!function(){"use strict";function t(){}!function(){const t={DFX_NETWORK:"local",CANISTER_ID_ENCRYPTED_NOTES:"uxrrr-q7777-77774-qaaaq-cai"};try{if(process)return process.env=Object.assign({},process.env),void Object.assign(process.env,t)}catch(t){}globalThis.process={env:t}}();const e=t=>t;function n(t,e){for(const n in e)t[n]=e[n];return t}function r(t){return t()}function i(){return Object.create(null)}function o(t){t.forEach(r)}function s(t){return"function"==typeof t}function a(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function u(t){let e;return c(t,(t=>e=t))(),e}function l(t,e,n){t.$$.on_destroy.push(c(e,n))}function f(t,e,n,r){if(t){const i=d(t,e,n,r);return t[0](i)}}function d(t,e,r,i){return t[1]&&i?n(r.ctx.slice(),t[1](i(e))):r.ctx}function h(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|i[r];return t}return e.dirty|i}return e.dirty}function p(t,e,n,r,i,o){if(i){const s=d(e,n,r,o);t.p(s,i)}}function g(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function m(t){const e={};for(const n in t)"$"!==n[0]&&(e[n]=t[n]);return e}function b(e){return e&&s(e.destroy)?e.destroy:t}function y(t){const e="string"==typeof t&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}const w="undefined"!=typeof window;let v=w?()=>window.performance.now():()=>Date.now(),E=w?t=>requestAnimationFrame(t):t;const x=new Set;function _(t){x.forEach((e=>{e.c(t)||(x.delete(e),e.f())})),0!==x.size&&E(_)}function A(t){let e;return 0===x.size&&E(_),{promise:new Promise((n=>{x.add(e={c:t,f:n})})),abort(){x.delete(e)}}}function T(t,e){t.appendChild(e)}function S(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function N(t){const e=R("style");return function(t,e){T(t.head||t,e),e.sheet}(S(t),e),e.sheet}function B(t,e,n){t.insertBefore(e,n||null)}function I(t){t.parentNode&&t.parentNode.removeChild(t)}function O(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function R(t){return document.createElement(t)}function $(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function k(t){return document.createTextNode(t)}function L(){return k(" ")}function P(){return k("")}function U(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function D(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function C(t,e){e=""+e,t.data!==e&&(t.data=e)}function F(t,e){t.value=null==e?"":e}function M(t,e,n){for(let n=0;n<t.options.length;n+=1){const r=t.options[n];if(r.__value===e)return void(r.selected=!0)}n&&void 0===e||(t.selectedIndex=-1)}function j(t){const e=t.querySelector(":checked");return e&&e.__value}function q(t,e,n){t.classList[n?"add":"remove"](e)}function V(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}function z(t,e){return new t(e)}const H=new Map;let G,K=0;function W(t,e,n,r,i,o,s,a=0){const c=16.666/r;let u="{\n";for(let t=0;t<=1;t+=c){const r=e+(n-e)*o(t);u+=100*t+`%{${s(r,1-r)}}\n`}const l=u+`100% {${s(n,1-n)}}\n}`,f=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(l)}_${a}`,d=S(t),{stylesheet:h,rules:p}=H.get(d)||function(t,e){const n={stylesheet:N(e),rules:{}};return H.set(t,n),n}(d,t);p[f]||(p[f]=!0,h.insertRule(`@keyframes ${f} ${l}`,h.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${f} ${r}ms linear ${i}ms 1 both`,K+=1,f}function Z(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-r.length;i&&(t.style.animation=r.join(", "),K-=i,K||E((()=>{K||(H.forEach((t=>{const{ownerNode:e}=t.stylesheet;e&&I(e)})),H.clear())})))}function Y(t){G=t}function X(){if(!G)throw new Error("Function called outside component initialization");return G}function J(t){X().$$.on_mount.push(t)}function Q(t){X().$$.on_destroy.push(t)}function tt(){const t=X();return(e,n,{cancelable:r=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=V(e,n,{cancelable:r});return i.slice().forEach((e=>{e.call(t,o)})),!o.defaultPrevented}return!0}}const et=[],nt=[];let rt=[];const it=[],ot=Promise.resolve();let st=!1;function at(t){rt.push(t)}const ct=new Set;let ut,lt=0;function ft(){if(0!==lt)return;const t=G;do{try{for(;lt<et.length;){const t=et[lt];lt++,Y(t),dt(t.$$)}}catch(t){throw et.length=0,lt=0,t}for(Y(null),et.length=0,lt=0;nt.length;)nt.pop()();for(let t=0;t<rt.length;t+=1){const e=rt[t];ct.has(e)||(ct.add(e),e())}rt.length=0}while(et.length);for(;it.length;)it.pop()();st=!1,ct.clear(),Y(t)}function dt(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(at)}}function ht(){return ut||(ut=Promise.resolve(),ut.then((()=>{ut=null}))),ut}function pt(t,e,n){t.dispatchEvent(V(`${e?"intro":"outro"}${n}`))}const gt=new Set;let mt;function bt(){mt={r:0,c:[],p:mt}}function yt(){mt.r||o(mt.c),mt=mt.p}function wt(t,e){t&&t.i&&(gt.delete(t),t.i(e))}function vt(t,e,n,r){if(t&&t.o){if(gt.has(t))return;gt.add(t),mt.c.push((()=>{gt.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}else r&&r()}const Et={duration:0};function xt(n,r,i){const a={direction:"out"};let c,u=r(n,i,a),l=!0;const f=mt;function d(){const{delay:r=0,duration:i=300,easing:s=e,tick:a=t,css:d}=u||Et;d&&(c=W(n,1,0,i,r,s,d));const h=v()+r,p=h+i;at((()=>pt(n,!1,"start"))),A((t=>{if(l){if(t>=p)return a(0,1),pt(n,!1,"end"),--f.r||o(f.c),!1;if(t>=h){const e=s((t-h)/i);a(1-e,e)}}return l}))}return f.r+=1,s(u)?ht().then((()=>{u=u(a),d()})):d(),{end(t){t&&u.tick&&u.tick(1,0),l&&(c&&Z(n,c),l=!1)}}}function _t(t,e){vt(t,1,1,(()=>{e.delete(t.key)}))}function At(t,e,n,r,i,s,a,c,u,l,f,d){let h=t.length,p=s.length,g=h;const m={};for(;g--;)m[t[g].key]=g;const b=[],y=new Map,w=new Map,v=[];for(g=p;g--;){const t=d(i,s,g),o=n(t);let c=a.get(o);c?r&&v.push((()=>c.p(t,e))):(c=l(o,t),c.c()),y.set(o,b[g]=c),o in m&&w.set(o,Math.abs(g-m[o]))}const E=new Set,x=new Set;function _(t){wt(t,1),t.m(c,f),a.set(t.key,t),f=t.first,p--}for(;h&&p;){const e=b[p-1],n=t[h-1],r=e.key,i=n.key;e===n?(f=e.first,h--,p--):y.has(i)?!a.has(r)||E.has(r)?_(e):x.has(i)?h--:w.get(r)>w.get(i)?(x.add(r),_(e)):(E.add(i),h--):(u(n,a),h--)}for(;h--;){const e=t[h];y.has(e.key)||u(e,a)}for(;p;)_(b[p-1]);return o(v),b}function Tt(t,e){const n={},r={},i={$$scope:1};let o=t.length;for(;o--;){const s=t[o],a=e[o];if(a){for(const t in s)t in a||(r[t]=1);for(const t in a)i[t]||(n[t]=a[t],i[t]=1);t[o]=a}else for(const t in s)i[t]=1}for(const t in r)t in n||(n[t]=void 0);return n}function St(t){return"object"==typeof t&&null!==t?t:{}}function Nt(t){t&&t.c()}function Bt(t,e,n,i){const{fragment:a,after_update:c}=t.$$;a&&a.m(e,n),i||at((()=>{const e=t.$$.on_mount.map(r).filter(s);t.$$.on_destroy?t.$$.on_destroy.push(...e):o(e),t.$$.on_mount=[]})),c.forEach(at)}function It(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];rt.forEach((r=>-1===t.indexOf(r)?e.push(r):n.push(r))),n.forEach((t=>t())),rt=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Ot(t,e){-1===t.$$.dirty[0]&&(et.push(t),st||(st=!0,ot.then(ft)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Rt(e,n,r,s,a,c,u,l=[-1]){const f=G;Y(e);const d=e.$$={fragment:null,ctx:[],props:c,update:t,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:i(),dirty:l,skip_bound:!1,root:n.target||f.$$.root};u&&u(d.root);let h=!1;if(d.ctx=r?r(e,n.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return d.ctx&&a(d.ctx[t],d.ctx[t]=i)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](i),h&&Ot(e,t)),n})):[],d.update(),h=!0,o(d.before_update),d.fragment=!!s&&s(d.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);d.fragment&&d.fragment.l(t),t.forEach(I)}else d.fragment&&d.fragment.c();n.intro&&wt(e.$$.fragment),Bt(e,n.target,n.anchor,n.customElement),ft()}Y(f)}class $t{$destroy(){It(this,1),this.$destroy=t}$on(e,n){if(!s(n))return t;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const t=r.indexOf(n);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const kt=[];function Lt(t,e){return{subscribe:Pt(t,e).subscribe}}function Pt(e,n=t){let r;const i=new Set;function o(t){if(a(e,t)&&(e=t,r)){const t=!kt.length;for(const t of i)t[1](),kt.push(t,e);if(t){for(let t=0;t<kt.length;t+=2)kt[t][0](kt[t+1]);kt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const c=[s,a];return i.add(c),1===i.size&&(r=n(o)||t),s(e),()=>{i.delete(c),0===i.size&&r&&(r(),r=null)}}}}var Ut="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Dt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}for(var Ct={},Ft={byteLength:function(t){var e=Ht(t),n=e[0],r=e[1];return 3*(n+r)/4-r},toByteArray:function(t){var e,n,r=Ht(t),i=r[0],o=r[1],s=new qt(function(t,e,n){return 3*(e+n)/4-n}(0,i,o)),a=0,c=o>0?i-4:i;for(n=0;n<c;n+=4)e=jt[t.charCodeAt(n)]<<18|jt[t.charCodeAt(n+1)]<<12|jt[t.charCodeAt(n+2)]<<6|jt[t.charCodeAt(n+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===o&&(e=jt[t.charCodeAt(n)]<<2|jt[t.charCodeAt(n+1)]>>4,s[a++]=255&e);1===o&&(e=jt[t.charCodeAt(n)]<<10|jt[t.charCodeAt(n+1)]<<4|jt[t.charCodeAt(n+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},fromByteArray:function(t){for(var e,n=t.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(Gt(t,s,s+o>a?a:s+o));1===r?(e=t[n-1],i.push(Mt[e>>2]+Mt[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],i.push(Mt[e>>10]+Mt[e>>4&63]+Mt[e<<2&63]+"="));return i.join("")}},Mt=[],jt=[],qt="undefined"!=typeof Uint8Array?Uint8Array:Array,Vt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zt=0;zt<64;++zt)Mt[zt]=Vt[zt],jt[Vt.charCodeAt(zt)]=zt;function Ht(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function Gt(t,e,n){for(var r,i,o=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(Mt[(i=r)>>18&63]+Mt[i>>12&63]+Mt[i>>6&63]+Mt[63&i]);return o.join("")}jt["-".charCodeAt(0)]=62,jt["_".charCodeAt(0)]=63;var Kt,Wt={};Wt.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,l=-7,f=n?i-1:0,d=n?-1:1,h=t[e+f];for(f+=d,o=h&(1<<-l)-1,h>>=-l,l+=a;l>0;o=256*o+t[e+f],f+=d,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+f],f+=d,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,r),o-=u}return(h?-1:1)*s*Math.pow(2,o-r)},Wt.write=function(t,e,n,r,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,f=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+f>=1?d/c:d*Math.pow(2,1-f))*c>=2&&(s++,c/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(e*c-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[n+h]=255&a,h+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[n+h]=255&s,h+=p,s/=256,u-=8);t[n+h-p]|=128*g},function(t){const e=Ft,n=Wt,r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=function(t){+t!=t&&(t=0);return s.alloc(+t)},t.INSPECT_MAX_BYTES=50;const i=2147483647;function o(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return a(t,e,n)}function a(t,e,n){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|h(t,e);let r=o(n);const i=r.write(t,e);i!==n&&(r=r.slice(0,i));return r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(K(t,Uint8Array)){const e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(K(t,ArrayBuffer)||t&&K(t.buffer,ArrayBuffer))return f(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(K(t,SharedArrayBuffer)||t&&K(t.buffer,SharedArrayBuffer)))return f(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return s.from(r,e,n);const i=function(t){if(s.isBuffer(t)){const e=0|d(t.length),n=o(e);return 0===n.length||t.copy(n,0,0,e),n}if(void 0!==t.length)return"number"!=typeof t.length||W(t.length)?o(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return c(t),o(t<0?0:0|d(t))}function l(t){const e=t.length<0?0:0|d(t.length),n=o(e);for(let r=0;r<e;r+=1)n[r]=255&t[r];return n}function f(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,s.prototype),r}function d(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function h(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||K(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(t).length;default:if(i)return r?-1:z(t).length;e=(""+e).toLowerCase(),i=!0}}function p(t,e,n){let r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return B(this,e,n);case"utf8":case"utf-8":return A(this,e,n);case"ascii":return S(this,e,n);case"latin1":case"binary":return N(this,e,n);case"base64":return _(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),W(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=s.from(e,r)),s.isBuffer(e))return 0===e.length?-1:b(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,r,i){let o,s=1,a=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){let r=-1;for(o=n;o<a;o++)if(u(t,o)===u(e,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===c)return r*s}else-1!==r&&(o-=o-r),r=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){let n=!0;for(let r=0;r<c;r++)if(u(t,o+r)!==u(e,r)){n=!1;break}if(n)return o}return-1}function y(t,e,n,r){n=Number(n)||0;const i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=e.length;let s;for(r>o/2&&(r=o/2),s=0;s<r;++s){const r=parseInt(e.substr(2*s,2),16);if(W(r))return s;t[n+s]=r}return s}function w(t,e,n,r){return G(z(e,t.length-n),t,n,r)}function v(t,e,n,r){return G(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function E(t,e,n,r){return G(H(e),t,n,r)}function x(t,e,n,r){return G(function(t,e){let n,r,i;const o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function _(t,n,r){return 0===n&&r===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(n,r))}function A(t,e,n){n=Math.min(t.length,n);const r=[];let i=e;for(;i<n;){const e=t[i];let o=null,s=e>239?4:e>223?3:e>191?2:1;if(i+s<=n){let n,r,a,c;switch(s){case 1:e<128&&(o=e);break;case 2:n=t[i+1],128==(192&n)&&(c=(31&e)<<6|63&n,c>127&&(o=c));break;case 3:n=t[i+1],r=t[i+2],128==(192&n)&&128==(192&r)&&(c=(15&e)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=t[i+1],r=t[i+2],a=t[i+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(c=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(t){const e=t.length;if(e<=T)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=T));return n}(r)}t.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,n){return a(t,e,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,n){return function(t,e,n){return c(t),t<=0?o(t):void 0!==e?"string"==typeof n?o(t).fill(e,n):o(t).fill(e):o(t)}(t,e,n)},s.allocUnsafe=function(t){return u(t)},s.allocUnsafeSlow=function(t){return u(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(K(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),K(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,r=e.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const r=s.allocUnsafe(e);let i=0;for(n=0;n<t.length;++n){let e=t[n];if(K(e,Uint8Array))i+e.length>r.length?(s.isBuffer(e)||(e=s.from(e)),e.copy(r,i)):Uint8Array.prototype.set.call(r,e,i);else{if(!s.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(r,i)}i+=e.length}return r},s.byteLength=h,s.prototype._isBuffer=!0,s.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)g(this,e,e+1);return this},s.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},s.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},s.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?A(this,0,t):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(t,e,n,r,i){if(K(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;let o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0);const c=Math.min(o,a),u=this.slice(r,i),l=t.slice(e,n);for(let t=0;t<c;++t)if(u[t]!==l[t]){o=u[t],a=l[t];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},s.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},s.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},s.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return y(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":case"latin1":case"binary":return v(this,t,e,n);case"base64":return E(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const T=4096;function S(t,e,n){let r="";n=Math.min(t.length,n);for(let i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function N(t,e,n){let r="";n=Math.min(t.length,n);for(let i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function B(t,e,n){const r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=e;r<n;++r)i+=Z[t[r]];return i}function I(t,e,n){const r=t.slice(e,n);let i="";for(let t=0;t<r.length-1;t+=2)i+=String.fromCharCode(r[t]+256*r[t+1]);return i}function O(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,n,r,i,o){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function $(t,e,n,r,i){M(e,r,i,t,n,7);let o=Number(e&BigInt(4294967295));t[n++]=o,o>>=8,t[n++]=o,o>>=8,t[n++]=o,o>>=8,t[n++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,n}function k(t,e,n,r,i){M(e,r,i,t,n,7);let o=Number(e&BigInt(4294967295));t[n+7]=o,o>>=8,t[n+6]=o,o>>=8,t[n+5]=o,o>>=8,t[n+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=s,s>>=8,t[n+2]=s,s>>=8,t[n+1]=s,s>>=8,t[n]=s,n+8}function L(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function P(t,e,r,i,o){return e=+e,r>>>=0,o||L(t,0,r,4),n.write(t,e,r,i,23,4),r+4}function U(t,e,r,i,o){return e=+e,r>>>=0,o||L(t,0,r,8),n.write(t,e,r,i,52,8),r+8}s.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const r=this.subarray(t,e);return Object.setPrototypeOf(r,s.prototype),r},s.prototype.readUintLE=s.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let r=this[t],i=1,o=0;for(;++o<e&&(i*=256);)r+=this[t+o]*i;return r},s.prototype.readUintBE=s.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let r=this[t+--e],i=1;for(;e>0&&(i*=256);)r+=this[t+--e]*i;return r},s.prototype.readUint8=s.prototype.readUInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readBigUInt64LE=Y((function(t){j(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||q(t,this.length-8);const r=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,i=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),s.prototype.readBigUInt64BE=Y((function(t){j(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||q(t,this.length-8);const r=e*2**24+65536*this[++t]+256*this[++t]+this[++t],i=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),s.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let r=this[t],i=1,o=0;for(;++o<e&&(i*=256);)r+=this[t+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*e)),r},s.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let r=e,i=1,o=this[t+--r];for(;r>0&&(i*=256);)o+=this[t+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},s.prototype.readInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||O(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(t,e){t>>>=0,e||O(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readBigInt64LE=Y((function(t){j(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||q(t,this.length-8);const r=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),s.prototype.readBigInt64BE=Y((function(t){j(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||q(t,this.length-8);const r=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(r)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)})),s.prototype.readFloatLE=function(t,e){return t>>>=0,e||O(t,4,this.length),n.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||O(t,4,this.length),n.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||O(t,8,this.length),n.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||O(t,8,this.length),n.read(this,t,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){R(this,t,e,n,Math.pow(2,8*n)-1,0)}let i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){R(this,t,e,n,Math.pow(2,8*n)-1,0)}let i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},s.prototype.writeUint8=s.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigUInt64LE=Y((function(t,e=0){return $(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeBigUInt64BE=Y((function(t,e=0){return k(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);R(this,t,e,n,r-1,-r)}let i=0,o=1,s=0;for(this[e]=255&t;++i<n&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},s.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);R(this,t,e,n,r-1,-r)}let i=n-1,o=1,s=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},s.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigInt64LE=Y((function(t,e=0){return $(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeBigInt64BE=Y((function(t,e=0){return k(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeFloatLE=function(t,e,n){return P(this,t,e,!0,n)},s.prototype.writeFloatBE=function(t,e,n){return P(this,t,e,!1,n)},s.prototype.writeDoubleLE=function(t,e,n){return U(this,t,e,!0,n)},s.prototype.writeDoubleBE=function(t,e,n){return U(this,t,e,!1,n)},s.prototype.copy=function(t,e,n,r){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);const i=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),i},s.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){const e=t.charCodeAt(0);("utf8"===r&&e<128||"latin1"===r)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{const o=s.isBuffer(t)?t:s.from(t,r),a=o.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<n-e;++i)this[i+e]=o[i%a]}return this};const D={};function C(t,e,n){D[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function F(t){let e="",n=t.length;const r="-"===t[0]?1:0;for(;n>=r+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function M(t,e,n,r,i,o){if(t>n||t<e){const r="bigint"==typeof e?"n":"";let i;throw i=o>3?0===e||e===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${e}${r} and <= ${n}${r}`,new D.ERR_OUT_OF_RANGE("value",i,t)}!function(t,e,n){j(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||q(e,t.length-(n+1))}(r,i,o)}function j(t,e){if("number"!=typeof t)throw new D.ERR_INVALID_ARG_TYPE(e,"number",t)}function q(t,e,n){if(Math.floor(t)!==t)throw j(t,n),new D.ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(e<0)throw new D.ERR_BUFFER_OUT_OF_BOUNDS;throw new D.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}C("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),C("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),C("ERR_OUT_OF_RANGE",(function(t,e,n){let r=`The value of "${t}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=F(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=F(i)),i+="n"),r+=` It must be ${e}. Received ${i}`,r}),RangeError);const V=/[^+/0-9A-Za-z-_]/g;function z(t,e){let n;e=e||1/0;const r=t.length;let i=null;const o=[];for(let s=0;s<r;++s){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function H(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function G(t,e,n,r){let i;for(i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function K(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function W(t){return t!=t}const Z=function(){const t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)e[r+i]=t[n]+t[i]}return e}();function Y(t){return"undefined"==typeof BigInt?X:t}function X(){throw new Error("BigInt not supported")}}(Ct),function(t){t[t.SysFatal=1]="SysFatal",t[t.SysTransient=2]="SysTransient",t[t.DestinationInvalid=3]="DestinationInvalid",t[t.CanisterReject=4]="CanisterReject",t[t.CanisterError=5]="CanisterError"}(Kt||(Kt={}));const Zt="abcdefghijklmnopqrstuvwxyz234567",Yt=Object.create(null);for(let t=0;t<32;t++)Yt[Zt[t]]=t;Yt[0]=Yt.o,Yt[1]=Yt.i;const Xt=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);const Jt="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function Qt(t,...e){if(!((n=t)instanceof Uint8Array||ArrayBuffer.isView(n)&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function te(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ee(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function ne(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function re(t,e){return t<<32-e|t>>>e}function ie(t){return"string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}(t)),Qt(t),t}class oe{}function se(t){const e=e=>t().update(ie(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function ae(t=32){if(Jt&&"function"==typeof Jt.getRandomValues)return Jt.getRandomValues(new Uint8Array(t));if(Jt&&"function"==typeof Jt.randomBytes)return Uint8Array.from(Jt.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function ce(t,e,n){return t&e^~t&n}function ue(t,e,n){return t&e^t&n^e&n}class le extends oe{constructor(t,e,n,r){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.buffer=new Uint8Array(t),this.view=ne(this.buffer)}update(t){te(this),Qt(t=ie(t));const{view:e,buffer:n,blockLen:r}=this,i=t.length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(e,0),this.pos=0);else{const e=ne(t);for(;r<=i-o;o+=r)this.process(e,o)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){te(this),function(t,e){Qt(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;e[o++]=128,ee(this.buffer.subarray(o)),this.padOffset>r-o&&(this.process(n,0),o=0);for(let t=o;t<r;t++)e[t]=0;!function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=ne(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return t.destroyed=o,t.finished=i,t.length=r,t.pos=s,r%e&&t.buffer.set(n),t}clone(){return this._cloneInto()}}const fe=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),de=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),he=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),pe=BigInt(2**32-1),ge=BigInt(32);function me(t,e=!1){return e?{h:Number(t&pe),l:Number(t>>ge&pe)}:{h:0|Number(t>>ge&pe),l:0|Number(t&pe)}}const be=(t,e,n)=>t>>>n,ye=(t,e,n)=>t<<32-n|e>>>n,we=(t,e,n)=>t>>>n|e<<32-n,ve=(t,e,n)=>t<<32-n|e>>>n,Ee=(t,e,n)=>t<<64-n|e>>>n-32,xe=(t,e,n)=>t>>>n-32|e<<64-n;function _e(t,e,n,r){const i=(e>>>0)+(r>>>0);return{h:t+n+(i/2**32|0)|0,l:0|i}}const Ae=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),Te=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,Se=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),Ne=(t,e,n,r,i)=>e+n+r+i+(t/2**32|0)|0,Be=(t,e,n,r,i)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(i>>>0),Ie=(t,e,n,r,i,o)=>e+n+r+i+o+(t/2**32|0)|0,Oe=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Re=new Uint32Array(64);class $e extends le{constructor(t=32){super(64,t,8,!1),this.A=0|fe[0],this.B=0|fe[1],this.C=0|fe[2],this.D=0|fe[3],this.E=0|fe[4],this.F=0|fe[5],this.G=0|fe[6],this.H=0|fe[7]}get(){const{A:t,B:e,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[t,e,n,r,i,o,s,a]}set(t,e,n,r,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)Re[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=Re[t-15],n=Re[t-2],r=re(e,7)^re(e,18)^e>>>3,i=re(n,17)^re(n,19)^n>>>10;Re[t]=i+Re[t-7]+r+Re[t-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(re(s,6)^re(s,11)^re(s,25))+ce(s,a,c)+Oe[t]+Re[t]|0,l=(re(n,2)^re(n,13)^re(n,22))+ue(n,r,i)|0;u=c,c=a,a=s,s=o+e|0,o=i,i=r,r=n,n=e+l|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,i,o,s,a,c,u)}roundClean(){ee(Re)}destroy(){this.set(0,0,0,0,0,0,0,0),ee(this.buffer)}}class ke extends $e{constructor(){super(28),this.A=0|de[0],this.B=0|de[1],this.C=0|de[2],this.D=0|de[3],this.E=0|de[4],this.F=0|de[5],this.G=0|de[6],this.H=0|de[7]}}const Le=(()=>function(t,e=!1){const n=t.length;let r=new Uint32Array(n),i=new Uint32Array(n);for(let o=0;o<n;o++){const{h:n,l:s}=me(t[o],e);[r[o],i[o]]=[n,s]}return[r,i]}(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t)))))(),Pe=(()=>Le[0])(),Ue=(()=>Le[1])(),De=new Uint32Array(80),Ce=new Uint32Array(80);class Fe extends le{constructor(t=64){super(128,t,16,!1),this.Ah=0|he[0],this.Al=0|he[1],this.Bh=0|he[2],this.Bl=0|he[3],this.Ch=0|he[4],this.Cl=0|he[5],this.Dh=0|he[6],this.Dl=0|he[7],this.Eh=0|he[8],this.El=0|he[9],this.Fh=0|he[10],this.Fl=0|he[11],this.Gh=0|he[12],this.Gl=0|he[13],this.Hh=0|he[14],this.Hl=0|he[15]}get(){const{Ah:t,Al:e,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:u,Fh:l,Fl:f,Gh:d,Gl:h,Hh:p,Hl:g}=this;return[t,e,n,r,i,o,s,a,c,u,l,f,d,h,p,g]}set(t,e,n,r,i,o,s,a,c,u,l,f,d,h,p,g){this.Ah=0|t,this.Al=0|e,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|l,this.Fl=0|f,this.Gh=0|d,this.Gl=0|h,this.Hh=0|p,this.Hl=0|g}process(t,e){for(let n=0;n<16;n++,e+=4)De[n]=t.getUint32(e),Ce[n]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|De[t-15],n=0|Ce[t-15],r=we(e,n,1)^we(e,n,8)^be(e,0,7),i=ve(e,n,1)^ve(e,n,8)^ye(e,n,7),o=0|De[t-2],s=0|Ce[t-2],a=we(o,s,19)^Ee(o,s,61)^be(o,0,6),c=ve(o,s,19)^xe(o,s,61)^ye(o,s,6),u=Se(i,c,Ce[t-7],Ce[t-16]),l=Ne(u,r,a,De[t-7],De[t-16]);De[t]=0|l,Ce[t]=0|u}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:u,Eh:l,El:f,Fh:d,Fl:h,Gh:p,Gl:g,Hh:m,Hl:b}=this;for(let t=0;t<80;t++){const e=we(l,f,14)^we(l,f,18)^Ee(l,f,41),y=ve(l,f,14)^ve(l,f,18)^xe(l,f,41),w=l&d^~l&p,v=Be(b,y,f&h^~f&g,Ue[t],Ce[t]),E=Ie(v,m,e,w,Pe[t],De[t]),x=0|v,_=we(n,r,28)^Ee(n,r,34)^Ee(n,r,39),A=ve(n,r,28)^xe(n,r,34)^xe(n,r,39),T=n&i^n&s^i&s,S=r&o^r&a^o&a;m=0|p,b=0|g,p=0|d,g=0|h,d=0|l,h=0|f,({h:l,l:f}=_e(0|c,0|u,0|E,0|x)),c=0|s,u=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const N=Ae(x,A,S);n=Te(N,E,_,T),r=0|N}({h:n,l:r}=_e(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=_e(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=_e(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=_e(0|this.Dh,0|this.Dl,0|c,0|u)),({h:l,l:f}=_e(0|this.Eh,0|this.El,0|l,0|f)),({h:d,l:h}=_e(0|this.Fh,0|this.Fl,0|d,0|h)),({h:p,l:g}=_e(0|this.Gh,0|this.Gl,0|p,0|g)),({h:m,l:b}=_e(0|this.Hh,0|this.Hl,0|m,0|b)),this.set(n,r,i,o,s,a,c,u,l,f,d,h,p,g,m,b)}roundClean(){ee(De,Ce)}destroy(){ee(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Me=se((()=>new $e)),je=se((()=>new ke)),qe=se((()=>new Fe)),Ve=Me,ze=je;const He="__principal__";let Ge=class t{constructor(t){this._arr=t,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([4]))}static managementCanister(){return this.fromText("aaaaa-aa")}static selfAuthenticating(t){const e=(n=t,ze.create().update(new Uint8Array(n)).digest());var n;return new this(new Uint8Array([...e,2]))}static from(e){if("string"==typeof e)return t.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new t(e);if("object"==typeof e&&null!==e&&!0===e._isPrincipal)return new t(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(t){return new this((t=>{var e;return new Uint8Array((null!==(e=t.match(/.{1,2}/g))&&void 0!==e?e:[]).map((t=>parseInt(t,16))))})(t))}static fromText(t){let e=t;if(t.includes(He)){const n=JSON.parse(t);He in n&&(e=n[He])}let n=function(t){let e=0,n=0;const r=new Uint8Array(4*t.length/3|0);let i=0;function o(t){let o=Yt[t.toLowerCase()];if(void 0===o)throw new Error(`Invalid character: ${JSON.stringify(t)}`);o<<=3,n|=o>>>e,e+=5,e>=8&&(r[i++]=n,e-=8,n=e>0?o<<5-e&255:0)}for(const e of t)o(e);return r.slice(0,i)}(e.toLowerCase().replace(/-/g,""));n=n.slice(4,n.length);const r=new this(n);if(r.toText()!==e)throw new Error(`Principal "${r.toText()}" does not have a valid checksum (original value "${e}" may not be a valid Principal ID).`);return r}static fromUint8Array(t){return new this(t)}isAnonymous(){return 1===this._arr.byteLength&&4===this._arr[0]}toUint8Array(){return this._arr}toHex(){return(t=>t.reduce(((t,e)=>t+e.toString(16).padStart(2,"0")),""))(this._arr).toUpperCase()}toText(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,function(t){const e=new Uint8Array(t);let n=-1;for(let t=0;t<e.length;t++){const r=e[t];n=Xt[255&(r^n)]^n>>>8}return(-1^n)>>>0}(this._arr));const e=new Uint8Array(t),n=Uint8Array.from(this._arr),r=function(t){let e=0,n=0,r="";for(let o=0;o<t.length;)o+=(i=t[o],e<0?n|=i>>-e:n=i<<e&248,e>3?(e-=8,1):(e<4&&(r+=Zt[n>>3],e+=5),0));var i;return r+(e<0?Zt[n>>3]:"")}(new Uint8Array([...e,...n])),i=r.match(/.{1,5}/g);if(!i)throw new Error;return i.join("-")}toString(){return this.toText()}toJSON(){return{[He]:this.toText()}}compareTo(t){for(let e=0;e<Math.min(this._arr.length,t._arr.length);e++){if(this._arr[e]<t._arr[e])return"lt";if(this._arr[e]>t._arr[e])return"gt"}return this._arr.length<t._arr.length?"lt":this._arr.length>t._arr.length?"gt":"eq"}ltEq(t){const e=this.compareTo(t);return"lt"==e||"eq"==e}gtEq(t){const e=this.compareTo(t);return"gt"==e||"eq"==e}};function Ke(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.byteLength),0));let n=0;for(const r of t)e.set(new Uint8Array(r),n),n+=r.byteLength;return e.buffer}function We(t){return[...new Uint8Array(t)].map((t=>t.toString(16).padStart(2,"0"))).join("")}const Ze=new RegExp(/^[0-9a-fA-F]+$/);function Ye(t){if(!Ze.test(t))throw new Error("Invalid hexadecimal string.");const e=[...t].reduce(((t,e,n)=>(t[n/2|0]=(t[n/2|0]||"")+e,t)),[]).map((t=>Number.parseInt(t,16)));return new Uint8Array(e).buffer}function Xe(t,e){if(t.byteLength!==e.byteLength)return t.byteLength-e.byteLength;const n=new Uint8Array(t),r=new Uint8Array(e);for(let t=0;t<n.length;t++)if(n[t]!==r[t])return n[t]-r[t];return 0}function Je(t,e){return 0===Xe(t,e)}function Qe(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function tn(t){return t instanceof Uint8Array?Qe(t):t instanceof ArrayBuffer?t:Array.isArray(t)?Qe(new Uint8Array(t)):"buffer"in t?tn(t.buffer):Qe(new Uint8Array(t))}class en extends Error{constructor(t){super(t),this.message=t,this.name="AgentError",this.__proto__=en.prototype,Object.setPrototypeOf(this,en.prototype)}}function nn(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.byteLength),0));let n=0;for(const r of t)e.set(new Uint8Array(r),n),n+=r.byteLength;return e}class rn{constructor(t,e=(null==t?void 0:t.byteLength)||0){this._buffer=sn(t||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,e)}save(){return this._view}restore(t){this._view=t}get buffer(){return sn(this._view.slice())}get byteLength(){return this._view.byteLength}read(t){const e=this._view.subarray(0,t);return this._view=this._view.subarray(t),e.slice().buffer}readUint8(){const t=this._view[0];return this._view=this._view.subarray(1),t}write(t){const e=new Uint8Array(t),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+e.byteLength>=this._buffer.byteLength?this.alloc(e.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+e.byteLength),this._view.set(e,n)}get end(){return 0===this._view.byteLength}alloc(t){const e=new ArrayBuffer(1.2*(this._buffer.byteLength+t)|0),n=new Uint8Array(e,0,this._view.byteLength+t);n.set(this._view),this._buffer=e,this._view=n}}function on(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function sn(t){return t instanceof Uint8Array?on(t):t instanceof ArrayBuffer?t:Array.isArray(t)?on(new Uint8Array(t)):"buffer"in t?sn(t.buffer):on(new Uint8Array(t))}function an(t){if(/^_\d+_$/.test(t)||/^_0x[0-9a-fA-F]+_$/.test(t)){const e=+t.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return function(t){const e=(new TextEncoder).encode(t);let n=0;for(const t of e)n=(223*n+t)%2**32;return n}(t)}function cn(){throw new Error("unexpected end of buffer")}function un(t,e){return t.byteLength<e&&cn(),t.read(e)}function ln(t){const e=t.readUint8();return void 0===e&&cn(),e}function fn(t){if("number"==typeof t&&(t=BigInt(t)),t<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,n=new rn(new ArrayBuffer(e),0);for(;;){const e=Number(t&BigInt(127));if((t/=BigInt(128))===BigInt(0)){n.write(new Uint8Array([e]));break}n.write(new Uint8Array([128|e]))}return n.buffer}function dn(t){let e,n=BigInt(1),r=BigInt(0);do{e=ln(t),r+=BigInt(127&e).valueOf()*n,n*=BigInt(128)}while(e>=128);return r}function hn(t){"number"==typeof t&&(t=BigInt(t));const e=t<BigInt(0);e&&(t=-t-BigInt(1));const n=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,r=new rn(new ArrayBuffer(n),0);for(;;){const n=i(t);if(t/=BigInt(128),e&&t===BigInt(0)&&0!=(64&n)||!e&&t===BigInt(0)&&0==(64&n)){r.write(new Uint8Array([n]));break}r.write(new Uint8Array([128|n]))}function i(t){const n=t%BigInt(128);return Number(e?BigInt(128)-n-BigInt(1):n)}return r.buffer}function pn(t){const e=new Uint8Array(t.buffer);let n=0;for(;n<e.byteLength;n++)if(e[n]<128){if(0==(64&e[n]))return dn(t);break}const r=new Uint8Array(un(t,n+1));let i=BigInt(0);for(let t=r.byteLength-1;t>=0;t--)i=i*BigInt(128)+BigInt(128-(127&r[t])-1);return-i-BigInt(1)}function gn(t,e){t=BigInt(t);const n=new rn(new ArrayBuffer(Math.min(1,e)),0);let r=0,i=BigInt(256),o=BigInt(0),s=Number(t%i);for(n.write(new Uint8Array([s]));++r<e;)t<0&&o===BigInt(0)&&0!==s&&(o=BigInt(1)),s=Number((t/i-o)%BigInt(256)),n.write(new Uint8Array([s])),i*=BigInt(256);return n.buffer}function mn(t,e){let n=BigInt(ln(t)),r=BigInt(1),i=0;for(;++i<e;){r*=BigInt(256);n+=r*BigInt(ln(t))}return n}function bn(t){const e=BigInt(t);if(t<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const yn="DIDL";function wn(t,e,n){return t.map(((t,r)=>n(t,e[r])))}class vn{constructor(){this._typs=[],this._idx=new Map}has(t){return this._idx.has(t.name)}add(t,e){const n=this._typs.length;this._idx.set(t.name,n),this._typs.push(e)}merge(t,e){const n=this._idx.get(t.name),r=this._idx.get(e);if(void 0===n)throw new Error("Missing type index for "+t);if(void 0===r)throw new Error("Missing type index for "+e);this._typs[n]=this._typs[r],this._typs.splice(r,1),this._idx.delete(e)}encode(){const t=fn(this._typs.length),e=nn(...this._typs);return nn(t,e)}indexOf(t){if(!this._idx.has(t))throw new Error("Missing type index for "+t);return hn(this._idx.get(t)||0)}}class En{display(){return this.name}valueToString(t){return Hn(t)}buildTypeTable(t){t.has(this)||this._buildTypeTableImpl(t)}}class xn extends En{checkType(t){if(this.name!==t.name)throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`);return t}_buildTypeTableImpl(t){}}class _n extends En{checkType(t){if(t instanceof Mn){const e=t.getType();if(void 0===e)throw new Error("type mismatch with uninitialized type");return e}throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`)}encodeType(t){return t.indexOf(this.name)}}class An extends xn{accept(t,e){return t.visitEmpty(this,e)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return hn(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class Tn extends En{checkType(t){throw new Error("Method not implemented for unknown.")}accept(t,e){throw t.visitType(this,e)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(t,e){let n,r=e.decodeValue(t,e);return Object(r)!==r&&(r=Object(r)),n=e instanceof Mn?()=>e.getType():()=>e,Object.defineProperty(r,"type",{value:n,writable:!0,enumerable:!1,configurable:!0}),r}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class Sn extends xn{accept(t,e){return t.visitBool(this,e)}covariant(t){if("boolean"==typeof t)return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){return new Uint8Array([t?1:0])}encodeType(){return hn(-2)}decodeValue(t,e){switch(this.checkType(e),ln(t)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class Nn extends xn{accept(t,e){return t.visitNull(this,e)}covariant(t){if(null===t)return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return hn(-1)}decodeValue(t,e){return this.checkType(e),null}get name(){return"null"}}class Bn extends xn{accept(t,e){return t.visitReserved(this,e)}covariant(t){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return hn(-16)}decodeValue(t,e){return e.name!==this.name&&e.decodeValue(t,e),null}get name(){return"reserved"}}class In extends xn{accept(t,e){return t.visitText(this,e)}covariant(t){if("string"==typeof t)return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){const e=(new TextEncoder).encode(t);return nn(fn(e.byteLength),e)}encodeType(){return hn(-15)}decodeValue(t,e){this.checkType(e);const n=dn(t),r=un(t,Number(n));return new TextDecoder("utf8",{fatal:!0}).decode(r)}get name(){return"text"}valueToString(t){return'"'+t+'"'}}class On extends xn{accept(t,e){return t.visitInt(this,e)}covariant(t){if("bigint"==typeof t||Number.isInteger(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){return hn(t)}encodeType(){return hn(-4)}decodeValue(t,e){return this.checkType(e),pn(t)}get name(){return"int"}valueToString(t){return t.toString()}}class Rn extends xn{accept(t,e){return t.visitNat(this,e)}covariant(t){if("bigint"==typeof t&&t>=BigInt(0)||Number.isInteger(t)&&t>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){return fn(t)}encodeType(){return hn(-3)}decodeValue(t,e){return this.checkType(e),dn(t)}get name(){return"nat"}valueToString(t){return t.toString()}}class $n extends xn{constructor(t){if(super(),this._bits=t,32!==t&&64!==t)throw new Error("not a valid float type")}accept(t,e){return t.visitFloat(this,e)}covariant(t){if("number"==typeof t||t instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){const e=new ArrayBuffer(this._bits/8),n=new DataView(e);return 32===this._bits?n.setFloat32(0,t,!0):n.setFloat64(0,t,!0),e}encodeType(){return hn(32===this._bits?-13:-14)}decodeValue(t,e){this.checkType(e);const n=un(t,this._bits/8),r=new DataView(n);return 32===this._bits?r.getFloat32(0,!0):r.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(t){return t.toString()}}class kn extends xn{constructor(t){super(),this._bits=t}accept(t,e){return t.visitFixedInt(this,e)}covariant(t){const e=bn(this._bits-1)*BigInt(-1),n=bn(this._bits-1)-BigInt(1);let r=!1;if("bigint"==typeof t)r=t>=e&&t<=n;else if(Number.isInteger(t)){const i=BigInt(t);r=i>=e&&i<=n}else r=!1;if(r)return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){return gn(t,this._bits/8)}encodeType(){return hn(-9-(Math.log2(this._bits)-3))}decodeValue(t,e){this.checkType(e);const n=function(t,e){let n=mn(t,e);const r=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return n>=r&&(n-=r*BigInt(2)),n}(t,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`int${this._bits}`}valueToString(t){return t.toString()}}class Ln extends xn{constructor(t){super(),this._bits=t}accept(t,e){return t.visitFixedNat(this,e)}covariant(t){const e=bn(this._bits);let n=!1;if("bigint"==typeof t&&t>=BigInt(0))n=t<e;else if(Number.isInteger(t)&&t>=0){n=BigInt(t)<e}else n=!1;if(n)return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){return function(t,e){if(BigInt(t)<BigInt(0))throw new Error("Cannot write negative values.");return gn(t,e)}(t,this._bits/8)}encodeType(){return hn(-5-(Math.log2(this._bits)-3))}decodeValue(t,e){this.checkType(e);const n=mn(t,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`nat${this._bits}`}valueToString(t){return t.toString()}}class Pn extends _n{constructor(t){super(),this._type=t,this._blobOptimization=!1,t instanceof Ln&&8===t._bits&&(this._blobOptimization=!0)}accept(t,e){return t.visitVec(this,this._type,e)}covariant(t){const e=this._type instanceof Ln||this._type instanceof kn?this._type._bits:0;if(ArrayBuffer.isView(t)&&e==8*t.BYTES_PER_ELEMENT||Array.isArray(t)&&t.every(((t,e)=>{try{return this._type.covariant(t)}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nindex ${e} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){const e=fn(t.length);if(this._blobOptimization)return nn(e,new Uint8Array(t));if(ArrayBuffer.isView(t))return nn(e,new Uint8Array(t.buffer));const n=new rn(new ArrayBuffer(e.byteLength+t.length),0);n.write(e);for(const e of t){const t=this._type.encodeValue(e);n.write(new Uint8Array(t))}return n.buffer}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const e=hn(-19),n=this._type.encodeType(t);t.add(this,nn(e,n))}decodeValue(t,e){const n=this.checkType(e);if(!(n instanceof Pn))throw new Error("Not a vector type");const r=Number(dn(t));if(this._type instanceof Ln){if(8==this._type._bits)return new Uint8Array(t.read(r));if(16==this._type._bits)return new Uint16Array(t.read(2*r));if(32==this._type._bits)return new Uint32Array(t.read(4*r));if(64==this._type._bits)return new BigUint64Array(t.read(8*r))}if(this._type instanceof kn){if(8==this._type._bits)return new Int8Array(t.read(r));if(16==this._type._bits)return new Int16Array(t.read(2*r));if(32==this._type._bits)return new Int32Array(t.read(4*r));if(64==this._type._bits)return new BigInt64Array(t.read(8*r))}const i=[];for(let e=0;e<r;e++)i.push(this._type.decodeValue(t,n._type));return i}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(t){return"vec {"+t.map((t=>this._type.valueToString(t))).join("; ")+"}"}}class Un extends _n{constructor(t){super(),this._type=t}accept(t,e){return t.visitOpt(this,this._type,e)}covariant(t){try{if(Array.isArray(t)&&(0===t.length||1===t.length&&this._type.covariant(t[0])))return!0}catch(e){throw new Error(`Invalid ${this.display()} argument: ${Hn(t)} \n\n-> ${e.message}`)}throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){return 0===t.length?new Uint8Array([0]):nn(new Uint8Array([1]),this._type.encodeValue(t[0]))}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const e=hn(-18),n=this._type.encodeType(t);t.add(this,nn(e,n))}decodeValue(t,e){if(e instanceof Nn)return[];if(e instanceof Bn)return[];let n=e;if(e instanceof Mn){const t=e.getType();if(void 0===t)throw new Error("type mismatch with uninitialized type");n=t}if(n instanceof Un)switch(ln(t)){case 0:return[];case 1:{const e=t.save();try{return[this._type.decodeValue(t,n._type)]}catch(r){return t.restore(e),n._type.decodeValue(t,n._type),[]}}default:throw new Error("Not an option value")}else{if(this._type instanceof Nn||this._type instanceof Un||this._type instanceof Bn)return n.decodeValue(t,n),[];{const r=t.save();try{return[this._type.decodeValue(t,e)]}catch(i){return t.restore(r),n.decodeValue(t,e),[]}}}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(t){return 0===t.length?"null":`opt ${this._type.valueToString(t[0])}`}}class Dn extends _n{constructor(t={}){super(),this._fields=Object.entries(t).sort(((t,e)=>an(t[0])-an(e[0])))}accept(t,e){return t.visitRecord(this,this._fields,e)}tryAsTuple(){const t=[];for(let e=0;e<this._fields.length;e++){const[n,r]=this._fields[e];if(n!==`_${e}_`)return null;t.push(r)}return t}covariant(t){if("object"==typeof t&&this._fields.every((([e,n])=>{if(!t.hasOwnProperty(e))throw new Error(`Record is missing key "${e}".`);try{return n.covariant(t[e])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nfield ${e} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){const e=this._fields.map((([e])=>t[e])),n=wn(this._fields,e,(([,t],e)=>t.encodeValue(e)));return nn(...n)}_buildTypeTableImpl(t){this._fields.forEach((([e,n])=>n.buildTypeTable(t)));const e=hn(-20),n=fn(this._fields.length),r=this._fields.map((([e,n])=>nn(fn(an(e)),n.encodeType(t))));t.add(this,nn(e,n,nn(...r)))}decodeValue(t,e){const n=this.checkType(e);if(!(n instanceof Dn))throw new Error("Not a record type");const r={};let i=0,o=0;for(;o<n._fields.length;){const[e,s]=n._fields[o];if(i>=this._fields.length){s.decodeValue(t,s),o++;continue}const[a,c]=this._fields[i],u=an(this._fields[i][0]),l=an(e);if(u===l)r[a]=c.decodeValue(t,s),i++,o++;else if(l>u){if(!(c instanceof Un||c instanceof Bn))throw new Error("Cannot find required field "+a);r[a]=[],i++}else s.decodeValue(t,s),o++}for(const[t,e]of this._fields.slice(i)){if(!(e instanceof Un||e instanceof Bn))throw new Error("Cannot find required field "+t);r[t]=[]}return r}get name(){const t=this._fields.map((([t,e])=>t+":"+e.name));return`record {${t.join("; ")}}`}display(){const t=this._fields.map((([t,e])=>t+":"+e.display()));return`record {${t.join("; ")}}`}valueToString(t){const e=this._fields.map((([e])=>t[e])),n=wn(this._fields,e,(([t,e],n)=>t+"="+e.valueToString(n)));return`record {${n.join("; ")}}`}}class Cn extends Dn{constructor(t){const e={};t.forEach(((t,n)=>e["_"+n+"_"]=t)),super(e),this._components=t}accept(t,e){return t.visitTuple(this,this._components,e)}covariant(t){if(Array.isArray(t)&&t.length>=this._fields.length&&this._components.every(((e,n)=>{try{return e.covariant(t[n])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nindex ${n} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){const e=wn(this._components,t,((t,e)=>t.encodeValue(e)));return nn(...e)}decodeValue(t,e){const n=this.checkType(e);if(!(n instanceof Cn))throw new Error("not a tuple type");if(n._components.length<this._components.length)throw new Error("tuple mismatch");const r=[];for(const[e,i]of n._components.entries())e>=this._components.length?i.decodeValue(t,i):r.push(this._components[e].decodeValue(t,i));return r}display(){const t=this._components.map((t=>t.display()));return`record {${t.join("; ")}}`}valueToString(t){const e=wn(this._components,t,((t,e)=>t.valueToString(e)));return`record {${e.join("; ")}}`}}class Fn extends _n{constructor(t={}){super(),this._fields=Object.entries(t).sort(((t,e)=>an(t[0])-an(e[0])))}accept(t,e){return t.visitVariant(this,this._fields,e)}covariant(t){if("object"==typeof t&&1===Object.entries(t).length&&this._fields.every((([e,n])=>{try{return!t.hasOwnProperty(e)||n.covariant(t[e])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nvariant ${e} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){for(let e=0;e<this._fields.length;e++){const[n,r]=this._fields[e];if(t.hasOwnProperty(n)){return nn(fn(e),r.encodeValue(t[n]))}}throw Error("Variant has no data: "+t)}_buildTypeTableImpl(t){this._fields.forEach((([,e])=>{e.buildTypeTable(t)}));const e=hn(-21),n=fn(this._fields.length),r=this._fields.map((([e,n])=>nn(fn(an(e)),n.encodeType(t))));t.add(this,nn(e,n,...r))}decodeValue(t,e){const n=this.checkType(e);if(!(n instanceof Fn))throw new Error("Not a variant type");const r=Number(dn(t));if(r>=n._fields.length)throw Error("Invalid variant index: "+r);const[i,o]=n._fields[r];for(const[e,n]of this._fields)if(an(i)===an(e)){return{[e]:n.decodeValue(t,o)}}throw new Error("Cannot find field hash "+i)}get name(){return`variant {${this._fields.map((([t,e])=>t+":"+e.name)).join("; ")}}`}display(){return`variant {${this._fields.map((([t,e])=>t+("null"===e.name?"":`:${e.display()}`))).join("; ")}}`}valueToString(t){for(const[e,n]of this._fields)if(t.hasOwnProperty(e)){const r=n.valueToString(t[e]);return"null"===r?`variant {${e}}`:`variant {${e}=${r}}`}throw new Error("Variant has no data: "+t)}}class Mn extends _n{constructor(){super(...arguments),this._id=Mn._counter++,this._type=void 0}accept(t,e){if(!this._type)throw Error("Recursive type uninitialized.");return t.visitRec(this,this._type,e)}fill(t){this._type=t}getType(){return this._type}covariant(t){if(this._type&&this._type.covariant(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(t)}_buildTypeTableImpl(t){if(!this._type)throw Error("Recursive type uninitialized.");t.add(this,new Uint8Array([])),this._type.buildTypeTable(t),t.merge(this,this._type.name)}decodeValue(t,e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(t,e)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`${this.name}.${this._type.name}`}valueToString(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(t)}}function jn(t){if(1!==ln(t))throw new Error("Cannot decode principal");const e=Number(dn(t));return Ge.fromUint8Array(new Uint8Array(un(t,e)))}Mn._counter=0;class qn extends xn{accept(t,e){return t.visitPrincipal(this,e)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){const e=t.toUint8Array(),n=fn(e.byteLength);return nn(new Uint8Array([1]),n,e)}encodeType(){return hn(-24)}decodeValue(t,e){return this.checkType(e),jn(t)}get name(){return"principal"}valueToString(t){return`${this.name} "${t.toText()}"`}}class Vn extends _n{constructor(t,e,n=[]){super(),this.argTypes=t,this.retTypes=e,this.annotations=n}static argsToString(t,e){if(t.length!==e.length)throw new Error("arity mismatch");return"("+t.map(((t,n)=>t.valueToString(e[n]))).join(", ")+")"}accept(t,e){return t.visitFunc(this,e)}covariant(t){if(Array.isArray(t)&&2===t.length&&t[0]&&t[0]._isPrincipal&&"string"==typeof t[1])return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue([t,e]){const n=t.toUint8Array(),r=fn(n.byteLength),i=nn(new Uint8Array([1]),r,n),o=(new TextEncoder).encode(e),s=fn(o.byteLength);return nn(new Uint8Array([1]),i,s,o)}_buildTypeTableImpl(t){this.argTypes.forEach((e=>e.buildTypeTable(t))),this.retTypes.forEach((e=>e.buildTypeTable(t)));const e=hn(-22),n=fn(this.argTypes.length),r=nn(...this.argTypes.map((e=>e.encodeType(t)))),i=fn(this.retTypes.length),o=nn(...this.retTypes.map((e=>e.encodeType(t)))),s=fn(this.annotations.length),a=nn(...this.annotations.map((t=>this.encodeAnnotation(t))));t.add(this,nn(e,n,r,i,o,s,a))}decodeValue(t){if(1!==ln(t))throw new Error("Cannot decode function reference");const e=jn(t),n=un(t,Number(dn(t)));return[e,new TextDecoder("utf8",{fatal:!0}).decode(n)]}get name(){return`(${this.argTypes.map((t=>t.name)).join(", ")}) -> (${this.retTypes.map((t=>t.name)).join(", ")})${" "+this.annotations.join(" ")}`}valueToString([t,e]){return`func "${t.toText()}".${e}`}display(){return`(${this.argTypes.map((t=>t.display())).join(", ")})  (${this.retTypes.map((t=>t.display())).join(", ")})${" "+this.annotations.join(" ")}`}encodeAnnotation(t){if("query"===t)return new Uint8Array([1]);if("oneway"===t)return new Uint8Array([2]);if("composite_query"===t)return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class zn extends _n{constructor(t){super(),this._fields=Object.entries(t).sort(((t,e)=>t[0]<e[0]?-1:t[0]>e[0]?1:0))}accept(t,e){return t.visitService(this,e)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Hn(t)}`)}encodeValue(t){const e=t.toUint8Array(),n=fn(e.length);return nn(new Uint8Array([1]),n,e)}_buildTypeTableImpl(t){this._fields.forEach((([e,n])=>n.buildTypeTable(t)));const e=hn(-23),n=fn(this._fields.length),r=this._fields.map((([e,n])=>{const r=(new TextEncoder).encode(e);return nn(fn(r.length),r,n.encodeType(t))}));t.add(this,nn(e,n,...r))}decodeValue(t){return jn(t)}get name(){const t=this._fields.map((([t,e])=>t+":"+e.name));return`service {${t.join("; ")}}`}valueToString(t){return`service "${t.toText()}"`}}function Hn(t){const e=JSON.stringify(t,((t,e)=>"bigint"==typeof e?`BigInt(${e})`:e));return e&&e.length>400?e.substring(0,397)+"...":e}function Gn(t,e){if(e.length<t.length)throw Error("Wrong number of message arguments");const n=new vn;t.forEach((t=>t.buildTypeTable(n)));const r=(new TextEncoder).encode(yn),i=n.encode(),o=fn(e.length),s=nn(...t.map((t=>t.encodeType(n)))),a=nn(...wn(t,e,((t,e)=>{try{t.covariant(e)}catch(t){throw new Error(t.message+"\n\n")}return t.encodeValue(e)})));return nn(r,i,o,s,a)}function Kn(t,e){const n=new rn(e);if(e.byteLength<yn.length)throw new Error("Message length smaller than magic number");const r=un(n,yn.length),i=(new TextDecoder).decode(r);if(i!==yn)throw new Error("Wrong magic number: "+JSON.stringify(i));const[o,s]=function(t){const e=[],n=Number(dn(t));for(let r=0;r<n;r++){const n=Number(pn(t));switch(n){case-18:case-19:{const r=Number(pn(t));e.push([n,r]);break}case-20:case-21:{const r=[];let i,o=Number(dn(t));for(;o--;){const e=Number(dn(t));if(e>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if("number"==typeof i&&i>=e)throw new Error("field id collision or not sorted");i=e;const n=Number(pn(t));r.push([e,n])}e.push([n,r]);break}case-22:{const r=[];let i=Number(dn(t));for(;i--;)r.push(Number(pn(t)));const o=[];let s=Number(dn(t));for(;s--;)o.push(Number(pn(t)));const a=[];let c=Number(dn(t));for(;c--;){switch(Number(dn(t))){case 1:a.push("query");break;case 2:a.push("oneway");break;case 3:a.push("composite_query");break;default:throw new Error("unknown annotation")}}e.push([n,[r,o,a]]);break}case-23:{let r=Number(dn(t));const i=[];for(;r--;){const e=Number(dn(t)),n=(new TextDecoder).decode(un(t,e)),r=pn(t);i.push([n,r])}e.push([n,i]);break}default:throw new Error("Illegal op_code: "+n)}}const r=[],i=Number(dn(t));for(let e=0;e<i;e++)r.push(Number(pn(t)));return[e,r]}(n);if(s.length<t.length)throw new Error("Wrong number of return values");const a=o.map((t=>yr()));function c(t){if(t<-24)throw new Error("future value not supported");if(t<0)switch(t){case-1:return Jn;case-2:return Xn;case-3:return er;case-4:return tr;case-5:return cr;case-6:return ur;case-7:return lr;case-8:return fr;case-9:return ir;case-10:return or;case-11:return sr;case-12:return ar;case-13:return nr;case-14:return rr;case-15:return Qn;case-16:return Zn;case-17:return Wn;case-24:return dr;default:throw new Error("Illegal op_code: "+t)}if(t>=o.length)throw new Error("type index out of range");return a[t]}function u(t){switch(t[0]){case-19:return pr(c(t[1]));case-18:return gr(c(t[1]));case-20:{const e={};for(const[n,r]of t[1]){e[`_${n}_`]=c(r)}const n=mr(e),r=n.tryAsTuple();return Array.isArray(r)?hr(...r):n}case-21:{const e={};for(const[n,r]of t[1]){e[`_${n}_`]=c(r)}return br(e)}case-22:{const[e,n,r]=t[1];return wr(e.map((t=>c(t))),n.map((t=>c(t))),r)}case-23:{const e={},n=t[1];for(const[t,r]of n){let n=c(r);if(n instanceof Mn&&(n=n.getType()),!(n instanceof Vn))throw new Error("Illegal service definition: services can only contain functions");e[t]=n}return vr(e)}default:throw new Error("Illegal op_code: "+t[0])}}o.forEach(((t,e)=>{if(-22===t[0]){const n=u(t);a[e].fill(n)}})),o.forEach(((t,e)=>{if(-22!==t[0]){const n=u(t);a[e].fill(n)}}));const l=s.map((t=>c(t))),f=t.map(((t,e)=>t.decodeValue(n,l[e])));for(let e=t.length;e<l.length;e++)l[e].decodeValue(n,l[e]);if(n.byteLength>0)throw new Error("decode: Left-over bytes");return f}const Wn=new An,Zn=new Bn,Yn=new Tn,Xn=new Sn,Jn=new Nn,Qn=new In,tr=new On,er=new Rn,nr=new $n(32),rr=new $n(64),ir=new kn(8),or=new kn(16),sr=new kn(32),ar=new kn(64),cr=new Ln(8),ur=new Ln(16),lr=new Ln(32),fr=new Ln(64),dr=new qn;function hr(...t){return new Cn(t)}function pr(t){return new Pn(t)}function gr(t){return new Un(t)}function mr(t){return new Dn(t)}function br(t){return new Fn(t)}function yr(){return new Mn}function wr(t,e,n=[]){return new Vn(t,e,n)}function vr(t){return new zn(t)}var Er=Object.freeze({__proto__:null,Bool:Xn,BoolClass:Sn,ConstructType:_n,Empty:Wn,EmptyClass:An,FixedIntClass:kn,FixedNatClass:Ln,Float32:nr,Float64:rr,FloatClass:$n,Func:wr,FuncClass:Vn,Int:tr,Int16:or,Int32:sr,Int64:ar,Int8:ir,IntClass:On,Nat:er,Nat16:ur,Nat32:lr,Nat64:fr,Nat8:cr,NatClass:Rn,Null:Jn,NullClass:Nn,Opt:gr,OptClass:Un,PrimitiveType:xn,Principal:dr,PrincipalClass:qn,Rec:yr,RecClass:Mn,Record:mr,RecordClass:Dn,Reserved:Zn,ReservedClass:Bn,Service:vr,ServiceClass:zn,Text:Qn,TextClass:In,Tuple:hr,TupleClass:Cn,Type:En,Unknown:Yn,UnknownClass:Tn,Variant:br,VariantClass:Fn,Vec:pr,VecClass:Pn,Visitor:class{visitType(t,e){throw new Error("Not implemented")}visitPrimitive(t,e){return this.visitType(t,e)}visitEmpty(t,e){return this.visitPrimitive(t,e)}visitBool(t,e){return this.visitPrimitive(t,e)}visitNull(t,e){return this.visitPrimitive(t,e)}visitReserved(t,e){return this.visitPrimitive(t,e)}visitText(t,e){return this.visitPrimitive(t,e)}visitNumber(t,e){return this.visitPrimitive(t,e)}visitInt(t,e){return this.visitNumber(t,e)}visitNat(t,e){return this.visitNumber(t,e)}visitFloat(t,e){return this.visitPrimitive(t,e)}visitFixedInt(t,e){return this.visitNumber(t,e)}visitFixedNat(t,e){return this.visitNumber(t,e)}visitPrincipal(t,e){return this.visitPrimitive(t,e)}visitConstruct(t,e){return this.visitType(t,e)}visitVec(t,e,n){return this.visitConstruct(t,n)}visitOpt(t,e,n){return this.visitConstruct(t,n)}visitRecord(t,e,n){return this.visitConstruct(t,n)}visitTuple(t,e,n){const r=e.map(((t,e)=>[`_${e}_`,t]));return this.visitRecord(t,r,n)}visitVariant(t,e,n){return this.visitConstruct(t,n)}visitRec(t,e,n){return this.visitConstruct(e,n)}visitFunc(t,e){return this.visitConstruct(t,e)}visitService(t,e){return this.visitConstruct(t,e)}},decode:Kn,encode:Gn}),xr={},_r={};!function(t){var e=Ft,n=Wt,r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=function(t){+t!=t&&(t=0);return s.alloc(+t)},t.INSPECT_MAX_BYTES=50;var i=2147483647;function o(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return a(t,e,n)}function a(t,e,n){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|h(t,e),r=o(n),i=r.write(t,e);i!==n&&(r=r.slice(0,i));return r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(F(t,Uint8Array)){var e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(F(t,ArrayBuffer)||t&&F(t.buffer,ArrayBuffer))return f(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(F(t,SharedArrayBuffer)||t&&F(t.buffer,SharedArrayBuffer)))return f(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return s.from(r,e,n);var i=function(t){if(s.isBuffer(t)){var e=0|d(t.length),n=o(e);return 0===n.length||t.copy(n,0,0,e),n}if(void 0!==t.length)return"number"!=typeof t.length||M(t.length)?o(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return c(t),o(t<0?0:0|d(t))}function l(t){for(var e=t.length<0?0:0|d(t.length),n=o(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function f(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,s.prototype),r}function d(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function h(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||F(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return U(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return D(t).length;default:if(i)return r?-1:U(t).length;e=(""+e).toLowerCase(),i=!0}}function p(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return B(this,e,n);case"utf8":case"utf-8":return A(this,e,n);case"ascii":return S(this,e,n);case"latin1":case"binary":return N(this,e,n);case"base64":return _(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),M(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=s.from(e,r)),s.isBuffer(e))return 0===e.length?-1:b(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,r,i){var o,s=1,a=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=n;o<a;o++)if(u(t,o)===u(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){for(var f=!0,d=0;d<c;d++)if(u(t,o+d)!==u(e,d)){f=!1;break}if(f)return o}return-1}function y(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(M(a))return s;t[n+s]=a}return s}function w(t,e,n,r){return C(U(e,t.length-n),t,n,r)}function v(t,e,n,r){return C(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function E(t,e,n,r){return C(D(e),t,n,r)}function x(t,e,n,r){return C(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function _(t,n,r){return 0===n&&r===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(n,r))}function A(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,c,u=t[i],l=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f<=n)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(t){var e=t.length;if(e<=T)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=T));return n}(r)}t.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,n){return a(t,e,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,n){return function(t,e,n){return c(t),t<=0?o(t):void 0!==e?"string"==typeof n?o(t).fill(e,n):o(t).fill(e):o(t)}(t,e,n)},s.allocUnsafe=function(t){return u(t)},s.allocUnsafeSlow=function(t){return u(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(F(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),F(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=s.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(F(o,Uint8Array))i+o.length>r.length?s.from(o).copy(r,i):Uint8Array.prototype.set.call(r,o,i);else{if(!s.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i)}i+=o.length}return r},s.byteLength=h,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},s.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},s.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},s.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?A(this,0,t):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(t,e,n,r,i){if(F(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),c=Math.min(o,a),u=this.slice(r,i),l=t.slice(e,n),f=0;f<c;++f)if(u[f]!==l[f]){o=u[f],a=l[f];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},s.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},s.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},s.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return y(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":case"latin1":case"binary":return v(this,t,e,n);case"base64":return E(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function S(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function N(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function B(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=j[t[o]];return i}function I(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function O(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,n,r,i,o){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function $(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function k(t,e,r,i,o){return e=+e,r>>>=0,o||$(t,0,r,4),n.write(t,e,r,i,23,4),r+4}function L(t,e,r,i,o){return e=+e,r>>>=0,o||$(t,0,r,8),n.write(t,e,r,i,52,8),r+8}s.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return Object.setPrototypeOf(r,s.prototype),r},s.prototype.readUintLE=s.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},s.prototype.readUintBE=s.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},s.prototype.readUint8=s.prototype.readUInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},s.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},s.prototype.readInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||O(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(t,e){t>>>=0,e||O(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readFloatLE=function(t,e){return t>>>=0,e||O(t,4,this.length),n.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||O(t,4,this.length),n.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||O(t,8,this.length),n.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||O(t,8,this.length),n.read(this,t,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e>>>=0,n>>>=0,r)||R(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e>>>=0,n>>>=0,r)||R(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},s.prototype.writeUint8=s.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);R(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},s.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);R(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},s.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeFloatLE=function(t,e,n){return k(this,t,e,!0,n)},s.prototype.writeFloatBE=function(t,e,n){return k(this,t,e,!1,n)},s.prototype.writeDoubleLE=function(t,e,n){return L(this,t,e,!0,n)},s.prototype.writeDoubleBE=function(t,e,n){return L(this,t,e,!1,n)},s.prototype.copy=function(t,e,n,r){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),i},s.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var i=t.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=s.isBuffer(t)?t:s.from(t,r),c=a.length;if(0===c)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=a[o%c]}return this};var P=/[^+/0-9A-Za-z-_]/g;function U(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function D(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(P,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function C(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function F(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function M(t){return t!=t}var j=function(){for(var t="0123456789abcdef",e=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)e[r+i]=t[n]+t[i];return e}()}(_r);var Ar,Tr={exports:{}};Ar=Tr,function(t){var e,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,i=Math.floor,o="[BigNumber Error] ",s=o+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,d=1e9;function h(t){var e=0|t;return t>0||t===e?e:e-1}function p(t){for(var e,n,r=1,i=t.length,o=t[0]+"";r<i;){for(e=t[r++]+"",n=c-e.length;n--;e="0"+e);o+=e}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function g(t,e){var n,r,i=t.c,o=e.c,s=t.s,a=e.s,c=t.e,u=e.e;if(!s||!a)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-a:s;if(s!=a)return s;if(n=s<0,r=c==u,!i||!o)return r?0:!i^n?1:-1;if(!r)return c>u^n?1:-1;for(a=(c=i.length)<(u=o.length)?c:u,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^n?1:-1;return c==u?0:c>u^n?1:-1}function m(t,e,n,r){if(t<e||t>n||t!==i(t))throw Error(o+(r||"Argument")+("number"==typeof t?t<e||t>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function b(t){var e=t.c.length-1;return h(t.e/c)==e&&t.c[e]%2!=0}function y(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function w(t,e,n){var r,i;if(e<0){for(i=n+".";++e;i+=n);t=i+t}else if(++e>(r=t.length)){for(i=n,e-=r;--e;i+=n);t+=i}else e<r&&(t=t.slice(0,e)+"."+t.slice(e));return t}e=function t(e){var v,E,x,_,A,T,S,N,B,I,O=z.prototype={constructor:z,toString:null,valueOf:null},R=new z(1),$=20,k=4,L=-7,P=21,U=-1e7,D=1e7,C=!1,F=1,M=0,j={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},q="0123456789abcdefghijklmnopqrstuvwxyz",V=!0;function z(t,e){var r,o,a,l,f,d,h,p,g=this;if(!(g instanceof z))return new z(t,e);if(null==e){if(t&&!0===t._isBigNumber)return g.s=t.s,void(!t.c||t.e>D?g.c=g.e=null:t.e<U?g.c=[g.e=0]:(g.e=t.e,g.c=t.c.slice()));if((d="number"==typeof t)&&0*t==0){if(g.s=1/t<0?(t=-t,-1):1,t===~~t){for(l=0,f=t;f>=10;f/=10,l++);return void(l>D?g.c=g.e=null:(g.e=l,g.c=[t]))}p=String(t)}else{if(!n.test(p=String(t)))return x(g,p,d);g.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(l=p.indexOf("."))>-1&&(p=p.replace(".","")),(f=p.search(/e/i))>0?(l<0&&(l=f),l+=+p.slice(f+1),p=p.substring(0,f)):l<0&&(l=p.length)}else{if(m(e,2,q.length,"Base"),10==e&&V)return W(g=new z(t),$+g.e+1,k);if(p=String(t),d="number"==typeof t){if(0*t!=0)return x(g,p,d,e);if(g.s=1/t<0?(p=p.slice(1),-1):1,z.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(s+t)}else g.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=q.slice(0,e),l=f=0,h=p.length;f<h;f++)if(r.indexOf(o=p.charAt(f))<0){if("."==o){if(f>l){l=h;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,f=-1,l=0;continue}return x(g,String(t),d,e)}d=!1,(l=(p=E(p,e,10,g.s)).indexOf("."))>-1?p=p.replace(".",""):l=p.length}for(f=0;48===p.charCodeAt(f);f++);for(h=p.length;48===p.charCodeAt(--h););if(p=p.slice(f,++h)){if(h-=f,d&&z.DEBUG&&h>15&&(t>u||t!==i(t)))throw Error(s+g.s*t);if((l=l-f-1)>D)g.c=g.e=null;else if(l<U)g.c=[g.e=0];else{if(g.e=l,g.c=[],f=(l+1)%c,l<0&&(f+=c),f<h){for(f&&g.c.push(+p.slice(0,f)),h-=c;f<h;)g.c.push(+p.slice(f,f+=c));f=c-(p=p.slice(f)).length}else f-=h;for(;f--;p+="0");g.c.push(+p)}}else g.c=[g.e=0]}function H(t,e,n,r){var i,o,s,a,c;if(null==n?n=k:m(n,0,8),!t.c)return t.toString();if(i=t.c[0],s=t.e,null==e)c=p(t.c),c=1==r||2==r&&(s<=L||s>=P)?y(c,s):w(c,s,"0");else if(o=(t=W(new z(t),e,n)).e,a=(c=p(t.c)).length,1==r||2==r&&(e<=o||o<=L)){for(;a<e;c+="0",a++);c=y(c,o)}else if(e-=s,c=w(c,o,"0"),o+1>a){if(--e>0)for(c+=".";e--;c+="0");}else if((e+=o-a)>0)for(o+1==a&&(c+=".");e--;c+="0");return t.s<0&&i?"-"+c:c}function G(t,e){for(var n,r=1,i=new z(t[0]);r<t.length;r++){if(!(n=new z(t[r])).s){i=n;break}e.call(i,n)&&(i=n)}return i}function K(t,e,n){for(var r=1,i=e.length;!e[--i];e.pop());for(i=e[0];i>=10;i/=10,r++);return(n=r+n*c-1)>D?t.c=t.e=null:n<U?t.c=[t.e=0]:(t.e=n,t.c=e),t}function W(t,e,n,o){var s,u,f,d,h,p,g,m=t.c,b=l;if(m){t:{for(s=1,d=m[0];d>=10;d/=10,s++);if((u=e-s)<0)u+=c,f=e,g=(h=m[p=0])/b[s-f-1]%10|0;else if((p=r((u+1)/c))>=m.length){if(!o)break t;for(;m.length<=p;m.push(0));h=g=0,s=1,f=(u%=c)-c+1}else{for(h=d=m[p],s=1;d>=10;d/=10,s++);g=(f=(u%=c)-c+s)<0?0:h/b[s-f-1]%10|0}if(o=o||e<0||null!=m[p+1]||(f<0?h:h%b[s-f-1]),o=n<4?(g||o)&&(0==n||n==(t.s<0?3:2)):g>5||5==g&&(4==n||o||6==n&&(u>0?f>0?h/b[s-f]:0:m[p-1])%10&1||n==(t.s<0?8:7)),e<1||!m[0])return m.length=0,o?(e-=t.e+1,m[0]=b[(c-e%c)%c],t.e=-e||0):m[0]=t.e=0,t;if(0==u?(m.length=p,d=1,p--):(m.length=p+1,d=b[c-u],m[p]=f>0?i(h/b[s-f]%b[f])*d:0),o)for(;;){if(0==p){for(u=1,f=m[0];f>=10;f/=10,u++);for(f=m[0]+=d,d=1;f>=10;f/=10,d++);u!=d&&(t.e++,m[0]==a&&(m[0]=1));break}if(m[p]+=d,m[p]!=a)break;m[p--]=0,d=1}for(u=m.length;0===m[--u];m.pop());}t.e>D?t.c=t.e=null:t.e<U&&(t.c=[t.e=0])}return t}function Z(t){var e,n=t.e;return null===n?t.toString():(e=p(t.c),e=n<=L||n>=P?y(e,n):w(e,n,"0"),t.s<0?"-"+e:e)}return z.clone=t,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(t){var e,n;if(null!=t){if("object"!=typeof t)throw Error(o+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(m(n=t[e],0,d,e),$=n),t.hasOwnProperty(e="ROUNDING_MODE")&&(m(n=t[e],0,8,e),k=n),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((n=t[e])&&n.pop?(m(n[0],-d,0,e),m(n[1],0,d,e),L=n[0],P=n[1]):(m(n,-d,d,e),L=-(P=n<0?-n:n))),t.hasOwnProperty(e="RANGE"))if((n=t[e])&&n.pop)m(n[0],-d,-1,e),m(n[1],1,d,e),U=n[0],D=n[1];else{if(m(n,-d,d,e),!n)throw Error(o+e+" cannot be zero: "+n);U=-(D=n<0?-n:n)}if(t.hasOwnProperty(e="CRYPTO")){if((n=t[e])!==!!n)throw Error(o+e+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw C=!n,Error(o+"crypto unavailable");C=n}else C=n}if(t.hasOwnProperty(e="MODULO_MODE")&&(m(n=t[e],0,9,e),F=n),t.hasOwnProperty(e="POW_PRECISION")&&(m(n=t[e],0,d,e),M=n),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(n=t[e]))throw Error(o+e+" not an object: "+n);j=n}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(n=t[e])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(o+e+" invalid: "+n);V="0123456789"==n.slice(0,10),q=n}}return{DECIMAL_PLACES:$,ROUNDING_MODE:k,EXPONENTIAL_AT:[L,P],RANGE:[U,D],CRYPTO:C,MODULO_MODE:F,POW_PRECISION:M,FORMAT:j,ALPHABET:q}},z.isBigNumber=function(t){if(!t||!0!==t._isBigNumber)return!1;if(!z.DEBUG)return!0;var e,n,r=t.c,s=t.e,u=t.s;t:if("[object Array]"=={}.toString.call(r)){if((1===u||-1===u)&&s>=-d&&s<=d&&s===i(s)){if(0===r[0]){if(0===s&&1===r.length)return!0;break t}if((e=(s+1)%c)<1&&(e+=c),String(r[0]).length==e){for(e=0;e<r.length;e++)if((n=r[e])<0||n>=a||n!==i(n))break t;if(0!==n)return!0}}}else if(null===r&&null===s&&(null===u||1===u||-1===u))return!0;throw Error(o+"Invalid BigNumber: "+t)},z.maximum=z.max=function(){return G(arguments,O.lt)},z.minimum=z.min=function(){return G(arguments,O.gt)},z.random=(_=9007199254740992,A=Math.random()*_&2097151?function(){return i(Math.random()*_)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,n,s,a,u,f=0,h=[],p=new z(R);if(null==t?t=$:m(t,0,d),a=r(t/c),C)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(a*=2));f<a;)(u=131072*e[f]+(e[f+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),e[f]=n[0],e[f+1]=n[1]):(h.push(u%1e14),f+=2);f=a/2}else{if(!crypto.randomBytes)throw C=!1,Error(o+"crypto unavailable");for(e=crypto.randomBytes(a*=7);f<a;)(u=281474976710656*(31&e[f])+1099511627776*e[f+1]+4294967296*e[f+2]+16777216*e[f+3]+(e[f+4]<<16)+(e[f+5]<<8)+e[f+6])>=9e15?crypto.randomBytes(7).copy(e,f):(h.push(u%1e14),f+=7);f=a/7}if(!C)for(;f<a;)(u=A())<9e15&&(h[f++]=u%1e14);for(a=h[--f],t%=c,a&&t&&(u=l[c-t],h[f]=i(a/u)*u);0===h[f];h.pop(),f--);if(f<0)h=[s=0];else{for(s=-1;0===h[0];h.splice(0,1),s-=c);for(f=1,u=h[0];u>=10;u/=10,f++);f<c&&(s-=c-f)}return p.e=s,p.c=h,p}),z.sum=function(){for(var t=1,e=arguments,n=new z(e[0]);t<e.length;)n=n.plus(e[t++]);return n},E=function(){var t="0123456789";function e(t,e,n,r){for(var i,o,s=[0],a=0,c=t.length;a<c;){for(o=s.length;o--;s[o]*=e);for(s[0]+=r.indexOf(t.charAt(a++)),i=0;i<s.length;i++)s[i]>n-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/n|0,s[i]%=n)}return s.reverse()}return function(n,r,i,o,s){var a,c,u,l,f,d,h,g,m=n.indexOf("."),b=$,y=k;for(m>=0&&(l=M,M=0,n=n.replace(".",""),d=(g=new z(r)).pow(n.length-m),M=l,g.c=e(w(p(d.c),d.e,"0"),10,i,t),g.e=g.c.length),u=l=(h=e(n,r,i,s?(a=q,t):(a=t,q))).length;0==h[--l];h.pop());if(!h[0])return a.charAt(0);if(m<0?--u:(d.c=h,d.e=u,d.s=o,h=(d=v(d,g,b,y,i)).c,f=d.r,u=d.e),m=h[c=u+b+1],l=i/2,f=f||c<0||null!=h[c+1],f=y<4?(null!=m||f)&&(0==y||y==(d.s<0?3:2)):m>l||m==l&&(4==y||f||6==y&&1&h[c-1]||y==(d.s<0?8:7)),c<1||!h[0])n=f?w(a.charAt(1),-b,a.charAt(0)):a.charAt(0);else{if(h.length=c,f)for(--i;++h[--c]>i;)h[c]=0,c||(++u,h=[1].concat(h));for(l=h.length;!h[--l];);for(m=0,n="";m<=l;n+=a.charAt(h[m++]));n=w(n,u,a.charAt(0))}return n}}(),v=function(){function t(t,e,n){var r,i,o,s,a=0,c=t.length,u=e%f,l=e/f|0;for(t=t.slice();c--;)a=((i=u*(o=t[c]%f)+(r=l*o+(s=t[c]/f|0)*u)%f*f+a)/n|0)+(r/f|0)+l*s,t[c]=i%n;return a&&(t=[a].concat(t)),t}function e(t,e,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(t[i]!=e[i]){o=t[i]>e[i]?1:-1;break}return o}function n(t,e,n,r){for(var i=0;n--;)t[n]-=i,i=t[n]<e[n]?1:0,t[n]=i*r+t[n]-e[n];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(r,o,s,u,l){var f,d,p,g,m,b,y,w,v,E,x,_,A,T,S,N,B,I=r.s==o.s?1:-1,O=r.c,R=o.c;if(!(O&&O[0]&&R&&R[0]))return new z(r.s&&o.s&&(O?!R||O[0]!=R[0]:R)?O&&0==O[0]||!R?0*I:I/0:NaN);for(v=(w=new z(I)).c=[],I=s+(d=r.e-o.e)+1,l||(l=a,d=h(r.e/c)-h(o.e/c),I=I/c|0),p=0;R[p]==(O[p]||0);p++);if(R[p]>(O[p]||0)&&d--,I<0)v.push(1),g=!0;else{for(T=O.length,N=R.length,p=0,I+=2,(m=i(l/(R[0]+1)))>1&&(R=t(R,m,l),O=t(O,m,l),N=R.length,T=O.length),A=N,x=(E=O.slice(0,N)).length;x<N;E[x++]=0);B=R.slice(),B=[0].concat(B),S=R[0],R[1]>=l/2&&S++;do{if(m=0,(f=e(R,E,N,x))<0){if(_=E[0],N!=x&&(_=_*l+(E[1]||0)),(m=i(_/S))>1)for(m>=l&&(m=l-1),y=(b=t(R,m,l)).length,x=E.length;1==e(b,E,y,x);)m--,n(b,N<y?B:R,y,l),y=b.length,f=1;else 0==m&&(f=m=1),y=(b=R.slice()).length;if(y<x&&(b=[0].concat(b)),n(E,b,x,l),x=E.length,-1==f)for(;e(R,E,N,x)<1;)m++,n(E,N<x?B:R,x,l),x=E.length}else 0===f&&(m++,E=[0]);v[p++]=m,E[0]?E[x++]=O[A]||0:(E=[O[A]],x=1)}while((A++<T||null!=E[0])&&I--);g=null!=E[0],v[0]||v.splice(0,1)}if(l==a){for(p=1,I=v[0];I>=10;I/=10,p++);W(w,s+(w.e=p+d*c-1)+1,u,g)}else w.e=d,w.r=+g;return w}}(),T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,N=/^\.([^.]+)$/,B=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g,x=function(t,e,n,r){var i,s=n?e:e.replace(I,"");if(B.test(s))t.s=isNaN(s)?null:s<0?-1:1;else{if(!n&&(s=s.replace(T,(function(t,e,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?t:e})),r&&(i=r,s=s.replace(S,"$1").replace(N,"0.$1")),e!=s))return new z(s,i);if(z.DEBUG)throw Error(o+"Not a"+(r?" base "+r:"")+" number: "+e);t.s=null}t.c=t.e=null},O.absoluteValue=O.abs=function(){var t=new z(this);return t.s<0&&(t.s=1),t},O.comparedTo=function(t,e){return g(this,new z(t,e))},O.decimalPlaces=O.dp=function(t,e){var n,r,i,o=this;if(null!=t)return m(t,0,d),null==e?e=k:m(e,0,8),W(new z(o),t+o.e+1,e);if(!(n=o.c))return null;if(r=((i=n.length-1)-h(this.e/c))*c,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},O.dividedBy=O.div=function(t,e){return v(this,new z(t,e),$,k)},O.dividedToIntegerBy=O.idiv=function(t,e){return v(this,new z(t,e),0,1)},O.exponentiatedBy=O.pow=function(t,e){var n,s,a,u,l,f,d,h,p=this;if((t=new z(t)).c&&!t.isInteger())throw Error(o+"Exponent not an integer: "+Z(t));if(null!=e&&(e=new z(e)),l=t.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!t.c||!t.c[0])return h=new z(Math.pow(+Z(p),l?2-b(t):+Z(t))),e?h.mod(e):h;if(f=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new z(NaN);(s=!f&&p.isInteger()&&e.isInteger())&&(p=p.mod(e))}else{if(t.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||l&&p.c[1]>=24e7:p.c[0]<8e13||l&&p.c[0]<=9999975e7)))return u=p.s<0&&b(t)?-0:0,p.e>-1&&(u=1/u),new z(f?1/u:u);M&&(u=r(M/c+2))}for(l?(n=new z(.5),f&&(t.s=1),d=b(t)):d=(a=Math.abs(+Z(t)))%2,h=new z(R);;){if(d){if(!(h=h.times(p)).c)break;u?h.c.length>u&&(h.c.length=u):s&&(h=h.mod(e))}if(a){if(0===(a=i(a/2)))break;d=a%2}else if(W(t=t.times(n),t.e+1,1),t.e>14)d=b(t);else{if(0==(a=+Z(t)))break;d=a%2}p=p.times(p),u?p.c&&p.c.length>u&&(p.c.length=u):s&&(p=p.mod(e))}return s?h:(f&&(h=R.div(h)),e?h.mod(e):u?W(h,M,k,void 0):h)},O.integerValue=function(t){var e=new z(this);return null==t?t=k:m(t,0,8),W(e,e.e+1,t)},O.isEqualTo=O.eq=function(t,e){return 0===g(this,new z(t,e))},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(t,e){return g(this,new z(t,e))>0},O.isGreaterThanOrEqualTo=O.gte=function(t,e){return 1===(e=g(this,new z(t,e)))||0===e},O.isInteger=function(){return!!this.c&&h(this.e/c)>this.c.length-2},O.isLessThan=O.lt=function(t,e){return g(this,new z(t,e))<0},O.isLessThanOrEqualTo=O.lte=function(t,e){return-1===(e=g(this,new z(t,e)))||0===e},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&0==this.c[0]},O.minus=function(t,e){var n,r,i,o,s=this,u=s.s;if(e=(t=new z(t,e)).s,!u||!e)return new z(NaN);if(u!=e)return t.s=-e,s.plus(t);var l=s.e/c,f=t.e/c,d=s.c,p=t.c;if(!l||!f){if(!d||!p)return d?(t.s=-e,t):new z(p?s:NaN);if(!d[0]||!p[0])return p[0]?(t.s=-e,t):new z(d[0]?s:3==k?-0:0)}if(l=h(l),f=h(f),d=d.slice(),u=l-f){for((o=u<0)?(u=-u,i=d):(f=l,i=p),i.reverse(),e=u;e--;i.push(0));i.reverse()}else for(r=(o=(u=d.length)<(e=p.length))?u:e,u=e=0;e<r;e++)if(d[e]!=p[e]){o=d[e]<p[e];break}if(o&&(i=d,d=p,p=i,t.s=-t.s),(e=(r=p.length)-(n=d.length))>0)for(;e--;d[n++]=0);for(e=a-1;r>u;){if(d[--r]<p[r]){for(n=r;n&&!d[--n];d[n]=e);--d[n],d[r]+=a}d[r]-=p[r]}for(;0==d[0];d.splice(0,1),--f);return d[0]?K(t,d,f):(t.s=3==k?-1:1,t.c=[t.e=0],t)},O.modulo=O.mod=function(t,e){var n,r,i=this;return t=new z(t,e),!i.c||!t.s||t.c&&!t.c[0]?new z(NaN):!t.c||i.c&&!i.c[0]?new z(i):(9==F?(r=t.s,t.s=1,n=v(i,t,0,3),t.s=r,n.s*=r):n=v(i,t,0,F),(t=i.minus(n.times(t))).c[0]||1!=F||(t.s=i.s),t)},O.multipliedBy=O.times=function(t,e){var n,r,i,o,s,u,l,d,p,g,m,b,y,w,v,E=this,x=E.c,_=(t=new z(t,e)).c;if(!(x&&_&&x[0]&&_[0]))return!E.s||!t.s||x&&!x[0]&&!_||_&&!_[0]&&!x?t.c=t.e=t.s=null:(t.s*=E.s,x&&_?(t.c=[0],t.e=0):t.c=t.e=null),t;for(r=h(E.e/c)+h(t.e/c),t.s*=E.s,(l=x.length)<(g=_.length)&&(y=x,x=_,_=y,i=l,l=g,g=i),i=l+g,y=[];i--;y.push(0));for(w=a,v=f,i=g;--i>=0;){for(n=0,m=_[i]%v,b=_[i]/v|0,o=i+(s=l);o>i;)n=((d=m*(d=x[--s]%v)+(u=b*d+(p=x[s]/v|0)*m)%v*v+y[o]+n)/w|0)+(u/v|0)+b*p,y[o--]=d%w;y[o]=n}return n?++r:y.splice(0,1),K(t,y,r)},O.negated=function(){var t=new z(this);return t.s=-t.s||null,t},O.plus=function(t,e){var n,r=this,i=r.s;if(e=(t=new z(t,e)).s,!i||!e)return new z(NaN);if(i!=e)return t.s=-e,r.minus(t);var o=r.e/c,s=t.e/c,u=r.c,l=t.c;if(!o||!s){if(!u||!l)return new z(i/0);if(!u[0]||!l[0])return l[0]?t:new z(u[0]?r:0*i)}if(o=h(o),s=h(s),u=u.slice(),i=o-s){for(i>0?(s=o,n=l):(i=-i,n=u),n.reverse();i--;n.push(0));n.reverse()}for((i=u.length)-(e=l.length)<0&&(n=l,l=u,u=n,e=i),i=0;e;)i=(u[--e]=u[e]+l[e]+i)/a|0,u[e]=a===u[e]?0:u[e]%a;return i&&(u=[i].concat(u),++s),K(t,u,s)},O.precision=O.sd=function(t,e){var n,r,i,o=this;if(null!=t&&t!==!!t)return m(t,1,d),null==e?e=k:m(e,0,8),W(new z(o),t,e);if(!(n=o.c))return null;if(r=(i=n.length-1)*c+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return t&&o.e+1>r&&(r=o.e+1),r},O.shiftedBy=function(t){return m(t,-9007199254740991,u),this.times("1e"+t)},O.squareRoot=O.sqrt=function(){var t,e,n,r,i,o=this,s=o.c,a=o.s,c=o.e,u=$+4,l=new z("0.5");if(1!==a||!s||!s[0])return new z(!a||a<0&&(!s||s[0])?NaN:s?o:1/0);if(0==(a=Math.sqrt(+Z(o)))||a==1/0?(((e=p(s)).length+c)%2==0&&(e+="0"),a=Math.sqrt(+e),c=h((c+1)/2)-(c<0||c%2),n=new z(e=a==1/0?"5e"+c:(e=a.toExponential()).slice(0,e.indexOf("e")+1)+c)):n=new z(a+""),n.c[0])for((a=(c=n.e)+u)<3&&(a=0);;)if(i=n,n=l.times(i.plus(v(o,i,u,1))),p(i.c).slice(0,a)===(e=p(n.c)).slice(0,a)){if(n.e<c&&--a,"9999"!=(e=e.slice(a-3,a+1))&&(r||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(W(n,n.e+$+2,1),t=!n.times(n).eq(o));break}if(!r&&(W(i,i.e+$+2,0),i.times(i).eq(o))){n=i;break}u+=4,a+=4,r=1}return W(n,n.e+$+1,k,t)},O.toExponential=function(t,e){return null!=t&&(m(t,0,d),t++),H(this,t,e,1)},O.toFixed=function(t,e){return null!=t&&(m(t,0,d),t=t+this.e+1),H(this,t,e)},O.toFormat=function(t,e,n){var r,i=this;if(null==n)null!=t&&e&&"object"==typeof e?(n=e,e=null):t&&"object"==typeof t?(n=t,t=e=null):n=j;else if("object"!=typeof n)throw Error(o+"Argument not an object: "+n);if(r=i.toFixed(t,e),i.c){var s,a=r.split("."),c=+n.groupSize,u=+n.secondaryGroupSize,l=n.groupSeparator||"",f=a[0],d=a[1],h=i.s<0,p=h?f.slice(1):f,g=p.length;if(u&&(s=c,c=u,u=s,g-=s),c>0&&g>0){for(s=g%c||c,f=p.substr(0,s);s<g;s+=c)f+=l+p.substr(s,c);u>0&&(f+=l+p.slice(s)),h&&(f="-"+f)}r=d?f+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?d.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):d):f}return(n.prefix||"")+r+(n.suffix||"")},O.toFraction=function(t){var e,n,r,i,s,a,u,f,d,h,g,m,b=this,y=b.c;if(null!=t&&(!(u=new z(t)).isInteger()&&(u.c||1!==u.s)||u.lt(R)))throw Error(o+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+Z(u));if(!y)return new z(b);for(e=new z(R),d=n=new z(R),r=f=new z(R),m=p(y),s=e.e=m.length-b.e-1,e.c[0]=l[(a=s%c)<0?c+a:a],t=!t||u.comparedTo(e)>0?s>0?e:d:u,a=D,D=1/0,u=new z(m),f.c[0]=0;h=v(u,e,0,1),1!=(i=n.plus(h.times(r))).comparedTo(t);)n=r,r=i,d=f.plus(h.times(i=d)),f=i,e=u.minus(h.times(i=e)),u=i;return i=v(t.minus(n),r,0,1),f=f.plus(i.times(d)),n=n.plus(i.times(r)),f.s=d.s=b.s,g=v(d,r,s*=2,k).minus(b).abs().comparedTo(v(f,n,s,k).minus(b).abs())<1?[d,r]:[f,n],D=a,g},O.toNumber=function(){return+Z(this)},O.toPrecision=function(t,e){return null!=t&&m(t,1,d),H(this,t,e,2)},O.toString=function(t){var e,n=this,r=n.s,i=n.e;return null===i?r?(e="Infinity",r<0&&(e="-"+e)):e="NaN":(null==t?e=i<=L||i>=P?y(p(n.c),i):w(p(n.c),i,"0"):10===t&&V?e=w(p((n=W(new z(n),$+i+1,k)).c),n.e,"0"):(m(t,2,q.length,"Base"),e=E(w(p(n.c),i,"0"),10,t,r,!0)),r<0&&n.c[0]&&(e="-"+e)),e},O.valueOf=O.toJSON=function(){return Z(this)},O._isBigNumber=!0,null!=e&&z.set(e),z}(),e.default=e.BigNumber=e,Ar.exports?Ar.exports=e:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=e)}(Ut);var Sr=Tr.exports,Nr={},Br={};const Ir=Sr.BigNumber;Br.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},Br.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36},Br.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},Br.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},Br.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")},Br.SHIFT32=Math.pow(2,32),Br.SHIFT16=Math.pow(2,16),Br.MAX_SAFE_HIGH=2097151,Br.NEG_ONE=new Ir(-1),Br.TEN=new Ir(10),Br.TWO=new Ir(2),Br.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5},function(t){const{Buffer:e}=_r,n=Sr.BigNumber,r=Br,i=r.SHIFT32,o=r.SHIFT16;t.parseHalf=function(t){var e,n,r;return r=128&t[0]?-1:1,e=(124&t[0])>>2,n=(3&t[0])<<8|t[1],e?31===e?r*(n?NaN:Infinity):r*Math.pow(2,e-25)*(1024+n):5.960464477539063e-8*r*n},t.arrayBufferToBignumber=function(t){const e=t.byteLength;let r="";for(let n=0;n<e;n++)r+=(i=t[n])<16?"0"+i.toString(16):i.toString(16);var i;return new n(r,16)},t.buildMap=t=>{const e=new Map,n=Object.keys(t),r=n.length;for(let i=0;i<r;i++)e.set(n[i],t[n[i]]);return e},t.buildInt32=(t,e)=>t*o+e,t.buildInt64=(e,r,o,s)=>{const a=t.buildInt32(e,r),c=t.buildInt32(o,s);return a>2097151?new n(a).times(i).plus(c):a*i+c},t.writeHalf=function(t,n){const r=e.allocUnsafe(4);r.writeFloatBE(n,0);const i=r.readUInt32BE(0);if(0!=(8191&i))return!1;var o=i>>16&32768;const s=i>>23&255,a=8388607&i;if(s>=113&&s<=142)o+=(s-112<<10)+(a>>13);else{if(!(s>=103&&s<113))return!1;if(a&(1<<126-s)-1)return!1;o+=a+8388608>>126-s}return t.writeUInt16BE(o,0),!0},t.keySorter=function(t,e){var n=t[0].byteLength,r=e[0].byteLength;return n>r?1:r>n?-1:t[0].compare(e[0])},t.isNegativeZero=t=>0===t&&1/t<0,t.nextPowerOf2=t=>{let e=0;if(t&&!(t&t-1))return t;for(;0!==t;)t>>=1,e+=1;return 1<<e}}(Nr);const Or=Br,Rr=Or.MT,$r=Or.SIMPLE,kr=Or.SYMS;var Lr=class t{constructor(t){if("number"!=typeof t)throw new Error("Invalid Simple type: "+typeof t);if(t<0||t>255||(0|t)!==t)throw new Error("value must be a small positive integer: "+t);this.value=t}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(t){return t._pushInt(this.value,Rr.SIMPLE_FLOAT)}static isSimple(e){return e instanceof t}static decode(e,n){switch(null==n&&(n=!0),e){case $r.FALSE:return!1;case $r.TRUE:return!0;case $r.NULL:return n?null:kr.NULL;case $r.UNDEFINED:return n?void 0:kr.UNDEFINED;case-1:if(!n)throw new Error("Invalid BREAK");return kr.BREAK;default:return new t(e)}}};var Pr=class t{constructor(t,e,n){if(this.tag=t,this.value=e,this.err=n,"number"!=typeof this.tag)throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(0|this.tag)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(t){return t._pushTag(this.tag),t.pushAny(this.value)}convert(e){var n,r;if("function"!=typeof(r=null!=e?e[this.tag]:void 0)&&"function"!=typeof(r=t["_tag"+this.tag]))return this;try{return r.call(t,this.value)}catch(t){return n=t,this.err=n,this}}};const Ur=self.location?self.location.protocol+"//"+self.location.host:"",Dr=self.URL;var Cr={URLWithLegacySupport:class{constructor(t="",e=Ur){this.super=new Dr(t,e),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(t){this.super.hash=t}set host(t){this.super.host=t}set hostname(t){this.super.hostname=t}set href(t){this.super.href=t}set origin(t){this.super.origin=t}set password(t){this.super.password=t}set pathname(t){this.super.pathname=t}set port(t){this.super.port=t}set protocol(t){this.super.protocol=t}set search(t){this.super.search=t}set searchParams(t){this.super.searchParams=t}set username(t){this.super.username=t}createObjectURL(t){return this.super.createObjectURL(t)}revokeObjectURL(t){this.super.revokeObjectURL(t)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:Ur,format:function(t){if("string"==typeof t){return new Dr(t).toString()}if(!(t instanceof Dr)){const e=t.username&&t.password?`${t.username}:${t.password}@`:"",n=t.auth?t.auth+"@":"",r=t.port?":"+t.port:"",i=t.protocol?t.protocol+"//":"",o=t.host||"",s=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),c=t.hash||"",u=t.pathname||"";return`${i}${e||n}${o||s+r}${t.path||u+a}${c}`}}};const{URLWithLegacySupport:Fr,format:Mr}=Cr;const{URLWithLegacySupport:jr,format:qr,URLSearchParams:Vr,defaultBase:zr}=Cr;var Hr={URL:jr,URLSearchParams:Vr,format:qr,relative:(t,e={},n={},r)=>{let i,o=e.protocol?e.protocol.replace(":",""):"http";o=(n[o]||r||o)+":";try{i=new Fr(t)}catch(t){i={}}const s=Object.assign({},e,{protocol:o||i.protocol,host:e.host||i.host});return new Fr(t,Mr(s)).toString()},defaultBase:zr};const{Buffer:Gr}=_r,Kr=Wt,Wr=Sr.BigNumber,Zr=function(t,e,n){"use asm";var r=new t.Uint8Array(n),i=e.pushInt,o=e.pushInt32,s=e.pushInt32Neg,a=e.pushInt64,c=e.pushInt64Neg,u=e.pushFloat,l=e.pushFloatSingle,f=e.pushFloatDouble,d=e.pushTrue,h=e.pushFalse,p=e.pushUndefined,g=e.pushNull,m=e.pushInfinity,b=e.pushInfinityNeg,y=e.pushNaN,w=e.pushNaNNeg,v=e.pushArrayStart,E=e.pushArrayStartFixed,x=e.pushArrayStartFixed32,_=e.pushArrayStartFixed64,A=e.pushObjectStart,T=e.pushObjectStartFixed,S=e.pushObjectStartFixed32,N=e.pushObjectStartFixed64,B=e.pushByteString,I=e.pushByteStringStart,O=e.pushUtf8String,R=e.pushUtf8StringStart,$=e.pushSimpleUnassigned,k=e.pushTagStart,L=e.pushTagStart4,P=e.pushTagStart8,U=e.pushTagUnassigned,D=e.pushBreak,C=t.Math.pow,F=0,M=0,j=0;function q(t){t=t|0;F=0;M=t;while((F|0)<(M|0)){j=Yt[r[F]&255](r[F]|0)|0;if((j|0)>0){break}}return j|0}function V(t){t=t|0;if(((F|0)+(t|0)|0)<(M|0)){return 0}return 1}function z(t){t=t|0;return r[t|0]<<8|r[t+1|0]|0}function H(t){t=t|0;return r[t|0]<<24|r[t+1|0]<<16|r[t+2|0]<<8|r[t+3|0]|0}function G(t){t=t|0;i(t|0);F=F+1|0;return 0}function K(t){t=t|0;if(V(1)|0){return 1}i(r[F+1|0]|0);F=F+2|0;return 0}function W(t){t=t|0;if(V(2)|0){return 1}i(z(F+1|0)|0);F=F+3|0;return 0}function Z(t){t=t|0;if(V(4)|0){return 1}o(z(F+1|0)|0,z(F+3|0)|0);F=F+5|0;return 0}function Y(t){t=t|0;if(V(8)|0){return 1}a(z(F+1|0)|0,z(F+3|0)|0,z(F+5|0)|0,z(F+7|0)|0);F=F+9|0;return 0}function X(t){t=t|0;i(-1-(t-32|0)|0);F=F+1|0;return 0}function J(t){t=t|0;if(V(1)|0){return 1}i(-1-(r[F+1|0]|0)|0);F=F+2|0;return 0}function Q(t){t=t|0;var e=0;if(V(2)|0){return 1}e=z(F+1|0)|0;i(-1-(e|0)|0);F=F+3|0;return 0}function tt(t){t=t|0;if(V(4)|0){return 1}s(z(F+1|0)|0,z(F+3|0)|0);F=F+5|0;return 0}function et(t){t=t|0;if(V(8)|0){return 1}c(z(F+1|0)|0,z(F+3|0)|0,z(F+5|0)|0,z(F+7|0)|0);F=F+9|0;return 0}function nt(t){t=t|0;var e=0;var n=0;var r=0;r=t-64|0;if(V(r|0)|0){return 1}e=F+1|0;n=(F+1|0)+(r|0)|0;B(e|0,n|0);F=n|0;return 0}function rt(t){t=t|0;var e=0;var n=0;var i=0;if(V(1)|0){return 1}i=r[F+1|0]|0;e=F+2|0;n=(F+2|0)+(i|0)|0;if(V(i+1|0)|0){return 1}B(e|0,n|0);F=n|0;return 0}function it(t){t=t|0;var e=0;var n=0;var r=0;if(V(2)|0){return 1}r=z(F+1|0)|0;e=F+3|0;n=(F+3|0)+(r|0)|0;if(V(r+2|0)|0){return 1}B(e|0,n|0);F=n|0;return 0}function ot(t){t=t|0;var e=0;var n=0;var r=0;if(V(4)|0){return 1}r=H(F+1|0)|0;e=F+5|0;n=(F+5|0)+(r|0)|0;if(V(r+4|0)|0){return 1}B(e|0,n|0);F=n|0;return 0}function st(t){t=t|0;return 1}function at(t){t=t|0;I();F=F+1|0;return 0}function ct(t){t=t|0;var e=0;var n=0;var r=0;r=t-96|0;if(V(r|0)|0){return 1}e=F+1|0;n=(F+1|0)+(r|0)|0;O(e|0,n|0);F=n|0;return 0}function ut(t){t=t|0;var e=0;var n=0;var i=0;if(V(1)|0){return 1}i=r[F+1|0]|0;e=F+2|0;n=(F+2|0)+(i|0)|0;if(V(i+1|0)|0){return 1}O(e|0,n|0);F=n|0;return 0}function lt(t){t=t|0;var e=0;var n=0;var r=0;if(V(2)|0){return 1}r=z(F+1|0)|0;e=F+3|0;n=(F+3|0)+(r|0)|0;if(V(r+2|0)|0){return 1}O(e|0,n|0);F=n|0;return 0}function ft(t){t=t|0;var e=0;var n=0;var r=0;if(V(4)|0){return 1}r=H(F+1|0)|0;e=F+5|0;n=(F+5|0)+(r|0)|0;if(V(r+4|0)|0){return 1}O(e|0,n|0);F=n|0;return 0}function dt(t){t=t|0;return 1}function ht(t){t=t|0;R();F=F+1|0;return 0}function pt(t){t=t|0;E(t-128|0);F=F+1|0;return 0}function gt(t){t=t|0;if(V(1)|0){return 1}E(r[F+1|0]|0);F=F+2|0;return 0}function mt(t){t=t|0;if(V(2)|0){return 1}E(z(F+1|0)|0);F=F+3|0;return 0}function bt(t){t=t|0;if(V(4)|0){return 1}x(z(F+1|0)|0,z(F+3|0)|0);F=F+5|0;return 0}function yt(t){t=t|0;if(V(8)|0){return 1}_(z(F+1|0)|0,z(F+3|0)|0,z(F+5|0)|0,z(F+7|0)|0);F=F+9|0;return 0}function wt(t){t=t|0;v();F=F+1|0;return 0}function vt(t){t=t|0;var e=0;e=t-160|0;if(V(e|0)|0){return 1}T(e|0);F=F+1|0;return 0}function Et(t){t=t|0;if(V(1)|0){return 1}T(r[F+1|0]|0);F=F+2|0;return 0}function xt(t){t=t|0;if(V(2)|0){return 1}T(z(F+1|0)|0);F=F+3|0;return 0}function _t(t){t=t|0;if(V(4)|0){return 1}S(z(F+1|0)|0,z(F+3|0)|0);F=F+5|0;return 0}function At(t){t=t|0;if(V(8)|0){return 1}N(z(F+1|0)|0,z(F+3|0)|0,z(F+5|0)|0,z(F+7|0)|0);F=F+9|0;return 0}function Tt(t){t=t|0;A();F=F+1|0;return 0}function St(t){t=t|0;k(t-192|0|0);F=F+1|0;return 0}function Nt(t){t=t|0;k(t|0);F=F+1|0;return 0}function Bt(t){t=t|0;k(t|0);F=F+1|0;return 0}function It(t){t=t|0;k(t|0);F=F+1|0;return 0}function Ot(t){t=t|0;k(t|0);F=F+1|0;return 0}function Rt(t){t=t|0;k(t-192|0|0);F=F+1|0;return 0}function $t(t){t=t|0;k(t|0);F=F+1|0;return 0}function kt(t){t=t|0;k(t|0);F=F+1|0;return 0}function Lt(t){t=t|0;k(t|0);F=F+1|0;return 0}function Pt(t){t=t|0;if(V(1)|0){return 1}k(r[F+1|0]|0);F=F+2|0;return 0}function Ut(t){t=t|0;if(V(2)|0){return 1}k(z(F+1|0)|0);F=F+3|0;return 0}function Dt(t){t=t|0;if(V(4)|0){return 1}L(z(F+1|0)|0,z(F+3|0)|0);F=F+5|0;return 0}function Ct(t){t=t|0;if(V(8)|0){return 1}P(z(F+1|0)|0,z(F+3|0)|0,z(F+5|0)|0,z(F+7|0)|0);F=F+9|0;return 0}function Ft(t){t=t|0;$((t|0)-224|0);F=F+1|0;return 0}function Mt(t){t=t|0;h();F=F+1|0;return 0}function jt(t){t=t|0;d();F=F+1|0;return 0}function qt(t){t=t|0;g();F=F+1|0;return 0}function Vt(t){t=t|0;p();F=F+1|0;return 0}function zt(t){t=t|0;if(V(1)|0){return 1}$(r[F+1|0]|0);F=F+2|0;return 0}function Ht(t){t=t|0;var e=0;var n=0;var i=1.0;var o=0.0;var s=0.0;var a=0.0;if(V(2)|0){return 1}e=r[F+1|0]|0;n=r[F+2|0]|0;if((e|0)&0x80){i=-1.0}o=+(((e|0)&0x7C)>>2);s=+(((e|0)&0x03)<<8|n);if(+o==0.0){u(+(+i*+5.9604644775390625e-8*+s))}else if(+o==31.0){if(+i==1.0){if(+s>0.0){y()}else{m()}}else{if(+s>0.0){w()}else{b()}}}else{u(+(+i*C(+2,+(+o-25.0))*+(1024.0+s)))}F=F+3|0;return 0}function Gt(t){t=t|0;if(V(4)|0){return 1}l(r[F+1|0]|0,r[F+2|0]|0,r[F+3|0]|0,r[F+4|0]|0);F=F+5|0;return 0}function Kt(t){t=t|0;if(V(8)|0){return 1}f(r[F+1|0]|0,r[F+2|0]|0,r[F+3|0]|0,r[F+4|0]|0,r[F+5|0]|0,r[F+6|0]|0,r[F+7|0]|0,r[F+8|0]|0);F=F+9|0;return 0}function Wt(t){t=t|0;return 1}function Zt(t){t=t|0;D();F=F+1|0;return 0}var Yt=[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,K,W,Z,Y,Wt,Wt,Wt,Wt,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,J,Q,tt,et,Wt,Wt,Wt,Wt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,nt,rt,it,ot,st,Wt,Wt,Wt,at,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ut,lt,ft,dt,Wt,Wt,Wt,ht,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,gt,mt,bt,yt,Wt,Wt,Wt,wt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,Et,xt,_t,At,Wt,Wt,Wt,Tt,St,St,St,St,St,St,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Pt,Ut,Dt,Ct,Wt,Wt,Wt,Wt,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Ft,Mt,jt,qt,Vt,zt,Ht,Gt,Kt,Wt,Wt,Wt,Zt];return{parse:q}},Yr=Nr,Xr=Br,Jr=Lr,Qr=Pr,{URL:ti}=Hr;let ei=class t{constructor(t){!(t=t||{}).size||t.size<65536?t.size=65536:t.size=Yr.nextPowerOf2(t.size),this._heap=new ArrayBuffer(t.size),this._heap8=new Uint8Array(this._heap),this._buffer=Gr.from(this._heap),this._reset(),this._knownTags=Object.assign({0:t=>new Date(t),1:t=>new Date(1e3*t),2:t=>Yr.arrayBufferToBignumber(t),3:t=>Xr.NEG_ONE.minus(Yr.arrayBufferToBignumber(t)),4:t=>Xr.TEN.pow(t[0]).times(t[1]),5:t=>Xr.TWO.pow(t[0]).times(t[1]),32:t=>new ti(t),35:t=>new RegExp(t)},t.tags),this.parser=Zr(Ut,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var t=this._parents.pop();if(t.length>0)throw new Error(`Missing ${t.length} elements`);switch(t.type){case Xr.PARENT.TAG:this._push(this.createTag(t.ref[0],t.ref[1]));break;case Xr.PARENT.BYTE_STRING:this._push(this.createByteString(t.ref,t.length));break;case Xr.PARENT.UTF8_STRING:this._push(this.createUtf8String(t.ref,t.length));break;case Xr.PARENT.MAP:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(t.ref,t.length));break;case Xr.PARENT.OBJECT:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(t.ref,t.length));break;case Xr.PARENT.ARRAY:this._push(this.createArray(t.ref,t.length))}this._currentParent&&this._currentParent.type===Xr.PARENT.TAG&&this._dec()}_dec(){const t=this._currentParent;t.length<0||(t.length--,0===t.length&&this._closeParent())}_push(t,e){const n=this._currentParent;switch(n.values++,n.type){case Xr.PARENT.ARRAY:case Xr.PARENT.BYTE_STRING:case Xr.PARENT.UTF8_STRING:n.length>-1?this._ref[this._ref.length-n.length]=t:this._ref.push(t),this._dec();break;case Xr.PARENT.OBJECT:null!=n.tmpKey?(this._ref[n.tmpKey]=t,n.tmpKey=null,this._dec()):(n.tmpKey=t,"string"!=typeof n.tmpKey&&(n.type=Xr.PARENT.MAP,n.ref=Yr.buildMap(n.ref)));break;case Xr.PARENT.MAP:null!=n.tmpKey?(this._ref.set(n.tmpKey,t),n.tmpKey=null,this._dec()):n.tmpKey=t;break;case Xr.PARENT.TAG:this._ref.push(t),e||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(t,e,n){this._parents[this._depth]={type:e,length:n,ref:t,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:Xr.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(t,e){const n=this._knownTags[t];return n?n(e):new Qr(t,e)}createMap(t,e){return t}createObject(t,e){return t}createArray(t,e){return t}createByteString(t,e){return Gr.concat(t)}createByteStringFromHeap(t,e){return t===e?Gr.alloc(0):Gr.from(this._heap.slice(t,e))}createInt(t){return t}createInt32(t,e){return Yr.buildInt32(t,e)}createInt64(t,e,n,r){return Yr.buildInt64(t,e,n,r)}createFloat(t){return t}createFloatSingle(t,e,n,r){return Kr.read([t,e,n,r],0,!1,23,4)}createFloatDouble(t,e,n,r,i,o,s,a){return Kr.read([t,e,n,r,i,o,s,a],0,!1,52,8)}createInt32Neg(t,e){return-1-Yr.buildInt32(t,e)}createInt64Neg(t,e,n,r){const i=Yr.buildInt32(t,e),o=Yr.buildInt32(n,r);return i>Xr.MAX_SAFE_HIGH?Xr.NEG_ONE.minus(new Wr(i).times(Xr.SHIFT32).plus(o)):-1-(i*Xr.SHIFT32+o)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(t,e){return t.join("")}createUtf8StringFromHeap(t,e){return t===e?"":this._buffer.toString("utf8",t,e)}createSimpleUnassigned(t){return new Jr(t)}pushInt(t){this._push(this.createInt(t))}pushInt32(t,e){this._push(this.createInt32(t,e))}pushInt64(t,e,n,r){this._push(this.createInt64(t,e,n,r))}pushFloat(t){this._push(this.createFloat(t))}pushFloatSingle(t,e,n,r){this._push(this.createFloatSingle(t,e,n,r))}pushFloatDouble(t,e,n,r,i,o,s,a){this._push(this.createFloatDouble(t,e,n,r,i,o,s,a))}pushInt32Neg(t,e){this._push(this.createInt32Neg(t,e))}pushInt64Neg(t,e,n,r){this._push(this.createInt64Neg(t,e,n,r))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],Xr.PARENT.ARRAY,-1)}pushArrayStartFixed(t){this._createArrayStartFixed(t)}pushArrayStartFixed32(t,e){const n=Yr.buildInt32(t,e);this._createArrayStartFixed(n)}pushArrayStartFixed64(t,e,n,r){const i=Yr.buildInt64(t,e,n,r);this._createArrayStartFixed(i)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(t){this._createObjectStartFixed(t)}pushObjectStartFixed32(t,e){const n=Yr.buildInt32(t,e);this._createObjectStartFixed(n)}pushObjectStartFixed64(t,e,n,r){const i=Yr.buildInt64(t,e,n,r);this._createObjectStartFixed(i)}pushByteStringStart(){this._parents[this._depth]={type:Xr.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(t,e){this._push(this.createByteStringFromHeap(t,e))}pushUtf8StringStart(){this._parents[this._depth]={type:Xr.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(t,e){this._push(this.createUtf8StringFromHeap(t,e))}pushSimpleUnassigned(t){this._push(this.createSimpleUnassigned(t))}pushTagStart(t){this._parents[this._depth]={type:Xr.PARENT.TAG,length:1,ref:[t]}}pushTagStart4(t,e){this.pushTagStart(Yr.buildInt32(t,e))}pushTagStart8(t,e,n,r){this.pushTagStart(Yr.buildInt64(t,e,n,r))}pushTagUnassigned(t){this._push(this.createTag(t))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(t){0!==t?this._createParent({},Xr.PARENT.OBJECT,t):this._push(this.createObject({}))}_createArrayStartFixed(t){0!==t?this._createParent(new Array(t),Xr.PARENT.ARRAY,t):this._push(this.createArray([]))}_decode(t){if(0===t.byteLength)throw new Error("Input too short");this._reset(),this._heap8.set(t);const e=this.parser.parse(t.byteLength);if(this._depth>1){for(;0===this._currentParent.length;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(e>0)throw new Error("Failed to parse");if(0===this._res.length)throw new Error("No valid result")}decodeFirst(t){return this._decode(t),this._res[0]}decodeAll(t){return this._decode(t),this._res}static decode(e,n){"string"==typeof e&&(e=Gr.from(e,n||"hex"));return new t({size:e.length}).decodeFirst(e)}static decodeAll(e,n){"string"==typeof e&&(e=Gr.from(e,n||"hex"));return new t({size:e.length}).decodeAll(e)}};ei.decodeFirst=ei.decode;var ni=ei;const{Buffer:ri}=_r,ii=ni,oi=Nr;class si extends ii{createTag(t,e){return`${t}(${e})`}createInt(t){return super.createInt(t).toString()}createInt32(t,e){return super.createInt32(t,e).toString()}createInt64(t,e,n,r){return super.createInt64(t,e,n,r).toString()}createInt32Neg(t,e){return super.createInt32Neg(t,e).toString()}createInt64Neg(t,e,n,r){return super.createInt64Neg(t,e,n,r).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(t){const e=super.createFloat(t);return oi.isNegativeZero(t)?"-0_1":`${e}_1`}createFloatSingle(t,e,n,r){return`${super.createFloatSingle(t,e,n,r)}_2`}createFloatDouble(t,e,n,r,i,o,s,a){return`${super.createFloatDouble(t,e,n,r,i,o,s,a)}_3`}createByteString(t,e){const n=t.join(", ");return-1===e?`(_ ${n})`:`h'${n}`}createByteStringFromHeap(t,e){return`h'${ri.from(super.createByteStringFromHeap(t,e)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(t){return`simple(${t})`}createArray(t,e){const n=super.createArray(t,e);return-1===e?`[_ ${n.join(", ")}]`:`[${n.join(", ")}]`}createMap(t,e){const n=super.createMap(t),r=Array.from(n.keys()).reduce(ci(n),"");return-1===e?`{_ ${r}}`:`{${r}}`}createObject(t,e){const n=super.createObject(t),r=Object.keys(n).reduce(ci(n),"");return-1===e?`{_ ${r}}`:`{${r}}`}createUtf8String(t,e){const n=t.join(", ");return-1===e?`(_ ${n})`:`"${n}"`}createUtf8StringFromHeap(t,e){return`"${ri.from(super.createUtf8StringFromHeap(t,e)).toString("utf8")}"`}static diagnose(t,e){"string"==typeof t&&(t=ri.from(t,e||"hex"));return(new si).decodeFirst(t)}}var ai=si;function ci(t){return(e,n)=>e?`${e}, ${n}: ${t[n]}`:`${n}: ${t[n]}`}const{Buffer:ui}=_r,{URL:li}=Hr,fi=Sr.BigNumber,di=Nr,hi=Br,pi=hi.MT,gi=hi.NUMBYTES,mi=hi.SHIFT32,bi=hi.SYMS,yi=hi.TAG,wi=hi.MT.SIMPLE_FLOAT<<5|hi.NUMBYTES.TWO,vi=hi.MT.SIMPLE_FLOAT<<5|hi.NUMBYTES.FOUR,Ei=hi.MT.SIMPLE_FLOAT<<5|hi.NUMBYTES.EIGHT,xi=hi.MT.SIMPLE_FLOAT<<5|hi.SIMPLE.TRUE,_i=hi.MT.SIMPLE_FLOAT<<5|hi.SIMPLE.FALSE,Ai=hi.MT.SIMPLE_FLOAT<<5|hi.SIMPLE.UNDEFINED,Ti=hi.MT.SIMPLE_FLOAT<<5|hi.SIMPLE.NULL,Si=new fi("0x20000000000000"),Ni=ui.from("f97e00","hex"),Bi=ui.from("f9fc00","hex"),Ii=ui.from("f97c00","hex");class Oi{constructor(t){t=t||{},this.streaming="function"==typeof t.stream,this.onData=t.stream,this.semanticTypes=[[li,this._pushUrl],[fi,this._pushBigNumber]];const e=t.genTypes||[],n=e.length;for(let t=0;t<n;t++)this.addSemanticType(e[t][0],e[t][1]);this._reset()}addSemanticType(t,e){const n=this.semanticTypes.length;for(let r=0;r<n;r++){if(this.semanticTypes[r][0]===t){const t=this.semanticTypes[r][1];return this.semanticTypes[r][1]=e,t}}return this.semanticTypes.push([t,e]),null}push(t){return!t||(this.result[this.offset]=t,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=t.length,this.offset++,this.streaming&&this.onData(this.finalize()),!0)}pushWrite(t,e,n){return this.result[this.offset]=t,this.resultMethod[this.offset]=e,this.resultLength[this.offset]=n,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(t){return this.pushWrite(t,1,1)}_pushUInt16BE(t){return this.pushWrite(t,2,2)}_pushUInt32BE(t){return this.pushWrite(t,3,4)}_pushDoubleBE(t){return this.pushWrite(t,4,8)}_pushNaN(){return this.push(Ni)}_pushInfinity(t){const e=t<0?Bi:Ii;return this.push(e)}_pushFloat(t){const e=ui.allocUnsafe(2);if(di.writeHalf(e,t)&&di.parseHalf(e)===t)return this._pushUInt8(wi)&&this.push(e);const n=ui.allocUnsafe(4);return n.writeFloatBE(t,0),n.readFloatBE(0)===t?this._pushUInt8(vi)&&this.push(n):this._pushUInt8(Ei)&&this._pushDoubleBE(t)}_pushInt(t,e,n){const r=e<<5;return t<24?this._pushUInt8(r|t):t<=255?this._pushUInt8(r|gi.ONE)&&this._pushUInt8(t):t<=65535?this._pushUInt8(r|gi.TWO)&&this._pushUInt16BE(t):t<=4294967295?this._pushUInt8(r|gi.FOUR)&&this._pushUInt32BE(t):t<=Number.MAX_SAFE_INTEGER?this._pushUInt8(r|gi.EIGHT)&&this._pushUInt32BE(Math.floor(t/mi))&&this._pushUInt32BE(t%mi):e===pi.NEG_INT?this._pushFloat(n):this._pushFloat(t)}_pushIntNum(t){return t<0?this._pushInt(-t-1,pi.NEG_INT,t):this._pushInt(t,pi.POS_INT)}_pushNumber(t){switch(!1){case t==t:return this._pushNaN(t);case isFinite(t):return this._pushInfinity(t);case t%1!=0:return this._pushIntNum(t);default:return this._pushFloat(t)}}_pushString(t){const e=ui.byteLength(t,"utf8");return this._pushInt(e,pi.UTF8_STRING)&&this.pushWrite(t,5,e)}_pushBoolean(t){return this._pushUInt8(t?xi:_i)}_pushUndefined(t){return this._pushUInt8(Ai)}_pushArray(t,e){const n=e.length;if(!t._pushInt(n,pi.ARRAY))return!1;for(let r=0;r<n;r++)if(!t.pushAny(e[r]))return!1;return!0}_pushTag(t){return this._pushInt(t,pi.TAG)}_pushDate(t,e){return t._pushTag(yi.DATE_EPOCH)&&t.pushAny(Math.round(e/1e3))}_pushBuffer(t,e){return t._pushInt(e.length,pi.BYTE_STRING)&&t.push(e)}_pushNoFilter(t,e){return t._pushBuffer(t,e.slice())}_pushRegexp(t,e){return t._pushTag(yi.REGEXP)&&t.pushAny(e.source)}_pushSet(t,e){if(!t._pushInt(e.size,pi.ARRAY))return!1;for(const n of e)if(!t.pushAny(n))return!1;return!0}_pushUrl(t,e){return t._pushTag(yi.URI)&&t.pushAny(e.format())}_pushBigint(t){let e=yi.POS_BIGINT;t.isNegative()&&(t=t.negated().minus(1),e=yi.NEG_BIGINT);let n=t.toString(16);n.length%2&&(n="0"+n);const r=ui.from(n,"hex");return this._pushTag(e)&&this._pushBuffer(this,r)}_pushBigNumber(t,e){if(e.isNaN())return t._pushNaN();if(!e.isFinite())return t._pushInfinity(e.isNegative()?-1/0:1/0);if(e.isInteger())return t._pushBigint(e);if(!t._pushTag(yi.DECIMAL_FRAC)||!t._pushInt(2,pi.ARRAY))return!1;const n=e.decimalPlaces(),r=e.multipliedBy(new fi(10).pow(n));return!!t._pushIntNum(-n)&&(r.abs().isLessThan(Si)?t._pushIntNum(r.toNumber()):t._pushBigint(r))}_pushMap(t,e){return!!t._pushInt(e.size,pi.MAP)&&this._pushRawMap(e.size,Array.from(e))}_pushObject(t){if(!t)return this._pushUInt8(Ti);for(var e=this.semanticTypes.length,n=0;n<e;n++)if(t instanceof this.semanticTypes[n][0])return this.semanticTypes[n][1].call(t,this,t);var r=t.encodeCBOR;if("function"==typeof r)return r.call(t,this);var i=Object.keys(t),o=i.length;return!!this._pushInt(o,pi.MAP)&&this._pushRawMap(o,i.map((e=>[e,t[e]])))}_pushRawMap(t,e){e=e.map((function(t){return t[0]=Oi.encode(t[0]),t})).sort(di.keySorter);for(var n=0;n<t;n++){if(!this.push(e[n][0]))return!1;if(!this.pushAny(e[n][1]))return!1}return!0}write(t){return this.pushAny(t)}pushAny(t){var e=function(t){return{}.toString.call(t).slice(8,-1)}(t);switch(e){case"Number":return this._pushNumber(t);case"String":return this._pushString(t);case"Boolean":return this._pushBoolean(t);case"Object":return this._pushObject(t);case"Array":return this._pushArray(this,t);case"Uint8Array":return this._pushBuffer(this,ui.isBuffer(t)?t:ui.from(t));case"Null":return this._pushUInt8(Ti);case"Undefined":return this._pushUndefined(t);case"Map":return this._pushMap(this,t);case"Set":return this._pushSet(this,t);case"URL":return this._pushUrl(this,t);case"BigNumber":return this._pushBigNumber(this,t);case"Date":return this._pushDate(this,t);case"RegExp":return this._pushRegexp(this,t);case"Symbol":switch(t){case bi.NULL:return this._pushObject(null);case bi.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+t.toString())}default:throw new Error("Unknown type: "+typeof t+", "+(t?t.toString():""))}}finalize(){if(0===this.offset)return null;for(var t=this.result,e=this.resultLength,n=this.resultMethod,r=this.offset,i=0,o=0;o<r;o++)i+=e[o];var s=ui.allocUnsafe(i),a=0,c=0;for(o=0;o<r;o++){switch(c=e[o],n[o]){case 0:t[o].copy(s,a);break;case 1:s.writeUInt8(t[o],a,!0);break;case 2:s.writeUInt16BE(t[o],a,!0);break;case 3:s.writeUInt32BE(t[o],a,!0);break;case 4:s.writeDoubleBE(t[o],a,!0);break;case 5:s.write(t[o],a,c,"utf8");break;default:throw new Error("unkown method")}a+=c}var u=s;return this._reset(),u}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(t){const e=new Oi;if(!e.pushAny(t))throw new Error("Failed to encode input");return e.finalize()}}var Ri,$i=Oi;(Ri=xr).Diagnose=ai,Ri.Decoder=ni,Ri.Encoder=$i,Ri.Simple=Lr,Ri.Tagged=Pr,Ri.decodeAll=Ri.Decoder.decodeAll,Ri.decodeFirst=Ri.Decoder.decodeFirst,Ri.diagnose=Ri.Diagnose.diagnose,Ri.encode=Ri.Encoder.encode,Ri.decode=Ri.Decoder.decode,Ri.leveldb={decode:Ri.Decoder.decodeAll,encode:Ri.Encoder.encode,buffer:!0,name:"cbor"};var ki=Dt(xr);function Li(t){return Qe(Ve.create().update(new Uint8Array(t)).digest())}function Pi(t){if(t instanceof ki.Tagged)return Pi(t.value);if("string"==typeof t)return Ui(t);if("number"==typeof t)return Li(fn(t));if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return Li(t);if(Array.isArray(t)){return Li(Ke(...t.map(Pi)))}if(t&&"object"==typeof t&&t._isPrincipal)return Li(t.toUint8Array());if("object"==typeof t&&null!==t&&"function"==typeof t.toHash)return Pi(t.toHash());if("object"==typeof t)return Ci(t);if("bigint"==typeof t)return Li(fn(t));throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${t}`),{value:t})}const Ui=t=>Li((new TextEncoder).encode(t));function Di(t){return Ci(t)}function Ci(t){const e=Object.entries(t).filter((([,t])=>void 0!==t)).map((([t,e])=>[Ui(t),Pi(e)]));return Li(Ke(...e.sort((([t],[e])=>Xe(t,e))).map((t=>Ke(...t)))))}var Fi=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Mi=(new TextEncoder).encode("\nic-request");class ji{getPrincipal(){return this._principal||(this._principal=Ge.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(t){const{body:e}=t,n=Fi(t,["body"]),r=Di(e);return Object.assign(Object.assign({},n),{body:{content:e,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(Ke(Mi,r))}})}}class qi{getPrincipal(){return Ge.anonymous()}async transformRequest(t){return Object.assign(Object.assign({},t),{body:{content:t.body}})}}var Vi={},zi={},Hi={};Object.defineProperty(Hi,"__esModule",{value:!0});const Gi=9007199254740992;function Ki(t,...e){const n=new Uint8Array(t.byteLength+e.reduce(((t,e)=>t+e.byteLength),0));n.set(new Uint8Array(t),0);let r=t.byteLength;for(const t of e)n.set(new Uint8Array(t),r),r+=t.byteLength;return n.buffer}function Wi(t,e,n){const r=2**(e-24);n=(n=n.replace(/[^0-9a-fA-F]/g,"")).slice(2*-r).padStart(2*r,"0");const i=[(t<<5)+e].concat(n.match(/../g).map((t=>parseInt(t,16))));return new Uint8Array(i).buffer}function Zi(t,e){if(e<24)return new Uint8Array([(t<<5)+e]).buffer;return Wi(t,e<=255?24:e<=65535?25:e<=4294967295?26:27,e.toString(16))}function Yi(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);r<128?e.push(r):r<2048?e.push(192|r>>6,128|63&r):r<55296||r>=57344?e.push(224|r>>12,128|r>>6&63,128|63&r):(n++,r=(1023&r)<<10|1023&t.charCodeAt(n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return Ki(new Uint8Array(Zi(3,t.length)),new Uint8Array(e))}function Xi(t){return new Uint8Array(t).buffer}function Ji(t){if(isNaN(t))throw new RangeError("Invalid number.");t=Math.min(Math.max(0,t),23);return new Uint8Array([0+t]).buffer}function Qi(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Wi(0,24,t=(t=Math.min(Math.max(0,t),255)).toString(16))}function to(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Wi(0,25,t=(t=Math.min(Math.max(0,t),65535)).toString(16))}function eo(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Wi(0,26,t=(t=Math.min(Math.max(0,t),4294967295)).toString(16))}function no(t,e){if("string"==typeof t&&16==e){if(t.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return Wi(0,27,t)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Wi(0,27,t=(t=Math.min(Math.max(0,t),Gi)).toString(16))}function ro(t){if(isNaN(t))throw new RangeError("Invalid number.");if(0===t)return Ji(0);t=Math.min(Math.max(0,-t),24)-1;return new Uint8Array([32+t]).buffer}function io(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Wi(1,24,t=(t=Math.min(Math.max(0,-t-1),255)).toString(16))}function oo(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Wi(1,25,t=(t=Math.min(Math.max(0,-t-1),65535)).toString(16))}function so(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Wi(1,26,t=(t=Math.min(Math.max(0,-t-1),4294967295)).toString(16))}function ao(t,e){if("string"==typeof t&&16==e){if((t=t.startsWith("-")?t.slice(1):"0").match(/[^0-9a-fA-F]/)||t.length>16)throw new RangeError("Invalid number.");let e=!1,n=t.split("").reduceRight(((t,n)=>{if(e)return n+t;let r=parseInt(n,16)-1;return r>=0?(e=!0,r.toString(16)+t):"f"+t}),"");return e?Wi(1,27,n):no(0)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Wi(1,27,t=(t=Math.min(Math.max(0,-t-1),9007199254740992)).toString(16))}function co(){return Xi(new Uint8Array([245]))}function uo(){return Xi(new Uint8Array([244]))}Hi.tagged=function(t,e){if(14277111==t)return Ki(new Uint8Array([217,217,247]),e);if(t<24)return Ki(new Uint8Array([192+t]),e);{const e=t<=255?24:t<=65535?25:t<=4294967295?26:27,n=2**(e-24),r=t.toString(16).slice(2*-n).padStart(2*n,"0"),i=[192+e].concat(r.match(/../g).map((t=>parseInt(t,16))));return new Uint8Array(i).buffer}},Hi.raw=Xi,Hi.uSmall=Ji,Hi.u8=Qi,Hi.u16=to,Hi.u32=eo,Hi.u64=no,Hi.iSmall=ro,Hi.i8=io,Hi.i16=oo,Hi.i32=so,Hi.i64=ao,Hi.number=function(t){return t>=0?t<24?Ji(t):t<=255?Qi(t):t<=65535?to(t):t<=4294967295?eo(t):no(t):t>=-24?ro(t):t>=-255?io(t):t>=-65535?oo(t):t>=-4294967295?so(t):ao(t)},Hi.bytes=function(t){return Ki(Zi(2,t.byteLength),t)},Hi.string=function(t){return Yi(t)},Hi.array=function(t){return Ki(Zi(4,t.length),...t)},Hi.map=function(t,e=!1){t instanceof Map||(t=new Map(Object.entries(t)));let n=Array.from(t.entries());return e&&(n=n.sort((([t],[e])=>t.localeCompare(e)))),Ki(Zi(5,t.size),...n.map((([t,e])=>Ki(Yi(t),e))))},Hi.singleFloat=function(t){const e=new Float32Array([t]);return Ki(new Uint8Array([250]),new Uint8Array(e.buffer))},Hi.doubleFloat=function(t){const e=new Float64Array([t]);return Ki(new Uint8Array([251]),new Uint8Array(e.buffer))},Hi.bool=function(t){return t?co():uo()},Hi.true_=co,Hi.false_=uo,Hi.null_=function(){return Xi(new Uint8Array([246]))},Hi.undefined_=function(){return Xi(new Uint8Array([247]))};var lo=Ut&&Ut.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(zi,"__esModule",{value:!0});const fo=lo(Hi),ho=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class po{constructor(t,e=!1){this._serializer=t,this._stable=e,this.name="jsonDefault",this.priority=-100}match(t){return-1!=["undefined","boolean","number","string","object"].indexOf(typeof t)}encode(t){switch(typeof t){case"undefined":return fo.undefined_();case"boolean":return fo.bool(t);case"number":return Math.floor(t)===t?fo.number(t):fo.doubleFloat(t);case"string":return fo.string(t);case"object":if(null===t)return fo.null_();if(Array.isArray(t))return fo.array(t.map((t=>this._serializer.serializeValue(t))));if(ho.find((e=>t instanceof e)))return fo.bytes(t.buffer);if(-1!==Object.getOwnPropertyNames(t).indexOf("toJSON"))return this.encode(t.toJSON());if(t instanceof Map){const e=new Map;for(const[n,r]of t.entries())e.set(n,this._serializer.serializeValue(r));return fo.map(e,this._stable)}{const e=new Map;for(const[n,r]of Object.entries(t))e.set(n,this._serializer.serializeValue(r));return fo.map(e,this._stable)}default:throw new Error("Invalid value.")}}}zi.JsonDefaultCborEncoder=po;class go{constructor(){this.name="cborEncoder",this.priority=-90}match(t){return"object"==typeof t&&"function"==typeof t.toCBOR}encode(t){return t.toCBOR()}}zi.ToCborEncoder=go;class mo{constructor(){this._encoders=new Set}static withDefaultEncoders(t=!1){const e=new this;return e.addEncoder(new po(e,t)),e.addEncoder(new go),e}removeEncoder(t){for(const e of this._encoders.values())e.name==t&&this._encoders.delete(e)}addEncoder(t){this._encoders.add(t)}getEncoderFor(t){let e=null;for(const n of this._encoders)(!e||n.priority>e.priority)&&n.match(t)&&(e=n);if(null===e)throw new Error("Could not find an encoder for value.");return e}serializeValue(t){return this.getEncoderFor(t).encode(t)}serialize(t){return this.serializeValue(t)}}zi.CborSerializer=mo;zi.SelfDescribeCborSerializer=class extends mo{serialize(t){return fo.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(t))]))}},function(t){var e=Ut&&Ut.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(zi);const n=e(Hi);t.value=n}(Vi);const bo=Vi.SelfDescribeCborSerializer.withDefaultEncoders(!0);var yo;function wo(t){return bo.serialize(t)}function vo(t){const e=t.byteLength;let n=BigInt(0);for(let r=0;r<e;r++)n=n*BigInt(256)+BigInt(t[r]);return n}bo.addEncoder(new class{get name(){return"Principal"}get priority(){return 0}match(t){return t&&!0===t._isPrincipal}encode(t){return Vi.value.bytes(t.toUint8Array())}}),bo.addEncoder(new class{get name(){return"Buffer"}get priority(){return 1}match(t){return t instanceof ArrayBuffer||ArrayBuffer.isView(t)}encode(t){return Vi.value.bytes(new Uint8Array(t))}}),bo.addEncoder(new class{get name(){return"BigInt"}get priority(){return 1}match(t){return"bigint"==typeof t}encode(t){return t>BigInt(0)?Vi.value.tagged(2,Vi.value.bytes(Ye(t.toString(16)))):Vi.value.tagged(3,Vi.value.bytes(Ye((BigInt("-1")*t).toString(16))))}}),function(t){t[t.Uint64LittleEndian=71]="Uint64LittleEndian",t[t.Semantic=55799]="Semantic"}(yo||(yo={}));class Eo extends ki.Decoder{createByteString(t){return Ke(...t)}createByteStringFromHeap(t,e){return t===e?new ArrayBuffer(0):new Uint8Array(this._heap.slice(t,e))}}function xo(t){const e=new Uint8Array(t),n=new Eo({size:e.byteLength,tags:{2:t=>vo(t),3:t=>-vo(t),[yo.Semantic]:t=>t}});try{return n.decodeFirst(e)}catch(t){throw new Error(`Failed to decode CBOR: ${t}, input: ${We(e)}`)}}const _o=()=>{if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){const t=new Uint32Array(1);return window.crypto.getRandomValues(t),t[0]}if("undefined"!=typeof crypto&&crypto.getRandomValues){const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]}return"undefined"!=typeof crypto&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(4294967295*Math.random())};var Ao;function To(){const t=new ArrayBuffer(16),e=new DataView(t),n=_o(),r=_o(),i=_o(),o=_o();return e.setUint32(0,n),e.setUint32(4,r),e.setUint32(8,i),e.setUint32(12,o),t}!function(t){t.Call="call"}(Ao||(Ao={}));const So=BigInt(1e6);class No{constructor(t){if(t<9e4){const e=BigInt(Date.now()+t)*So/BigInt(1e9);return void(this._value=e*BigInt(1e9))}const e=BigInt(Math.floor(Date.now()+t-6e4))*So/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=e}toCBOR(){return Vi.value.u64(this._value.toString(16),16)}toHash(){return fn(this._value)}}function Bo(t=To){return async e=>{const n=e.request.headers;e.request.headers=n,"call"===e.endpoint&&(e.body.nonce=t())}}function Io(t){const e=[];return t.forEach(((t,n)=>{e.push([n,t])})),e}class Oo extends en{constructor(t,e){super(t),this.response=e,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class Ro extends en{constructor(t,e,n,r,i,o){super(t),this.response=e,this.requestId=n,this.senderPubkey=r,this.senderSig=i,this.ingressExpiry=o,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class $o extends en{constructor(t,e,n,r,i,o){super(t),this.response=e,this.requestId=n,this.senderPubkey=r,this.senderSig=i,this.ingressExpiry=o,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class ko extends en{constructor(t,e,n,r,i,o){super(t),this.response=e,this.requestId=n,this.senderPubkey=r,this.senderSig=i,this.ingressExpiry=o,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Lo=BigInt(0),Po=BigInt(1);function Uo(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function Do(t){if(!Uo(t))throw new Error("Uint8Array expected")}function Co(t,e){if("boolean"!=typeof e)throw new Error(t+" boolean expected, got "+e)}function Fo(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return""===t?Lo:BigInt("0x"+t)}const Mo="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,jo=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function qo(t){if(Do(t),Mo)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=jo[t[n]];return e}const Vo={_0:48,_9:57,A:65,F:70,a:97,f:102};function zo(t){return t>=Vo._0&&t<=Vo._9?t-Vo._0:t>=Vo.A&&t<=Vo.F?t-(Vo.A-10):t>=Vo.a&&t<=Vo.f?t-(Vo.a-10):void 0}function Ho(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);if(Mo)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let e=0,i=0;e<n;e++,i+=2){const n=zo(t.charCodeAt(i)),o=zo(t.charCodeAt(i+1));if(void 0===n||void 0===o){const e=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+i)}r[e]=16*n+o}return r}function Go(t){return Fo(qo(t))}function Ko(t){return Do(t),Fo(qo(Uint8Array.from(t).reverse()))}function Wo(t,e){return Ho(t.toString(16).padStart(2*e,"0"))}function Zo(t,e){return Wo(t,e).reverse()}function Yo(t,e,n){let r;if("string"==typeof e)try{r=Ho(e)}catch(e){throw new Error(t+" must be hex string or Uint8Array, cause: "+e)}else{if(!Uo(e))throw new Error(t+" must be hex string or Uint8Array");r=Uint8Array.from(e)}const i=r.length;if("number"==typeof n&&i!==n)throw new Error(t+" of length "+n+" expected, got "+i);return r}function Xo(...t){let e=0;for(let n=0;n<t.length;n++){const r=t[n];Do(r),e+=r.length}const n=new Uint8Array(e);for(let e=0,r=0;e<t.length;e++){const i=t[e];n.set(i,r),r+=i.length}return n}function Jo(t){if("string"!=typeof t)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}const Qo=t=>"bigint"==typeof t&&Lo<=t;function ts(t,e,n){return Qo(t)&&Qo(e)&&Qo(n)&&e<=t&&t<n}function es(t,e,n,r){if(!ts(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function ns(t){let e;for(e=0;t>Lo;t>>=Po,e+=1);return e}function rs(t,e){return t>>BigInt(e)&Po}const is=t=>(Po<<BigInt(t))-Po,os={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||Uo(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function ss(t,e,n={}){const r=(e,n,r)=>{const i=os[n];if("function"!=typeof i)throw new Error("invalid validator function");const o=t[e];if(!(r&&void 0===o||i(o,t)))throw new Error("param "+String(e)+" is invalid. Expected "+n+", got "+o)};for(const[t,n]of Object.entries(e))r(t,n,!1);for(const[t,e]of Object.entries(n))r(t,e,!0);return t}const as=()=>{throw new Error("not implemented")};function cs(t){const e=new WeakMap;return(n,...r)=>{const i=e.get(n);if(void 0!==i)return i;const o=t(n,...r);return e.set(n,o),o}}const us=BigInt(0),ls=BigInt(1),fs=BigInt(2),ds=BigInt(3),hs=BigInt(4),ps=BigInt(5),gs=BigInt(8);function ms(t,e){const n=t%e;return n>=us?n:e+n}function bs(t,e,n){let r=t;for(;e-- >us;)r*=r,r%=n;return r}function ys(t,e){if(t===us)throw new Error("invert: expected non-zero number");if(e<=us)throw new Error("invert: expected positive modulus, got "+e);let n=ms(t,e),r=e,i=us,o=ls;for(;n!==us;){const t=r%n,e=i-o*(r/n);r=n,n=t,i=o,o=e}if(r!==ls)throw new Error("invert: does not exist");return ms(i,e)}function ws(t,e){const n=(t.ORDER+ls)/hs,r=t.pow(e,n);if(!t.eql(t.sqr(r),e))throw new Error("Cannot find square root");return r}function vs(t,e){const n=(t.ORDER-ps)/gs,r=t.mul(e,fs),i=t.pow(r,n),o=t.mul(e,i),s=t.mul(t.mul(o,fs),i),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function Es(t){return t%hs===ds?ws:t%gs===ps?vs:function(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-ls,n=0;for(;e%fs===us;)e/=fs,n++;let r=fs;const i=Bs(t);for(;1===Ss(i,r);)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===n)return ws;let o=i.pow(r,e);const s=(e+ls)/fs;return function(t,r){if(t.is0(r))return r;if(1!==Ss(t,r))throw new Error("Cannot find square root");let i=n,a=t.mul(t.ONE,o),c=t.pow(r,e),u=t.pow(r,s);for(;!t.eql(c,t.ONE);){if(t.is0(c))return t.ZERO;let e=1,n=t.sqr(c);for(;!t.eql(n,t.ONE);)if(e++,n=t.sqr(n),e===i)throw new Error("Cannot find square root");const r=ls<<BigInt(i-e-1),o=t.pow(a,r);i=e,a=t.sqr(o),c=t.mul(c,a),u=t.mul(u,o)}return u}}(t)}const xs=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function _s(t){const e=xs.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return ss(t,e)}function As(t,e,n){if(n<us)throw new Error("invalid exponent, negatives unsupported");if(n===us)return t.ONE;if(n===ls)return e;let r=t.ONE,i=e;for(;n>us;)n&ls&&(r=t.mul(r,i)),i=t.sqr(i),n>>=ls;return r}function Ts(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),i=e.reduce(((e,n,i)=>t.is0(n)?e:(r[i]=e,t.mul(e,n))),t.ONE),o=t.inv(i);return e.reduceRight(((e,n,i)=>t.is0(n)?e:(r[i]=t.mul(e,r[i]),t.mul(e,n))),o),r}function Ss(t,e){const n=(t.ORDER-ls)/fs,r=t.pow(e,n),i=t.eql(r,t.ONE),o=t.eql(r,t.ZERO),s=t.eql(r,t.neg(t.ONE));if(!i&&!o&&!s)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function Ns(t,e){void 0!==e&&function(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}(e);const n=void 0!==e?e:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function Bs(t,e,n=!1,r={}){if(t<=us)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:o}=Ns(t,e);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let s;const a=Object.freeze({ORDER:t,isLE:n,BITS:i,BYTES:o,MASK:is(i),ZERO:us,ONE:ls,create:e=>ms(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("invalid field element: expected bigint, got "+typeof e);return us<=e&&e<t},is0:t=>t===us,isOdd:t=>(t&ls)===ls,neg:e=>ms(-e,t),eql:(t,e)=>t===e,sqr:e=>ms(e*e,t),add:(e,n)=>ms(e+n,t),sub:(e,n)=>ms(e-n,t),mul:(e,n)=>ms(e*n,t),pow:(t,e)=>As(a,t,e),div:(e,n)=>ms(e*ys(n,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>ys(e,t),sqrt:r.sqrt||(e=>(s||(s=Es(t)),s(a,e))),toBytes:t=>n?Zo(t,o):Wo(t,o),fromBytes:t=>{if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);return n?Ko(t):Go(t)},invertBatch:t=>Ts(a,t),cmov:(t,e,n)=>n?e:t});return Object.freeze(a)}function Is(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Os(t){const e=Is(t);return e+Math.ceil(e/2)}const Rs=Go;function $s(t,e){if(Ls(t),Ls(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const n=Array.from({length:e}).fill(0);for(let r=e-1;r>=0;r--)n[r]=255&t,t>>>=8;return new Uint8Array(n)}function ks(t,e){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]^e[r];return n}function Ls(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Ps(t,e,n){ss(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:r,k:i,m:o,hash:s,expand:a,DST:c}=n;Do(t),Ls(e);const u="string"==typeof c?Jo(c):c,l=r.toString(2).length,f=Math.ceil((l+i)/8),d=e*o*f;let h;if("xmd"===a)h=function(t,e,n,r){Do(t),Do(e),Ls(n),e.length>255&&(e=r(Xo(Jo("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:o}=r,s=Math.ceil(n/i);if(n>65535||s>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=Xo(e,$s(e.length,1)),c=$s(0,o),u=$s(n,2),l=new Array(s),f=r(Xo(c,t,u,$s(0,1),a));l[0]=r(Xo(f,$s(1,1),a));for(let t=1;t<=s;t++){const e=[ks(f,l[t-1]),$s(t+1,1),a];l[t]=r(Xo(...e))}return Xo(...l).slice(0,n)}(t,u,d,s);else if("xof"===a)h=function(t,e,n,r,i){if(Do(t),Do(e),Ls(n),e.length>255){const t=Math.ceil(2*r/8);e=i.create({dkLen:t}).update(Jo("H2C-OVERSIZE-DST-")).update(e).digest()}if(n>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:n}).update(t).update($s(n,2)).update(e).update($s(e.length,1)).digest()}(t,u,d,i,s);else{if("_internal_pass"!==a)throw new Error('expand must be "xmd" or "xof"');h=t}const p=new Array(e);for(let t=0;t<e;t++){const e=new Array(o);for(let n=0;n<o;n++){const i=f*(n+t*o),s=h.subarray(i,i+f);e[n]=ms(Rs(s),r)}p[t]=e}return p}function Us(t,e){const n=e.map((t=>Array.from(t).reverse()));return(e,r)=>{const[i,o,s,a]=n.map((n=>n.reduce(((n,r)=>t.add(t.mul(n,e),r))))),[c,u]=Ts(t,[o,a],!0);return e=t.mul(i,c),r=t.mul(r,t.mul(s,u)),{x:e,y:r}}}function Ds(t,e,n){if("function"!=typeof e)throw new Error("mapToCurve() must be defined");function r(n){return t.fromAffine(e(n))}function i(e){const n=e.clearCofactor();return n.equals(t.ZERO)?t.ZERO:(n.assertValidity(),n)}return{defaults:n,hashToCurve(t,e){const o=Ps(t,2,{...n,DST:n.DST,...e}),s=r(o[0]),a=r(o[1]);return i(s.add(a))},encodeToCurve:(t,e)=>i(r(Ps(t,1,{...n,DST:n.encodeDST,...e})[0])),mapToCurve(t){if(!Array.isArray(t))throw new Error("expected array of bigints");for(const e of t)if("bigint"!=typeof e)throw new Error("expected array of bigints");return i(r(t))}}}const Cs=BigInt(0),Fs=BigInt(1);function Ms(t,e){const n=e.negate();return t?n:e}function js(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function qs(t,e){js(t,e);const n=2**t;return{windows:Math.ceil(e/t)+1,windowSize:2**(t-1),mask:is(t),maxNumber:n,shiftBy:BigInt(t)}}function Vs(t,e,n){const{windowSize:r,mask:i,maxNumber:o,shiftBy:s}=n;let a=Number(t&i),c=t>>s;a>r&&(a-=o,c+=Fs);const u=e*r;return{nextN:c,offset:u+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:e%2!=0,offsetF:u}}const zs=new WeakMap,Hs=new WeakMap;function Gs(t){return Hs.get(t)||1}function Ks(t,e){return{constTimeNegate:Ms,hasPrecomputes:t=>1!==Gs(t),unsafeLadder(e,n,r=t.ZERO){let i=e;for(;n>Cs;)n&Fs&&(r=r.add(i)),i=i.double(),n>>=Fs;return r},precomputeWindow(t,n){const{windows:r,windowSize:i}=qs(n,e),o=[];let s=t,a=s;for(let t=0;t<r;t++){a=s,o.push(a);for(let t=1;t<i;t++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(n,r,i){let o=t.ZERO,s=t.BASE;const a=qs(n,e);for(let t=0;t<a.windows;t++){const{nextN:e,offset:n,isZero:c,isNeg:u,isNegF:l,offsetF:f}=Vs(i,t,a);i=e,c?s=s.add(Ms(l,r[f])):o=o.add(Ms(u,r[n]))}return{p:o,f:s}},wNAFUnsafe(n,r,i,o=t.ZERO){const s=qs(n,e);for(let t=0;t<s.windows&&i!==Cs;t++){const{nextN:e,offset:n,isZero:a,isNeg:c}=Vs(i,t,s);if(i=e,!a){const t=r[n];o=o.add(c?t.negate():t)}}return o},getPrecomputes(t,e,n){let r=zs.get(e);return r||(r=this.precomputeWindow(e,t),1!==t&&zs.set(e,n(r))),r},wNAFCached(t,e,n){const r=Gs(t);return this.wNAF(r,this.getPrecomputes(r,t,n),e)},wNAFCachedUnsafe(t,e,n,r){const i=Gs(t);return 1===i?this.unsafeLadder(t,e,r):this.wNAFUnsafe(i,this.getPrecomputes(i,t,n),e,r)},setWindowSize(t,n){js(n,e),Hs.set(t,n),zs.delete(t)}}}function Ws(t,e,n,r){!function(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach(((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)}))}(n,t),function(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach(((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)}))}(r,e);const i=n.length,o=r.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,a=ns(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=is(c),l=new Array(Number(u)+1).fill(s);let f=s;for(let t=Math.floor((e.BITS-1)/c)*c;t>=0;t-=c){l.fill(s);for(let e=0;e<o;e++){const i=r[e],o=Number(i>>BigInt(t)&u);l[o]=l[o].add(n[e])}let e=s;for(let t=l.length-1,n=s;t>0;t--)n=n.add(l[t]),e=e.add(n);if(f=f.add(e),0!==t)for(let t=0;t<c;t++)f=f.double()}return f}function Zs(t){return _s(t.Fp),ss(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Ns(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const Ys=BigInt(0),Xs=BigInt(1),Js=BigInt(2),Qs=BigInt(3),ta=BigInt(4);function ea(t){const e=function(t){const e=Zs(t);ss(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:n,Fp:r,a:i}=e;if(n){if(!r.eql(i,r.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}(t),{Fp:n}=e,r=Bs(e.n,e.nBitLength),i=e.toBytes||((t,e,r)=>{const i=e.toAffine();return Xo(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))}),o=e.fromBytes||(t=>{const e=t.subarray(1);return{x:n.fromBytes(e.subarray(0,n.BYTES)),y:n.fromBytes(e.subarray(n.BYTES,2*n.BYTES))}});function s(t){const{a:r,b:i}=e,o=n.sqr(t),s=n.mul(o,t);return n.add(n.add(s,n.mul(t,r)),i)}function a(t,e){const r=n.sqr(e),i=s(t);return n.eql(r,i)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=n.mul(n.pow(e.a,Qs),ta),u=n.mul(n.sqr(e.b),BigInt(27));if(n.is0(n.add(c,u)))throw new Error("bad curve params: a or b");function l(t){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:i,n:o}=e;if(n&&"bigint"!=typeof t){if(Uo(t)&&(t=qo(t)),"string"!=typeof t||!n.includes(t.length))throw new Error("invalid private key");t=t.padStart(2*r,"0")}let s;try{s="bigint"==typeof t?t:Go(Yo("private key",t,r))}catch(e){throw new Error("invalid private key, expected hex or "+r+" bytes, got "+typeof t)}return i&&(s=ms(s,o)),es("private key",s,Xs,o),s}function f(t){if(!(t instanceof p))throw new Error("ProjectivePoint expected")}const d=cs(((t,e)=>{const{px:r,py:i,pz:o}=t;if(n.eql(o,n.ONE))return{x:r,y:i};const s=t.is0();null==e&&(e=s?n.ONE:n.inv(o));const a=n.mul(r,e),c=n.mul(i,e),u=n.mul(o,e);if(s)return{x:n.ZERO,y:n.ZERO};if(!n.eql(u,n.ONE))throw new Error("invZ was invalid");return{x:a,y:c}})),h=cs((t=>{if(t.is0()){if(e.allowInfinityPoint&&!n.is0(t.py))return;throw new Error("bad point: ZERO")}const{x:r,y:i}=t.toAffine();if(!n.isValid(r)||!n.isValid(i))throw new Error("bad point: x or y not FE");if(!a(r,i))throw new Error("bad point: equation left != right");if(!t.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));class p{constructor(t,e,r){if(null==t||!n.isValid(t))throw new Error("x required");if(null==e||!n.isValid(e)||n.is0(e))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required");this.px=t,this.py=e,this.pz=r,Object.freeze(this)}static fromAffine(t){const{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw new Error("invalid affine point");if(t instanceof p)throw new Error("projective point not allowed");const i=t=>n.eql(t,n.ZERO);return i(e)&&i(r)?p.ZERO:new p(e,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=Ts(n,t.map((t=>t.pz)));return t.map(((t,n)=>t.toAffine(e[n]))).map(p.fromAffine)}static fromHex(t){const e=p.fromAffine(o(Yo("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return p.BASE.multiply(l(t))}static msm(t,e){return Ws(p,r,t,e)}_setWindowSize(t){b.setWindowSize(this,t)}assertValidity(){h(this)}hasEvenY(){const{y:t}=this.toAffine();if(n.isOdd)return!n.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){f(t);const{px:e,py:r,pz:i}=this,{px:o,py:s,pz:a}=t,c=n.eql(n.mul(e,a),n.mul(o,i)),u=n.eql(n.mul(r,a),n.mul(s,i));return c&&u}negate(){return new p(this.px,n.neg(this.py),this.pz)}double(){const{a:t,b:r}=e,i=n.mul(r,Qs),{px:o,py:s,pz:a}=this;let c=n.ZERO,u=n.ZERO,l=n.ZERO,f=n.mul(o,o),d=n.mul(s,s),h=n.mul(a,a),g=n.mul(o,s);return g=n.add(g,g),l=n.mul(o,a),l=n.add(l,l),c=n.mul(t,l),u=n.mul(i,h),u=n.add(c,u),c=n.sub(d,u),u=n.add(d,u),u=n.mul(c,u),c=n.mul(g,c),l=n.mul(i,l),h=n.mul(t,h),g=n.sub(f,h),g=n.mul(t,g),g=n.add(g,l),l=n.add(f,f),f=n.add(l,f),f=n.add(f,h),f=n.mul(f,g),u=n.add(u,f),h=n.mul(s,a),h=n.add(h,h),f=n.mul(h,g),c=n.sub(c,f),l=n.mul(h,d),l=n.add(l,l),l=n.add(l,l),new p(c,u,l)}add(t){f(t);const{px:r,py:i,pz:o}=this,{px:s,py:a,pz:c}=t;let u=n.ZERO,l=n.ZERO,d=n.ZERO;const h=e.a,g=n.mul(e.b,Qs);let m=n.mul(r,s),b=n.mul(i,a),y=n.mul(o,c),w=n.add(r,i),v=n.add(s,a);w=n.mul(w,v),v=n.add(m,b),w=n.sub(w,v),v=n.add(r,o);let E=n.add(s,c);return v=n.mul(v,E),E=n.add(m,y),v=n.sub(v,E),E=n.add(i,o),u=n.add(a,c),E=n.mul(E,u),u=n.add(b,y),E=n.sub(E,u),d=n.mul(h,v),u=n.mul(g,y),d=n.add(u,d),u=n.sub(b,d),d=n.add(b,d),l=n.mul(u,d),b=n.add(m,m),b=n.add(b,m),y=n.mul(h,y),v=n.mul(g,v),b=n.add(b,y),y=n.sub(m,y),y=n.mul(h,y),v=n.add(v,y),m=n.mul(b,v),l=n.add(l,m),m=n.mul(E,v),u=n.mul(w,u),u=n.sub(u,m),m=n.mul(w,b),d=n.mul(E,d),d=n.add(d,m),new p(u,l,d)}subtract(t){return this.add(t.negate())}is0(){return this.equals(p.ZERO)}wNAF(t){return b.wNAFCached(this,t,p.normalizeZ)}multiplyUnsafe(t){const{endo:r,n:i}=e;es("scalar",t,Ys,i);const o=p.ZERO;if(t===Ys)return o;if(this.is0()||t===Xs)return this;if(!r||b.hasPrecomputes(this))return b.wNAFCachedUnsafe(this,t,p.normalizeZ);let{k1neg:s,k1:a,k2neg:c,k2:u}=r.splitScalar(t),l=o,f=o,d=this;for(;a>Ys||u>Ys;)a&Xs&&(l=l.add(d)),u&Xs&&(f=f.add(d)),d=d.double(),a>>=Xs,u>>=Xs;return s&&(l=l.negate()),c&&(f=f.negate()),f=new p(n.mul(f.px,r.beta),f.py,f.pz),l.add(f)}multiply(t){const{endo:r,n:i}=e;let o,s;if(es("scalar",t,Xs,i),r){const{k1neg:e,k1:i,k2neg:a,k2:c}=r.splitScalar(t);let{p:u,f:l}=this.wNAF(i),{p:f,f:d}=this.wNAF(c);u=b.constTimeNegate(e,u),f=b.constTimeNegate(a,f),f=new p(n.mul(f.px,r.beta),f.py,f.pz),o=u.add(f),s=l.add(d)}else{const{p:e,f:n}=this.wNAF(t);o=e,s=n}return p.normalizeZ([o,s])[0]}multiplyAndAddUnsafe(t,e,n){const r=p.BASE,i=(t,e)=>e!==Ys&&e!==Xs&&t.equals(r)?t.multiply(e):t.multiplyUnsafe(e),o=i(this,e).add(i(t,n));return o.is0()?void 0:o}toAffine(t){return d(this,t)}isTorsionFree(){const{h:t,isTorsionFree:n}=e;if(t===Xs)return!0;if(n)return n(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:n}=e;return t===Xs?this:n?n(p,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return Co("isCompressed",t),this.assertValidity(),i(p,this,t)}toHex(t=!0){return Co("isCompressed",t),qo(this.toRawBytes(t))}}p.BASE=new p(e.Gx,e.Gy,n.ONE),p.ZERO=new p(n.ZERO,n.ONE,n.ZERO);const{endo:g,nBitLength:m}=e,b=Ks(p,g?Math.ceil(m/2):m);return{CURVE:e,ProjectivePoint:p,normPrivateKeyToScalar:l,weierstrassEquation:s,isWithinCurveOrder:function(t){return ts(t,Xs,e.n)}}}function na(t,e){if(_s(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=function(t,e){const n=t.ORDER;let r=Ys;for(let t=n-Xs;t%Js===Ys;t/=Js)r+=Xs;const i=r,o=Js<<i-Xs-Xs,s=o*Js,a=(n-Xs)/s,c=(a-Xs)/Js,u=s-Xs,l=o,f=t.pow(e,a),d=t.pow(e,(a+Xs)/Js);let h=(e,n)=>{let r=f,o=t.pow(n,u),s=t.sqr(o);s=t.mul(s,n);let a=t.mul(e,s);a=t.pow(a,c),a=t.mul(a,o),o=t.mul(a,n),s=t.mul(a,e);let h=t.mul(s,o);a=t.pow(h,l);let p=t.eql(a,t.ONE);o=t.mul(s,d),a=t.mul(h,r),s=t.cmov(o,s,p),h=t.cmov(a,h,p);for(let e=i;e>Xs;e--){let n=e-Js;n=Js<<n-Xs;let i=t.pow(h,n);const a=t.eql(i,t.ONE);o=t.mul(s,r),r=t.mul(r,r),i=t.mul(h,r),s=t.cmov(o,s,a),h=t.cmov(i,h,a)}return{isValid:p,value:s}};if(t.ORDER%ta===Qs){const n=(t.ORDER-Qs)/ta,r=t.sqrt(t.neg(e));h=(e,i)=>{let o=t.sqr(i);const s=t.mul(e,i);o=t.mul(o,s);let a=t.pow(o,n);a=t.mul(a,s);const c=t.mul(a,r),u=t.mul(t.sqr(a),i),l=t.eql(u,e);return{isValid:l,value:t.cmov(c,a,l)}}}return h}(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let i,o,s,a,c,u,l,f;i=t.sqr(r),i=t.mul(i,e.Z),o=t.sqr(i),o=t.add(o,i),s=t.add(o,t.ONE),s=t.mul(s,e.B),a=t.cmov(e.Z,t.neg(o),!t.eql(o,t.ZERO)),a=t.mul(a,e.A),o=t.sqr(s),u=t.sqr(a),c=t.mul(u,e.A),o=t.add(o,c),o=t.mul(o,s),u=t.mul(u,a),c=t.mul(u,e.B),o=t.add(o,c),l=t.mul(i,s);const{isValid:d,value:h}=n(o,u);f=t.mul(i,r),f=t.mul(f,h),l=t.cmov(l,s,d),f=t.cmov(f,h,d);const p=t.isOdd(r)===t.isOdd(f);f=t.cmov(t.neg(f),f,p);const g=Ts(t,[a],!0)[0];return l=t.mul(l,g),{x:l,y:f}}}const ra=BigInt(0),ia=BigInt(1),oa=BigInt(2),sa=BigInt(3);const aa=BigInt(0),ca=BigInt(1),ua=BigInt(2),la=BigInt(3);function fa(t,e,n,r,i=1,o){const s=BigInt(void 0===o?r:o),a=n**BigInt(r),c=[];for(let o=0;o<i;o++){const i=BigInt(o+1),u=[];for(let o=0,c=ca;o<r;o++){const r=(i*c-i)/s%a;u.push(t.pow(e,r)),c*=n}c.push(u)}return c}const da=BigInt(0),ha=BigInt(1),pa=BigInt(2),ma=BigInt(3),ba=BigInt(4),ya=BigInt("0xd201000000010000"),wa=ns(ya),{Fp:va,Fp2:Ea,Fp6:xa,Fp4Square:_a,Fp12:Aa}=function(t){const{ORDER:e}=t,n=Bs(e),r=n.create(t.NONRESIDUE||BigInt(-1)),i=n.div(n.ONE,ua),o=fa(n,r,n.ORDER,2)[0],s=({c0:t,c1:e},{c0:r,c1:i})=>({c0:n.add(t,r),c1:n.add(e,i)}),a=({c0:t,c1:e},{c0:r,c1:i})=>({c0:n.sub(t,r),c1:n.sub(e,i)}),c=({c0:t,c1:e},r)=>{if("bigint"==typeof r)return{c0:n.mul(t,r),c1:n.mul(e,r)};const{c0:i,c1:o}=r;let s=n.mul(t,i),a=n.mul(e,o);return{c0:n.sub(s,a),c1:n.sub(n.mul(n.add(t,e),n.add(i,o)),n.add(s,a))}},u=({c0:t,c1:e})=>{const r=n.add(t,e),i=n.sub(t,e),o=n.add(t,t);return{c0:n.mul(r,i),c1:n.mul(o,e)}},l=t=>{if(2!==t.length)throw new Error("invalid tuple");const e=t.map((t=>n.create(t)));return{c0:e[0],c1:e[1]}},f=e*e,d=l(t.FP2_NONRESIDUE),h={ORDER:f,isLE:n.isLE,NONRESIDUE:d,BITS:ns(f),BYTES:Math.ceil(ns(f)/8),MASK:is(ns(f)),ZERO:{c0:n.ZERO,c1:n.ZERO},ONE:{c0:n.ONE,c1:n.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>"bigint"==typeof t&&"bigint"==typeof e,is0:({c0:t,c1:e})=>n.is0(t)&&n.is0(e),eql:({c0:t,c1:e},{c0:r,c1:i})=>n.eql(t,r)&&n.eql(e,i),neg:({c0:t,c1:e})=>({c0:n.neg(t),c1:n.neg(e)}),pow:(t,e)=>As(h,t,e),invertBatch:t=>Ts(h,t),add:s,sub:a,mul:c,sqr:u,addN:s,subN:a,mulN:c,sqrN:u,div:(t,e)=>h.mul(t,"bigint"==typeof e?n.inv(n.create(e)):h.inv(e)),inv:({c0:t,c1:e})=>{const r=n.inv(n.create(t*t+e*e));return{c0:n.mul(r,n.create(t)),c1:n.mul(r,n.create(-e))}},sqrt:e=>{if(t.Fp2sqrt)return t.Fp2sqrt(e);const{c0:o,c1:s}=e;if(n.is0(s))return 1===Ss(n,o)?h.create({c0:n.sqrt(o),c1:n.ZERO}):h.create({c0:n.ZERO,c1:n.sqrt(n.div(o,r))});const a=n.sqrt(n.sub(n.sqr(o),n.mul(n.sqr(s),r)));let c=n.mul(n.add(a,o),i);-1===Ss(n,c)&&(c=n.sub(c,a));const u=n.sqrt(c),l=h.create({c0:u,c1:n.div(n.mul(s,i),u)});if(!h.eql(h.sqr(l),e))throw new Error("Cannot find square root");const f=l,d=h.neg(f),{re:p,im:g}=h.reim(f),{re:m,im:b}=h.reim(d);return g>b||g===b&&p>m?f:d},isOdd:t=>{const{re:e,im:n}=h.reim(t);return BigInt(e%ua||e===aa&&n%ua)==ca},fromBytes(t){if(t.length!==h.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:n.fromBytes(t.subarray(0,n.BYTES)),c1:n.fromBytes(t.subarray(n.BYTES))}},toBytes:({c0:t,c1:e})=>Xo(n.toBytes(t),n.toBytes(e)),cmov:({c0:t,c1:e},{c0:r,c1:i},o)=>({c0:n.cmov(t,r,o),c1:n.cmov(e,i,o)}),reim:({c0:t,c1:e})=>({re:t,im:e}),mulByNonresidue:({c0:t,c1:e})=>h.mul({c0:t,c1:e},d),mulByB:t.Fp2mulByB,fromBigTuple:l,frobeniusMap:({c0:t,c1:e},r)=>({c0:t,c1:n.mul(e,o[r%2])})},p=({c0:t,c1:e,c2:n},{c0:r,c1:i,c2:o})=>({c0:h.add(t,r),c1:h.add(e,i),c2:h.add(n,o)}),g=({c0:t,c1:e,c2:n},{c0:r,c1:i,c2:o})=>({c0:h.sub(t,r),c1:h.sub(e,i),c2:h.sub(n,o)}),m=({c0:t,c1:e,c2:n},r)=>{if("bigint"==typeof r)return{c0:h.mul(t,r),c1:h.mul(e,r),c2:h.mul(n,r)};const{c0:i,c1:o,c2:s}=r,a=h.mul(t,i),c=h.mul(e,o),u=h.mul(n,s);return{c0:h.add(a,h.mulByNonresidue(h.sub(h.mul(h.add(e,n),h.add(o,s)),h.add(c,u)))),c1:h.add(h.sub(h.mul(h.add(t,e),h.add(i,o)),h.add(a,c)),h.mulByNonresidue(u)),c2:h.sub(h.add(c,h.mul(h.add(t,n),h.add(i,s))),h.add(a,u))}},b=({c0:t,c1:e,c2:n})=>{let r=h.sqr(t),i=h.mul(h.mul(t,e),ua),o=h.mul(h.mul(e,n),ua),s=h.sqr(n);return{c0:h.add(h.mulByNonresidue(o),r),c1:h.add(h.mulByNonresidue(s),i),c2:h.sub(h.sub(h.add(h.add(i,h.sqr(h.add(h.sub(t,e),n))),o),r),s)}},[y,w]=fa(h,d,n.ORDER,6,2,3),v={ORDER:h.ORDER,isLE:h.isLE,BITS:3*h.BITS,BYTES:3*h.BYTES,MASK:is(3*h.BITS),ZERO:{c0:h.ZERO,c1:h.ZERO,c2:h.ZERO},ONE:{c0:h.ONE,c1:h.ZERO,c2:h.ZERO},create:t=>t,isValid:({c0:t,c1:e,c2:n})=>h.isValid(t)&&h.isValid(e)&&h.isValid(n),is0:({c0:t,c1:e,c2:n})=>h.is0(t)&&h.is0(e)&&h.is0(n),neg:({c0:t,c1:e,c2:n})=>({c0:h.neg(t),c1:h.neg(e),c2:h.neg(n)}),eql:({c0:t,c1:e,c2:n},{c0:r,c1:i,c2:o})=>h.eql(t,r)&&h.eql(e,i)&&h.eql(n,o),sqrt:as,div:(t,e)=>v.mul(t,"bigint"==typeof e?n.inv(n.create(e)):v.inv(e)),pow:(t,e)=>As(v,t,e),invertBatch:t=>Ts(v,t),add:p,sub:g,mul:m,sqr:b,addN:p,subN:g,mulN:m,sqrN:b,inv:({c0:t,c1:e,c2:n})=>{let r=h.sub(h.sqr(t),h.mulByNonresidue(h.mul(n,e))),i=h.sub(h.mulByNonresidue(h.sqr(n)),h.mul(t,e)),o=h.sub(h.sqr(e),h.mul(t,n)),s=h.inv(h.add(h.mulByNonresidue(h.add(h.mul(n,i),h.mul(e,o))),h.mul(t,r)));return{c0:h.mul(s,r),c1:h.mul(s,i),c2:h.mul(s,o)}},fromBytes:t=>{if(t.length!==v.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:h.fromBytes(t.subarray(0,h.BYTES)),c1:h.fromBytes(t.subarray(h.BYTES,2*h.BYTES)),c2:h.fromBytes(t.subarray(2*h.BYTES))}},toBytes:({c0:t,c1:e,c2:n})=>Xo(h.toBytes(t),h.toBytes(e),h.toBytes(n)),cmov:({c0:t,c1:e,c2:n},{c0:r,c1:i,c2:o},s)=>({c0:h.cmov(t,r,s),c1:h.cmov(e,i,s),c2:h.cmov(n,o,s)}),fromBigSix:t=>{if(!Array.isArray(t)||6!==t.length)throw new Error("invalid Fp6 usage");return{c0:h.fromBigTuple(t.slice(0,2)),c1:h.fromBigTuple(t.slice(2,4)),c2:h.fromBigTuple(t.slice(4,6))}},frobeniusMap:({c0:t,c1:e,c2:n},r)=>({c0:h.frobeniusMap(t,r),c1:h.mul(h.frobeniusMap(e,r),y[r%6]),c2:h.mul(h.frobeniusMap(n,r),w[r%6])}),mulByFp2:({c0:t,c1:e,c2:n},r)=>({c0:h.mul(t,r),c1:h.mul(e,r),c2:h.mul(n,r)}),mulByNonresidue:({c0:t,c1:e,c2:n})=>({c0:h.mulByNonresidue(n),c1:t,c2:e}),mul1:({c0:t,c1:e,c2:n},r)=>({c0:h.mulByNonresidue(h.mul(n,r)),c1:h.mul(t,r),c2:h.mul(e,r)}),mul01({c0:t,c1:e,c2:n},r,i){let o=h.mul(t,r),s=h.mul(e,i);return{c0:h.add(h.mulByNonresidue(h.sub(h.mul(h.add(e,n),i),s)),o),c1:h.sub(h.sub(h.mul(h.add(r,i),h.add(t,e)),o),s),c2:h.add(h.sub(h.mul(h.add(t,n),r),o),s)}}},E=fa(h,d,n.ORDER,12,1,6)[0],x=({c0:t,c1:e},{c0:n,c1:r})=>({c0:v.add(t,n),c1:v.add(e,r)}),_=({c0:t,c1:e},{c0:n,c1:r})=>({c0:v.sub(t,n),c1:v.sub(e,r)}),A=({c0:t,c1:e},n)=>{if("bigint"==typeof n)return{c0:v.mul(t,n),c1:v.mul(e,n)};let{c0:r,c1:i}=n,o=v.mul(t,r),s=v.mul(e,i);return{c0:v.add(o,v.mulByNonresidue(s)),c1:v.sub(v.mul(v.add(t,e),v.add(r,i)),v.add(o,s))}},T=({c0:t,c1:e})=>{let n=v.mul(t,e);return{c0:v.sub(v.sub(v.mul(v.add(v.mulByNonresidue(e),t),v.add(t,e)),n),v.mulByNonresidue(n)),c1:v.add(n,n)}},S={ORDER:h.ORDER,isLE:v.isLE,BITS:2*v.BITS,BYTES:2*v.BYTES,MASK:is(2*v.BITS),ZERO:{c0:v.ZERO,c1:v.ZERO},ONE:{c0:v.ONE,c1:v.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>v.isValid(t)&&v.isValid(e),is0:({c0:t,c1:e})=>v.is0(t)&&v.is0(e),neg:({c0:t,c1:e})=>({c0:v.neg(t),c1:v.neg(e)}),eql:({c0:t,c1:e},{c0:n,c1:r})=>v.eql(t,n)&&v.eql(e,r),sqrt:as,inv:({c0:t,c1:e})=>{let n=v.inv(v.sub(v.sqr(t),v.mulByNonresidue(v.sqr(e))));return{c0:v.mul(t,n),c1:v.neg(v.mul(e,n))}},div:(t,e)=>S.mul(t,"bigint"==typeof e?n.inv(n.create(e)):S.inv(e)),pow:(t,e)=>As(S,t,e),invertBatch:t=>Ts(S,t),add:x,sub:_,mul:A,sqr:T,addN:x,subN:_,mulN:A,sqrN:T,fromBytes:t=>{if(t.length!==S.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:v.fromBytes(t.subarray(0,v.BYTES)),c1:v.fromBytes(t.subarray(v.BYTES))}},toBytes:({c0:t,c1:e})=>Xo(v.toBytes(t),v.toBytes(e)),cmov:({c0:t,c1:e},{c0:n,c1:r},i)=>({c0:v.cmov(t,n,i),c1:v.cmov(e,r,i)}),fromBigTwelve:t=>({c0:v.fromBigSix(t.slice(0,6)),c1:v.fromBigSix(t.slice(6,12))}),frobeniusMap(t,e){const{c0:n,c1:r,c2:i}=v.frobeniusMap(t.c1,e),o=E[e%12];return{c0:v.frobeniusMap(t.c0,e),c1:v.create({c0:h.mul(n,o),c1:h.mul(r,o),c2:h.mul(i,o)})}},mulByFp2:({c0:t,c1:e},n)=>({c0:v.mulByFp2(t,n),c1:v.mulByFp2(e,n)}),conjugate:({c0:t,c1:e})=>({c0:t,c1:v.neg(e)}),mul014:({c0:t,c1:e},n,r,i)=>{let o=v.mul01(t,n,r),s=v.mul1(e,i);return{c0:v.add(v.mulByNonresidue(s),o),c1:v.sub(v.sub(v.mul01(v.add(e,t),n,h.add(r,i)),o),s)}},mul034:({c0:t,c1:e},n,r,i)=>{const o=v.create({c0:h.mul(t.c0,n),c1:h.mul(t.c1,n),c2:h.mul(t.c2,n)}),s=v.mul01(e,r,i),a=v.mul01(v.add(t,e),h.add(n,r),i);return{c0:v.add(v.mulByNonresidue(s),o),c1:v.sub(a,v.add(o,s))}},_cyclotomicSquare:t.Fp12cyclotomicSquare,_cyclotomicExp:t.Fp12cyclotomicExp,finalExponentiate:t.Fp12finalExponentiate};return{Fp:n,Fp2:h,Fp6:v,Fp4Square:function(t,e){const n=h.sqr(t),r=h.sqr(e);return{first:h.add(h.mulByNonresidue(r),n),second:h.sub(h.sub(h.sqr(h.add(t,e)),n),r)}},Fp12:S}}({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[ha,ha],Fp2mulByB:({c0:t,c1:e})=>{const n=va.mul(t,ba),r=va.mul(e,ba);return{c0:va.sub(n,r),c1:va.add(n,r)}},Fp12cyclotomicSquare:({c0:t,c1:e})=>{const{c0:n,c1:r,c2:i}=t,{c0:o,c1:s,c2:a}=e,{first:c,second:u}=_a(n,s),{first:l,second:f}=_a(o,i),{first:d,second:h}=_a(r,a),p=Ea.mulByNonresidue(h);return{c0:xa.create({c0:Ea.add(Ea.mul(Ea.sub(c,n),pa),c),c1:Ea.add(Ea.mul(Ea.sub(l,r),pa),l),c2:Ea.add(Ea.mul(Ea.sub(d,i),pa),d)}),c1:xa.create({c0:Ea.add(Ea.mul(Ea.add(p,o),pa),p),c1:Ea.add(Ea.mul(Ea.add(u,s),pa),u),c2:Ea.add(Ea.mul(Ea.add(f,a),pa),f)})}},Fp12cyclotomicExp(t,e){let n=Aa.ONE;for(let r=wa-1;r>=0;r--)n=Aa._cyclotomicSquare(n),rs(e,r)&&(n=Aa.mul(n,t));return n},Fp12finalExponentiate:t=>{const e=ya,n=Aa.div(Aa.frobeniusMap(t,6),t),r=Aa.mul(Aa.frobeniusMap(n,2),n),i=Aa.conjugate(Aa._cyclotomicExp(r,e)),o=Aa.mul(Aa.conjugate(Aa._cyclotomicSquare(r)),i),s=Aa.conjugate(Aa._cyclotomicExp(o,e)),a=Aa.conjugate(Aa._cyclotomicExp(s,e)),c=Aa.mul(Aa.conjugate(Aa._cyclotomicExp(a,e)),Aa._cyclotomicSquare(i)),u=Aa.conjugate(Aa._cyclotomicExp(c,e)),l=Aa.frobeniusMap(Aa.mul(i,a),2),f=Aa.frobeniusMap(Aa.mul(s,r),3),d=Aa.frobeniusMap(Aa.mul(c,Aa.conjugate(r)),1),h=Aa.mul(Aa.mul(u,Aa.conjugate(o)),r);return Aa.mul(Aa.mul(Aa.mul(l,f),d),h)}}),Ta=Bs(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),Sa=Us(Ea,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map((t=>t.map((t=>Ea.fromBigTuple(t.map(BigInt))))))),Na=Us(va,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map((t=>t.map((t=>BigInt(t)))))),Ba=na(Ea,{A:Ea.create({c0:va.create(da),c1:va.create(BigInt(240))}),B:Ea.create({c0:va.create(BigInt(1012)),c1:va.create(BigInt(1012))}),Z:Ea.create({c0:va.create(BigInt(-2)),c1:va.create(BigInt(-1))})}),Ia=na(va,{A:va.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:va.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:va.create(BigInt(11))}),{G2psi:Oa,G2psi2:Ra}=function(t,e,n){const r=e.pow(n,(t.ORDER-ca)/la),i=e.pow(n,(t.ORDER-ca)/ua);function o(t,n){return[e.mul(e.frobeniusMap(t,1),r),e.mul(e.frobeniusMap(n,1),i)]}const s=e.pow(n,(t.ORDER**ua-ca)/la),a=e.pow(n,(t.ORDER**ua-ca)/ua);if(!e.eql(a,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function c(t,n){return[e.mul(t,s),e.neg(n)]}const u=t=>(e,n)=>{const r=n.toAffine(),i=t(r.x,r.y);return e.fromAffine({x:i[0],y:i[1]})};return{psi:o,psi2:c,G2psi:u(o),G2psi2:u(c),PSI_X:r,PSI_Y:i,PSI2_X:s,PSI2_Y:a}}(va,Ea,Ea.div(Ea.ONE,Ea.NONRESIDUE)),$a=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:va.ORDER,m:2,k:128,expand:"xmd",hash:Me}),ka=Pa(va.toBytes(da),{infinity:!0,compressed:!0});function La(t){const e=224&(t=t.slice())[0],n=!!(e>>7&1),r=!!(e>>6&1),i=!!(e>>5&1);return t[0]&=31,{compressed:n,infinity:r,sort:i,value:t}}function Pa(t,e){if(224&t[0])throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function Ua(t){t.assertValidity();const e=t.equals(Ca.G1.ProjectivePoint.ZERO),{x:n,y:r}=t.toAffine();if(e)return ka.slice();const i=va.ORDER,o=Boolean(r*pa/i);return Pa(Wo(n,va.BYTES),{compressed:!0,sort:o})}function Da(t){t.assertValidity();const e=va.BYTES;if(t.equals(Ca.G2.ProjectivePoint.ZERO))return Xo(ka,Wo(da,e));const{x:n,y:r}=t.toAffine(),{re:i,im:o}=Ea.reim(n),{re:s,im:a}=Ea.reim(r),c=Boolean((a>da?a*pa:s*pa)/va.ORDER&ha),u=i;return Xo(Pa(Wo(o,e),{sort:c,compressed:!0}),Wo(u,e))}const Ca=function(t){const{Fp:e,Fr:n,Fp2:r,Fp6:i,Fp12:o}=t.fields,s=t.params.xNegative,a=t.params.twistType,c=ea({n:n.ORDER,...t.G1}),u=Object.assign(c,Ds(c.ProjectivePoint,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),l=ea({n:n.ORDER,...t.G2}),f=Object.assign(l,Ds(l.ProjectivePoint,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults}));let d;if("multiplicative"===a)d=(t,e,n,i,s,a)=>o.mul014(i,t,r.mul(e,s),r.mul(n,a));else{if("divisive"!==a)throw new Error("bls: unknown twist type");d=(t,e,n,i,s,a)=>o.mul034(i,r.mul(n,a),r.mul(e,s),t)}const h=r.div(r.ONE,r.mul(r.ONE,oa));function p(t,e,n,i){const o=r.sqr(n),s=r.sqr(i),a=r.mulByB(r.mul(s,sa)),c=r.mul(a,sa),u=r.sub(r.sub(r.sqr(r.add(n,i)),s),o),l=r.sub(a,o),f=r.mul(r.sqr(e),sa),d=r.neg(u);return t.push([l,f,d]),{Rx:e=r.mul(r.mul(r.mul(r.sub(o,c),e),n),h),Ry:n=r.sub(r.sqr(r.mul(r.add(o,c),h)),r.mul(r.sqr(a),sa)),Rz:i=r.mul(o,u)}}function g(t,e,n,i,o,s){const a=r.sub(n,r.mul(s,i)),c=r.sub(e,r.mul(o,i)),u=r.sub(r.mul(a,o),r.mul(c,s)),l=r.neg(a),f=c;t.push([u,l,f]);const d=r.sqr(c),h=r.mul(d,c),p=r.mul(d,e),g=r.add(r.sub(h,r.mul(p,oa)),r.mul(r.sqr(a),i));return{Rx:e=r.mul(c,g),Ry:n=r.sub(r.mul(r.sub(p,g),a),r.mul(h,n)),Rz:i=r.mul(i,h)}}const m=function(t){const e=[];for(;t>ia;t>>=ia)(t&ia)===ra?e.unshift(0):(t&sa)===sa?(e.unshift(-1),t+=ia):e.unshift(1);return e}(t.params.ateLoopSize),b=cs((e=>{const n=e,{x:i,y:o}=n.toAffine(),s=i,a=o,c=r.neg(o);let u=s,l=a,f=r.ONE;const d=[];for(const t of m){const e=[];({Rx:u,Ry:l,Rz:f}=p(e,u,l,f)),t&&({Rx:u,Ry:l,Rz:f}=g(e,u,l,f,s,-1===t?c:a)),d.push(e)}if(t.postPrecompute){const e=d[d.length-1];t.postPrecompute(u,l,f,s,a,g.bind(null,e))}return d}));function y(t,e=!1){let n=o.ONE;if(t.length){const e=t[0][0].length;for(let r=0;r<e;r++){n=o.sqr(n);for(const[e,i,o]of t)for(const[t,s,a]of e[r])n=d(t,s,a,n,i,o)}}return s&&(n=o.conjugate(n)),e?o.finalExponentiate(n):n}function w(t,e=!0){const n=[];u.ProjectivePoint.normalizeZ(t.map((({g1:t})=>t))),f.ProjectivePoint.normalizeZ(t.map((({g2:t})=>t)));for(const{g1:e,g2:r}of t){if(e.equals(u.ProjectivePoint.ZERO)||r.equals(f.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");e.assertValidity(),r.assertValidity();const t=e.toAffine();n.push([b(r),t.x,t.y])}return y(n,e)}const v={randomPrivateKey:()=>{const e=Os(n.ORDER);return function(t,e,n=!1){const r=t.length,i=Is(e),o=Os(e);if(r<16||r<o||r>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+r);const s=ms(n?Ko(t):Go(t),e-ls)+ls;return n?Zo(s,i):Wo(s,i)}(t.randomBytes(e),n.ORDER)},calcPairingPrecomputes:b},{ShortSignature:E}=t.G1,{Signature:x}=t.G2;function _(t){return t instanceof u.ProjectivePoint?t:u.ProjectivePoint.fromHex(t)}function A(t,e){return t instanceof u.ProjectivePoint?t:u.hashToCurve(Yo("point",t),e)}function T(t){return t instanceof f.ProjectivePoint?t:x.fromHex(t)}function S(t,e){return t instanceof f.ProjectivePoint?t:f.hashToCurve(Yo("point",t),e)}function N(t){if(!Array.isArray(t)||0===t.length)throw new Error("expected non-empty array")}return u.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:function(t){return u.ProjectivePoint.fromPrivateKey(t).toRawBytes(!0)},getPublicKeyForShortSignatures:function(t){return f.ProjectivePoint.fromPrivateKey(t).toRawBytes(!0)},sign:function(t,e,n){const r=S(t,n);r.assertValidity();const i=r.multiply(u.normPrivateKeyToScalar(e));return t instanceof f.ProjectivePoint?i:x.toRawBytes(i)},signShortSignature:function(t,e,n){const r=A(t,n);r.assertValidity();const i=r.multiply(u.normPrivateKeyToScalar(e));return t instanceof u.ProjectivePoint?i:E.toRawBytes(i)},verify:function(t,e,n,r){const i=_(n),s=S(e,r),a=u.ProjectivePoint.BASE,c=T(t),l=w([{g1:i.negate(),g2:s},{g1:a,g2:c}]);return o.eql(l,o.ONE)},verifyBatch:function(t,e,n,r){if(N(e),n.length!==e.length)throw new Error("amount of public keys and messages should be equal");const i=T(t),s=e.map((t=>S(t,r))),a=n.map(_),c=new Map;for(let t=0;t<a.length;t++){const e=a[t],n=s[t];let r=c.get(n);void 0===r&&(r=[],c.set(n,r)),r.push(e)}const l=[];try{for(const[t,e]of c){const n=e.reduce(((t,e)=>t.add(e)));l.push({g1:n,g2:t})}return l.push({g1:u.ProjectivePoint.BASE.negate(),g2:i}),o.eql(w(l),o.ONE)}catch{return!1}},verifyShortSignature:function(t,e,n,r){const i=T(n),s=A(e,r),a=f.ProjectivePoint.BASE,c=w([{g1:s,g2:i},{g1:_(t),g2:a.negate()}]);return o.eql(c,o.ONE)},aggregatePublicKeys:function(t){N(t);const e=t.map(_).reduce(((t,e)=>t.add(e)),u.ProjectivePoint.ZERO);return t[0]instanceof u.ProjectivePoint?(e.assertValidity(),e):e.toRawBytes(!0)},aggregateSignatures:function(t){N(t);const e=t.map(T).reduce(((t,e)=>t.add(e)),f.ProjectivePoint.ZERO);return t[0]instanceof f.ProjectivePoint?(e.assertValidity(),e):x.toRawBytes(e)},aggregateShortSignatures:function(t){N(t);const e=t.map(_).reduce(((t,e)=>t.add(e)),u.ProjectivePoint.ZERO);return t[0]instanceof u.ProjectivePoint?(e.assertValidity(),e):E.toRawBytes(e)},millerLoopBatch:y,pairing:function(t,e,n=!0){return w([{g1:t,g2:e}],n)},pairingBatch:w,G1:u,G2:f,Signature:x,ShortSignature:E,fields:{Fr:n,Fp:e,Fp2:r,Fp6:i,Fp12:o},params:{ateLoopSize:t.params.ateLoopSize,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:v}}({fields:{Fp:va,Fp2:Ea,Fp6:xa,Fp12:Aa,Fr:Ta},G1:{Fp:va,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:va.ZERO,b:ba,htfDefaults:{...$a,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const n=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),r=new t(va.mul(e.px,n),e.py,e.pz);return e.multiplyUnsafe(ya).negate().multiplyUnsafe(ya).equals(r)},clearCofactor:(t,e)=>e.multiplyUnsafe(ya).add(e),mapToCurve:t=>{const{x:e,y:n}=Ia(va.create(t[0]));return Na(e,n)},fromBytes:t=>{const{compressed:e,infinity:n,sort:r,value:i}=La(t);if(48===i.length&&e){const t=va.ORDER,e=Go(i),o=va.create(e&va.MASK);if(n){if(o!==da)throw new Error("G1: non-empty compressed point at infinity");return{x:da,y:da}}const s=va.add(va.pow(o,ma),va.create(Ca.params.G1b));let a=va.sqrt(s);if(!a)throw new Error("invalid compressed G1 point");return a*pa/t!==BigInt(r)&&(a=va.neg(a)),{x:va.create(o),y:va.create(a)}}if(96!==i.length||e)throw new Error("invalid point G1, expected 48/96 bytes");{const t=Go(i.subarray(0,va.BYTES)),e=Go(i.subarray(va.BYTES));if(n){if(t!==da||e!==da)throw new Error("G1: non-empty point at infinity");return Ca.G1.ProjectivePoint.ZERO.toAffine()}return{x:va.create(t),y:va.create(e)}}},toBytes:(t,e,n)=>{const r=e.equals(t.ZERO),{x:i,y:o}=e.toAffine();if(n){if(r)return ka.slice();const t=va.ORDER,e=Boolean(o*pa/t);return Pa(Wo(i,va.BYTES),{compressed:!0,sort:e})}if(r){return Xo(new Uint8Array([64]),new Uint8Array(2*va.BYTES-1))}return Xo(Wo(i,va.BYTES),Wo(o,va.BYTES))},ShortSignature:{fromHex(t){const{infinity:e,sort:n,value:r}=La(Yo("signatureHex",t,48)),i=va.ORDER,o=Go(r);if(e)return Ca.G1.ProjectivePoint.ZERO;const s=va.create(o&va.MASK),a=va.add(va.pow(s,ma),va.create(Ca.params.G1b));let c=va.sqrt(a);if(!c)throw new Error("invalid compressed G1 point");const u=BigInt(n);c*pa/i!==u&&(c=va.neg(c));const l=Ca.G1.ProjectivePoint.fromAffine({x:s,y:c});return l.assertValidity(),l},toRawBytes:t=>Ua(t),toHex:t=>qo(Ua(t))}},G2:{Fp:Ea,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:Ea.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:Ea.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:Ea.ZERO,b:Ea.fromBigTuple([ba,ba]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...$a},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:t=>{const{x:e,y:n}=Ba(Ea.fromBigTuple(t));return Sa(e,n)},isTorsionFree:(t,e)=>e.multiplyUnsafe(ya).negate().equals(Oa(t,e)),clearCofactor:(t,e)=>{const n=ya;let r=e.multiplyUnsafe(n).negate(),i=Oa(t,e),o=e.double();o=Ra(t,o),o=o.subtract(i),i=r.add(i),i=i.multiplyUnsafe(n).negate(),o=o.add(i),o=o.subtract(r);return o.subtract(e)},fromBytes:t=>{const{compressed:e,infinity:n,sort:r,value:i}=La(t);if(!e&&!n&&r||!e&&n&&r||r&&n&&e)throw new Error("invalid encoding flag: "+(224&t[0]));const o=va.BYTES,s=(t,e,n)=>Go(t.slice(e,n));if(96===i.length&&e){const t=Ca.params.G2b,e=va.ORDER;if(n){if(i.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid compressed G2 point");return{x:Ea.ZERO,y:Ea.ZERO}}const a=s(i,0,o),c=s(i,o,2*o),u=Ea.create({c0:va.create(c),c1:va.create(a)}),l=Ea.add(Ea.pow(u,ma),t);let f=Ea.sqrt(l);const d=f.c1===da?f.c0*pa/e:f.c1*pa/e?ha:da;return f=r&&d>0?f:Ea.neg(f),{x:u,y:f}}if(192!==i.length||e)throw new Error("invalid point G2, expected 96/192 bytes");{if(n){if(i.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid uncompressed G2 point");return{x:Ea.ZERO,y:Ea.ZERO}}const t=s(i,0,o),e=s(i,o,2*o),r=s(i,2*o,3*o),a=s(i,3*o,4*o);return{x:Ea.fromBigTuple([e,t]),y:Ea.fromBigTuple([a,r])}}},toBytes:(t,e,n)=>{const{BYTES:r,ORDER:i}=va,o=e.equals(t.ZERO),{x:s,y:a}=e.toAffine();if(n){if(o)return Xo(ka,Wo(da,r));const t=Boolean(a.c1===da?a.c0*pa/i:a.c1*pa/i);return Xo(Pa(Wo(s.c1,r),{compressed:!0,sort:t}),Wo(s.c0,r))}{if(o)return Xo(new Uint8Array([64]),new Uint8Array(4*r-1));const{re:t,im:e}=Ea.reim(s),{re:n,im:i}=Ea.reim(a);return Xo(Wo(e,r),Wo(t,r),Wo(i,r),Wo(n,r))}},Signature:{fromHex(t){const{infinity:e,sort:n,value:r}=La(Yo("signatureHex",t)),i=va.ORDER,o=r.length/2;if(48!==o&&96!==o)throw new Error("invalid compressed signature length, must be 96 or 192");const s=Go(r.slice(0,o)),a=Go(r.slice(o));if(e)return Ca.G2.ProjectivePoint.ZERO;const c=va.create(s&va.MASK),u=va.create(a),l=Ea.create({c0:u,c1:c}),f=Ea.add(Ea.pow(l,ma),Ca.params.G2b);let d=Ea.sqrt(f);if(!d)throw new Error("Failed to find a square root");const{re:h,im:p}=Ea.reim(d),g=BigInt(n);(p>da&&p*pa/i!==g||p===da&&h*pa/i!==g)&&(d=Ea.neg(d));const m=Ca.G2.ProjectivePoint.fromAffine({x:l,y:d});return m.assertValidity(),m},toRawBytes:t=>Da(t),toHex:t=>qo(Da(t))}},params:{ateLoopSize:ya,r:Ta.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:$a,hash:Me,randomBytes:ae});function Fa(t,e,n){const r="string"==typeof t?t:We(t),i="string"==typeof e?e:We(e),o="string"==typeof n?n:We(n);return Ca.verifyShortSignature(i,o,r)}const Ma=t=>dn(new rn(t)),ja=t=>{const e=Ma(t);return new Date(Number(e)/1e6)};var qa,Va,za=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},Ha=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class Ga extends en{constructor(t){super(`Invalid certificate: ${t}`)}}!function(t){t[t.Empty=0]="Empty",t[t.Fork=1]="Fork",t[t.Labeled=2]="Labeled",t[t.Leaf=3]="Leaf",t[t.Pruned=4]="Pruned"}(Va||(Va={}));class Ka{constructor(t,e,n,r,i=5,o=!1){this._rootKey=e,this._canisterId=n,this._blsVerify=r,this._maxAgeInMinutes=i,qa.set(this,!1),za(this,qa,o,"f"),this.cert=xo(new Uint8Array(t))}static async create(t){const e=Ka.createUnverified(t);return await e.verify(),e}static createUnverified(t){let e=t.blsVerify;return e||(e=Fa),new Ka(t.certificate,t.rootKey,t.canisterId,e,t.maxAgeInMinutes,t.disableTimeVerification)}lookup(t){return ec(t,this.cert.tree)}lookup_label(t){return this.lookup([t])}async verify(){const t=await Xa(this.cert.tree),e=await this._checkDelegationAndGetKey(this.cert.delegation),n=this.cert.signature,r=function(t){const e=Wa.byteLength+Za;if(t.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const n=t.slice(0,Wa.byteLength);if(!Je(n,Wa))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${Wa}, but get ${n}`);return t.slice(Wa.byteLength)}(e),i=Ke(Ja("ic-state-root"),t);let o=!1;const s=Ya(this.lookup(["time"]));if(!s)throw new Ga("Certificate does not contain a time");if(!Ha(this,qa,"f")){const t=3e5,e=60*this._maxAgeInMinutes*1e3,n=Date.now(),r=n-e,i=n+t,o=ja(s);if(o.getTime()<r)throw new Ga(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+o.toISOString()+" Current time: "+new Date(n).toISOString());if(o.getTime()>i)throw new Ga("Certificate is signed more than 5 minutes in the future. Certificate time: "+o.toISOString()+" Current time: "+new Date(n).toISOString())}try{o=await this._blsVerify(new Uint8Array(r),new Uint8Array(n),new Uint8Array(i))}catch(t){o=!1}if(!o)throw new Ga("Signature verification failed")}async _checkDelegationAndGetKey(t){if(!t)return this._rootKey;const e=await Ka.createUnverified({certificate:t.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(e.cert.delegation)throw new Ga("Delegation certificates cannot be nested");if(await e.verify(),this._canisterId.toString()!==Fu){if(!ic({canisterId:this._canisterId,subnetId:Ge.fromUint8Array(new Uint8Array(t.subnet_id)),tree:e.cert.tree}))throw new Ga(`Canister ${this._canisterId} not in range of delegations for subnet 0x${We(t.subnet_id)}`)}const n=Ya(e.lookup(["subnet",t.subnet_id,"public_key"]));if(!n)throw new Error(`Could not find subnet key for subnet 0x${We(t.subnet_id)}`);return n}}qa=new WeakMap;const Wa=Ye("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),Za=96;function Ya(t){if(t.status===Qa.Found)return t.value instanceof ArrayBuffer?t.value:t.value instanceof Uint8Array?t.value.buffer:void 0}async function Xa(t){switch(t[0]){case Va.Empty:return Li(Ja("ic-hashtree-empty"));case Va.Pruned:return t[1];case Va.Leaf:return Li(Ke(Ja("ic-hashtree-leaf"),t[1]));case Va.Labeled:return Li(Ke(Ja("ic-hashtree-labeled"),t[1],await Xa(t[2])));case Va.Fork:return Li(Ke(Ja("ic-hashtree-fork"),await Xa(t[1]),await Xa(t[2])));default:throw new Error("unreachable")}}function Ja(t){return Ke(new Uint8Array([t.length]),(new TextEncoder).encode(t))}var Qa,tc;function ec(t,e){if(0===t.length){if(e[0]===Va.Leaf){if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:Qa.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:Qa.Found,value:e[1].buffer}:{status:Qa.Found,value:e[1]}}return{status:Qa.Found,value:e}}const n=rc("string"==typeof t[0]?(new TextEncoder).encode(t[0]):t[0],e);switch(n.status){case Qa.Found:return ec(t.slice(1),n.value);case tc.Greater:case tc.Less:return{status:Qa.Absent};default:return n}}function nc(t){switch(t[0]){case Va.Empty:return[];case Va.Fork:return nc(t[1]).concat(nc(t[2]));default:return[t]}}function rc(t,e){switch(e[0]){case Va.Labeled:return function(t,e){const n=new Uint8Array(t),r=new Uint8Array(e);for(let t=0;t<n.length;t++)if(n[t]>r[t])return!0;return!1}(t,e[1])?{status:tc.Greater}:Je(t,e[1])?{status:Qa.Found,value:e[2]}:{status:tc.Less};case Va.Fork:const n=rc(t,e[1]);switch(n.status){case tc.Greater:{const n=rc(t,e[2]);return n.status===tc.Less?{status:Qa.Absent}:n}case Qa.Unknown:{let n=rc(t,e[2]);return n.status===tc.Less?{status:Qa.Unknown}:n}default:return n}case Va.Pruned:return{status:Qa.Unknown};default:return{status:Qa.Absent}}}function ic(t){const{canisterId:e,subnetId:n,tree:r}=t,i=ec(["subnet",n.toUint8Array(),"canister_ranges"],r);if(i.status!==Qa.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${n}`);return xo(i.value).map((t=>[Ge.fromUint8Array(t[0]),Ge.fromUint8Array(t[1])])).some((t=>t[0].ltEq(e)&&t[1].gtEq(e)))}!function(t){t.Unknown="unknown",t.Absent="absent",t.Found="found"}(Qa||(Qa={})),function(t){t.Less="less",t.Greater="greater"}(tc||(tc={}));const oc=async t=>{const{agent:e,paths:n}=t,r=Ge.from(t.canisterId),i=[...new Set(n)],o=i.map((t=>ac(t,r))),s=new Map,a=i.map(((t,n)=>(async()=>{var a;try{const t=await e.readState(r,{paths:[o[n]]});if(null==e.rootKey)throw new Error("Agent is missing root key");const a=await Ka.create({certificate:t.certificate,rootKey:e.rootKey,canisterId:r,disableTimeVerification:!0}),c=(n,i)=>{if("subnet"===i){if(null==e.rootKey)throw new Error("Agent is missing root key");return{path:i,data:sc(t.certificate,r,e.rootKey)}}return{path:i,data:Ya(n.lookup(ac(i,r)))}},{path:u,data:l}=c(a,i[n]);if(l)switch(u){case"time":s.set(u,ja(l));break;case"controllers":s.set(u,fc(l));break;case"module_hash":s.set(u,cc(l));break;case"subnet":s.set(u,l);break;case"candid":s.set(u,(new TextDecoder).decode(l));break;default:if("string"!=typeof u&&"key"in u&&"path"in u)switch(u.decodeStrategy){case"raw":s.set(u.key,l);break;case"leb128":s.set(u.key,Ma(l));break;case"cbor":s.set(u.key,uc(l));break;case"hex":s.set(u.key,cc(l));break;case"utf-8":s.set(u.key,lc(l))}}else console.warn(`Expected to find result for path ${u}, but instead found nothing.`),"string"==typeof u?s.set(u,null):s.set(u.key,null)}catch(e){if(null===(a=null==e?void 0:e.message)||void 0===a?void 0:a.includes("Invalid certificate"))throw new en(e.message);"string"!=typeof t&&"key"in t&&"path"in t?s.set(t.key,null):s.set(t,null),console.group(),console.warn(`Expected to find result for path ${t}, but instead found nothing.`),console.warn(e),console.groupEnd()}})()));return await Promise.all(a),s},sc=(t,e,n)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const r=xo(new Uint8Array(t)),i=r.tree;let o,s=r.delegation;s&&s.subnet_id?o=Ge.fromUint8Array(new Uint8Array(s.subnet_id)):s||void 0===n?(o=Ge.selfAuthenticating(Ge.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),s={subnet_id:o.toUint8Array(),certificate:new ArrayBuffer(0)}):(o=Ge.selfAuthenticating(new Uint8Array(n)),s={subnet_id:o.toUint8Array(),certificate:new ArrayBuffer(0)});if(!ic({canisterId:e,subnetId:o,tree:i}))throw new Error("Canister not in range");const a=ec(["subnet",s.subnet_id,"node"],i);if(a.status!==Qa.Found)throw new Error("Node not found");if(a.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const c=nc(a.value),u=new Map;return c.forEach((t=>{const e=Ge.from(new Uint8Array(t[1])).toText(),n=ec(["public_key"],t[2]);if(n.status!==Qa.Found)throw new Error("Public key not found");const r=n.value;if(44!==r.byteLength)throw new Error("Invalid public key length");u.set(e,r)})),{subnetId:Ge.fromUint8Array(new Uint8Array(s.subnet_id)).toText(),nodeKeys:u}},ac=(t,e)=>{const n=new TextEncoder,r=t=>new DataView(n.encode(t).buffer).buffer,i=new DataView(e.toUint8Array().buffer).buffer;switch(t){case"time":return[r("time")];case"controllers":return[r("canister"),i,r("controllers")];case"module_hash":return[r("canister"),i,r("module_hash")];case"subnet":return[r("subnet")];case"candid":return[r("canister"),i,r("metadata"),r("candid:service")];default:if("key"in t&&"path"in t){if("string"==typeof t.path||t.path instanceof ArrayBuffer){const e=t.path,n="string"==typeof e?r(e):e;return[r("canister"),i,r("metadata"),n]}return t.path}}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${t} was formatted correctly.`)},cc=t=>We(t),uc=t=>xo(t),lc=t=>(new TextDecoder).decode(t),fc=t=>uc(t).map((t=>Ge.fromUint8Array(new Uint8Array(t))));var dc=Object.freeze({__proto__:null,CustomPath:class{constructor(t,e,n){this.key=t,this.path=e,this.decodeStrategy=n}},encodePath:ac,fetchNodeKeys:sc,request:oc});const hc=BigInt(0),pc=BigInt(1),gc=BigInt(2),mc=BigInt(8),bc={zip215:!0};function yc(t){const e=function(t){const e=Zs(t);return ss(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:n,n:r,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=e,u=gc<<BigInt(8*a)-pc,l=n.create,f=Bs(e.n,e.nBitLength);if(!function(t,r){const i=n.sqr(t),o=n.sqr(r),s=n.add(n.mul(e.a,i),o),a=n.add(n.ONE,n.mul(e.d,n.mul(i,o)));return n.eql(s,a)}(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const d=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:n.sqrt(t*n.inv(e))}}catch(t){return{isValid:!1,value:hc}}}),h=e.adjustScalarBytes||(t=>t),p=e.domain||((t,e,n)=>{if(Co("phflag",n),e.length||n)throw new Error("Contexts/pre-hash are not supported");return t});function g(t,e,n=!1){es("coordinate "+t,e,n?pc:hc,u)}function m(t){if(!(t instanceof w))throw new Error("ExtendedPoint expected")}const b=cs(((t,e)=>{const{ex:r,ey:i,ez:o}=t,s=t.is0();null==e&&(e=s?mc:n.inv(o));const a=l(r*e),c=l(i*e),u=l(o*e);if(s)return{x:hc,y:pc};if(u!==pc)throw new Error("invZ was invalid");return{x:a,y:c}})),y=cs((t=>{const{a:n,d:r}=e;if(t.is0())throw new Error("bad point: ZERO");const{ex:i,ey:o,ez:s,et:a}=t,c=l(i*i),u=l(o*o),f=l(s*s),d=l(f*f),h=l(c*n);if(l(f*l(h+u))!==l(d+l(r*l(c*u))))throw new Error("bad point: equation left != right (1)");if(l(i*o)!==l(s*a))throw new Error("bad point: equation left != right (2)");return!0}));class w{constructor(t,e,n,r){g("x",t),g("y",e),g("z",n,!0),g("t",r),this.ex=t,this.ey=e,this.ez=n,this.et=r,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof w)throw new Error("extended point not allowed");const{x:e,y:n}=t||{};return g("x",e),g("y",n),new w(e,n,pc,l(e*n))}static normalizeZ(t){const e=Ts(n,t.map((t=>t.ez)));return t.map(((t,n)=>t.toAffine(e[n]))).map(w.fromAffine)}static msm(t,e){return Ws(w,f,t,e)}_setWindowSize(t){x.setWindowSize(this,t)}assertValidity(){y(this)}equals(t){m(t);const{ex:e,ey:n,ez:r}=this,{ex:i,ey:o,ez:s}=t,a=l(e*s),c=l(i*r),u=l(n*s),f=l(o*r);return a===c&&u===f}is0(){return this.equals(w.ZERO)}negate(){return new w(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:t}=e,{ex:n,ey:r,ez:i}=this,o=l(n*n),s=l(r*r),a=l(gc*l(i*i)),c=l(t*o),u=n+r,f=l(l(u*u)-o-s),d=c+s,h=d-a,p=c-s,g=l(f*h),m=l(d*p),b=l(f*p),y=l(h*d);return new w(g,m,y,b)}add(t){m(t);const{a:n,d:r}=e,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:u,ez:f,et:d}=t,h=l(i*c),p=l(o*u),g=l(a*r*d),b=l(s*f),y=l((i+o)*(c+u)-h-p),v=b-g,E=b+g,x=l(p-n*h),_=l(y*v),A=l(E*x),T=l(y*x),S=l(v*E);return new w(_,A,S,T)}subtract(t){return this.add(t.negate())}wNAF(t){return x.wNAFCached(this,t,w.normalizeZ)}multiply(t){const e=t;es("scalar",e,pc,r);const{p:n,f:i}=this.wNAF(e);return w.normalizeZ([n,i])[0]}multiplyUnsafe(t,e=w.ZERO){const n=t;return es("scalar",n,hc,r),n===hc?E:this.is0()||n===pc?this:x.wNAFCachedUnsafe(this,n,w.normalizeZ,e)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return x.unsafeLadder(this,r).is0()}toAffine(t){return b(this,t)}clearCofactor(){const{h:t}=e;return t===pc?this:this.multiplyUnsafe(t)}static fromHex(t,r=!1){const{d:i,a:o}=e,s=n.BYTES;t=Yo("pointHex",t,s),Co("zip215",r);const a=t.slice(),c=t[s-1];a[s-1]=-129&c;const f=Ko(a),h=r?u:n.ORDER;es("pointHex.y",f,hc,h);const p=l(f*f),g=l(p-pc),m=l(i*p-o);let{isValid:b,value:y}=d(g,m);if(!b)throw new Error("Point.fromHex: invalid y coordinate");const v=(y&pc)===pc,E=0!=(128&c);if(!r&&y===hc&&E)throw new Error("Point.fromHex: x=0 and x_0=1");return E!==v&&(y=l(-y)),w.fromAffine({x:y,y:f})}static fromPrivateKey(t){const{scalar:e}=T(t);return v.multiply(e)}toRawBytes(){const{x:t,y:e}=this.toAffine(),r=Zo(e,n.BYTES);return r[r.length-1]|=t&pc?128:0,r}toHex(){return qo(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,pc,l(e.Gx*e.Gy)),w.ZERO=new w(hc,pc,pc,hc);const{BASE:v,ZERO:E}=w,x=Ks(w,8*a);function _(t){return ms(t,r)}function A(t){return _(Ko(t))}function T(t){const e=n.BYTES;t=Yo("private key",t,e);const r=Yo("hashed private key",o(t),2*e),i=h(r.slice(0,e));return{head:i,prefix:r.slice(e,2*e),scalar:A(i)}}function S(t){const{head:e,prefix:n,scalar:r}=T(t),i=v.multiply(r),o=i.toRawBytes();return{head:e,prefix:n,scalar:r,point:i,pointBytes:o}}function N(t=Uint8Array.of(),...e){const n=Xo(...e);return A(o(p(n,Yo("context",t),!!i)))}const B=bc;v._setWindowSize(8);return{CURVE:e,getPublicKey:function(t){return S(t).pointBytes},sign:function(t,e,o={}){t=Yo("message",t),i&&(t=i(t));const{prefix:s,scalar:a,pointBytes:c}=S(e),u=N(o.context,s,t),l=v.multiply(u).toRawBytes(),f=_(u+N(o.context,l,c,t)*a);return es("signature.s",f,hc,r),Yo("result",Xo(l,Zo(f,n.BYTES)),2*n.BYTES)},verify:function(t,e,r,o=B){const{context:s,zip215:a}=o,c=n.BYTES;t=Yo("signature",t,2*c),e=Yo("message",e),r=Yo("publicKey",r,c),void 0!==a&&Co("zip215",a),i&&(e=i(e));const u=Ko(t.slice(c,2*c));let l,f,d;try{l=w.fromHex(r,a),f=w.fromHex(t.slice(0,c),a),d=v.multiplyUnsafe(u)}catch(t){return!1}if(!a&&l.isSmallOrder())return!1;const h=N(s,f.toRawBytes(),l.toRawBytes(),e);return f.add(l.multiplyUnsafe(h)).subtract(d).clearCofactor().equals(w.ZERO)},ExtendedPoint:w,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>s(n.BYTES),precompute:(t=8,e=w.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}const wc=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),vc=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Ec=BigInt(1),xc=BigInt(2);BigInt(3);const _c=BigInt(5),Ac=BigInt(8);function Tc(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Sc(t,e){const n=wc,r=ms(e*e*e,n),i=function(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),i=BigInt(80),o=wc,s=t*t%o*t%o,a=bs(s,xc,o)*s%o,c=bs(a,Ec,o)*t%o,u=bs(c,_c,o)*c%o,l=bs(u,e,o)*u%o,f=bs(l,n,o)*l%o,d=bs(f,r,o)*f%o,h=bs(d,i,o)*d%o,p=bs(h,i,o)*d%o,g=bs(p,e,o)*u%o;return{pow_p_5_8:bs(g,xc,o)*t%o,b2:s}}(t*ms(r*r*e,n)).pow_p_5_8;let o=ms(t*r*i,n);const s=ms(e*o*o,n),a=o,c=ms(o*vc,n),u=s===t,l=s===ms(-t,n),f=s===ms(-t*vc,n);return u&&(o=a),(l||f)&&(o=c),(ms(o,n)&ls)===ls&&(o=ms(-o,n)),{isValid:u||l,value:o}}const Nc=(()=>Bs(wc,void 0,!0))(),Bc=(()=>({a:Nc.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Nc,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Ac,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:qe,randomBytes:ae,adjustScalarBytes:Tc,uvRatio:Sc}))(),Ic=(()=>yc(Bc))();var Oc,Rc,$c,kc,Lc=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},Pc=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class Uc{constructor(t={}){Oc.set(this,void 0),Rc.set(this,void 0),this[$c]=this.entries.bind(this),this[kc]="ExpirableMap";const{source:e=[],expirationTime:n=6e5}=t,r=Date.now();Lc(this,Oc,new Map([...e].map((([t,e])=>[t,{value:e,timestamp:r}]))),"f"),Lc(this,Rc,n,"f")}prune(){const t=Date.now();for(const[e,n]of Pc(this,Oc,"f").entries())t-n.timestamp>Pc(this,Rc,"f")&&Pc(this,Oc,"f").delete(e);return this}set(t,e){this.prune();const n={value:e,timestamp:Date.now()};return Pc(this,Oc,"f").set(t,n),this}get(t){const e=Pc(this,Oc,"f").get(t);if(void 0!==e){if(!(Date.now()-e.timestamp>Pc(this,Rc,"f")))return e.value;Pc(this,Oc,"f").delete(t)}}clear(){Pc(this,Oc,"f").clear()}entries(){const t=Pc(this,Oc,"f").entries();return function*(){for(const[e,n]of t)yield[e,n.value]}()}values(){const t=Pc(this,Oc,"f").values();return function*(){for(const e of t)yield e.value}()}keys(){return Pc(this,Oc,"f").keys()}forEach(t,e){for(const[n,r]of Pc(this,Oc,"f").entries())t.call(e,r.value,n,this)}has(t){return Pc(this,Oc,"f").has(t)}delete(t){return Pc(this,Oc,"f").delete(t)}get size(){return Pc(this,Oc,"f").size}}Oc=new WeakMap,Rc=new WeakMap,$c=Symbol.iterator,kc=Symbol.toStringTag;const Dc=t=>{if(t<=127)return 1;if(t<=255)return 2;if(t<=65535)return 3;if(t<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},Cc=(t,e,n)=>{if(n<=127)return t[e]=n,1;if(n<=255)return t[e]=129,t[e+1]=n,2;if(n<=65535)return t[e]=130,t[e+1]=n>>8,t[e+2]=n,3;if(n<=16777215)return t[e]=131,t[e+1]=n>>16,t[e+2]=n>>8,t[e+3]=n,4;throw new Error("Length too long (> 4 bytes)")},Fc=(t,e)=>{if(t[e]<128)return 1;if(128===t[e])throw new Error("Invalid length 0");if(129===t[e])return 2;if(130===t[e])return 3;if(131===t[e])return 4;throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const Mc=Uint8Array.from([48,5,6,3,43,101,112]);function jc(t,e){const n=2+Dc(t.byteLength+1),r=e.byteLength+n+t.byteLength;let i=0;const o=new Uint8Array(1+Dc(r)+r);return o[i++]=48,i+=Cc(o,i,r),o.set(e,i),i+=e.byteLength,o[i++]=3,i+=Cc(o,i,t.byteLength+1),o[i++]=0,o.set(new Uint8Array(t),i),o}Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);const qc=(t,e)=>{let n=0;const r=(t,e)=>{if(i[n++]!==t)throw new Error("Expected: "+e)},i=new Uint8Array(t);if(r(48,"sequence"),n+=Fc(i,n),!Je(i.slice(n,n+e.byteLength),e))throw new Error("Not the expected OID.");n+=e.byteLength,r(3,"bit string");const o=((t,e)=>{const n=Fc(t,e);if(1===n)return t[e];if(2===n)return t[e+1];if(3===n)return(t[e+1]<<8)+t[e+2];if(4===n)return(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];throw new Error("Length too long (> 4 bytes)")})(i,n)-1;n+=Fc(i,n),r(0,"0 padding");const s=i.slice(n);if(o!==s.length)throw new Error(`DER payload mismatch: Expected length ${o} actual length ${s.length}`);return s};var Vc,zc,Hc=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},Gc=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};let Kc=class t{constructor(e){if(Vc.set(this,void 0),zc.set(this,void 0),e.byteLength!==t.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Hc(this,Vc,e,"f"),Hc(this,zc,t.derEncode(e),"f")}static from(t){return this.fromDer(t.toDer())}static fromRaw(e){return new t(e)}static fromDer(e){return new t(this.derDecode(e))}static derEncode(t){return jc(t,Mc).buffer}static derDecode(t){const e=qc(t,Mc);if(e.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return e}get rawKey(){return Gc(this,Vc,"f")}get derKey(){return Gc(this,zc,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};Vc=new WeakMap,zc=new WeakMap,Kc.RAW_KEY_LENGTH=32;class Wc{constructor(){this.observers=[]}subscribe(t){this.observers.push(t)}unsubscribe(t){this.observers=this.observers.filter((e=>e!==t))}notify(t,...e){this.observers.forEach((n=>n(t,...e)))}}class Zc extends Wc{constructor(){super()}print(t,...e){this.notify({message:t,level:"info"},...e)}warn(t,...e){this.notify({message:t,level:"warn"},...e)}error(t,e,...n){this.notify({message:t,level:"error",error:e},...n)}}var Yc,Xc,Jc,Qc,tu,eu,nu,ru,iu,ou=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},su=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};const au=.5,cu=1.5,uu=500,lu=6e4,fu=9e5,du=10;class hu{constructor(t=hu.default){Yc.set(this,void 0),Xc.set(this,void 0),Jc.set(this,void 0),Qc.set(this,void 0),tu.set(this,void 0),eu.set(this,void 0),nu.set(this,void 0),ru.set(this,void 0),iu.set(this,0);const{initialInterval:e=uu,randomizationFactor:n=au,multiplier:r=cu,maxInterval:i=lu,maxElapsedTime:o=fu,maxIterations:s=du,date:a=Date}=t;ou(this,Yc,e,"f"),ou(this,Xc,n,"f"),ou(this,Jc,r,"f"),ou(this,Qc,i,"f"),ou(this,ru,a,"f"),ou(this,tu,a.now(),"f"),ou(this,eu,o,"f"),ou(this,nu,s,"f")}get ellapsedTimeInMsec(){return su(this,ru,"f").now()-su(this,tu,"f")}get currentInterval(){return su(this,Yc,"f")}get count(){return su(this,iu,"f")}get randomValueFromInterval(){const t=su(this,Xc,"f")*su(this,Yc,"f"),e=su(this,Yc,"f")-t,n=su(this,Yc,"f")+t;return Math.random()*(n-e)+e}incrementCurrentInterval(){var t;return ou(this,Yc,Math.min(su(this,Yc,"f")*su(this,Jc,"f"),su(this,Qc,"f")),"f"),ou(this,iu,(t=su(this,iu,"f"),++t),"f"),su(this,Yc,"f")}next(){return this.ellapsedTimeInMsec>=su(this,eu,"f")||su(this,iu,"f")>=su(this,nu,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}Yc=new WeakMap,Xc=new WeakMap,Jc=new WeakMap,Qc=new WeakMap,tu=new WeakMap,eu=new WeakMap,nu=new WeakMap,ru=new WeakMap,iu=new WeakMap,hu.default={initialInterval:uu,randomizationFactor:au,multiplier:cu,maxInterval:lu,maxElapsedTime:fu,maxIterations:du,date:Date};var pu,gu,mu,bu,yu,wu,vu,Eu,xu,_u,Au,Tu,Su,Nu,Bu,Iu,Ou,Ru,$u,ku,Lu,Pu,Uu=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},Du=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};!function(t){t.Received="received",t.Processing="processing",t.Replied="replied",t.Rejected="rejected",t.Unknown="unknown",t.Done="done"}(Pu||(Pu={}));const Cu=6e4,Fu="aaaaa-aa";class Mu extends en{constructor(t){super(t),this.message=t}}class ju extends en{constructor(t){super(t),this.message=t}}class qu{constructor(t={}){var e,n;pu.add(this),gu.set(this,null),mu.set(this,!1),bu.set(this,void 0),yu.set(this,void 0),wu.set(this,void 0),vu.set(this,void 0),Eu.set(this,0),xu.set(this,void 0),_u.set(this,void 0),Au.set(this,void 0),Tu.set(this,void 0),this._isAgent=!0,this.config={},Su.set(this,0),this.log=new Zc,Nu.set(this,[]),Bu.set(this,[]),Iu.set(this,new Uc({expirationTime:3e5})),Ou.set(this,!0),ku.set(this,((t,e)=>{if(!1===Du(this,Ou,"f"))return t;if(!e)throw new Ga("Invalid signature from replica signed query: no matching node key found.");const{status:n,signatures:r=[],requestId:i}=t,o=tn((new TextEncoder).encode("\vic-response"));for(const s of r){const{timestamp:r,identity:a}=s,c=Ge.fromUint8Array(a).toText();let u;if("replied"===n){const{reply:e}=t;u=Ci({status:n,reply:e,timestamp:BigInt(r),request_id:i})}else{if("rejected"!==n)throw new Error(`Unknown status: ${n}`);{const{reject_code:e,reject_message:o,error_code:s}=t;u=Ci({status:n,reject_code:e,reject_message:o,error_code:s,timestamp:BigInt(r),request_id:i})}}const l=Ke(o,tn(new Uint8Array(u))),f=null==e?void 0:e.nodeKeys.get(c);if(!f)throw new Ga("Invalid signature from replica signed query: no matching node key found.");const d=Kc.fromDer(f).rawKey;if(Ic.verify(s.signature,new Uint8Array(l),new Uint8Array(d)))return t;throw new Ga(`Invalid signature from replica ${c} signed query.`)}return t})),this.config=t,Uu(this,yu,t.fetch||function(){let t;if("undefined"!=typeof window){if(!window.fetch)throw new Mu("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");t=window.fetch.bind(window)}else if("undefined"!=typeof global){if(!global.fetch)throw new Mu("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");t=global.fetch.bind(global)}else"undefined"!=typeof self&&self.fetch&&(t=self.fetch.bind(self));if(t)return t;throw new Mu("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}()||fetch.bind(global),"f"),Uu(this,wu,t.fetchOptions,"f"),Uu(this,vu,t.callOptions,"f"),Uu(this,mu,null!==(e=t.shouldFetchRootKey)&&void 0!==e&&e,"f"),t.rootKey?this.rootKey=t.rootKey:Du(this,mu,"f")?this.rootKey=null:this.rootKey=Ye("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae");const r=function(t){let e;if(void 0!==t)e=t.match(/^[a-z]+:/)||"undefined"==typeof window?new URL(t):new URL(window.location.protocol+"//"+t);else{const t=["ic0.app","icp0.io","127.0.0.1","localhost"],n=[".github.dev",".gitpod.io"],r="undefined"!=typeof window?window.location:void 0,i=null==r?void 0:r.hostname;let o;i&&"string"==typeof i&&(o=n.some((t=>i.endsWith(t)))?i:t.find((t=>i.endsWith(t)))),e=r&&o?new URL(`${r.protocol}//${o}${r.port?":"+r.port:""}`):new URL("https://icp-api.io")}return e.toString()}(t.host);this.host=new URL(r),void 0!==t.verifyQuerySignatures&&Uu(this,Ou,t.verifyQuerySignatures,"f"),Uu(this,_u,null!==(n=t.retryTimes)&&void 0!==n?n:3,"f");if(Uu(this,Au,t.backoffStrategy||(()=>new hu({maxIterations:Du(this,_u,"f")})),"f"),this.host.hostname.endsWith(".ic0.app")?this.host.hostname="ic0.app":this.host.hostname.endsWith(".icp0.io")?this.host.hostname="icp0.io":this.host.hostname.endsWith(".icp-api.io")&&(this.host.hostname="icp-api.io"),t.credentials){const{name:e,password:n}=t.credentials;Uu(this,xu,`${e}${n?":"+n:""}`,"f")}if(Uu(this,bu,Promise.resolve(t.identity||new qi),"f"),t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes>5)throw new en(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);if(t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes<=0)throw new en(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);Uu(this,Tu,t.ingressExpiryInMinutes||5,"f"),this.addTransform("update",Bo(To)),t.useQueryNonces&&this.addTransform("query",Bo(To)),t.logToConsole&&this.log.subscribe((t=>{"error"===t.level?console.error(t.message):"warn"===t.level?console.warn(t.message):console.log(t.message)}))}get waterMark(){return Du(this,Su,"f")}static createSync(t={}){return new this(Object.assign({},t))}static async create(t={shouldFetchRootKey:!1}){const e=qu.createSync(t),n=[e.syncTime()];return"https://icp-api.io"!==e.host.toString()&&t.shouldFetchRootKey&&n.push(e.fetchRootKey()),await Promise.all(n),e}static async from(t){var e;try{return"config"in t?await qu.create(t.config):await qu.create({fetch:t._fetch,fetchOptions:t._fetchOptions,callOptions:t._callOptions,host:t._host.toString(),identity:null!==(e=t._identity)&&void 0!==e?e:void 0})}catch(t){throw new en("Failed to create agent from provided agent")}}isLocal(){const t=this.host.hostname;return"127.0.0.1"===t||t.endsWith("127.0.0.1")}addTransform(t,e,n=e.priority||0){if("update"===t){const t=Du(this,Bu,"f").findIndex((t=>(t.priority||0)<n));Du(this,Bu,"f").splice(t>=0?t:Du(this,Bu,"f").length,0,Object.assign(e,{priority:n}))}else if("query"===t){const t=Du(this,Nu,"f").findIndex((t=>(t.priority||0)<n));Du(this,Nu,"f").splice(t>=0?t:Du(this,Nu,"f").length,0,Object.assign(e,{priority:n}))}}async getPrincipal(){if(!Du(this,bu,"f"))throw new ju("This identity has expired due this application's security policy. Please refresh your authentication.");return(await Du(this,bu,"f")).getPrincipal()}async call(t,e,n){var r,i;await Du(this,pu,"m",Lu).call(this);const o=null===(r=e.callSync)||void 0===r||r,s=await(void 0!==n?await n:await Du(this,bu,"f"));if(!s)throw new ju("This identity has expired due this application's security policy. Please refresh your authentication.");const a=Ge.from(t),c=e.effectiveCanisterId?Ge.from(e.effectiveCanisterId):a,u=s.getPrincipal()||Ge.anonymous();let l=new No(Du(this,Tu,"f")*Cu);Math.abs(Du(this,Eu,"f"))>3e4&&(l=new No(Du(this,Tu,"f")*Cu+Du(this,Eu,"f")));const f={request_type:Ao.Call,canister_id:a,method_name:e.methodName,arg:e.arg,sender:u,ingress_expiry:l};let d,h=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},Du(this,xu,"f")?{Authorization:"Basic "+btoa(Du(this,xu,"f"))}:{})},endpoint:"call",body:f});function p(t){return new Uint8Array(t)}d=(null==e?void 0:e.nonce)?p(e.nonce):h.body.nonce?p(h.body.nonce):void 0,f.nonce=d,h=await s.transformRequest(h);const g=wo(h.body),m=Du(this,Au,"f").call(this),b=Di(f);try{const t=()=>(this.log.print(`fetching "/api/v3/canister/${c.toText()}/call" with request:`,h),Du(this,yu,"f").call(this,""+new URL(`/api/v3/canister/${c.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},Du(this,vu,"f")),h.request),{body:g}))),e=()=>(this.log.print(`fetching "/api/v2/canister/${c.toText()}/call" with request:`,h),Du(this,yu,"f").call(this,""+new URL(`/api/v2/canister/${c.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},Du(this,vu,"f")),h.request),{body:g}))),n=Du(this,pu,"m",$u).call(this,{request:o?t:e,backoff:m,tries:0}),r=await n,i=await r.arrayBuffer(),s=200===r.status&&i.byteLength>0?xo(i):null;if(s&&"certificate"in s){const t=await this.parseTimeFromResponse({certificate:s.certificate});Uu(this,Su,t,"f")}return{requestId:b,response:{ok:r.ok,status:r.status,statusText:r.statusText,body:s,headers:Io(r.headers)},requestDetails:f}}catch(r){if(r.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(t,Object.assign(Object.assign({},e),{callSync:!1}),n);const o=`Error while making call: ${null!==(i=r.message)&&void 0!==i?i:String(r)}`,s=new Ro(o,r,We(b),We(h.body.sender_pubkey),We(h.body.sender_sig),String(h.body.content.ingress_expiry._value));throw this.log.error(o,s),s}}async query(t,e,n){var r,i,o,s;await Du(this,pu,"m",Lu).call(this);const a=Du(this,Au,"f").call(this),c=e.effectiveCanisterId?Ge.from(e.effectiveCanisterId):Ge.from(t);let u,l;this.log.print(`ecid ${c.toString()}`),this.log.print(`canisterId ${t.toString()}`);const f=await(void 0!==n?n:Du(this,bu,"f"));if(!f)throw new ju("This identity has expired due this application's security policy. Please refresh your authentication.");const d=Ge.from(t),h=(null==f?void 0:f.getPrincipal())||Ge.anonymous(),p={request_type:"query",canister_id:d,method_name:e.methodName,arg:e.arg,sender:h,ingress_expiry:new No(Du(this,Tu,"f")*Cu)},g=Di(p);u=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},Du(this,xu,"f")?{Authorization:"Basic "+btoa(Du(this,xu,"f"))}:{})},endpoint:"read",body:p}),u=await(null==f?void 0:f.transformRequest(u));const m=wo(u.body),b={canister:d.toText(),ecid:c,transformedRequest:u,body:m,requestId:g,backoff:a,tries:0},y=async()=>({requestDetails:p,query:await Du(this,pu,"m",Ru).call(this,b)}),w=async()=>{if(!Du(this,Ou,"f"))return;const t=Du(this,Iu,"f").get(c.toString());return t||(await this.fetchSubnetKeys(c.toString()),Du(this,Iu,"f").get(c.toString()))};try{const[e,n]=await Promise.all([y(),w()]);l=e;const{requestDetails:r,query:i}=l,o=Object.assign(Object.assign({},i),{requestDetails:r});if(this.log.print("Query response:",o),!Du(this,Ou,"f"))return o;try{return Du(this,ku,"f").call(this,o,n)}catch(e){this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),Du(this,Iu,"f").delete(t.toString()),await this.fetchSubnetKeys(c.toString());const n=Du(this,Iu,"f").get(t.toString());if(!n)throw new Ga("Invalid signature from replica signed query: no matching node key found.");return Du(this,ku,"f").call(this,o,n)}}catch(t){const e=`Error while making call: ${null!==(r=t.message)&&void 0!==r?r:String(t)}`,n=new $o(e,t,String(g),We(null===(i=null==u?void 0:u.body)||void 0===i?void 0:i.sender_pubkey),We(null===(o=null==u?void 0:u.body)||void 0===o?void 0:o.sender_sig),String(null===(s=null==u?void 0:u.body)||void 0===s?void 0:s.content.ingress_expiry._value));throw this.log.error(e,n),n}}async createReadStateRequest(t,e){await Du(this,pu,"m",Lu).call(this);const n=await(void 0!==e?await e:await Du(this,bu,"f"));if(!n)throw new ju("This identity has expired due this application's security policy. Please refresh your authentication.");const r=(null==n?void 0:n.getPrincipal())||Ge.anonymous(),i=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},Du(this,xu,"f")?{Authorization:"Basic "+btoa(Du(this,xu,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:t.paths,sender:r,ingress_expiry:new No(Du(this,Tu,"f")*Cu)}});return null==n?void 0:n.transformRequest(i)}async readState(t,e,n,r){var i,o,s,a;const c=function(t){for(const e of t.paths){const[t,n]=e;if(Je(t,tn((new TextEncoder).encode("request_status"))))return n}}(e);await Du(this,pu,"m",Lu).call(this);const u="string"==typeof t?Ge.fromText(t):t,l=null!=r?r:await this.createReadStateRequest(e,n),f=wo(l.body);this.log.print(`fetching "/api/v2/canister/${u}/read_state" with request:`,l);const d=Du(this,Au,"f").call(this);try{const t=await Du(this,pu,"m",$u).call(this,{request:()=>Du(this,yu,"f").call(this,""+new URL(`/api/v2/canister/${u.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},Du(this,wu,"f")),l.request),{body:f})),backoff:d,tries:0});if(!t.ok)throw new Error(`Server returned an error:\n  Code: ${t.status} (${t.statusText})\n  Body: ${await t.text()}\n`);const e=xo(await t.arrayBuffer());this.log.print("Read state response:",e);const n=await this.parseTimeFromResponse(e);return n>0&&(this.log.print("Read state response time:",n),Uu(this,Su,n,"f")),e}catch(t){const e=`Caught exception while attempting to read state: ${null!==(i=t.message)&&void 0!==i?i:String(t)}`,n=new ko(e,t,String(c),We(null===(o=null==l?void 0:l.body)||void 0===o?void 0:o.sender_pubkey),We(null===(s=null==l?void 0:l.body)||void 0===s?void 0:s.sender_sig),String(null===(a=null==l?void 0:l.body)||void 0===a?void 0:a.content.ingress_expiry._value));throw this.log.error(e,n),n}}async parseTimeFromResponse(t){let e;if(t.certificate){const n=xo(t.certificate);if(!n||!("tree"in n))throw new Error("Could not decode time from response");e=n.tree;const r=ec(["time"],e);if(r.status!==Qa.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(r.value instanceof ArrayBuffer||ArrayBuffer.isView(r)))throw new Error("Time was not found in the response or was not in its expected format.");const i=ja(tn(r.value));return this.log.print("Time from response:",i),this.log.print("Time from response in milliseconds:",Number(i)),Number(i)}return this.log.warn("No certificate found in response"),0}async syncTime(t){await Du(this,pu,"m",Lu).call(this);const e=await Promise.resolve().then((function(){return dc})),n=Date.now();try{t||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const r=qu.createSync({identity:new qi,host:this.host.toString(),fetch:Du(this,yu,"f"),retryTimes:0}),i=(await e.request({canisterId:null!=t?t:Ge.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:r,paths:["time"]})).get("time");i&&(Uu(this,Eu,Number(i)-Number(n),"f"),this.log.notify({message:`Syncing time: offset of ${Du(this,Eu,"f")}`,level:"info"}))}catch(t){this.log.error("Caught exception while attempting to sync time",t)}}async status(){const t=Du(this,xu,"f")?{Authorization:"Basic "+btoa(Du(this,xu,"f"))}:{};this.log.print('fetching "/api/v2/status"');const e=Du(this,Au,"f").call(this),n=await Du(this,pu,"m",$u).call(this,{backoff:e,request:()=>Du(this,yu,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:t},Du(this,wu,"f"))),tries:0});return xo(await n.arrayBuffer())}async fetchRootKey(){let t;return Du(this,gu,"f")||Uu(this,gu,new Promise(((t,e)=>{this.status().then((e=>{const n=e.root_key;this.rootKey=n,t(n)})).catch(e)})),"f"),t=await Du(this,gu,"f"),Uu(this,gu,null,"f"),t}invalidateIdentity(){Uu(this,bu,null,"f")}replaceIdentity(t){Uu(this,bu,Promise.resolve(t),"f")}async fetchSubnetKeys(t){await Du(this,pu,"m",Lu).call(this);const e=Ge.from(t),n=(await oc({canisterId:e,paths:["subnet"],agent:this})).get("subnet");if(n&&"object"==typeof n&&"nodeKeys"in n)return Du(this,Iu,"f").set(e.toText(),n),n}_transform(t){let e=Promise.resolve(t);if("call"===t.endpoint)for(const t of Du(this,Bu,"f"))e=e.then((e=>t(e).then((t=>t||e))));else for(const t of Du(this,Nu,"f"))e=e.then((e=>t(e).then((t=>t||e))));return e}}var Vu;function zu(){const t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!t)throw new Error("No Agent could be found.");return t}gu=new WeakMap,mu=new WeakMap,bu=new WeakMap,yu=new WeakMap,wu=new WeakMap,vu=new WeakMap,Eu=new WeakMap,xu=new WeakMap,_u=new WeakMap,Au=new WeakMap,Tu=new WeakMap,Su=new WeakMap,Nu=new WeakMap,Bu=new WeakMap,Iu=new WeakMap,Ou=new WeakMap,ku=new WeakMap,pu=new WeakSet,Ru=async function t(e){var n,r;const{ecid:i,transformedRequest:o,body:s,requestId:a,backoff:c,tries:u}=e,l=0===u?0:c.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:u,backoff:c,delay:l}),null===l)throw new en(`Timestamp failed to pass the watermark after retrying the configured ${Du(this,_u,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);let f;l>0&&await new Promise((t=>setTimeout(t,l)));try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,o);const t=await Du(this,yu,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},Du(this,wu,"f")),o.request),{body:s}));if(200!==t.status)throw new Oo(`Gateway returned an error:\n  Code: ${t.status} (${t.statusText})\n  Body: ${await t.text()}\n`,{ok:t.ok,status:t.status,statusText:t.statusText,headers:Io(t.headers)});{const e=xo(await t.arrayBuffer());f=Object.assign(Object.assign({},e),{httpDetails:{ok:t.ok,status:t.status,statusText:t.statusText,headers:Io(t.headers)},requestId:a})}}catch(n){if(u<Du(this,_u,"f"))return this.log.warn(`Caught exception while attempting to make query:\n  ${n}\n  Retrying query.`),await Du(this,pu,"m",t).call(this,Object.assign(Object.assign({},e),{tries:u+1}));throw n}const d=null===(r=null===(n=f.signatures)||void 0===n?void 0:n[0])||void 0===r?void 0:r.timestamp;if(!Du(this,Ou,"f"))return f;if(!d)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const h=Number(BigInt(d)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:h}),Number(this.waterMark)>h){const n=new en("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",n,{timestamp:d,waterMark:this.waterMark}),u<Du(this,_u,"f"))return await Du(this,pu,"m",t).call(this,Object.assign(Object.assign({},e),{tries:u+1}));throw new en(`Timestamp failed to pass the watermark after retrying the configured ${Du(this,_u,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return f},$u=async function t(e){const{request:n,backoff:r,tries:i}=e,o=0===i?0:r.next();if(null===o)throw new en(`Timestamp failed to pass the watermark after retrying the configured ${Du(this,_u,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);let s;o>0&&await new Promise((t=>setTimeout(t,o)));try{s=await n()}catch(e){if(Du(this,_u,"f")>i)return this.log.warn(`Caught exception while attempting to make request:\n  ${e}\n  Retrying request.`),await Du(this,pu,"m",t).call(this,{request:n,backoff:r,tries:i+1});throw e}if(s.ok)return s;const a=await s.clone().text(),c=`Server returned an error:\n  Code: ${s.status} (${s.statusText})\n  Body: ${a}\n`;if(404===s.status&&s.url.includes("api/v3"))throw new Oo("v3 api not supported. Fall back to v2",{ok:s.ok,status:s.status,statusText:s.statusText,headers:Io(s.headers)});if(i<Du(this,_u,"f"))return await Du(this,pu,"m",t).call(this,{request:n,backoff:r,tries:i+1});throw new Oo(c,{ok:s.ok,status:s.status,statusText:s.statusText,headers:Io(s.headers)})},Lu=async function(){if(!this.rootKey){if(null!==this.rootKey||!Du(this,mu,"f"))throw new en(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${Du(this,mu,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`);await this.fetchRootKey()}},function(t){t.Error="err",t.GetPrincipal="gp",t.GetPrincipalResponse="gpr",t.Query="q",t.QueryResponse="qr",t.Call="c",t.CallResponse="cr",t.ReadState="rs",t.ReadStateResponse="rsr",t.Status="s",t.StatusResponse="sr"}(Vu||(Vu={}));const Hu=3e5;function Gu(){return function(...t){return async(e,n,r)=>{for(const i of t)await i(e,n,r)}}((t=function(){let t=!0;return async()=>!!t&&(t=!1,!0)}(),e=1e3,async(n,r,i)=>{if(await t(n,r,i))return new Promise((t=>setTimeout(t,e)))}),function(t,e){let n=t;return()=>new Promise((t=>setTimeout((()=>{n*=e,t()}),n)))}(1e3,1.2),function(t){const e=Date.now()+t;return async(n,r,i)=>{if(Date.now()>e)throw new Error(`Request timed out after ${t} msec:\n  Request ID: ${We(r)}\n  Request status: ${i}\n`)}}(Hu));var t,e}async function Ku(t,e,n,r=Gu(),i,o){var s;const a=[(new TextEncoder).encode("request_status"),n],c=null!=i?i:await(null===(s=t.createReadStateRequest)||void 0===s?void 0:s.call(t,{paths:[a]})),u=await t.readState(e,{paths:[a]},void 0,c);if(null==t.rootKey)throw new Error("Agent root key not initialized before polling");const l=await Ka.create({certificate:u.certificate,rootKey:t.rootKey,canisterId:e,blsVerify:o}),f=Ya(l.lookup([...a,(new TextEncoder).encode("status")]));let d;switch(d=void 0===f?Pu.Unknown:(new TextDecoder).decode(f),d){case Pu.Replied:return{reply:Ya(l.lookup([...a,"reply"])),certificate:l};case Pu.Received:case Pu.Unknown:case Pu.Processing:return await r(e,n,d),Ku(t,e,n,r,c,o);case Pu.Rejected:{const t=new Uint8Array(Ya(l.lookup([...a,"reject_code"])))[0],e=(new TextDecoder).decode(Ya(l.lookup([...a,"reject_message"])));throw new Error(`Call was rejected:\n  Request ID: ${We(n)}\n  Reject code: ${t}\n  Reject text: ${e}\n`)}case Pu.Done:throw new Error(`Call was marked as done but we never saw the reply:\n  Request ID: ${We(n)}\n`)}throw new Error("unreachable")}var Wu=({IDL:t})=>{const e=t.Variant({mainnet:t.Null,testnet:t.Null}),n=t.Text,r=t.Record({network:e,address:n,min_confirmations:t.Opt(t.Nat32)}),i=t.Nat64,o=i,s=t.Nat32,a=t.Record({start_height:s,end_height:t.Opt(s),network:e}),c=t.Vec(t.Nat8),u=t.Record({tip_height:s,block_headers:t.Vec(c)}),l=t.Record({network:e}),f=t.Nat64,d=t.Vec(f),h=t.Record({network:e,filter:t.Opt(t.Variant({page:t.Vec(t.Nat8),min_confirmations:t.Nat32})),address:n}),p=t.Vec(t.Nat8),g=t.Record({txid:t.Vec(t.Nat8),vout:t.Nat32}),m=t.Record({height:t.Nat32,value:i,outpoint:g}),b=t.Record({next_page:t.Opt(t.Vec(t.Nat8)),tip_height:s,tip_block_hash:p,utxos:t.Vec(m)}),y=t.Record({transaction:t.Vec(t.Nat8),network:e}),w=t.Principal,v=t.Record({canister_id:w,num_requested_changes:t.Opt(t.Nat64)}),E=t.Variant({from_user:t.Record({user_id:t.Principal}),from_canister:t.Record({canister_version:t.Opt(t.Nat64),canister_id:t.Principal})}),x=t.Vec(t.Nat8),_=t.Variant({creation:t.Record({controllers:t.Vec(t.Principal)}),code_deployment:t.Record({mode:t.Variant({reinstall:t.Null,upgrade:t.Null,install:t.Null}),module_hash:t.Vec(t.Nat8)}),load_snapshot:t.Record({canister_version:t.Nat64,taken_at_timestamp:t.Nat64,snapshot_id:x}),controllers_change:t.Record({controllers:t.Vec(t.Principal)}),code_uninstall:t.Null}),A=t.Record({timestamp_nanos:t.Nat64,canister_version:t.Nat64,origin:E,details:_}),T=t.Record({controllers:t.Vec(t.Principal),module_hash:t.Opt(t.Vec(t.Nat8)),recent_changes:t.Vec(A),total_num_changes:t.Nat64}),S=t.Record({canister_id:w}),N=t.Variant({controllers:t.Null,public:t.Null,allowed_viewers:t.Vec(t.Principal)}),B=t.Record({freezing_threshold:t.Nat,controllers:t.Vec(t.Principal),reserved_cycles_limit:t.Nat,log_visibility:N,wasm_memory_limit:t.Nat,memory_allocation:t.Nat,compute_allocation:t.Nat}),I=t.Record({status:t.Variant({stopped:t.Null,stopping:t.Null,running:t.Null}),memory_size:t.Nat,cycles:t.Nat,settings:B,query_stats:t.Record({response_payload_bytes_total:t.Nat,num_instructions_total:t.Nat,num_calls_total:t.Nat,request_payload_bytes_total:t.Nat}),idle_cycles_burned_per_day:t.Nat,module_hash:t.Opt(t.Vec(t.Nat8)),reserved_cycles:t.Nat}),O=t.Record({canister_id:w}),R=t.Record({freezing_threshold:t.Opt(t.Nat),controllers:t.Opt(t.Vec(t.Principal)),reserved_cycles_limit:t.Opt(t.Nat),log_visibility:t.Opt(N),wasm_memory_limit:t.Opt(t.Nat),memory_allocation:t.Opt(t.Nat),compute_allocation:t.Opt(t.Nat)}),$=t.Record({settings:t.Opt(R),sender_canister_version:t.Opt(t.Nat64)}),k=t.Record({canister_id:w}),L=t.Record({canister_id:w}),P=t.Record({canister_id:w,snapshot_id:x}),U=t.Record({canister_id:w}),D=t.Variant({secp256k1:t.Null}),C=t.Record({key_id:t.Record({name:t.Text,curve:D}),canister_id:t.Opt(w),derivation_path:t.Vec(t.Vec(t.Nat8))}),F=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),M=t.Record({canister_id:w}),j=t.Record({idx:t.Nat64,timestamp_nanos:t.Nat64,content:t.Vec(t.Nat8)}),q=t.Record({canister_log_records:t.Vec(j)}),V=t.Record({value:t.Text,name:t.Text}),z=t.Record({status:t.Nat,body:t.Vec(t.Nat8),headers:t.Vec(V)}),H=t.Record({url:t.Text,method:t.Variant({get:t.Null,head:t.Null,post:t.Null}),max_response_bytes:t.Opt(t.Nat64),body:t.Opt(t.Vec(t.Nat8)),transform:t.Opt(t.Record({function:t.Func([t.Record({context:t.Vec(t.Nat8),response:z})],[z],["query"]),context:t.Vec(t.Nat8)})),headers:t.Vec(V)}),G=t.Variant({reinstall:t.Null,upgrade:t.Opt(t.Record({wasm_memory_persistence:t.Opt(t.Variant({keep:t.Null,replace:t.Null})),skip_pre_upgrade:t.Opt(t.Bool)})),install:t.Null}),K=t.Record({hash:t.Vec(t.Nat8)}),W=t.Record({arg:t.Vec(t.Nat8),wasm_module_hash:t.Vec(t.Nat8),mode:G,chunk_hashes_list:t.Vec(K),target_canister:w,store_canister:t.Opt(w),sender_canister_version:t.Opt(t.Nat64)}),Z=t.Vec(t.Nat8),Y=t.Record({arg:t.Vec(t.Nat8),wasm_module:Z,mode:G,canister_id:w,sender_canister_version:t.Opt(t.Nat64)}),X=t.Record({canister_id:w}),J=t.Record({id:x,total_size:t.Nat64,taken_at_timestamp:t.Nat64}),Q=t.Vec(J),tt=t.Record({canister_id:w,sender_canister_version:t.Opt(t.Nat64),snapshot_id:x}),et=t.Record({start_at_timestamp_nanos:t.Nat64,subnet_id:t.Principal}),nt=t.Record({num_block_failures_total:t.Nat64,node_id:t.Principal,num_blocks_proposed_total:t.Nat64}),rt=t.Vec(t.Record({timestamp_nanos:t.Nat64,node_metrics:t.Vec(nt)})),it=t.Record({settings:t.Opt(R),specified_id:t.Opt(w),amount:t.Opt(t.Nat),sender_canister_version:t.Opt(t.Nat64)}),ot=t.Record({canister_id:w}),st=t.Record({canister_id:w,amount:t.Nat}),at=t.Vec(t.Nat8),ct=t.Variant({ed25519:t.Null,bip340secp256k1:t.Null}),ut=t.Record({key_id:t.Record({algorithm:ct,name:t.Text}),canister_id:t.Opt(w),derivation_path:t.Vec(t.Vec(t.Nat8))}),lt=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),ft=t.Record({key_id:t.Record({name:t.Text,curve:D}),derivation_path:t.Vec(t.Vec(t.Nat8)),message_hash:t.Vec(t.Nat8)}),dt=t.Record({signature:t.Vec(t.Nat8)}),ht=t.Variant({bip341:t.Record({merkle_root_hash:t.Vec(t.Nat8)})}),pt=t.Record({aux:t.Opt(ht),key_id:t.Record({algorithm:ct,name:t.Text}),derivation_path:t.Vec(t.Vec(t.Nat8)),message:t.Vec(t.Nat8)}),gt=t.Record({signature:t.Vec(t.Nat8)}),mt=t.Record({canister_id:w}),bt=t.Record({canister_id:w}),yt=t.Record({canister_id:w}),wt=t.Vec(K),vt=t.Record({subnet_id:t.Principal}),Et=t.Record({replica_version:t.Text}),xt=t.Record({replace_snapshot:t.Opt(x),canister_id:w}),_t=J,At=t.Record({canister_id:w,sender_canister_version:t.Opt(t.Nat64)}),Tt=t.Record({canister_id:t.Principal,settings:R,sender_canister_version:t.Opt(t.Nat64)}),St=t.Record({chunk:t.Vec(t.Nat8),canister_id:t.Principal}),Nt=K;return t.Service({bitcoin_get_balance:t.Func([r],[o],[]),bitcoin_get_block_headers:t.Func([a],[u],[]),bitcoin_get_current_fee_percentiles:t.Func([l],[d],[]),bitcoin_get_utxos:t.Func([h],[b],[]),bitcoin_send_transaction:t.Func([y],[],[]),canister_info:t.Func([v],[T],[]),canister_status:t.Func([S],[I],[]),clear_chunk_store:t.Func([O],[],[]),create_canister:t.Func([$],[k],[]),delete_canister:t.Func([L],[],[]),delete_canister_snapshot:t.Func([P],[],[]),deposit_cycles:t.Func([U],[],[]),ecdsa_public_key:t.Func([C],[F],[]),fetch_canister_logs:t.Func([M],[q],["query"]),http_request:t.Func([H],[z],[]),install_chunked_code:t.Func([W],[],[]),install_code:t.Func([Y],[],[]),list_canister_snapshots:t.Func([X],[Q],[]),load_canister_snapshot:t.Func([tt],[],[]),node_metrics_history:t.Func([et],[rt],[]),provisional_create_canister_with_cycles:t.Func([it],[ot],[]),provisional_top_up_canister:t.Func([st],[],[]),raw_rand:t.Func([],[at],[]),schnorr_public_key:t.Func([ut],[lt],[]),sign_with_ecdsa:t.Func([ft],[dt],[]),sign_with_schnorr:t.Func([pt],[gt],[]),start_canister:t.Func([mt],[],[]),stop_canister:t.Func([bt],[],[]),stored_chunks:t.Func([yt],[wt],[]),subnet_info:t.Func([vt],[Et],[]),take_canister_snapshot:t.Func([xt],[_t],[]),uninstall_code:t.Func([At],[],[]),update_settings:t.Func([Tt],[],[]),upload_chunk:t.Func([St],[Nt],[])})};class Zu extends en{constructor(t,e,n,r){super(["Call failed:",`  Canister: ${t.toText()}`,`  Method: ${e} (${n})`,...Object.getOwnPropertyNames(r).map((t=>`  "${t}": ${JSON.stringify(r[t])}`))].join("\n")),this.canisterId=t,this.methodName=e,this.type=n,this.props=r}}class Yu extends Zu{constructor(t,e,n){var r;super(t,e,"query",{Status:n.status,Code:null!==(r=Kt[n.reject_code])&&void 0!==r?r:`Unknown Code "${n.reject_code}"`,Message:n.reject_message}),this.result=n}}class Xu extends Zu{constructor(t,e,n,r,i,o,s){super(t,e,"update",Object.assign({"Request ID":We(n)},r.body?Object.assign(Object.assign({},s?{"Error code":s}:{}),{"Reject code":String(i),"Reject message":o}):{"HTTP status code":r.status.toString(),"HTTP status text":r.statusText})),this.requestId=n,this.response=r,this.reject_code=i,this.reject_message=o,this.error_code=s}}const Ju=Symbol.for("ic-agent-metadata");class Qu{constructor(t){this[Ju]=Object.freeze(t)}static agentOf(t){return t[Ju].config.agent}static interfaceOf(t){return t[Ju].service}static canisterIdOf(t){return Ge.from(t[Ju].config.canisterId)}static async install(t,e){const n=void 0===t.mode?{install:null}:t.mode,r=t.arg?[...new Uint8Array(t.arg)]:[],i=[...new Uint8Array(t.module)],o="string"==typeof e.canisterId?Ge.fromText(e.canisterId):e.canisterId;await ol(e).install_code({mode:n,arg:r,wasm_module:i,canister_id:o,sender_canister_version:[]})}static async createCanister(t,e){const{canister_id:n}=await ol(t||{}).provisional_create_canister_with_cycles({amount:[],settings:function(t){return[{controllers:t.controllers?[t.controllers]:[],compute_allocation:t.compute_allocation?[t.compute_allocation]:[],freezing_threshold:t.freezing_threshold?[t.freezing_threshold]:[],memory_allocation:t.memory_allocation?[t.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}(e||{}),specified_id:[],sender_canister_version:[]});return n}static async createAndInstallCanister(t,e,n){const r=await this.createCanister(n);return await this.install(Object.assign({},e),Object.assign(Object.assign({},n),{canisterId:r})),this.createActor(t,Object.assign(Object.assign({},n),{canisterId:r}))}static createActorClass(t,e){const n=t({IDL:Er});return class extends Qu{constructor(t){if(!t.canisterId)throw new en(`Canister ID is required, but received ${typeof t.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const r="string"==typeof t.canisterId?Ge.fromText(t.canisterId):t.canisterId;super({config:Object.assign(Object.assign(Object.assign({},el),t),{canisterId:r}),service:n});for(const[r,i]of n._fields)(null==e?void 0:e.httpDetails)&&i.annotations.push(nl),(null==e?void 0:e.certificate)&&i.annotations.push(rl),this[r]=il(this,r,i,t.blsVerify)}}}static createActor(t,e){if(!e.canisterId)throw new en(`Canister ID is required, but received ${typeof e.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(t))(e)}static createActorWithHttpDetails(t,e){return new(this.createActorClass(t,{httpDetails:!0}))(e)}static createActorWithExtendedDetails(t,e,n={httpDetails:!0,certificate:!0}){return new(this.createActorClass(t,n))(e)}}function tl(t,e){const n=Kn(t,Ct.Buffer.from(e));switch(n.length){case 0:return;case 1:return n[0];default:return n}}const el={pollingStrategyFactory:Gu},nl="http-details",rl="certificate";function il(t,e,n,r){let i;i=n.annotations.includes("query")||n.annotations.includes("composite_query")?async(r,...i)=>{var o,s;const a=(r=Object.assign(Object.assign({},r),null===(s=(o=t[Ju].config).queryTransform)||void 0===s?void 0:s.call(o,e,i,Object.assign(Object.assign({},t[Ju].config),r)))).agent||t[Ju].config.agent||zu(),c=Ge.from(r.canisterId||t[Ju].config.canisterId),u=Gn(n.argTypes,i),l=await a.query(c,{methodName:e,arg:u,effectiveCanisterId:r.effectiveCanisterId}),f=Object.assign(Object.assign({},l.httpDetails),{requestDetails:l.requestDetails});switch(l.status){case"rejected":throw new Yu(c,e,l);case"replied":return n.annotations.includes(nl)?{httpDetails:f,result:tl(n.retTypes,l.reply.arg)}:tl(n.retTypes,l.reply.arg)}}:async(i,...o)=>{var s,a;const c=(i=Object.assign(Object.assign({},i),null===(a=(s=t[Ju].config).callTransform)||void 0===a?void 0:a.call(s,e,o,Object.assign(Object.assign({},t[Ju].config),i)))).agent||t[Ju].config.agent||zu(),{canisterId:u,effectiveCanisterId:l,pollingStrategyFactory:f}=Object.assign(Object.assign(Object.assign({},el),t[Ju].config),i),d=Ge.from(u),h=void 0!==l?Ge.from(l):d,p=Gn(n.argTypes,o),{requestId:g,response:m,requestDetails:b}=await c.call(d,{methodName:e,arg:p,effectiveCanisterId:h});let y,w;if(m.body&&m.body.certificate){if(null==c.rootKey)throw new Error("Agent is missing root key");const t=m.body.certificate;w=await Ka.create({certificate:sn(t),rootKey:c.rootKey,canisterId:Ge.from(u),blsVerify:r});const n=[(new TextEncoder).encode("request_status"),g];switch((new TextDecoder).decode(Ya(w.lookup([...n,"status"])))){case"replied":y=Ya(w.lookup([...n,"reply"]));break;case"rejected":{const t=new Uint8Array(Ya(w.lookup([...n,"reject_code"])))[0],r=(new TextDecoder).decode(Ya(w.lookup([...n,"reject_message"]))),i=Ya(w.lookup([...n,"error_code"])),o=i?(new TextDecoder).decode(i):void 0;throw new Xu(d,e,g,m,t,r,o)}}}else if(m.body&&"reject_message"in m.body){const{reject_code:t,reject_message:n,error_code:r}=m.body;throw new Xu(d,e,g,m,t,n,r)}if(202===m.status){const t=f(),e=await Ku(c,h,g,t,r);w=e.certificate,y=e.reply}const v=n.annotations.includes(nl),E=n.annotations.includes(rl),x=Object.assign(Object.assign({},m),{requestDetails:b});if(void 0!==y)return v&&E?{httpDetails:x,certificate:w,result:tl(n.retTypes,y)}:E?{certificate:w,result:tl(n.retTypes,y)}:v?{httpDetails:x,result:tl(n.retTypes,y)}:tl(n.retTypes,y);if(0===n.retTypes.length)return v?{httpDetails:m,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${n.retTypes.join(",")}].`)};const o=(...t)=>i({},...t);return o.withOptions=t=>(...e)=>i(t,...e),o}function ol(t){function e(e,n){if(t.effectiveCanisterId)return{effectiveCanisterId:Ge.from(t.effectiveCanisterId)};const r=n[0];let i=Ge.fromHex("");return r&&"object"==typeof r&&r.target_canister&&"install_chunked_code"===e&&(i=Ge.from(r.target_canister)),r&&"object"==typeof r&&r.canister_id&&(i=Ge.from(r.canister_id)),{effectiveCanisterId:i}}return Qu.createActor(Wu,Object.assign(Object.assign(Object.assign({},t),{canisterId:Ge.fromHex("")}),{callTransform:e,queryTransform:e}))}const sl=({IDL:t})=>{const e=t.Record({id:t.Nat,passport_id:t.Nat,owner:t.Text,memory_type:t.Text,encrypted_content:t.Text,created_at:t.Nat64,importance_score:t.Nat8}),n=t.Record({id:t.Nat,capabilities:t.Vec(t.Text),owner:t.Text,encrypted_specifications:t.Text,created_at:t.Nat64,api_endpoints:t.Vec(t.Text),last_active:t.Nat64,agent_name:t.Text,agent_type:t.Text,is_active:t.Bool}),r=t.Record({id:t.Nat,encrypted_text:t.Text,owner:t.Text,users:t.Vec(t.Text)});return t.Service({add_agent_memory:t.Func([t.Nat,t.Text,t.Text,t.Nat8],[t.Nat],[]),add_user:t.Func([t.Nat,t.Text],[],[]),create_agent_passport:t.Func([t.Text,t.Text,t.Vec(t.Text),t.Text],[t.Nat],[]),create_note:t.Func([],[t.Nat],[]),delete_note:t.Func([t.Nat],[],[]),encrypted_symmetric_key_for_note:t.Func([t.Nat,t.Vec(t.Nat8)],[t.Text],[]),get_agent_memories:t.Func([t.Nat,t.Opt(t.Text)],[t.Vec(e)],[]),get_agent_passport:t.Func([t.Nat],[t.Opt(n)],[]),get_my_passports:t.Func([],[t.Vec(n)],[]),get_notes:t.Func([],[t.Vec(r)],[]),remove_user:t.Func([t.Nat,t.Text],[],[]),symmetric_key_verification_key_for_note:t.Func([],[t.Text],[]),update_agent_specifications:t.Func([t.Nat,t.Text],[],[]),update_note:t.Func([t.Nat,t.Text],[],[]),whoami:t.Func([],[t.Text],[])})};function al(t){const e=process.env.CANISTER_ID_ENCRYPTED_NOTES||"uxrrr-q7777-77774-qaaaq-cai",n={host:"ic"===process.env.DFX_NETWORK?`https://${e}.ic0.app`:"http://localhost:8000"};t?t.agentOptions?t.agentOptions.host=n.host:t.agentOptions=n:t={agentOptions:n};const r=new qu(Object.assign({},t.agentOptions));return"production"!==process.env.NODE_ENV&&(console.log("Dev environment - fetching root key..."),r.fetchRootKey().catch((t=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(t)}))),Qu.createActor(sl,Object.assign({agent:r,canisterId:e},null==t?void 0:t.actorOptions))}var cl,ul,ll,fl,dl=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},hl=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};function pl(t){return null!==t&&"object"==typeof t}class gl{constructor(t){if(cl.set(this,void 0),ul.set(this,void 0),t.byteLength!==gl.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");dl(this,cl,tn(t),"f"),dl(this,ul,gl.derEncode(t),"f")}static from(t){if("string"==typeof t){const e=Ye(t);return this.fromRaw(e)}if(pl(t)){const e=t;if(pl(e)&&Object.hasOwnProperty.call(e,"__derEncodedPublicKey__"))return this.fromDer(e);if(ArrayBuffer.isView(e)){const t=e;return this.fromRaw(tn(t.buffer))}if(e instanceof ArrayBuffer)return this.fromRaw(e);if("rawKey"in e)return this.fromRaw(e.rawKey);if("derKey"in e)return this.fromDer(e.derKey);if("toDer"in e)return this.fromDer(e.toDer())}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(t){return new gl(t)}static fromDer(t){return new gl(this.derDecode(t))}static derEncode(t){const e=jc(t,Mc).buffer;return e.__derEncodedPublicKey__=void 0,e}static derDecode(t){const e=qc(t,Mc);if(e.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return tn(e)}get rawKey(){return hl(this,cl,"f")}get derKey(){return hl(this,ul,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}cl=new WeakMap,ul=new WeakMap,gl.RAW_KEY_LENGTH=32;class ml extends ji{constructor(t,e){super(),ll.set(this,void 0),fl.set(this,void 0),dl(this,ll,gl.from(t),"f"),dl(this,fl,new Uint8Array(e),"f")}static generate(t){if(t&&32!==t.length)throw new Error("Ed25519 Seed needs to be 32 bytes long.");t||(t=Ic.utils.randomPrivateKey()),Je(t,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const e=new Uint8Array(32);for(let n=0;n<32;n++)e[n]=new Uint8Array(t)[n];const n=Ic.getPublicKey(e);return ml.fromKeyPair(n,e)}static fromParsedJson(t){const[e,n]=t;return new ml(gl.fromDer(Ye(e)),Ye(n))}static fromJSON(t){const e=JSON.parse(t);if(Array.isArray(e)){if("string"==typeof e[0]&&"string"==typeof e[1])return this.fromParsedJson([e[0],e[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(t)}`)}static fromKeyPair(t,e){return new ml(gl.fromRaw(t),e)}static fromSecretKey(t){const e=Ic.getPublicKey(new Uint8Array(t));return ml.fromKeyPair(e,t)}toJSON(){return[We(hl(this,ll,"f").toDer()),We(hl(this,fl,"f"))]}getKeyPair(){return{secretKey:hl(this,fl,"f"),publicKey:hl(this,ll,"f")}}getPublicKey(){return hl(this,ll,"f")}async sign(t){const e=new Uint8Array(t),n=Qe(Ic.sign(e,hl(this,fl,"f").slice(0,32)));return Object.defineProperty(n,"__signature__",{enumerable:!1,value:void 0}),n}static verify(t,e,n){const[r,i,o]=[t,e,n].map((t=>("string"==typeof t&&(t=Ye(t)),t instanceof Uint8Array&&(t=tn(t.buffer)),new Uint8Array(t))));return Ic.verify(r,i,o)}}ll=new WeakMap,fl=new WeakMap;class bl extends Error{constructor(t){super(t),this.message=t,Object.setPrototypeOf(this,bl.prototype)}}function yl(t){if("undefined"!=typeof global&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(t)return t;if("undefined"!=typeof crypto&&crypto.subtle)return crypto.subtle;throw new bl("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class wl extends ji{constructor(t,e,n){super(),this._keyPair=t,this._derKey=e,this._subtleCrypto=n}static async generate(t){const{extractable:e=!1,keyUsages:n=["sign","verify"],subtleCrypto:r}=null!=t?t:{},i=yl(r),o=await i.generateKey({name:"ECDSA",namedCurve:"P-256"},e,n);return new this(o,await i.exportKey("spki",o.publicKey),i)}static async fromKeyPair(t,e){const n=yl(e),r=await n.exportKey("spki",t.publicKey);return new wl(t,r,n)}getKeyPair(){return this._keyPair}getPublicKey(){const t=this._derKey,e=Object.create(this._keyPair.publicKey);return e.toDer=function(){return t},e}async sign(t){return await this._subtleCrypto.sign({name:"ECDSA",hash:{name:"SHA-256"}},this._keyPair.privateKey,t)}}var vl,El=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},xl=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};class _l{constructor(t){vl.set(this,void 0),El(this,vl,t,"f")}get rawKey(){return xl(this,vl,"f").rawKey}get derKey(){return xl(this,vl,"f").derKey}toDer(){return xl(this,vl,"f").toDer()}getPublicKey(){return xl(this,vl,"f")}getPrincipal(){if(!xl(this,vl,"f").rawKey)throw new Error("Cannot get principal from a public key without a raw key.");return Ge.fromUint8Array(new Uint8Array(xl(this,vl,"f").rawKey))}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}vl=new WeakMap;var Al,Tl=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},Sl=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)},Nl=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Bl=(new TextEncoder).encode("ic-request-auth-delegation"),Il=(new TextEncoder).encode("\nic-request");function Ol(t){if("string"!=typeof t||t.length<64)throw new Error("Invalid public key.");return Ye(t)}class Rl{constructor(t,e,n){this.pubkey=t,this.expiration=e,this.targets=n}toCBOR(){return Vi.value.map(Object.assign({pubkey:Vi.value.bytes(this.pubkey),expiration:Vi.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:Vi.value.array(this.targets.map((t=>Vi.value.bytes(sn(t.toUint8Array())))))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:We(this.pubkey)},this.targets&&{targets:this.targets.map((t=>t.toHex()))})}}class $l{constructor(t,e){this.delegations=t,this.publicKey=e}static async create(t,e,n=new Date(Date.now()+9e5),r={}){var i,o;const s=await async function(t,e,n,r){const i=new Rl(e.toDer(),BigInt(+n)*BigInt(1e6),r),o=new Uint8Array([...Bl,...new Uint8Array(Di(Object.assign({},i)))]);return{delegation:i,signature:await t.sign(sn(o))}}(t,e,n,r.targets);return new $l([...(null===(i=r.previous)||void 0===i?void 0:i.delegations)||[],s],(null===(o=r.previous)||void 0===o?void 0:o.publicKey)||t.getPublicKey().toDer())}static fromJSON(t){const{publicKey:e,delegations:n}="string"==typeof t?JSON.parse(t):t;if(!Array.isArray(n))throw new Error("Invalid delegations.");return new this(n.map((t=>{const{delegation:e,signature:n}=t,{pubkey:r,expiration:i,targets:o}=e;if(void 0!==o&&!Array.isArray(o))throw new Error("Invalid targets.");return{delegation:new Rl(Ol(r),BigInt("0x"+i),o&&o.map((t=>{if("string"!=typeof t)throw new Error("Invalid target.");return Ge.fromHex(t)}))),signature:Ol(n)}})),Ol(e))}static fromDelegations(t,e){return new this(t,e)}toJSON(){return{delegations:this.delegations.map((t=>{const{delegation:e,signature:n}=t,{targets:r}=e;return{delegation:Object.assign({expiration:e.expiration.toString(16),pubkey:We(e.pubkey)},r&&{targets:r.map((t=>t.toHex()))}),signature:We(n)}})),publicKey:We(this.publicKey)}}}class kl extends ji{constructor(t,e){super(),this._inner=t,this._delegation=e}static fromDelegation(t,e){return new this(t,e)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(t){return this._inner.sign(t)}async transformRequest(t){const{body:e}=t,n=Nl(t,["body"]),r=await Di(e);return Object.assign(Object.assign({},n),{body:{content:e,sender_sig:await this.sign(sn(new Uint8Array([...Il,...new Uint8Array(r)]))),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class Ll extends _l{constructor(t,e){super(t),Al.set(this,void 0),Tl(this,Al,e,"f")}get delegation(){return Sl(this,Al,"f")}static fromDelegation(t,e){return new Ll(t,e)}}var Pl;Al=new WeakMap,function(t){t[t.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"}(Pl||(Pl={}));const Ul=["mousedown","mousemove","keydown","touchstart","wheel"];class Dl{constructor(t={}){var e;this.callbacks=[],this.idleTimeout=6e5,this.timeoutID=void 0;const{onIdle:n,idleTimeout:r=6e5}=t||{};this.callbacks=n?[n]:[],this.idleTimeout=r;const i=this._resetTimer.bind(this);window.addEventListener("load",i,!0),Ul.forEach((function(t){document.addEventListener(t,i,!0)}));const o=(t,e)=>{let n;return(...r)=>{const i=this;clearTimeout(n),n=window.setTimeout((function(){n=void 0,t.apply(i,r)}),e)}};if(null==t?void 0:t.captureScroll){const n=o(i,null!==(e=null==t?void 0:t.scrollDebounce)&&void 0!==e?e:100);window.addEventListener("scroll",n,!0)}i()}static create(t={}){return new this(t)}registerCallback(t){this.callbacks.push(t)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const t=this._resetTimer.bind(this);Ul.forEach((function(e){document.removeEventListener(e,t,!0)})),this.callbacks.forEach((t=>t()))}_resetTimer(){const t=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(t,this.idleTimeout)}}const Cl=(t,e)=>e.some((e=>t instanceof e));let Fl,Ml;const jl=new WeakMap,ql=new WeakMap,Vl=new WeakMap,zl=new WeakMap,Hl=new WeakMap;let Gl={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return ql.get(t);if("objectStoreNames"===e)return t.objectStoreNames||Vl.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Zl(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function Kl(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Ml||(Ml=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Yl(this),e),Zl(jl.get(this))}:function(...e){return Zl(t.apply(Yl(this),e))}:function(e,...n){const r=t.call(Yl(this),e,...n);return Vl.set(r,e.sort?e.sort():[e]),Zl(r)}}function Wl(t){return"function"==typeof t?Kl(t):(t instanceof IDBTransaction&&function(t){if(ql.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{e(),r()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)}));ql.set(t,e)}(t),Cl(t,Fl||(Fl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,Gl):t)}function Zl(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{e(Zl(t.result)),r()},o=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)}));return e.then((e=>{e instanceof IDBCursor&&jl.set(e,t)})).catch((()=>{})),Hl.set(e,t),e}(t);if(zl.has(t))return zl.get(t);const e=Wl(t);return e!==t&&(zl.set(t,e),Hl.set(e,t)),e}const Yl=t=>Hl.get(t);const Xl=["get","getKey","getAll","getAllKeys","count"],Jl=["put","add","delete","clear"],Ql=new Map;function tf(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(Ql.get(e))return Ql.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=Jl.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Xl.includes(n))return;const o=async function(t,...e){const o=this.transaction(t,i?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(e.shift())),(await Promise.all([s[n](...e),i&&o.done]))[0]};return Ql.set(e,o),o}Gl=(t=>({...t,get:(e,n,r)=>tf(e,n)||t.get(e,n,r),has:(e,n)=>!!tf(e,n)||t.has(e,n)}))(Gl);const ef="auth-client-db",nf="ic-keyval",rf=async(t=ef,e=nf,n)=>(df&&(null===localStorage||void 0===localStorage?void 0:localStorage.getItem(lf))&&(localStorage.removeItem(lf),localStorage.removeItem(uf)),await function(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),a=Zl(s);return r&&s.addEventListener("upgradeneeded",(t=>{r(Zl(s.result),t.oldVersion,t.newVersion,Zl(s.transaction),t)})),n&&s.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{o&&t.addEventListener("close",(()=>o())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(t,n,{upgrade:t=>{t.objectStoreNames.contains(e)&&t.clear(e),t.createObjectStore(e)}}));class of{constructor(t,e){this._db=t,this._storeName=e}static async create(t){const{dbName:e=ef,storeName:n=nf,version:r=ff}=null!=t?t:{},i=await rf(e,n,r);return new of(i,n)}async set(t,e){return await async function(t,e,n,r){return await t.put(e,r,n)}(this._db,this._storeName,t,e)}async get(t){var e;return null!==(e=await async function(t,e,n){return await t.get(e,n)}(this._db,this._storeName,t))&&void 0!==e?e:null}async remove(t){return await async function(t,e,n){return await t.delete(e,n)}(this._db,this._storeName,t)}}var sf,af=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},cf=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};const uf="identity",lf="delegation",ff=1,df="undefined"!=typeof window;class hf{constructor(t="ic-",e){this.prefix=t,this._localStorage=e}get(t){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+t))}set(t,e){return this._getLocalStorage().setItem(this.prefix+t,e),Promise.resolve()}remove(t){return this._getLocalStorage().removeItem(this.prefix+t),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?void 0:self.localStorage:global.localStorage:window.localStorage;if(!t)throw new Error("Could not find local storage.");return t}}class pf{constructor(t){sf.set(this,void 0),af(this,sf,null!=t?t:{},"f")}get _db(){return new Promise((t=>{this.initializedDb?t(this.initializedDb):of.create(cf(this,sf,"f")).then((e=>{this.initializedDb=e,t(e)}))}))}async get(t){const e=await this._db;return await e.get(t)}async set(t,e){const n=await this._db;await n.set(t,e)}async remove(t){const e=await this._db;await e.remove(t)}}sf=new WeakMap;const gf="ECDSA",mf="Ed25519";class bf{constructor(t,e,n,r,i,o,s,a){this._identity=t,this._key=e,this._chain=n,this._storage=r,this.idleManager=i,this._createOptions=o,this._idpWindow=s,this._eventHandler=a,this._registerDefaultIdleCallback()}static async create(t={}){var e,n,r;const i=null!==(e=t.storage)&&void 0!==e?e:new pf,o=null!==(n=t.keyType)&&void 0!==n?n:gf;let s=null;if(t.identity)s=t.identity;else{let t=await i.get(uf);if(!t&&df)try{const e=new hf,n=await e.get(lf),r=await e.get(uf);n&&r&&o===gf&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await i.set(lf,n),await i.set(uf,r),t=n,await e.remove(lf),await e.remove(uf))}catch(t){console.error("error while attempting to recover localstorage: "+t)}if(t)try{"object"==typeof t?s=o===mf&&"string"==typeof t?await ml.fromJSON(t):await wl.fromKeyPair(t):"string"==typeof t&&(s=ml.fromJSON(t))}catch(t){}}let a,c=new qi,u=null;if(s)try{const e=await i.get(lf);if("object"==typeof e&&null!==e)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");t.identity?c=t.identity:e&&(u=$l.fromJSON(e),!function(t,e){for(const{delegation:e}of t.delegations)if(+new Date(Number(e.expiration/BigInt(1e6)))<=+Date.now())return!1;const n=[],r=null==e?void 0:e.scope;r&&(Array.isArray(r)?n.push(...r.map((t=>"string"==typeof t?Ge.fromText(t):t))):n.push("string"==typeof r?Ge.fromText(r):r));for(const e of n){const n=e.toText();for(const{delegation:e}of t.delegations){if(void 0===e.targets)continue;let t=!0;for(const r of e.targets)if(r.toText()===n){t=!1;break}if(t)return!1}}return!0}(u)?(await yf(i),s=null):c="toDer"in s?Ll.fromDelegation(s,u):kl.fromDelegation(s,u))}catch(t){console.error(t),await yf(i),s=null}return(null===(r=t.idleOptions)||void 0===r?void 0:r.disableIdle)?a=void 0:(u||t.identity)&&(a=Dl.create(t.idleOptions)),s||(o===mf?(s=await ml.generate(),await i.set(uf,JSON.stringify(s.toJSON()))):(t.storage&&o===gf&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${mf}' as the key type, as it can serialize to a string`),s=await wl.generate(),await i.set(uf,s.getKeyPair()))),new this(c,s,u,i,a,t)}_registerDefaultIdleCallback(){var t,e;const n=null===(t=this._createOptions)||void 0===t?void 0:t.idleOptions;(null==n?void 0:n.onIdle)||(null==n?void 0:n.disableDefaultIdleCallback)||null===(e=this.idleManager)||void 0===e||e.registerCallback((()=>{this.logout(),location.reload()}))}async _handleSuccess(t,e){var n,r;const i=t.delegations.map((t=>({delegation:new Rl(t.delegation.pubkey,t.delegation.expiration,t.delegation.targets),signature:t.signature.buffer}))),o=$l.fromDelegations(i,t.userPublicKey.buffer),s=this._key;if(!s)return;this._chain=o,this._identity="toDer"in s?Ll.fromDelegation(s,this._chain):kl.fromDelegation(s,this._chain),null===(n=this._idpWindow)||void 0===n||n.close();const a=null===(r=this._createOptions)||void 0===r?void 0:r.idleOptions;this.idleManager||(null==a?void 0:a.disableIdle)||(this.idleManager=Dl.create(a),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(lf,JSON.stringify(this._chain.toJSON())),null==e||e(t)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&null!==this._chain}async login(t){var e,n,r,i;const o=BigInt(8)*BigInt(36e11),s=new URL((null===(e=null==t?void 0:t.identityProvider)||void 0===e?void 0:e.toString())||"https://identity.internetcomputer.org");s.hash="#authorize",null===(n=this._idpWindow)||void 0===n||n.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(s,Object.assign({maxTimeToLive:null!==(r=null==t?void 0:t.maxTimeToLive)&&void 0!==r?r:o},t)),window.addEventListener("message",this._eventHandler),this._idpWindow=null!==(i=window.open(s.toString(),"idpWindow",null==t?void 0:t.windowOpenerFeatures))&&void 0!==i?i:void 0;const a=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure("UserInterrupt",null==t?void 0:t.onError):setTimeout(a,500))};a()}_getEventHandler(t,e){return async n=>{var r,i,o;if(n.origin!==t.origin)return;const s=n.data;switch(s.kind){case"authorize-ready":{const n=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array(null===(r=this._key)||void 0===r?void 0:r.getPublicKey().toDer()),maxTimeToLive:null==e?void 0:e.maxTimeToLive,allowPinAuthentication:null==e?void 0:e.allowPinAuthentication,derivationOrigin:null===(i=null==e?void 0:e.derivationOrigin)||void 0===i?void 0:i.toString()},null==e?void 0:e.customValues);null===(o=this._idpWindow)||void 0===o||o.postMessage(n,t.origin);break}case"authorize-client-success":try{await this._handleSuccess(s,null==e?void 0:e.onSuccess)}catch(t){this._handleFailure(t.message,null==e?void 0:e.onError)}break;case"authorize-client-failure":this._handleFailure(s.text,null==e?void 0:e.onError)}}}_handleFailure(t,e){var n;null===(n=this._idpWindow)||void 0===n||n.close(),null==e||e(t),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(t={}){if(await yf(this._storage),this._identity=new qi,this._chain=null,t.returnTo)try{window.history.pushState({},"",t.returnTo)}catch(e){window.location.href=t.returnTo}}}async function yf(t){await t.remove(uf),await t.remove(lf),await t.remove("iv")}function wf(t){return new Promise(((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)}))}let vf;function Ef(){return vf||(vf=function(t,e){const n=indexedDB.open(t);n.onupgradeneeded=()=>n.result.createObjectStore(e);const r=wf(n);return(t,n)=>r.then((r=>n(r.transaction(e,t).objectStore(e))))}("keyval-store","keyval")),vf}function xf(t,e=Ef()){return e("readonly",(e=>wf(e.get(t))))}const _f="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Af(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function Tf(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Sf(t,...e){if(!Af(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Nf(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.createHasher");Tf(t.outputLen),Tf(t.blockLen)}function Bf(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function If(t,e){Sf(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Of(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Rf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function $f(t,e){return t<<32-e|t>>>e}function kf(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const Lf=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]?t=>t:function(t){for(let e=0;e<t.length;e++)t[e]=kf(t[e]);return t},Pf="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,Uf=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function Df(t){if(Sf(t),Pf)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=Uf[t[n]];return e}const Cf={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ff(t){return t>=Cf._0&&t<=Cf._9?t-Cf._0:t>=Cf.A&&t<=Cf.F?t-(Cf.A-10):t>=Cf.a&&t<=Cf.f?t-(Cf.a-10):void 0}function Mf(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);if(Pf)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let e=0,i=0;e<n;e++,i+=2){const n=Ff(t.charCodeAt(i)),o=Ff(t.charCodeAt(i+1));if(void 0===n||void 0===o){const e=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+i)}r[e]=16*n+o}return r}function jf(t){if("string"!=typeof t)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}function qf(t){return"string"==typeof t&&(t=jf(t)),Sf(t),t}function Vf(...t){let e=0;for(let n=0;n<t.length;n++){const r=t[n];Sf(r),e+=r.length}const n=new Uint8Array(e);for(let e=0,r=0;e<t.length;e++){const i=t[e];n.set(i,r),r+=i.length}return n}class zf{}function Hf(t){const e=e=>t().update(qf(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Gf(t=32){if(_f&&"function"==typeof _f.getRandomValues)return _f.getRandomValues(new Uint8Array(t));if(_f&&"function"==typeof _f.randomBytes)return Uint8Array.from(_f.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function Kf(t,e,n){return t&e^~t&n}function Wf(t,e,n){return t&e^t&n^e&n}class Zf extends zf{constructor(t,e,n,r){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.buffer=new Uint8Array(t),this.view=Rf(this.buffer)}update(t){Bf(this),Sf(t=qf(t));const{view:e,buffer:n,blockLen:r}=this,i=t.length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(e,0),this.pos=0);else{const e=Rf(t);for(;r<=i-o;o+=r)this.process(e,o)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){Bf(this),If(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;e[o++]=128,Of(this.buffer.subarray(o)),this.padOffset>r-o&&(this.process(n,0),o=0);for(let t=o;t<r;t++)e[t]=0;(function(t,e,n,r){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,u=r?0:4;t.setUint32(e+c,s,r),t.setUint32(e+u,a,r)})(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=Rf(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return t.destroyed=o,t.finished=i,t.length=r,t.pos=s,r%e&&t.buffer.set(n),t}clone(){return this._cloneInto()}}const Yf=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Xf=BigInt(2**32-1),Jf=BigInt(32);function Qf(t,e=!1){return e?{h:Number(t&Xf),l:Number(t>>Jf&Xf)}:{h:0|Number(t>>Jf&Xf),l:0|Number(t&Xf)}}function td(t,e=!1){const n=t.length;let r=new Uint32Array(n),i=new Uint32Array(n);for(let o=0;o<n;o++){const{h:n,l:s}=Qf(t[o],e);[r[o],i[o]]=[n,s]}return[r,i]}const ed=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),nd=new Uint32Array(64);class rd extends Zf{constructor(t=32){super(64,t,8,!1),this.A=0|Yf[0],this.B=0|Yf[1],this.C=0|Yf[2],this.D=0|Yf[3],this.E=0|Yf[4],this.F=0|Yf[5],this.G=0|Yf[6],this.H=0|Yf[7]}get(){const{A:t,B:e,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[t,e,n,r,i,o,s,a]}set(t,e,n,r,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let n=0;n<16;n++,e+=4)nd[n]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=nd[t-15],n=nd[t-2],r=$f(e,7)^$f(e,18)^e>>>3,i=$f(n,17)^$f(n,19)^n>>>10;nd[t]=i+nd[t-7]+r+nd[t-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+($f(s,6)^$f(s,11)^$f(s,25))+Kf(s,a,c)+ed[t]+nd[t]|0,l=($f(n,2)^$f(n,13)^$f(n,22))+Wf(n,r,i)|0;u=c,c=a,a=s,s=o+e|0,o=i,i=r,r=n,n=e+l|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,i,o,s,a,c,u)}roundClean(){Of(nd)}destroy(){this.set(0,0,0,0,0,0,0,0),Of(this.buffer)}}td(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t))));const id=Hf((()=>new rd)),od=BigInt(0),sd=BigInt(1);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ad(t,e){if("boolean"!=typeof e)throw new Error(t+" boolean expected, got "+e)}function cd(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return""===t?od:BigInt("0x"+t)}function ud(t){return cd(Df(t))}function ld(t){return Sf(t),cd(Df(Uint8Array.from(t).reverse()))}function fd(t,e){return Mf(t.toString(16).padStart(2*e,"0"))}function dd(t,e){return fd(t,e).reverse()}function hd(t,e,n){let r;if("string"==typeof e)try{r=Mf(e)}catch(e){throw new Error(t+" must be hex string or Uint8Array, cause: "+e)}else{if(!Af(e))throw new Error(t+" must be hex string or Uint8Array");r=Uint8Array.from(e)}const i=r.length;if("number"==typeof n&&i!==n)throw new Error(t+" of length "+n+" expected, got "+i);return r}const pd=t=>"bigint"==typeof t&&od<=t;function gd(t){let e;for(e=0;t>od;t>>=sd,e+=1);return e}function md(t,e){return t>>BigInt(e)&sd}const bd=t=>(sd<<BigInt(t))-sd;function yd(t,e,n={}){if(!t||"object"!=typeof t)throw new Error("expected valid options object");function r(e,n,r){const i=t[e];if(r&&void 0===i)return;const o=typeof i;if(o!==n||null===i)throw new Error(`param "${e}" is invalid: expected ${n}, got ${o}`)}Object.entries(e).forEach((([t,e])=>r(t,e,!1))),Object.entries(n).forEach((([t,e])=>r(t,e,!0)))}const wd=()=>{throw new Error("not implemented")};function vd(t){const e=new WeakMap;return(n,...r)=>{const i=e.get(n);if(void 0!==i)return i;const o=t(n,...r);return e.set(n,o),o}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ed=BigInt(0),xd=BigInt(1),_d=BigInt(2),Ad=BigInt(3),Td=BigInt(4),Sd=BigInt(5),Nd=BigInt(8);function Bd(t,e){const n=t%e;return n>=Ed?n:e+n}function Id(t,e){if(t===Ed)throw new Error("invert: expected non-zero number");if(e<=Ed)throw new Error("invert: expected positive modulus, got "+e);let n=Bd(t,e),r=e,i=Ed,o=xd;for(;n!==Ed;){const t=r%n,e=i-o*(r/n);r=n,n=t,i=o,o=e}if(r!==xd)throw new Error("invert: does not exist");return Bd(i,e)}function Od(t,e){const n=(t.ORDER+xd)/Td,r=t.pow(e,n);if(!t.eql(t.sqr(r),e))throw new Error("Cannot find square root");return r}function Rd(t,e){const n=(t.ORDER-Sd)/Nd,r=t.mul(e,_d),i=t.pow(r,n),o=t.mul(e,i),s=t.mul(t.mul(o,_d),i),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function $d(t){return t%Td===Ad?Od:t%Nd===Sd?Rd:function(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-xd,n=0;for(;e%_d===Ed;)e/=_d,n++;let r=_d;const i=Cd(t);for(;1===Dd(i,r);)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===n)return Od;let o=i.pow(r,e);const s=(e+xd)/_d;return function(t,r){if(t.is0(r))return r;if(1!==Dd(t,r))throw new Error("Cannot find square root");let i=n,a=t.mul(t.ONE,o),c=t.pow(r,e),u=t.pow(r,s);for(;!t.eql(c,t.ONE);){if(t.is0(c))return t.ZERO;let e=1,n=t.sqr(c);for(;!t.eql(n,t.ONE);)if(e++,n=t.sqr(n),e===i)throw new Error("Cannot find square root");const r=xd<<BigInt(i-e-1),o=t.pow(a,r);i=e,a=t.sqr(o),c=t.mul(c,a),u=t.mul(u,o)}return u}}(t)}const kd=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ld(t){return yd(t,kd.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),t}function Pd(t,e,n){if(n<Ed)throw new Error("invalid exponent, negatives unsupported");if(n===Ed)return t.ONE;if(n===xd)return e;let r=t.ONE,i=e;for(;n>Ed;)n&xd&&(r=t.mul(r,i)),i=t.sqr(i),n>>=xd;return r}function Ud(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),i=e.reduce(((e,n,i)=>t.is0(n)?e:(r[i]=e,t.mul(e,n))),t.ONE),o=t.inv(i);return e.reduceRight(((e,n,i)=>t.is0(n)?e:(r[i]=t.mul(e,r[i]),t.mul(e,n))),o),r}function Dd(t,e){const n=(t.ORDER-xd)/_d,r=t.pow(e,n),i=t.eql(r,t.ONE),o=t.eql(r,t.ZERO),s=t.eql(r,t.neg(t.ONE));if(!i&&!o&&!s)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function Cd(t,e,n=!1,r={}){if(t<=Ed)throw new Error("invalid field: expected ORDER > 0, got "+t);let i,o;if("object"==typeof e&&null!=e){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const t=e;t.BITS&&(i=t.BITS),t.sqrt&&(o=t.sqrt),"boolean"==typeof t.isLE&&(n=t.isLE)}else"number"==typeof e&&(i=e),r.sqrt&&(o=r.sqrt);const{nBitLength:s,nByteLength:a}=function(t,e){void 0!==e&&Tf(e);const n=void 0!==e?e:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}(t,i);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const u=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:a,MASK:bd(s),ZERO:Ed,ONE:xd,create:e=>Bd(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("invalid field element: expected bigint, got "+typeof e);return Ed<=e&&e<t},is0:t=>t===Ed,isValidNot0:t=>!u.is0(t)&&u.isValid(t),isOdd:t=>(t&xd)===xd,neg:e=>Bd(-e,t),eql:(t,e)=>t===e,sqr:e=>Bd(e*e,t),add:(e,n)=>Bd(e+n,t),sub:(e,n)=>Bd(e-n,t),mul:(e,n)=>Bd(e*n,t),pow:(t,e)=>Pd(u,t,e),div:(e,n)=>Bd(e*Id(n,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>Id(e,t),sqrt:o||(e=>(c||(c=$d(t)),c(u,e))),toBytes:t=>n?dd(t,a):fd(t,a),fromBytes:t=>{if(t.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+t.length);return n?ld(t):ud(t)},invertBatch:t=>Ud(u,t),cmov:(t,e,n)=>n?e:t});return Object.freeze(u)}function Fd(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Md(t){const e=Fd(t);return e+Math.ceil(e/2)}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const jd=BigInt(0),qd=BigInt(1);function Vd(t,e){const n=e.negate();return t?n:e}function zd(t,e,n){const r="pz"===e?t=>t.pz:t=>t.ez,i=Ud(t.Fp,n.map(r));return n.map(((t,e)=>t.toAffine(i[e]))).map(t.fromAffine)}function Hd(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Gd(t,e){Hd(t,e);const n=2**t;return{windows:Math.ceil(e/t)+1,windowSize:2**(t-1),mask:bd(t),maxNumber:n,shiftBy:BigInt(t)}}function Kd(t,e,n){const{windowSize:r,mask:i,maxNumber:o,shiftBy:s}=n;let a=Number(t&i),c=t>>s;a>r&&(a-=o,c+=qd);const u=e*r;return{nextN:c,offset:u+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:e%2!=0,offsetF:u}}const Wd=new WeakMap,Zd=new WeakMap;function Yd(t){return Zd.get(t)||1}function Xd(t){if(t!==jd)throw new Error("invalid wNAF")}function Jd(t,e,n,r){(function(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach(((t,n)=>{if(!(t instanceof e))throw new Error("invalid point at index "+n)}))})(n,t),function(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach(((t,n)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+n)}))}(r,e);const i=n.length,o=r.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,a=gd(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=bd(c),l=new Array(Number(u)+1).fill(s);let f=s;for(let t=Math.floor((e.BITS-1)/c)*c;t>=0;t-=c){l.fill(s);for(let e=0;e<o;e++){const i=r[e],o=Number(i>>BigInt(t)&u);l[o]=l[o].add(n[e])}let e=s;for(let t=l.length-1,n=s;t>0;t--)n=n.add(l[t]),e=e.add(n);if(f=f.add(e),0!==t)for(let t=0;t<c;t++)f=f.double()}return f}function Qd(t,e){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Ld(e),e}return Cd(t)}const th=ud;function eh(t,e){if(rh(t),rh(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const n=Array.from({length:e}).fill(0);for(let r=e-1;r>=0;r--)n[r]=255&t,t>>>=8;return new Uint8Array(n)}function nh(t,e){const n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t[r]^e[r];return n}function rh(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function ih(t,e,n){yd(n,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:r,k:i,m:o,hash:s,expand:a,DST:c}=n;if(!Af(c)&&"string"!=typeof c)throw new Error("DST must be string or uint8array");if(!function(t){return"function"==typeof t&&Number.isSafeInteger(t.outputLen)}(n.hash))throw new Error("expected valid hash");Sf(t),rh(e);const u="string"==typeof c?jf(c):c,l=r.toString(2).length,f=Math.ceil((l+i)/8),d=e*o*f;let h;if("xmd"===a)h=function(t,e,n,r){Sf(t),Sf(e),rh(n),e.length>255&&(e=r(Vf(jf("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:o}=r,s=Math.ceil(n/i);if(n>65535||s>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=Vf(e,eh(e.length,1)),c=eh(0,o),u=eh(n,2),l=new Array(s),f=r(Vf(c,t,u,eh(0,1),a));l[0]=r(Vf(f,eh(1,1),a));for(let t=1;t<=s;t++){const e=[nh(f,l[t-1]),eh(t+1,1),a];l[t]=r(Vf(...e))}return Vf(...l).slice(0,n)}(t,u,d,s);else if("xof"===a)h=function(t,e,n,r,i){if(Sf(t),Sf(e),rh(n),e.length>255){const t=Math.ceil(2*r/8);e=i.create({dkLen:t}).update(jf("H2C-OVERSIZE-DST-")).update(e).digest()}if(n>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:n}).update(t).update(eh(n,2)).update(e).update(eh(e.length,1)).digest()}(t,u,d,i,s);else{if("_internal_pass"!==a)throw new Error('expand must be "xmd" or "xof"');h=t}const p=new Array(e);for(let t=0;t<e;t++){const e=new Array(o);for(let n=0;n<o;n++){const i=f*(n+t*o),s=h.subarray(i,i+f);e[n]=Bd(th(s),r)}p[t]=e}return p}function oh(t,e){const n=e.map((t=>Array.from(t).reverse()));return(e,r)=>{const[i,o,s,a]=n.map((n=>n.reduce(((n,r)=>t.add(t.mul(n,e),r))))),[c,u]=Ud(t,[o,a],!0);return e=t.mul(i,c),r=t.mul(r,t.mul(s,u)),{x:e,y:r}}}function sh(t,e,n){if("function"!=typeof e)throw new Error("mapToCurve() must be defined");function r(n){return t.fromAffine(e(n))}function i(e){const n=e.clearCofactor();return n.equals(t.ZERO)?t.ZERO:(n.assertValidity(),n)}return{defaults:n,hashToCurve(t,e){const o=n.DST?n.DST:{},s=ih(t,2,Object.assign({},n,o,e)),a=r(s[0]),c=r(s[1]);return i(a.add(c))},encodeToCurve(t,e){const o=n.encodeDST?n.encodeDST:{};return i(r(ih(t,1,Object.assign({},n,o,e))[0]))},mapToCurve(t){if(!Array.isArray(t))throw new Error("expected array of bigints");for(const e of t)if("bigint"!=typeof e)throw new Error("expected array of bigints");return i(r(t))}}}class ah extends zf{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,Nf(t);const n=qf(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?t.create().update(n).digest():n);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),Of(i)}update(t){return Bf(this),this.iHash.update(t),this}digestInto(t){Bf(this),Sf(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return t.finished=r,t.destroyed=i,t.blockLen=o,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ch=(t,e,n)=>new ah(t,e).update(n).digest();ch.create=(t,e)=>new ah(t,e)
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */;const uh=BigInt(0),lh=BigInt(1),fh=BigInt(2),dh=BigInt(3),hh=BigInt(4);function ph(t,e,n){return function(r){const i=t.sqr(r),o=t.mul(i,r);return t.add(t.add(o,t.mul(r,e)),n)}}function gh(t,e,n){const{BYTES:r}=t;return function(i){let o;if("bigint"==typeof i)o=i;else{let n=hd("private key",i);if(e){if(!e.includes(2*n.length))throw new Error("invalid private key");const t=new Uint8Array(r);t.set(n,t.length-n.length),n=t}try{o=t.fromBytes(n)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(n&&(o=t.create(o)),!t.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}}function mh(t,e={}){const{Fp:n,Fn:r}=function(t,e,n={}){if(!e||"object"!=typeof e)throw new Error(`expected valid ${t} CURVE object`);for(const t of["p","n","h"]){const n=e[t];if(!("bigint"==typeof n&&n>jd))throw new Error(`CURVE.${t} must be positive bigint`)}const r=Qd(e.p,n.Fp),i=Qd(e.n,n.Fn),o=["Gx","Gy","a","weierstrass"===t?"b":"d"];for(const t of o)if(!r.isValid(e[t]))throw new Error(`CURVE.${t} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:i}}("weierstrass",t,e),{h:i,n:o}=t;yd(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:s}=e;if(s&&(!n.is0(t.a)||"bigint"!=typeof s.beta||"function"!=typeof s.splitScalar))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const c=e.toBytes||function(t,e,r){const{x:i,y:o}=e.toAffine(),s=n.toBytes(i);if(ad("isCompressed",r),r){a();return Vf(function(t){return Uint8Array.of(t?2:3)}(!n.isOdd(o)),s)}return Vf(Uint8Array.of(4),s,n.toBytes(o))},u=e.fromBytes||function(t){Sf(t);const e=n.BYTES,r=e+1,i=2*e+1,o=t.length,s=t[0],c=t.subarray(1);if(o!==r||2!==s&&3!==s){if(o===i&&4===s){const t=n.fromBytes(c.subarray(0*e,1*e)),r=n.fromBytes(c.subarray(1*e,2*e));if(!f(t,r))throw new Error("bad point: is not on curve");return{x:t,y:r}}throw new Error(`bad point: got length ${o}, expected compressed=${r} or uncompressed=${i}`)}{const t=n.fromBytes(c);if(!n.isValid(t))throw new Error("bad point: is not on curve, wrong x");const e=l(t);let r;try{r=n.sqrt(e)}catch(t){const e=t instanceof Error?": "+t.message:"";throw new Error("bad point: is not on curve, sqrt error"+e)}a();return 1==(1&s)!==n.isOdd(r)&&(r=n.neg(r)),{x:t,y:r}}},l=ph(n,t.a,t.b);function f(t,e){const r=n.sqr(e),i=l(t);return n.eql(r,i)}if(!f(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const d=n.mul(n.pow(t.a,dh),hh),h=n.mul(n.sqr(t.b),BigInt(27));if(n.is0(n.add(d,h)))throw new Error("bad curve params: a or b");function p(t,e,r=!1){if(!n.isValid(e)||r&&n.is0(e))throw new Error(`bad point coordinate ${t}`);return e}function g(t){if(!(t instanceof w))throw new Error("ProjectivePoint expected")}const m=vd(((t,e)=>{const{px:r,py:i,pz:o}=t;if(n.eql(o,n.ONE))return{x:r,y:i};const s=t.is0();null==e&&(e=s?n.ONE:n.inv(o));const a=n.mul(r,e),c=n.mul(i,e),u=n.mul(o,e);if(s)return{x:n.ZERO,y:n.ZERO};if(!n.eql(u,n.ONE))throw new Error("invZ was invalid");return{x:a,y:c}})),b=vd((t=>{if(t.is0()){if(e.allowInfinityPoint&&!n.is0(t.py))return;throw new Error("bad point: ZERO")}const{x:r,y:i}=t.toAffine();if(!n.isValid(r)||!n.isValid(i))throw new Error("bad point: x or y not field elements");if(!f(r,i))throw new Error("bad point: equation left != right");if(!t.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));function y(t,e,r,i,o){return r=new w(n.mul(r.px,t),r.py,r.pz),e=Vd(i,e),r=Vd(o,r),e.add(r)}class w{constructor(t,e,n){this.px=p("x",t),this.py=p("y",e,!0),this.pz=p("z",n),Object.freeze(this)}static fromAffine(t){const{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw new Error("invalid affine point");if(t instanceof w)throw new Error("projective point not allowed");return n.is0(e)&&n.is0(r)?w.ZERO:new w(e,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){return zd(w,"pz",t)}static fromBytes(t){return Sf(t),w.fromHex(t)}static fromHex(t){const e=w.fromAffine(u(hd("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){const n=gh(r,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return w.BASE.multiply(n(t))}static msm(t,e){return Jd(w,r,t,e)}precompute(t=8,e=!0){return E.setWindowSize(this,t),e||this.multiply(dh),this}_setWindowSize(t){this.precompute(t)}assertValidity(){b(this)}hasEvenY(){const{y:t}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(t)}equals(t){g(t);const{px:e,py:r,pz:i}=this,{px:o,py:s,pz:a}=t,c=n.eql(n.mul(e,a),n.mul(o,i)),u=n.eql(n.mul(r,a),n.mul(s,i));return c&&u}negate(){return new w(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,i=n.mul(r,dh),{px:o,py:s,pz:a}=this;let c=n.ZERO,u=n.ZERO,l=n.ZERO,f=n.mul(o,o),d=n.mul(s,s),h=n.mul(a,a),p=n.mul(o,s);return p=n.add(p,p),l=n.mul(o,a),l=n.add(l,l),c=n.mul(e,l),u=n.mul(i,h),u=n.add(c,u),c=n.sub(d,u),u=n.add(d,u),u=n.mul(c,u),c=n.mul(p,c),l=n.mul(i,l),h=n.mul(e,h),p=n.sub(f,h),p=n.mul(e,p),p=n.add(p,l),l=n.add(f,f),f=n.add(l,f),f=n.add(f,h),f=n.mul(f,p),u=n.add(u,f),h=n.mul(s,a),h=n.add(h,h),f=n.mul(h,p),c=n.sub(c,f),l=n.mul(h,d),l=n.add(l,l),l=n.add(l,l),new w(c,u,l)}add(e){g(e);const{px:r,py:i,pz:o}=this,{px:s,py:a,pz:c}=e;let u=n.ZERO,l=n.ZERO,f=n.ZERO;const d=t.a,h=n.mul(t.b,dh);let p=n.mul(r,s),m=n.mul(i,a),b=n.mul(o,c),y=n.add(r,i),v=n.add(s,a);y=n.mul(y,v),v=n.add(p,m),y=n.sub(y,v),v=n.add(r,o);let E=n.add(s,c);return v=n.mul(v,E),E=n.add(p,b),v=n.sub(v,E),E=n.add(i,o),u=n.add(a,c),E=n.mul(E,u),u=n.add(m,b),E=n.sub(E,u),f=n.mul(d,v),u=n.mul(h,b),f=n.add(u,f),u=n.sub(m,f),f=n.add(m,f),l=n.mul(u,f),m=n.add(p,p),m=n.add(m,p),b=n.mul(d,b),v=n.mul(h,v),m=n.add(m,b),b=n.sub(p,b),b=n.mul(d,b),v=n.add(v,b),p=n.mul(m,v),l=n.add(l,p),p=n.mul(E,v),u=n.mul(y,u),u=n.sub(u,p),p=n.mul(y,m),f=n.mul(E,f),f=n.add(f,p),new w(u,l,f)}subtract(t){return this.add(t.negate())}is0(){return this.equals(w.ZERO)}multiply(t){const{endo:n}=e;if(!r.isValidNot0(t))throw new Error("invalid scalar: out of range");let i,o;const s=t=>E.wNAFCached(this,t,w.normalizeZ);if(n){const{k1neg:e,k1:r,k2neg:a,k2:c}=n.splitScalar(t),{p:u,f:l}=s(r),{p:f,f:d}=s(c);o=l.add(d),i=y(n.beta,u,f,e,a)}else{const{p:e,f:n}=s(t);i=e,o=n}return w.normalizeZ([i,o])[0]}multiplyUnsafe(t){const{endo:n}=e,i=this;if(!r.isValid(t))throw new Error("invalid scalar: out of range");if(t===uh||i.is0())return w.ZERO;if(t===lh)return i;if(E.hasPrecomputes(this))return this.multiply(t);if(n){const{k1neg:e,k1:r,k2neg:o,k2:s}=n.splitScalar(t),{p1:a,p2:c}=function(t,e,n,r){let i=e,o=t.ZERO,s=t.ZERO;for(;n>jd||r>jd;)n&qd&&(o=o.add(i)),r&qd&&(s=s.add(i)),i=i.double(),n>>=qd,r>>=qd;return{p1:o,p2:s}}(w,i,r,s);return y(n.beta,a,c,e,o)}return E.wNAFCachedUnsafe(i,t)}multiplyAndAddUnsafe(t,e,n){const r=this.multiplyUnsafe(e).add(t.multiplyUnsafe(n));return r.is0()?void 0:r}toAffine(t){return m(this,t)}isTorsionFree(){const{isTorsionFree:t}=e;return i===lh||(t?t(w,this):E.wNAFCachedUnsafe(this,o).is0())}clearCofactor(){const{clearCofactor:t}=e;return i===lh?this:t?t(w,this):this.multiplyUnsafe(i)}toBytes(t=!0){return ad("isCompressed",t),this.assertValidity(),c(w,this,t)}toRawBytes(t=!0){return this.toBytes(t)}toHex(t=!0){return Df(this.toBytes(t))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}w.BASE=new w(t.Gx,t.Gy,n.ONE),w.ZERO=new w(n.ZERO,n.ONE,n.ZERO),w.Fp=n,w.Fn=r;const v=r.BITS,E=function(t,e){return{constTimeNegate:Vd,hasPrecomputes:t=>1!==Yd(t),unsafeLadder(e,n,r=t.ZERO){let i=e;for(;n>jd;)n&qd&&(r=r.add(i)),i=i.double(),n>>=qd;return r},precomputeWindow(t,n){const{windows:r,windowSize:i}=Gd(n,e),o=[];let s=t,a=s;for(let t=0;t<r;t++){a=s,o.push(a);for(let t=1;t<i;t++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(n,r,i){let o=t.ZERO,s=t.BASE;const a=Gd(n,e);for(let t=0;t<a.windows;t++){const{nextN:e,offset:n,isZero:c,isNeg:u,isNegF:l,offsetF:f}=Kd(i,t,a);i=e,c?s=s.add(Vd(l,r[f])):o=o.add(Vd(u,r[n]))}return Xd(i),{p:o,f:s}},wNAFUnsafe(n,r,i,o=t.ZERO){const s=Gd(n,e);for(let t=0;t<s.windows&&i!==jd;t++){const{nextN:e,offset:n,isZero:a,isNeg:c}=Kd(i,t,s);if(i=e,!a){const t=r[n];o=o.add(c?t.negate():t)}}return Xd(i),o},getPrecomputes(t,e,n){let r=Wd.get(e);return r||(r=this.precomputeWindow(e,t),1!==t&&("function"==typeof n&&(r=n(r)),Wd.set(e,r))),r},wNAFCached(t,e,n){const r=Yd(t);return this.wNAF(r,this.getPrecomputes(r,t,n),e)},wNAFCachedUnsafe(t,e,n,r){const i=Yd(t);return 1===i?this.unsafeLadder(t,e,r):this.wNAFUnsafe(i,this.getPrecomputes(i,t,n),e,r)},setWindowSize(t,n){Hd(n,e),Zd.set(t,n),Wd.delete(t)}}}(w,e.endo?Math.ceil(v/2):v);return w}function bh(t){const{CURVE:e,curveOpts:n}=function(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp,r=Cd(e.n,t.nBitLength),i={Fp:n,Fn:r,allowedPrivateKeyLengths:t.allowedPrivateKeyLengths,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,wrapPrivateKey:t.wrapPrivateKey,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:i}}(t);return function(t,e){const{Fp:n,Fn:r}=e;function i(t){return function(t,e,n){return pd(t)&&pd(e)&&pd(n)&&e<=t&&t<n}(t,lh,r.ORDER)}const o=ph(n,t.a,t.b),s=gh(r,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return Object.assign({},{CURVE:t,Point:e,ProjectivePoint:e,normPrivateKeyToScalar:s,weierstrassEquation:o,isWithinCurveOrder:i})}(t,mh(e,n))}function yh(t,e){Ld(t);const{A:n,B:r,Z:i}=e;if(!t.isValid(n)||!t.isValid(r)||!t.isValid(i))throw new Error("mapToCurveSimpleSWU: invalid opts");const o=function(t,e){const n=t.ORDER;let r=uh;for(let t=n-lh;t%fh===uh;t/=fh)r+=lh;const i=r,o=fh<<i-lh-lh,s=o*fh,a=(n-lh)/s,c=(a-lh)/fh,u=s-lh,l=o,f=t.pow(e,a),d=t.pow(e,(a+lh)/fh);let h=(e,n)=>{let r=f,o=t.pow(n,u),s=t.sqr(o);s=t.mul(s,n);let a=t.mul(e,s);a=t.pow(a,c),a=t.mul(a,o),o=t.mul(a,n),s=t.mul(a,e);let h=t.mul(s,o);a=t.pow(h,l);let p=t.eql(a,t.ONE);o=t.mul(s,d),a=t.mul(h,r),s=t.cmov(o,s,p),h=t.cmov(a,h,p);for(let e=i;e>lh;e--){let n=e-fh;n=fh<<n-lh;let i=t.pow(h,n);const a=t.eql(i,t.ONE);o=t.mul(s,r),r=t.mul(r,r),i=t.mul(h,r),s=t.cmov(o,s,a),h=t.cmov(i,h,a)}return{isValid:p,value:s}};if(t.ORDER%hh===dh){const n=(t.ORDER-dh)/hh,r=t.sqrt(t.neg(e));h=(e,i)=>{let o=t.sqr(i);const s=t.mul(e,i);o=t.mul(o,s);let a=t.pow(o,n);a=t.mul(a,s);const c=t.mul(a,r),u=t.mul(t.sqr(a),i),l=t.eql(u,e);return{isValid:l,value:t.cmov(c,a,l)}}}return h}(t,i);if(!t.isOdd)throw new Error("Field does not have .isOdd()");return e=>{let s,a,c,u,l,f,d,h;s=t.sqr(e),s=t.mul(s,i),a=t.sqr(s),a=t.add(a,s),c=t.add(a,t.ONE),c=t.mul(c,r),u=t.cmov(i,t.neg(a),!t.eql(a,t.ZERO)),u=t.mul(u,n),a=t.sqr(c),f=t.sqr(u),l=t.mul(f,n),a=t.add(a,l),a=t.mul(a,c),f=t.mul(f,u),l=t.mul(f,r),a=t.add(a,l),d=t.mul(s,c);const{isValid:p,value:g}=o(a,f);h=t.mul(s,e),h=t.mul(h,g),d=t.cmov(d,c,p),h=t.cmov(h,g,p);const m=t.isOdd(e)===t.isOdd(h);h=t.cmov(t.neg(h),h,m);const b=Ud(t,[u],!0)[0];return d=t.mul(d,b),{x:d,y:h}}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const wh=BigInt(0),vh=BigInt(1),Eh=BigInt(2),xh=BigInt(3);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const _h=BigInt(0),Ah=BigInt(1),Th=BigInt(2),Sh=BigInt(3);function Nh(t,e,n,r,i=1,o){const s=BigInt(void 0===o?r:o),a=n**BigInt(r),c=[];for(let o=0;o<i;o++){const i=BigInt(o+1),u=[];for(let o=0,c=Ah;o<r;o++){const r=(i*c-i)/s%a;u.push(t.pow(e,r)),c*=n}c.push(u)}return c}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const Bh=BigInt(0),Ih=BigInt(1),Oh=BigInt(2),Rh=BigInt(3),$h=BigInt(4),kh=BigInt("0xd201000000010000"),Lh=gd(kh),Ph={p:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),n:BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001"),h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),a:Bh,b:$h,Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1")},Uh=Cd(Ph.n),{Fp:Dh,Fp2:Ch,Fp6:Fh,Fp4Square:Mh,Fp12:jh}=function(t){const{ORDER:e}=t,n=Cd(e),r=n.create(t.NONRESIDUE||BigInt(-1)),i=n.div(n.ONE,Th),o=Nh(n,r,n.ORDER,2)[0],s=({c0:t,c1:e},{c0:r,c1:i})=>({c0:n.add(t,r),c1:n.add(e,i)}),a=({c0:t,c1:e},{c0:r,c1:i})=>({c0:n.sub(t,r),c1:n.sub(e,i)}),c=({c0:t,c1:e},r)=>{if("bigint"==typeof r)return{c0:n.mul(t,r),c1:n.mul(e,r)};const{c0:i,c1:o}=r;let s=n.mul(t,i),a=n.mul(e,o);return{c0:n.sub(s,a),c1:n.sub(n.mul(n.add(t,e),n.add(i,o)),n.add(s,a))}},u=({c0:t,c1:e})=>{const r=n.add(t,e),i=n.sub(t,e),o=n.add(t,t);return{c0:n.mul(r,i),c1:n.mul(o,e)}},l=t=>{if(2!==t.length)throw new Error("invalid tuple");const e=t.map((t=>n.create(t)));return{c0:e[0],c1:e[1]}};function f(t,e){return"bigint"==typeof t&&_h<=t&&t<e}const d=e*e,h=l(t.FP2_NONRESIDUE),p={ORDER:d,isLE:n.isLE,NONRESIDUE:h,BITS:gd(d),BYTES:Math.ceil(gd(d)/8),MASK:bd(gd(d)),ZERO:{c0:n.ZERO,c1:n.ZERO},ONE:{c0:n.ONE,c1:n.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>f(t,d)&&f(e,d),is0:({c0:t,c1:e})=>n.is0(t)&&n.is0(e),isValidNot0:t=>!p.is0(t)&&p.isValid(t),eql:({c0:t,c1:e},{c0:r,c1:i})=>n.eql(t,r)&&n.eql(e,i),neg:({c0:t,c1:e})=>({c0:n.neg(t),c1:n.neg(e)}),pow:(t,e)=>Pd(p,t,e),invertBatch:t=>Ud(p,t),add:s,sub:a,mul:c,sqr:u,addN:s,subN:a,mulN:c,sqrN:u,div:(t,e)=>p.mul(t,"bigint"==typeof e?n.inv(n.create(e)):p.inv(e)),inv:({c0:t,c1:e})=>{const r=n.inv(n.create(t*t+e*e));return{c0:n.mul(r,n.create(t)),c1:n.mul(r,n.create(-e))}},sqrt:e=>{if(t.Fp2sqrt)return t.Fp2sqrt(e);const{c0:o,c1:s}=e;if(n.is0(s))return 1===Dd(n,o)?p.create({c0:n.sqrt(o),c1:n.ZERO}):p.create({c0:n.ZERO,c1:n.sqrt(n.div(o,r))});const a=n.sqrt(n.sub(n.sqr(o),n.mul(n.sqr(s),r)));let c=n.mul(n.add(a,o),i);-1===Dd(n,c)&&(c=n.sub(c,a));const u=n.sqrt(c),l=p.create({c0:u,c1:n.div(n.mul(s,i),u)});if(!p.eql(p.sqr(l),e))throw new Error("Cannot find square root");const f=l,d=p.neg(f),{re:h,im:g}=p.reim(f),{re:m,im:b}=p.reim(d);return g>b||g===b&&h>m?f:d},isOdd:t=>{const{re:e,im:n}=p.reim(t);return BigInt(e%Th||e===_h&&n%Th)==Ah},fromBytes(t){if(t.length!==p.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:n.fromBytes(t.subarray(0,n.BYTES)),c1:n.fromBytes(t.subarray(n.BYTES))}},toBytes:({c0:t,c1:e})=>Vf(n.toBytes(t),n.toBytes(e)),cmov:({c0:t,c1:e},{c0:r,c1:i},o)=>({c0:n.cmov(t,r,o),c1:n.cmov(e,i,o)}),reim:({c0:t,c1:e})=>({re:t,im:e}),mulByNonresidue:({c0:t,c1:e})=>p.mul({c0:t,c1:e},h),mulByB:t.Fp2mulByB,fromBigTuple:l,frobeniusMap:({c0:t,c1:e},r)=>({c0:t,c1:n.mul(e,o[r%2])})},g=({c0:t,c1:e,c2:n},{c0:r,c1:i,c2:o})=>({c0:p.add(t,r),c1:p.add(e,i),c2:p.add(n,o)}),m=({c0:t,c1:e,c2:n},{c0:r,c1:i,c2:o})=>({c0:p.sub(t,r),c1:p.sub(e,i),c2:p.sub(n,o)}),b=({c0:t,c1:e,c2:n},r)=>{if("bigint"==typeof r)return{c0:p.mul(t,r),c1:p.mul(e,r),c2:p.mul(n,r)};const{c0:i,c1:o,c2:s}=r,a=p.mul(t,i),c=p.mul(e,o),u=p.mul(n,s);return{c0:p.add(a,p.mulByNonresidue(p.sub(p.mul(p.add(e,n),p.add(o,s)),p.add(c,u)))),c1:p.add(p.sub(p.mul(p.add(t,e),p.add(i,o)),p.add(a,c)),p.mulByNonresidue(u)),c2:p.sub(p.add(c,p.mul(p.add(t,n),p.add(i,s))),p.add(a,u))}},y=({c0:t,c1:e,c2:n})=>{let r=p.sqr(t),i=p.mul(p.mul(t,e),Th),o=p.mul(p.mul(e,n),Th),s=p.sqr(n);return{c0:p.add(p.mulByNonresidue(o),r),c1:p.add(p.mulByNonresidue(s),i),c2:p.sub(p.sub(p.add(p.add(i,p.sqr(p.add(p.sub(t,e),n))),o),r),s)}},[w,v]=Nh(p,h,n.ORDER,6,2,3),E={ORDER:p.ORDER,isLE:p.isLE,BITS:3*p.BITS,BYTES:3*p.BYTES,MASK:bd(3*p.BITS),ZERO:{c0:p.ZERO,c1:p.ZERO,c2:p.ZERO},ONE:{c0:p.ONE,c1:p.ZERO,c2:p.ZERO},create:t=>t,isValid:({c0:t,c1:e,c2:n})=>p.isValid(t)&&p.isValid(e)&&p.isValid(n),is0:({c0:t,c1:e,c2:n})=>p.is0(t)&&p.is0(e)&&p.is0(n),isValidNot0:t=>!E.is0(t)&&E.isValid(t),neg:({c0:t,c1:e,c2:n})=>({c0:p.neg(t),c1:p.neg(e),c2:p.neg(n)}),eql:({c0:t,c1:e,c2:n},{c0:r,c1:i,c2:o})=>p.eql(t,r)&&p.eql(e,i)&&p.eql(n,o),sqrt:wd,div:(t,e)=>E.mul(t,"bigint"==typeof e?n.inv(n.create(e)):E.inv(e)),pow:(t,e)=>Pd(E,t,e),invertBatch:t=>Ud(E,t),add:g,sub:m,mul:b,sqr:y,addN:g,subN:m,mulN:b,sqrN:y,inv:({c0:t,c1:e,c2:n})=>{let r=p.sub(p.sqr(t),p.mulByNonresidue(p.mul(n,e))),i=p.sub(p.mulByNonresidue(p.sqr(n)),p.mul(t,e)),o=p.sub(p.sqr(e),p.mul(t,n)),s=p.inv(p.add(p.mulByNonresidue(p.add(p.mul(n,i),p.mul(e,o))),p.mul(t,r)));return{c0:p.mul(s,r),c1:p.mul(s,i),c2:p.mul(s,o)}},fromBytes:t=>{if(t.length!==E.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:p.fromBytes(t.subarray(0,p.BYTES)),c1:p.fromBytes(t.subarray(p.BYTES,2*p.BYTES)),c2:p.fromBytes(t.subarray(2*p.BYTES))}},toBytes:({c0:t,c1:e,c2:n})=>Vf(p.toBytes(t),p.toBytes(e),p.toBytes(n)),cmov:({c0:t,c1:e,c2:n},{c0:r,c1:i,c2:o},s)=>({c0:p.cmov(t,r,s),c1:p.cmov(e,i,s),c2:p.cmov(n,o,s)}),fromBigSix:t=>{if(!Array.isArray(t)||6!==t.length)throw new Error("invalid Fp6 usage");return{c0:p.fromBigTuple(t.slice(0,2)),c1:p.fromBigTuple(t.slice(2,4)),c2:p.fromBigTuple(t.slice(4,6))}},frobeniusMap:({c0:t,c1:e,c2:n},r)=>({c0:p.frobeniusMap(t,r),c1:p.mul(p.frobeniusMap(e,r),w[r%6]),c2:p.mul(p.frobeniusMap(n,r),v[r%6])}),mulByFp2:({c0:t,c1:e,c2:n},r)=>({c0:p.mul(t,r),c1:p.mul(e,r),c2:p.mul(n,r)}),mulByNonresidue:({c0:t,c1:e,c2:n})=>({c0:p.mulByNonresidue(n),c1:t,c2:e}),mul1:({c0:t,c1:e,c2:n},r)=>({c0:p.mulByNonresidue(p.mul(n,r)),c1:p.mul(t,r),c2:p.mul(e,r)}),mul01({c0:t,c1:e,c2:n},r,i){let o=p.mul(t,r),s=p.mul(e,i);return{c0:p.add(p.mulByNonresidue(p.sub(p.mul(p.add(e,n),i),s)),o),c1:p.sub(p.sub(p.mul(p.add(r,i),p.add(t,e)),o),s),c2:p.add(p.sub(p.mul(p.add(t,n),r),o),s)}}},x=Nh(p,h,n.ORDER,12,1,6)[0],_=({c0:t,c1:e},{c0:n,c1:r})=>({c0:E.add(t,n),c1:E.add(e,r)}),A=({c0:t,c1:e},{c0:n,c1:r})=>({c0:E.sub(t,n),c1:E.sub(e,r)}),T=({c0:t,c1:e},n)=>{if("bigint"==typeof n)return{c0:E.mul(t,n),c1:E.mul(e,n)};let{c0:r,c1:i}=n,o=E.mul(t,r),s=E.mul(e,i);return{c0:E.add(o,E.mulByNonresidue(s)),c1:E.sub(E.mul(E.add(t,e),E.add(r,i)),E.add(o,s))}},S=({c0:t,c1:e})=>{let n=E.mul(t,e);return{c0:E.sub(E.sub(E.mul(E.add(E.mulByNonresidue(e),t),E.add(t,e)),n),E.mulByNonresidue(n)),c1:E.add(n,n)}},N={ORDER:p.ORDER,isLE:E.isLE,BITS:2*E.BITS,BYTES:2*E.BYTES,MASK:bd(2*E.BITS),ZERO:{c0:E.ZERO,c1:E.ZERO},ONE:{c0:E.ONE,c1:E.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>E.isValid(t)&&E.isValid(e),is0:({c0:t,c1:e})=>E.is0(t)&&E.is0(e),isValidNot0:t=>!N.is0(t)&&N.isValid(t),neg:({c0:t,c1:e})=>({c0:E.neg(t),c1:E.neg(e)}),eql:({c0:t,c1:e},{c0:n,c1:r})=>E.eql(t,n)&&E.eql(e,r),sqrt:wd,inv:({c0:t,c1:e})=>{let n=E.inv(E.sub(E.sqr(t),E.mulByNonresidue(E.sqr(e))));return{c0:E.mul(t,n),c1:E.neg(E.mul(e,n))}},div:(t,e)=>N.mul(t,"bigint"==typeof e?n.inv(n.create(e)):N.inv(e)),pow:(t,e)=>Pd(N,t,e),invertBatch:t=>Ud(N,t),add:_,sub:A,mul:T,sqr:S,addN:_,subN:A,mulN:T,sqrN:S,fromBytes:t=>{if(t.length!==N.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:E.fromBytes(t.subarray(0,E.BYTES)),c1:E.fromBytes(t.subarray(E.BYTES))}},toBytes:({c0:t,c1:e})=>Vf(E.toBytes(t),E.toBytes(e)),cmov:({c0:t,c1:e},{c0:n,c1:r},i)=>({c0:E.cmov(t,n,i),c1:E.cmov(e,r,i)}),fromBigTwelve:t=>({c0:E.fromBigSix(t.slice(0,6)),c1:E.fromBigSix(t.slice(6,12))}),frobeniusMap(t,e){const{c0:n,c1:r,c2:i}=E.frobeniusMap(t.c1,e),o=x[e%12];return{c0:E.frobeniusMap(t.c0,e),c1:E.create({c0:p.mul(n,o),c1:p.mul(r,o),c2:p.mul(i,o)})}},mulByFp2:({c0:t,c1:e},n)=>({c0:E.mulByFp2(t,n),c1:E.mulByFp2(e,n)}),conjugate:({c0:t,c1:e})=>({c0:t,c1:E.neg(e)}),mul014:({c0:t,c1:e},n,r,i)=>{let o=E.mul01(t,n,r),s=E.mul1(e,i);return{c0:E.add(E.mulByNonresidue(s),o),c1:E.sub(E.sub(E.mul01(E.add(e,t),n,p.add(r,i)),o),s)}},mul034:({c0:t,c1:e},n,r,i)=>{const o=E.create({c0:p.mul(t.c0,n),c1:p.mul(t.c1,n),c2:p.mul(t.c2,n)}),s=E.mul01(e,r,i),a=E.mul01(E.add(t,e),p.add(n,r),i);return{c0:E.add(E.mulByNonresidue(s),o),c1:E.sub(a,E.add(o,s))}},_cyclotomicSquare:t.Fp12cyclotomicSquare,_cyclotomicExp:t.Fp12cyclotomicExp,finalExponentiate:t.Fp12finalExponentiate};return{Fp:n,Fp2:p,Fp6:E,Fp12:N,Fp4Square:function(t,e){const n=p.sqr(t),r=p.sqr(e);return{first:p.add(p.mulByNonresidue(r),n),second:p.sub(p.sub(p.sqr(p.add(t,e)),n),r)}}}}({ORDER:Ph.p,FP2_NONRESIDUE:[Ih,Ih],Fp2mulByB:({c0:t,c1:e})=>{const n=Dh.mul(t,$h),r=Dh.mul(e,$h);return{c0:Dh.sub(n,r),c1:Dh.add(n,r)}},Fp12cyclotomicSquare:({c0:t,c1:e})=>{const{c0:n,c1:r,c2:i}=t,{c0:o,c1:s,c2:a}=e,{first:c,second:u}=Mh(n,s),{first:l,second:f}=Mh(o,i),{first:d,second:h}=Mh(r,a),p=Ch.mulByNonresidue(h);return{c0:Fh.create({c0:Ch.add(Ch.mul(Ch.sub(c,n),Oh),c),c1:Ch.add(Ch.mul(Ch.sub(l,r),Oh),l),c2:Ch.add(Ch.mul(Ch.sub(d,i),Oh),d)}),c1:Fh.create({c0:Ch.add(Ch.mul(Ch.add(p,o),Oh),p),c1:Ch.add(Ch.mul(Ch.add(u,s),Oh),u),c2:Ch.add(Ch.mul(Ch.add(f,a),Oh),f)})}},Fp12cyclotomicExp(t,e){let n=jh.ONE;for(let r=Lh-1;r>=0;r--)n=jh._cyclotomicSquare(n),md(e,r)&&(n=jh.mul(n,t));return n},Fp12finalExponentiate:t=>{const e=kh,n=jh.div(jh.frobeniusMap(t,6),t),r=jh.mul(jh.frobeniusMap(n,2),n),i=jh.conjugate(jh._cyclotomicExp(r,e)),o=jh.mul(jh.conjugate(jh._cyclotomicSquare(r)),i),s=jh.conjugate(jh._cyclotomicExp(o,e)),a=jh.conjugate(jh._cyclotomicExp(s,e)),c=jh.mul(jh.conjugate(jh._cyclotomicExp(a,e)),jh._cyclotomicSquare(i)),u=jh.conjugate(jh._cyclotomicExp(c,e)),l=jh.frobeniusMap(jh.mul(i,a),2),f=jh.frobeniusMap(jh.mul(s,r),3),d=jh.frobeniusMap(jh.mul(c,jh.conjugate(r)),1),h=jh.mul(jh.mul(u,jh.conjugate(o)),r);return jh.mul(jh.mul(jh.mul(l,f),d),h)}}),{G2psi:qh,G2psi2:Vh}=function(t,e,n){const r=e.pow(n,(t.ORDER-Ah)/Sh),i=e.pow(n,(t.ORDER-Ah)/Th);function o(t,n){return[e.mul(e.frobeniusMap(t,1),r),e.mul(e.frobeniusMap(n,1),i)]}const s=e.pow(n,(t.ORDER**Th-Ah)/Sh),a=e.pow(n,(t.ORDER**Th-Ah)/Th);if(!e.eql(a,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function c(t,n){return[e.mul(t,s),e.neg(n)]}const u=t=>(e,n)=>{const r=n.toAffine(),i=t(r.x,r.y);return e.fromAffine({x:i[0],y:i[1]})};return{psi:o,psi2:c,G2psi:u(o),G2psi2:u(c),PSI_X:r,PSI_Y:i,PSI2_X:s,PSI2_Y:a}}(Dh,Ch,Ch.div(Ch.ONE,Ch.NONRESIDUE)),zh=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:Dh.ORDER,m:2,k:128,expand:"xmd",hash:id}),Hh={p:Ch.ORDER,n:Ph.n,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),a:Ch.ZERO,b:Ch.fromBigTuple([$h,$h]),Gx:Ch.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:Ch.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")])},Gh=Wh(Dh.toBytes(Bh),{infinity:!0,compressed:!0});function Kh(t){const e=224&(t=t.slice())[0],n=!!(e>>7&1),r=!!(e>>6&1),i=!!(e>>5&1);return t[0]&=31,{compressed:n,infinity:r,sort:i,value:t}}function Wh(t,e){if(224&t[0])throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function Zh(t){t.assertValidity();const{BYTES:e,ORDER:n}=Dh,{x:r,y:i}=t.toAffine();if(t.is0())return Gh.slice();const o=!!(i*Oh/n);return Wh(fd(r,e),{compressed:!0,sort:o})}function Yh(t){const{infinity:e,sort:n,value:r}=Kh(hd("signatureHex",t,48)),i=Dh.ORDER,o=Qh.G1.Point,s=ud(r);if(e)return o.ZERO;const a=Dh.create(s&Dh.MASK),c=Dh.add(Dh.pow(a,Rh),Dh.create(Ph.b));let u=Dh.sqrt(c);if(!u)throw new Error("invalid G1 point: compressed");const l=BigInt(n);u*Oh/i!==l&&(u=Dh.neg(u));const f=o.fromAffine({x:a,y:u});return f.assertValidity(),f}function Xh(t){t.assertValidity();const{BYTES:e}=Dh;if(t.is0())return Vf(Gh,fd(Bh,e));const{x:n,y:r}=t.toAffine(),{re:i,im:o}=Ch.reim(n),{re:s,im:a}=Ch.reim(r),c=!!((a>Bh?a*Oh:s*Oh)/Dh.ORDER&Ih),u=i;return Vf(Wh(fd(o,e),{sort:c,compressed:!0}),fd(u,e))}function Jh(t){const{ORDER:e}=Dh,{infinity:n,sort:r,value:i}=Kh(hd("signatureHex",t)),o=Qh.G2.Point,s=i.length/2;if(48!==s&&96!==s)throw new Error("invalid compressed signature length, expected 96/192 bytes");const a=ud(i.slice(0,s)),c=ud(i.slice(s));if(n)return o.ZERO;const u=Dh.create(a&Dh.MASK),l=Dh.create(c),f=Ch.create({c0:l,c1:u}),d=Ch.add(Ch.pow(f,Rh),Hh.b);let h=Ch.sqrt(d);if(!h)throw new Error("Failed to find a square root");const{re:p,im:g}=Ch.reim(h),m=BigInt(r);(g>Bh&&g*Oh/e!==m||g===Bh&&p*Oh/e!==m)&&(h=Ch.neg(h));const b=o.fromAffine({x:f,y:h});return b.assertValidity(),b}const Qh=function(t){const{Fp:e,Fr:n,Fp2:r,Fp6:i,Fp12:o}=t.fields,s=t.params.xNegative,a=t.params.twistType,c=bh(t.G1),u=Object.assign(c,sh(c.Point,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),l=bh(t.G2),f=Object.assign(l,sh(l.Point,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults}));let d;if("multiplicative"===a)d=(t,e,n,i,s,a)=>o.mul014(i,t,r.mul(e,s),r.mul(n,a));else{if("divisive"!==a)throw new Error("bls: unknown twist type");d=(t,e,n,i,s,a)=>o.mul034(i,r.mul(n,a),r.mul(e,s),t)}const h=r.div(r.ONE,r.mul(r.ONE,Eh));function p(t,e,n,i){const o=r.sqr(n),s=r.sqr(i),a=r.mulByB(r.mul(s,xh)),c=r.mul(a,xh),u=r.sub(r.sub(r.sqr(r.add(n,i)),s),o),l=r.sub(a,o),f=r.mul(r.sqr(e),xh),d=r.neg(u);return t.push([l,f,d]),{Rx:e=r.mul(r.mul(r.mul(r.sub(o,c),e),n),h),Ry:n=r.sub(r.sqr(r.mul(r.add(o,c),h)),r.mul(r.sqr(a),xh)),Rz:i=r.mul(o,u)}}function g(t,e,n,i,o,s){const a=r.sub(n,r.mul(s,i)),c=r.sub(e,r.mul(o,i)),u=r.sub(r.mul(a,o),r.mul(c,s)),l=r.neg(a),f=c;t.push([u,l,f]);const d=r.sqr(c),h=r.mul(d,c),p=r.mul(d,e),g=r.add(r.sub(h,r.mul(p,Eh)),r.mul(r.sqr(a),i));return{Rx:e=r.mul(c,g),Ry:n=r.sub(r.mul(r.sub(p,g),a),r.mul(h,n)),Rz:i=r.mul(i,h)}}const m=function(t){const e=[];for(;t>vh;t>>=vh)(t&vh)===wh?e.unshift(0):(t&xh)===xh?(e.unshift(-1),t+=vh):e.unshift(1);return e}(t.params.ateLoopSize),b=vd((e=>{const n=e,{x:i,y:o}=n.toAffine(),s=i,a=o,c=r.neg(o);let u=s,l=a,f=r.ONE;const d=[];for(const t of m){const e=[];({Rx:u,Ry:l,Rz:f}=p(e,u,l,f)),t&&({Rx:u,Ry:l,Rz:f}=g(e,u,l,f,s,-1===t?c:a)),d.push(e)}if(t.postPrecompute){const e=d[d.length-1];t.postPrecompute(u,l,f,s,a,g.bind(null,e))}return d}));function y(t,e=!1){let n=o.ONE;if(t.length){const e=t[0][0].length;for(let r=0;r<e;r++){n=o.sqr(n);for(const[e,i,o]of t)for(const[t,s,a]of e[r])n=d(t,s,a,n,i,o)}}return s&&(n=o.conjugate(n)),e?o.finalExponentiate(n):n}function w(t,e=!0){const n=[];zd(u.Point,"pz",t.map((({g1:t})=>t))),zd(f.Point,"pz",t.map((({g2:t})=>t)));for(const{g1:e,g2:r}of t){if(e.is0()||r.is0())throw new Error("pairing is not available for ZERO point");e.assertValidity(),r.assertValidity();const t=e.toAffine();n.push([b(r),t.x,t.y])}return y(n,e)}const v=t.randomBytes||Gf,E={randomPrivateKey:()=>{const t=Md(n.ORDER);return function(t,e,n=!1){const r=t.length,i=Fd(e),o=Md(e);if(r<16||r<o||r>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+r);const s=Bd(n?ld(t):ud(t),e-xd)+xd;return n?dd(s,i):fd(s,i)}(v(t),n.ORDER)},calcPairingPrecomputes:b};function x(t){if(!Array.isArray(t)||0===t.length)throw new Error("expected non-empty array")}function _(t){return t instanceof u.Point?t:u.Point.fromHex(t)}function A(e,n){function r(t){return t instanceof e.Point?t:e.Point.fromHex(t)}function i(t){return t instanceof n.Point?t:n.Point.fromHex(t)}function s(t){if(!(t instanceof n.Point))throw new Error(`expected valid message hashed to ${a?"G2":"G1"} curve`);return t}const a=n.Point.Fp.BYTES>e.Point.Fp.BYTES;return{getPublicKey:t=>e.Point.fromPrivateKey(t),sign(t,n,r){if(null!=r)throw new Error("sign() expects 2 arguments");return s(t).assertValidity(),t.multiply(e.normPrivateKeyToScalar(n))},verify(t,n,c,u){if(null!=u)throw new Error("verify() expects 3 arguments");t=i(t);const l=(c=r(c)).negate(),f=e.Point.BASE,d=s(n),h=w(a?[{g1:l,g2:d},{g1:f,g2:t}]:[{g1:d,g2:l},{g1:t,g2:f}]);return o.eql(h,o.ONE)},aggregatePublicKeys(t){x(t);const n=(t=t.map((t=>r(t)))).reduce(((t,e)=>t.add(e)),e.Point.ZERO);return n.assertValidity(),n},aggregateSignatures(t){x(t);const e=(t=t.map((t=>i(t)))).reduce(((t,e)=>t.add(e)),n.Point.ZERO);return e.assertValidity(),e},hash(t,e){Sf(t);const r=e?{DST:e}:void 0;return n.hashToCurve(t,r)},Signature:a?t.G2.Signature:t.G1.ShortSignature}}const T=A(u,f),S=A(f,u),{ShortSignature:N}=t.G1,{Signature:B}=t.G2;function I(t,e){return t instanceof u.Point?t:S.hash(hd("point",t),e?.DST)}function O(t,e){return t instanceof f.Point?t:T.hash(hd("point",t),e?.DST)}return u.Point.BASE.precompute(4),{longSignatures:T,shortSignatures:S,millerLoopBatch:y,pairing:function(t,e,n=!0){return w([{g1:t,g2:e}],n)},pairingBatch:w,verifyBatch:function(t,e,n,r){if(x(e),n.length!==e.length)throw new Error("amount of public keys and messages should be equal");const i=function(t){return t instanceof f.Point?t:B.fromHex(t)}(t),s=e.map((t=>O(t,r))),a=n.map(_),c=new Map;for(let t=0;t<a.length;t++){const e=a[t],n=s[t];let r=c.get(n);void 0===r&&(r=[],c.set(n,r)),r.push(e)}const l=[];try{for(const[t,e]of c){const n=e.reduce(((t,e)=>t.add(e)));l.push({g1:n,g2:t})}return l.push({g1:u.Point.BASE.negate(),g2:i}),o.eql(w(l),o.ONE)}catch{return!1}},curves:{G1:c.Point,G2:l.Point},fields:{Fr:n,Fp:e,Fp2:r,Fp6:i,Fp12:o},params:{ateLoopSize:t.params.ateLoopSize,twistType:t.params.twistType,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:E,getPublicKey:function(t){return T.getPublicKey(t).toBytes(!0)},getPublicKeyForShortSignatures:function(t){return S.getPublicKey(t).toBytes(!0)},sign:function(t,e,n){const r=O(t,n),i=T.sign(r,e);return t instanceof f.Point?i:B.toBytes(i)},signShortSignature:function(t,e,n){const r=I(t,n),i=S.sign(r,e);return t instanceof u.Point?i:N.toBytes(i)},verify:function(t,e,n,r){const i=O(e,r);return T.verify(t,i,n)},verifyShortSignature:function(t,e,n,r){const i=I(e,r);return S.verify(t,i,n)},aggregatePublicKeys:function(t){const e=T.aggregatePublicKeys(t);return t[0]instanceof u.Point?e:e.toBytes(!0)},aggregateSignatures:function(t){const e=T.aggregateSignatures(t);return t[0]instanceof f.Point?e:B.toBytes(e)},aggregateShortSignatures:function(t){const e=S.aggregateSignatures(t);return t[0]instanceof u.Point?e:N.toBytes(e)},G1:u,G2:f,Signature:B,ShortSignature:N}}({fields:{Fp:Dh,Fp2:Ch,Fp6:Fh,Fp12:jh,Fr:Uh},G1:{...Ph,Fp:Dh,htfDefaults:{...zh,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const n=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),r=new t(Dh.mul(e.px,n),e.py,e.pz);return e.multiplyUnsafe(kh).negate().multiplyUnsafe(kh).equals(r)},clearCofactor:(t,e)=>e.multiplyUnsafe(kh).add(e),mapToCurve:function(t){const{x:e,y:n}=np(Dh.create(t[0]));return ep(e,n)},fromBytes:function(t){const{compressed:e,infinity:n,sort:r,value:i}=Kh(t),{BYTES:o,ORDER:s}=Dh;if(48===i.length&&e){const t=ud(i),e=Dh.create(t&Dh.MASK);if(n){if(e!==Bh)throw new Error("invalid G1 point: non-empty, at infinity, with compression");return{x:Bh,y:Bh}}const o=Dh.add(Dh.pow(e,Rh),Dh.create(Ph.b));let a=Dh.sqrt(o);if(!a)throw new Error("invalid G1 point: compressed point");return a*Oh/s!==BigInt(r)&&(a=Dh.neg(a)),{x:Dh.create(e),y:Dh.create(a)}}if(96!==i.length||e)throw new Error("invalid G1 point: expected 48/96 bytes");{const t=ud(i.subarray(0,o)),e=ud(i.subarray(o));if(n){if(t!==Bh||e!==Bh)throw new Error("G1: non-empty point at infinity");return Qh.G1.Point.ZERO.toAffine()}return{x:Dh.create(t),y:Dh.create(e)}}},toBytes:function(t,e,n){const{BYTES:r,ORDER:i}=Dh,o=e.is0(),{x:s,y:a}=e.toAffine();if(n){if(o)return Gh.slice();const t=!!(a*Oh/i);return Wh(fd(s,r),{compressed:!0,sort:t})}return o?Vf(Uint8Array.of(64),new Uint8Array(2*r-1)):Vf(fd(s,r),fd(a,r))},ShortSignature:{fromBytes:t=>(Sf(t),Yh(t)),fromHex:t=>Yh(t),toBytes:t=>Zh(t),toRawBytes:t=>Zh(t),toHex:t=>Df(Zh(t))}},G2:{...Hh,Fp:Ch,hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...zh},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:function(t){const{x:e,y:n}=rp(Ch.fromBigTuple(t));return tp(e,n)},isTorsionFree:(t,e)=>e.multiplyUnsafe(kh).negate().equals(qh(t,e)),clearCofactor:(t,e)=>{const n=kh;let r=e.multiplyUnsafe(n).negate(),i=qh(t,e),o=e.double();return o=Vh(t,o),o=o.subtract(i),i=r.add(i),i=i.multiplyUnsafe(n).negate(),o=o.add(i),o=o.subtract(r),o.subtract(e)},fromBytes:function(t){const{BYTES:e,ORDER:n}=Dh,{compressed:r,infinity:i,sort:o,value:s}=Kh(t);if(!r&&!i&&o||!r&&i&&o||o&&i&&r)throw new Error("invalid encoding flag: "+(224&t[0]));const a=(t,e,n)=>ud(t.slice(e,n));if(96===s.length&&r){if(i){if(s.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid G2 point: compressed");return{x:Ch.ZERO,y:Ch.ZERO}}const t=a(s,0,e),r=a(s,e,2*e),c=Ch.create({c0:Dh.create(r),c1:Dh.create(t)}),u=Ch.add(Ch.pow(c,Rh),Hh.b);let l=Ch.sqrt(u);const f=l.c1===Bh?l.c0*Oh/n:l.c1*Oh/n?Ih:Bh;return l=o&&f>0?l:Ch.neg(l),{x:c,y:l}}if(192!==s.length||r)throw new Error("invalid G2 point: expected 96/192 bytes");{if(i){if(s.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid G2 point: uncompressed");return{x:Ch.ZERO,y:Ch.ZERO}}const t=a(s,0*e,1*e),n=a(s,1*e,2*e),r=a(s,2*e,3*e),o=a(s,3*e,4*e);return{x:Ch.fromBigTuple([n,t]),y:Ch.fromBigTuple([o,r])}}},toBytes:function(t,e,n){const{BYTES:r,ORDER:i}=Dh,o=e.is0(),{x:s,y:a}=e.toAffine();if(n){if(o)return Vf(Gh,fd(Bh,r));const t=!!(a.c1===Bh?a.c0*Oh/i:a.c1*Oh/i);return Vf(Wh(fd(s.c1,r),{compressed:!0,sort:t}),fd(s.c0,r))}{if(o)return Vf(Uint8Array.of(64),new Uint8Array(4*r-1));const{re:t,im:e}=Ch.reim(s),{re:n,im:i}=Ch.reim(a);return Vf(fd(e,r),fd(t,r),fd(i,r),fd(n,r))}},Signature:{fromBytes:t=>(Sf(t),Jh(t)),fromHex:t=>Jh(t),toBytes:t=>Xh(t),toRawBytes:t=>Xh(t),toHex:t=>Df(Xh(t))}},params:{ateLoopSize:kh,r:Ph.n,xNegative:!0,twistType:"multiplicative"},htfDefaults:zh,hash:id}),tp=oh(Ch,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map((t=>t.map((t=>Ch.fromBigTuple(t.map(BigInt))))))),ep=oh(Dh,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map((t=>t.map((t=>BigInt(t)))))),np=yh(Dh,{A:Dh.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:Dh.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:Dh.create(BigInt(11))}),rp=yh(Ch,{A:Ch.create({c0:Dh.create(Bh),c1:Dh.create(BigInt(240))}),B:Ch.create({c0:Dh.create(BigInt(1012)),c1:Dh.create(BigInt(1012))}),Z:Ch.create({c0:Dh.create(BigInt(-2)),c1:Dh.create(BigInt(-1))})});const ip=BigInt(0),op=BigInt(1),sp=BigInt(2),ap=BigInt(7),cp=BigInt(256),up=BigInt(113),lp=[],fp=[],dp=[];for(let t=0,e=op,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],lp.push(2*(5*r+n)),fp.push((t+1)*(t+2)/2%64);let i=ip;for(let t=0;t<7;t++)e=(e<<op^(e>>ap)*up)%cp,e&sp&&(i^=op<<(op<<BigInt(t))-op);dp.push(i)}const hp=td(dp,!0),pp=hp[0],gp=hp[1],mp=(t,e,n)=>n>32?((t,e,n)=>e<<n-32|t>>>64-n)(t,e,n):((t,e,n)=>t<<n|e>>>32-n)(t,e,n),bp=(t,e,n)=>n>32?((t,e,n)=>t<<n-32|e>>>64-n)(t,e,n):((t,e,n)=>e<<n|t>>>32-n)(t,e,n);class yp extends zf{constructor(t,e,n,r=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=e,this.outputLen=n,this.enableXOF=r,this.rounds=i,Tf(n),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");var o;this.state=new Uint8Array(200),this.state32=(o=this.state,new Uint32Array(o.buffer,o.byteOffset,Math.floor(o.byteLength/4)))}clone(){return this._cloneInto()}keccak(){Lf(this.state32),function(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let e=0;e<10;e++)n[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){const r=(e+8)%10,i=(e+2)%10,o=n[i],s=n[i+1],a=mp(o,s,1)^n[r],c=bp(o,s,1)^n[r+1];for(let n=0;n<50;n+=10)t[e+n]^=a,t[e+n+1]^=c}let e=t[2],i=t[3];for(let n=0;n<24;n++){const r=fp[n],o=mp(e,i,r),s=bp(e,i,r),a=lp[n];e=t[a],i=t[a+1],t[a]=o,t[a+1]=s}for(let e=0;e<50;e+=10){for(let r=0;r<10;r++)n[r]=t[e+r];for(let r=0;r<10;r++)t[e+r]^=~n[(r+2)%10]&n[(r+4)%10]}t[0]^=pp[r],t[1]^=gp[r]}Of(n)}(this.state32,this.rounds),Lf(this.state32),this.posOut=0,this.pos=0}update(t){Bf(this),Sf(t=qf(t));const{blockLen:e,state:n}=this,r=t.length;for(let i=0;i<r;){const o=Math.min(e-this.pos,r-i);for(let e=0;e<o;e++)n[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:n,blockLen:r}=this;t[n]^=e,0!=(128&e)&&n===r-1&&this.keccak(),t[r-1]^=128,this.keccak()}writeInto(t){Bf(this,!1),Sf(t),this.finish();const e=this.state,{blockLen:n}=this;for(let r=0,i=t.length;r<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-r);t.set(e.subarray(this.posOut,this.posOut+o),r),this.posOut+=o,r+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Tf(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(If(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Of(this.state)}_cloneInto(t){const{blockLen:e,suffix:n,outputLen:r,rounds:i,enableXOF:o}=this;return t||(t=new yp(e,n,r,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=n,t.outputLen=r,t.enableXOF=o,t.destroyed=this.destroyed,t}}var wp,vp,Ep;wp=31,vp=136,Ep=32,function(t){const e=(e,n)=>t(n).update(qf(e)).digest(),n=t({});e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=e=>t(e)}(((t={})=>new yp(vp,wp,void 0===t.dkLen?Ep:t.dkLen,!0)));const xp=Uint8Array.from([0]),_p=Uint8Array.of();const Ap=(t,e,n,r,i)=>function(t,e,n,r=32){Nf(t),Tf(r);const i=t.outputLen;if(r>255*i)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/i);void 0===n&&(n=_p);const s=new Uint8Array(o*i),a=ch.create(t,e),c=a._cloneInto(),u=new Uint8Array(a.outputLen);for(let t=0;t<o;t++)xp[0]=t+1,c.update(0===t?_p:u).update(n).update(xp).digestInto(u),s.set(u,i*t),a._cloneInto(c);return a.destroy(),c.destroy(),Of(u,xp),s.slice(0,r)}(t,function(t,e,n){return Nf(t),void 0===n&&(n=new Uint8Array(t.outputLen)),ch(t,qf(n),qf(e))}(t,e,n),r,i),Tp=id,Sp=48;class Np{#t;#e;static random(){return new Np(Qh.utils.randomPrivateKey())}static deserialize(t){if(32!==t.length)throw new Error("Invalid size for transport secret key");return new Np(t)}publicKeyBytes(){return this.#e.toRawBytes(!0)}serialize(){return this.#t}constructor(t){this.#t=t;const e=Qh.G1.ProjectivePoint.fromPrivateKey(this.#t);this.#e=e}}function Bp(t){let e=t.length;const n=new Uint8Array(8+e);for(let t=7;t>=0;t--)n[t]=255&e,e>>>=8;return n.set(t,8),n}class Ip{#t;static deserialize(t){return new Ip(Qh.G2.ProjectivePoint.fromHex(t))}deriveKey(t){if(0===t.length)return this;{const e="ic-vetkd-bls12-381-g2-context",n=this.publicKeyBytes(),r=function(t,e){const n={p:Qh.params.r,m:1,DST:e},r=Object.assign({},Qh.G2.CURVE.htfDefaults,n);return ih(t,1,r)[0][0]}(new Uint8Array([...Bp(n),...Bp(t)]),e),i=Qh.G2.ProjectivePoint.BASE.multiply(r);return new Ip(this.getPoint().add(i))}}publicKeyBytes(){return this.#t.toRawBytes(!0)}getPoint(){return this.#t}constructor(t){this.#t=t}}function Op(t){return"string"==typeof t?(new TextEncoder).encode(t):t}function Rp(t,e,n){const r=Qh.G2.ProjectivePoint.BASE.negate(),i=Qh.fields.Fp12.ONE,o=n instanceof Qh.G1.ProjectivePoint?n:Qh.G1.ProjectivePoint.fromHex(n),s=function(t,e){const n=t.publicKeyBytes(),r=new Uint8Array([...n,...e]);return Qh.G1.ProjectivePoint.fromAffine(Qh.G1.hashToCurve(r,{DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_AUG_"}).toAffine())}(t,e),a=Qh.pairingBatch([{g1:o,g2:r},{g1:s,g2:t.getPoint()}]);return Qh.fields.Fp12.eql(a,i)}class $p{#t;#e;signatureBytes(){return this.#e}serialize(){return this.#e}deriveSymmetricKey(t,e){return function(t,e,n){const r=new Uint8Array;return Ap(Tp,t,r,e,n)}(this.#e,t,e)}async asDerivedKeyMaterial(){return kp.setup(this.#e)}static deserialize(t){return new $p(Qh.G1.ProjectivePoint.fromHex(t))}getPoint(){return this.#t}constructor(t){this.#t=t,this.#e=t.toRawBytes(!0)}}class kp{#t;constructor(t){this.#t=t}static fromCryptoKey(t){return new kp(t)}static async setup(t){const e=await globalThis.crypto.subtle.importKey("raw",t,"HKDF",!1,["deriveKey"]);return new kp(e)}getCryptoKey(){return this.#t}async deriveAesGcmCryptoKey(t){const e={name:"HKDF",hash:"SHA-256",length:256,info:Op(t),salt:new Uint8Array};return globalThis.crypto.subtle.deriveKey(e,this.#t,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async encryptMessage(t,e){const n=await this.deriveAesGcmCryptoKey(e),r=globalThis.crypto.getRandomValues(new Uint8Array(12)),i=new Uint8Array(await globalThis.crypto.subtle.encrypt({name:"AES-GCM",iv:r},n,Op(t)));return new Uint8Array([...r,...i])}async decryptMessage(t,e){if(t.length<28)throw new Error("Invalid ciphertext, too short to possibly be valid");const n=t.slice(0,12),r=t.slice(12),i=await this.deriveAesGcmCryptoKey(e);try{const t=await globalThis.crypto.subtle.decrypt({name:"AES-GCM",iv:n},i,r);return new Uint8Array(t)}catch{throw new Error("Decryption failed")}}}class Lp{#t;#e;#n;static deserialize(t){if(192!==t.length)throw new Error("Invalid EncryptedVetKey serialization");const e=Qh.G1.ProjectivePoint.fromHex(t.subarray(0,Sp)),n=Qh.G2.ProjectivePoint.fromHex(t.subarray(Sp,144)),r=Qh.G1.ProjectivePoint.fromHex(t.subarray(144));return new Lp(e,n,r)}decryptAndVerify(t,e,n){const r=Qh.G1.ProjectivePoint.BASE,i=Qh.G2.ProjectivePoint.BASE.negate(),o=Qh.fields.Fp12.ONE,s=Qh.pairingBatch([{g1:this.#t,g2:i},{g1:r,g2:this.#e}]);if(!Qh.fields.Fp12.eql(s,o))throw new Error("Invalid VetKey");const a=this.#n.subtract(this.#t.multiply(Qh.G1.normPrivateKeyToScalar(t.serialize())));if(Rp(e,n,a))return new $p(a);throw new Error("Invalid VetKey")}constructor(t,e,n){this.#t=t,this.#e=e,this.#n=n}}class Pp{constructor(t){this.actor=t}async encryptWithNoteKey(t,e,n){await this.fetch_note_key_if_needed(t,e);const r=await xf([t.toString(),e]),i=Uint8Array.from([...n].map((t=>t.charCodeAt(0)))).buffer,o=window.crypto.getRandomValues(new Uint8Array(12)),s=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},r,i);return String.fromCharCode(...new Uint8Array(o))+String.fromCharCode(...new Uint8Array(s))}async decryptWithNoteKey(t,e,n){await this.fetch_note_key_if_needed(t,e);const r=await xf([t.toString(),e]);if(n.length<13)throw new Error("wrong encoding, too short to contain iv");const i=n.slice(0,12),o=n.slice(12),s=Uint8Array.from([...i].map((t=>t.charCodeAt(0)))).buffer,a=Uint8Array.from([...o].map((t=>t.charCodeAt(0)))).buffer;let c=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:s},r,a);return String.fromCharCode(...new Uint8Array(c))}async fetch_note_key_if_needed(t,e){if(!await xf([t.toString(),e])){const n=Np.random(),r=await this.actor.encrypted_symmetric_key_for_note(t,n.publicKeyBytes()),i=Lp.deserialize(Up(r)),o=await this.actor.symmetric_key_verification_key_for_note(),s=Ip.deserialize(Up(o)),a=function(t){var e=BigInt(t).toString(16);for(;e.length<32;)e="0"+e;var n=e.length/2,r=new Uint8Array(n),i=0,o=0;for(;i<n;)r[i]=parseInt(e.slice(o,o+2),16),i+=1,o+=2;return r}(t),c=(new TextEncoder).encode(e);let u=new Uint8Array(a.length+c.length);u.set(a),u.set(c,a.length);const l=i.decryptAndVerify(n,s,u),f=await(await l.asDerivedKeyMaterial()).deriveAesGcmCryptoKey("note-key");await function(t,e,n=Ef()){return n("readwrite",(n=>(n.put(e,t),wf(n.transaction))))}([t.toString(),e],f)}}}const Up=t=>Uint8Array.from(t.match(/.{1,2}/g).map((t=>parseInt(t,16))));let Dp=0;const Cp=Pt([]);function Fp(t,e=2e3){const n=Dp++;Cp.update((e=>[...e,Object.assign(Object.assign({},t),{id:n})])),setTimeout((()=>{Cp.update((t=>t.filter((t=>t.id!=n))))}),e)}function Mp(t){Fp({type:"error",message:t})}function jp(t){Fp({type:"success",message:t})}const{set:qp,subscribe:Vp}=Pt({}),zp={subscribe:Vp,set:qp,remove:()=>{qp({})}},Hp=(t,e="")=>{const n=new URL(t);function r(){return o(e).reduce(((t,e,n)=>(":"===e[0]&&t.push({value:e.slice(1),index:n}),t)),[])}function i(){return o(n.pathname)}function o(t){return"/"===t||0===t.trim().length?[t]:("/"===t.slice(-1)&&(t=t.slice(0,-1)),"/"===t[0]&&(t=t.slice(1)),t.split("/"))}return Object.freeze({hash:n.hash,host:n.host,hostname:n.hostname,namedParams:function(){const t=i();return r().reduce(((e,n)=>(e[n.value]=t[n.index],e)),{})}(),namedParamsKeys:r().reduce(((t,e)=>(t.push(e.value),t)),[]),namedParamsValues:function(){const t=i();return r().reduce(((e,n)=>(e.push(t[n.index]),e)),[])}(),pathNames:i(),port:n.port,pathname:n.pathname,protocol:n.protocol,search:n.search,queryParams:function(){const t={};return n.searchParams.forEach(((e,n)=>{t[n]=e})),t}(),queryParamsKeys:function(){const t=[];return n.searchParams.forEach(((e,n)=>{t.push(n)})),t}(),queryParamsValues:function(){const t=[];return n.searchParams.forEach((e=>{t.push(e)})),t}()})},Gp=t=>{let e=!1;return 0===Object.keys(t).length||(t.childRoute&&0===Object.keys(t.childRoute).length?e=!0:t.childRoute&&(e=Gp(t.childRoute)),e)},Kp=(t,e)=>(e=Qp(e)).includes(":")?e.includes(t):e.startsWith(t),Wp=(t,e,n)=>{let r=!1;if(n)return{exists:e.lang&&e.lang[n]&&e.lang[n].includes(t),language:n};if(r=Kp(t,e.name),!r&&e.lang&&"object"==typeof e.lang)for(const[i,o]of Object.entries(e.lang))Kp(t,o)&&(r=!0,n=i);return{exists:r,language:n}},Zp=(t="")=>{if(0===t.trim().length)return[];return Yp(t).reduce(((t,e)=>(":"===e[0]&&t.push(e.slice(1)),t)),[])},Yp=t=>"/"===t||0===t.trim().length?[t]:(t=Qp(t,"both")).split("/"),Xp=(t="")=>{let e;return"/"===t||0===t.trim().length?t:(e=(t=Qp(t,"lead")).split(":")[0],e=Qp(e,"trail"),e.toLowerCase())},Jp=(t,e)=>{const n=e.split("/");return n.length>1&&n.forEach((function(e,n){e.length>0&&n>0&&t.shift()})),t},Qp=(t,e="lead")=>("trail"!==e&&"both"!==e||(t=t.replace(/\/$/,"")),"lead"!==e&&"both"!==e||(t=t.replace(/^\//,"")),t),tg=(t,e=null)=>e&&t.lang&&t.lang[e]?t.lang[e]:t.name,eg=(t,e,n,r,i=!1)=>{if("/"===t||0===t.trim().length)return{result:t,language:null};let o=t,s=n.name,a=r;if(i&&(a=""),s=Qp(s),o=Qp(o),n.childRoute)return{result:t,language:a};{let t=Wp(o,n,a);t.exists&&i&&(o=tg(n,r));let c=s.split(":")[0];return c=Qp(c,"trail"),c=c.split("/"),c.shift(),c.forEach((()=>{const s=e[0];if(t=Wp(`${o}/${s}`,n,a),!s||!t.exists)return{result:o,language:t.language};o=i?tg(n,r):`${o}/${s}`,e.shift()})),{result:o,language:t.language}}},ng=t=>{const e=t||!1;let n="";const r=(t,n)=>{if("undefined"!=typeof window){const r=(t=>{let e=[];if(t.queryParams)for(let[n,r]of Object.entries(t.queryParams))e.push(`${n}=${r}`);const n=t.hash?t.hash:"";return e.length>0?`${t.path}?${e.join("&")}${n}`:t.path+n})(t);n&&window.history.pushState({page:r},"",r),e&&i(r)}},i=t=>{"undefined"!=typeof ga&&(ga("set","page",t),ga("send","pageview"))};return Object.freeze({active:()=>n,isActive:(t,e=!1)=>{"/"!==t[0]&&(t="/"+t);let r=Hp(`http://fake.com${t}`).pathname,i=Hp(`http://fake.com${n}`).pathname;return r=Qp(r,"trail"),i=Qp(i,"trail"),e?i.includes(r):i===r},setActive:(t,e)=>{n=t.path,r(t,e)}})},rg=(t,e)=>{const n=(t=>{const e=t;return Object.freeze({valid:()=>e&&e.guard&&"function"==typeof e.guard,redirect:()=>!e.guard(),redirectPath:()=>{let t="/";return e.redirect&&e.redirect.length>0&&(t=e.redirect),t}})})(t.onlyIf);return Object.freeze({path:()=>{let r=e;return t.redirectTo&&t.redirectTo.length>0&&(r=t.redirectTo),n.valid()&&n.redirect()&&(r=n.redirectPath()),r}})};function ig({routes:t,currentUrl:e,routerOptions:n,convert:r}){const i=n.defaultLanguage,o=n.prefix?n.prefix.toLowerCase():"",s=function(t,e){if(e&&e.trim().length>0){const n=t.endsWith(e)?e:e+"/",r=t.replace(n,"");return Hp(r)}return Hp(t)}(e,o);let a="",c={},u=!1;function l(t,e,n,r,o){let f={};const d=function({basePath:t,basePathName:e,pathNames:n,convert:r,currentLanguage:i}){let o,s,a=i;function c(){return tg(s,a)}function u(){return Xp(c())}function l(){return Xp(o.result)}return Object.freeze({basePathSameAsLocalised:function(){return l()===u()},updatedPath:function(t){return s=t,o=eg(e,n,s,a,r),a=r?i:o.language,o},basePathNameWithoutNamedParams:l,localisedPathName:c,localisedRouteWithoutNamedParams:u,namedPath:function(){let e=c();return e&&!e.startsWith("/")&&(e="/"+e),t?`${t}${e}`:e},pathNames:n,routeLanguage:function(){return a},routePath:function(){let e=`${t}/${l()}`;"//"===e&&(e="/"),a&&(n=Jp(n,u()));const r=Zp(c());return r&&r.length>0&&r.forEach((function(){n.length>0&&(e+=`/${n.shift()}`)})),e}})}({basePath:e,basePathName:n.shift().toLowerCase(),pathNames:n,convert:o,currentLanguage:r});return u=!1,t.forEach((function(t){if(d.updatedPath(t),function(t,e){const n=t.basePathSameAsLocalised();n&&(u=!0);return n||!u&&(t=>Qp(t).startsWith(":"))(e)}(d,t.name)){let e=d.routePath();if(a=rg(t,a).path(),f.name!==e&&(f=function({route:t,routePath:e,routeLanguage:n,urlParser:r,namedPath:o}){const s=function({routeInfo:t,path:e,routeNamedParams:n,urlParser:r,namedPath:i,language:o}){const s=()=>{const t=Hp(`https://fake.com${r.pathname}`,i).namedParams;return{...n,...t}};return Object.freeze({get:()=>({name:e,component:t.component,hash:r.hash,layout:t.layout,queryParams:r.queryParams,namedParams:s(),path:e,language:o}),namedParams:s})}({routeInfo:t,urlParser:r,path:e,routeNamedParams:c,namedPath:o,language:n||i});return c=s.namedParams(),s.get()}({route:t,routePath:e,routeLanguage:d.routeLanguage(),urlParser:s,namedPath:d.namedPath()})),t.nestedRoutes&&t.nestedRoutes.length>0&&d.pathNames.length>0)f.childRoute=l(t.nestedRoutes,e,d.pathNames,d.routeLanguage(),o),f.path=f.childRoute.path,f.language=f.childRoute.language;else if(function(t,e){return t.nestedRoutes&&t.nestedRoutes.length>0&&0===e.length}(t,d.pathNames)){const n=l(t.nestedRoutes,e,["index"],d.routeLanguage(),o);n&&Object.keys(n).length>0&&(f.childRoute=n,f.language=f.childRoute.language)}}})),a&&(f.redirectTo=a),f}const f=e=>{const n=t.find((t=>"404"==t.name)),r=e||i||"";return n?{...n,language:r,path:"404"}:{name:"404",component:"",path:"404",redirectTo:"/404.html"}};return Object.freeze({findActiveRoute:function(){let e=l(t,"",s.pathNames,n.lang,r);return e&&Object.keys(e).length&&!Gp(e)?(e.path=e.path.split("?")[0],o&&(e.path=`/${o}${e.path}`)):"undefined"!=typeof window&&(e=f(n.lang)),e}})}const og="/404.html";let sg,ag=[],cg={};const ug=(t,e,n={})=>{cg={...n},void 0!==e&&""!==e||(e=document.location.href),sg=ng(cg.gaPageviews),e=Qp(e,"trail"),ag=t;const r=()=>{let n=!1;return cg.langConvertTo&&(cg.lang=cg.langConvertTo,n=!0),ig({routes:t,currentUrl:e,routerOptions:cg,convert:n}).findActiveRoute()};return Object.freeze({setActiveRoute:(t=!0)=>{const e=r();return e.redirectTo?((t,e)=>("undefined"!=typeof window&&(t===og?sg.setActive({path:og},e):lg(t)),t))(e.redirectTo,t):(sg.setActive(e,t),zp.set(e),e)},findActiveRoute:r})},lg=(t,e=null,n=!0)=>(t=Qp(t,"lead"),e&&(cg.langConvertTo=e),ug(ag,"http://fake.com/"+t,cg).setActiveRoute(n));function fg(t){let e,n;return e=new mg({props:{currentRoute:t[0].childRoute,params:t[1]}}),{c(){Nt(e.$$.fragment)},m(t,r){Bt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.currentRoute=t[0].childRoute),2&n&&(r.params=t[1]),e.$set(r)},i(t){n||(wt(e.$$.fragment,t),n=!0)},o(t){vt(e.$$.fragment,t),n=!1},d(t){It(e,t)}}}function dg(t){let e,n,r;var i=t[0].component;function o(t){return{props:{currentRoute:{...t[0],component:""},params:t[1]}}}return i&&(e=z(i,o(t))),{c(){e&&Nt(e.$$.fragment),n=P()},m(t,i){e&&Bt(e,t,i),B(t,n,i),r=!0},p(t,r){const s={};if(1&r&&(s.currentRoute={...t[0],component:""}),2&r&&(s.params=t[1]),1&r&&i!==(i=t[0].component)){if(e){bt();const t=e;vt(t.$$.fragment,1,0,(()=>{It(t,1)})),yt()}i?(e=z(i,o(t)),Nt(e.$$.fragment),wt(e.$$.fragment,1),Bt(e,n.parentNode,n)):e=null}else i&&e.$set(s)},i(t){r||(e&&wt(e.$$.fragment,t),r=!0)},o(t){e&&vt(e.$$.fragment,t),r=!1},d(t){t&&I(n),e&&It(e,t)}}}function hg(t){let e,n,r;var i=t[0].layout;function o(t){return{props:{currentRoute:{...t[0],layout:""},params:t[1]}}}return i&&(e=z(i,o(t))),{c(){e&&Nt(e.$$.fragment),n=P()},m(t,i){e&&Bt(e,t,i),B(t,n,i),r=!0},p(t,r){const s={};if(1&r&&(s.currentRoute={...t[0],layout:""}),2&r&&(s.params=t[1]),1&r&&i!==(i=t[0].layout)){if(e){bt();const t=e;vt(t.$$.fragment,1,0,(()=>{It(t,1)})),yt()}i?(e=z(i,o(t)),Nt(e.$$.fragment),wt(e.$$.fragment,1),Bt(e,n.parentNode,n)):e=null}else i&&e.$set(s)},i(t){r||(e&&wt(e.$$.fragment,t),r=!0)},o(t){e&&vt(e.$$.fragment,t),r=!1},d(t){t&&I(n),e&&It(e,t)}}}function pg(t){let e,n,r,i;const o=[hg,dg,fg],s=[];function a(t,e){return t[0].layout?0:t[0].component?1:t[0].childRoute?2:-1}return~(e=a(t))&&(n=s[e]=o[e](t)),{c(){n&&n.c(),r=P()},m(t,n){~e&&s[e].m(t,n),B(t,r,n),i=!0},p(t,[i]){let c=e;e=a(t),e===c?~e&&s[e].p(t,i):(n&&(bt(),vt(s[c],1,1,(()=>{s[c]=null})),yt()),~e?(n=s[e],n?n.p(t,i):(n=s[e]=o[e](t),n.c()),wt(n,1),n.m(r.parentNode,r)):n=null)},i(t){i||(wt(n),i=!0)},o(t){vt(n),i=!1},d(t){~e&&s[e].d(t),t&&I(r)}}}function gg(t,e,n){let{currentRoute:r={}}=e,{params:i={}}=e;return t.$$set=t=>{"currentRoute"in t&&n(0,r=t.currentRoute),"params"in t&&n(1,i=t.params)},[r,i]}"undefined"!=typeof window&&(window.addEventListener("click",(t=>{if("a"!==t.target.localName.toLowerCase())return;if(t.metaKey||t.ctrlKey||t.shiftKey)return;const e=cg.prefix?`/${cg.prefix.toLowerCase()}`:"",n=t.target.pathname&&t.target.host===window.location.host,r=!(e.length>1)||t.target.pathname.startsWith(e);if(n&&r){t.preventDefault();const e=t.target.pathname+t.target.search+t.target.search+t.target.hash;"_blank"===t.target.target?window.open(e,"newTab"):lg(e)}})),window.onpopstate=function(t){let e=window.location.pathname+window.location.search+window.location.hash;lg(e,null,!1)});class mg extends $t{constructor(t){super(),Rt(this,t,gg,pg,a,{currentRoute:0,params:1})}}function bg(t){let e,n;return e=new mg({props:{currentRoute:t[0]}}),{c(){Nt(e.$$.fragment)},m(t,r){Bt(e,t,r),n=!0},p(t,[n]){const r={};1&n&&(r.currentRoute=t[0]),e.$set(r)},i(t){n||(wt(e.$$.fragment,t),n=!0)},o(t){vt(e.$$.fragment,t),n=!1},d(t){It(e,t)}}}function yg(t,e,n){let r;l(t,zp,(t=>n(0,r=t)));let{routes:i=[]}=e,{options:o={}}=e;return J((()=>{ug(i,document.location.href,o).setActiveRoute()})),t.$$set=t=>{"routes"in t&&n(1,i=t.routes),"options"in t&&n(2,o=t.options)},[r,i,o]}class wg extends $t{constructor(t){super(),Rt(this,t,yg,bg,a,{routes:1,options:2})}}const vg=Pt({state:"initializing-auth"});function Eg(){const t=u(vg);"anonymous"===t.state&&t.client.login({maxTimeToLive:BigInt(1800)*BigInt(1e9),identityProvider:"ic"===process.env.DFX_NETWORK?"https://identity.ic0.app/#authorize":"http://rdmx6-jaaaa-aaaaa-aaadq-cai.localhost:8000/#authorize",onSuccess:()=>_g(t.client)})}async function xg(){const t=u(vg);"initialized"===t.state&&(await t.client.logout(),vg.update((()=>({state:"anonymous",actor:al(),client:t.client}))),lg("/"))}async function _g(t){setTimeout((()=>{try{const t=JSON.parse(window.localStorage.getItem("ic-delegation")),e=Number.parseInt(t.delegations[0].delegation.expiration,16)/1e6;setTimeout((()=>{xg()}),e-Date.now())}catch(t){console.error("Could not handle delegation expiry.")}}));try{const e=al({agentOptions:{identity:t.getIdentity()}});vg.update((()=>({state:"initializing-crypto",actor:e,client:t})));const n=new Pp(e);vg.update((()=>({state:"initialized",actor:e,client:t,crypto:n})))}catch(t){vg.update((()=>({state:"error",error:t.message||"An error occurred"})))}}function Ag(e){let n,r;return{c(){n=R("strong"),n.textContent="Disclaimer:",r=k(" This sample dapp is intended exclusively for experimental\npurpose. You are advised not to use this dapp for storing your critical data such\nas keys or passwords.")},m(t,e){B(t,n,e),B(t,r,e)},p:t,i:t,o:t,d(t){t&&I(n),t&&I(r)}}}!async function(){const t=await bf.create();await t.isAuthenticated()?_g(t):vg.update((()=>({state:"anonymous",actor:al(),client:t})))}();class Tg extends $t{constructor(t){super(),Rt(this,t,null,Ag,a,{})}}function Sg(e){let n;return{c(){n=R("span"),D(n,"class","inline-block h-4 w-4 rounded-full mr-2 border-2 animate-spin border-b-current border-r-current border-t-transparent border-l-transparent")},m(t,e){B(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}class Ng extends $t{constructor(t){super(),Rt(this,t,null,Sg,a,{})}}function Bg(e){let n;return{c(){n=R("div"),n.textContent="An error occurred.",D(n,"class","text-lg font-semibold mt-8")},m(t,e){B(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}function Ig(e){let n,r,i;return{c(){n=R("button"),n.textContent="Login with Internet Identity to manage AI passports",D(n,"class","btn btn-primary")},m(t,o){B(t,n,o),r||(i=U(n,"click",e[1]),r=!0)},p:t,i:t,o:t,d(t){t&&I(n),r=!1,i()}}}function Og(e){let n,r,i,o;return r=new Ng({}),{c(){n=R("div"),Nt(r.$$.fragment),i=k("\n          Synchronizing... Please keep the app open on a device that's already added."),D(n,"class","text-lg font-semibold")},m(t,e){B(t,n,e),Bt(r,n,null),T(n,i),o=!0},p:t,i(t){o||(wt(r.$$.fragment,t),o=!0)},o(t){vt(r.$$.fragment,t),o=!1},d(t){t&&I(n),It(r)}}}function Rg(e){let n,r,i,o;return r=new Ng({}),{c(){n=R("div"),Nt(r.$$.fragment),i=k("\n          Initializing..."),D(n,"class","text-lg font-semibold mt-8")},m(t,e){B(t,n,e),Bt(r,n,null),T(n,i),o=!0},p:t,i(t){o||(wt(r.$$.fragment,t),o=!0)},o(t){vt(r.$$.fragment,t),o=!1},d(t){t&&I(n),It(r)}}}function $g(t){let e,n,r,i,o,s,a,c,u,l,f,d,h,p,g,m,b;const y=[Rg,Og,Ig,Bg],w=[];function v(t,e){return"initializing-auth"===t[0].state||"initializing-crypto"===t[0].state?0:"synchronizing"===t[0].state?1:"anonymous"===t[0].state?2:"error"===t[0].state?3:-1}return~(l=v(t))&&(f=w[l]=y[l](t)),p=new Tg({}),{c(){e=R("div"),n=R("div"),r=R("div"),i=R("h1"),i.textContent="AI Passport",o=L(),s=R("p"),s.textContent="Secure digital identities for AI agents on the Internet Computer.",a=L(),c=R("p"),c.textContent="Create and manage agent passports with encrypted memories, specifications, and secure API access for AI agents like Eliza.",u=L(),f&&f.c(),d=L(),h=R("div"),Nt(p.$$.fragment),g=L(),m=R("div"),m.innerHTML='<img src="/img/ic-badge-powered-by-crypto_label-stripe-white-text.png" alt="Powered by the Internet Computer" class="hidden dark:inline h-4"/> \n    <img src="/img/ic-badge-powered-by-crypto_label-stripe-dark-text.png" alt="Powered by the Internet Computer" class="dark:hidden inline h-4"/>',D(i,"class","mb-5 text-4xl sm:text-5xl font-bold text-primary dark:text-white"),D(s,"class","mb-5 text-xl font-semibold"),D(c,"class","mb-5"),D(h,"class","text-xs mt-8 sm:mt-12 opacity-75 mb-12 sm:mb-32"),D(r,"class","max-w-xl "),D(n,"class","text-center hero-content "),D(m,"class","fixed bottom-0 text-center left-0 right-0 pb-4 sm:pb-8"),D(e,"class","hero min-h-screen pt-8 sm:pt-0 content-start sm:content-center")},m(t,f){B(t,e,f),T(e,n),T(n,r),T(r,i),T(r,o),T(r,s),T(r,a),T(r,c),T(r,u),~l&&w[l].m(r,null),T(r,d),T(r,h),Bt(p,h,null),T(e,g),T(e,m),b=!0},p(t,[e]){let n=l;l=v(t),l===n?~l&&w[l].p(t,e):(f&&(bt(),vt(w[n],1,1,(()=>{w[n]=null})),yt()),~l?(f=w[l],f?f.p(t,e):(f=w[l]=y[l](t),f.c()),wt(f,1),f.m(r,d)):f=null)},i(t){b||(wt(f),wt(p.$$.fragment,t),b=!0)},o(t){vt(f),vt(p.$$.fragment,t),b=!1},d(t){t&&I(e),~l&&w[l].d(),It(p)}}}function kg(t,e,n){let{auth:r}=e;return t.$$set=t=>{"auth"in t&&n(0,r=t.auth)},[r,()=>Eg()]}class Lg extends $t{constructor(t){super(),Rt(this,t,kg,$g,a,{auth:0})}}async function Pg(t,e){const n={title:t.title,content:t.content,createdAt:t.createdAt,updatedAt:t.updatedAt,tags:t.tags},r=await e.encryptWithNoteKey(t.id,t.owner,JSON.stringify(n));return{id:t.id,encrypted_text:r,owner:t.owner,users:t.users}}function Ug(t){var e;const n=t.querySelector("h1");if(n)return n.innerText;const r=t.querySelectorAll("h1,h2,p,li");for(const t of r)if((null===(e=t.innerText)||void 0===e?void 0:e.trim().length)>0)return t.innerText.trim();return""}function Dg(t){const e=document.createElement("div");return e.innerHTML=t,Ug(e)}const Cg=Pt({state:"uninitialized"});let Fg;async function Mg(t,e){const n=t.filter((t=>""!=t.encrypted_text));return await Promise.all(n.map((t=>async function(t,e){const n=await e.decryptWithNoteKey(t.id,t.owner,t.encrypted_text),r=JSON.parse(n);return Object.assign({id:t.id,owner:t.owner,users:t.users},r)}(t,e))))}async function jg(t,e){const n=await t.get_notes();!function(t){Cg.set({state:"loaded",list:t})}(await Mg(n,e))}function qg(t){if(!t)return t;if("function"==typeof t.toJSON&&(t=t.toJSON()),Array.isArray(t))return t.map(qg);if("object"==typeof t){const e={};return Object.keys(t).forEach((n=>e[n]=qg(t[n]))),e}return t}vg.subscribe((async t=>{if("initialized"===t.state){null!==Fg&&(clearInterval(Fg),Fg=null),Cg.set({state:"loading"});try{await jg(t.actor,t.crypto).catch((t=>Mp(t))),Fg=setInterval((async()=>{await jg(t.actor,t.crypto).catch((t=>Mp(t)))}),3e3)}catch(t){Cg.set({state:"error"})}}else"anonymous"===t.state&&null!==Fg&&(clearInterval(Fg),Fg=null,Cg.set({state:"uninitialized"}))}));const Vg={};function zg(t,e,n=Vg){if(t===e)return!0;const r=typeof t,i=typeof t;if("number"===r&&"number"===i&&isNaN(t)&&isNaN(e))return!0;if(!t||!e||"object"!==r||"object"!==i||t.constructor!==e.constructor)return!1;if(t.valueOf()!==t)return zg(t.valueOf(),e.valueOf(),n);const o=n.shallow?Hg:zg;if("function"==typeof t[Symbol.iterator]){const r=t[Symbol.iterator](),i=e[Symbol.iterator]();let s=r.next(),a=i.next();for(;!s.done&&!a.done;){if(!o(s.value,a.value,n))return!1;s=r.next(),a=i.next()}return s.done===a.done}let s=Object.keys(t),a=Object.keys(e);if(n.excludeProps){const t=(c=n.excludeProps,t=>!c.has(t));s=s.filter(t),a=a.filter(t)}var c;return(n.partial||s.length===a.length)&&a.every((r=>t.hasOwnProperty(r)&&o(e[r],t[r],n)))}function Hg(t,e){return t===e}var Gg=-1,Kg=1,Wg=0;function Zg(t,e,n,r){if(t===e)return t?[[Wg,t]]:[];if(null!=n){var i=function(t,e,n){var r="number"==typeof n?{index:n,length:0}:n.oldRange,i="number"==typeof n?null:n.newRange,o=t.length,s=e.length;if(0===r.length&&(null===i||0===i.length)){var a=r.index,c=t.slice(0,a),u=t.slice(a),l=i?i.index:null,f=a+s-o;if((null===l||l===f)&&!(f<0||f>s)){var d=e.slice(0,f);if((g=e.slice(f))===u){var h=Math.min(a,f);if((b=c.slice(0,h))===(w=d.slice(0,h)))return im(b,c.slice(h),d.slice(h),u)}}if(null===l||l===a){var p=a,g=(d=e.slice(0,p),e.slice(p));if(d===c){var m=Math.min(o-p,s-p);if((y=u.slice(u.length-m))===(v=g.slice(g.length-m)))return im(c,u.slice(0,u.length-m),g.slice(0,g.length-m),y)}}}if(r.length>0&&i&&0===i.length){var b=t.slice(0,r.index),y=t.slice(r.index+r.length);if(!(s<(h=b.length)+(m=y.length))){var w=e.slice(0,h),v=e.slice(s-m);if(b===w&&y===v)return im(b,t.slice(h,o-m),e.slice(h,s-m),y)}}return null}(t,e,n);if(i)return i}var o=Xg(t,e),s=t.substring(0,o);o=Jg(t=t.substring(o),e=e.substring(o));var a=t.substring(t.length-o),c=function(t,e){var n;if(!t)return[[Kg,e]];if(!e)return[[Gg,t]];var r=t.length>e.length?t:e,i=t.length>e.length?e:t,o=r.indexOf(i);if(-1!==o)return n=[[Kg,r.substring(0,o)],[Wg,i],[Kg,r.substring(o+i.length)]],t.length>e.length&&(n[0][0]=n[2][0]=Gg),n;if(1===i.length)return[[Gg,t],[Kg,e]];var s=function(t,e){var n=t.length>e.length?t:e,r=t.length>e.length?e:t;if(n.length<4||2*r.length<n.length)return null;function i(t,e,n){for(var r,i,o,s,a=t.substring(n,n+Math.floor(t.length/4)),c=-1,u="";-1!==(c=e.indexOf(a,c+1));){var l=Xg(t.substring(n),e.substring(c)),f=Jg(t.substring(0,n),e.substring(0,c));u.length<f+l&&(u=e.substring(c-f,c)+e.substring(c,c+l),r=t.substring(0,n-f),i=t.substring(n+l),o=e.substring(0,c-f),s=e.substring(c+l))}return 2*u.length>=t.length?[r,i,o,s,u]:null}var o,s,a,c,u,l=i(n,r,Math.ceil(n.length/4)),f=i(n,r,Math.ceil(n.length/2));if(!l&&!f)return null;o=f?l&&l[4].length>f[4].length?l:f:l;t.length>e.length?(s=o[0],a=o[1],c=o[2],u=o[3]):(c=o[0],u=o[1],s=o[2],a=o[3]);var d=o[4];return[s,a,c,u,d]}(t,e);if(s){var a=s[0],c=s[1],u=s[2],l=s[3],f=s[4],d=Zg(a,u),h=Zg(c,l);return d.concat([[Wg,f]],h)}return function(t,e){for(var n=t.length,r=e.length,i=Math.ceil((n+r)/2),o=i,s=2*i,a=new Array(s),c=new Array(s),u=0;u<s;u++)a[u]=-1,c[u]=-1;a[o+1]=0,c[o+1]=0;for(var l=n-r,f=l%2!=0,d=0,h=0,p=0,g=0,m=0;m<i;m++){for(var b=-m+d;b<=m-h;b+=2){for(var y=o+b,w=(A=b===-m||b!==m&&a[y-1]<a[y+1]?a[y+1]:a[y-1]+1)-b;A<n&&w<r&&t.charAt(A)===e.charAt(w);)A++,w++;if(a[y]=A,A>n)h+=2;else if(w>r)d+=2;else if(f){if((x=o+l-b)>=0&&x<s&&-1!==c[x])if(A>=(E=n-c[x]))return Yg(t,e,A,w)}}for(var v=-m+p;v<=m-g;v+=2){for(var E,x=o+v,_=(E=v===-m||v!==m&&c[x-1]<c[x+1]?c[x+1]:c[x-1]+1)-v;E<n&&_<r&&t.charAt(n-E-1)===e.charAt(r-_-1);)E++,_++;if(c[x]=E,E>n)g+=2;else if(_>r)p+=2;else if(!f){if((y=o+l-v)>=0&&y<s&&-1!==a[y]){var A;w=o+(A=a[y])-y;if(A>=(E=n-E))return Yg(t,e,A,w)}}}}return[[Gg,t],[Kg,e]]}(t,e)}(t=t.substring(0,t.length-o),e=e.substring(0,e.length-o));return s&&c.unshift([Wg,s]),a&&c.push([Wg,a]),Qg(c,r),c}function Yg(t,e,n,r){var i=t.substring(0,n),o=e.substring(0,r),s=t.substring(n),a=e.substring(r),c=Zg(i,o),u=Zg(s,a);return c.concat(u)}function Xg(t,e){if(!t||!e||t.charAt(0)!==e.charAt(0))return 0;for(var n=0,r=Math.min(t.length,e.length),i=r,o=0;n<i;)t.substring(o,i)==e.substring(o,i)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return tm(t.charCodeAt(i-1))&&i--,i}function Jg(t,e){if(!t||!e||t.slice(-1)!==e.slice(-1))return 0;for(var n=0,r=Math.min(t.length,e.length),i=r,o=0;n<i;)t.substring(t.length-i,t.length-o)==e.substring(e.length-i,e.length-o)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return em(t.charCodeAt(t.length-i))&&i--,i}function Qg(t,e){t.push([Wg,""]);for(var n,r=0,i=0,o=0,s="",a="";r<t.length;)if(r<t.length-1&&!t[r][1])t.splice(r,1);else switch(t[r][0]){case Kg:o++,a+=t[r][1],r++;break;case Gg:i++,s+=t[r][1],r++;break;case Wg:var c=r-o-i-1;if(e){if(c>=0&&rm(t[c][1])){var u=t[c][1].slice(-1);if(t[c][1]=t[c][1].slice(0,-1),s=u+s,a=u+a,!t[c][1]){t.splice(c,1),r--;var l=c-1;t[l]&&t[l][0]===Kg&&(o++,a=t[l][1]+a,l--),t[l]&&t[l][0]===Gg&&(i++,s=t[l][1]+s,l--),c=l}}if(nm(t[r][1])){u=t[r][1].charAt(0);t[r][1]=t[r][1].slice(1),s+=u,a+=u}}if(r<t.length-1&&!t[r][1]){t.splice(r,1);break}if(s.length>0||a.length>0){s.length>0&&a.length>0&&(0!==(n=Xg(a,s))&&(c>=0?t[c][1]+=a.substring(0,n):(t.splice(0,0,[Wg,a.substring(0,n)]),r++),a=a.substring(n),s=s.substring(n)),0!==(n=Jg(a,s))&&(t[r][1]=a.substring(a.length-n)+t[r][1],a=a.substring(0,a.length-n),s=s.substring(0,s.length-n)));var f=o+i;0===s.length&&0===a.length?(t.splice(r-f,f),r-=f):0===s.length?(t.splice(r-f,f,[Kg,a]),r=r-f+1):0===a.length?(t.splice(r-f,f,[Gg,s]),r=r-f+1):(t.splice(r-f,f,[Gg,s],[Kg,a]),r=r-f+2)}0!==r&&t[r-1][0]===Wg?(t[r-1][1]+=t[r][1],t.splice(r,1)):r++,o=0,i=0,s="",a=""}""===t[t.length-1][1]&&t.pop();var d=!1;for(r=1;r<t.length-1;)t[r-1][0]===Wg&&t[r+1][0]===Wg&&(t[r][1].substring(t[r][1].length-t[r-1][1].length)===t[r-1][1]?(t[r][1]=t[r-1][1]+t[r][1].substring(0,t[r][1].length-t[r-1][1].length),t[r+1][1]=t[r-1][1]+t[r+1][1],t.splice(r-1,1),d=!0):t[r][1].substring(0,t[r+1][1].length)==t[r+1][1]&&(t[r-1][1]+=t[r+1][1],t[r][1]=t[r][1].substring(t[r+1][1].length)+t[r+1][1],t.splice(r+1,1),d=!0)),r++;d&&Qg(t,e)}function tm(t){return t>=55296&&t<=56319}function em(t){return t>=56320&&t<=57343}function nm(t){return em(t.charCodeAt(0))}function rm(t){return tm(t.charCodeAt(t.length-1))}function im(t,e,n,r){return rm(t)||nm(r)?null:function(t){for(var e=[],n=0;n<t.length;n++)t[n][1].length>0&&e.push(t[n]);return e}([[Wg,t],[Gg,e],[Kg,n],[Wg,r]])}function om(t,e,n){return Zg(t,e,n,!0)}om.INSERT=Kg,om.DELETE=Gg,om.EQUAL=Wg;var sm=Dt(om);const am=new WeakMap,cm=new WeakMap;class um{on(t,e,n){this.addEventListener(t,e,n)}off(t,e,n){this.removeEventListener(t,e,n)}addEventListener(t,e,n){(null==n?void 0:n.once)&&(e=fm(this,t,e,!0)),lm(this,t,!0).add(e)}removeEventListener(t,e,n){if((null==n?void 0:n.once)&&(e=fm(this,t,e)),!e)return;const r=lm(this,t);r&&r.delete(e)}dispatchEvent(t,e){const n=lm(this,t.type);if(n)for(let r of n){if(e)try{r.call(this,t)}catch(t){try{this.dispatchEvent(new ErrorEvent("error",{error:t}))}catch(t){}}else r.call(this,t);if(t.cancelBubble)break}}}function lm(t,e,n=!1){let r=am.get(t);return!r&&n&&am.set(t,r=Object.create(null)),r&&r[e]||n&&(r[e]=new Set)}function fm(t,e,n,r=!1){let i=cm.get(t);!i&&r&&am.set(t,i=Object.create(null));const o=i&&i[e]||r&&(i[e]=new Map);if(!o.has(n)&&r){const r=r=>{const i=lm(t,e);i&&i.delete(n),n.call(t,r)};o.set(n,r)}return o&&o.get(n)}var dm;function hm(t){return t===Object(t)&&!Array.isArray(t)}!function(t){t.compose=function t(e={},n={},r){"object"!=typeof e&&(e={}),"object"!=typeof n&&(n={});let i=qg(n);for(const n in e)hm(e[n])&&hm(i[n])&&(i[n]=t(e[n],i[n],r));r||(i=Object.keys(i).reduce(((t,e)=>(null!=i[e]&&(t[e]=i[e]),t)),{}));for(const t in e)void 0!==e[t]&&void 0===n[t]&&(i[t]=e[t]);return Object.keys(i).length>0?i:void 0},t.diff=function t(e={},n={}){"object"!=typeof e&&(e={}),"object"!=typeof n&&(n={});const r=Object.keys(e).concat(Object.keys(n)).reduce(((r,i)=>(zg(e[i],n[i])||(void 0===n[i]?r[i]=null:hm(e[i])&&hm(n[i])?r[i]=t(e[i],n[i]):r[i]=n[i]),r)),{});return Object.keys(r).length>0?r:void 0},t.invert=function t(e={},n={}){e=e||{};const r=Object.keys(n).reduce(((r,i)=>(zg(n[i],e[i])||void 0===e[i]||(hm(e[i])&&hm(n[i])?r[i]=t(e[i],n[i]):r[i]=n[i]),r)),{});return Object.keys(e).reduce(((t,r)=>(e[r]!==n[r]&&void 0===n[r]&&(t[r]=null),t)),r)},t.transform=function t(e,n,r=!1){if("object"!=typeof e)return n;if("object"!=typeof n)return;if(!r)return n;const i=Object.keys(n).reduce(((r,i)=>(void 0===e[i]?r[i]=n[i]:hm(e[i])&&hm(n[i])&&(r[i]=t(e[i],n[i],!0)),r)),{});return Object.keys(i).length>0?i:void 0}}(dm||(dm={}));var pm,gm=dm;!function(t){t.iterator=function(t){return new bm(t)},t.length=function(t){return"number"==typeof t.delete?t.delete:"number"==typeof t.retain?t.retain:"string"==typeof t.insert?t.insert.length:1}}(pm||(pm={}));var mm=pm;class bm{constructor(t){this.ops=t,this.index=0,this.offset=0}hasNext(){return!!this.peek()}next(t){t||(t=1/0);const e=this.ops[this.index];if(e){const n=this.offset,r=pm.length(e);if(t>=r-n?(t=r-n,this.index+=1,this.offset=0):this.offset+=t,"number"==typeof e.delete)return{delete:t};{if(r===t)return e;const i={};return e.attributes&&(i.attributes=e.attributes),"number"==typeof e.retain?i.retain=t:"string"==typeof e.insert?i.insert=e.insert.substr(n,t):i.insert=e.insert,i}}return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?pm.length(this.ops[this.index])-this.offset:1/0}peekType(){return this.ops[this.index]?"number"==typeof this.ops[this.index].delete?"delete":"number"==typeof this.ops[this.index].retain?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);{const t=this.offset,e=this.index,n=this.next(),r=this.ops.slice(this.index);return this.offset=t,this.index=e,[n].concat(r)}}return[]}}const ym=String.fromCharCode(0);class wm{constructor(t){Array.isArray(t)?this.ops=t:null!=t&&Array.isArray(t.ops)?this.ops=t.ops:this.ops=[]}insert(t,e){const n={};return"string"==typeof t&&0===t.length?this:(n.insert=t,null!=e&&"object"==typeof e&&Object.keys(e).length>0&&(n.attributes=e),this.push(n))}delete(t){return t<=0?this:this.push({delete:t})}retain(t,e){if(t<=0)return this;const n={retain:t};return null!=e&&"object"==typeof e&&Object.keys(e).length>0&&(n.attributes=e),this.push(n)}push(t){let e=this.ops.length,n=this.ops[e-1];if("object"==typeof n){if("number"==typeof t.delete&&"number"==typeof n.delete)return this.ops[e-1]={delete:n.delete+t.delete},this;if("number"==typeof n.delete&&null!=t.insert&&(e-=1,n=this.ops[e-1],"object"!=typeof n))return this.ops.unshift(t),this;if(zg(t.attributes,n.attributes)){if("string"==typeof t.insert&&"string"==typeof n.insert)return this.ops[e-1]={insert:n.insert+t.insert},"object"==typeof t.attributes&&(this.ops[e-1].attributes=t.attributes),this;if("number"==typeof t.retain&&"number"==typeof n.retain)return this.ops[e-1]={retain:n.retain+t.retain},"object"==typeof t.attributes&&(this.ops[e-1].attributes=t.attributes),this}}return e===this.ops.length?this.ops.push(t):this.ops.splice(e,0,t),this}chop(){const t=this.ops[this.ops.length-1];return t&&t.retain&&!t.attributes&&this.ops.pop(),this}filter(t){return this.ops.filter(t)}forEach(t){this.ops.forEach(t)}map(t){return this.ops.map(t)}partition(t){const e=[],n=[];return this.forEach((r=>{(t(r)?e:n).push(r)})),[e,n]}reduce(t,e){return this.ops.reduce(t,e)}changeLength(){return this.reduce(((t,e)=>e.insert?t+mm.length(e):e.delete?t-e.delete:t),0)}length(){return this.reduce(((t,e)=>t+mm.length(e)),0)}slice(t=0,e=1/0){const n=[],r=mm.iterator(this.ops);let i=0;for(;i<e&&r.hasNext();){let o;i<t?o=r.next(t-i):(o=r.next(e-i),n.push(o)),i+=mm.length(o)}return new wm(n)}compose(t,e){const n=mm.iterator(this.ops),r=mm.iterator(t.ops),i=[],o=r.peek();if(null!=o&&"number"==typeof o.retain&&null==o.attributes){let t=o.retain;for(;"insert"===n.peekType()&&n.peekLength()<=t;)t-=n.peekLength(),i.push(n.next());o.retain-t>0&&r.next(o.retain-t)}const s=new wm(i);for(;n.hasNext()||r.hasNext();)if("insert"===r.peekType())s.push(r.next());else if("delete"===n.peekType())s.push(n.next());else{const t=Math.min(n.peekLength(),r.peekLength()),i=n.next(t),o=r.next(t);if("number"==typeof o.retain){let a;const c=o.attributes&&gm.compose(i.attributes,o.attributes,!e&&"number"==typeof i.retain);if(o.attributes&&!zg(c,i.attributes)?(a={},"number"==typeof i.retain?a.retain=t:a.insert=i.insert,c&&(a.attributes=c)):a=i.retain===1/0?o:i,s.push(a),o.retain===1/0||!r.hasNext()&&zg(s.ops[s.ops.length-1],a)){const t=new wm(n.rest());return s.concat(t).chop()}}else"number"==typeof o.delete&&"number"==typeof i.retain&&s.push(o)}return s.chop()}concat(t){const e=new wm(this.ops.slice());return t.ops.length>0&&(e.push(t.ops[0]),e.ops=e.ops.concat(t.ops.slice(1))),e}diff(t,e){if(this.ops===t.ops)return new wm;const n=[this,t].map((e=>e.map((n=>{if(null!=n.insert)return"string"==typeof n.insert?n.insert:ym;throw new Error("diff() called "+(e===t?"on":"with")+" non-document")})).join(""))),r=new wm,i=sm(n[0],n[1],e),o=mm.iterator(this.ops),s=mm.iterator(t.ops);return i.forEach((t=>{let e=t[1].length;for(;e>0;){let n=0;switch(t[0]){case sm.INSERT:n=Math.min(s.peekLength(),e),r.push(s.next(n));break;case sm.DELETE:n=Math.min(e,o.peekLength()),o.next(n),r.delete(n);break;case sm.EQUAL:n=Math.min(o.peekLength(),s.peekLength(),e);const t=o.next(n),i=s.next(n);zg(t.insert,i.insert)?r.retain(n,gm.diff(t.attributes,i.attributes)):r.push(i).delete(n)}e-=n}})),r.chop()}eachLine(t,e="\n"){const n=mm.iterator(this.ops);let r=new wm,i=0;for(;n.hasNext();){if("insert"!==n.peekType())return;const o=n.peek(),s=mm.length(o)-n.peekLength(),a="string"==typeof o.insert?o.insert.indexOf(e,s)-s:-1;if(a<0)r.push(n.next());else if(a>0)r.push(n.next(a));else{if(!1===t(r,n.next(1).attributes||{},i))return;i+=1,r=new wm}}r.length()>0&&t(r,{},i,!0)}invert(t){const e=new wm;return this.reduce(((n,r)=>{if(r.insert)e.delete(mm.length(r));else{if(r.retain&&null==r.attributes)return e.retain(r.retain),n+r.retain;if(r.delete||r.retain&&r.attributes){const i=r.delete||r.retain;return t.slice(n,n+i).forEach((t=>{r.delete?e.push(t):r.retain&&r.attributes&&e.retain(mm.length(t),gm.invert(r.attributes,t.attributes))})),n+i}}return n}),0),e.chop()}transform(t,e=!1){if(e=!!e,"number"==typeof t)return this.transformPosition(t,e);const n=t,r=mm.iterator(this.ops),i=mm.iterator(n.ops),o=new wm;for(;r.hasNext()||i.hasNext();)if("insert"!==r.peekType()||!e&&"insert"===i.peekType())if("insert"===i.peekType())o.push(i.next());else{const t=Math.min(r.peekLength(),i.peekLength()),n=r.next(t),s=i.next(t);if(n.delete)continue;s.delete?o.push(s):o.retain(t,gm.transform(n.attributes,s.attributes,e))}else o.retain(mm.length(r.next()));return o.chop()}transformPosition(t,e=!1){e=!!e;const n=mm.iterator(this.ops);let r=0;for(;n.hasNext()&&r<=t;){const i=n.peekLength(),o=n.peekType();n.next(),"delete"!==o?("insert"===o&&(r<t||!e)&&(t+=i),r+=i):t-=Math.min(i,t-r)}return t}}function vm(t){return t?(t[0]>t[1]&&(t=[t[1],t[0]]),t):t}function Em(t){return t.map((t=>"string"==typeof t.insert?t.insert:t.insert?" ":"")).join("")}wm.Op=mm,wm.AttributeMap=gm;const xm=new Map,_m={id:"",attributes:{},content:new wm([{retain:1/0}]),length:1/0};var Am;!function(t){function e(t=xm){let e;for(;t[e=Math.random().toString(36).slice(2)];);return e}t.iterator=function(t,e){return new Nm(t,e)},t.linesToLineIds=function(e){const n=new Map;return e.forEach((e=>n.set(e.id||t.createId(n),e))),n},t.length=function(t){return t.length},t.getId=function(t){return console.warn("getId() is deprecated"),t.id},t.equal=function(t,e){return zg(t.attributes,e.attributes)&&zg(t.content.ops,e.content.ops)},t.fromDelta=function(e,n){const r=[],i=new Map(n||[]);return e.eachLine(((e,n)=>{const o=t.create(e,Object.keys(n).length?n:void 0,i);i.set(o.id,o),r.push(o)})),r},t.toDelta=function(t){let e=new wm;return t.forEach((t=>{e=e.concat(t.content),e.insert("\n",t.attributes)})),e},t.create=function(t=new wm,n={},r){const i=t.length()+1;return"string"!=typeof r&&(r=e(r)),{id:r,attributes:n,content:t,length:i}},t.createFrom=function(t,n=new wm,r){return{id:t?t.id:e(r),attributes:t?t.attributes:{},content:n,length:1}},t.getLineRanges=function(t){const e=new Map;let n=0;return t.forEach((t=>{e.set(t,[n,n+=t.length])})),e},t.createId=e}(Am||(Am={}));var Tm,Sm=Am;class Nm{constructor(t,e){this.lines=t,this.index=0,this.offset=0,this.lineIds=e?new Map(e):Am.linesToLineIds(t)}hasNext(){return!!this.peek()}next(t){t||(t=1/0);const e=this.lines[this.index];if(e){const n=this.offset,r=e.length;if(t>=r-n?(t=r-n,this.index+=1,this.offset=0):this.offset+=t,0===n&&t>=e.length)return e;{const r=0===n?e.id:Am.createId(this.lineIds),i={id:r,attributes:e.attributes,content:e.content.slice(n,t),length:t-n};return 0!==n&&this.lineIds.set(r,i),i}}return _m}peek(){return this.lines[this.index]}peekLength(){return this.lines[this.index]?this.lines[this.index].length-this.offset:1/0}rest(){if(this.hasNext()){if(0===this.offset)return this.lines.slice(this.index);{const t=this.offset,e=this.index,n=this.next(),r=this.lines.slice(this.index);return this.offset=t,this.index=e,[n].concat(r)}}return[]}}!function(t){t.iterator=function(t,e){return new Im(t,e)},t.length=function(t){return mm.length(t)}}(Tm||(Tm={}));var Bm=Tm;class Im{constructor(t,e){this.lineIterator=Sm.iterator(t,e);const n=this.lineIterator.peek();this.opIterator=mm.iterator((null==n?void 0:n.content.ops)||[])}hasNext(){return this.opIterator.hasNext()||this.lineIterator.hasNext()}next(t){let e=this.opIterator.next(t);return e.retain===1/0&&this.lineIterator.hasNext()&&(e=Om(this.nextLine())),e}nextLine(){const t=this.lineIterator.next(),e=this.lineIterator.peek();return this.opIterator=new bm((null==e?void 0:e.content.ops)||[]),t}peek(){return this.opIterator.hasNext()||!this.lineIterator.hasNext()?this.opIterator.peek():Om(this.peekLine())}peekLine(){return this.lineIterator.peek()}peekLength(){return this.opIterator.hasNext()||!this.lineIterator.hasNext()?this.opIterator.peekLength():1}peekLineLength(){return this.lineIterator.peekLength()}peekType(){return this.opIterator.hasNext()?this.opIterator.peekType():this.lineIterator.hasNext()?"insert":"retain"}restCurrentLine(){return this.opIterator.rest()}restLines(){return this.opIterator.offset&&this.lineIterator.next(this.opIterator.offset),this.lineIterator.rest()}}function Om(t){const e={insert:"\n"};return t.attributes&&(e.attributes=t.attributes),e}class Rm{constructor(t,e=new wm,n,r){this._pos=0,this.doc=t,this.delta=e,this.selection=n,this.activeFormats=r}get contentChanged(){return this.delta.ops.length>0}get selectionChanged(){var t;return void 0!==this.selection&&!zg(this.selection,null===(t=this.doc)||void 0===t?void 0:t.selection)}apply(){throw new Error("Must be overridden by creator of change (e.g. Editor).")}setDelta(t){return this.delta=t,this._pos=t.length(),this}setActiveFormats(t){return this.activeFormats=t,this}select(t){return this.selection="number"==typeof t?[t,t]:t,this}delete(t,e){if(!t||!this.doc)return this;let[n,r]=vm(t);if(n=Math.max(0,n),r=Math.min(this.doc.length-1,r),n===r)return this;const i=r-n;this.doc.selection&&(this.selection=[n,n]),this.compose(n,(t=>t.delete(i)),i);const o=this.doc.getLineRange(n);if(!(null==e?void 0:e.dontFixNewline)&&o[1]<=r){const t=this.doc.getLineAt(n).attributes;this.formatLine(r,t)}return this}insert(t,e,n,r){if(!this.doc)return this;if(t=this.normalizePoint(t),this.doc.selection){const n=t+("string"==typeof e?e.length:1);this.selection=[n,n]}const{id:i,...o}=this.doc.getLineAt(t).attributes;if("string"!=typeof e)this.compose(t,(t=>t.insert(e,n)));else if("\n"===e)(null==r?void 0:r.dontFixNewline)?this.compose(t,(t=>t.insert("\n",{...n}))):(this.compose(t,(t=>t.insert("\n",o))),this.formatLine(t,{...n}));else if(n||(n=this.getFormatAt(t)),e.includes("\n")){const r=e.split("\n");this.compose(t,(t=>(r.forEach(((e,r)=>{r&&t.insert("\n",1===r?o:{}),e.length&&t.insert(e,n)})),t))),o&&this.formatLine(t,{...o})}else this.compose(t,(t=>t.insert(e,n)));return this}insertContent(t,e){if(!this.doc)return this;if(t=this.normalizePoint(t),this.doc.selection){const n=e.ops.filter((t=>t.delete));for(;n.length&&n[n.length-1].retain;)n.pop();const r=t+n.reduce(((t,e)=>t+mm.length(e)),0);this.selection=[r,r]}return-1!==Em(e).indexOf("\n")&&this.formatLine(t,{...this.doc.getLineFormat(t)}),this.compose(t,(t=>t.concat(e))),this}formatText(t,e){if(!this.doc)return this;return(t=vm(t))[1]-t[0]?(e&&Object.keys(e).forEach((t=>!1===e[t]&&(e[t]=null))),this.doc.getLineRanges(t).forEach((([n,r])=>{n=Math.max(t[0],n);const i=(r=Math.min(t[1],r-1))-n;this.compose(n,(t=>t.retain(i,e)),i)})),this):this}toggleTextFormat(t,e){if(!this.doc)return this;"number"==typeof t&&(t=[t,t]),t=vm(t);return $m(e,this.doc.getTextFormat(t))&&(e=gm.invert(e)),this.formatText(t,e)}formatLine(t,e,n){if(!this.doc)return this;const r=this.doc;return"number"==typeof t&&(t=[t,t]),t=vm(t),this.doc.getLineRanges(t).forEach((([t,i])=>{if(i--,!n){const t=gm.invert(r.getLineFormat(i));e={...t,...e}}this.compose(i,(t=>t.retain(1,e)),1)})),this.delta.chop(),this}toggleLineFormat(t,e){if(!this.doc)return this;"number"==typeof t&&(t=[t,t]),t=vm(t);return $m(e,this.doc.getLineFormat(t))&&(e=gm.invert(e)),this.formatLine(t,e)}removeFormat(t){if(!this.doc)return this;t=vm(t);const e=gm.invert(this.doc.getFormats(t)),n=t[1]-t[0];return this.compose(t[0],(t=>t.retain(n,e)),n)}transform(t,e){const n=this.delta.transform(t.delta,e),r=t.selection&&this.transformSelection(t.selection);return new Rm(null,n,r)}transformSelection(t,e){if(!t)return t;const n=this.delta.transformPosition(t[0],e),r=this.delta.transformPosition(t[1],e);return n===t[0]&&r===t[1]?t:[n,r]}transformAgainst(t,e){return(t instanceof wm?new Rm(null,t):t).transform(this,!e)}isFor(t){return this.doc===t}clone(){var t;return new Rm(this.doc,new wm(this.delta.ops.slice()),null===(t=this.selection)||void 0===t?void 0:t.slice())}compose(t,e,n){return this._pos<=t?this.delta=e(this.delta.retain(t-this._pos)):this.delta=this.delta.compose(e((new wm).retain(t))),this._pos=Math.max(t+(n||0),this._pos),this}normalizePoint(t,e=(this.doc?this.doc.length-1:0)){return Math.max(0,Math.min(e,t))}getFormatAt(t){let e;if(this.doc){const n=this.doc.getTextFormat(t),r=this.doc.getTextFormat(t+1);n&&r&&(e=n===r?n:function(t,e){const n={};return Object.keys(t).forEach((r=>{t[r]===e[r]&&(n[r]=t[r])})),n}(r,Object.keys(n)))}return e}}function $m(t,e){return Object.keys(t).every((n=>zg(e[n],t[n])))}const km=[0,0],Lm={},Pm=new WeakMap,Um=new Set(["id"]);class Dm{constructor(t,e=null){t instanceof Dm?(this.lines=t.lines,this.byId=t.byId,this._ranges=t._ranges,this.length=t.length):(this.byId=new Map,Array.isArray(t)?this.lines=t:this.lines=t?Sm.fromDelta(t):[Sm.create()],this.lines.length||this.lines.push(Sm.create()),this.byId=Sm.linesToLineIds(this.lines),this.lines.forEach((t=>{if(this.byId.get(t.id)!==t)throw new Error("TextDocument has duplicate line ids: "+t.id)})),this._ranges=Sm.getLineRanges(this.lines),this.length=this.lines.reduce(((t,e)=>t+e.length),0)),this.selection=e&&e.map((t=>Math.min(this.length-1,Math.max(0,t))))}get change(){const t=new Rm(this);return t.apply=()=>this.apply(t),t}getText(t){return t&&(t=vm(t)),Em(t?this.slice(t[0],t[1]):this.slice(0,this.length-1))}getLineBy(t){return this.byId.get(t)}getLineAt(t){return this.lines.find((e=>{const[n,r]=this.getLineRange(e);return n<=t&&r>t}))}getLinesAt(t,e){let n=t;return Array.isArray(t)&&([t,n]=vm(t)),this.lines.filter((r=>{const[i,o]=this.getLineRange(r);return e?i>=t&&o<=n:(i<n||i===t)&&o>t}))}getLineRange(t){const{lines:e,_ranges:n}=this;if("number"==typeof t){for(let r=0;r<e.length;r++){const i=n.get(e[r])||km;if(i[0]<=t&&i[1]>t)return i}return km}return"string"==typeof t&&(t=this.getLineBy(t)),n.get(t)}getLineRanges(t){return null==t?Array.from(this._ranges.values()):this.getLinesAt(t).map((t=>this.getLineRange(t)))}getLineFormat(t=this.selection,e){let n=t;return Array.isArray(t)&&([t,n]=vm(t)),t===n&&n++,Cm(Sm,this.lines,t,n,void 0,e)}getTextFormat(t=this.selection,e){let n=t;return Array.isArray(t)&&([t,n]=vm(t)),t===n&&t--,Cm(Bm,this.lines,t,n,(t=>"\n"!==t.insert),e)}getFormats(t=this.selection,e){return{...this.getTextFormat(t,e),...this.getLineFormat(t,e)}}slice(t=0,e=1/0){const n=[],r=Bm.iterator(this.lines);let i=0;for(;i<e&&r.hasNext();){let o;i<t?o=r.next(t-i):(o=r.next(e-i),n.push(o)),i+=mm.length(o)}return new wm(n)}apply(t,e,n){let r;if(t instanceof Rm?(r=t.delta,e=t.selection):r=t,!r.ops.length&&(void 0===e||zg(this.selection,e)))return this;if(!r.ops.length&&e)return new Dm(this,e);void 0===e&&this.selection&&(e=[r.transformPosition(this.selection[0]),r.transformPosition(this.selection[1])],zg(this.selection,e)&&(e=this.selection));const i=Bm.iterator(this.lines,this.byId),o=mm.iterator(r.ops);let s=[];const a=o.peek();if(a&&a.retain&&!a.attributes){let t=a.retain;for(;i.peekLineLength()<=t;)t-=i.peekLineLength(),s.push(i.nextLine());a.retain-t>0&&o.next(a.retain-t)}if(!i.hasNext()&&n)throw new Error("apply() called with change that extends beyond document");let c=Sm.createFrom(i.peekLine());function u(t){t.length=t.content.length()+1,s.push(t)}for(;i.hasNext()||o.hasNext();)if("insert"===o.peekType()){const t=o.peek(),e="string"==typeof t.insert?t.insert.indexOf("\n",o.offset):-1;if(e<0)c.content.push(o.next());else{const t=e-o.offset;t&&c.content.push(o.next(t));const n=o.next(1);u(Sm.create(c.content,n.attributes)),c.content=new wm}}else{const t=Math.min(i.peekLength(),o.peekLength()),e=i.next(t),r=o.next(t);if("number"==typeof e.retain){if(n)throw new Error("apply() called with change that extends beyond document");continue}if("number"==typeof r.retain){const t="\n"===e.insert;let n=e;const a=r.attributes&&gm.compose(e.attributes,r.attributes);if(r.attributes&&!zg(a,e.attributes)&&(t?c.attributes=a||{}:(n={insert:e.insert},a&&(n.attributes=a))),t?(u(c),c=Sm.createFrom(i.peekLine())):c.content.push(n),r.retain===1/0||!o.hasNext()){if(0!==i.opIterator.index||0!==i.opIterator.offset){const t=i.restCurrentLine();for(let e=0;e<t.length;e++)c.content.push(t[e]);u(c),i.nextLine()}s.push(...i.restLines());break}}else"number"==typeof r.delete&&"\n"===e.insert&&(c=Sm.createFrom(i.peekLine(),c.content))}return new Dm(s,e)}replace(t,e){return new Dm(t,e)}toDelta(){const t=Pm;let e=t.get(this);return e||(e=Sm.toDelta(this.lines),t.set(this,e)),e}equals(t,e){return this===t||((null==e?void 0:e.contentOnly)||zg(this.selection,t.selection))&&zg(this.lines,t.lines,{excludeProps:Um})}toJSON(){return this.toDelta()}toString(){return this.lines.map((t=>t.content.map((t=>"string"==typeof t.insert?t.insert:" ")).join(""))).join("\n")+"\n"}}function Cm(t,e,n,r,i,o){const s=t.iterator(e);let a,c=0;for(s.skip&&(c+=s.skip(n));c<r&&s.hasNext();){let e=s.next();c+=t.length(e),c>n&&(!i||i(e))&&(a=e.attributes?a?(null==o?void 0:o.allFormats)?gm.compose(a,e.attributes):Fm(a,e.attributes,null==o?void 0:o.nameOnly):{...e.attributes}:{})}return a||Lm}function Fm(t,e,n){return Object.keys(e).reduce((function(r,i){return n?i in t&&i in e&&(r[i]=!0):zg(t[i],e[i],{partial:!0})?r[i]=e[i]:zg(e[i],t[i],{partial:!0})&&(r[i]=t[i]),r}),{})}const Mm=new Set(["value","selected","checked","contentEditable"]),jm=t=>null==t?t:t.key,qm=(t,e)=>{e&&e!==t.key&&(t.key=e),!e&&t.key&&delete t.key},Vm=t=>{t.currentTarget.events[t.type](t)},zm=(t,e,n,r,i)=>{"key"===e||("o"===e[0]&&"n"===e[1]?((t.events||(t.events={}))[e=e.slice(2)]=r)?n||t.addEventListener(e,Vm):t.removeEventListener(e,Vm):null==r?t.removeAttribute(e):!i&&"list"!==e&&"form"!==e&&e in t?t[e]=null==r?"":r:t.setAttribute(e,r))},Hm=(t,e)=>{if("string"==typeof t)return document.createTextNode(t);var n=t.props,r=(e=e||"svg"===t.type)?document.createElementNS("http://www.w3.org/2000/svg",t.type,{is:n.is}):document.createElement(t.type,{is:n.is});for(var i in n)zm(r,i,null,n[i],e);return qm(r,jm(t)),t.children.forEach((t=>r.appendChild(Hm(Wm(t),e)))),r},Gm=(t,e,n,r,i)=>{if("string"==typeof r)null!=n&&n.nodeType===Node.TEXT_NODE?n.nodeValue!==r&&(e.nodeValue=r):(e=t.insertBefore(Hm(r,i),e),null!=n&&t.removeChild(n));else if(null==n||n.nodeName.toLowerCase()!==r.type)e=t.insertBefore(Hm(Wm(r),i),e),null!=n&&t.removeChild(n);else{var o=((t,e)=>{const n={};for(let r=0;r<t.attributes.length;r++){const{name:i,value:o}=t.attributes[r];n[i]=i in t&&"list"!==i&&!e?t[i]:""===o||o}return n})(n,i),s=r.props;for(var a in i=i||"svg"===r.type,{...o,...s})(Mm.has(a)?e[a]:o[a])!==s[a]&&zm(e,a,o[a],s[a],i);qm(e,r.key),Km(e,r.children,i)}return e},Km=(t,e,n,r=Array.from(t.childNodes))=>{for(var i,o,s,a,c=0,u=0,l=r.length-1,f=e.length-1;u<=f&&c<=l&&null!=(s=jm(r[c]))&&s===jm(e[u]);)Gm(t,r[c],r[c++],e[u]=Wm(e[u++]),n);for(;u<=f&&c<=l&&null!=(s=jm(r[l]))&&s===jm(e[f]);)r[l]=Gm(t,r[l],r[l--],e[f]=Wm(e[f--]),n);if(c>l){const i=r[c]||r[c-1]&&r[c-1].nextSibling||null;for(;u<=f;)t.insertBefore(Hm(e[u]=Wm(e[u++]),n),i)}else if(u>f)for(;c<=l;)t.removeChild(r[c++]);else{const d=new Map,h=new Set;for(let t=c;t<=l;t++)null!=(s=jm(r[t]))&&d.set(s,r[t]);for(;u<=f;)s=jm(o=r[c]),a=jm(e[u]=Wm(e[u])),h.has(s)||null!=a&&a===jm(r[c+1])?(null==s&&t.removeChild(o),c++):null==a?(null==s&&(Gm(t,o,o,e[u],n),u++),c++):(s===a?(Gm(t,o,o,e[u],n),h.add(a),c++):null!=(i=d.get(a))?(Gm(t,t.insertBefore(i,o),i,e[u],n),h.add(a)):Gm(t,o,null,e[u],n),u++);for(;c<=l;)null==jm(o=r[c++])&&t.removeChild(o);for(const[e,n]of d)h.has(e)||t.removeChild(n)}return t},Wm=t=>!0!==t&&!1!==t&&t?t:"",Zm=(t,e,n)=>"function"==typeof t?t(e||{},n):((t,e,n,r)=>({type:t,props:e,children:n,key:r}))(t,e||{},Array.isArray(n)?n:null==n?[]:[n],null==e?void 0:e.key),Ym=(t,e,n)=>t=Array.isArray(e)?Km(t,e,t instanceof window.SVGElement,n):Gm(t.parentNode,t,t,e),Xm=[],Jm={},Qm={},tb={},eb=(t,e)=>!0;class nb{constructor(t){var e,n,r;const i=null===(e=t.lines)||void 0===e?void 0:e.map((t=>"string"==typeof t?Jm[t]:t)).filter(Boolean),o=null===(n=t.formats)||void 0===n?void 0:n.map((t=>"string"==typeof t?Qm[t]:t)).filter(Boolean),s=null===(r=t.embeds)||void 0===r?void 0:r.map((t=>"string"==typeof t?tb[t]:t)).filter(Boolean);this.lines=new sb(i||Xm),this.formats=new sb(o||Xm),this.embeds=new sb(s||Xm)}}function rb(t){return t.renderMultiple&&!t.shouldCombine&&(t.shouldCombine=eb),Jm[t.name]=t}function ib(t){return Qm[t.name]=t}function ob(t){return tb[t.name]=t}nb.line=rb,nb.format=ib,nb.embed=ob;class sb{constructor(t){this.list=t,this.init()}get default(){return this.list[0]}init(){this.selector=this.list.map((t=>t.selector||"")).filter(Boolean).join(", "),this.types=this.list.reduce(((t,e)=>(t[e.name]=e,t)),{}),this.priorities=this.list.reduce(((t,e,n)=>(t[e.name]=n,t)),{})}add(t){this.list.push(t),this.init()}remove(t){const e="string"==typeof t?t:t.name;this.list=this.list.filter((t=>t.name!==e)),this.init()}get(t){return this.types[t]}priority(t){const e=this.priorities[t];return void 0!==e?e:-1}matches(t){if(!t)return!1;if(!t.nodeType)throw new Error("Cannot match against "+t);return t.nodeType===Node.ELEMENT_NODE?!!this.selector&&t.matches(this.selector):void 0}findByNode(t,e=!1){if(t.nodeType!==Node.ELEMENT_NODE)return;let n=this.list.length;for(;n--;){let e=this.list[n];if(t.matches(e.selector))return e}return e?this.default:void 0}findByAttributes(t,e=!1){const n=t&&Object.keys(t);let r;return n&&n.every((t=>!(r=this.get(t)))),r||(e?this.default:void 0)}}const ab=/;\s*$/,cb={name:"decoration",selector:"span.format.decoration",fromDom:!1,render:(t,e)=>db(Zm("span",{},e),t,["format","decoration"])},ub={name:"decoration",selector:".embed.decoration",fromDom:!1,noFill:!0,render:(t,e)=>{const n="embed decoration",{name:r,...i}=t.decoration;return i.class=i.class?n+" "+i.class:n,Zm(r||"span",i,e)}};class lb extends Event{constructor(t,e){super(t,e),this.old=e.old,this.doc=e.doc,this.change=e.change,this.changedLines=e.changedLines}}class fb{constructor(t,e,n,r,i){this._name=t,this._doc=e,this.change=new Rm(e),this._decoration=n,this._apply=r,this._remove=i}hasDecorations(){return!!this._decoration&&this._decoration.ops.length>0||this.change.delta.ops.length>0}getDecoration(){return this._decoration?this._decoration.compose(this.change.delta):this.change.delta}apply(){return this._apply(this._name,this.change.delta)}remove(){return this._remove(this._name)}clear(t){return this.hasDecorations()?(t?this.change.setDelta(this.change.delta.compose(this.invert(t))):this.change.setDelta(this.invert()),this):this}clearLines(t){if(!t.length)return this;const e=this._doc,n=[e.getLineRange(t[0])[0],e.getLineRange(t[t.length-1])[1]],r=1===t.length||t.every(((n,r)=>!r||e.getLineRange(t[r-1])[1]===e.getLineRange(n)[0]));if(r)return this.clear(n);const i=this.invert(n),o=new wm;let s=0;return t.forEach((t=>{const[n,r]=e.getLineRange(t);o.retain(n-s).concat(i.slice(n,r)),s=r})),this.change.setDelta(this.change.delta.compose(o)),this}clearLine(t){const e=this._doc,n="number"==typeof t?e.getLineAt(t):"string"==typeof t?e.getLineBy(t):t;return this.clearLines([n])}invert(t){return this._decoration?hb(this._name,this._decoration,this._doc,t):new wm}decorateText(t,e={class:this._name}){return this.change.formatText(t,{decoration:{[this._name]:e}}),this}decorateLine(t,e={class:this._name}){return this.change.formatLine(t,{decoration:{[this._name]:e}},!0),this}insertDecoration(t,e={class:this._name}){if("string"==typeof e)throw new Error("You may only insert embed decorations");return this.change.insert(t,{decoration:e}),this}}function db(t,e,n){if(!e||!e.decoration)return t;const r=new Set(n);let i="",o=t.props;Object.values(e.decoration).forEach((t=>{const{class:e,style:n,...s}=t;e&&r.add(e.trim()),n&&(i+=n.trim()),i&&!ab.test(i)&&(i+=";"),o={...s,...o}}));const s=Array.from(r).join(" ").trim();return s&&(o.class=o.class?o.class+" "+s:s),i&&(o.style=o.style?o.style+";"+i:i),t.props=o,t}function hb(t,e,n,r){let i=n.toDelta();return r&&(i=i.slice(r[0],r[1]),e=e.slice(r[0],r[1])),(e=e.invert(i)).ops.forEach((e=>{var n;null===(null===(n=e.attributes)||void 0===n?void 0:n.decoration)&&(e.attributes.decoration={[t]:null})})),r&&(e=(new wm).retain(r[0]).concat(e)),e}const pb=[],gb=Zm("br",{}),mb=new WeakMap,bb=new WeakMap,yb=new WeakMap,wb=new WeakMap,vb=new WeakMap;function Eb(t,e){var n,r;return null===(r=null===(n=vb.get(t))||void 0===n?void 0:n.get(e))||void 0===r?void 0:r[0]}function xb(t,e){var n,r;return null===(r=null===(n=vb.get(t))||void 0===n?void 0:n.get(e))||void 0===r?void 0:r[1]}function _b(t){const{root:e,doc:n}=t,r=Bb(t,n.lines),i=new WeakMap;for(let o=0;o<e.children.length;o++){const s=e.children[o];if(!s.key)continue;const a=r.byKey[s.key];if(a)if(Array.isArray(a)){i.set(s,[n.getLineRange(a[0])[0],n.getLineRange(a[a.length-1])[1]]);const e=s.querySelectorAll(t.typeset.lines.selector);for(let t=0;t<e.length;t++){const r=e[t],o=n.getLineBy(r.key);o&&i.set(r,n.getLineRange(o))}}else i.set(s,n.getLineRange(a))}const o=e.querySelectorAll(t.typeset.lines.selector);for(let t=0;t<o.length;t++){const e=o[t];if(i.has(e)||!e.key)continue;const r=n.getLineBy(e.key);i.set(e,n.getLineRange(r))}vb.set(e,i)}function Ab(t,e){const{root:n}=t;t.dispatchEvent(new Event("rendering")),Ym(n,Sb(t,e)),_b(t),t.dispatchEvent(new Event("render")),t.dispatchEvent(new Event("rendered"))}function Tb(t,e,n){const{root:r}=t,i=Bb(t,e.lines).combined,o=Bb(t,n.lines).combined,[s,a]=function(t,e){const n=t.length,r=e.length,i=Math.min(n,r);let o=0,s=0,a=0,c=0;for(let n=0;n<i;n++)if(!Ob(t[n],e[n])){o=a=n;break}for(let o=0;o<i;o++)if(!Ob(t[n-o-1],e[r-o-1])){s=n-o,c=r-o;break}return[[o,s],[a,c]]}(i,o);zg(s,a)||(s[0]=Math.max(0,s[0]-1),a[0]=Math.max(0,a[0]-1),s[1]=Math.min(i.length,s[1]+1),a[1]=Math.min(o.length,a[1]+1),r.childNodes.length!==i.length&&(s[1]+=r.childNodes.length-i.length));const c=Array.from(r.childNodes).slice(s[0],s[1]),u=o.slice(a[0],a[1]);if(!c.length&&!u.length)return Ab(t,n);t.dispatchEvent(new Event("rendering")),Ym(r,Nb(t,u),c),_b(t),t.dispatchEvent(new Event("render")),t.dispatchEvent(new Event("rendered"))}function Sb(t,e,n){return Nb(t,Bb(t,e.lines).combined,n)}function Nb(t,e,n){return e.map((e=>function(t,e,n){return Array.isArray(e)?function(t,e,n){const r=Rb(t,e[0]);if(!r.renderMultiple)throw new Error("No render method defined for line");const i=r.renderMultiple(e.map((e=>[e.attributes,Ib(t,e.content),e.id])),t,n);return i.key=e[0].id,i}(t,e,n):function(t,e,n){const r=Rb(t,e);if(!r.render)throw new Error("No render method defined for line");const i=r.render(e.attributes,Ib(t,e.content),t,n);return db(i,e.attributes),i.key=e.id,i}(t,e,n)}(t,e,n))).filter(Boolean)}function Bb(t,e){const n=wb.get(e);if(n)return n;const r=[],i={};let o=[];e.forEach(((n,s)=>{const a=Rb(t,n);if(a.shouldCombine){o.push(n);const c=e[s+1];if(!c||Rb(t,c)!==a||!a.shouldCombine(n.attributes,c.attributes)){const t=yb.get(o[0]);t&&t.length===o.length&&o.every(((e,n)=>t[n]===e))?o=t:yb.set(o[0],o),r.push(o),i[o[0].id]=o,o=[]}}else a.render&&(r.push(n),i[n.id]=n)}));const s={combined:r,byKey:i};return wb.set(e,s),s}function Ib(t,e,n){const{formats:r,embeds:i}=t.typeset;let o=[],s=!0;return e.ops.forEach(((e,a,c)=>{let u=[];if("string"==typeof e.insert){const t=c[a-1],n=c[a+1];let r=e.insert.replace(/  /g," ").replace(/  /g," ");t&&"object"!=typeof t.insert||(r=r.replace(/^ /,"")),n&&"object"!=typeof n.insert&&!function(t){return"string"==typeof t.insert&&" "===t.insert[0]}
/*!
     * escape-html
     * Copyright(c) 2012-2013 TJ Holowaychuk
     * Copyright(c) 2015 Andreas Lubbe
     * Copyright(c) 2015 Tiancheng "Timothy" Gu
     * MIT Licensed
     */(n)||(r=r.replace(/ $/,"")),s=!1,u.push(r)}else if(e.insert){const r=i.findByAttributes(e.insert);(null==r?void 0:r.render)&&(u.push(r.render(e.insert,pb,t,n)),"br"===r.name?s=!0:r.noFill||(s=!1))}e.attributes&&Object.keys(e.attributes).sort(((t,e)=>r.priority(e)-r.priority(t))).forEach((i=>{const o=r.get(i);if(null==o?void 0:o.render){const r=o.render(e.attributes,u,t,n);r&&(mb.set(r,o),u=[r])}})),o.push.apply(o,u)})),o=$b(o),s&&o.push(gb),o}function Ob(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every(((t,n)=>t===e[n]))}function Rb(t,e){let n=bb.get(e.attributes);return n||(n=t.typeset.lines.findByAttributes(e.attributes,!0),bb.set(e.attributes,n)),n}function $b(t){const e=[];if(t.forEach(((t,n)=>{const r=e.length-1,i=e[r];i&&"string"!=typeof i&&"string"!=typeof t&&mb.has(i)&&mb.get(i)===mb.get(t)&&zg(i.props,t.props)?i.children=i.children.concat(t.children):i&&"string"==typeof i&&"string"==typeof t?e[r]+=t:(e.push(t),i&&"string"!=typeof i&&i.children&&(i.children=$b(i.children)))})),e.length){const t=e[e.length-1];t&&"string"!=typeof t&&t.children&&(t.children=$b(t.children))}return e}const kb=/["'&<>]/;function Lb(t){var e,n=""+t,r=kb.exec(n);if(!r)return n;var i="",o=0,s=0;for(o=r.index;o<n.length;o++){switch(n.charCodeAt(o)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 39:e="&#39;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}s!==o&&(i+=n.substring(s,o)),s=o+1,i+=e}return s!==o?i+n.substring(s,o):i}const Pb=NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT;function Ub(t,e){return(t.ownerDocument||document).createTreeWalker(t,Pb,{acceptNode(t){if(t.nodeType===Node.TEXT_NODE&&""===t.nodeValue)return NodeFilter.FILTER_REJECT;if(e){const n=e(t);return n?!0===n?NodeFilter.FILTER_ACCEPT:n:NodeFilter.FILTER_REJECT}return NodeFilter.FILTER_ACCEPT}})}const Db="address, article, aside, blockquote, editor, dd, div, dl, dt, fieldset, figcaption, figure, footer, form, h1, h2, h3, h4, h5, h6, header, hr, li, main, nav, noscript, ol, output, p, pre, section, table, tfoot, ul, video",Cb=/[\0-\x09\x0B\x1F\x7F-\x9F\xAD\u0600-\u0605\u061C\u06DD\u070F\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB\uE000-\uF8FF]/g,Fb={STYLE:!0,SCRIPT:!0,LINK:!0,META:!0,TITLE:!0},Mb={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},jb=/[ \t\n\r]+/g,qb=document.createElement("div"),Vb={};function zb(t,e){return"BR"===e.nodeName&&function(t,e){const n=e.closest&&e.closest(t.typeset.lines.selector);if(!n)return!1;const r=Ub(n);r.currentNode=e;const i=r.nextNode();return!i||i instanceof HTMLElement&&i.matches(Db)}(t,e)}function Hb(t,e){return Yb(Sb(t,e,!0))}function Gb(t,e,n){return new Dm(Kb(t,e),n)}function Kb(t,e,n){const r=Zb(t,{root:(new window.DOMParser).parseFromString(e,"text/html").body,possiblePartial:null==n?void 0:n.possiblePartial,collapseWhitespace:null==n?void 0:n.collapseWhitespace});return Wb(r),r}function Wb(t){t.forEach((t=>{"string"==typeof t.insert&&(t.insert=t.insert.replace(Cb,""))}))}function Zb(t,e=Vb){const{lines:n,embeds:r}=t.typeset,i=e.root||t.root,o=null==e.collapseWhitespace||e.collapseWhitespace;var s=Ub(i,(t=>!Fb[t.nodeName]));const a=new wm;let c,u,l=!1,f=!1,d=!0;for(e.startNode?(s.currentNode=e.startNode,s.previousNode(),e.offset&&a.retain(e.offset,void 0)):s.currentNode=i;(u=s.nextNode())&&u!==e.endNode;)if(zb(t,u))d=!1;else if("BR"===u.nodeName&&"Apple-interchange-newline"===u.className)a.insert("\n",!c||c.unknownLine?{}:c);else if(u.nodeType===Node.TEXT_NODE){let e=u.parentNode;if(null==u.nodeValue||""===u.nodeValue.replace(/\n+/g,""))continue;if(!u.nodeValue.replace(/\s+/g,"")&&(u.parentNode===i||u.previousSibling&&n.matches(u.previousSibling)||u.nextSibling&&n.matches(u.nextSibling)))continue;const r=u.nodeValue,s=(o?r.replace(jb," "):r).replace(/\xA0/g," ");if(!s||" "===s&&e.classList.contains("EOP"))continue;const c=Xb(e,i,t);d=!1,a.insert(s,c)}else if(r.matches(u)){const e=r.findByNode(u);if(e){const n=Xb(u.parentNode,i,t);!1!==e.fromDom&&a.insert(e.fromDom?e.fromDom(u):{[e.name]:!0},n)}}else if(n.matches(u)||u.nodeType===Node.ELEMENT_NODE&&u.matches(Db)){if(f=!n.matches(u),f){let t=u.parentNode;for(;t&&!n.matches(t)&&t!==i;)t=t.parentNode;if(t&&t!==i)continue}const t=n.findByNode(u,!0);if(t===n.default&&(!u.parentNode||n.matches(u.parentNode)))continue;if(t.frozen)for(;s.lastChild(););l?c&&c.unknownLine&&d||(a.insert("\n",!c||c.unknownLine?{}:c),d=!0):l=!0,c=f?{unknownLine:f}:t&&t!==n.default?t.fromDom?t.fromDom(u):{[t.name]:!0}:{},e.includeIds&&u.key&&(c.id=u.key)}return f&&d||!l&&e.possiblePartial||a.insert("\n",!c||c.unknownLine?{}:c),a}function Yb(t){return t&&t.length?t.reduce(((t,e)=>t+("string"!=typeof e?function(t){if("string"==typeof t){qb.textContent=t;const e=qb.innerHTML;return qb.textContent="",e}const e=Object.keys(t.props).reduce(((e,n)=>"key"===n||null==t.props[n]?e:`${e} ${Lb(n)}="${Lb(t.props[n])}"`),""),n=Yb(t.children),r=n||!Mb[t.type]?`</${t.type}>`:"";return`<${t.type}${e}>${n}${r}`}(e):Lb(e).replace(/\xA0/g,"&nbsp;"))),""):""}function Xb(t,e,n){const{lines:r,formats:i}=n.typeset,o={};for(;t&&!r.matches(t)&&t!==e;){if(i.matches(t)){const e=i.findByNode(t);e&&!1!==e.fromDom&&(o[e.name]=!e.fromDom||e.fromDom(t))}else t.hasAttribute("style")&&i.list.forEach((e=>{e.styleSelector&&t.matches(e.styleSelector)&&(o[e.name]=!e.fromDom||e.fromDom(t))}));t=t.parentNode}return o}const Jb=[null,0];function Qb(t,e){const n=function(t,e){e[0]>e[1]&&(e=[e[1],e[0]]);const[n,r,i,o]=ny(t,e),s=t.root.ownerDocument.createRange();return n&&i&&(s.setStart(n,r),s.setEnd(i,o)),s}(t,e);if((null==n?void 0:n.endContainer.nodeType)===Node.ELEMENT_NODE)try{n.setEnd(n.endContainer,n.endOffset+1)}catch(t){}return n}function ty(t,e,n,r){var i;const{root:o}=t,{lines:s}=t.typeset;if(!o.contains(e))return-1;if(e.nodeType===Node.ELEMENT_NODE){if(e.childNodes.length===n){if(null!=xb(o,e))return xb(o,e)-1;e.childNodes.length&&(n=function(t,e){var n;const{lines:r,embeds:i}=t.typeset;if(i.matches(e)&&!zb(t,e))return 1;if(e.nodeType===Node.TEXT_NODE)return iy(r,e);const o=Ub(e);let s,a=r.findByNode(e)?1:0;for(;s=o.nextNode();)s.nodeType===Node.TEXT_NODE?a+=iy(r,s):(null===(n=s.classList)||void 0===n?void 0:n.contains("decoration"))||(i.matches(s)&&!zb(t,s)||r.matches(s))&&a++;return a}(t,e=e.childNodes[n-1]))}else e=e.childNodes[n],n=0;const a=Eb(o,e);if(null!=a)return(null===(i=s.findByNode(e))||void 0===i?void 0:i.frozen)?a+n:(null==r||r<a?a:a-1)+n}return ey(t,e)+n}function ey(t,e){var n;const{root:r}=t;if(!r.ownerDocument)return-1;const{lines:i,embeds:o}=t.typeset,s=Ub(r);let a;s.currentNode=e;let c,u=0;for(;(a=s.previousNode())&&a!==r;){if(null!=(c=Eb(r,a))){u+=c;break}a.nodeType===Node.TEXT_NODE?u+=iy(i,a):(null===(n=a.classList)||void 0===n?void 0:n.contains("decoration"))||(o.matches(a)&&!zb(t,a)||i.matches(a)&&t.doc.lines[0].id!==a.key)&&u++}return u}function ny(t,e){if(null==e)return[null,0,null,0];{const n=e[0]<=e[1],r=n?1:-1,i=e[0]===e[1],[o,s,a]=ry(t,e[0],n?0:1),[c,u]=i&&!a?[o,s]:a&&(i||e[1]-e[0]==r*t.doc.getLineAt(e[0]).length)?[o,s+(n?1:-1)]:ry(t,e[1],n?1:0);return[o,s,c,u]}}function ry(t,e,n){var r;const{root:i}=t;if(!i.ownerDocument)return Jb;const{lines:o,embeds:s}=t.typeset,a=Array.from(i.childNodes),c=function(t,e){const{root:n}=t;if(!n.ownerDocument)return;return Array.from(n.childNodes).find((t=>Eb(n,t)<=e&&xb(n,t)>e))}(t,e);if(!c)return Jb;if(o.findByNode(c,!0).frozen)return[c.parentNode,a.indexOf(c)+n,!0];const u=!(e-=Eb(i,c)),l=Ub(c);let f,d=!1;for(;f=l.nextNode();)if(f.nodeType===Node.TEXT_NODE){const t=iy(o,f);if(e<=t)return[f,e];e-=t}else if(null===(r=f.classList)||void 0===r?void 0:r.contains("decoration"));else if(s.matches(f)&&!zb(t,f)){const t=s.findByNode(f);if(!t||!1===t.fromDom)continue;if((e-=1)<=0){const t=Array.from(f.parentNode.childNodes);return[f.parentNode,t.indexOf(f)+1+e]}}else if(o.matches(f)&&(d?e-=1:d=!0,0===e)){const t=l.firstChild();if(t&&t.nodeType===Node.TEXT_NODE)return[t,0];if(t){return[f,Array.from(f.childNodes).indexOf(t)]}return[f,0]}return u?[c,0]:Jb}function iy(t,e){const n=e.nodeValue||"";return n.trim()||!t.matches(e.previousSibling)&&!t.matches(e.nextSibling)?n.length:0}function oy(t){var e;const{root:n}=t,r=t.doc.selection;if(!n.ownerDocument)return null;const i=n.ownerDocument.getSelection(),{lines:o}=t.typeset;if(null!=i&&null!=i.anchorNode&&null!=i.focusNode&&n.contains(i.anchorNode)){const n=ty(t,i.anchorNode,i.anchorOffset,r&&r[0]),s=i.anchorNode===i.focusNode&&i.anchorOffset===i.focusOffset,a=o.findByAttributes(null===(e=t.doc.getLineAt(n))||void 0===e?void 0:e.attributes,!0).frozen;return[n,s?n:ty(t,i.focusNode,i.focusOffset,!a&&r?r[1]:null)]}return null}function sy(t,e){const{root:n}=t;if(!n.ownerDocument)return;const r=n.ownerDocument.getSelection();if(!r)return;const i=r.anchorNode&&n.contains(r.anchorNode)&&document.activeElement!==document.body;if(null==e)i&&(r.removeAllRanges(),n.classList.contains("focus")&&n.classList.remove("focus"));else{const[o,s,a,c]=ny(t,e),u=e[0]===e[1]?"Caret":"Range";o&&a&&(r.anchorNode===o&&r.anchorOffset===s&&r.focusNode===a&&r.focusOffset===c&&r.type===u||r.setBaseAndExtent(o,s,a,c)),i||n.focus(),n.classList.contains("focus")||n.classList.add("focus")}n.dispatchEvent(new Event("select",{bubbles:!0}))}var ay;!function(t){t.api="api",t.user="user",t.history="history",t.input="input",t.paste="paste"}(ay||(ay={}));const cy=function(t={}){return function(e){let n=0,r="",i=!1,o={undo:[],redo:[]};const s={maxStack:500,delay:0,...t};function a(t){"historyUndo"===t.inputType?(t.preventDefault(),c()):"historyRedo"===t.inputType&&(t.preventDefault(),u())}function c(){p("undo","redo")}function u(){p("redo","undo")}function l(){return o.undo.length>0}function f(){return o.redo.length>0}function d(){n=0}function h(){o={undo:[],redo:[]}}function p(t,n){if(0===o[t].length)return;const r=o[t].pop();o[n].push(r),d(),i=!0,"function"==typeof r[t]?r[t]():e.update(r[t],ay.history),i=!1}function g({change:t,old:e,source:a}){return t?i?void 0:t.contentChanged?void(a!==ay.api?function(t,e){const i=Date.now(),a=function(t){var e;const{ops:n}=t.delta;let r=0,i=n.length-1;if(n[r].retain&&!n[r].attributes&&r++,1===n[i].retain&&(null===(e=n[i].attributes)||void 0===e?void 0:e.id)&&i--,r===i){const t=n[r];if(t.delete)return"delete";if("\n"===t.insert)return"newline";if("string"==typeof t.insert)return"insert"}return""}(t);o.redo.length=0;const c=new Rm(null,t.delta.invert(e.toDelta()),e.selection);if(a&&r===a||d(),r=a,n&&(!s.delay||n+s.delay>i)&&o.undo.length){const e=o.undo[o.undo.length-1];e.redo.delta=e.redo.delta.compose(t.delta),e.redo.selection=t.selection,e.undo.delta=c.delta.compose(e.undo.delta)}else{const e=new Rm(null,t.delta,t.selection);n=i,o.undo.push({redo:e,undo:c})}o.undo.length>s.maxStack&&o.undo.shift()}(t,e):function(t,e){const n=e instanceof wm?new Rm(null,e):e;t.undo.forEach((t=>{t.undo=n.transform(t.undo,!0),t.redo=n.transform(t.redo,!0)})),t.redo.forEach((t=>{t.undo=n.transform(t.undo,!0),t.redo=n.transform(t.redo,!0)}))}(o,t)):d():h()}return{options:s,hasUndo:l,hasRedo:f,undo:c,redo:u,cutoffHistory:d,clearHistory:h,setStack:function(t){o=t},getStack:function(){return o},getActive:()=>({undo:l(),redo:f()}),commands:{undo:c,redo:u},shortcuts:{"win:Ctrl+Z":"undo","mac:Cmd+Z":"undo","win:Ctrl+Y":"redo","mac:Cmd+Shift+Z":"redo"},init(){e.on("change",g),e.root.addEventListener("beforeinput",a)},destroy(){e.off("change",g),e.root.removeEventListener("beforeinput",a)}}}}();const uy=!(navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform)||/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream)&&/Mobi|Android/.test(navigator.userAgent)&&!window.MSStream,ly={characterData:!0,characterDataOldValue:!0,subtree:!0,childList:!0};function fy(t,e){for(;e&&e.parentNode!==t;)e=e.parentNode;return e}const dy={Control:!0,Meta:!0,Shift:!0,Alt:!0},hy=-1!==navigator.userAgent.indexOf("Macintosh"),py=hy?/Cmd/:/Ctrl/;class gy extends KeyboardEvent{constructor(t,e){super(t,e),this.shortcut=(null==e?void 0:e.shortcut)||"",this.osShortcut=`${hy?"mac":"win"}:${this.shortcut}`,this.modShortcut=this.shortcut.replace(py,"Mod")}static fromKeyboardEvent(t){return t.shortcut=my(t),new gy("shortcut",t)}}function my(t){const e=[];let n=t.key;return n?(" "===n&&(n="Space"),t.metaKey&&e.push("Cmd"),t.ctrlKey&&e.push("Ctrl"),t.altKey&&e.push("Alt"),t.shiftKey&&e.push("Shift"),dy[n]||(hy&&t.altKey&&t.code&&t.code.startsWith("Key")&&(n=t.code.replace("Key","")),1===n.length&&(n=n.toUpperCase()),e.push(n)),e.join("+")):""}const by={},yy=window.chrome&&"object"==typeof window.chrome;const wy={dontFixNewline:!0},vy={excludeProps:new Set(["id"])};class Ey extends Event{constructor(t,e){super(t,e),this.delta=e.delta,this.html=e.html,this.text=e.text}}function xy(t){const{id:e,...n}=t.attributes;return n}const _y={copyPlainText:!0,copyHTML:!0};function Ay(t,e){return n=>{function r({doc:r}){var i,o,s;const a=n.modules.decorations.getDecorator("placeholder"),c=("function"==typeof t?t():t)||"";let u;if(a.hasDecorations()){const t=a.getDecoration().ops;u=null===(o=null===(i=t[t.length-1].attributes)||void 0===i?void 0:i.decoration)||void 0===o?void 0:o.placeholder}const{lines:l}=n.typeset,f=l.findByAttributes(null===(s=r.lines[0])||void 0===s?void 0:s.attributes,!0),d=l.default===f&&1===r.length;if(d||(null==e?void 0:e.keepAttribute)){const t={"data-placeholder":c||""};d&&(t.class="placeholder"),zg(t,u)||(a.remove(),a.decorateLine(0,t).apply())}else a.remove()}return n.addEventListener("decorate",r),{destroy(){n.removeEventListener("decorate",r)}}}}const Ty={keyboard:function(t){function e(e){if(e.defaultPrevented)return;const{typeset:{lines:n},doc:r}=t;let{selection:o}=r;if(!o)return;e.preventDefault();const[s,a]=o,c=s===a,u=r.getLineAt(o[0]),[l,f]=r.getLineRange(o[0]);let d,{id:h,...p}=u.attributes;const g=n.findByAttributes(p,!0),m=a===l,b=a===f-1;!i(u)||g===n.default||g.contained||g.defaultFollows||g.frozen||!c?(s===l&&a===f&&g.frozen?(d={dontFixNewline:!0},o=0===s?[s,s]:[a,a],p=g.nextLineAttributes?g.nextLineAttributes(p):by):b&&(g.nextLineAttributes||g.defaultFollows||g.frozen)?p=g.nextLineAttributes?g.nextLineAttributes(p):by:m&&!b&&(g.defaultFollows&&(p=by),d={dontFixNewline:!0}),t.insert("\n",p,o,d),s===l&&a===f&&g.frozen&&t.select(0===s?0:a)):t.formatLine(by)}function n(e,n){if(e.defaultPrevented)return;const{typeset:{lines:r},doc:o}=t,{selection:s}=o;if(!s)return;const[a,c]=s,u=a===c,[l,f]=o.getLineRange(a);if(u&&(!yy||e.ctrlKey||e.altKey||e.metaKey)){if(-1===n&&a!==l)return;if(1===n&&a!==f-1)return}if(e.preventDefault(),-1===n&&s[0]+s[1]===0)d(o.getLineAt(a),!0);else{const e=vm(s),c=o.getLineAt(e[0]),h=r.findByAttributes(c.attributes,!0);if(u&&(-1===n&&a===l||1===n&&a===f-1)&&!h.contained){if(-1===n&&d(o.getLineAt(a)))return;const r=o.lines[o.lines.indexOf(c)+n],[s,u]=1===n?[c,r]:[r,c];if(s&&i(s)&&u&&!i(u))return t.update(t.change.delete([e[0]+n,e[0]],{dontFixNewline:!0}),ay.input)}t.delete(n,{dontFixNewline:h.frozen})}function d(e,n){if(!e)return;const i=r.findByAttributes(e.attributes,!0);return i?i.indentable&&e.attributes.indent?(t.outdent(),!0):n||i!==r.default&&!i.defaultFollows?(t.formatLine(by),!0):void 0:void 0}}function r(r){var i;if(r.isComposing)return;!function(t){t.shortcut=my(t),t.osShortcut=`${hy?"mac":"win"}:${t.shortcut}`,t.modShortcut=t.shortcut.replace(py,"Mod")}(r);const o=e=>{const n=t.shortcuts[e];if(n&&t.commands[n])return r.preventDefault(),!1!==t.commands[n]()};if(!t.root.dispatchEvent(gy.fromKeyboardEvent(r))||o(r.shortcut)||o(r.osShortcut)||o(r.modShortcut))r.preventDefault();else{switch(r.modShortcut){case"Enter":return e(r);case"Shift+Enter":return function(n){if(n.defaultPrevented)return;const{typeset:r,doc:i}=t;if(!r.embeds.get("br"))return e(n);i.selection&&(n.preventDefault(),t.insert({br:!0}))}(r);case"Tab":case"Shift+Tab":case"Mod+]":case"Mod+[":return function(e){if(e.defaultPrevented)return;e.preventDefault();const n=e.modShortcut;"Tab"===n||"Mod+]"===n?t.indent():t.outdent()}(r)}switch(null===(i=r.modShortcut)||void 0===i?void 0:i.split("+").pop()){case"Backspace":return function(t){n(t,-1)}(r);case"Delete":return function(t){n(t,1)}(r);default:return}}}function i(e){var n;return 1===e.length&&!(null===(n=t.typeset.lines.findByAttributes(e.attributes))||void 0===n?void 0:n.frozen)}return{init(){t.root.addEventListener("keydown",r)},destroy(){t.root.removeEventListener("keydown",r)}}},input:function(t){let e=!1;function n(){const t=i.takeRecords();t.length&&r(t)}function r(n){if(!t.enabled)return t.render();let r=function(e){const n=function(t){const e=new Set;if(t=t.filter((t=>"characterData"!==t.type||!e.has(t.target)&&(e.add(t.target),!0))),t.length>3)return null;const n=t.find((t=>"characterData"===t.type));if(!n)return null;const r=t.find((t=>1===t.addedNodes.length&&"#text"===t.addedNodes[0].nodeName)),i=t.find((t=>1===t.addedNodes.length&&"BR"===t.addedNodes[0].nodeName||1===t.removedNodes.length&&"BR"===t.removedNodes[0].nodeName));return 1+(r?1:0)+(i?1:0)<t.length||r&&r.addedNodes[0]!==n.target?null:n}(e);if(!n||null==n.oldValue||null==n.target.nodeValue)return null;const r=new wm,i=ey(t,n.target);r.retain(i);let o;if(t.doc.selection){o=vm(t.doc.selection)[0]-i,o<0&&(o=0)}return sm(n.oldValue.replace(/\xA0/g," "),n.target.nodeValue.replace(/\xA0/g," "),o).forEach((([e,n])=>{e===sm.EQUAL?r.retain(n.length):e===sm.DELETE?r.delete(n.length):e===sm.INSERT&&r.insert(n,t.activeFormats)})),r.chop(),r}(n),i=oy(t);if(!r){const e=function(t,e){let n,r;for(let i=0;i<e.length;i++){const o=e[i];if(o.target===t)return;const s=fy(t,o.target);if(!s||!s.key)return;(!n||Eb(t,s)<Eb(t,n))&&(n=s),(!r||Eb(t,s)>Eb(t,r))&&(r=s)}if(n&&r)return[n,r]}(t.root,n);r=function(e){const{doc:n}=t;if(e){const[r,i]=e,o=Eb(t.root,r),s=xb(t.root,i),a=Zb(t,{startNode:r,endNode:i.nextElementSibling||void 0,collapseWhitespace:!1});let c=n.toDelta().slice(o,s).diff(a);return c.ops.length&&o&&(c=(new wm).retain(o).concat(c)),c}{const e=Zb(t,{collapseWhitespace:!1});return n.toDelta().diff(e)}}(e)}if(e&&(function(t){let e=!1;const n=t.ops[t.ops.length-1];n.insert&&n.insert.br&&(e=!0);return e}(r)&&(r.ops.pop(),r.insert("\n")),null!==i&&(i[0]++,i[1]++),e=!1),r&&r.ops.length){Wb(r);const e=t.doc;t.update(new Rm(t.doc,r,i,t.activeFormats),ay.input),t.doc.lines===e.lines&&t.render()}}const i=new window.MutationObserver(r);function o(){i.disconnect()}function s(){i.observe(t.root,ly)}function a(t){t.data&&t.data.includes("\n")&&(e=!0)}return{init(){t.root.addEventListener("input",n),t.on("rendering",o),t.on("render",s),uy&&t.root.addEventListener("beforeinput",a)},destroy(){i.disconnect(),t.root.removeEventListener("input",n),t.off("rendering",o),t.off("render",s),uy&&t.root.removeEventListener("beforeinput",a)}}},copy:function(t,e=_y){function n(n){if(!t.enabled||!t.doc.selection)return;n.preventDefault();const r=n.clipboardData,{doc:i}=t,{selection:o}=i;if(!i.selection)return;if(!r||!o)return;const s=vm(i.selection),a=i.slice(s[0],s[1]);if(!a.ops.length)return;const c=a.map((t=>"string"==typeof t.insert?t.insert:" ")).join("");if(e.copyHTML){let e;c.includes("\n")?(a.push({insert:"\n",attributes:i.getLineFormat(s[1])}),e=Hb(t,new Dm(a))):e=function(t,e){return Yb(Ib(t,e,!0))}(t,a),r.setData("text/html",e)}e.copyPlainText&&r.setData("text/plain",c)}function r(e){n(e),t.delete()}return{init(){t.root.addEventListener("copy",n),t.root.addEventListener("cut",r)},destroy(){t.root.removeEventListener("copy",n),t.root.removeEventListener("cut",r)}}},paste:function(t,e){function n(n){if(!t.enabled||!t.doc.selection)return;n.preventDefault();const r=n.clipboardData,{doc:i}=t,o=i.selection&&vm(i.selection);if(!r||!o)return;const[s,a]=o,c=r.getData("text/html"),u=r.getData("text/plain");let l;if(c)l=(null==e?void 0:e.htmlParser)?e.htmlParser(t,c):Kb(t,c,{possiblePartial:!0});else{if(!u)return;l=(new wm).insert(u)}const f=l.filter((t=>"string"==typeof t.insert&&t.insert.includes("\n"))).length>0;let d=l.length();if(f){let t=Sm.fromDelta(l,i.byId);l=Sm.toDelta(t),d=l.length();const e=i.getLineAt(s),n=i.getLineAt(a),r=xy(e),o=e===n?r:xy(n);c||(t=t.map((t=>({...t,attributes:e.attributes}))),r!==o&&(t[t.length-1].attributes=n.attributes));const u=t[0],f=xy(u),h=t[t.length-1],p=u===h?f:xy(h);s===i.getLineRange(e)[0]||zg(r,f,vy)||(l=(new wm).insert("\n",r).concat(l),d++);const g=l.ops[l.ops.length-1].insert,m="string"==typeof g&&g.endsWith("\n");m&&a!==i.getLineRange(n)[1]&&zg(o,p,vy)?l=l.slice(0,--d):m&&a===i.getLineRange(n)[1]-1&&(l.delete(1),d--)}const h=new Ey("paste",{delta:l,html:c,text:u,cancelable:!0});if(t.dispatchEvent(h),l=h.delta,!h.defaultPrevented)if(l&&l.ops.length){const e=t.change.delete(o,f?wy:void 0);e.insertContent(s,l).select(s+d),t.update(e,ay.paste)}else s!==a&&t.delete([s,a])}return{init(){t.root.addEventListener("paste",n)},destroy(){t.root.removeEventListener("paste",n)}}},history:cy,decorations:function(t){t.typeset.formats.add(cb),t.typeset.embeds.add(ub);const e=new Map;let n=t.doc,r=n,i=n,o=!1;function s(s){var a,c;if(!s)throw new TypeError("A decoration name is required");const u=e.get(s);if(!u)return!1;const l=hb(s,u,n);return e.delete(s),i=e.size?i.apply(l):n,o||(null===(a=t.modules.rendering)||void 0===a||a.render({old:r,doc:i}),null===(c=t.modules.selection)||void 0===c||c.renderSelection()),!0}function a(){e.size&&e.clear(),i=n}function c(s,a){var c,u;const l=e.get(s),f=l?l.compose(a,!0):a;zg(f,l)||!l&&!f.ops.length||(f.ops.length?e.set(s,f):e.delete(s),i=e.size?i.apply(a,null):n,o||(null===(c=t.modules.rendering)||void 0===c||c.render({old:r,doc:i}),null===(u=t.modules.selection)||void 0===u||u.renderSelection()))}function u(t){const{change:r,changedLines:o}=t;if(n=t.doc,r){if(r.contentChanged){for(let[t,n]of e)n=r.delta.transform(n,!0),n.ops.length?e.set(t,n):e.delete(t);i=e.size?i.apply(r.delta,null):n,e.size&&i.lines.forEach(((t,e)=>{const r=n.lines[e];t!==r&&t.id!==r.id&&(t.id=r.id)}))}}else a();l(r,o)}function l(e,i){const s={old:r,doc:n,change:e,changedLines:i};o=!0,t.dispatchEvent(new lb("decorate",s)),o=!1}function f(){r=i}return t.on("change",u),t.on("render",f),{get old(){return r},get doc(){return i},getDecorator:function(n){if(!n)throw new TypeError("A decoration name is required");const r=e.get(n);return new fb(n,t.doc,r,c,s)},removeDecorations:s,clearDecorations:a,gatherDecorations:l,init(){l()},destroy(){t.off("change",u),t.off("render",f)}}},rendering:function(t){function e(e){const{doc:n,old:r}=t.modules.decorations||e;r.lines!==n.lines&&Tb(t,r,n)}return t.on("change",e),{render:function(e){if(e){const{doc:n,old:r}=e;r&&n?Tb(t,r,n):n&&Ab(t,n)}else{const{doc:e}=t.modules.decorations||t;Ab(t,e)}},destroy(){t.off("change",e)}}},selection:function(t){let e,n,r=!1;function i(){if(!t.enabled)return;const e=oy(t);if(!e&&r)return;if(r&&(r=!1),e&&e[0]===e[1]&&t.doc.selection&&t.doc.selection[0]===e[0]&&t.doc.selection[1]===e[0]+1){const n=t.doc.getLineAt(e[0]);t.typeset.lines.findByAttributes(n.attributes,!0).frozen&&(e[0]--,e[1]--)}const{doc:n}=t;if(!zg(n.selection,e)){if(e&&e[0]===e[1]&&e[0]>=n.length)return;t.select(e)}}function o(){!r&&t.enabled&&sy(t,t.doc.selection)}function s(){const{doc:e,typeset:{lines:n}}=t,r=t.modules.decorations.getDecorator("selection");r.clear();const i=e.selection;i&&e.getLinesAt(i).forEach((t=>{if(n.findByAttributes(t.attributes,!0).frozen){const n=zg(i,e.getLineRange(t));r.decorateLine(e.getLineRange(t)[0],{class:"selected"+(n?" focus":"")})}})),r.apply()}function a(e){let n=e.target;for(;n.parentNode&&n.parentNode!==t.root;)n=n.parentNode;const r=Eb(t.root,n),i=null!=r&&t.doc.getLineAt(r),o=i&&t.typeset.lines.findByAttributes(i.attributes);null!=r&&i&&o&&o.frozen&&(e.preventDefault(),t.select([r,r+i.length]))}function c(e){var n;const r=(null===(n=e.doc)||void 0===n?void 0:n.selection)||t.doc.selection;sy(t,r)}function u(){t.root.classList.toggle("window-inactive",!e.hasFocus())}return{pause:function(){r=!0;const{selection:e}=t.doc,{decorations:n}=t.modules;if(e&&e[0]!==e[1]&&n){n.getDecorator("pausedSelection").decorateText(e,{class:"selected"}).apply()}},resume:function(){r=!1;const{decorations:e}=t.modules;e&&e.removeDecorations("pausedSelection"),setTimeout(o)},renderSelection:o,init(){e=t.root.ownerDocument,n=e.defaultView,e.addEventListener("selectionchange",i),n.addEventListener("focus",u),n.addEventListener("blur",u),t.root.addEventListener("mousedown",a),t.on("change",c),t.on("decorate",s)},destroy(){e.removeEventListener("selectionchange",i),n.removeEventListener("focus",u),n.removeEventListener("blur",u),t.root.removeEventListener("mousedown",a),t.off("change",c),t.off("decorate",s),r=!1,e=null,n=null}}}},Sy=()=>{},Ny=Lt({},Sy),By=Lt(new Dm,Sy),Iy=Lt(null,Sy),Oy=Lt(void 0,Sy);function Ry(e){const n=Uy($y(e)),r=Uy(ky(e)),i=Uy(Ly(e)),a=Uy(Py(e)),u=function(e){return function(e,n,r){const i=!Array.isArray(e),a=i?[e]:e,u=n.length<2;return Lt(r,(e=>{let r=!1;const l=[];let f=0,d=t;const h=()=>{if(f)return;d();const r=n(i?l[0]:l,e);u?e(r):d=s(r)?r:t},p=a.map(((t,e)=>c(t,(t=>{l[e]=t,f&=~(1<<e),r&&h()}),(()=>{f|=1<<e}))));return r=!0,h(),function(){o(p),d(),r=!1}}))}(e,(t=>!!t))}(i);return{active:n,doc:r,selection:i,root:a,focus:u,updateEditor:function(t){t!==e&&(e=t,n.set($y(e)),r.set(ky(e)),i.set(Ly(e)),a.set(Py(e)))}}}function $y(t){if(!t)return Ny;let e=t.getActive();return Lt(e,(n=>{const r=()=>{const r=t.getActive();zg(e,r)||n(e=r)};return t.on("changed",r),t.on("format",r),()=>{t.off("changed",r),t.off("format",r)}}))}function ky(t){return t?Lt(t.doc,(e=>{const n=()=>e(t.doc);return n(),t.on("changed",n),()=>t.off("changed",n)})):By}function Ly(t){return t?Lt(t.doc.selection,(e=>{const n=()=>e(t.doc.selection);return n(),t.on("changed",n),()=>t.off("changed",n)})):Iy}function Py(t){return t?Lt(t._root,(e=>{const n=()=>e(t._root);return n(),t.on("root",n),()=>t.off("root",n)})):Oy}function Uy(t){const e="subscribe"in t?u(t):t,{set:n,subscribe:r}=Pt(e);let i;function o(t){i&&i(),t&&(i=t.subscribe((t=>n(t))))}return"subscribe"in t&&o(t),{set:o,subscribe:r}}rb({name:"paragraph",selector:"p",commands:t=>()=>t.formatLine({}),shortcuts:"Mod+0",render:(t,e)=>Zm("p",null,e)}),rb({name:"header",selector:"h1, h2, h3, h4, h5, h6",defaultFollows:!0,commands:t=>({header:e=>t.toggleLineFormat({header:e}),header1:()=>t.toggleLineFormat({header:1}),header2:()=>t.toggleLineFormat({header:2}),header3:()=>t.toggleLineFormat({header:3}),header4:()=>t.toggleLineFormat({header:4}),header5:()=>t.toggleLineFormat({header:5}),header6:()=>t.toggleLineFormat({header:6})}),shortcuts:{"Mod+1":"header1","Mod+2":"header2","Mod+3":"header3","Mod+4":"header4","Mod+5":"header5","Mod+6":"header6"},fromDom:t=>({header:parseInt(t.nodeName.replace("H",""))}),render:(t,e)=>Zm(`h${t.header}`,null,e)}),rb({name:"list",selector:"ul > li, ol > li",indentable:!0,commands:t=>({bulletList:()=>t.toggleLineFormat({list:"bullet"}),orderedList:()=>t.toggleLineFormat({list:"ordered"}),checkList:()=>t.toggleLineFormat({list:"check"}),indent:()=>t.indent(),outdent:()=>t.outdent(),toggleCheck:e=>{const n="string"==typeof e?t.doc.getLineBy(e):t.doc.selection?t.doc.getLineAt(t.doc.selection[0]):null;if(!n)return!1;const[r]=t.doc.getLineRange(n),i={list:"check"};n.attributes.checked||(i.checked=!0),t.formatLine(i,r)}}),shortcuts:{"Mod+Space":"toggleCheck"},fromDom(t){let e=-1,n=t.parentNode;const r=t.hasAttribute("data-checked")?"check":n&&"OL"===n.nodeName?"ordered":"bullet";for(;n;){if(/^UL|OL$/.test(n.nodeName))e++;else if("LI"!==n.nodeName)break;n=n.parentNode}!e&&t.className.startsWith("ql-indent-")&&(e=parseInt(t.className.replace("ql-indent-","")));const i={list:r};return e&&(i.indent=e),"true"===t.getAttribute("data-checked")&&(i.checked=!0),i},nextLineAttributes(t){const{start:e,...n}=t;return n},shouldCombine:(t,e)=>t.list===e.list||e.indent,renderMultiple:(t,e,n)=>{const r=[],i=[];return t.forEach((([t,o,s])=>{const a="ordered"===t.list?"ol":"ul",c=t.indent||0;let u={key:s};if("check"===t.list){function f(t){e.enabled&&(t.preventDefault(),e.commands.toggleCheck(s))}const d=Zm("button",{class:"check-list-check",onmousedown:f,ontouchstart:f});1===o.length&&"br"===o[0].type?o.push(d):o.unshift(d),u={...u,class:"check-list-item","data-checked":""+(t.checked||!1)}}const l=db(Zm("li",u,o),t);for(;c>=i.length;){const h=Zm(a,{start:t.start,type:t.type,key:`${s}-outer`}),p=i.length?i[i.length-1].children:r,g=p[p.length-1];"object"==typeof g&&"li"===g.type&&n?g.children.push(h):p.push(h),i.push(h)}if(!function(t,e,n){return t.type===e&&(t.props.start===n.start||t.props.start&&!n.start)&&t.props.type===n.type}(i[c],a,t)){const m=Zm(a,{start:t.start,type:t.type});(c?i[c-1].children:r).push(m),i[c]=m}i[c].children.push(l),i.length=c+1})),r[0]}}),rb({name:"blockquote",selector:"blockquote p",commands:t=>(e=!0)=>{"string"!=typeof e&&(e=!0),t.toggleLineFormat({blockquote:e})},fromDom(t){const{className:e}=t.parentNode,n=e.match(/quote-(\S+)/);return{blockquote:n&&"true"!==n[1]&&n[1]||!0}},shouldCombine:(t,e)=>t.blockquote===e.blockquote,renderMultiple:t=>{const e=t[0][0].blockquote,n="string"==typeof e?{className:`quote-${e}`}:null,r=t.map((([t,e,n])=>Zm("p",{key:n},e)));return Zm("blockquote",n,r)}}),rb({name:"code-block",selector:"pre code",contained:!0,commands:t=>()=>t.toggleLineFormat({"code-block":!0}),renderMultiple:t=>{const e=[];return t.forEach((([t,n,r])=>{n.length&&"br"===n[n.length-1].type&&n.pop(),e.push(Zm("code",{key:r},n)),e.push("\n")})),Zm("pre",{spellcheck:!1},e)}}),rb({name:"hr",selector:"hr",frozen:!0,commands:t=>()=>{const{doc:e}=t,{selection:n}=e;if(!n)return;const r=vm(n),i=t.change.delete(r);if(r[0]===r[1]&&1===e.getLineAt(r[0]).length)i.insert(r[0],"\n",{...e.getLineFormat(r[0])}).formatLine(r[0],{hr:!0});else{const t=(new wm).insert("\n",e.getLineAt(r[0]).attributes).insert("\n",{hr:!0});i.insertContent(r[0],t),i.select(r[0]+2)}t.update(i)},render:()=>Zm("hr")}),ib({name:"bold",selector:"strong, b",styleSelector:'[style*="font-weight:bold"], [style*="font-weight: bold"]',commands:t=>()=>t.toggleTextFormat({bold:!0}),shortcuts:"Mod+B",render:(t,e)=>Zm("strong",null,e)}),ib({name:"italic",selector:"em, i",styleSelector:'[style*="font-style:italic"], [style*="font-style: italic"]',commands:t=>()=>t.toggleTextFormat({italic:!0}),shortcuts:"Mod+I",render:(t,e)=>Zm("em",null,e)}),ib({name:"code",selector:"code",commands:t=>()=>t.toggleTextFormat({code:!0}),render:(t,e)=>Zm("code",null,e)}),ib({name:"link",selector:"a[href]",greedy:!1,commands:t=>e=>t.toggleTextFormat({link:e}),fromDom:t=>t.href,render:(t,e)=>Zm("a",{href:t.link,target:"_blank"},e)}),ob({name:"image",selector:"img",commands:t=>(e,n)=>t.insert({image:e,...n}),fromDom:t=>{const e={};return["src","alt","width","height"].forEach((n=>{if(!t.hasAttribute(n))return;const r=t.getAttribute(n);"src"===n&&(n="image"),e[n]=r})),e},render:t=>{const{image:e,...n}=t;return n.src=e,Zm("img",n)}}),ob({name:"br",selector:"br",commands:t=>()=>t.insert({br:!0}),render:()=>Zm("br")});const Dy={lines:["paragraph","header","list","blockquote","code-block","hr"],formats:["link","bold","italic","code"],embeds:["image","br"]},Cy={},Fy=[],My=["focus","blur","keydown","mousedown","mouseup","click"],jy=new WeakMap;class qy extends Event{constructor(t,e){super(t,e),this.old=e.old,this.doc=e.doc,this.change=e.change,this.changedLines=e.changedLines,this.source=e.source,Object.setPrototypeOf(this,qy.prototype)}modify(t){if(!this.cancelable)throw new Error('Cannot modify an applied change, listen to the "changing" event');this.doc=this.doc.apply(t),this.change&&(this.change.delta=this.change.delta.compose(t)),this.changedLines&&(this.changedLines=this.old.lines===this.doc.lines?Fy:Ky(this.old,this.doc))}}class Vy extends Event{constructor(t,e){super(t,e),this.formats=e.formats}}class zy extends um{constructor(t={}){super(),this.activeFormats=Cy,this.commands={},this.shortcuts={},this.modules={},this.catchErrors=!t.dev,this.identifier=t.identifier,this.typeset=new nb(t.types||Dy),t.doc?this.doc=t.doc:t.html?this.doc=Gb(this,t.html):t.text?this.doc=new Dm((new wm).insert(t.text)):this.doc=new Dm,this.throwOnError=t.throwOnError||!1,this._enabled=void 0===t.enabled||t.enabled,this._modules={...Ty,...t.modules},t.root&&this.setRoot(t.root)}get root(){return this._root||this.setRoot(document.createElement("div")),this._root}get enabled(){return this._enabled}set enabled(t){t=!!t;const e=this._enabled!==t;!t&&this.doc.selection&&this.select(null,ay.api),this._enabled=t,this._root&&(this._root.contentEditable=t?"true":"inherit"),e&&this.dispatchEvent(new Event("enabledchange"))}get change(){const t=new Rm(this.doc);return t.apply=(e=ay.user)=>this.update(t,e),t}setRoot(t){if(!t)throw new TypeError("Root must be set, cannot be "+t);return this.destroy(),this._root=t,this.init(),this.dispatchEvent(new Event("root")),this}update(t,e=ay.user){if(!this.enabled&&e!==ay.api)return this;t instanceof wm&&(t=new Rm(this.doc,t));const n=this.doc,r=n.apply(t,void 0,this.throwOnError),i=n.lines===r.lines?Fy:Ky(n,r);return this.set(r,e,t,i),this}set(t,e=ay.user,n,r){const i=this.doc;if(t instanceof wm&&(t=new Dm(t)),!this.enabled&&e!==ay.api||!t||i.equals(t))return this;const o=new qy("changing",{cancelable:!0,old:i,doc:t,change:n,changedLines:r,source:e});return this.dispatchEvent(o,this.catchErrors),o.defaultPrevented||i.equals(o.doc)||(this.activeFormats=(null==n?void 0:n.activeFormats)?n.activeFormats:Gy(this,o.doc),this.doc=o.doc,this.dispatchEvent(new qy("change",{...o,cancelable:!1}),this.catchErrors),this.dispatchEvent(new qy("changed",{...o,cancelable:!1}),this.catchErrors)),this}getHTML(){return Hb(this,this.doc)}setHTML(t,e=this.doc.selection,n){return this.set(Gb(this,t,e))}getDelta(){return this.doc.toDelta()}setDelta(t,e=this.doc.selection,n){return this.set(new Dm(t,e),n)}getText(t){return this.doc.getText(t)}setText(t,e=this.doc.selection,n){return this.set(new Dm((new wm).insert(t),e),n)}getActive(){const{selection:t}=this.doc;let e=t?t[0]===t[1]?{...this.activeFormats,...this.doc.getLineFormat(t)}:{...this.doc.getFormats(t)}:{};return Object.values(this.modules).forEach((t=>{t.getActive&&(e={...e,...t.getActive()})})),e}select(t,e){return this.update(this.change.select(t),e)}insert(t,e,n=this.doc.selection,r){if(!n)return this;const i=zg(n,this.doc.selection);null==e&&"string"==typeof t&&"\n"!==t&&(e=i?this.activeFormats:Gy(this,this.doc,n));const o=this.typeset.lines.findByAttributes(e,!0),s=this.change.delete(n),a=vm(n)[0];if(i&&s.setActiveFormats("\n"!==t&&e||Gy(this,this.doc,n)),"\n"===t&&o.frozen){const t={...this.doc.getLineFormat(a)},n={...e};let r={...t};const i=(new wm).insert("\n",t);this.doc.getLineRange(a)[1]-1!==a?i.insert("\n",n):r=n,s.insertContent(a,i).formatLine(a,r).select(a+2)}else s.insert(a,t,e,r);return this.update(s)}insertContent(t,e=this.doc.selection){if(!e)return this;const n=this.change.delete(e).insertContent(e[0],t);return this.update(n)}delete(t,e){let n;if(Array.isArray(t))n=vm(t);else{if(!this.doc.selection)return this;n=vm(this.doc.selection),t&&n[0]===n[1]&&(n=t<0?[n[0]+t,n[1]]:[n[0],n[1]+t])}const r=Gy(this,this.doc,n),i=this.change.delete(n,e).select(n[0]).setActiveFormats(r);return this.update(i)}formatText(t,e=this.doc.selection){return e?("string"==typeof t&&(t={[t]:!0}),e[0]===e[1]?(this.activeFormats=gm.compose(this.activeFormats,t)||Cy,this.dispatchEvent(new Vy("format",{formats:this.activeFormats})),this):(Hy(this,"formatText",t,e),this)):this}toggleTextFormat(t,e=this.doc.selection){return e?("string"==typeof t&&(t={[t]:!0}),e[0]===e[1]?($m(t,this.activeFormats)&&(t=gm.invert(t)),this.activeFormats=gm.compose(this.activeFormats,t)||Cy,this.dispatchEvent(new Vy("format",{formats:this.activeFormats})),this):(Hy(this,"toggleTextFormat",t,e),this)):this}formatLine(t,e=this.doc.selection){return"string"==typeof t&&(t={[t]:!0}),Hy(this,"formatLine",t,e),this}toggleLineFormat(t,e=this.doc.selection){return"string"==typeof t&&(t={[t]:!0}),Hy(this,"toggleLineFormat",t,e),this}indent(){return Yy(this,1),this}outdent(){return Yy(this,-1),this}removeFormat(t=this.doc.selection){return Hy(this,"removeFormat",null,t),this}getBounds(t,e,n){var r;if("number"==typeof t&&(t=[t,t]),!t)return;let i=null===(r=Qb(this,t))||void 0===r?void 0:r.getBoundingClientRect();if(i&&e){const t=e.getBoundingClientRect(),r=(n?e.scrollLeft:0)-t.x,o=(n?e.scrollTop:0)-t.y;i=new DOMRect(i.x+r,i.y+o,i.width,i.height)}return i}getAllBounds(t,e,n){var r;"number"==typeof t&&(t=[t,t]);const i=null===(r=Qb(this,t))||void 0===r?void 0:r.getClientRects();let o=i&&Array.from(i);if(o&&e){const t=e.getBoundingClientRect(),r=(n?e.scrollLeft:0)-t.x,i=(n?e.scrollTop:0)-t.y;o=o.map((t=>new DOMRect(t.x+r,t.y+i,t.width,t.height)))}return o}getIndexFromPoint(t,e){return function(t,e,n){const r=t.root.ownerDocument;if("caretPositionFromPoint"in r)try{const i=r.caretPositionFromPoint(e,n);if(i)return ty(t,i.offsetNode,i.offset)}catch(t){}if(r.caretRangeFromPoint){const i=r.caretRangeFromPoint(e,n);if(i)return ty(t,i.startContainer,i.startOffset)}return null}(this,t,e)}render(){var t,e,n;return null===(t=this.modules.decorations)||void 0===t||t.gatherDecorations(),null===(e=this.modules.rendering)||void 0===e||e.render(),null===(n=this.modules.selection)||void 0===n||n.renderSelection(),this}init(){const t=this._root;t.editor&&t.editor.destroy(),t.editor=this,this.enabled=this._enabled,this.commands={},My.forEach((t=>this._root.addEventListener(t,Xy(this)))),this.typeset.lines.list.forEach((t=>t.commands&&Wy(this,t.name,t.commands(this)))),this.typeset.formats.list.forEach((t=>t.commands&&Wy(this,t.name,t.commands(this)))),this.typeset.embeds.list.forEach((t=>t.commands&&Wy(this,t.name,t.commands(this)))),Object.keys(this._modules).forEach((t=>{if(!this._modules[t])return;const e=this.modules[t]=this._modules[t](this);e.commands&&Wy(this,t,e.commands)})),this.shortcuts=function(t){const e={},{typeset:{lines:n,formats:r,embeds:i},modules:o}=t;return Qy(n,e),Qy(r,e),Qy(i,e),function(t,e){Object.keys(t).forEach((n=>{var r;const i=null===(r=t[n])||void 0===r?void 0:r.shortcuts;i&&tw(i,e)}))}(o,e),e}(this),Object.keys(this.modules).forEach((t=>{var e,n;return null===(n=(e=this.modules[t]).init)||void 0===n?void 0:n.call(e)})),this.render()}destroy(){const t=this._root;t&&(My.forEach((e=>t.removeEventListener(e,Xy(this)))),Object.values(this.modules).forEach((t=>t.destroy&&t.destroy())),this._root=void 0,delete t.editor)}}function Hy(t,e,n,r){if(!r)return;const i=t.change[e](r,n);t.update(i)}function Gy(t,e,n=e.selection){const{formats:r}=t.typeset;if(!n||0===n[0])return Cy;const i=vm(n)[0];let o=i;const s=e.getTextFormat(o),a={};return Object.keys(s).forEach((t=>{const n=r.get(t);n&&(!1!==n.greedy||e.getTextFormat(i)[t])&&(a[t]=s[t])})),a}function Ky(t,e){const n=new Set(t.lines);return e.lines.filter((t=>!n.has(t)))}function Wy(t,e,n){n&&("function"==typeof n?t.commands[e]=Zy(t,n):Object.keys(n).forEach((e=>t.commands[e]=Zy(t,n[e]))))}function Zy(t,e){return(...n)=>{e(...n),t.doc.selection&&t.root.focus()}}function Yy(t,e=1){const{typeset:{lines:n},doc:r}=t,{selection:i}=r;if(!i)return r;const o=t.change;r.getLinesAt(i).forEach((t=>{if(!n.findByAttributes(t.attributes,!0).indentable)return;const i=r.getLineRange(t);let s=(t.attributes.indent||0)+e;s<=0&&(s=null),o.formatLine(i[0],s<0?Cy:{...t.attributes,indent:s})})),t.update(o)}function Xy(t){let e=jy.get(t);return e||(e=Jy.bind(t),jy.set(t,e)),e}function Jy(t){this.dispatchEvent(t)}function Qy(t,e){t.list.forEach((t=>{const n=t.shortcuts;n&&("string"==typeof n?e[n]=t.name:tw(n,e))}))}function tw(t,e){Object.keys(t).forEach((n=>e[n]=t[n]))}const ew=t=>({}),nw=t=>({}),rw=t=>({}),iw=t=>({});function ow(t){let e,n,r,i,o,s,a;const c=t[1].title,u=f(c,t,t[0],iw),l=t[1].actions,d=f(l,t,t[0],nw);return{c(){e=R("div"),n=R("div"),n.innerHTML='<label for="my-drawer-3" class="btn btn-square btn-ghost"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-6 h-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></label>',r=L(),i=R("div"),u&&u.c(),o=L(),s=R("div"),d&&d.c(),D(n,"class","flex-none lg:hidden"),D(i,"class","flex-1 px-2 mx-2 font-bold text-lg"),D(e,"class","w-full navbar bg-base-100 border-b border-base-300")},m(t,c){B(t,e,c),T(e,n),T(e,r),T(e,i),u&&u.m(i,null),T(e,o),T(e,s),d&&d.m(s,null),a=!0},p(t,[e]){u&&u.p&&(!a||1&e)&&p(u,c,t,t[0],a?h(c,t[0],e,rw):g(t[0]),iw),d&&d.p&&(!a||1&e)&&p(d,l,t,t[0],a?h(l,t[0],e,ew):g(t[0]),nw)},i(t){a||(wt(u,t),wt(d,t),a=!0)},o(t){vt(u,t),vt(d,t),a=!1},d(t){t&&I(e),u&&u.d(t),d&&d.d(t)}}}function sw(t,e,n){let{$$slots:r={},$$scope:i}=e;return t.$$set=t=>{"$$scope"in t&&n(0,i=t.$$scope)},[i,r]}class aw extends $t{constructor(t){super(),Rt(this,t,sw,ow,a,{})}}function cw(t,e){function n(){e&&e.destroy()}return t.children.length&&e.set(function(t,e){return new Dm(Zb(t,{root:e}))}(e,t)),e&&e.setRoot(t),{update:function(r){e!==r&&(n(),r&&r.setRoot(t),e=r)},destroy:n}}var uw="top",lw="bottom",fw="right",dw="left",hw="auto",pw=[uw,lw,fw,dw],gw="start",mw="end",bw="clippingParents",yw="viewport",ww="popper",vw="reference",Ew=pw.reduce((function(t,e){return t.concat([e+"-"+gw,e+"-"+mw])}),[]),xw=[].concat(pw,[hw]).reduce((function(t,e){return t.concat([e,e+"-"+gw,e+"-"+mw])}),[]),_w=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function Aw(t){return t?(t.nodeName||"").toLowerCase():null}function Tw(t){if(null==t)return window;if("[object Window]"!==t.toString()){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Sw(t){return t instanceof Tw(t).Element||t instanceof Element}function Nw(t){return t instanceof Tw(t).HTMLElement||t instanceof HTMLElement}function Bw(t){return"undefined"!=typeof ShadowRoot&&(t instanceof Tw(t).ShadowRoot||t instanceof ShadowRoot)}var Iw={name:"applyStyles",enabled:!0,phase:"write",fn:function(t){var e=t.state;Object.keys(e.elements).forEach((function(t){var n=e.styles[t]||{},r=e.attributes[t]||{},i=e.elements[t];Nw(i)&&Aw(i)&&(Object.assign(i.style,n),Object.keys(r).forEach((function(t){var e=r[t];!1===e?i.removeAttribute(t):i.setAttribute(t,!0===e?"":e)})))}))},effect:function(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach((function(t){var r=e.elements[t],i=e.attributes[t]||{},o=Object.keys(e.styles.hasOwnProperty(t)?e.styles[t]:n[t]).reduce((function(t,e){return t[e]="",t}),{});Nw(r)&&Aw(r)&&(Object.assign(r.style,o),Object.keys(i).forEach((function(t){r.removeAttribute(t)})))}))}},requires:["computeStyles"]};function Ow(t){return t.split("-")[0]}var Rw=Math.max,$w=Math.min,kw=Math.round;function Lw(t,e){void 0===e&&(e=!1);var n=t.getBoundingClientRect(),r=1,i=1;if(Nw(t)&&e){var o=t.offsetHeight,s=t.offsetWidth;s>0&&(r=kw(n.width)/s||1),o>0&&(i=kw(n.height)/o||1)}return{width:n.width/r,height:n.height/i,top:n.top/i,right:n.right/r,bottom:n.bottom/i,left:n.left/r,x:n.left/r,y:n.top/i}}function Pw(t){var e=Lw(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function Uw(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Bw(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Dw(t){return Tw(t).getComputedStyle(t)}function Cw(t){return["table","td","th"].indexOf(Aw(t))>=0}function Fw(t){return((Sw(t)?t.ownerDocument:t.document)||window.document).documentElement}function Mw(t){return"html"===Aw(t)?t:t.assignedSlot||t.parentNode||(Bw(t)?t.host:null)||Fw(t)}function jw(t){return Nw(t)&&"fixed"!==Dw(t).position?t.offsetParent:null}function qw(t){for(var e=Tw(t),n=jw(t);n&&Cw(n)&&"static"===Dw(n).position;)n=jw(n);return n&&("html"===Aw(n)||"body"===Aw(n)&&"static"===Dw(n).position)?e:n||function(t){var e=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&Nw(t)&&"fixed"===Dw(t).position)return null;for(var n=Mw(t);Nw(n)&&["html","body"].indexOf(Aw(n))<0;){var r=Dw(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||e&&"filter"===r.willChange||e&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(t)||e}function Vw(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function zw(t,e,n){return Rw(t,$w(e,n))}function Hw(t){return Object.assign({},{top:0,right:0,bottom:0,left:0},t)}function Gw(t,e){return e.reduce((function(e,n){return e[n]=t,e}),{})}var Kw={name:"arrow",enabled:!0,phase:"main",fn:function(t){var e,n=t.state,r=t.name,i=t.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,a=Ow(n.placement),c=Vw(a),u=[dw,fw].indexOf(a)>=0?"height":"width";if(o&&s){var l=function(t,e){return Hw("number"!=typeof(t="function"==typeof t?t(Object.assign({},e.rects,{placement:e.placement})):t)?t:Gw(t,pw))}(i.padding,n),f=Pw(o),d="y"===c?uw:dw,h="y"===c?lw:fw,p=n.rects.reference[u]+n.rects.reference[c]-s[c]-n.rects.popper[u],g=s[c]-n.rects.reference[c],m=qw(o),b=m?"y"===c?m.clientHeight||0:m.clientWidth||0:0,y=p/2-g/2,w=l[d],v=b-f[u]-l[h],E=b/2-f[u]/2+y,x=zw(w,E,v),_=c;n.modifiersData[r]=((e={})[_]=x,e.centerOffset=x-E,e)}},effect:function(t){var e=t.state,n=t.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=e.elements.popper.querySelector(r)))&&("production"!==process.env.NODE_ENV&&(Nw(r)||console.error(['Popper: "arrow" element must be an HTMLElement (not an SVGElement).',"To use an SVG arrow, wrap it in an HTMLElement that will be used as","the arrow."].join(" "))),Uw(e.elements.popper,r)?e.elements.arrow=r:"production"!==process.env.NODE_ENV&&console.error(['Popper: "arrow" modifier\'s `element` must be a child of the popper',"element."].join(" ")))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ww(t){return t.split("-")[1]}var Zw={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Yw(t){var e,n=t.popper,r=t.popperRect,i=t.placement,o=t.variation,s=t.offsets,a=t.position,c=t.gpuAcceleration,u=t.adaptive,l=t.roundOffsets,f=t.isFixed,d=s.x,h=void 0===d?0:d,p=s.y,g=void 0===p?0:p,m="function"==typeof l?l({x:h,y:g}):{x:h,y:g};h=m.x,g=m.y;var b=s.hasOwnProperty("x"),y=s.hasOwnProperty("y"),w=dw,v=uw,E=window;if(u){var x=qw(n),_="clientHeight",A="clientWidth";if(x===Tw(n)&&"static"!==Dw(x=Fw(n)).position&&"absolute"===a&&(_="scrollHeight",A="scrollWidth"),i===uw||(i===dw||i===fw)&&o===mw)v=lw,g-=(f&&E.visualViewport?E.visualViewport.height:x[_])-r.height,g*=c?1:-1;if(i===dw||(i===uw||i===lw)&&o===mw)w=fw,h-=(f&&E.visualViewport?E.visualViewport.width:x[A])-r.width,h*=c?1:-1}var T,S=Object.assign({position:a},u&&Zw),N=!0===l?function(t){var e=t.x,n=t.y,r=window.devicePixelRatio||1;return{x:kw(e*r)/r||0,y:kw(n*r)/r||0}}({x:h,y:g}):{x:h,y:g};return h=N.x,g=N.y,c?Object.assign({},S,((T={})[v]=y?"0":"",T[w]=b?"0":"",T.transform=(E.devicePixelRatio||1)<=1?"translate("+h+"px, "+g+"px)":"translate3d("+h+"px, "+g+"px, 0)",T)):Object.assign({},S,((e={})[v]=y?g+"px":"",e[w]=b?h+"px":"",e.transform="",e))}var Xw={passive:!0};var Jw={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,o=void 0===i||i,s=r.resize,a=void 0===s||s,c=Tw(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&u.forEach((function(t){t.addEventListener("scroll",n.update,Xw)})),a&&c.addEventListener("resize",n.update,Xw),function(){o&&u.forEach((function(t){t.removeEventListener("scroll",n.update,Xw)})),a&&c.removeEventListener("resize",n.update,Xw)}},data:{}},Qw={left:"right",right:"left",bottom:"top",top:"bottom"};function tv(t){return t.replace(/left|right|bottom|top/g,(function(t){return Qw[t]}))}var ev={start:"end",end:"start"};function nv(t){return t.replace(/start|end/g,(function(t){return ev[t]}))}function rv(t){var e=Tw(t);return{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function iv(t){return Lw(Fw(t)).left+rv(t).scrollLeft}function ov(t){var e=Dw(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function sv(t){return["html","body","#document"].indexOf(Aw(t))>=0?t.ownerDocument.body:Nw(t)&&ov(t)?t:sv(Mw(t))}function av(t,e){var n;void 0===e&&(e=[]);var r=sv(t),i=r===(null==(n=t.ownerDocument)?void 0:n.body),o=Tw(r),s=i?[o].concat(o.visualViewport||[],ov(r)?r:[]):r,a=e.concat(s);return i?a:a.concat(av(Mw(s)))}function cv(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function uv(t,e){return e===yw?cv(function(t){var e=Tw(t),n=Fw(t),r=e.visualViewport,i=n.clientWidth,o=n.clientHeight,s=0,a=0;return r&&(i=r.width,o=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(s=r.offsetLeft,a=r.offsetTop)),{width:i,height:o,x:s+iv(t),y:a}}(t)):Sw(e)?function(t){var e=Lw(t);return e.top=e.top+t.clientTop,e.left=e.left+t.clientLeft,e.bottom=e.top+t.clientHeight,e.right=e.left+t.clientWidth,e.width=t.clientWidth,e.height=t.clientHeight,e.x=e.left,e.y=e.top,e}(e):cv(function(t){var e,n=Fw(t),r=rv(t),i=null==(e=t.ownerDocument)?void 0:e.body,o=Rw(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Rw(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+iv(t),c=-r.scrollTop;return"rtl"===Dw(i||n).direction&&(a+=Rw(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:a,y:c}}(Fw(t)))}function lv(t,e,n){var r="clippingParents"===e?function(t){var e=av(Mw(t)),n=["absolute","fixed"].indexOf(Dw(t).position)>=0&&Nw(t)?qw(t):t;return Sw(n)?e.filter((function(t){return Sw(t)&&Uw(t,n)&&"body"!==Aw(t)})):[]}(t):[].concat(e),i=[].concat(r,[n]),o=i[0],s=i.reduce((function(e,n){var r=uv(t,n);return e.top=Rw(r.top,e.top),e.right=$w(r.right,e.right),e.bottom=$w(r.bottom,e.bottom),e.left=Rw(r.left,e.left),e}),uv(t,o));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function fv(t){var e,n=t.reference,r=t.element,i=t.placement,o=i?Ow(i):null,s=i?Ww(i):null,a=n.x+n.width/2-r.width/2,c=n.y+n.height/2-r.height/2;switch(o){case uw:e={x:a,y:n.y-r.height};break;case lw:e={x:a,y:n.y+n.height};break;case fw:e={x:n.x+n.width,y:c};break;case dw:e={x:n.x-r.width,y:c};break;default:e={x:n.x,y:n.y}}var u=o?Vw(o):null;if(null!=u){var l="y"===u?"height":"width";switch(s){case gw:e[u]=e[u]-(n[l]/2-r[l]/2);break;case mw:e[u]=e[u]+(n[l]/2-r[l]/2)}}return e}function dv(t,e){void 0===e&&(e={});var n=e,r=n.placement,i=void 0===r?t.placement:r,o=n.boundary,s=void 0===o?bw:o,a=n.rootBoundary,c=void 0===a?yw:a,u=n.elementContext,l=void 0===u?ww:u,f=n.altBoundary,d=void 0!==f&&f,h=n.padding,p=void 0===h?0:h,g=Hw("number"!=typeof p?p:Gw(p,pw)),m=l===ww?vw:ww,b=t.rects.popper,y=t.elements[d?m:l],w=lv(Sw(y)?y:y.contextElement||Fw(t.elements.popper),s,c),v=Lw(t.elements.reference),E=fv({reference:v,element:b,strategy:"absolute",placement:i}),x=cv(Object.assign({},b,E)),_=l===ww?x:v,A={top:w.top-_.top+g.top,bottom:_.bottom-w.bottom+g.bottom,left:w.left-_.left+g.left,right:_.right-w.right+g.right},T=t.modifiersData.offset;if(l===ww&&T){var S=T[i];Object.keys(A).forEach((function(t){var e=[fw,lw].indexOf(t)>=0?1:-1,n=[uw,lw].indexOf(t)>=0?"y":"x";A[t]+=S[n]*e}))}return A}function hv(t,e){void 0===e&&(e={});var n=e,r=n.placement,i=n.boundary,o=n.rootBoundary,s=n.padding,a=n.flipVariations,c=n.allowedAutoPlacements,u=void 0===c?xw:c,l=Ww(r),f=l?a?Ew:Ew.filter((function(t){return Ww(t)===l})):pw,d=f.filter((function(t){return u.indexOf(t)>=0}));0===d.length&&(d=f,"production"!==process.env.NODE_ENV&&console.error(["Popper: The `allowedAutoPlacements` option did not allow any","placements. Ensure the `placement` option matches the variation","of the allowed placements.",'For example, "auto" cannot be used to allow "bottom-start".','Use "auto-start" instead.'].join(" ")));var h=d.reduce((function(e,n){return e[n]=dv(t,{placement:n,boundary:i,rootBoundary:o,padding:s})[Ow(n)],e}),{});return Object.keys(h).sort((function(t,e){return h[t]-h[e]}))}var pv={name:"flip",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,o=void 0===i||i,s=n.altAxis,a=void 0===s||s,c=n.fallbackPlacements,u=n.padding,l=n.boundary,f=n.rootBoundary,d=n.altBoundary,h=n.flipVariations,p=void 0===h||h,g=n.allowedAutoPlacements,m=e.options.placement,b=Ow(m),y=c||(b===m||!p?[tv(m)]:function(t){if(Ow(t)===hw)return[];var e=tv(t);return[nv(t),e,nv(e)]}(m)),w=[m].concat(y).reduce((function(t,n){return t.concat(Ow(n)===hw?hv(e,{placement:n,boundary:l,rootBoundary:f,padding:u,flipVariations:p,allowedAutoPlacements:g}):n)}),[]),v=e.rects.reference,E=e.rects.popper,x=new Map,_=!0,A=w[0],T=0;T<w.length;T++){var S=w[T],N=Ow(S),B=Ww(S)===gw,I=[uw,lw].indexOf(N)>=0,O=I?"width":"height",R=dv(e,{placement:S,boundary:l,rootBoundary:f,altBoundary:d,padding:u}),$=I?B?fw:dw:B?lw:uw;v[O]>E[O]&&($=tv($));var k=tv($),L=[];if(o&&L.push(R[N]<=0),a&&L.push(R[$]<=0,R[k]<=0),L.every((function(t){return t}))){A=S,_=!1;break}x.set(S,L)}if(_)for(var P=function(t){var e=w.find((function(e){var n=x.get(e);if(n)return n.slice(0,t).every((function(t){return t}))}));if(e)return A=e,"break"},U=p?3:1;U>0;U--){if("break"===P(U))break}e.placement!==A&&(e.modifiersData[r]._skip=!0,e.placement=A,e.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function gv(t,e,n){return void 0===n&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function mv(t){return[uw,fw,lw,dw].some((function(e){return t[e]>=0}))}var bv={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(t){var e=t.state,n=t.options,r=t.name,i=n.offset,o=void 0===i?[0,0]:i,s=xw.reduce((function(t,n){return t[n]=function(t,e,n){var r=Ow(t),i=[dw,uw].indexOf(r)>=0?-1:1,o="function"==typeof n?n(Object.assign({},e,{placement:t})):n,s=o[0],a=o[1];return s=s||0,a=(a||0)*i,[dw,fw].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}(n,e.rects,o),t}),{}),a=s[e.placement],c=a.x,u=a.y;null!=e.modifiersData.popperOffsets&&(e.modifiersData.popperOffsets.x+=c,e.modifiersData.popperOffsets.y+=u),e.modifiersData[r]=s}};var yv={name:"preventOverflow",enabled:!0,phase:"main",fn:function(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,o=void 0===i||i,s=n.altAxis,a=void 0!==s&&s,c=n.boundary,u=n.rootBoundary,l=n.altBoundary,f=n.padding,d=n.tether,h=void 0===d||d,p=n.tetherOffset,g=void 0===p?0:p,m=dv(e,{boundary:c,rootBoundary:u,padding:f,altBoundary:l}),b=Ow(e.placement),y=Ww(e.placement),w=!y,v=Vw(b),E="x"===v?"y":"x",x=e.modifiersData.popperOffsets,_=e.rects.reference,A=e.rects.popper,T="function"==typeof g?g(Object.assign({},e.rects,{placement:e.placement})):g,S="number"==typeof T?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),N=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,B={x:0,y:0};if(x){if(o){var I,O="y"===v?uw:dw,R="y"===v?lw:fw,$="y"===v?"height":"width",k=x[v],L=k+m[O],P=k-m[R],U=h?-A[$]/2:0,D=y===gw?_[$]:A[$],C=y===gw?-A[$]:-_[$],F=e.elements.arrow,M=h&&F?Pw(F):{width:0,height:0},j=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},q=j[O],V=j[R],z=zw(0,_[$],M[$]),H=w?_[$]/2-U-z-q-S.mainAxis:D-z-q-S.mainAxis,G=w?-_[$]/2+U+z+V+S.mainAxis:C+z+V+S.mainAxis,K=e.elements.arrow&&qw(e.elements.arrow),W=K?"y"===v?K.clientTop||0:K.clientLeft||0:0,Z=null!=(I=null==N?void 0:N[v])?I:0,Y=k+G-Z,X=zw(h?$w(L,k+H-Z-W):L,k,h?Rw(P,Y):P);x[v]=X,B[v]=X-k}if(a){var J,Q="x"===v?uw:dw,tt="x"===v?lw:fw,et=x[E],nt="y"===E?"height":"width",rt=et+m[Q],it=et-m[tt],ot=-1!==[uw,dw].indexOf(b),st=null!=(J=null==N?void 0:N[E])?J:0,at=ot?rt:et-_[nt]-A[nt]-st+S.altAxis,ct=ot?et+_[nt]+A[nt]-st-S.altAxis:it,ut=h&&ot?function(t,e,n){var r=zw(t,e,n);return r>n?n:r}(at,et,ct):zw(h?at:rt,et,h?ct:it);x[E]=ut,B[E]=ut-et}e.modifiersData[r]=B}},requiresIfExists:["offset"]};function wv(t,e,n){void 0===n&&(n=!1);var r,i=Nw(e),o=Nw(e)&&function(t){var e=t.getBoundingClientRect(),n=kw(e.width)/t.offsetWidth||1,r=kw(e.height)/t.offsetHeight||1;return 1!==n||1!==r}(e),s=Fw(e),a=Lw(t,o),c={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!n)&&(("body"!==Aw(e)||ov(s))&&(c=(r=e)!==Tw(r)&&Nw(r)?function(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}(r):rv(r)),Nw(e)?((u=Lw(e,!0)).x+=e.clientLeft,u.y+=e.clientTop):s&&(u.x=iv(s))),{x:a.left+c.scrollLeft-u.x,y:a.top+c.scrollTop-u.y,width:a.width,height:a.height}}function vv(t){var e=new Map,n=new Set,r=[];function i(t){n.add(t.name),[].concat(t.requires||[],t.requiresIfExists||[]).forEach((function(t){if(!n.has(t)){var r=e.get(t);r&&i(r)}})),r.push(t)}return t.forEach((function(t){e.set(t.name,t)})),t.forEach((function(t){n.has(t.name)||i(t)})),r}function Ev(t){var e;return function(){return e||(e=new Promise((function(n){Promise.resolve().then((function(){e=void 0,n(t())}))}))),e}}function xv(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return[].concat(n).reduce((function(t,e){return t.replace(/%s/,e)}),t)}var _v='Popper: modifier "%s" provided an invalid %s property, expected %s but got %s',Av='Popper: modifier "%s" requires "%s", but "%s" modifier is not available',Tv=["name","enabled","phase","fn","effect","requires","options"];var Sv="Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.",Nv={placement:"bottom",modifiers:[],strategy:"absolute"};function Bv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some((function(t){return!(t&&"function"==typeof t.getBoundingClientRect)}))}function Iv(t){void 0===t&&(t={});var e=t,n=e.defaultModifiers,r=void 0===n?[]:n,i=e.defaultOptions,o=void 0===i?Nv:i;return function(t,e,n){void 0===n&&(n=o);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},Nv,o),modifiersData:{},elements:{reference:t,popper:e},attributes:{},styles:{}},s=[],a=!1,c={state:i,setOptions:function(n){var a="function"==typeof n?n(i.options):n;u(),i.options=Object.assign({},o,i.options,a),i.scrollParents={reference:Sw(t)?av(t):t.contextElement?av(t.contextElement):[],popper:av(e)};var l=function(t){var e=vv(t);return _w.reduce((function(t,n){return t.concat(e.filter((function(t){return t.phase===n})))}),[])}(function(t){var e=t.reduce((function(t,e){var n=t[e.name];return t[e.name]=n?Object.assign({},n,e,{options:Object.assign({},n.options,e.options),data:Object.assign({},n.data,e.data)}):e,t}),{});return Object.keys(e).map((function(t){return e[t]}))}([].concat(r,i.options.modifiers)));if(i.orderedModifiers=l.filter((function(t){return t.enabled})),"production"!==process.env.NODE_ENV){var f=function(t,e){var n=new Set;return t.filter((function(t){var r=e(t);if(!n.has(r))return n.add(r),!0}))}([].concat(l,i.options.modifiers),(function(t){return t.name}));if(function(t){t.forEach((function(e){[].concat(Object.keys(e),Tv).filter((function(t,e,n){return n.indexOf(t)===e})).forEach((function(n){switch(n){case"name":"string"!=typeof e.name&&console.error(xv(_v,String(e.name),'"name"','"string"','"'+String(e.name)+'"'));break;case"enabled":"boolean"!=typeof e.enabled&&console.error(xv(_v,e.name,'"enabled"','"boolean"','"'+String(e.enabled)+'"'));break;case"phase":_w.indexOf(e.phase)<0&&console.error(xv(_v,e.name,'"phase"',"either "+_w.join(", "),'"'+String(e.phase)+'"'));break;case"fn":"function"!=typeof e.fn&&console.error(xv(_v,e.name,'"fn"','"function"','"'+String(e.fn)+'"'));break;case"effect":null!=e.effect&&"function"!=typeof e.effect&&console.error(xv(_v,e.name,'"effect"','"function"','"'+String(e.fn)+'"'));break;case"requires":null==e.requires||Array.isArray(e.requires)||console.error(xv(_v,e.name,'"requires"','"array"','"'+String(e.requires)+'"'));break;case"requiresIfExists":Array.isArray(e.requiresIfExists)||console.error(xv(_v,e.name,'"requiresIfExists"','"array"','"'+String(e.requiresIfExists)+'"'));break;case"options":case"data":break;default:console.error('PopperJS: an invalid property has been provided to the "'+e.name+'" modifier, valid properties are '+Tv.map((function(t){return'"'+t+'"'})).join(", ")+'; but "'+n+'" was provided.')}e.requires&&e.requires.forEach((function(n){null==t.find((function(t){return t.name===n}))&&console.error(xv(Av,String(e.name),n,n))}))}))}))}(f),Ow(i.options.placement)===hw)i.orderedModifiers.find((function(t){return"flip"===t.name}))||console.error(['Popper: "auto" placements require the "flip" modifier be',"present and enabled to work."].join(" "));var d=Dw(e);[d.marginTop,d.marginRight,d.marginBottom,d.marginLeft].some((function(t){return parseFloat(t)}))&&console.warn(['Popper: CSS "margin" styles cannot be used to apply padding',"between the popper and its reference element or boundary.","To replicate margin, use the `offset` modifier, as well as","the `padding` option in the `preventOverflow` and `flip`","modifiers."].join(" "))}return i.orderedModifiers.forEach((function(t){var e=t.name,n=t.options,r=void 0===n?{}:n,o=t.effect;if("function"==typeof o){var a=o({state:i,name:e,instance:c,options:r}),u=function(){};s.push(a||u)}})),c.update()},forceUpdate:function(){if(!a){var t=i.elements,e=t.reference,n=t.popper;if(Bv(e,n)){i.rects={reference:wv(e,qw(n),"fixed"===i.options.strategy),popper:Pw(n)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach((function(t){return i.modifiersData[t.name]=Object.assign({},t.data)}));for(var r=0,o=0;o<i.orderedModifiers.length;o++){if("production"!==process.env.NODE_ENV&&(r+=1)>100){console.error("Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.");break}if(!0!==i.reset){var s=i.orderedModifiers[o],u=s.fn,l=s.options,f=void 0===l?{}:l,d=s.name;"function"==typeof u&&(i=u({state:i,options:f,name:d,instance:c})||i)}else i.reset=!1,o=-1}}else"production"!==process.env.NODE_ENV&&console.error(Sv)}},update:Ev((function(){return new Promise((function(t){c.forceUpdate(),t(i)}))})),destroy:function(){u(),a=!0}};if(!Bv(t,e))return"production"!==process.env.NODE_ENV&&console.error(Sv),c;function u(){s.forEach((function(t){return t()})),s=[]}return c.setOptions(n).then((function(t){!a&&n.onFirstUpdate&&n.onFirstUpdate(t)})),c}}var Ov=Iv({defaultModifiers:[Jw,{name:"popperOffsets",enabled:!0,phase:"read",fn:function(t){var e=t.state,n=t.name;e.modifiersData[n]=fv({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=void 0===r||r,o=n.adaptive,s=void 0===o||o,a=n.roundOffsets,c=void 0===a||a;if("production"!==process.env.NODE_ENV){var u=Dw(e.elements.popper).transitionProperty||"";s&&["transform","top","right","bottom","left"].some((function(t){return u.indexOf(t)>=0}))&&console.warn(["Popper: Detected CSS transitions on at least one of the following",'CSS properties: "transform", "top", "right", "bottom", "left".',"\n\n",'Disable the "computeStyles" modifier\'s `adaptive` option to allow',"for smooth transitions, or remove these properties from the CSS","transition declaration on the popper element if only transitioning","opacity or background-color for example.","\n\n","We recommend using the popper element as a wrapper around an inner","element that can have any CSS property transitioned for animations."].join(" "))}var l={placement:Ow(e.placement),variation:Ww(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:"fixed"===e.options.strategy};null!=e.modifiersData.popperOffsets&&(e.styles.popper=Object.assign({},e.styles.popper,Yw(Object.assign({},l,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:c})))),null!=e.modifiersData.arrow&&(e.styles.arrow=Object.assign({},e.styles.arrow,Yw(Object.assign({},l,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})},data:{}},Iw,bv,pv,yv,Kw,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(t){var e=t.state,n=t.name,r=e.rects.reference,i=e.rects.popper,o=e.modifiersData.preventOverflow,s=dv(e,{elementContext:"reference"}),a=dv(e,{altBoundary:!0}),c=gv(s,r),u=gv(a,i,o),l=mv(c),f=mv(u);e.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:u,isReferenceHidden:l,hasPopperEscaped:f},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":l,"data-popper-escaped":f})}}]});const Rv=-1e5,$v={left:Rv,right:Rv,top:Rv,bottom:Rv,width:0,height:0},kv=t=>({commands:1&t[0],active:32&t[0],selection:16&t[0],focus:64&t[0],placement:8&t[0]}),Lv=t=>({commands:t[0].commands,active:t[5],selection:t[4],focus:t[6],placement:t[3]});function Pv(t){let e,n,r,i;const s=t[24].default,a=f(s,t,t[23],Lv);return{c(){e=R("div"),a&&a.c(),D(e,"class",t[1])},m(o,s){B(o,e,s),a&&a.m(e,null),t[25](e),n=!0,r||(i=[U(e,"focusin",t[12]),U(e,"focusout",t[13])],r=!0)},p(t,r){a&&a.p&&(!n||8388729&r[0])&&p(a,s,t,t[23],n?h(s,t[23],r,kv):g(t[23]),Lv),(!n||2&r[0])&&D(e,"class",t[1])},i(t){n||(wt(a,t),n=!0)},o(t){vt(a,t),n=!1},d(n){n&&I(e),a&&a.d(n),t[25](null),r=!1,o(i)}}}function Uv(t){let e,n,r=t[4]&&t[4][0]!==t[4][1]&&Pv(t);return{c(){r&&r.c(),e=P()},m(t,i){r&&r.m(t,i),B(t,e,i),n=!0},p(t,n){t[4]&&t[4][0]!==t[4][1]?r?(r.p(t,n),16&n[0]&&wt(r,1)):(r=Pv(t),r.c(),wt(r,1),r.m(e.parentNode,e)):r&&(bt(),vt(r,1,1,(()=>{r=null})),yt())},i(t){n||(wt(r),n=!0)},o(t){vt(r),n=!1},d(t){r&&r.d(t),t&&I(e)}}}function Dv(t,e,n){let r,i,o,s,a,c,u,f,d,h,{$$slots:p={},$$scope:g}=e,{editor:m}=e,{class:b="bubble-menu"}=e,{offset:y=0}=e,{padding:w=4}=e,{for:v}=e,{placement:E="top"}=e,x=!1,_=!1,A=E;const{active:T,doc:S,selection:N,focus:B,root:I,updateEditor:O}=Ry(m);function R(){if(!x)if(u)if(f)f.update();else{const t={getBoundingClientRect:()=>m.getBounds(r)||$v,contextElement:m.root};f=Ov(t,u,{placement:E,modifiers:[{name:"arrow",options:{element:"[data-arrow]"}},{name:"computeStyles",options:{adaptive:!1}},{name:"offset",options:{offset:[0,y]}},{name:"preventOverflow",options:{padding:w}},{name:"dataOutput",enabled:!0,phase:"write",fn({state:t}){n(3,A=t.placement.split("-")[0])}}]}),requestAnimationFrame((()=>u&&u.classList.add("active")))}else f&&!_&&(f.destroy(),f=null)}function $(){n(18,x=!0)}function k(){n(18,x=!1),R()}function L(t){d&&(d.removeEventListener("mousedown",$),(h||d).removeEventListener("mouseup",k)),d=t,h=t&&t.ownerDocument,d&&(d.addEventListener("mousedown",$),(h||d).addEventListener("mouseup",k))}function P(){_&&(m.modules.selection.resume(),n(19,_=!1))}return l(t,T,(t=>n(5,a=t))),l(t,S,(t=>n(21,o=t))),l(t,N,(t=>n(22,s=t))),l(t,B,(t=>n(6,c=t))),l(t,I,(t=>n(20,i=t))),Q((()=>{L(),P(),f&&f.destroy()})),t.$$set=t=>{"editor"in t&&n(0,m=t.editor),"class"in t&&n(1,b=t.class),"offset"in t&&n(14,y=t.offset),"padding"in t&&n(15,w=t.padding),"for"in t&&n(16,v=t.for),"placement"in t&&n(17,E=t.placement),"$$scope"in t&&n(23,g=t.$$scope)},t.$$.update=()=>{1&t.$$.dirty[0]&&O(m),4980736&t.$$.dirty[0]&&n(4,r=function(t,e,n){let i;if(n&&n[0]===n[1]-1){const t=m.doc.getLineAt(n[0]),e=m.typeset.lines.findByAttributes(t.attributes,!0);e.frozen&&(i=e.name)}return i!=v&&(n=null),t||e?r:n}(x,_,s)),2097156&t.$$.dirty[0]&&R(),1048576&t.$$.dirty[0]&&L(i)},[m,b,u,A,r,a,c,T,S,N,B,I,function(t){_||"BUTTON"===t.target.nodeName||(m.modules.selection.pause(),n(19,_=!0))},P,y,w,v,E,x,_,i,o,s,g,p,function(t){nt[t?"unshift":"push"]((()=>{u=t,n(2,u)}))}]}class Cv extends $t{constructor(t){super(),Rt(this,t,Dv,Uv,a,{editor:0,class:1,offset:14,padding:15,for:16,placement:17},null,[-1,-1])}}function Fv(t){let e,n;return{c(){e=$("title"),n=k(t[0])},m(t,r){B(t,e,r),T(e,n)},p(t,e){1&e&&C(n,t[0])},d(t){t&&I(e)}}}function Mv(t){let e,n,r,i=t[0]&&Fv(t);const o=t[3].default,s=f(o,t,t[2],null);return{c(){e=$("svg"),i&&i.c(),n=P(),s&&s.c(),D(e,"xmlns","http://www.w3.org/2000/svg"),D(e,"viewBox",t[1]),D(e,"class","svelte-3h8371")},m(t,o){B(t,e,o),i&&i.m(e,null),T(e,n),s&&s.m(e,null),r=!0},p(t,[a]){t[0]?i?i.p(t,a):(i=Fv(t),i.c(),i.m(e,n)):i&&(i.d(1),i=null),s&&s.p&&(!r||4&a)&&p(s,o,t,t[2],r?h(o,t[2],a,null):g(t[2]),null),(!r||2&a)&&D(e,"viewBox",t[1])},i(t){r||(wt(s,t),r=!0)},o(t){vt(s,t),r=!1},d(t){t&&I(e),i&&i.d(),s&&s.d(t)}}}function jv(t,e,n){let{$$slots:r={},$$scope:i}=e,{title:o=null}=e,{viewBox:s}=e;return t.$$set=t=>{"title"in t&&n(0,o=t.title),"viewBox"in t&&n(1,s=t.viewBox),"$$scope"in t&&n(2,i=t.$$scope)},[o,s,i,r]}class qv extends $t{constructor(t){super(),Rt(this,t,jv,Mv,a,{title:0,viewBox:1})}}function Vv(e){let n;return{c(){n=$("path"),D(n,"d","M448 96v320h32a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16H320a16 16 0 0 1-16-16v-32a16 16 0 0 1 16-16h32V288H160v128h32a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16H32a16 16 0 0 1-16-16v-32a16 16 0 0 1 16-16h32V96H32a16 16 0 0 1-16-16V48a16 16 0 0 1 16-16h160a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16h-32v128h192V96h-32a16 16 0 0 1-16-16V48a16 16 0 0 1 16-16h160a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16z")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function zv(t){let e,r;const i=[{viewBox:"0 0 512 512"},t[0]];let o={$$slots:{default:[Vv]},$$scope:{ctx:t}};for(let t=0;t<i.length;t+=1)o=n(o,i[t]);return e=new qv({props:o}),{c(){Nt(e.$$.fragment)},m(t,n){Bt(e,t,n),r=!0},p(t,[n]){const r=1&n?Tt(i,[i[0],St(t[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){r||(wt(e.$$.fragment,t),r=!0)},o(t){vt(e.$$.fragment,t),r=!1},d(t){It(e,t)}}}function Hv(t,e,r){return t.$$set=t=>{r(0,e=n(n({},e),m(t)))},[e=m(e)]}class Gv extends $t{constructor(t){super(),Rt(this,t,Hv,zv,a,{})}}function Kv(e){let n;return{c(){n=$("path"),D(n,"d","M333.49 238a122 122 0 0 0 27-65.21C367.87 96.49 308 32 233.42 32H34a16 16 0 0 0-16 16v48a16 16 0 0 0 16 16h31.87v288H34a16 16 0 0 0-16 16v48a16 16 0 0 0 16 16h209.32c70.8 0 134.14-51.75 141-122.4 4.74-48.45-16.39-92.06-50.83-119.6zM145.66 112h87.76a48 48 0 0 1 0 96h-87.76zm87.76 288h-87.76V288h87.76a56 56 0 0 1 0 112z")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function Wv(t){let e,r;const i=[{viewBox:"0 0 384 512"},t[0]];let o={$$slots:{default:[Kv]},$$scope:{ctx:t}};for(let t=0;t<i.length;t+=1)o=n(o,i[t]);return e=new qv({props:o}),{c(){Nt(e.$$.fragment)},m(t,n){Bt(e,t,n),r=!0},p(t,[n]){const r=1&n?Tt(i,[i[0],St(t[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){r||(wt(e.$$.fragment,t),r=!0)},o(t){vt(e.$$.fragment,t),r=!1},d(t){It(e,t)}}}function Zv(t,e,r){return t.$$set=t=>{r(0,e=n(n({},e),m(t)))},[e=m(e)]}class Yv extends $t{constructor(t){super(),Rt(this,t,Zv,Wv,a,{})}}function Xv(e){let n;return{c(){n=$("path"),D(n,"d","M320 48v32a16 16 0 0 1-16 16h-62.76l-80 320H208a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16H16a16 16 0 0 1-16-16v-32a16 16 0 0 1 16-16h62.76l80-320H112a16 16 0 0 1-16-16V48a16 16 0 0 1 16-16h192a16 16 0 0 1 16 16z")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function Jv(t){let e,r;const i=[{viewBox:"0 0 320 512"},t[0]];let o={$$slots:{default:[Xv]},$$scope:{ctx:t}};for(let t=0;t<i.length;t+=1)o=n(o,i[t]);return e=new qv({props:o}),{c(){Nt(e.$$.fragment)},m(t,n){Bt(e,t,n),r=!0},p(t,[n]){const r=1&n?Tt(i,[i[0],St(t[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){r||(wt(e.$$.fragment,t),r=!0)},o(t){vt(e.$$.fragment,t),r=!1},d(t){It(e,t)}}}function Qv(t,e,r){return t.$$set=t=>{r(0,e=n(n({},e),m(t)))},[e=m(e)]}class tE extends $t{constructor(t){super(),Rt(this,t,Qv,Jv,a,{})}}function eE(e){let n;return{c(){n=$("path"),D(n,"d","M48 48a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm448 16H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function nE(t){let e,r;const i=[{viewBox:"0 0 512 512"},t[0]];let o={$$slots:{default:[eE]},$$scope:{ctx:t}};for(let t=0;t<i.length;t+=1)o=n(o,i[t]);return e=new qv({props:o}),{c(){Nt(e.$$.fragment)},m(t,n){Bt(e,t,n),r=!0},p(t,[n]){const r=1&n?Tt(i,[i[0],St(t[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){r||(wt(e.$$.fragment,t),r=!0)},o(t){vt(e.$$.fragment,t),r=!1},d(t){It(e,t)}}}function rE(t,e,r){return t.$$set=t=>{r(0,e=n(n({},e),m(t)))},[e=m(e)]}class iE extends $t{constructor(t){super(),Rt(this,t,rE,nE,a,{})}}function oE(t){let e,n,r,i,a,c,u,l,f,d,h,p,g,m,b,y,w,v,E;return i=new Gv({}),l=new iE({}),p=new Yv({}),y=new tE({}),{c(){e=R("div"),n=R("button"),r=R("span"),Nt(i.$$.fragment),a=L(),c=R("button"),u=R("span"),Nt(l.$$.fragment),f=L(),d=R("button"),h=R("span"),Nt(p.$$.fragment),g=L(),m=R("button"),b=R("span"),Nt(y.$$.fragment),D(r,"class","w-6 h-6 p-1"),D(n,"class","btn btn-sm"),D(u,"class","w-6 h-6 p-1"),D(c,"class","btn btn-sm"),D(h,"class","w-6 h-6 p-1"),D(d,"class","btn btn-sm"),D(b,"class","w-6 h-6 p-1"),D(m,"class","btn btn-sm"),D(e,"class","btn-group")},m(o,x){B(o,e,x),T(e,n),T(n,r),Bt(i,r,null),T(e,a),T(e,c),T(c,u),Bt(l,u,null),T(e,f),T(e,d),T(d,h),Bt(p,h,null),T(e,g),T(e,m),T(m,b),Bt(y,b,null),w=!0,v||(E=[U(n,"click",(function(){s(t[3].header1)&&t[3].header1.apply(this,arguments)})),U(c,"click",(function(){s(t[3].bulletList)&&t[3].bulletList.apply(this,arguments)})),U(d,"click",(function(){s(t[3].bold)&&t[3].bold.apply(this,arguments)})),U(m,"click",(function(){s(t[3].italic)&&t[3].italic.apply(this,arguments)}))],v=!0)},p(e,n){t=e},i(t){w||(wt(i.$$.fragment,t),wt(l.$$.fragment,t),wt(p.$$.fragment,t),wt(y.$$.fragment,t),w=!0)},o(t){vt(i.$$.fragment,t),vt(l.$$.fragment,t),vt(p.$$.fragment,t),vt(y.$$.fragment,t),w=!1},d(t){t&&I(e),It(i),It(l),It(p),It(y),v=!1,o(E)}}}function sE(t){let e,n,r,i,a,c,u,l;return e=new Cv({props:{for:null,editor:t[0],offset:8,$$slots:{default:[oE,({commands:t})=>({3:t}),({commands:t})=>t?8:0]},$$scope:{ctx:t}}}),{c(){Nt(e.$$.fragment),n=L(),r=R("div"),D(r,"class",i="p-4 min-h-[16rem] textarea border-base-300 "+t[2]+" "+(t[1]?"opacity-50":"")+" svelte-1utagcy")},m(i,o){Bt(e,i,o),B(i,n,o),B(i,r,o),c=!0,u||(l=[b(a=cw.call(null,r,t[0])),b(aE.call(null,r))],u=!0)},p(t,[n]){const o={};1&n&&(o.editor=t[0]),24&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o),(!c||6&n&&i!==(i="p-4 min-h-[16rem] textarea border-base-300 "+t[2]+" "+(t[1]?"opacity-50":"")+" svelte-1utagcy"))&&D(r,"class",i),a&&s(a.update)&&1&n&&a.update.call(null,t[0])},i(t){c||(wt(e.$$.fragment,t),c=!0)},o(t){vt(e.$$.fragment,t),c=!1},d(t){It(e,t),t&&I(n),t&&I(r),u=!1,o(l)}}}function aE(t){t.focus()}function cE(t,e,n){let{editor:r}=e,{disabled:i=!1}=e,{class:o=""}=e;return t.$$set=t=>{"editor"in t&&n(0,r=t.editor),"disabled"in t&&n(1,i=t.disabled),"class"in t&&n(2,o=t.class)},t.$$.update=()=>{2&t.$$.dirty&&n(0,r.enabled=!i,r)},[r,i,o]}class uE extends $t{constructor(t){super(),Rt(this,t,cE,sE,a,{editor:0,disabled:1,class:2})}}function lE(t,e,n){const r=t.slice();return r[11]=e[n],r}function fE(t){let e,n,r,i,o,s,a,c,u=t[11]+"";function l(){return t[7](t[11])}return{c(){e=R("button"),n=R("span"),r=k(u),i=L(),o=$("svg"),s=$("path"),D(s,"stroke-linecap","round"),D(s,"stroke-linejoin","round"),D(s,"stroke-width","2"),D(s,"d","M6 18L18 6M6 6l12 12"),D(o,"xmlns","http://www.w3.org/2000/svg"),D(o,"fill","none"),D(o,"viewBox","0 0 24 24"),D(o,"class","inline-block w-4 h-4 stroke-current"),D(e,"class","btn btn-outline btn-sm flex items-center")},m(t,u){B(t,e,u),T(e,n),T(n,r),T(e,i),T(e,o),T(o,s),a||(c=U(e,"click",l),a=!0)},p(e,n){t=e,1&n&&u!==(u=t[11]+"")&&C(r,u)},d(t){t&&I(e),a=!1,c()}}}function dE(e){let n,r,i,s,a,c,u,l,f,d,h=e[0],p=[];for(let t=0;t<h.length;t+=1)p[t]=fE(lE(e,h,t));return{c(){n=R("div");for(let t=0;t<p.length;t+=1)p[t].c();r=L(),i=R("input"),a=L(),c=R("button"),u=k("Add"),D(i,"placeholder","Add tag..."),D(i,"class",s="bg-transparent text-base rounded-lg h-8 px-3 w-32 "+(e[1]?"opacity-50":"")),i.disabled=e[1],D(c,"class","btn btn-sm btn-ghost"),c.disabled=l=0===e[2].trim().length||e[0].includes(e[2])||e[1],D(n,"class","flex flex-wrap space-x-2")},m(t,o){B(t,n,o);for(let t=0;t<p.length;t+=1)p[t]&&p[t].m(n,null);T(n,r),T(n,i),F(i,e[2]),e[9](i),T(n,a),T(n,c),T(c,u),f||(d=[U(i,"input",e[8]),U(i,"keypress",e[6]),U(c,"click",e[4])],f=!0)},p(t,[e]){if(33&e){let i;for(h=t[0],i=0;i<h.length;i+=1){const o=lE(t,h,i);p[i]?p[i].p(o,e):(p[i]=fE(o),p[i].c(),p[i].m(n,r))}for(;i<p.length;i+=1)p[i].d(1);p.length=h.length}2&e&&s!==(s="bg-transparent text-base rounded-lg h-8 px-3 w-32 "+(t[1]?"opacity-50":""))&&D(i,"class",s),2&e&&(i.disabled=t[1]),4&e&&i.value!==t[2]&&F(i,t[2]),7&e&&l!==(l=0===t[2].trim().length||t[0].includes(t[2])||t[1])&&(c.disabled=l)},i:t,o:t,d(t){t&&I(n),O(p,t),e[9](null),f=!1,o(d)}}}function hE(t,e,n){let r,{tags:i}=e,{disabled:o=!1}=e,s="";const a=tt();function c(){a("add",s),n(2,s=""),r.focus()}function u(t){a("remove",t)}return t.$$set=t=>{"tags"in t&&n(0,i=t.tags),"disabled"in t&&n(1,o=t.disabled)},[i,o,s,r,c,u,function(t){"Enter"===t.key&&s.trim().length>0&&!i.includes(s)&&c()},t=>u(t),function(){s=this.value,n(2,s)},function(t){nt[t?"unshift":"push"]((()=>{r=t,n(3,r)}))}]}class pE extends $t{constructor(t){super(),Rt(this,t,hE,dE,a,{tags:0,disabled:1})}}function gE(t,e,n){const r=t.slice();return r[13]=e[n],r}function mE(t){let e,n,r,i,o,s,a,c,u,l=t[0].owner+"";return{c(){e=R("p"),n=k("This note is "),r=R("span"),r.textContent="shared",i=k(" with you. It is owned\n      by "),o=R("span"),s=k(l),a=k("."),c=L(),u=R("p"),u.textContent="Users with whom the owner shared the note:",D(r,"class","font-bold"),D(o,"class","italic font-bold"),D(e,"class","mt-3"),D(u,"class","mt-3")},m(t,l){B(t,e,l),T(e,n),T(e,r),T(e,i),T(e,o),T(o,s),T(e,a),B(t,c,l),B(t,u,l)},p(t,e){1&e&&l!==(l=t[0].owner+"")&&C(s,l)},d(t){t&&I(e),t&&I(c),t&&I(u)}}}function bE(e){let n;return{c(){n=R("p"),n.textContent="Add users by their principal to allow them editing the note.",D(n,"class","mt-1")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function yE(t){let e,n,r,i,o,s,a,c,u,l=t[13]+"";function f(){return t[9](t[13])}return{c(){e=R("button"),n=R("span"),r=k(l),i=L(),o=$("svg"),s=$("path"),D(s,"stroke-linecap","round"),D(s,"stroke-linejoin","round"),D(s,"stroke-width","2"),D(s,"d","M6 18L18 6M6 6l12 12"),D(o,"xmlns","http://www.w3.org/2000/svg"),D(o,"fill","none"),D(o,"viewBox","0 0 24 24"),D(o,"class","inline-block w-4 h-4 stroke-current"),D(e,"class","btn btn-outline btn-sm flex items-center"),e.disabled=a=t[4]||t[5]||!t[1]},m(t,a){B(t,e,a),T(e,n),T(n,r),T(e,i),T(e,o),T(o,s),c||(u=U(e,"click",f),c=!0)},p(n,i){t=n,1&i&&l!==(l=t[13]+"")&&C(r,l),50&i&&a!==(a=t[4]||t[5]||!t[1])&&(e.disabled=a)},d(t){t&&I(e),c=!1,u()}}}function wE(e){let n,r,i,s,a,c,u,l,f,d,h,p,g,m,b,y=e[4]?"Adding...":e[5]?"Removing... ":"Add";function w(t,e){return t[1]?bE:mE}let v=w(e),E=v(e),x=e[0].users,_=[];for(let t=0;t<x.length;t+=1)_[t]=yE(gE(e,x,t));return{c(){n=R("div"),r=R("p"),r.textContent="Users",i=L(),E.c(),s=L(),a=R("div");for(let t=0;t<_.length;t+=1)_[t].c();c=L(),u=R("input"),f=L(),d=R("button"),h=k(y),D(r,"class","text-lg font-bold"),D(u,"placeholder","Add principal..."),D(u,"class",l="bg-transparent text-base rounded-lg h-8 px-3 w-auto "+(e[4]||e[5]?"opacity-50":"")+" "+(e[1]?"":"hidden")),u.disabled=e[4],D(d,"class",p="btn btn-sm btn-ghost "+(e[1]?"":"hidden")+" "+(e[4]||e[5]?"loading":"")),d.disabled=g=0===e[2].trim().length||e[0].users.includes(e[2])||e[4]||e[5],D(a,"class","flex flex-wrap space-x-2 mt-2"),D(n,"class","flex flex-col flex-wrap mt-4")},m(t,o){B(t,n,o),T(n,r),T(n,i),E.m(n,null),T(n,s),T(n,a);for(let t=0;t<_.length;t+=1)_[t]&&_[t].m(a,null);T(a,c),T(a,u),F(u,e[2]),e[11](u),T(a,f),T(a,d),T(d,h),m||(b=[U(u,"input",e[10]),U(u,"keypress",e[8]),U(d,"click",e[6])],m=!0)},p(t,[e]){if(v===(v=w(t))&&E?E.p(t,e):(E.d(1),E=v(t),E&&(E.c(),E.m(n,s))),179&e){let n;for(x=t[0].users,n=0;n<x.length;n+=1){const r=gE(t,x,n);_[n]?_[n].p(r,e):(_[n]=yE(r),_[n].c(),_[n].m(a,c))}for(;n<_.length;n+=1)_[n].d(1);_.length=x.length}50&e&&l!==(l="bg-transparent text-base rounded-lg h-8 px-3 w-auto "+(t[4]||t[5]?"opacity-50":"")+" "+(t[1]?"":"hidden"))&&D(u,"class",l),16&e&&(u.disabled=t[4]),4&e&&u.value!==t[2]&&F(u,t[2]),48&e&&y!==(y=t[4]?"Adding...":t[5]?"Removing... ":"Add")&&C(h,y),50&e&&p!==(p="btn btn-sm btn-ghost "+(t[1]?"":"hidden")+" "+(t[4]||t[5]?"loading":""))&&D(d,"class",p),53&e&&g!==(g=0===t[2].trim().length||t[0].users.includes(t[2])||t[4]||t[5])&&(d.disabled=g)},i:t,o:t,d(t){t&&I(n),E.d(),O(_,t),e[11](null),m=!1,o(b)}}}function vE(t,e,n){let r;l(t,vg,(t=>n(12,r=t)));let i,{editedNote:o}=e,{ownedByMe:s=!1}=e,a="",c=!1,u=!1;async function f(){n(4,c=!0);try{await async function(t,e,n){await n.add_user(t,e)}(o.id,a,r.actor),Fp({type:"success",message:"User successfully added"}),n(0,o.users=[...o.users,a],o),n(2,a=""),i.focus()}catch(t){Mp(t)}finally{n(4,c=!1)}await jg(r.actor,r.crypto).catch((t=>Mp(t)))}async function d(t){n(5,u=!0);try{await async function(t,e,n){await n.remove_user(t,e)}(o.id,t,r.actor),n(0,o.users=o.users.filter((e=>e!==t)),o),Fp({type:"success",message:"User successfully removed"})}catch(t){Mp(t)}finally{n(5,u=!1)}await jg(r.actor,r.crypto).catch((t=>Mp(t)))}return t.$$set=t=>{"editedNote"in t&&n(0,o=t.editedNote),"ownedByMe"in t&&n(1,s=t.ownedByMe)},[o,s,a,i,c,u,f,d,function(t){"Enter"===t.key&&a.trim().length>0&&!o.users.includes(a)&&f()},t=>{d(t)},function(){a=this.value,n(2,a)},function(t){nt[t?"unshift":"push"]((()=>{i=t,n(3,i)}))}]}class EE extends $t{constructor(t){super(),Rt(this,t,vE,wE,a,{editedNote:0,ownedByMe:1})}}function xE(e){let n;return{c(){n=$("path"),D(n,"d","M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function _E(t){let e,r;const i=[{viewBox:"0 0 448 512"},t[0]];let o={$$slots:{default:[xE]},$$scope:{ctx:t}};for(let t=0;t<i.length;t+=1)o=n(o,i[t]);return e=new qv({props:o}),{c(){Nt(e.$$.fragment)},m(t,n){Bt(e,t,n),r=!0},p(t,[n]){const r=1&n?Tt(i,[i[0],St(t[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){r||(wt(e.$$.fragment,t),r=!0)},o(t){vt(e.$$.fragment,t),r=!1},d(t){It(e,t)}}}function AE(t,e,r){return t.$$set=t=>{r(0,e=n(n({},e),m(t)))},[e=m(e)]}class TE extends $t{constructor(t){super(),Rt(this,t,AE,_E,a,{})}}var SE,NE;function BE(){if(NE)return SE;NE=1;const{entries:t,setPrototypeOf:e,isFrozen:n,getPrototypeOf:r,getOwnPropertyDescriptor:i}=Object;let{freeze:o,seal:s,create:a}=Object,{apply:c,construct:u}="undefined"!=typeof Reflect&&Reflect;o||(o=function(t){return t}),s||(s=function(t){return t}),c||(c=function(t,e,n){return t.apply(e,n)}),u||(u=function(t,e){return new t(...e)});const l=T(Array.prototype.forEach),f=T(Array.prototype.lastIndexOf),d=T(Array.prototype.pop),h=T(Array.prototype.push),p=T(Array.prototype.splice),g=T(String.prototype.toLowerCase),m=T(String.prototype.toString),b=T(String.prototype.match),y=T(String.prototype.replace),w=T(String.prototype.indexOf),v=T(String.prototype.trim),E=T(Object.prototype.hasOwnProperty),x=T(RegExp.prototype.test),_=(A=TypeError,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return u(A,e)});var A;function T(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return c(t,e,r)}}function S(t,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g;e&&e(t,null);let o=r.length;for(;o--;){let e=r[o];if("string"==typeof e){const t=i(e);t!==e&&(n(r)||(r[o]=t),e=t)}t[e]=!0}return t}function N(t){for(let e=0;e<t.length;e++){E(t,e)||(t[e]=null)}return t}function B(e){const n=a(null);for(const[r,i]of t(e)){E(e,r)&&(Array.isArray(i)?n[r]=N(i):i&&"object"==typeof i&&i.constructor===Object?n[r]=B(i):n[r]=i)}return n}function I(t,e){for(;null!==t;){const n=i(t,e);if(n){if(n.get)return T(n.get);if("function"==typeof n.value)return T(n.value)}t=r(t)}return function(){return null}}const O=o(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),R=o(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),$=o(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),k=o(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),L=o(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),P=o(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),U=o(["#text"]),D=o(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),C=o(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),F=o(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),M=o(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),j=s(/\{\{[\w\W]*|[\w\W]*\}\}/gm),q=s(/<%[\w\W]*|[\w\W]*%>/gm),V=s(/\$\{[\w\W]*/gm),z=s(/^data-[\-\w.\u00B7-\uFFFF]+$/),H=s(/^aria-[\-\w]+$/),G=s(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),K=s(/^(?:\w+script|data):/i),W=s(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Z=s(/^html$/i),Y=s(/^[a-z][.\w]*(-[.\w]+)+$/i);var X=Object.freeze({__proto__:null,ARIA_ATTR:H,ATTR_WHITESPACE:W,CUSTOM_ELEMENT:Y,DATA_ATTR:z,DOCTYPE_NAME:Z,ERB_EXPR:q,IS_ALLOWED_URI:G,IS_SCRIPT_OR_DATA:K,MUSTACHE_EXPR:j,TMPLIT_EXPR:V});const J=1,Q=3,tt=7,et=8,nt=9,rt=function(){return"undefined"==typeof window?null:window};var it=function e(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt();const r=t=>e(t);if(r.version="3.2.6",r.removed=[],!n||!n.document||n.document.nodeType!==nt||!n.Element)return r.isSupported=!1,r;let{document:i}=n;const s=i,c=s.currentScript,{DocumentFragment:u,HTMLTemplateElement:A,Node:T,Element:N,NodeFilter:j,NamedNodeMap:q=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:V,DOMParser:z,trustedTypes:H}=n,K=N.prototype,W=I(K,"cloneNode"),Y=I(K,"remove"),it=I(K,"nextSibling"),ot=I(K,"childNodes"),st=I(K,"parentNode");if("function"==typeof A){const t=i.createElement("template");t.content&&t.content.ownerDocument&&(i=t.content.ownerDocument)}let at,ct="";const{implementation:ut,createNodeIterator:lt,createDocumentFragment:ft,getElementsByTagName:dt}=i,{importNode:ht}=s;let pt={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};r.isSupported="function"==typeof t&&"function"==typeof st&&ut&&void 0!==ut.createHTMLDocument;const{MUSTACHE_EXPR:gt,ERB_EXPR:mt,TMPLIT_EXPR:bt,DATA_ATTR:yt,ARIA_ATTR:wt,IS_SCRIPT_OR_DATA:vt,ATTR_WHITESPACE:Et,CUSTOM_ELEMENT:xt}=X;let{IS_ALLOWED_URI:_t}=X,At=null;const Tt=S({},[...O,...R,...$,...L,...U]);let St=null;const Nt=S({},[...D,...C,...F,...M]);let Bt=Object.seal(a(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),It=null,Ot=null,Rt=!0,$t=!0,kt=!1,Lt=!0,Pt=!1,Ut=!0,Dt=!1,Ct=!1,Ft=!1,Mt=!1,jt=!1,qt=!1,Vt=!0,zt=!1,Ht=!0,Gt=!1,Kt={},Wt=null;const Zt=S({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Yt=null;const Xt=S({},["audio","video","img","source","image","track"]);let Jt=null;const Qt=S({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),te="http://www.w3.org/1998/Math/MathML",ee="http://www.w3.org/2000/svg",ne="http://www.w3.org/1999/xhtml";let re=ne,ie=!1,oe=null;const se=S({},[te,ee,ne],m);let ae=S({},["mi","mo","mn","ms","mtext"]),ce=S({},["annotation-xml"]);const ue=S({},["title","style","font","a","script"]);let le=null;const fe=["application/xhtml+xml","text/html"];let de=null,he=null;const pe=i.createElement("form"),ge=function(t){return t instanceof RegExp||t instanceof Function},me=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!he||he!==t){if(t&&"object"==typeof t||(t={}),t=B(t),le=-1===fe.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,de="application/xhtml+xml"===le?m:g,At=E(t,"ALLOWED_TAGS")?S({},t.ALLOWED_TAGS,de):Tt,St=E(t,"ALLOWED_ATTR")?S({},t.ALLOWED_ATTR,de):Nt,oe=E(t,"ALLOWED_NAMESPACES")?S({},t.ALLOWED_NAMESPACES,m):se,Jt=E(t,"ADD_URI_SAFE_ATTR")?S(B(Qt),t.ADD_URI_SAFE_ATTR,de):Qt,Yt=E(t,"ADD_DATA_URI_TAGS")?S(B(Xt),t.ADD_DATA_URI_TAGS,de):Xt,Wt=E(t,"FORBID_CONTENTS")?S({},t.FORBID_CONTENTS,de):Zt,It=E(t,"FORBID_TAGS")?S({},t.FORBID_TAGS,de):B({}),Ot=E(t,"FORBID_ATTR")?S({},t.FORBID_ATTR,de):B({}),Kt=!!E(t,"USE_PROFILES")&&t.USE_PROFILES,Rt=!1!==t.ALLOW_ARIA_ATTR,$t=!1!==t.ALLOW_DATA_ATTR,kt=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Lt=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Pt=t.SAFE_FOR_TEMPLATES||!1,Ut=!1!==t.SAFE_FOR_XML,Dt=t.WHOLE_DOCUMENT||!1,Mt=t.RETURN_DOM||!1,jt=t.RETURN_DOM_FRAGMENT||!1,qt=t.RETURN_TRUSTED_TYPE||!1,Ft=t.FORCE_BODY||!1,Vt=!1!==t.SANITIZE_DOM,zt=t.SANITIZE_NAMED_PROPS||!1,Ht=!1!==t.KEEP_CONTENT,Gt=t.IN_PLACE||!1,_t=t.ALLOWED_URI_REGEXP||G,re=t.NAMESPACE||ne,ae=t.MATHML_TEXT_INTEGRATION_POINTS||ae,ce=t.HTML_INTEGRATION_POINTS||ce,Bt=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&ge(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Bt.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ge(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Bt.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Bt.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Pt&&($t=!1),jt&&(Mt=!0),Kt&&(At=S({},U),St=[],!0===Kt.html&&(S(At,O),S(St,D)),!0===Kt.svg&&(S(At,R),S(St,C),S(St,M)),!0===Kt.svgFilters&&(S(At,$),S(St,C),S(St,M)),!0===Kt.mathMl&&(S(At,L),S(St,F),S(St,M))),t.ADD_TAGS&&(At===Tt&&(At=B(At)),S(At,t.ADD_TAGS,de)),t.ADD_ATTR&&(St===Nt&&(St=B(St)),S(St,t.ADD_ATTR,de)),t.ADD_URI_SAFE_ATTR&&S(Jt,t.ADD_URI_SAFE_ATTR,de),t.FORBID_CONTENTS&&(Wt===Zt&&(Wt=B(Wt)),S(Wt,t.FORBID_CONTENTS,de)),Ht&&(At["#text"]=!0),Dt&&S(At,["html","head","body"]),At.table&&(S(At,["tbody"]),delete It.tbody),t.TRUSTED_TYPES_POLICY){if("function"!=typeof t.TRUSTED_TYPES_POLICY.createHTML)throw _('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof t.TRUSTED_TYPES_POLICY.createScriptURL)throw _('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');at=t.TRUSTED_TYPES_POLICY,ct=at.createHTML("")}else void 0===at&&(at=function(t,e){if("object"!=typeof t||"function"!=typeof t.createPolicy)return null;let n=null;const r="data-tt-policy-suffix";e&&e.hasAttribute(r)&&(n=e.getAttribute(r));const i="dompurify"+(n?"#"+n:"");try{return t.createPolicy(i,{createHTML:t=>t,createScriptURL:t=>t})}catch(t){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(H,c)),null!==at&&"string"==typeof ct&&(ct=at.createHTML(""));o&&o(t),he=t}},be=S({},[...R,...$,...k]),ye=S({},[...L,...P]),we=function(t){h(r.removed,{element:t});try{st(t).removeChild(t)}catch(e){Y(t)}},ve=function(t,e){try{h(r.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){h(r.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t)if(Mt||jt)try{we(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},Ee=function(t){let e=null,n=null;if(Ft)t="<remove></remove>"+t;else{const e=b(t,/^[\r\n\t ]+/);n=e&&e[0]}"application/xhtml+xml"===le&&re===ne&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");const r=at?at.createHTML(t):t;if(re===ne)try{e=(new z).parseFromString(r,le)}catch(t){}if(!e||!e.documentElement){e=ut.createDocument(re,"template",null);try{e.documentElement.innerHTML=ie?ct:r}catch(t){}}const o=e.body||e.documentElement;return t&&n&&o.insertBefore(i.createTextNode(n),o.childNodes[0]||null),re===ne?dt.call(e,Dt?"html":"body")[0]:Dt?e.documentElement:o},xe=function(t){return lt.call(t.ownerDocument||t,t,j.SHOW_ELEMENT|j.SHOW_COMMENT|j.SHOW_TEXT|j.SHOW_PROCESSING_INSTRUCTION|j.SHOW_CDATA_SECTION,null)},_e=function(t){return t instanceof V&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof q)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},Ae=function(t){return"function"==typeof T&&t instanceof T};function Te(t,e,n){l(t,(t=>{t.call(r,e,n,he)}))}const Se=function(t){let e=null;if(Te(pt.beforeSanitizeElements,t,null),_e(t))return we(t),!0;const n=de(t.nodeName);if(Te(pt.uponSanitizeElement,t,{tagName:n,allowedTags:At}),Ut&&t.hasChildNodes()&&!Ae(t.firstElementChild)&&x(/<[/\w!]/g,t.innerHTML)&&x(/<[/\w!]/g,t.textContent))return we(t),!0;if(t.nodeType===tt)return we(t),!0;if(Ut&&t.nodeType===et&&x(/<[/\w]/g,t.data))return we(t),!0;if(!At[n]||It[n]){if(!It[n]&&Be(n)){if(Bt.tagNameCheck instanceof RegExp&&x(Bt.tagNameCheck,n))return!1;if(Bt.tagNameCheck instanceof Function&&Bt.tagNameCheck(n))return!1}if(Ht&&!Wt[n]){const e=st(t)||t.parentNode,n=ot(t)||t.childNodes;if(n&&e){for(let r=n.length-1;r>=0;--r){const i=W(n[r],!0);i.__removalCount=(t.__removalCount||0)+1,e.insertBefore(i,it(t))}}}return we(t),!0}return t instanceof N&&!function(t){let e=st(t);e&&e.tagName||(e={namespaceURI:re,tagName:"template"});const n=g(t.tagName),r=g(e.tagName);return!!oe[t.namespaceURI]&&(t.namespaceURI===ee?e.namespaceURI===ne?"svg"===n:e.namespaceURI===te?"svg"===n&&("annotation-xml"===r||ae[r]):Boolean(be[n]):t.namespaceURI===te?e.namespaceURI===ne?"math"===n:e.namespaceURI===ee?"math"===n&&ce[r]:Boolean(ye[n]):t.namespaceURI===ne?!(e.namespaceURI===ee&&!ce[r])&&!(e.namespaceURI===te&&!ae[r])&&!ye[n]&&(ue[n]||!be[n]):!("application/xhtml+xml"!==le||!oe[t.namespaceURI]))}(t)?(we(t),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!x(/<\/no(script|embed|frames)/i,t.innerHTML)?(Pt&&t.nodeType===Q&&(e=t.textContent,l([gt,mt,bt],(t=>{e=y(e,t," ")})),t.textContent!==e&&(h(r.removed,{element:t.cloneNode()}),t.textContent=e)),Te(pt.afterSanitizeElements,t,null),!1):(we(t),!0)},Ne=function(t,e,n){if(Vt&&("id"===e||"name"===e)&&(n in i||n in pe))return!1;if($t&&!Ot[e]&&x(yt,e));else if(Rt&&x(wt,e));else if(!St[e]||Ot[e]){if(!(Be(t)&&(Bt.tagNameCheck instanceof RegExp&&x(Bt.tagNameCheck,t)||Bt.tagNameCheck instanceof Function&&Bt.tagNameCheck(t))&&(Bt.attributeNameCheck instanceof RegExp&&x(Bt.attributeNameCheck,e)||Bt.attributeNameCheck instanceof Function&&Bt.attributeNameCheck(e))||"is"===e&&Bt.allowCustomizedBuiltInElements&&(Bt.tagNameCheck instanceof RegExp&&x(Bt.tagNameCheck,n)||Bt.tagNameCheck instanceof Function&&Bt.tagNameCheck(n))))return!1}else if(Jt[e]);else if(x(_t,y(n,Et,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==w(n,"data:")||!Yt[t]){if(kt&&!x(vt,y(n,Et,"")));else if(n)return!1}else;return!0},Be=function(t){return"annotation-xml"!==t&&b(t,xt)},Ie=function(t){Te(pt.beforeSanitizeAttributes,t,null);const{attributes:e}=t;if(!e||_e(t))return;const n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:St,forceKeepAttr:void 0};let i=e.length;for(;i--;){const o=e[i],{name:s,namespaceURI:a,value:c}=o,u=de(s),f=c;let h="value"===s?f:v(f);if(n.attrName=u,n.attrValue=h,n.keepAttr=!0,n.forceKeepAttr=void 0,Te(pt.uponSanitizeAttribute,t,n),h=n.attrValue,!zt||"id"!==u&&"name"!==u||(ve(s,t),h="user-content-"+h),Ut&&x(/((--!?|])>)|<\/(style|title)/i,h)){ve(s,t);continue}if(n.forceKeepAttr)continue;if(!n.keepAttr){ve(s,t);continue}if(!Lt&&x(/\/>/i,h)){ve(s,t);continue}Pt&&l([gt,mt,bt],(t=>{h=y(h,t," ")}));const p=de(t.nodeName);if(Ne(p,u,h)){if(at&&"object"==typeof H&&"function"==typeof H.getAttributeType)if(a);else switch(H.getAttributeType(p,u)){case"TrustedHTML":h=at.createHTML(h);break;case"TrustedScriptURL":h=at.createScriptURL(h)}if(h!==f)try{a?t.setAttributeNS(a,s,h):t.setAttribute(s,h),_e(t)?we(t):d(r.removed)}catch(e){ve(s,t)}}else ve(s,t)}Te(pt.afterSanitizeAttributes,t,null)},Oe=function t(e){let n=null;const r=xe(e);for(Te(pt.beforeSanitizeShadowDOM,e,null);n=r.nextNode();)Te(pt.uponSanitizeShadowNode,n,null),Se(n),Ie(n),n.content instanceof u&&t(n.content);Te(pt.afterSanitizeShadowDOM,e,null)};return r.sanitize=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=null,o=null,a=null;if(ie=!t,ie&&(t="\x3c!--\x3e"),"string"!=typeof t&&!Ae(t)){if("function"!=typeof t.toString)throw _("toString is not a function");if("string"!=typeof(t=t.toString()))throw _("dirty is not a string, aborting")}if(!r.isSupported)return t;if(Ct||me(e),r.removed=[],"string"==typeof t&&(Gt=!1),Gt){if(t.nodeName){const e=de(t.nodeName);if(!At[e]||It[e])throw _("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof T)n=Ee("\x3c!----\x3e"),i=n.ownerDocument.importNode(t,!0),i.nodeType===J&&"BODY"===i.nodeName||"HTML"===i.nodeName?n=i:n.appendChild(i);else{if(!Mt&&!Pt&&!Dt&&-1===t.indexOf("<"))return at&&qt?at.createHTML(t):t;if(n=Ee(t),!n)return Mt?null:qt?ct:""}n&&Ft&&we(n.firstChild);const c=xe(Gt?t:n);for(;o=c.nextNode();)Se(o),Ie(o),o.content instanceof u&&Oe(o.content);if(Gt)return t;if(Mt){if(jt)for(a=ft.call(n.ownerDocument);n.firstChild;)a.appendChild(n.firstChild);else a=n;return(St.shadowroot||St.shadowrootmode)&&(a=ht.call(s,a,!0)),a}let f=Dt?n.outerHTML:n.innerHTML;return Dt&&At["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&x(Z,n.ownerDocument.doctype.name)&&(f="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+f),Pt&&l([gt,mt,bt],(t=>{f=y(f,t," ")})),at&&qt?at.createHTML(f):f},r.setConfig=function(){me(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Ct=!0},r.clearConfig=function(){he=null,Ct=!1},r.isValidAttribute=function(t,e,n){he||me({});const r=de(t),i=de(e);return Ne(r,i,n)},r.addHook=function(t,e){"function"==typeof e&&h(pt[t],e)},r.removeHook=function(t,e){if(void 0!==e){const n=f(pt[t],e);return-1===n?void 0:p(pt[t],n,1)[0]}return d(pt[t])},r.removeHooks=function(t){pt[t]=[]},r.removeAllHooks=function(){pt={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},r}();return SE=it}var IE=Dt(window.DOMPurify||(window.DOMPurify=BE().default||BE()));function OE(t){let e,n,r,i,o,s;e=new aw({props:{$$slots:{title:[$E]},$$scope:{ctx:t}}});const a=[LE,kE],c=[];function u(t,e){return"loading"===t[1].state?0:"loaded"===t[1].state?1:-1}return~(i=u(t))&&(o=c[i]=a[i](t)),{c(){Nt(e.$$.fragment),n=L(),r=R("main"),o&&o.c(),D(r,"class","p-4")},m(t,o){Bt(e,t,o),B(t,n,o),B(t,r,o),~i&&c[i].m(r,null),s=!0},p(t,n){const s={};32768&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s);let l=i;i=u(t),i!==l&&(o&&(bt(),vt(c[l],1,1,(()=>{c[l]=null})),yt()),~i?(o=c[i],o||(o=c[i]=a[i](t),o.c()),wt(o,1),o.m(r,null)):o=null)},i(t){s||(wt(e.$$.fragment,t),wt(o),s=!0)},o(t){vt(e.$$.fragment,t),vt(o),s=!1},d(t){It(e,t),t&&I(n),t&&I(r),~i&&c[i].d()}}}function RE(t){let e,n,r,i,o,s;e=new aw({props:{$$slots:{actions:[DE],title:[PE]},$$scope:{ctx:t}}});const a=[FE,CE],c=[];function u(t,e){return"loaded"===t[1].state?0:"loading"===t[1].state?1:-1}return~(i=u(t))&&(o=c[i]=a[i](t)),{c(){Nt(e.$$.fragment),n=L(),r=R("main"),o&&o.c(),D(r,"class","p-4")},m(t,o){Bt(e,t,o),B(t,n,o),B(t,r,o),~i&&c[i].m(r,null),s=!0},p(t,n){const s={};32824&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s);let l=i;i=u(t),i===l?~i&&c[i].p(t,n):(o&&(bt(),vt(c[l],1,1,(()=>{c[l]=null})),yt()),~i?(o=c[i],o?o.p(t,n):(o=c[i]=a[i](t),o.c()),wt(o,1),o.m(r,null)):o=null)},i(t){s||(wt(e.$$.fragment,t),wt(o),s=!0)},o(t){vt(e.$$.fragment,t),vt(o),s=!1},d(t){It(e,t),t&&I(n),t&&I(r),~i&&c[i].d()}}}function $E(e){let n;return{c(){n=R("span"),n.textContent="Edit note",D(n,"slot","title")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function kE(e){let n;return{c(){n=R("div"),n.textContent="Could not find note.",D(n,"class","alert alert-error")},m(t,e){B(t,n,e)},i:t,o:t,d(t){t&&I(n)}}}function LE(t){let e,n,r;return e=new Ng({}),{c(){Nt(e.$$.fragment),n=k("\n      Loading note...")},m(t,i){Bt(e,t,i),B(t,n,i),r=!0},i(t){r||(wt(e.$$.fragment,t),r=!0)},o(t){vt(e.$$.fragment,t),r=!1},d(t){It(e,t),t&&I(n)}}}function PE(e){let n;return{c(){n=R("span"),n.textContent="Edit note",D(n,"slot","title")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function UE(t){let e,n,r;return n=new TE({}),{c(){e=R("span"),Nt(n.$$.fragment),D(e,"class","w-6 h-6 p-1")},m(t,i){B(t,e,i),Bt(n,e,null),r=!0},i(t){r||(wt(n.$$.fragment,t),r=!0)},o(t){vt(n.$$.fragment,t),r=!1},d(t){t&&I(e),It(n)}}}function DE(t){let e,n,r,i,o,s,a,c,u=t[4]?"Deleting...":"",l=!t[4]&&UE();return{c(){e=R("button"),l&&l.c(),n=L(),r=k(u),D(e,"slot","actions"),D(e,"class",i="btn btn-ghost "+(t[4]?"loading":"")+" "+(t[5]?"":"hidden")),e.disabled=o=t[3]||t[4]},m(i,o){B(i,e,o),l&&l.m(e,null),T(e,n),T(e,r),s=!0,a||(c=U(e,"click",t[7]),a=!0)},p(t,a){t[4]?l&&(bt(),vt(l,1,1,(()=>{l=null})),yt()):l?16&a&&wt(l,1):(l=UE(),l.c(),wt(l,1),l.m(e,n)),(!s||16&a)&&u!==(u=t[4]?"Deleting...":"")&&C(r,u),(!s||48&a&&i!==(i="btn btn-ghost "+(t[4]?"loading":"")+" "+(t[5]?"":"hidden")))&&D(e,"class",i),(!s||24&a&&o!==(o=t[3]||t[4]))&&(e.disabled=o)},i(t){s||(wt(l),s=!0)},o(t){vt(l),s=!1},d(t){t&&I(e),l&&l.d(),a=!1,c()}}}function CE(e){let n;return{c(){n=k("Loading notes...")},m(t,e){B(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}function FE(t){let e,n,r,i,o,s,a,c,u,l,f,d,h,p,g,m=t[3]?"Saving...":"Save";return e=new uE({props:{editor:t[2],disabled:t[3]||t[4],class:"mb-3"}}),r=new pE({props:{tags:t[0].tags,disabled:t[3]||t[4]}}),r.$on("add",t[11]),r.$on("remove",t[12]),d=new EE({props:{editedNote:t[0],ownedByMe:t[5]}}),{c(){Nt(e.$$.fragment),n=L(),Nt(r.$$.fragment),i=L(),o=R("button"),s=k(m),u=L(),l=R("hr"),f=L(),Nt(d.$$.fragment),D(o,"class",a="btn mt-4 btn-primary "+(t[3]?"loading":"")),o.disabled=c=t[3]||t[4],D(l,"class","mt-10")},m(a,c){Bt(e,a,c),B(a,n,c),Bt(r,a,c),B(a,i,c),B(a,o,c),T(o,s),B(a,u,c),B(a,l,c),B(a,f,c),Bt(d,a,c),h=!0,p||(g=U(o,"click",t[6]),p=!0)},p(t,n){const i={};4&n&&(i.editor=t[2]),24&n&&(i.disabled=t[3]||t[4]),e.$set(i);const u={};1&n&&(u.tags=t[0].tags),24&n&&(u.disabled=t[3]||t[4]),r.$set(u),(!h||8&n)&&m!==(m=t[3]?"Saving...":"Save")&&C(s,m),(!h||8&n&&a!==(a="btn mt-4 btn-primary "+(t[3]?"loading":"")))&&D(o,"class",a),(!h||24&n&&c!==(c=t[3]||t[4]))&&(o.disabled=c);const l={};1&n&&(l.editedNote=t[0]),32&n&&(l.ownedByMe=t[5]),d.$set(l)},i(t){h||(wt(e.$$.fragment,t),wt(r.$$.fragment,t),wt(d.$$.fragment,t),h=!0)},o(t){vt(e.$$.fragment,t),vt(r.$$.fragment,t),vt(d.$$.fragment,t),h=!1},d(t){It(e,t),t&&I(n),It(r,t),t&&I(i),t&&I(o),t&&I(u),t&&I(l),t&&I(f),It(d,t),p=!1,g()}}}function ME(t){let e,n,r,i;const o=[RE,OE],s=[];function a(t,e){return t[0]?0:1}return e=a(t),n=s[e]=o[e](t),{c(){n.c(),r=P()},m(t,n){s[e].m(t,n),B(t,r,n),i=!0},p(t,[i]){let c=e;e=a(t),e===c?s[e].p(t,i):(bt(),vt(s[c],1,1,(()=>{s[c]=null})),yt(),n=s[e],n?n.p(t,i):(n=s[e]=o[e](t),n.c()),wt(n,1),n.m(r.parentNode,r))},i(t){i||(wt(n),i=!0)},o(t){vt(n),i=!1},d(t){s[e].d(t),t&&I(r)}}}function jE(t,e,n){let r,i;l(t,Cg,(t=>n(1,r=t))),l(t,vg,(t=>n(13,i=t)));let o,s,a,{currentRoute:c}=e,u=!1,f=!1;function d(t){n(0,o.tags=[...o.tags,t],o)}function h(t){n(0,o.tags=o.tags.filter((e=>e!==t)),o)}return t.$$set=t=>{"currentRoute"in t&&n(10,c=t.currentRoute)},t.$$.update=()=>{if(1027&t.$$.dirty&&"loaded"===r.state&&!o){const t=r.list.find((t=>t.id.toString()===c.namedParams.id));t&&(n(0,o=Object.assign({},t)),n(2,s=new zy({modules:{placeholder:Ay("Start typing...")},html:o.content})),n(5,a=t.owner==function(){if("initialized"!==i.state)throw new Error("expected the auth.state to be initialized");return i.client.getIdentity().getPrincipal().toString()}()))}},[o,r,s,u,f,a,async function(){if("initialized"!==i.state)return;const t=IE.sanitize(s.getHTML());n(3,u=!0),await async function(t,e,n){const r=await Pg(t,n);await e.update_note(t.id,r.encrypted_text)}(Object.assign(Object.assign({},o),{content:t,title:Dg(t),updatedAt:Date.now()}),i.actor,i.crypto).catch((t=>{Mp(t)})).finally((()=>{n(3,u=!1)})),Fp({type:"success",message:"Note saved successfully"}),await jg(i.actor,i.crypto).catch((t=>Mp(t)))},async function(){"initialized"===i.state&&(n(4,f=!0),await i.actor.delete_note(o.id).catch((t=>{n(4,f=!1),Mp(t)})),await jg(i.actor,i.crypto).catch((t=>Mp(t))).finally((()=>{Fp({type:"success",message:"Note deleted successfully"}),lg("/notes")})))},d,h,c,t=>d(t.detail),t=>h(t.detail)]}class qE extends $t{constructor(t){super(),Rt(this,t,jE,ME,a,{currentRoute:10})}}let VE={content:"",tags:[]};try{const t=JSON.parse(localStorage.getItem("draft"));"content"in t&&"tags"in t&&(VE=t)}catch($c){}const zE=Pt(VE);function HE(e){let n;return{c(){n=R("span"),n.textContent="New note",D(n,"slot","title")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function GE(t){let e,n,r,i,s,a,c,u,l,f,d,h,p,g=t[0]?"Adding...":"Add note";return e=new aw({props:{$$slots:{title:[HE]},$$scope:{ctx:t}}}),i=new uE({props:{editor:t[2],class:"mb-3",disabled:t[0]}}),a=new pE({props:{tags:t[1],disabled:t[0]}}),a.$on("add",t[7]),a.$on("remove",t[8]),{c(){Nt(e.$$.fragment),n=L(),r=R("main"),Nt(i.$$.fragment),s=L(),Nt(a.$$.fragment),c=L(),u=R("button"),l=k(g),D(u,"class",f="btn mt-6 btn-primary "+(t[0]?"loading":"")),u.disabled=t[0],D(r,"class","p-4")},m(o,f){Bt(e,o,f),B(o,n,f),B(o,r,f),Bt(i,r,null),T(r,s),Bt(a,r,null),T(r,c),T(r,u),T(u,l),d=!0,h||(p=[U(window,"beforeunload",t[4]),U(u,"click",t[3])],h=!0)},p(t,[n]){const r={};2048&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r);const o={};1&n&&(o.disabled=t[0]),i.$set(o);const s={};2&n&&(s.tags=t[1]),1&n&&(s.disabled=t[0]),a.$set(s),(!d||1&n)&&g!==(g=t[0]?"Adding...":"Add note")&&C(l,g),(!d||1&n&&f!==(f="btn mt-6 btn-primary "+(t[0]?"loading":"")))&&D(u,"class",f),(!d||1&n)&&(u.disabled=t[0])},i(t){d||(wt(e.$$.fragment,t),wt(i.$$.fragment,t),wt(a.$$.fragment,t),d=!0)},o(t){vt(e.$$.fragment,t),vt(i.$$.fragment,t),vt(a.$$.fragment,t),d=!1},d(t){It(e,t),t&&I(n),t&&I(r),It(i),It(a),h=!1,o(p)}}}function KE(t,e,n){let r,i;l(t,vg,(t=>n(9,r=t))),l(t,zE,(t=>n(10,i=t)));let o=!1,s=i.tags;const a=new zy({modules:{placeholder:Ay("Start typing...")},html:i.content});function c(){zE.set({content:IE.sanitize(a.getHTML()),tags:s})}function u(t){n(1,s=[...s,t])}function f(t){n(1,s=s.filter((e=>e!==t)))}Q(c);return[o,s,a,async function(){"initialized"===r.state&&(n(0,o=!0),await async function(t,e,n){const r=await e.create_note();t.id=r;const i=(await Pg(t,n)).encrypted_text;await e.update_note(r,i)}(function(t,e,n){const r=Dg(t),i=Date.now();return{id:BigInt(0),title:r,content:t,createdAt:i,updatedAt:i,tags:e,owner:n.toString(),users:[""]}}(IE.sanitize(a.getHTML()),s,r.client.getIdentity().getPrincipal()),r.actor,r.crypto).catch((t=>{Mp(t)})).finally((()=>{n(0,o=!1)})),a.setHTML(""),n(1,s=[]),Fp({type:"success",message:"Note added successfully"}),jg(r.actor,r.crypto).catch((t=>Mp(t))))},c,u,f,t=>u(t.detail),t=>f(t.detail)]}zE.subscribe((t=>{localStorage.setItem("draft",JSON.stringify(t))})),vg.subscribe((t=>{"anonymous"===t.state&&zE.set(VE)}));class WE extends $t{constructor(t){super(),Rt(this,t,KE,GE,a,{})}}function ZE(t,e,n){const r=t.slice();return r[4]=e[n],r}function YE(e){let n;return{c(){n=R("span"),n.textContent="Unnamed note",D(n,"class","text-gray-500")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function XE(t){let e,n=t[0].title+"";return{c(){e=k(n)},m(t,n){B(t,e,n)},p(t,r){1&r&&n!==(n=t[0].title+"")&&C(e,n)},d(t){t&&I(e)}}}function JE(t){let e,n=t[0].tags,r=[];for(let e=0;e<n.length;e+=1)r[e]=QE(ZE(t,n,e));return{c(){e=R("div");for(let t=0;t<r.length;t+=1)r[t].c();D(e,"class","mt-4 ")},m(t,n){B(t,e,n);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,null)},p(t,i){if(5&i){let o;for(n=t[0].tags,o=0;o<n.length;o+=1){const s=ZE(t,n,o);r[o]?r[o].p(s,i):(r[o]=QE(s),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(t){t&&I(e),O(r,t)}}}function QE(t){let e,n,r,i,o,s=t[4]+"";function a(...e){return t[3](t[4],...e)}return{c(){e=R("button"),n=k(s),r=L(),D(e,"class","btn btn-outline btn-sm mr-2 mb-2 pointer-events-auto")},m(t,s){B(t,e,s),T(e,n),T(e,r),i||(o=U(e,"click",a),i=!0)},p(e,r){t=e,1&r&&s!==(s=t[4]+"")&&C(n,s)},d(t){t&&I(e),i=!1,o()}}}function tx(e){let n,r,i,o,s,a,c;function u(t,e){return t[0].title?XE:YE}let l=u(e),f=l(e),d=e[0].tags.length>0&&JE(e);return{c(){n=R("a"),r=R("div"),i=R("h2"),f.c(),o=L(),s=k(e[1]),a=L(),d&&d.c(),D(i,"class","text-lg font-bold mb-2 line-clamp-3"),D(r,"class","pointer-events-none"),D(n,"class","p-4 rounded-md border border-base-300 dark:border-base-300 bg-base dark:bg-base-100 hover:-translate-y-2 transition-transform"),D(n,"href",c=`/notes/edit/${e[0].id}`)},m(t,e){B(t,n,e),T(n,r),T(r,i),f.m(i,null),T(r,o),T(r,s),T(r,a),d&&d.m(r,null)},p(t,[e]){l===(l=u(t))&&f?f.p(t,e):(f.d(1),f=l(t),f&&(f.c(),f.m(i,null))),2&e&&C(s,t[1]),t[0].tags.length>0?d?d.p(t,e):(d=JE(t),d.c(),d.m(r,null)):d&&(d.d(1),d=null),1&e&&c!==(c=`/notes/edit/${t[0].id}`)&&D(n,"href",c)},i:t,o:t,d(t){t&&I(n),f.d(),d&&d.d()}}}function ex(t,e,n){let r,{note:i}=e;const o=tt();return t.$$set=t=>{"note"in t&&n(0,i=t.note)},t.$$.update=()=>{1&t.$$.dirty&&n(1,r=function(t,e=50){const n=document.createElement("div");n.innerHTML=t.content;let r=n.innerText;const i=Ug(n);return i&&(r=r.replace(i,"")),r.slice(0,e)+(r.length>e?"...":"")}(i))},[i,r,o,(t,e)=>{o("tagclick",t),e.stopPropagation(),e.preventDefault()}]}class nx extends $t{constructor(t){super(),Rt(this,t,ex,tx,a,{note:0})}}function rx(t,e,n){const r=t.slice();return r[6]=e[n],r}function ix(e){let n;return{c(){n=R("span"),n.textContent="Your notes",D(n,"slot","title")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function ox(t){let e;return{c(){e=R("a"),e.textContent="New Note",D(e,"class","btn btn-primary"),D(e,"href","/")},m(t,n){B(t,e,n)},d(t){t&&I(e)}}}function sx(t){let e,n="loaded"===t[1].state&&t[1].list.length>0&&ox();return{c(){n&&n.c(),e=P()},m(t,r){n&&n.m(t,r),B(t,e,r)},p(t,r){"loaded"===t[1].state&&t[1].list.length>0?n||(n=ox(),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&I(e)}}}function ax(e){let n;return{c(){n=R("div"),n.textContent="Could not load notes.",D(n,"class","alert alert-error")},m(t,e){B(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}function cx(t){let e,n,r,i;const o=[fx,lx],s=[];function a(t,e){return t[1].list.length>0?0:1}return e=a(t),n=s[e]=o[e](t),{c(){n.c(),r=P()},m(t,n){s[e].m(t,n),B(t,r,n),i=!0},p(t,i){let c=e;e=a(t),e===c?s[e].p(t,i):(bt(),vt(s[c],1,1,(()=>{s[c]=null})),yt(),n=s[e],n?n.p(t,i):(n=s[e]=o[e](t),n.c()),wt(n,1),n.m(r.parentNode,r))},i(t){i||(wt(n),i=!0)},o(t){vt(n),i=!1},d(t){s[e].d(t),t&&I(r)}}}function ux(e){let n,r,i;return n=new Ng({}),{c(){Nt(n.$$.fragment),r=k("\n    Loading notes...")},m(t,e){Bt(n,t,e),B(t,r,e),i=!0},p:t,i(t){i||(wt(n.$$.fragment,t),i=!0)},o(t){vt(n.$$.fragment,t),i=!1},d(t){It(n,t),t&&I(r)}}}function lx(e){let n,r,i;return{c(){n=R("div"),n.textContent="You don't have any notes.",r=L(),i=R("div"),i.innerHTML='<a href="/" class="btn btn-primary">Add a note</a>',D(n,"class","text-center pt-8 italic"),D(i,"class","text-center pt-8 ")},m(t,e){B(t,n,e),B(t,r,e),B(t,i,e)},p:t,i:t,o:t,d(t){t&&I(n),t&&I(r),t&&I(i)}}}function fx(t){let e,n,r,i,o,s,a,c,u=[],l=new Map,f=t[2];const d=t=>t[6].id;for(let e=0;e<f.length;e+=1){let n=rx(t,f,e),r=d(n);l.set(r,u[e]=dx(r,n))}return{c(){e=R("div"),n=R("input"),i=L(),o=R("div");for(let t=0;t<u.length;t+=1)u[t].c();D(n,"class",r="bg-transparent text-base "+(t[0].length>0?"border":"")+" rounded-lg h-8 px-3"),D(n,"placeholder","Filter notes..."),D(e,"class","mb-6"),D(o,"class","grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 max-w-7xl")},m(r,l){B(r,e,l),T(e,n),F(n,t[0]),B(r,i,l),B(r,o,l);for(let t=0;t<u.length;t+=1)u[t]&&u[t].m(o,null);s=!0,a||(c=U(n,"input",t[4]),a=!0)},p(t,e){(!s||1&e&&r!==(r="bg-transparent text-base "+(t[0].length>0?"border":"")+" rounded-lg h-8 px-3"))&&D(n,"class",r),1&e&&n.value!==t[0]&&F(n,t[0]),5&e&&(f=t[2],bt(),u=At(u,e,d,1,t,f,l,o,_t,dx,null,rx),yt())},i(t){if(!s){for(let t=0;t<f.length;t+=1)wt(u[t]);s=!0}},o(t){for(let t=0;t<u.length;t+=1)vt(u[t]);s=!1},d(t){t&&I(e),t&&I(i),t&&I(o);for(let t=0;t<u.length;t+=1)u[t].d();a=!1,c()}}}function dx(t,e){let n,r,i;return r=new nx({props:{note:e[6]}}),r.$on("tagclick",e[5]),{key:t,first:null,c(){n=P(),Nt(r.$$.fragment),this.first=n},m(t,e){B(t,n,e),Bt(r,t,e),i=!0},p(t,n){e=t;const i={};4&n&&(i.note=e[6]),r.$set(i)},i(t){i||(wt(r.$$.fragment,t),i=!0)},o(t){vt(r.$$.fragment,t),i=!1},d(t){t&&I(n),It(r,t)}}}function hx(t){let e,n,r,i,o,s;e=new aw({props:{$$slots:{actions:[sx],title:[ix]},$$scope:{ctx:t}}});const a=[ux,cx,ax],c=[];function u(t,e){return"loading"===t[1].state?0:"loaded"===t[1].state?1:"error"===t[1].state?2:-1}return~(i=u(t))&&(o=c[i]=a[i](t)),{c(){Nt(e.$$.fragment),n=L(),r=R("main"),o&&o.c(),D(r,"class","p-4")},m(t,o){Bt(e,t,o),B(t,n,o),B(t,r,o),~i&&c[i].m(r,null),s=!0},p(t,[n]){const s={};514&n&&(s.$$scope={dirty:n,ctx:t}),e.$set(s);let l=i;i=u(t),i===l?~i&&c[i].p(t,n):(o&&(bt(),vt(c[l],1,1,(()=>{c[l]=null})),yt()),~i?(o=c[i],o?o.p(t,n):(o=c[i]=a[i](t),o.c()),wt(o,1),o.m(r,null)):o=null)},i(t){s||(wt(e.$$.fragment,t),wt(o),s=!0)},o(t){vt(e.$$.fragment,t),vt(o),s=!1},d(t){It(e,t),t&&I(n),t&&I(r),~i&&c[i].d()}}}function px(t,e,n){let r,i;l(t,Cg,(t=>n(1,i=t)));let o,s="";return t.$$.update=()=>{2&t.$$.dirty&&n(3,r="loaded"===i.state?i.list.map((t=>{const e=document.createElement("div");e.innerHTML=t.content;return[e.innerText,...t.tags].join("/#delimiter#/").toLowerCase()})):[]),11&t.$$.dirty&&"loaded"===i.state&&(s.length>0?n(2,o=i.list.filter(((t,e)=>r[e].includes(s.toLowerCase())))):n(2,o=i.list))},[s,i,o,r,function(){s=this.value,n(0,s)},t=>n(0,s=t.detail)]}class gx extends $t{constructor(t){super(),Rt(this,t,px,hx,a,{})}}function mx(e){let n;return{c(){n=R("div"),n.innerHTML='<svg class="w-12 h-12 mx-auto mb-4" stroke="currentColor" fill="none" viewBox="0 0 48 48"><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg> \n          <p class="text-lg font-semibold mb-2">Drop your CSV file here</p> \n          <p class="text-sm mb-4">or click to browse</p>',D(n,"class","text-base-content/70")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function bx(t){let e,n,r,i,o,s,a,c,u,l,f,d=t[1].split("\n").length-1+"";return{c(){e=R("div"),n=$("svg"),r=$("path"),i=$("path"),o=L(),s=R("p"),a=k(t[0]),c=L(),u=R("p"),l=k(d),f=k(" rows detected"),D(r,"d","M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"),D(i,"fill-rule","evenodd"),D(i,"d","M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6.5a1.5 1.5 0 01-1.5 1.5h-7A1.5 1.5 0 014 11.5V5zm8 5a1 1 0 10-2 0v1.5a.5.5 0 01-.5.5h-3a.5.5 0 01-.5-.5V10a1 1 0 10-2 0v1.5A2.5 2.5 0 006.5 14h3a2.5 2.5 0 002.5-2.5V10z"),D(i,"clip-rule","evenodd"),D(n,"class","w-12 h-12 mx-auto mb-2"),D(n,"fill","currentColor"),D(n,"viewBox","0 0 20 20"),D(s,"class","font-semibold"),D(u,"class","text-sm opacity-70"),D(e,"class","text-success mb-4")},m(t,d){B(t,e,d),T(e,n),T(n,r),T(n,i),T(e,o),T(e,s),T(s,a),T(e,c),T(e,u),T(u,l),T(u,f)},p(t,e){1&e&&C(a,t[0]),2&e&&d!==(d=t[1].split("\n").length-1+"")&&C(l,d)},d(t){t&&I(e)}}}function yx(t){let e,n,r,i,o,s,a,c=t[1].split("\n").slice(0,6).join("\n")+"",u=t[1].split("\n").length>6?"\n...":"";return{c(){e=R("div"),n=R("h3"),n.textContent="Preview",r=L(),i=R("div"),o=R("pre"),s=k(c),a=k(u),D(n,"class","font-semibold mb-2"),D(o,"class","text-xs"),D(i,"class","bg-base-200 p-4 rounded-lg max-h-48 overflow-auto"),D(e,"class","mt-6")},m(t,c){B(t,e,c),T(e,n),T(e,r),T(e,i),T(i,o),T(o,s),T(o,a)},p(t,e){2&e&&c!==(c=t[1].split("\n").slice(0,6).join("\n")+"")&&C(s,c),2&e&&u!==(u=t[1].split("\n").length>6?"\n...":"")&&C(a,u)},d(t){t&&I(e)}}}function wx(t){let e;return{c(){e=k("Upload Dataset")},m(t,n){B(t,e,n)},d(t){t&&I(e)}}}function vx(t){let e,n;return{c(){e=R("span"),n=k("\n          Uploading..."),D(e,"class","loading loading-spinner loading-sm")},m(t,r){B(t,e,r),B(t,n,r)},d(t){t&&I(e),t&&I(n)}}}function Ex(e){let n,r,i,s,a,c,u,l,f,d,h,p,g,m,b,y,w,v,E,x,_,A,S,N,O,$;function P(t,e){return t[0]?bx:mx}let C=P(e),F=C(e),M=e[1]&&yx(e);function j(t,e){return t[2]?vx:wx}let q=j(e),V=q(e);return{c(){n=R("div"),r=R("div"),i=R("h2"),i.textContent="Upload CSV Dataset",s=L(),a=R("div"),F.c(),c=L(),u=R("input"),l=L(),f=R("button"),d=k("Browse Files"),p=L(),g=R("div"),g.textContent="OR",m=L(),b=R("div"),y=R("button"),w=k("Load Sample Employee Data"),v=L(),E=R("p"),E.textContent="Loads a sample CSV with employee information for testing",x=L(),M&&M.c(),_=L(),A=R("div"),S=R("button"),V.c(),D(i,"class","card-title mb-4"),D(u,"type","file"),D(u,"accept",".csv"),D(u,"class","hidden"),D(f,"class","btn btn-outline btn-sm"),f.disabled=e[2],D(a,"class",h="border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(e[3]?"border-primary bg-primary/10":"border-base-300")),D(g,"class","divider"),D(y,"class","btn btn-secondary btn-outline"),y.disabled=e[2],D(E,"class","text-xs text-base-content/60 mt-2"),D(b,"class","text-center"),D(S,"class","btn btn-primary"),S.disabled=N=!e[1]||e[2],D(A,"class","card-actions justify-end mt-6"),D(r,"class","card-body"),D(n,"class","card bg-base-100 shadow-xl")},m(t,o){B(t,n,o),T(n,r),T(r,i),T(r,s),T(r,a),F.m(a,null),T(a,c),T(a,u),e[11](u),T(a,l),T(a,f),T(f,d),T(r,p),T(r,g),T(r,m),T(r,b),T(b,y),T(y,w),T(b,v),T(b,E),T(r,x),M&&M.m(r,null),T(r,_),T(r,A),T(A,S),V.m(S,null),O||($=[U(u,"change",e[5]),U(f,"click",e[12]),U(a,"drop",e[6]),U(a,"dragover",e[7]),U(a,"dragleave",e[8]),U(y,"click",e[9]),U(S,"click",e[10])],O=!0)},p(t,[e]){C===(C=P(t))&&F?F.p(t,e):(F.d(1),F=C(t),F&&(F.c(),F.m(a,c))),4&e&&(f.disabled=t[2]),8&e&&h!==(h="border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(t[3]?"border-primary bg-primary/10":"border-base-300"))&&D(a,"class",h),4&e&&(y.disabled=t[2]),t[1]?M?M.p(t,e):(M=yx(t),M.c(),M.m(r,_)):M&&(M.d(1),M=null),q!==(q=j(t))&&(V.d(1),V=q(t),V&&(V.c(),V.m(S,null))),6&e&&N!==(N=!t[1]||t[2])&&(S.disabled=N)},i:t,o:t,d(t){t&&I(n),F.d(),e[11](null),M&&M.d(),V.d(),O=!1,o($)}}}function xx(t,e,n){const r=tt();let i,o="",s="",a=!1,c=!1;async function l(t){n(0,o=t.name);try{n(1,s=await t.text()),jp(`File "${o}" loaded successfully`)}catch(t){Mp("Failed to read file")}}return[o,s,a,c,i,function(t){var e;const n=null===(e=t.target.files)||void 0===e?void 0:e[0];n&&l(n)},function(t){var e;t.preventDefault(),n(3,c=!1);const r=null===(e=t.dataTransfer)||void 0===e?void 0:e.files[0];r&&"text/csv"===r.type?l(r):Mp("Please upload a CSV file")},function(t){t.preventDefault(),n(3,c=!0)},function(){n(3,c=!1)},function(){n(0,o="sample_employees.csv"),n(1,s="name,email,age,city,salary\nJohn Doe,john.doe@email.com,28,New York,75000\nJane Smith,jane.smith@email.com,32,Los Angeles,82000\nMike Johnson,mike.johnson@email.com,25,Chicago,68000\nSarah Wilson,sarah.wilson@email.com,29,Houston,71000\nDavid Brown,david.brown@email.com,35,Phoenix,85000"),jp("Sample data loaded")},async function(){if(s){n(2,a=!0);try{const t=u(vg);if(!t||"initialized"!==t.state)return void Mp("Authentication required");const e=s.split("\n"),a=e[0].split(",").map((t=>t.trim())),c=e.slice(1).filter((t=>t.trim())),l=await t.actor.create_agent_passport(o.replace(".csv",""),"csv_dataset",a,await t.crypto.encryptWithNoteKey(BigInt(Date.now()),t.actor.getPrincipal().toString(),s));jp(`Dataset "${o}" uploaded successfully`),r("uploaded",{datasetId:l,fileName:o,headers:a,rowCount:c.length}),n(0,o=""),n(1,s=""),i&&n(4,i.value="",i)}catch(t){Mp(`Failed to upload dataset: ${t.message}`)}finally{n(2,a=!1)}}else Mp("Please select a CSV file first")},function(t){nt[t?"unshift":"push"]((()=>{i=t,n(4,i)}))},()=>i?.click()]}class _x extends $t{constructor(t){super(),Rt(this,t,xx,Ex,a,{})}}function Ax(t,e,n){const r=t.slice();return r[5]=e[n],r}function Tx(t){let e;return{c(){e=k("Load Dataset")},m(t,n){B(t,e,n)},d(t){t&&I(e)}}}function Sx(t){let e;return{c(){e=R("span"),D(e,"class","loading loading-spinner loading-xs")},m(t,n){B(t,e,n)},d(t){t&&I(e)}}}function Nx(t){let e,n,r,i,o,s,a,c,u,l,f,d,h,p,g,m,b,y,w,v,E,x,_,A,S,N,O,$,P=t[5].name+"",C=t[5].description+"",F=t[5].rowCount.toLocaleString()+"",M=t[5].headers.length+"",j=t[5].headers.join(", ")+"";function q(t,e){return t[0]?Sx:Tx}let V=q(t),z=V(t);function H(){return t[3](t[5])}return{c(){e=R("div"),n=R("div"),r=R("div"),i=R("div"),o=R("h3"),s=k(P),a=L(),c=R("p"),u=k(C),l=L(),f=R("div"),d=R("div"),h=k(F),p=k(" rows"),g=L(),m=R("div"),b=k(M),y=k(" columns"),w=L(),v=R("div"),E=R("strong"),E.textContent="Columns:",x=L(),_=k(j),A=L(),S=R("button"),z.c(),N=L(),D(o,"class","font-semibold text-lg"),D(c,"class","text-sm text-base-content/70 mb-3"),D(d,"class","badge badge-outline badge-sm"),D(m,"class","badge badge-outline badge-sm"),D(f,"class","flex flex-wrap gap-2 mb-3"),D(v,"class","text-xs text-base-content/60"),D(i,"class","flex-1"),D(S,"class","btn btn-primary btn-sm ml-4"),S.disabled=t[0],D(r,"class","flex justify-between items-start"),D(n,"class","card-body p-4"),D(e,"class","card bg-base-200 shadow-sm")},m(t,I){B(t,e,I),T(e,n),T(n,r),T(r,i),T(i,o),T(o,s),T(i,a),T(i,c),T(c,u),T(i,l),T(i,f),T(f,d),T(d,h),T(d,p),T(f,g),T(f,m),T(m,b),T(m,y),T(i,w),T(i,v),T(v,E),T(v,x),T(v,_),T(r,A),T(r,S),z.m(S,null),T(e,N),O||($=U(S,"click",H),O=!0)},p(e,n){V!==(V=q(t=e))&&(z.d(1),z=V(t),z&&(z.c(),z.m(S,null))),1&n&&(S.disabled=t[0])},d(t){t&&I(e),z.d(),O=!1,$()}}}function Bx(e){let n,r,i,o,s,a,c,u,l,f=e[1],d=[];for(let t=0;t<f.length;t+=1)d[t]=Nx(Ax(e,f,t));return{c(){n=R("div"),r=R("div"),i=R("h2"),i.textContent="Load Sample Datasets",o=L(),s=R("p"),s.textContent="Choose from pre-configured synthetic datasets to explore the platform features",a=L(),c=R("div");for(let t=0;t<d.length;t+=1)d[t].c();u=L(),l=R("div"),l.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> \n      <div><h3 class="font-bold">About Sample Data</h3> \n        <div class="text-sm">All sample datasets contain synthetic data generated for demonstration purposes. \n          Sensitive fields are pre-masked for privacy compliance.</div></div>',D(i,"class","card-title mb-4"),D(s,"class","text-base-content/70 mb-6"),D(c,"class","grid gap-4"),D(l,"class","alert alert-info mt-6"),D(r,"class","card-body"),D(n,"class","card bg-base-100 shadow-xl")},m(t,e){B(t,n,e),T(n,r),T(r,i),T(r,o),T(r,s),T(r,a),T(r,c);for(let t=0;t<d.length;t+=1)d[t]&&d[t].m(c,null);T(r,u),T(r,l)},p(t,[e]){if(7&e){let n;for(f=t[1],n=0;n<f.length;n+=1){const r=Ax(t,f,n);d[n]?d[n].p(r,e):(d[n]=Nx(r),d[n].c(),d[n].m(c,null))}for(;n<d.length;n+=1)d[n].d(1);d.length=f.length}},i:t,o:t,d(t){t&&I(n),O(d,t)}}}function Ix(t,e,n){const r=tt();let i=!1;async function o(t){n(0,i=!0);try{const e=u(vg);if(!e||"initialized"!==e.state)return void Mp("Authentication required");const n=await e.actor.create_agent_passport(t.name,"synthetic_dataset",t.headers,await e.crypto.encryptWithNoteKey(BigInt(Date.now()),e.actor.getPrincipal().toString(),t.data));jp(`Sample dataset "${t.name}" loaded successfully`),r("loaded",{datasetId:n,fileName:`${t.name.toLowerCase().replace(/\s+/g,"_")}.csv`,headers:t.headers,rowCount:t.rowCount})}catch(t){Mp(`Failed to load sample dataset: ${t.message}`)}finally{n(0,i=!1)}}return[i,[{name:"Customer Demographics",description:"Synthetic customer data with demographics and purchasing behavior",headers:["customer_id","name","email","age","city","income","segment"],rowCount:1e3,data:"customer_id,name,email,age,city,income,segment\n1001,Alice Johnson,alice.j@email.com,32,Seattle,75000,Premium\n1002,Bob Smith,bob.smith@email.com,28,Portland,52000,Standard\n1003,Carol Davis,carol.d@email.com,45,San Francisco,95000,Premium\n1004,David Wilson,david.w@email.com,35,Los Angeles,68000,Standard\n1005,Emma Brown,emma.b@email.com,29,Denver,71000,Standard"},{name:"Financial Transactions",description:"Synthetic financial transaction data with privacy masking",headers:["transaction_id","account_id","amount","category","date","merchant"],rowCount:2500,data:"transaction_id,account_id,amount,category,date,merchant\nTXN001,ACC****1234,125.50,Groceries,2024-01-15,SafeWay Store\nTXN002,ACC****5678,45.00,Gas,2024-01-15,Shell Station\nTXN003,ACC****9012,89.99,Electronics,2024-01-16,Best Buy\nTXN004,ACC****3456,12.75,Coffee,2024-01-16,Starbucks\nTXN005,ACC****7890,250.00,Utilities,2024-01-17,City Power"},{name:"Healthcare Records",description:"De-identified patient data for research purposes",headers:["patient_id","age_group","condition","treatment","outcome","region"],rowCount:750,data:"patient_id,age_group,condition,treatment,outcome,region\nP****001,25-35,Hypertension,Medication A,Improved,North\nP****002,45-55,Diabetes,Insulin,Stable,South\nP****003,35-45,Asthma,Inhaler,Improved,East\nP****004,55-65,Arthritis,Physical Therapy,Stable,West\nP****005,25-35,Migraine,Medication B,Improved,North"},{name:"IoT Sensor Data",description:"Synthetic sensor readings from smart devices",headers:["device_id","timestamp","temperature","humidity","location","status"],rowCount:5e3,data:"device_id,timestamp,temperature,humidity,location,status\nDEV001,2024-01-15T08:00:00Z,22.5,45,Building A Floor 1,Normal\nDEV002,2024-01-15T08:00:00Z,21.8,48,Building A Floor 2,Normal\nDEV003,2024-01-15T08:00:00Z,23.1,42,Building B Floor 1,Normal\nDEV004,2024-01-15T08:00:00Z,20.9,51,Building B Floor 2,Alert\nDEV005,2024-01-15T08:00:00Z,22.3,46,Building C Floor 1,Normal"}],o,t=>o(t)]}class Ox extends $t{constructor(t){super(),Rt(this,t,Ix,Bx,a,{})}}function Rx(t,e,n){const r=t.slice();return r[16]=e[n],r}function $x(t,e,n){const r=t.slice();return r[19]=e[n],r}function kx(t,e,n){const r=t.slice();return r[19]=e[n],r}function Lx(e){let n,r,i=e[19]+"";return{c(){n=R("option"),r=k(i),n.__value=e[19],n.value=n.__value},m(t,e){B(t,n,e),T(n,r)},p:t,d(t){t&&I(n)}}}function Px(e){let n,r,i=e[19]+"";return{c(){n=R("option"),r=k(i),n.__value=e[19],n.value=n.__value},m(t,e){B(t,n,e),T(n,r)},p:t,d(t){t&&I(n)}}}function Ux(t){let e,n=t[0],r=[];for(let e=0;e<n.length;e+=1)r[e]=Fx(Rx(t,n,e));return{c(){e=R("div");for(let t=0;t<r.length;t+=1)r[t].c();D(e,"class","space-y-3 max-h-96 overflow-y-auto")},m(t,n){B(t,e,n);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,null)},p(t,i){if(1&i){let o;for(n=t[0],o=0;o<n.length;o+=1){const s=Rx(t,n,o);r[o]?r[o].p(s,i):(r[o]=Fx(s),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(t){t&&I(e),O(r,t)}}}function Dx(e){let n;return{c(){n=R("div"),n.textContent="No memories found. Add some memories to get started!",D(n,"class","text-center text-gray-500 py-8")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function Cx(e){let n;return{c(){n=R("div"),n.innerHTML='<span class="loading loading-spinner loading-md"></span>',D(n,"class","flex justify-center items-center h-32")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function Fx(t){let e,n,r,i,o,s,a,c,u,l,f,d,h,p,g,m,b,y,w,v,E,x,_,A,S=t[16].memory_type+"",N=Vx(t[16].importance_score)+"",O=t[16].importance_score+"",$=jx(t[16].created_at)+"",P=t[16].decrypted_content+"",U=t[16].id+"";return{c(){e=R("div"),n=R("div"),r=R("div"),i=R("div"),o=R("div"),s=k(S),a=L(),c=R("div"),u=k(N),l=k(" ("),f=k(O),d=k(")"),p=L(),g=R("div"),m=k($),b=L(),y=R("div"),w=k(P),v=L(),E=R("div"),x=k("ID: "),_=k(U),A=L(),D(o,"class","badge badge-outline text-xs"),D(c,"class",h="badge "+qx(t[16].importance_score)+" text-xs"),D(i,"class","flex gap-2 items-center"),D(g,"class","text-xs opacity-60"),D(r,"class","flex justify-between items-start mb-2"),D(y,"class","text-sm"),D(E,"class","text-xs opacity-50 mt-2"),D(n,"class","card-body p-4"),D(e,"class","card bg-base-200 shadow-sm")},m(t,h){B(t,e,h),T(e,n),T(n,r),T(r,i),T(i,o),T(o,s),T(i,a),T(i,c),T(c,u),T(c,l),T(c,f),T(c,d),T(r,p),T(r,g),T(g,m),T(n,b),T(n,y),T(y,w),T(n,v),T(n,E),T(E,x),T(E,_),T(e,A)},p(t,e){1&e&&S!==(S=t[16].memory_type+"")&&C(s,S),1&e&&N!==(N=Vx(t[16].importance_score)+"")&&C(u,N),1&e&&O!==(O=t[16].importance_score+"")&&C(f,O),1&e&&h!==(h="badge "+qx(t[16].importance_score)+" text-xs")&&D(c,"class",h),1&e&&$!==($=jx(t[16].created_at)+"")&&C(m,$),1&e&&P!==(P=t[16].decrypted_content+"")&&C(w,P),1&e&&U!==(U=t[16].id+"")&&C(_,U)},d(t){t&&I(e)}}}function Mx(e){let n,r,i,s,a,c,u,l,f,d,h,p,g,m,b,y,w,v,E,x,_,A,S,N,$,P,j,V,z,H,G,K,W,Z,Y,X,J,Q,tt,et,nt,rt,it=e[7],ot=[];for(let t=0;t<it.length;t+=1)ot[t]=Lx(kx(e,it,t));let st=e[7],ct=[];for(let t=0;t<st.length;t+=1)ct[t]=Px($x(e,st,t));function ut(t,e){return t[1]?Cx:0===t[0].length?Dx:Ux}let lt=ut(e),ft=lt(e);return{c(){n=R("div"),r=R("div"),i=R("h3"),i.textContent="Agent Memories",s=L(),a=R("div"),c=R("select"),u=R("option"),u.textContent="All Types";for(let t=0;t<ot.length;t+=1)ot[t].c();l=L(),f=R("button"),f.textContent="Refresh",d=L(),h=R("div"),p=R("input"),g=L(),m=R("div"),m.textContent="Add New Memory",b=L(),y=R("div"),w=R("div"),v=R("div"),E=R("label"),E.textContent="Type",x=L(),_=R("select");for(let t=0;t<ct.length;t+=1)ct[t].c();A=L(),S=R("div"),N=R("label"),N.textContent="Importance (0-100)",$=L(),P=R("input"),j=L(),V=R("div"),z=k(e[6]),H=L(),G=R("div"),K=R("label"),K.textContent="Action",W=L(),Z=R("button"),Y=k("Add Memory"),J=L(),Q=R("div"),tt=R("textarea"),et=L(),ft.c(),D(i,"class","card-title"),u.__value="",u.value=u.__value,D(c,"class","select select-bordered select-sm"),void 0===e[3]&&at((()=>e[12].call(c))),D(f,"class","btn btn-sm btn-outline"),D(a,"class","flex gap-2 mb-4"),D(p,"type","checkbox"),D(m,"class","collapse-title text-sm font-medium"),D(E,"class","label label-text text-xs"),D(_,"class","select select-bordered select-sm"),void 0===e[4]&&at((()=>e[13].call(_))),D(v,"class","form-control"),D(N,"class","label label-text text-xs"),D(P,"type","range"),D(P,"min","0"),D(P,"max","100"),D(P,"class","range range-sm"),D(V,"class","text-xs text-center"),D(S,"class","form-control"),D(K,"class","label label-text text-xs"),D(Z,"class","btn btn-primary btn-sm"),Z.disabled=X=e[2]||!e[5].trim(),q(Z,"loading",e[2]),D(G,"class","form-control"),D(w,"class","grid grid-cols-1 md:grid-cols-3 gap-4 mt-2"),D(tt,"class","textarea textarea-bordered textarea-sm"),D(tt,"placeholder","Enter memory content..."),tt.disabled=e[2],D(Q,"class","form-control mt-2"),D(y,"class","collapse-content"),D(h,"class","collapse collapse-arrow bg-base-200 mb-4"),D(r,"class","card-body"),D(n,"class","card bg-base-100 shadow-xl")},m(t,o){B(t,n,o),T(n,r),T(r,i),T(r,s),T(r,a),T(a,c),T(c,u);for(let t=0;t<ot.length;t+=1)ot[t]&&ot[t].m(c,null);M(c,e[3],!0),T(a,l),T(a,f),T(r,d),T(r,h),T(h,p),T(h,g),T(h,m),T(h,b),T(h,y),T(y,w),T(w,v),T(v,E),T(v,x),T(v,_);for(let t=0;t<ct.length;t+=1)ct[t]&&ct[t].m(_,null);M(_,e[4],!0),T(w,A),T(w,S),T(S,N),T(S,$),T(S,P),F(P,e[6]),T(S,j),T(S,V),T(V,z),T(w,H),T(w,G),T(G,K),T(G,W),T(G,Z),T(Z,Y),T(y,J),T(y,Q),T(Q,tt),F(tt,e[5]),T(r,et),ft.m(r,null),nt||(rt=[U(c,"change",e[12]),U(c,"change",e[10]),U(f,"click",e[8]),U(_,"change",e[13]),U(P,"change",e[14]),U(P,"input",e[14]),U(Z,"click",e[9]),U(tt,"input",e[15])],nt=!0)},p(t,[e]){if(128&e){let n;for(it=t[7],n=0;n<it.length;n+=1){const r=kx(t,it,n);ot[n]?ot[n].p(r,e):(ot[n]=Lx(r),ot[n].c(),ot[n].m(c,null))}for(;n<ot.length;n+=1)ot[n].d(1);ot.length=it.length}if(136&e&&M(c,t[3]),128&e){let n;for(st=t[7],n=0;n<st.length;n+=1){const r=$x(t,st,n);ct[n]?ct[n].p(r,e):(ct[n]=Px(r),ct[n].c(),ct[n].m(_,null))}for(;n<ct.length;n+=1)ct[n].d(1);ct.length=st.length}144&e&&M(_,t[4]),64&e&&F(P,t[6]),64&e&&C(z,t[6]),36&e&&X!==(X=t[2]||!t[5].trim())&&(Z.disabled=X),4&e&&q(Z,"loading",t[2]),4&e&&(tt.disabled=t[2]),32&e&&F(tt,t[5]),lt===(lt=ut(t))&&ft?ft.p(t,e):(ft.d(1),ft=lt(t),ft&&(ft.c(),ft.m(r,null)))},i:t,o:t,d(t){t&&I(n),O(ot,t),O(ct,t),ft.d(),nt=!1,o(rt)}}}function jx(t){return new Date(Number(t)/1e6).toLocaleString()}function qx(t){return t>=80?"badge-error":t>=60?"badge-warning":t>=40?"badge-info":"badge-ghost"}function Vx(t){return t>=80?"Critical":t>=60?"High":t>=40?"Medium":"Low"}function zx(t,e,n){let{passportId:r}=e,i=[],o=!0,s=!1,a="",c="conversation",u="",l=50;const f=["conversation","preference","skill","context","goal","instruction","feedback","error"];async function d(){n(1,o=!0);try{const t=vg;if("initialized"!==t.state)return void Mp("Authentication required");const e=await t.actor.get_agent_memories(r,a?[a]:[]);n(0,i=e);for(let e of i)try{e.decrypted_content=await t.crypto.decryptWithNoteKey(BigInt(e.id),e.owner,e.encrypted_content)}catch(t){console.warn("Could not decrypt memory:",t),e.decrypted_content="[Encrypted]"}i.sort(((t,e)=>t.importance_score!==e.importance_score?e.importance_score-t.importance_score:Number(e.created_at)-Number(t.created_at)))}catch(t){Mp(`Failed to load memories: ${t.message}`)}finally{n(1,o=!1)}}return J((async()=>{await d()})),t.$$set=t=>{"passportId"in t&&n(11,r=t.passportId)},[i,o,s,a,c,u,l,f,d,async function(){if(u.trim()){n(2,s=!0);try{const t=vg;if("initialized"!==t.state)return void Mp("Authentication required");const e=await t.crypto.encryptWithNoteKey(BigInt(Date.now()),t.actor.getPrincipal().toString(),u);jp(`Memory added successfully! ID: ${await t.actor.add_agent_memory(r,c,e,l)}`),n(5,u=""),n(6,l=50),await d()}catch(t){Mp(`Failed to add memory: ${t.message}`)}finally{n(2,s=!1)}}else Mp("Memory content is required")},async function(){await d()},r,function(){a=j(this),n(3,a),n(7,f)},function(){c=j(this),n(4,c),n(7,f)},function(){l=function(t){return""===t?null:+t}(this.value),n(6,l)},function(){u=this.value,n(5,u)}]}class Hx extends $t{constructor(t){super(),Rt(this,t,zx,Mx,a,{passportId:11})}}function Gx(t,e,n){const r=t.slice();return r[6]=e[n],r}function Kx(t,e,n){const r=t.slice();return r[9]=e[n],r}function Wx(e){let n;return{c(){n=R("div"),n.innerHTML="<span>Passport not found or access denied</span>",D(n,"class","alert alert-error")},m(t,e){B(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}function Zx(t){let e,n,r,i,s,a,c,u,l,f,d,h,p,g,m,b,y,w,v,E,x,_,A,S,N,$,F,M,j,q,V,z,H,G,K,W,Z,Y,X,J,Q,tt,et,nt,rt,it,ot,st,at,ct,ut,lt,ft,dt,ht,pt,gt=t[1].agent_name+"",mt=t[1].is_active?"Active":"Inactive",Et=t[1].agent_type+"",xt=t[1].id+"",_t=t[1].owner+"",At=r_(t[1].created_at)+"",Tt=r_(t[1].last_active)+"",St=t[3]?"Hide":"Show",Nt=t[1].capabilities,Bt=[];for(let e=0;e<Nt.length;e+=1)Bt[e]=Xx(Kx(t,Nt,e));let It=t[1].api_endpoints&&t[1].api_endpoints.length>0&&Jx(t),Ot=t[1].decrypted_specifications&&t_(t),Rt=t[3]&&e_(t);return{c(){e=R("div"),n=R("div"),r=R("div"),i=R("h2"),s=k(gt),a=L(),c=R("div"),u=k(mt),f=L(),d=R("div"),h=k(Et),p=L(),g=R("div"),m=R("div"),b=R("h3"),b.textContent="Passport ID",y=L(),w=R("p"),v=k(xt),E=L(),x=R("div"),_=R("h3"),_.textContent="Owner",A=L(),S=R("p"),N=k(_t),$=L(),F=R("div"),M=R("h3"),M.textContent="Created",j=L(),q=R("p"),V=k(At),z=L(),H=R("div"),G=R("h3"),G.textContent="Last Active",K=L(),W=R("p"),Z=k(Tt),Y=L(),X=R("div"),J=R("h3"),J.textContent="Capabilities",Q=L(),tt=R("div");for(let t=0;t<Bt.length;t+=1)Bt[t].c();et=L(),It&&It.c(),nt=L(),Ot&&Ot.c(),rt=L(),it=R("div"),ot=R("button"),st=k(St),at=k(" Memories"),ct=L(),ut=R("button"),ut.textContent="Refresh",lt=L(),Rt&&Rt.c(),ft=P(),D(c,"class",l="badge "+i_(t[1].is_active)),D(i,"class","card-title"),D(d,"class","badge badge-outline"),D(r,"class","flex justify-between items-start"),D(b,"class","font-semibold text-sm opacity-70"),D(w,"class","font-mono text-sm"),D(_,"class","font-semibold text-sm opacity-70"),D(S,"class","font-mono text-xs break-all"),D(M,"class","font-semibold text-sm opacity-70"),D(q,"class","text-sm"),D(G,"class","font-semibold text-sm opacity-70"),D(W,"class","text-sm"),D(g,"class","grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"),D(J,"class","font-semibold text-sm opacity-70 mb-2"),D(tt,"class","flex flex-wrap gap-2"),D(X,"class","mt-4"),D(ot,"class","btn btn-outline"),D(ut,"class","btn btn-primary"),D(it,"class","card-actions justify-end mt-6"),D(n,"class","card-body"),D(e,"class","card bg-base-100 shadow-xl")},m(o,l){B(o,e,l),T(e,n),T(n,r),T(r,i),T(i,s),T(i,a),T(i,c),T(c,u),T(r,f),T(r,d),T(d,h),T(n,p),T(n,g),T(g,m),T(m,b),T(m,y),T(m,w),T(w,v),T(g,E),T(g,x),T(x,_),T(x,A),T(x,S),T(S,N),T(g,$),T(g,F),T(F,M),T(F,j),T(F,q),T(q,V),T(g,z),T(g,H),T(H,G),T(H,K),T(H,W),T(W,Z),T(n,Y),T(n,X),T(X,J),T(X,Q),T(X,tt);for(let t=0;t<Bt.length;t+=1)Bt[t]&&Bt[t].m(tt,null);T(n,et),It&&It.m(n,null),T(n,nt),Ot&&Ot.m(n,null),T(n,rt),T(n,it),T(it,ot),T(ot,st),T(ot,at),T(it,ct),T(it,ut),B(o,lt,l),Rt&&Rt.m(o,l),B(o,ft,l),dt=!0,ht||(pt=[U(ot,"click",t[5]),U(ut,"click",t[4])],ht=!0)},p(t,e){if((!dt||2&e)&&gt!==(gt=t[1].agent_name+"")&&C(s,gt),(!dt||2&e)&&mt!==(mt=t[1].is_active?"Active":"Inactive")&&C(u,mt),(!dt||2&e&&l!==(l="badge "+i_(t[1].is_active)))&&D(c,"class",l),(!dt||2&e)&&Et!==(Et=t[1].agent_type+"")&&C(h,Et),(!dt||2&e)&&xt!==(xt=t[1].id+"")&&C(v,xt),(!dt||2&e)&&_t!==(_t=t[1].owner+"")&&C(N,_t),(!dt||2&e)&&At!==(At=r_(t[1].created_at)+"")&&C(V,At),(!dt||2&e)&&Tt!==(Tt=r_(t[1].last_active)+"")&&C(Z,Tt),2&e){let n;for(Nt=t[1].capabilities,n=0;n<Nt.length;n+=1){const r=Kx(t,Nt,n);Bt[n]?Bt[n].p(r,e):(Bt[n]=Xx(r),Bt[n].c(),Bt[n].m(tt,null))}for(;n<Bt.length;n+=1)Bt[n].d(1);Bt.length=Nt.length}t[1].api_endpoints&&t[1].api_endpoints.length>0?It?It.p(t,e):(It=Jx(t),It.c(),It.m(n,nt)):It&&(It.d(1),It=null),t[1].decrypted_specifications?Ot?Ot.p(t,e):(Ot=t_(t),Ot.c(),Ot.m(n,rt)):Ot&&(Ot.d(1),Ot=null),(!dt||8&e)&&St!==(St=t[3]?"Hide":"Show")&&C(st,St),t[3]?Rt?(Rt.p(t,e),8&e&&wt(Rt,1)):(Rt=e_(t),Rt.c(),wt(Rt,1),Rt.m(ft.parentNode,ft)):Rt&&(bt(),vt(Rt,1,1,(()=>{Rt=null})),yt())},i(t){dt||(wt(Rt),dt=!0)},o(t){vt(Rt),dt=!1},d(t){t&&I(e),O(Bt,t),It&&It.d(),Ot&&Ot.d(),t&&I(lt),Rt&&Rt.d(t),t&&I(ft),ht=!1,o(pt)}}}function Yx(e){let n;return{c(){n=R("div"),n.innerHTML='<span class="loading loading-spinner loading-lg"></span>',D(n,"class","flex justify-center items-center h-64")},m(t,e){B(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}function Xx(t){let e,n,r=t[9]+"";return{c(){e=R("div"),n=k(r),D(e,"class","badge badge-primary")},m(t,r){B(t,e,r),T(e,n)},p(t,e){2&e&&r!==(r=t[9]+"")&&C(n,r)},d(t){t&&I(e)}}}function Jx(t){let e,n,r,i,o=t[1].api_endpoints,s=[];for(let e=0;e<o.length;e+=1)s[e]=Qx(Gx(t,o,e));return{c(){e=R("div"),n=R("h3"),n.textContent="API Endpoints",r=L(),i=R("div");for(let t=0;t<s.length;t+=1)s[t].c();D(n,"class","font-semibold text-sm opacity-70 mb-2"),D(i,"class","flex flex-wrap gap-2"),D(e,"class","mt-4")},m(t,o){B(t,e,o),T(e,n),T(e,r),T(e,i);for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(i,null)},p(t,e){if(2&e){let n;for(o=t[1].api_endpoints,n=0;n<o.length;n+=1){const r=Gx(t,o,n);s[n]?s[n].p(r,e):(s[n]=Qx(r),s[n].c(),s[n].m(i,null))}for(;n<s.length;n+=1)s[n].d(1);s.length=o.length}},d(t){t&&I(e),O(s,t)}}}function Qx(t){let e,n,r=t[6]+"";return{c(){e=R("div"),n=k(r),D(e,"class","badge badge-secondary")},m(t,r){B(t,e,r),T(e,n)},p(t,e){2&e&&r!==(r=t[6]+"")&&C(n,r)},d(t){t&&I(e)}}}function t_(t){let e,n,r,i,o,s,a=t[1].decrypted_specifications+"";return{c(){e=R("div"),n=R("h3"),n.textContent="Specifications",r=L(),i=R("div"),o=R("pre"),s=k(a),D(n,"class","font-semibold text-sm opacity-70 mb-2"),D(o,"class","text-sm whitespace-pre-wrap"),D(i,"class","bg-base-200 p-3 rounded-lg"),D(e,"class","mt-4")},m(t,a){B(t,e,a),T(e,n),T(e,r),T(e,i),T(i,o),T(o,s)},p(t,e){2&e&&a!==(a=t[1].decrypted_specifications+"")&&C(s,a)},d(t){t&&I(e)}}}function e_(t){let e,n,r;return n=new Hx({props:{passportId:t[0]}}),{c(){e=R("div"),Nt(n.$$.fragment),D(e,"class","mt-6")},m(t,i){B(t,e,i),Bt(n,e,null),r=!0},p(t,e){const r={};1&e&&(r.passportId=t[0]),n.$set(r)},i(t){r||(wt(n.$$.fragment,t),r=!0)},o(t){vt(n.$$.fragment,t),r=!1},d(t){t&&I(e),It(n)}}}function n_(t){let e,n,r,i;const o=[Yx,Zx,Wx],s=[];function a(t,e){return t[2]?0:t[1]?1:2}return e=a(t),n=s[e]=o[e](t),{c(){n.c(),r=P()},m(t,n){s[e].m(t,n),B(t,r,n),i=!0},p(t,[i]){let c=e;e=a(t),e===c?s[e].p(t,i):(bt(),vt(s[c],1,1,(()=>{s[c]=null})),yt(),n=s[e],n?n.p(t,i):(n=s[e]=o[e](t),n.c()),wt(n,1),n.m(r.parentNode,r))},i(t){i||(wt(n),i=!0)},o(t){vt(n),i=!1},d(t){s[e].d(t),t&&I(r)}}}function r_(t){return new Date(Number(t)/1e6).toLocaleString()}function i_(t){return t?"badge-success":"badge-error"}function o_(t,e,n){let{passportId:r}=e,i=null,o=!0,s=!1;async function a(){n(2,o=!0);try{const t=u(vg);if(console.log(" PassportViewer - Loading passport, auth state:",{state:null==t?void 0:t.state,hasActor:!!(null==t?void 0:t.actor),hasClient:!!(null==t?void 0:t.client),passportId:String(r)}),!t||"initialized"!==t.state)return console.error(" PassportViewer - Authentication not initialized:",null==t?void 0:t.state),void Mp("Authentication required");const e=await t.actor.get_agent_passport(r);if(e.length>0&&(n(1,i=e[0]),i.encrypted_specifications))try{n(1,i.decrypted_specifications=await t.crypto.decryptWithNoteKey(r,i.owner,i.encrypted_specifications),i)}catch(t){console.warn("Could not decrypt specifications:",t),n(1,i.decrypted_specifications="[Encrypted]",i)}}catch(t){Mp(`Failed to load passport: ${t.message}`)}finally{n(2,o=!1)}}J((()=>{const t=u(vg);if(t&&"initialized"===t.state)a();else{const t=vg.subscribe((e=>{e&&"initialized"===e.state&&(a(),t())}))}}));return t.$$set=t=>{"passportId"in t&&n(0,r=t.passportId)},[r,i,o,s,a,()=>n(3,s=!s)]}class s_ extends $t{constructor(t){super(),Rt(this,t,o_,n_,a,{passportId:0})}}function a_(t,e,n){const r=t.slice();return r[7]=e[n],r}function c_(t,e,n){const r=t.slice();return r[10]=e[n],r}function u_(e){let n,r,i,o,s,a,c,u;function l(t,e){return t[1]?h_:0===t[0].length?d_:f_}let f=l(e),d=f(e);return{c(){n=R("div"),r=R("h2"),r.textContent="My Synthetic Datasets",i=L(),o=R("button"),o.textContent="Refresh",s=L(),d.c(),a=P(),D(r,"class","text-xl font-bold"),D(o,"class","btn btn-sm btn-outline"),D(n,"class","flex justify-between items-center")},m(t,l){B(t,n,l),T(n,r),T(n,i),T(n,o),B(t,s,l),d.m(t,l),B(t,a,l),c||(u=U(o,"click",e[3]),c=!0)},p(t,e){f===(f=l(t))&&d?d.p(t,e):(d.d(1),d=f(t),d&&(d.c(),d.m(a.parentNode,a)))},i:t,o:t,d(t){t&&I(n),t&&I(s),d.d(t),t&&I(a),c=!1,u()}}}function l_(t){let e,n,r,i,o,s,a,c,u;return s=new s_({props:{passportId:t[2]}}),{c(){e=R("div"),n=R("button"),n.textContent=" Back to List",r=L(),i=R("h2"),i.textContent="Dataset Details",o=L(),Nt(s.$$.fragment),D(n,"class","btn btn-sm btn-outline"),D(i,"class","text-lg font-semibold"),D(e,"class","flex items-center gap-2 mb-4")},m(l,f){B(l,e,f),T(e,n),T(e,r),T(e,i),B(l,o,f),Bt(s,l,f),a=!0,c||(u=U(n,"click",t[5]),c=!0)},p(t,e){const n={};4&e&&(n.passportId=t[2]),s.$set(n)},i(t){a||(wt(s.$$.fragment,t),a=!0)},o(t){vt(s.$$.fragment,t),a=!1},d(t){t&&I(e),t&&I(o),It(s,t),c=!1,u()}}}function f_(t){let e,n=t[0],r=[];for(let e=0;e<n.length;e+=1)r[e]=m_(a_(t,n,e));return{c(){e=R("div");for(let t=0;t<r.length;t+=1)r[t].c();D(e,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4")},m(t,n){B(t,e,n);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,null)},p(t,i){if(17&i){let o;for(n=t[0],o=0;o<n.length;o+=1){const s=a_(t,n,o);r[o]?r[o].p(s,i):(r[o]=m_(s),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(t){t&&I(e),O(r,t)}}}function d_(e){let n;return{c(){n=R("div"),n.innerHTML='<div class="text-gray-500 mb-4"><svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17H7A5 5 0 0 1 7 7h2m0 10v3a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-3m0 0V7a1 1 0 0 0-1-1H10a1 1 0 0 0-1 1v10z"></path></svg> \n          <p class="text-lg">No datasets found</p> \n          <p class="text-sm">Upload your first CSV or load sample data to get started!</p></div>',D(n,"class","text-center py-12")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function h_(e){let n;return{c(){n=R("div"),n.innerHTML='<span class="loading loading-spinner loading-lg"></span>',D(n,"class","flex justify-center items-center h-64")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function p_(t){let e,n,r=t[10]+"";return{c(){e=R("div"),n=k(r),D(e,"class","badge badge-primary badge-xs")},m(t,r){B(t,e,r),T(e,n)},p(t,e){1&e&&r!==(r=t[10]+"")&&C(n,r)},d(t){t&&I(e)}}}function g_(t){let e,n,r,i,o=t[7].capabilities.length-3+"";return{c(){e=R("div"),n=k("+"),r=k(o),i=k(" more"),D(e,"class","badge badge-ghost badge-xs")},m(t,o){B(t,e,o),T(e,n),T(e,r),T(e,i)},p(t,e){1&e&&o!==(o=t[7].capabilities.length-3+"")&&C(r,o)},d(t){t&&I(e)}}}function m_(t){let e,n,r,i,o,s,a,c,u,l,f,d,h,p,g,m,b,y,w,v,E,x,_,A,S,N,$,P,F,M,j,q=y_(t[7].agent_type)+"",V=t[7].agent_name+"",z=t[7].is_active?"Available":"Archived",H=w_(t[7].agent_type)+"",G=t[7].capabilities.length+"",K=v_(t[7].created_at)+"",W=t[7].capabilities.slice(0,3),Z=[];for(let e=0;e<W.length;e+=1)Z[e]=p_(c_(t,W,e));let Y=t[7].capabilities.length>3&&g_(t);function X(){return t[6](t[7])}return{c(){e=R("div"),n=R("div"),r=R("div"),i=R("div"),o=R("span"),s=k(q),a=L(),c=R("h3"),u=k(V),l=L(),f=R("div"),d=k(z),p=L(),g=R("div"),m=R("div"),b=k(H),y=L(),w=R("div"),v=k("Columns: "),E=k(G),x=k(" | Created: "),_=k(K),A=L(),S=R("div");for(let t=0;t<Z.length;t+=1)Z[t].c();N=L(),Y&&Y.c(),$=L(),P=R("div"),P.innerHTML='<button class="btn btn-primary btn-sm">View Dataset</button>',F=L(),D(o,"class","text-2xl"),D(c,"class","card-title text-lg"),D(i,"class","flex items-center gap-2"),D(f,"class",h="badge "+E_(t[7].is_active)+" text-xs"),D(r,"class","flex justify-between items-start mb-2"),D(m,"class","badge badge-outline"),D(w,"class","text-sm opacity-70"),D(S,"class","flex flex-wrap gap-1 mt-2"),D(g,"class","space-y-2"),D(P,"class","card-actions justify-end mt-4"),D(n,"class","card-body p-4"),D(e,"class","card bg-base-100 shadow-lg hover:shadow-xl transition-shadow cursor-pointer")},m(t,h){B(t,e,h),T(e,n),T(n,r),T(r,i),T(i,o),T(o,s),T(i,a),T(i,c),T(c,u),T(r,l),T(r,f),T(f,d),T(n,p),T(n,g),T(g,m),T(m,b),T(g,y),T(g,w),T(w,v),T(w,E),T(w,x),T(w,_),T(g,A),T(g,S);for(let t=0;t<Z.length;t+=1)Z[t]&&Z[t].m(S,null);T(S,N),Y&&Y.m(S,null),T(n,$),T(n,P),T(e,F),M||(j=U(e,"click",X),M=!0)},p(e,n){if(t=e,1&n&&q!==(q=y_(t[7].agent_type)+"")&&C(s,q),1&n&&V!==(V=t[7].agent_name+"")&&C(u,V),1&n&&z!==(z=t[7].is_active?"Available":"Archived")&&C(d,z),1&n&&h!==(h="badge "+E_(t[7].is_active)+" text-xs")&&D(f,"class",h),1&n&&H!==(H=w_(t[7].agent_type)+"")&&C(b,H),1&n&&G!==(G=t[7].capabilities.length+"")&&C(E,G),1&n&&K!==(K=v_(t[7].created_at)+"")&&C(_,K),1&n){let e;for(W=t[7].capabilities.slice(0,3),e=0;e<W.length;e+=1){const r=c_(t,W,e);Z[e]?Z[e].p(r,n):(Z[e]=p_(r),Z[e].c(),Z[e].m(S,N))}for(;e<Z.length;e+=1)Z[e].d(1);Z.length=W.length}t[7].capabilities.length>3?Y?Y.p(t,n):(Y=g_(t),Y.c(),Y.m(S,null)):Y&&(Y.d(1),Y=null)},d(t){t&&I(e),O(Z,t),Y&&Y.d(),M=!1,j()}}}function b_(t){let e,n,r,i;const o=[l_,u_],s=[];function a(t,e){return t[2]?0:1}return n=a(t),r=s[n]=o[n](t),{c(){e=R("div"),r.c(),D(e,"class","space-y-4")},m(t,r){B(t,e,r),s[n].m(e,null),i=!0},p(t,[i]){let c=n;n=a(t),n===c?s[n].p(t,i):(bt(),vt(s[c],1,1,(()=>{s[c]=null})),yt(),r=s[n],r?r.p(t,i):(r=s[n]=o[n](t),r.c()),wt(r,1),r.m(e,null))},i(t){i||(wt(r),i=!0)},o(t){vt(r),i=!1},d(t){t&&I(e),s[n].d()}}}function y_(t){switch(t){case"csv_dataset":return"";case"synthetic_dataset":return"";default:return""}}function w_(t){switch(t){case"csv_dataset":return"CSV Dataset";case"synthetic_dataset":return"Synthetic Data";default:return"Dataset"}}function v_(t){return new Date(Number(t)/1e6).toLocaleDateString()}function E_(t){return t?"badge-success":"badge-error"}function x_(t,e,n){let r=[],i=!0,o=null;async function s(){n(1,i=!0);try{const t=u(vg);if(console.log(" DatasetList - Loading datasets, auth state:",null==t?void 0:t.state),!t||"initialized"!==t.state)return console.error(" DatasetList - Authentication not initialized:",null==t?void 0:t.state),void Mp("Authentication required");console.log(" DatasetList - Calling get_my_passports..."),n(0,r=await t.actor.get_my_passports()),r.sort(((t,e)=>Number(e.created_at)-Number(t.created_at)))}catch(t){Mp(`Failed to load datasets: ${t.message}`)}finally{n(1,i=!1)}}function a(t){n(2,o=t)}J((()=>{const t=u(vg);if(t&&"initialized"===t.state)s();else{const t=vg.subscribe((e=>{e&&"initialized"===e.state&&(s(),t())}))}}));return[r,i,o,s,a,()=>n(2,o=null),t=>a(t.id)]}class __ extends $t{constructor(t){super(),Rt(this,t,x_,b_,a,{})}}function A_(e){let n;return{c(){n=R("div"),n.innerHTML='<div class="card bg-base-100 shadow-xl"><div class="card-body text-center"><div class="loading loading-spinner loading-lg"></div> \n        <p class="mt-4">Initializing authentication...</p></div></div>',D(n,"class","container mx-auto p-4 max-w-md")},m(t,e){B(t,n,e)},p:t,i:t,o:t,d(t){t&&I(n)}}}function T_(e){let n,r,i,o,s,a,c,u,l,f;return{c(){n=R("div"),r=R("div"),i=R("div"),o=R("h2"),o.textContent="Authentication Required",s=L(),a=R("p"),a.textContent="Please log in with Internet Identity to access your AI agent passports.",c=L(),u=R("button"),u.textContent="Login with Internet Identity",D(o,"class","card-title justify-center mb-4"),D(a,"class","mb-6"),D(u,"class","btn btn-primary"),D(i,"class","card-body text-center"),D(r,"class","card bg-base-100 shadow-xl"),D(n,"class","container mx-auto p-4 max-w-md")},m(t,e){B(t,n,e),T(n,r),T(r,i),T(i,o),T(i,s),T(i,a),T(i,c),T(i,u),l||(f=U(u,"click",Eg),l=!0)},p:t,i:t,o:t,d(t){t&&I(n),l=!1,f()}}}function S_(t){let e,n,r,i,s,a,c,u,l,f,d,h,p,g,m,b,y,w,v,E,x,_;const A=[O_,I_,B_,N_],S=[];function N(t,e){return"list"===t[1]?0:"upload"===t[1]?1:"sample"===t[1]?2:3}return w=N(t),v=S[w]=A[w](t),{c(){e=R("div"),n=R("div"),n.innerHTML='<h1 class="text-3xl font-bold mb-2">Synthetic Data Manager</h1> \n      <p class="text-gray-600">Upload, store, and manage your synthetic datasets with privacy controls</p>',r=L(),i=R("div"),s=R("button"),a=k("My Datasets"),u=L(),l=R("button"),f=k("Upload CSV"),h=L(),p=R("button"),g=k("Sample Data"),b=L(),y=R("div"),v.c(),D(n,"class","mb-6"),D(s,"class",c="tab "+("list"===t[1]?"tab-active":"")),D(l,"class",d="tab "+("upload"===t[1]?"tab-active":"")),D(p,"class",m="tab "+("sample"===t[1]?"tab-active":"")),D(i,"class","tabs tabs-boxed mb-6"),D(y,"class","tab-content svelte-v7wdpz"),D(e,"class","container mx-auto p-4 max-w-6xl")},m(o,c){B(o,e,c),T(e,n),T(e,r),T(e,i),T(i,s),T(s,a),T(i,u),T(i,l),T(l,f),T(i,h),T(i,p),T(p,g),T(e,b),T(e,y),S[w].m(y,null),E=!0,x||(_=[U(s,"click",t[5]),U(l,"click",t[6]),U(p,"click",t[7])],x=!0)},p(t,e){(!E||2&e&&c!==(c="tab "+("list"===t[1]?"tab-active":"")))&&D(s,"class",c),(!E||2&e&&d!==(d="tab "+("upload"===t[1]?"tab-active":"")))&&D(l,"class",d),(!E||2&e&&m!==(m="tab "+("sample"===t[1]?"tab-active":"")))&&D(p,"class",m);let n=w;w=N(t),w===n?S[w].p(t,e):(bt(),vt(S[n],1,1,(()=>{S[n]=null})),yt(),v=S[w],v?v.p(t,e):(v=S[w]=A[w](t),v.c()),wt(v,1),v.m(y,null))},i(t){E||(wt(v),E=!0)},o(t){vt(v),E=!1},d(t){t&&I(e),S[w].d(),x=!1,o(_)}}}function N_(e){let n,r,i,o;return{c(){n=R("div"),r=R("span"),i=k("Unknown tab: "),o=k(e[1]),D(n,"class","alert alert-warning")},m(t,e){B(t,n,e),T(n,r),T(r,i),T(r,o)},p(t,e){2&e&&C(o,t[1])},i:t,o:t,d(t){t&&I(n)}}}function B_(e){let n,r;return n=new Ox({}),n.$on("loaded",e[3]),{c(){Nt(n.$$.fragment)},m(t,e){Bt(n,t,e),r=!0},p:t,i(t){r||(wt(n.$$.fragment,t),r=!0)},o(t){vt(n.$$.fragment,t),r=!1},d(t){It(n,t)}}}function I_(e){let n,r;return n=new _x({}),n.$on("uploaded",e[3]),{c(){Nt(n.$$.fragment)},m(t,e){Bt(n,t,e),r=!0},p:t,i(t){r||(wt(n.$$.fragment,t),r=!0)},o(t){vt(n.$$.fragment,t),r=!1},d(t){It(n,t)}}}function O_(e){let n,r,i=e[2],o=R_();return{c(){o.c(),n=P()},m(t,e){o.m(t,e),B(t,n,e),r=!0},p(e,r){4&r&&a(i,i=e[2])?(bt(),vt(o,1,1,t),yt(),o=R_(),o.c(),wt(o,1),o.m(n.parentNode,n)):o.p(e,r)},i(t){r||(wt(o),r=!0)},o(t){vt(o),r=!1},d(t){t&&I(n),o.d(t)}}}function R_(e){let n,r;return n=new __({}),{c(){Nt(n.$$.fragment)},m(t,e){Bt(n,t,e),r=!0},p:t,i(t){r||(wt(n.$$.fragment,t),r=!0)},o(t){vt(n.$$.fragment,t),r=!1},d(t){It(n,t)}}}function $_(t){let e,n,r,i,o,s,a,c,u,l,f,d,h,p,g,m,b,y,w=(t[0]?.state||"undefined")+"",v=t[0]?.actor?"":"",E=t[0]?.client?"":"",x=t[0]?.crypto?"":"";const _=[S_,T_,A_],A=[];function S(t,e){return t[0]&&"initialized"===t[0].state?0:t[0]&&"anonymous"===t[0].state?1:2}return g=S(t),m=A[g]=_[g](t),{c(){e=R("div"),n=R("strong"),n.textContent=" Debug Info:",r=k(' Auth State = "'),i=k(w),o=k('" | \n  Actor: '),s=k(v),a=k(" | \n  Client: "),c=k(E),u=k(" | \n  Crypto: "),l=k(x),f=k(' | \n  Active Tab: "'),d=k(t[1]),h=k('"'),p=L(),m.c(),b=P(),D(e,"class","bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-4")},m(t,m){B(t,e,m),T(e,n),T(e,r),T(e,i),T(e,o),T(e,s),T(e,a),T(e,c),T(e,u),T(e,l),T(e,f),T(e,d),T(e,h),B(t,p,m),A[g].m(t,m),B(t,b,m),y=!0},p(t,[e]){(!y||1&e)&&w!==(w=(t[0]?.state||"undefined")+"")&&C(i,w),(!y||1&e)&&v!==(v=t[0]?.actor?"":"")&&C(s,v),(!y||1&e)&&E!==(E=t[0]?.client?"":"")&&C(c,E),(!y||1&e)&&x!==(x=t[0]?.crypto?"":"")&&C(l,x),(!y||2&e)&&C(d,t[1]);let n=g;g=S(t),g===n?A[g].p(t,e):(bt(),vt(A[n],1,1,(()=>{A[n]=null})),yt(),m=A[g],m?m.p(t,e):(m=A[g]=_[g](t),m.c()),wt(m,1),m.m(b.parentNode,b))},i(t){y||(wt(m),y=!0)},o(t){vt(m),y=!1},d(t){t&&I(e),t&&I(p),A[g].d(t),t&&I(b)}}}function k_(t,e,n){let r;l(t,vg,(t=>n(0,r=t)));let i="list",o=0;function s(t){console.log(" Switching to tab:",t),n(1,i=t),console.log(" Active tab is now:",i)}return t.$$.update=()=>{1&t.$$.dirty&&console.log(" Passports.svelte - Auth State Debug:",{state:null==r?void 0:r.state,hasActor:!!(null==r?void 0:r.actor),hasClient:!!(null==r?void 0:r.client),hasCrypto:!!(null==r?void 0:r.crypto),timestamp:(new Date).toISOString()})},[r,i,o,function(){n(1,i="list"),n(2,o++,o)},s,()=>s("list"),()=>{console.log(" Upload CSV button clicked"),s("upload")},()=>s("sample")]}class L_ extends $t{constructor(t){super(),Rt(this,t,k_,$_,a,{})}}function P_(e){let n;return{c(){n=$("path"),D(n,"d","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-32 252c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92H92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function U_(t){let e,r;const i=[{viewBox:"0 0 448 512"},t[0]];let o={$$slots:{default:[P_]},$$scope:{ctx:t}};for(let t=0;t<i.length;t+=1)o=n(o,i[t]);return e=new qv({props:o}),{c(){Nt(e.$$.fragment)},m(t,n){Bt(e,t,n),r=!0},p(t,[n]){const r=1&n?Tt(i,[i[0],St(t[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){r||(wt(e.$$.fragment,t),r=!0)},o(t){vt(e.$$.fragment,t),r=!1},d(t){It(e,t)}}}function D_(t,e,r){return t.$$set=t=>{r(0,e=n(n({},e),m(t)))},[e=m(e)]}class C_ extends $t{constructor(t){super(),Rt(this,t,D_,U_,a,{})}}function F_(e){let n;return{c(){n=$("path"),D(n,"d","M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function M_(t){let e,r;const i=[{viewBox:"0 0 448 512"},t[0]];let o={$$slots:{default:[F_]},$$scope:{ctx:t}};for(let t=0;t<i.length;t+=1)o=n(o,i[t]);return e=new qv({props:o}),{c(){Nt(e.$$.fragment)},m(t,n){Bt(e,t,n),r=!0},p(t,[n]){const r=1&n?Tt(i,[i[0],St(t[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){r||(wt(e.$$.fragment,t),r=!0)},o(t){vt(e.$$.fragment,t),r=!1},d(t){It(e,t)}}}function j_(t,e,r){return t.$$set=t=>{r(0,e=n(n({},e),m(t)))},[e=m(e)]}class q_ extends $t{constructor(t){super(),Rt(this,t,j_,M_,a,{})}}function V_(e){let n;return{c(){n=$("path"),D(n,"d","M272 0H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h224c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48zM160 480c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm112-108c0 6.6-5.4 12-12 12H60c-6.6 0-12-5.4-12-12V60c0-6.6 5.4-12 12-12h200c6.6 0 12 5.4 12 12v312z")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function z_(t){let e,r;const i=[{viewBox:"0 0 320 512"},t[0]];let o={$$slots:{default:[V_]},$$scope:{ctx:t}};for(let t=0;t<i.length;t+=1)o=n(o,i[t]);return e=new qv({props:o}),{c(){Nt(e.$$.fragment)},m(t,n){Bt(e,t,n),r=!0},p(t,[n]){const r=1&n?Tt(i,[i[0],St(t[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){r||(wt(e.$$.fragment,t),r=!0)},o(t){vt(e.$$.fragment,t),r=!1},d(t){It(e,t)}}}function H_(t,e,r){return t.$$set=t=>{r(0,e=n(n({},e),m(t)))},[e=m(e)]}class G_ extends $t{constructor(t){super(),Rt(this,t,H_,z_,a,{})}}function K_(e){let n;return{c(){n=$("path"),D(n,"d","M624 448h-80V113.45C544 86.19 522.47 64 496 64H384v64h96v384h144c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM312.24 1.01l-192 49.74C105.99 54.44 96 67.7 96 82.92V448H16c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h336V33.18c0-21.58-19.56-37.41-39.76-32.17zM264 288c-13.25 0-24-14.33-24-32s10.75-32 24-32 24 14.33 24 32-10.75 32-24 32z")},m(t,e){B(t,n,e)},p:t,d(t){t&&I(n)}}}function W_(t){let e,r;const i=[{viewBox:"0 0 640 512"},t[0]];let o={$$slots:{default:[K_]},$$scope:{ctx:t}};for(let t=0;t<i.length;t+=1)o=n(o,i[t]);return e=new qv({props:o}),{c(){Nt(e.$$.fragment)},m(t,n){Bt(e,t,n),r=!0},p(t,[n]){const r=1&n?Tt(i,[i[0],St(t[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){r||(wt(e.$$.fragment,t),r=!0)},o(t){vt(e.$$.fragment,t),r=!1},d(t){It(e,t)}}}function Z_(t,e,r){return t.$$set=t=>{r(0,e=n(n({},e),m(t)))},[e=m(e)]}class Y_ extends $t{constructor(t){super(),Rt(this,t,Z_,W_,a,{})}}function X_(t){const e=t-1;return e*e*e+1}function J_(t,{delay:n=0,duration:r=400,easing:i=e}={}){const o=+getComputedStyle(t).opacity;return{delay:n,duration:r,easing:i,css:t=>"opacity: "+t*o}}function Q_(t,{delay:e=0,duration:n=400,easing:r=X_,x:i=0,y:o=0,opacity:s=0}={}){const a=getComputedStyle(t),c=+a.opacity,u="none"===a.transform?"":a.transform,l=c*(1-s),[f,d]=y(i),[h,p]=y(o);return{delay:e,duration:n,easing:r,css:(t,e)=>`\n\t\t\ttransform: ${u} translate(${(1-t)*f}${d}, ${(1-t)*h}${p});\n\t\t\topacity: ${c-l*e}`}}function tA(e){let n,r,i,o,s,a,c,u,l;return i=new Tg({}),{c(){n=R("div"),r=R("p"),Nt(i.$$.fragment),o=L(),s=R("button"),s.textContent="I understand",D(r,"class","opacity-90 sm:flex-1"),D(s,"class","btn btn-outline btn-xs sm:btn-sm sm:self-start mt-4 sm:mt-0 sm:ml-4 opacity-90"),D(n,"class","sticky bottom-0 p-4 text-xs bg-base-300 mt-4 sm:flex")},m(t,a){B(t,n,a),T(n,r),Bt(i,r,null),T(n,o),T(n,s),c=!0,u||(l=U(s,"click",e[1]),u=!0)},p:t,i(t){c||(wt(i.$$.fragment,t),a&&a.end(1),c=!0)},o(t){vt(i.$$.fragment,t),a=xt(n,Q_,{y:50}),c=!1},d(t){t&&I(n),It(i),t&&a&&a.end(),u=!1,l()}}}function eA(t){let e,n,r=!t[0]&&tA(t);return{c(){r&&r.c(),e=P()},m(t,i){r&&r.m(t,i),B(t,e,i),n=!0},p(t,[n]){t[0]?r&&(bt(),vt(r,1,1,(()=>{r=null})),yt()):r?(r.p(t,n),1&n&&wt(r,1)):(r=tA(t),r.c(),wt(r,1),r.m(e.parentNode,e))},i(t){n||(wt(r),n=!0)},o(t){vt(r),n=!1},d(t){r&&r.d(t),t&&I(e)}}}function nA(t,e,n){let r=!!window.localStorage.getItem("disclaimer-dismissed");return[r,function(){window.localStorage.setItem("disclaimer-dismissed","yes"),n(0,r=!0)}]}class rA extends $t{constructor(t){super(),Rt(this,t,nA,eA,a,{})}}function iA(t){let e,n,r,i,o,s,a,c,u,l,d,m,b,y,w,v,E,x,_,A,S,N,O,$,P,F,M,j,q,V,z,H,G,K,W,Z,Y,X,J,Q,tt,et,nt,rt,it,ot,st,at,ct,ut,lt,ft=t[0].client.getIdentity().getPrincipal()+"";const dt=t[2].default,ht=f(dt,t,t[1],null);return a=new rA({}),P=new G_({}),z=new C_({}),Y=new q_({}),it=new Y_({}),{c(){e=R("div"),n=R("input"),r=L(),i=R("div"),o=R("div"),ht&&ht.c(),s=L(),Nt(a.$$.fragment),c=L(),u=R("div"),l=R("label"),d=L(),m=R("aside"),b=R("div"),b.textContent="AI Passport",y=L(),w=R("div"),v=R("div"),v.textContent="My Principal:",E=L(),x=R("div"),_=k(ft),A=L(),S=R("ul"),N=R("li"),O=R("a"),$=R("span"),Nt(P.$$.fragment),F=k("\n            Agent Passports"),M=L(),j=R("li"),q=R("a"),V=R("span"),Nt(z.$$.fragment),H=k("\n            New note"),G=L(),K=R("li"),W=R("a"),Z=R("span"),Nt(Y.$$.fragment),X=k("\n            Your notes"),J=L(),Q=R("li"),tt=L(),et=R("li"),nt=R("button"),rt=R("span"),Nt(it.$$.fragment),ot=k("\n            Log out"),st=L(),at=R("div"),at.innerHTML='<img src="/img/ic-badge-powered-by-crypto_transparent-white-text.png" alt="Powered by the Internet Computer" class="hidden dark:inline "/> \n        <img src="/img/ic-badge-powered-by-crypto_transparent-dark-text.png" alt="Powered by the Internet Computer" class="dark:hidden inline "/>',D(n,"id","my-drawer-3"),D(n,"type","checkbox"),D(n,"class","drawer-toggle"),D(o,"class","flex-1"),D(i,"class","flex flex-col drawer-content lg:!z-[1000]"),D(l,"for","my-drawer-3"),D(l,"class","drawer-overlay"),D(b,"class","sticky h-16 py-4 pl-5 text-2xl font-bold border-b border-base-300 text-primary dark:text-white"),D(v,"class","pl-4"),D(x,"class","pl-4"),D(w,"class","border-b"),D($,"class","w-6 h-6 p-1 mr-2"),D(O,"href","/passports"),D(V,"class","w-6 h-6 p-1 mr-2"),D(q,"href","/"),D(Z,"class","w-6 h-6 p-1 mr-2"),D(W,"href","/notes"),D(Q,"class","flex-1"),D(rt,"class","w-6 h-6 p-1 mr-2"),D(S,"class","p-4 overflow-y-auto menu w-full bg-base-100 flex-1 flex flex-col"),D(at,"class","px-5 pb-4"),D(m,"class","flex flex-col justify-between border-r border-base-300 bg-base-100 text-base-content w-64 sm:w-80 "),D(u,"class","drawer-side"),D(e,"class","bg-base-200 drawer drawer-mobile min-h-screen")},m(f,h){B(f,e,h),T(e,n),T(e,r),T(e,i),T(i,o),ht&&ht.m(o,null),T(i,s),Bt(a,i,null),T(e,c),T(e,u),T(u,l),T(u,d),T(u,m),T(m,b),T(m,y),T(m,w),T(w,v),T(w,E),T(w,x),T(x,_),T(m,A),T(m,S),T(S,N),T(N,O),T(O,$),Bt(P,$,null),T(O,F),T(S,M),T(S,j),T(j,q),T(q,V),Bt(z,V,null),T(q,H),T(S,G),T(S,K),T(K,W),T(W,Z),Bt(Y,Z,null),T(W,X),T(S,J),T(S,Q),T(S,tt),T(S,et),T(et,nt),T(nt,rt),Bt(it,rt,null),T(nt,ot),T(m,st),T(m,at),ct=!0,ut||(lt=U(nt,"click",t[3]),ut=!0)},p(t,[e]){ht&&ht.p&&(!ct||2&e)&&p(ht,dt,t,t[1],ct?h(dt,t[1],e,null):g(t[1]),null),(!ct||1&e)&&ft!==(ft=t[0].client.getIdentity().getPrincipal()+"")&&C(_,ft)},i(t){ct||(wt(ht,t),wt(a.$$.fragment,t),wt(P.$$.fragment,t),wt(z.$$.fragment,t),wt(Y.$$.fragment,t),wt(it.$$.fragment,t),ct=!0)},o(t){vt(ht,t),vt(a.$$.fragment,t),vt(P.$$.fragment,t),vt(z.$$.fragment,t),vt(Y.$$.fragment,t),vt(it.$$.fragment,t),ct=!1},d(t){t&&I(e),ht&&ht.d(t),It(a),It(P),It(z),It(Y),It(it),ut=!1,lt()}}}function oA(t,e,n){let r;l(t,vg,(t=>n(0,r=t)));let{$$slots:i={},$$scope:o}=e;return t.$$set=t=>{"$$scope"in t&&n(1,o=t.$$scope)},[r,o,i,()=>xg()]}class sA extends $t{constructor(t){super(),Rt(this,t,oA,iA,a,{})}}function aA(e){let n,r;return n=new wg({props:{routes:e[0]}}),{c(){Nt(n.$$.fragment)},m(t,e){Bt(n,t,e),r=!0},p:t,i(t){r||(wt(n.$$.fragment,t),r=!0)},o(t){vt(n.$$.fragment,t),r=!1},d(t){It(n,t)}}}function cA(t){let e,n;return e=new sA({props:{$$slots:{default:[aA]},$$scope:{ctx:t}}}),{c(){Nt(e.$$.fragment)},m(t,r){Bt(e,t,r),n=!0},p(t,[n]){const r={};2&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(wt(e.$$.fragment,t),n=!0)},o(t){vt(e.$$.fragment,t),n=!1},d(t){It(e,t)}}}function uA(t){return[[{name:"/",component:WE},{name:"/notes",nestedRoutes:[{name:"index",component:gx},{name:"edit/:id",component:qE}]},{name:"/passports",component:L_}]]}class lA extends $t{constructor(t){super(),Rt(this,t,uA,cA,a,{})}}function fA(t,e,n){const r=t.slice();return r[2]=e[n],r}function dA(n,r){let i,o,a,c,u,l,f,d,h=r[2].message+"";return{key:n,first:null,c(){i=R("div"),o=R("p"),a=k(h),c=L(),D(i,"class",u="alert "+r[1][r[2].type]+" bg-opacity-100 text-white"),this.first=i},m(t,e){B(t,i,e),T(i,o),T(o,a),T(i,c),d=!0},p(t,e){r=t,(!d||1&e)&&h!==(h=r[2].message+"")&&C(a,h),(!d||1&e&&u!==(u="alert "+r[1][r[2].type]+" bg-opacity-100 text-white"))&&D(i,"class",u)},i(n){d||(at((()=>{d&&(f&&f.end(1),l=function(n,r,i){const o={direction:"in"};let a,c,u=r(n,i,o),l=!1,f=0;function d(){a&&Z(n,a)}function h(){const{delay:r=0,duration:i=300,easing:o=e,tick:s=t,css:h}=u||Et;h&&(a=W(n,0,1,i,r,o,h,f++)),s(0,1);const p=v()+r,g=p+i;c&&c.abort(),l=!0,at((()=>pt(n,!0,"start"))),c=A((t=>{if(l){if(t>=g)return s(1,0),pt(n,!0,"end"),d(),l=!1;if(t>=p){const e=o((t-p)/i);s(e,1-e)}}return l}))}let p=!1;return{start(){p||(p=!0,Z(n),s(u)?(u=u(o),ht().then(h)):h())},invalidate(){p=!1},end(){l&&(d(),l=!1)}}}(i,Q_,{x:100,duration:200}),l.start())})),d=!0)},o(t){l&&l.invalidate(),f=xt(i,J_,{}),d=!1},d(t){t&&I(i),t&&f&&f.end()}}}function hA(t){let e,n,r=[],i=new Map,o=t[0];const s=t=>t[2].id;for(let e=0;e<o.length;e+=1){let n=fA(t,o,e),a=s(n);i.set(a,r[e]=dA(a,n))}return{c(){e=R("div");for(let t=0;t<r.length;t+=1)r[t].c();D(e,"class","absolute right-4 bottom-4 flex flex-col max-w-xs space-y-4")},m(t,i){B(t,e,i);for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,null);n=!0},p(t,[n]){3&n&&(o=t[0],bt(),r=At(r,n,s,1,t,o,i,e,_t,dA,null,fA),yt())},i(t){if(!n){for(let t=0;t<o.length;t+=1)wt(r[t]);n=!0}},o(t){for(let t=0;t<r.length;t+=1)vt(r[t]);n=!1},d(t){t&&I(e);for(let t=0;t<r.length;t+=1)r[t].d()}}}function pA(t,e,n){let r;l(t,Cp,(t=>n(0,r=t)));return[r,{info:"alert-info",error:"alert-error",success:"alert-success"}]}class gA extends $t{constructor(t){super(),Rt(this,t,pA,hA,a,{})}}function mA(t){let e,n;return e=new Lg({props:{auth:t[0]}}),{c(){Nt(e.$$.fragment)},m(t,r){Bt(e,t,r),n=!0},p(t,n){const r={};1&n&&(r.auth=t[0]),e.$set(r)},i(t){n||(wt(e.$$.fragment,t),n=!0)},o(t){vt(e.$$.fragment,t),n=!1},d(t){It(e,t)}}}function bA(e){let n,r;return n=new lA({}),{c(){Nt(n.$$.fragment)},m(t,e){Bt(n,t,e),r=!0},p:t,i(t){r||(wt(n.$$.fragment,t),r=!0)},o(t){vt(n.$$.fragment,t),r=!1},d(t){It(n,t)}}}function yA(t){let e,n,r,i,o;const s=[bA,mA],a=[];function c(t,e){return"initialized"===t[0].state?0:1}return e=c(t),n=a[e]=s[e](t),i=new gA({}),{c(){n.c(),r=L(),Nt(i.$$.fragment)},m(t,n){a[e].m(t,n),B(t,r,n),Bt(i,t,n),o=!0},p(t,[i]){let o=e;e=c(t),e===o?a[e].p(t,i):(bt(),vt(a[o],1,1,(()=>{a[o]=null})),yt(),n=a[e],n?n.p(t,i):(n=a[e]=s[e](t),n.c()),wt(n,1),n.m(r.parentNode,r))},i(t){o||(wt(n),wt(i.$$.fragment,t),o=!0)},o(t){vt(n),vt(i.$$.fragment,t),o=!1},d(t){a[e].d(t),t&&I(r),It(i,t)}}}function wA(t,e,n){let r;return l(t,vg,(t=>n(0,r=t))),[r]}class vA extends $t{constructor(t){super(),Rt(this,t,wA,yA,a,{})}}(async()=>{new vA({target:document.body})})()}();
//# sourceMappingURL=main.js.map
