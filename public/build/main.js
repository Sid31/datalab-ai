!function(){"use strict";function t(){}!function(){const t={DFX_NETWORK:"local",CANISTER_ID_ENCRYPTED_NOTES:"uxrrr-q7777-77774-qaaaq-cai"};try{if(process)return process.env=Object.assign({},process.env),void Object.assign(process.env,t)}catch(t){}globalThis.process={env:t}}();const e=t=>t;function r(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(r)}function o(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(e,...r){if(null==e)return t;const n=e.subscribe(...r);return n.unsubscribe?()=>n.unsubscribe():n}function c(t){let e;return a(t,(t=>e=t))(),e}function u(t,e,r){t.$$.on_destroy.push(a(e,r))}function f(t){const e="string"==typeof t&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}const l="undefined"!=typeof window;let d=l?()=>window.performance.now():()=>Date.now(),h=l?t=>requestAnimationFrame(t):t;const p=new Set;function g(t){p.forEach((e=>{e.c(t)||(p.delete(e),e.f())})),0!==p.size&&h(g)}function b(t){let e;return 0===p.size&&h(g),{promise:new Promise((r=>{p.add(e={c:t,f:r})})),abort(){p.delete(e)}}}function y(t,e){t.appendChild(e)}function m(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function w(t){const e=x("style");return function(t,e){y(t.head||t,e),e.sheet}(m(t),e),e.sheet}function v(t,e,r){t.insertBefore(e,r||null)}function E(t){t.parentNode&&t.parentNode.removeChild(t)}function _(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function x(t){return document.createElement(t)}function B(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function I(t){return document.createTextNode(t)}function A(){return I(" ")}function S(){return I("")}function T(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function N(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function O(t,e){e=""+e,t.data!==e&&(t.data=e)}function R(t,e){t.value=null==e?"":e}function U(t,e,r){for(let r=0;r<t.options.length;r+=1){const n=t.options[r];if(n.__value===e)return void(n.selected=!0)}r&&void 0===e||(t.selectedIndex=-1)}function P(t){const e=t.querySelector(":checked");return e&&e.__value}function k(t,e,r){t.classList[r?"add":"remove"](e)}function F(t,e,{bubbles:r=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,r,n,e),i}const L=new Map;let C,D=0;function j(t,e,r,n,i,o,s,a=0){const c=16.666/n;let u="{\n";for(let t=0;t<=1;t+=c){const n=e+(r-e)*o(t);u+=100*t+`%{${s(n,1-n)}}\n`}const f=u+`100% {${s(r,1-r)}}\n}`,l=`__svelte_${function(t){let e=5381,r=t.length;for(;r--;)e=(e<<5)-e^t.charCodeAt(r);return e>>>0}(f)}_${a}`,d=m(t),{stylesheet:h,rules:p}=L.get(d)||function(t,e){const r={stylesheet:w(e),rules:{}};return L.set(t,r),r}(d,t);p[l]||(p[l]=!0,h.insertRule(`@keyframes ${l} ${f}`,h.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${l} ${n}ms linear ${i}ms 1 both`,D+=1,l}function $(t,e){const r=(t.style.animation||"").split(", "),n=r.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=r.length-n.length;i&&(t.style.animation=n.join(", "),D-=i,D||h((()=>{D||(L.forEach((t=>{const{ownerNode:e}=t.stylesheet;e&&E(e)})),L.clear())})))}function q(t){C=t}function M(){if(!C)throw new Error("Function called outside component initialization");return C}function V(t){M().$$.on_mount.push(t)}function z(){const t=M();return(e,r,{cancelable:n=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=F(e,r,{cancelable:n});return i.slice().forEach((e=>{e.call(t,o)})),!o.defaultPrevented}return!0}}const G=[],K=[];let H=[];const Z=[],W=Promise.resolve();let Y=!1;function J(t){H.push(t)}const X=new Set;let Q,tt=0;function et(){if(0!==tt)return;const t=C;do{try{for(;tt<G.length;){const t=G[tt];tt++,q(t),rt(t.$$)}}catch(t){throw G.length=0,tt=0,t}for(q(null),G.length=0,tt=0;K.length;)K.pop()();for(let t=0;t<H.length;t+=1){const e=H[t];X.has(e)||(X.add(e),e())}H.length=0}while(G.length);for(;Z.length;)Z.pop()();Y=!1,X.clear(),q(t)}function rt(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(J)}}function nt(){return Q||(Q=Promise.resolve(),Q.then((()=>{Q=null}))),Q}function it(t,e,r){t.dispatchEvent(F(`${e?"intro":"outro"}${r}`))}const ot=new Set;let st;function at(){st={r:0,c:[],p:st}}function ct(){st.r||i(st.c),st=st.p}function ut(t,e){t&&t.i&&(ot.delete(t),t.i(e))}function ft(t,e,r,n){if(t&&t.o){if(ot.has(t))return;ot.add(t),st.c.push((()=>{ot.delete(t),n&&(r&&t.d(1),n())})),t.o(e)}else n&&n()}const lt={duration:0};function dt(t,e){ft(t,1,1,(()=>{e.delete(t.key)}))}function ht(t){t&&t.c()}function pt(t,e,n,s){const{fragment:a,after_update:c}=t.$$;a&&a.m(e,n),s||J((()=>{const e=t.$$.on_mount.map(r).filter(o);t.$$.on_destroy?t.$$.on_destroy.push(...e):i(e),t.$$.on_mount=[]})),c.forEach(J)}function gt(t,e){const r=t.$$;null!==r.fragment&&(!function(t){const e=[],r=[];H.forEach((n=>-1===t.indexOf(n)?e.push(n):r.push(n))),r.forEach((t=>t())),H=e}(r.after_update),i(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function bt(t,e){-1===t.$$.dirty[0]&&(G.push(t),Y||(Y=!0,W.then(et)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function yt(e,r,o,s,a,c,u,f=[-1]){const l=C;q(e);const d=e.$$={fragment:null,ctx:[],props:c,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(l?l.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:r.target||l.$$.root};u&&u(d.root);let h=!1;if(d.ctx=o?o(e,r.props||{},((t,r,...n)=>{const i=n.length?n[0]:r;return d.ctx&&a(d.ctx[t],d.ctx[t]=i)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](i),h&&bt(e,t)),r})):[],d.update(),h=!0,i(d.before_update),d.fragment=!!s&&s(d.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);d.fragment&&d.fragment.l(t),t.forEach(E)}else d.fragment&&d.fragment.c();r.intro&&ut(e.$$.fragment),pt(e,r.target,r.anchor,r.customElement),et()}q(l)}class mt{$destroy(){gt(this,1),this.$destroy=t}$on(e,r){if(!o(r))return t;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const t=n.indexOf(r);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const wt=[];function vt(e,r=t){let n;const i=new Set;function o(t){if(s(e,t)&&(e=t,n)){const t=!wt.length;for(const t of i)t[1](),wt.push(t,e);if(t){for(let t=0;t<wt.length;t+=2)wt[t][0](wt[t+1]);wt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const c=[s,a];return i.add(c),1===i.size&&(n=r(o)||t),s(e),()=>{i.delete(c),0===i.size&&n&&(n(),n=null)}}}}var Et="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function _t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}for(var xt={},Bt={byteLength:function(t){var e=Ot(t),r=e[0],n=e[1];return 3*(r+n)/4-n},toByteArray:function(t){var e,r,n=Ot(t),i=n[0],o=n[1],s=new St(function(t,e,r){return 3*(e+r)/4-r}(0,i,o)),a=0,c=o>0?i-4:i;for(r=0;r<c;r+=4)e=At[t.charCodeAt(r)]<<18|At[t.charCodeAt(r+1)]<<12|At[t.charCodeAt(r+2)]<<6|At[t.charCodeAt(r+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===o&&(e=At[t.charCodeAt(r)]<<2|At[t.charCodeAt(r+1)]>>4,s[a++]=255&e);1===o&&(e=At[t.charCodeAt(r)]<<10|At[t.charCodeAt(r+1)]<<4|At[t.charCodeAt(r+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},fromByteArray:function(t){for(var e,r=t.length,n=r%3,i=[],o=16383,s=0,a=r-n;s<a;s+=o)i.push(Rt(t,s,s+o>a?a:s+o));1===n?(e=t[r-1],i.push(It[e>>2]+It[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],i.push(It[e>>10]+It[e>>4&63]+It[e<<2&63]+"="));return i.join("")}},It=[],At=[],St="undefined"!=typeof Uint8Array?Uint8Array:Array,Tt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Nt=0;Nt<64;++Nt)It[Nt]=Tt[Nt],At[Tt.charCodeAt(Nt)]=Nt;function Ot(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function Rt(t,e,r){for(var n,i,o=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(It[(i=n)>>18&63]+It[i>>12&63]+It[i>>6&63]+It[63&i]);return o.join("")}At["-".charCodeAt(0)]=62,At["_".charCodeAt(0)]=63;var Ut,Pt={};Pt.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,u=c>>1,f=-7,l=r?i-1:0,d=r?-1:1,h=t[e+l];for(l+=d,o=h&(1<<-f)-1,h>>=-f,f+=a;f>0;o=256*o+t[e+l],l+=d,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=n;f>0;s=256*s+t[e+l],l+=d,f-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,n),o-=u}return(h?-1:1)*s*Math.pow(2,o-n)},Pt.write=function(t,e,r,n,i,o){var s,a,c,u=8*o-i-1,f=(1<<u)-1,l=f>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:o-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+l>=1?d/c:d*Math.pow(2,1-l))*c>=2&&(s++,c/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(e*c-1)*Math.pow(2,i),s+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[r+h]=255&a,h+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[r+h]=255&s,h+=p,s/=256,u-=8);t[r+h-p]|=128*g},function(t){const e=Bt,r=Pt,n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=function(t){+t!=t&&(t=0);return s.alloc(+t)},t.INSPECT_MAX_BYTES=50;const i=2147483647;function o(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return a(t,e,r)}function a(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=0|h(t,e);let n=o(r);const i=n.write(t,e);i!==r&&(n=n.slice(0,i));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(H(t,Uint8Array)){const e=new Uint8Array(t);return l(e.buffer,e.byteOffset,e.byteLength)}return f(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(H(t,ArrayBuffer)||t&&H(t.buffer,ArrayBuffer))return l(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(H(t,SharedArrayBuffer)||t&&H(t.buffer,SharedArrayBuffer)))return l(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return s.from(n,e,r);const i=function(t){if(s.isBuffer(t)){const e=0|d(t.length),r=o(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||Z(t.length)?o(0):f(t);if("Buffer"===t.type&&Array.isArray(t.data))return f(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return c(t),o(t<0?0:0|d(t))}function f(t){const e=t.length<0?0:0|d(t.length),r=o(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function l(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,s.prototype),n}function d(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function h(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||H(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(t).length;default:if(i)return n?-1:z(t).length;e=(""+e).toLowerCase(),i=!0}}function p(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,r);case"utf8":case"utf-8":return B(this,e,r);case"ascii":return A(this,e,r);case"latin1":case"binary":return S(this,e,r);case"base64":return x(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function b(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=s.from(e,n)),s.isBuffer(e))return 0===e.length?-1:y(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):y(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function y(t,e,r,n,i){let o,s=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){let n=-1;for(o=r;o<a;o++)if(u(t,o)===u(e,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===c)return n*s}else-1!==n&&(o-=o-n),n=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){let r=!0;for(let n=0;n<c;n++)if(u(t,o+n)!==u(e,n)){r=!1;break}if(r)return o}return-1}function m(t,e,r,n){r=Number(r)||0;const i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=e.length;let s;for(n>o/2&&(n=o/2),s=0;s<n;++s){const n=parseInt(e.substr(2*s,2),16);if(Z(n))return s;t[r+s]=n}return s}function w(t,e,r,n){return K(z(e,t.length-r),t,r,n)}function v(t,e,r,n){return K(function(t){const e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function E(t,e,r,n){return K(G(e),t,r,n)}function _(t,e,r,n){return K(function(t,e){let r,n,i;const o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function x(t,r,n){return 0===r&&n===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(r,n))}function B(t,e,r){r=Math.min(t.length,r);const n=[];let i=e;for(;i<r;){const e=t[i];let o=null,s=e>239?4:e>223?3:e>191?2:1;if(i+s<=r){let r,n,a,c;switch(s){case 1:e<128&&(o=e);break;case 2:r=t[i+1],128==(192&r)&&(c=(31&e)<<6|63&r,c>127&&(o=c));break;case 3:r=t[i+1],n=t[i+2],128==(192&r)&&128==(192&n)&&(c=(15&e)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:r=t[i+1],n=t[i+2],a=t[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return function(t){const e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=I));return r}(n)}t.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,r){return a(t,e,r)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,r){return function(t,e,r){return c(t),t<=0?o(t):void 0!==e?"string"==typeof r?o(t).fill(e,r):o(t).fill(e):o(t)}(t,e,r)},s.allocUnsafe=function(t){return u(t)},s.allocUnsafeSlow=function(t){return u(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(H(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),H(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;const n=s.allocUnsafe(e);let i=0;for(r=0;r<t.length;++r){let e=t[r];if(H(e,Uint8Array))i+e.length>n.length?(s.isBuffer(e)||(e=s.from(e)),e.copy(n,i)):Uint8Array.prototype.set.call(n,e,i);else{if(!s.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,i)}i+=e.length}return n},s.byteLength=h,s.prototype._isBuffer=!0,s.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)g(this,e,e+1);return this},s.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},s.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},s.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?B(this,0,t):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},n&&(s.prototype[n]=s.prototype.inspect),s.prototype.compare=function(t,e,r,n,i){if(H(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;let o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0);const c=Math.min(o,a),u=this.slice(n,i),f=t.slice(e,r);for(let t=0;t<c;++t)if(u[t]!==f[t]){o=u[t],a=f[t];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},s.prototype.indexOf=function(t,e,r){return b(this,t,e,r,!0)},s.prototype.lastIndexOf=function(t,e,r){return b(this,t,e,r,!1)},s.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return m(this,t,e,r);case"utf8":case"utf-8":return w(this,t,e,r);case"ascii":case"latin1":case"binary":return v(this,t,e,r);case"base64":return E(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function A(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function S(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function T(t,e,r){const n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=e;n<r;++n)i+=W[t[n]];return i}function N(t,e,r){const n=t.slice(e,r);let i="";for(let t=0;t<n.length-1;t+=2)i+=String.fromCharCode(n[t]+256*n[t+1]);return i}function O(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,r,n,i,o){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function U(t,e,r,n,i){$(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,r}function P(t,e,r,n,i){$(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r+7]=o,o>>=8,t[r+6]=o,o>>=8,t[r+5]=o,o>>=8,t[r+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=s,s>>=8,t[r+2]=s,s>>=8,t[r+1]=s,s>>=8,t[r]=s,r+8}function k(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(t,e,n,i,o){return e=+e,n>>>=0,o||k(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function L(t,e,n,i,o){return e=+e,n>>>=0,o||k(t,0,n,8),r.write(t,e,n,i,52,8),n+8}s.prototype.slice=function(t,e){const r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,s.prototype),n},s.prototype.readUintLE=s.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);let n=this[t],i=1,o=0;for(;++o<e&&(i*=256);)n+=this[t+o]*i;return n},s.prototype.readUintBE=s.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);let n=this[t+--e],i=1;for(;e>0&&(i*=256);)n+=this[t+--e]*i;return n},s.prototype.readUint8=s.prototype.readUInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readBigUInt64LE=Y((function(t){q(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||M(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,i=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),s.prototype.readBigUInt64BE=Y((function(t){q(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||M(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],i=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),s.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);let n=this[t],i=1,o=0;for(;++o<e&&(i*=256);)n+=this[t+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},s.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);let n=e,i=1,o=this[t+--n];for(;n>0&&(i*=256);)o+=this[t+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},s.prototype.readInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||O(t,2,this.length);const r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(t,e){t>>>=0,e||O(t,2,this.length);const r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readBigInt64LE=Y((function(t){q(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||M(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),s.prototype.readBigInt64BE=Y((function(t){q(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||M(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)})),s.prototype.readFloatLE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){R(this,t,e,r,Math.pow(2,8*r)-1,0)}let i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){R(this,t,e,r,Math.pow(2,8*r)-1,0)}let i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},s.prototype.writeUint8=s.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigUInt64LE=Y((function(t,e=0){return U(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeBigUInt64BE=Y((function(t,e=0){return P(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);R(this,t,e,r,n-1,-n)}let i=0,o=1,s=0;for(this[e]=255&t;++i<r&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+r},s.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);R(this,t,e,r,n-1,-n)}let i=r-1,o=1,s=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+r},s.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigInt64LE=Y((function(t,e=0){return U(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeBigInt64BE=Y((function(t,e=0){return P(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeFloatLE=function(t,e,r){return F(this,t,e,!0,r)},s.prototype.writeFloatBE=function(t,e,r){return F(this,t,e,!1,r)},s.prototype.writeDoubleLE=function(t,e,r){return L(this,t,e,!0,r)},s.prototype.writeDoubleBE=function(t,e,r){return L(this,t,e,!1,r)},s.prototype.copy=function(t,e,r,n){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);const i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},s.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{const o=s.isBuffer(t)?t:s.from(t,n),a=o.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=o[i%a]}return this};const C={};function D(t,e,r){C[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function j(t){let e="",r=t.length;const n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function $(t,e,r,n,i,o){if(t>r||t<e){const n="bigint"==typeof e?"n":"";let i;throw i=o>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${e}${n} and <= ${r}${n}`,new C.ERR_OUT_OF_RANGE("value",i,t)}!function(t,e,r){q(e,"offset"),void 0!==t[e]&&void 0!==t[e+r]||M(e,t.length-(r+1))}(n,i,o)}function q(t,e){if("number"!=typeof t)throw new C.ERR_INVALID_ARG_TYPE(e,"number",t)}function M(t,e,r){if(Math.floor(t)!==t)throw q(t,r),new C.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new C.ERR_BUFFER_OUT_OF_BOUNDS;throw new C.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}D("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),D("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),D("ERR_OUT_OF_RANGE",(function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=j(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=j(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n}),RangeError);const V=/[^+/0-9A-Za-z-_]/g;function z(t,e){let r;e=e||1/0;const n=t.length;let i=null;const o=[];for(let s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function G(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function K(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function H(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Z(t){return t!=t}const W=function(){const t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function Y(t){return"undefined"==typeof BigInt?J:t}function J(){throw new Error("BigInt not supported")}}(xt),function(t){t[t.SysFatal=1]="SysFatal",t[t.SysTransient=2]="SysTransient",t[t.DestinationInvalid=3]="DestinationInvalid",t[t.CanisterReject=4]="CanisterReject",t[t.CanisterError=5]="CanisterError"}(Ut||(Ut={}));const kt="abcdefghijklmnopqrstuvwxyz234567",Ft=Object.create(null);for(let t=0;t<32;t++)Ft[kt[t]]=t;Ft[0]=Ft.o,Ft[1]=Ft.i;const Lt=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);const Ct="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function Dt(t,...e){if(!((r=t)instanceof Uint8Array||ArrayBuffer.isView(r)&&"Uint8Array"===r.constructor.name))throw new Error("Uint8Array expected");var r;if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function jt(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function $t(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function qt(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Mt(t,e){return t<<32-e|t>>>e}function Vt(t){return"string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}(t)),Dt(t),t}class zt{}function Gt(t){const e=e=>t().update(Vt(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Kt(t=32){if(Ct&&"function"==typeof Ct.getRandomValues)return Ct.getRandomValues(new Uint8Array(t));if(Ct&&"function"==typeof Ct.randomBytes)return Uint8Array.from(Ct.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function Ht(t,e,r){return t&e^~t&r}function Zt(t,e,r){return t&e^t&r^e&r}class Wt extends zt{constructor(t,e,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(t),this.view=qt(this.buffer)}update(t){jt(this),Dt(t=Vt(t));const{view:e,buffer:r,blockLen:n}=this,i=t.length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s!==n)r.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=qt(t);for(;n<=i-o;o+=n)this.process(e,o)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){jt(this),function(t,e){Dt(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;e[o++]=128,$t(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(r,0),o=0);for(let t=o;t<n;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,u=n?0:4;t.setUint32(e+c,s,n),t.setUint32(e+u,a,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=qt(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return t.destroyed=o,t.finished=i,t.length=n,t.pos=s,n%e&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const Yt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Jt=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),Xt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Qt=BigInt(2**32-1),te=BigInt(32);function ee(t,e=!1){return e?{h:Number(t&Qt),l:Number(t>>te&Qt)}:{h:0|Number(t>>te&Qt),l:0|Number(t&Qt)}}const re=(t,e,r)=>t>>>r,ne=(t,e,r)=>t<<32-r|e>>>r,ie=(t,e,r)=>t>>>r|e<<32-r,oe=(t,e,r)=>t<<32-r|e>>>r,se=(t,e,r)=>t<<64-r|e>>>r-32,ae=(t,e,r)=>t>>>r-32|e<<64-r;function ce(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:0|i}}const ue=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),fe=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,le=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),de=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,he=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),pe=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0,ge=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),be=new Uint32Array(64);class ye extends Wt{constructor(t=32){super(64,t,8,!1),this.A=0|Yt[0],this.B=0|Yt[1],this.C=0|Yt[2],this.D=0|Yt[3],this.E=0|Yt[4],this.F=0|Yt[5],this.G=0|Yt[6],this.H=0|Yt[7]}get(){const{A:t,B:e,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[t,e,r,n,i,o,s,a]}set(t,e,r,n,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)be[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=be[t-15],r=be[t-2],n=Mt(e,7)^Mt(e,18)^e>>>3,i=Mt(r,17)^Mt(r,19)^r>>>10;be[t]=i+be[t-7]+n+be[t-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(Mt(s,6)^Mt(s,11)^Mt(s,25))+Ht(s,a,c)+ge[t]+be[t]|0,f=(Mt(r,2)^Mt(r,13)^Mt(r,22))+Zt(r,n,i)|0;u=c,c=a,a=s,s=o+e|0,o=i,i=n,n=r,r=e+f|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,o,s,a,c,u)}roundClean(){$t(be)}destroy(){this.set(0,0,0,0,0,0,0,0),$t(this.buffer)}}class me extends ye{constructor(){super(28),this.A=0|Jt[0],this.B=0|Jt[1],this.C=0|Jt[2],this.D=0|Jt[3],this.E=0|Jt[4],this.F=0|Jt[5],this.G=0|Jt[6],this.H=0|Jt[7]}}const we=(()=>function(t,e=!1){const r=t.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let o=0;o<r;o++){const{h:r,l:s}=ee(t[o],e);[n[o],i[o]]=[r,s]}return[n,i]}(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t)))))(),ve=(()=>we[0])(),Ee=(()=>we[1])(),_e=new Uint32Array(80),xe=new Uint32Array(80);class Be extends Wt{constructor(t=64){super(128,t,16,!1),this.Ah=0|Xt[0],this.Al=0|Xt[1],this.Bh=0|Xt[2],this.Bl=0|Xt[3],this.Ch=0|Xt[4],this.Cl=0|Xt[5],this.Dh=0|Xt[6],this.Dl=0|Xt[7],this.Eh=0|Xt[8],this.El=0|Xt[9],this.Fh=0|Xt[10],this.Fl=0|Xt[11],this.Gh=0|Xt[12],this.Gl=0|Xt[13],this.Hh=0|Xt[14],this.Hl=0|Xt[15]}get(){const{Ah:t,Al:e,Bh:r,Bl:n,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:u,Fh:f,Fl:l,Gh:d,Gl:h,Hh:p,Hl:g}=this;return[t,e,r,n,i,o,s,a,c,u,f,l,d,h,p,g]}set(t,e,r,n,i,o,s,a,c,u,f,l,d,h,p,g){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|f,this.Fl=0|l,this.Gh=0|d,this.Gl=0|h,this.Hh=0|p,this.Hl=0|g}process(t,e){for(let r=0;r<16;r++,e+=4)_e[r]=t.getUint32(e),xe[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|_e[t-15],r=0|xe[t-15],n=ie(e,r,1)^ie(e,r,8)^re(e,0,7),i=oe(e,r,1)^oe(e,r,8)^ne(e,r,7),o=0|_e[t-2],s=0|xe[t-2],a=ie(o,s,19)^se(o,s,61)^re(o,0,6),c=oe(o,s,19)^ae(o,s,61)^ne(o,s,6),u=le(i,c,xe[t-7],xe[t-16]),f=de(u,n,a,_e[t-7],_e[t-16]);_e[t]=0|f,xe[t]=0|u}let{Ah:r,Al:n,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:u,Eh:f,El:l,Fh:d,Fl:h,Gh:p,Gl:g,Hh:b,Hl:y}=this;for(let t=0;t<80;t++){const e=ie(f,l,14)^ie(f,l,18)^se(f,l,41),m=oe(f,l,14)^oe(f,l,18)^ae(f,l,41),w=f&d^~f&p,v=he(y,m,l&h^~l&g,Ee[t],xe[t]),E=pe(v,b,e,w,ve[t],_e[t]),_=0|v,x=ie(r,n,28)^se(r,n,34)^se(r,n,39),B=oe(r,n,28)^ae(r,n,34)^ae(r,n,39),I=r&i^r&s^i&s,A=n&o^n&a^o&a;b=0|p,y=0|g,p=0|d,g=0|h,d=0|f,h=0|l,({h:f,l:l}=ce(0|c,0|u,0|E,0|_)),c=0|s,u=0|a,s=0|i,a=0|o,i=0|r,o=0|n;const S=ue(_,B,A);r=fe(S,E,x,I),n=0|S}({h:r,l:n}=ce(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:o}=ce(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=ce(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=ce(0|this.Dh,0|this.Dl,0|c,0|u)),({h:f,l:l}=ce(0|this.Eh,0|this.El,0|f,0|l)),({h:d,l:h}=ce(0|this.Fh,0|this.Fl,0|d,0|h)),({h:p,l:g}=ce(0|this.Gh,0|this.Gl,0|p,0|g)),({h:b,l:y}=ce(0|this.Hh,0|this.Hl,0|b,0|y)),this.set(r,n,i,o,s,a,c,u,f,l,d,h,p,g,b,y)}roundClean(){$t(_e,xe)}destroy(){$t(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Ie=Gt((()=>new ye)),Ae=Gt((()=>new me)),Se=Gt((()=>new Be)),Te=Ie,Ne=Ae;const Oe="__principal__";let Re=class t{constructor(t){this._arr=t,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([4]))}static managementCanister(){return this.fromText("aaaaa-aa")}static selfAuthenticating(t){const e=(r=t,Ne.create().update(new Uint8Array(r)).digest());var r;return new this(new Uint8Array([...e,2]))}static from(e){if("string"==typeof e)return t.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new t(e);if("object"==typeof e&&null!==e&&!0===e._isPrincipal)return new t(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(t){return new this((t=>{var e;return new Uint8Array((null!==(e=t.match(/.{1,2}/g))&&void 0!==e?e:[]).map((t=>parseInt(t,16))))})(t))}static fromText(t){let e=t;if(t.includes(Oe)){const r=JSON.parse(t);Oe in r&&(e=r[Oe])}let r=function(t){let e=0,r=0;const n=new Uint8Array(4*t.length/3|0);let i=0;function o(t){let o=Ft[t.toLowerCase()];if(void 0===o)throw new Error(`Invalid character: ${JSON.stringify(t)}`);o<<=3,r|=o>>>e,e+=5,e>=8&&(n[i++]=r,e-=8,r=e>0?o<<5-e&255:0)}for(const e of t)o(e);return n.slice(0,i)}(e.toLowerCase().replace(/-/g,""));r=r.slice(4,r.length);const n=new this(r);if(n.toText()!==e)throw new Error(`Principal "${n.toText()}" does not have a valid checksum (original value "${e}" may not be a valid Principal ID).`);return n}static fromUint8Array(t){return new this(t)}isAnonymous(){return 1===this._arr.byteLength&&4===this._arr[0]}toUint8Array(){return this._arr}toHex(){return(t=>t.reduce(((t,e)=>t+e.toString(16).padStart(2,"0")),""))(this._arr).toUpperCase()}toText(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,function(t){const e=new Uint8Array(t);let r=-1;for(let t=0;t<e.length;t++){const n=e[t];r=Lt[255&(n^r)]^r>>>8}return(-1^r)>>>0}(this._arr));const e=new Uint8Array(t),r=Uint8Array.from(this._arr),n=function(t){let e=0,r=0,n="";for(let o=0;o<t.length;)o+=(i=t[o],e<0?r|=i>>-e:r=i<<e&248,e>3?(e-=8,1):(e<4&&(n+=kt[r>>3],e+=5),0));var i;return n+(e<0?kt[r>>3]:"")}(new Uint8Array([...e,...r])),i=n.match(/.{1,5}/g);if(!i)throw new Error;return i.join("-")}toString(){return this.toText()}toJSON(){return{[Oe]:this.toText()}}compareTo(t){for(let e=0;e<Math.min(this._arr.length,t._arr.length);e++){if(this._arr[e]<t._arr[e])return"lt";if(this._arr[e]>t._arr[e])return"gt"}return this._arr.length<t._arr.length?"lt":this._arr.length>t._arr.length?"gt":"eq"}ltEq(t){const e=this.compareTo(t);return"lt"==e||"eq"==e}gtEq(t){const e=this.compareTo(t);return"gt"==e||"eq"==e}};function Ue(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.byteLength),0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e.buffer}function Pe(t){return[...new Uint8Array(t)].map((t=>t.toString(16).padStart(2,"0"))).join("")}const ke=new RegExp(/^[0-9a-fA-F]+$/);function Fe(t){if(!ke.test(t))throw new Error("Invalid hexadecimal string.");const e=[...t].reduce(((t,e,r)=>(t[r/2|0]=(t[r/2|0]||"")+e,t)),[]).map((t=>Number.parseInt(t,16)));return new Uint8Array(e).buffer}function Le(t,e){if(t.byteLength!==e.byteLength)return t.byteLength-e.byteLength;const r=new Uint8Array(t),n=new Uint8Array(e);for(let t=0;t<r.length;t++)if(r[t]!==n[t])return r[t]-n[t];return 0}function Ce(t,e){return 0===Le(t,e)}function De(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function je(t){return t instanceof Uint8Array?De(t):t instanceof ArrayBuffer?t:Array.isArray(t)?De(new Uint8Array(t)):"buffer"in t?je(t.buffer):De(new Uint8Array(t))}class $e extends Error{constructor(t){super(t),this.message=t,this.name="AgentError",this.__proto__=$e.prototype,Object.setPrototypeOf(this,$e.prototype)}}function qe(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.byteLength),0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e}class Me{constructor(t,e=(null==t?void 0:t.byteLength)||0){this._buffer=ze(t||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,e)}save(){return this._view}restore(t){this._view=t}get buffer(){return ze(this._view.slice())}get byteLength(){return this._view.byteLength}read(t){const e=this._view.subarray(0,t);return this._view=this._view.subarray(t),e.slice().buffer}readUint8(){const t=this._view[0];return this._view=this._view.subarray(1),t}write(t){const e=new Uint8Array(t),r=this._view.byteLength;this._view.byteOffset+this._view.byteLength+e.byteLength>=this._buffer.byteLength?this.alloc(e.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+e.byteLength),this._view.set(e,r)}get end(){return 0===this._view.byteLength}alloc(t){const e=new ArrayBuffer(1.2*(this._buffer.byteLength+t)|0),r=new Uint8Array(e,0,this._view.byteLength+t);r.set(this._view),this._buffer=e,this._view=r}}function Ve(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function ze(t){return t instanceof Uint8Array?Ve(t):t instanceof ArrayBuffer?t:Array.isArray(t)?Ve(new Uint8Array(t)):"buffer"in t?ze(t.buffer):Ve(new Uint8Array(t))}function Ge(t){if(/^_\d+_$/.test(t)||/^_0x[0-9a-fA-F]+_$/.test(t)){const e=+t.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return function(t){const e=(new TextEncoder).encode(t);let r=0;for(const t of e)r=(223*r+t)%2**32;return r}(t)}function Ke(){throw new Error("unexpected end of buffer")}function He(t,e){return t.byteLength<e&&Ke(),t.read(e)}function Ze(t){const e=t.readUint8();return void 0===e&&Ke(),e}function We(t){if("number"==typeof t&&(t=BigInt(t)),t<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,r=new Me(new ArrayBuffer(e),0);for(;;){const e=Number(t&BigInt(127));if((t/=BigInt(128))===BigInt(0)){r.write(new Uint8Array([e]));break}r.write(new Uint8Array([128|e]))}return r.buffer}function Ye(t){let e,r=BigInt(1),n=BigInt(0);do{e=Ze(t),n+=BigInt(127&e).valueOf()*r,r*=BigInt(128)}while(e>=128);return n}function Je(t){"number"==typeof t&&(t=BigInt(t));const e=t<BigInt(0);e&&(t=-t-BigInt(1));const r=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,n=new Me(new ArrayBuffer(r),0);for(;;){const r=i(t);if(t/=BigInt(128),e&&t===BigInt(0)&&0!=(64&r)||!e&&t===BigInt(0)&&0==(64&r)){n.write(new Uint8Array([r]));break}n.write(new Uint8Array([128|r]))}function i(t){const r=t%BigInt(128);return Number(e?BigInt(128)-r-BigInt(1):r)}return n.buffer}function Xe(t){const e=new Uint8Array(t.buffer);let r=0;for(;r<e.byteLength;r++)if(e[r]<128){if(0==(64&e[r]))return Ye(t);break}const n=new Uint8Array(He(t,r+1));let i=BigInt(0);for(let t=n.byteLength-1;t>=0;t--)i=i*BigInt(128)+BigInt(128-(127&n[t])-1);return-i-BigInt(1)}function Qe(t,e){t=BigInt(t);const r=new Me(new ArrayBuffer(Math.min(1,e)),0);let n=0,i=BigInt(256),o=BigInt(0),s=Number(t%i);for(r.write(new Uint8Array([s]));++n<e;)t<0&&o===BigInt(0)&&0!==s&&(o=BigInt(1)),s=Number((t/i-o)%BigInt(256)),r.write(new Uint8Array([s])),i*=BigInt(256);return r.buffer}function tr(t,e){let r=BigInt(Ze(t)),n=BigInt(1),i=0;for(;++i<e;){n*=BigInt(256);r+=n*BigInt(Ze(t))}return r}function er(t){const e=BigInt(t);if(t<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const rr="DIDL";function nr(t,e,r){return t.map(((t,n)=>r(t,e[n])))}class ir{constructor(){this._typs=[],this._idx=new Map}has(t){return this._idx.has(t.name)}add(t,e){const r=this._typs.length;this._idx.set(t.name,r),this._typs.push(e)}merge(t,e){const r=this._idx.get(t.name),n=this._idx.get(e);if(void 0===r)throw new Error("Missing type index for "+t);if(void 0===n)throw new Error("Missing type index for "+e);this._typs[r]=this._typs[n],this._typs.splice(n,1),this._idx.delete(e)}encode(){const t=We(this._typs.length),e=qe(...this._typs);return qe(t,e)}indexOf(t){if(!this._idx.has(t))throw new Error("Missing type index for "+t);return Je(this._idx.get(t)||0)}}class or{display(){return this.name}valueToString(t){return Nr(t)}buildTypeTable(t){t.has(this)||this._buildTypeTableImpl(t)}}class sr extends or{checkType(t){if(this.name!==t.name)throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`);return t}_buildTypeTableImpl(t){}}class ar extends or{checkType(t){if(t instanceof Br){const e=t.getType();if(void 0===e)throw new Error("type mismatch with uninitialized type");return e}throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`)}encodeType(t){return t.indexOf(this.name)}}class cr extends sr{accept(t,e){return t.visitEmpty(this,e)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return Je(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class ur extends or{checkType(t){throw new Error("Method not implemented for unknown.")}accept(t,e){throw t.visitType(this,e)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(t,e){let r,n=e.decodeValue(t,e);return Object(n)!==n&&(n=Object(n)),r=e instanceof Br?()=>e.getType():()=>e,Object.defineProperty(n,"type",{value:r,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class fr extends sr{accept(t,e){return t.visitBool(this,e)}covariant(t){if("boolean"==typeof t)return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){return new Uint8Array([t?1:0])}encodeType(){return Je(-2)}decodeValue(t,e){switch(this.checkType(e),Ze(t)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class lr extends sr{accept(t,e){return t.visitNull(this,e)}covariant(t){if(null===t)return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return Je(-1)}decodeValue(t,e){return this.checkType(e),null}get name(){return"null"}}class dr extends sr{accept(t,e){return t.visitReserved(this,e)}covariant(t){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return Je(-16)}decodeValue(t,e){return e.name!==this.name&&e.decodeValue(t,e),null}get name(){return"reserved"}}class hr extends sr{accept(t,e){return t.visitText(this,e)}covariant(t){if("string"==typeof t)return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){const e=(new TextEncoder).encode(t);return qe(We(e.byteLength),e)}encodeType(){return Je(-15)}decodeValue(t,e){this.checkType(e);const r=Ye(t),n=He(t,Number(r));return new TextDecoder("utf8",{fatal:!0}).decode(n)}get name(){return"text"}valueToString(t){return'"'+t+'"'}}class pr extends sr{accept(t,e){return t.visitInt(this,e)}covariant(t){if("bigint"==typeof t||Number.isInteger(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){return Je(t)}encodeType(){return Je(-4)}decodeValue(t,e){return this.checkType(e),Xe(t)}get name(){return"int"}valueToString(t){return t.toString()}}class gr extends sr{accept(t,e){return t.visitNat(this,e)}covariant(t){if("bigint"==typeof t&&t>=BigInt(0)||Number.isInteger(t)&&t>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){return We(t)}encodeType(){return Je(-3)}decodeValue(t,e){return this.checkType(e),Ye(t)}get name(){return"nat"}valueToString(t){return t.toString()}}class br extends sr{constructor(t){if(super(),this._bits=t,32!==t&&64!==t)throw new Error("not a valid float type")}accept(t,e){return t.visitFloat(this,e)}covariant(t){if("number"==typeof t||t instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){const e=new ArrayBuffer(this._bits/8),r=new DataView(e);return 32===this._bits?r.setFloat32(0,t,!0):r.setFloat64(0,t,!0),e}encodeType(){return Je(32===this._bits?-13:-14)}decodeValue(t,e){this.checkType(e);const r=He(t,this._bits/8),n=new DataView(r);return 32===this._bits?n.getFloat32(0,!0):n.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(t){return t.toString()}}class yr extends sr{constructor(t){super(),this._bits=t}accept(t,e){return t.visitFixedInt(this,e)}covariant(t){const e=er(this._bits-1)*BigInt(-1),r=er(this._bits-1)-BigInt(1);let n=!1;if("bigint"==typeof t)n=t>=e&&t<=r;else if(Number.isInteger(t)){const i=BigInt(t);n=i>=e&&i<=r}else n=!1;if(n)return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){return Qe(t,this._bits/8)}encodeType(){return Je(-9-(Math.log2(this._bits)-3))}decodeValue(t,e){this.checkType(e);const r=function(t,e){let r=tr(t,e);const n=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return r>=n&&(r-=n*BigInt(2)),r}(t,this._bits/8);return this._bits<=32?Number(r):r}get name(){return`int${this._bits}`}valueToString(t){return t.toString()}}class mr extends sr{constructor(t){super(),this._bits=t}accept(t,e){return t.visitFixedNat(this,e)}covariant(t){const e=er(this._bits);let r=!1;if("bigint"==typeof t&&t>=BigInt(0))r=t<e;else if(Number.isInteger(t)&&t>=0){r=BigInt(t)<e}else r=!1;if(r)return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){return function(t,e){if(BigInt(t)<BigInt(0))throw new Error("Cannot write negative values.");return Qe(t,e)}(t,this._bits/8)}encodeType(){return Je(-5-(Math.log2(this._bits)-3))}decodeValue(t,e){this.checkType(e);const r=tr(t,this._bits/8);return this._bits<=32?Number(r):r}get name(){return`nat${this._bits}`}valueToString(t){return t.toString()}}class wr extends ar{constructor(t){super(),this._type=t,this._blobOptimization=!1,t instanceof mr&&8===t._bits&&(this._blobOptimization=!0)}accept(t,e){return t.visitVec(this,this._type,e)}covariant(t){const e=this._type instanceof mr||this._type instanceof yr?this._type._bits:0;if(ArrayBuffer.isView(t)&&e==8*t.BYTES_PER_ELEMENT||Array.isArray(t)&&t.every(((t,e)=>{try{return this._type.covariant(t)}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nindex ${e} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){const e=We(t.length);if(this._blobOptimization)return qe(e,new Uint8Array(t));if(ArrayBuffer.isView(t))return qe(e,new Uint8Array(t.buffer));const r=new Me(new ArrayBuffer(e.byteLength+t.length),0);r.write(e);for(const e of t){const t=this._type.encodeValue(e);r.write(new Uint8Array(t))}return r.buffer}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const e=Je(-19),r=this._type.encodeType(t);t.add(this,qe(e,r))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof wr))throw new Error("Not a vector type");const n=Number(Ye(t));if(this._type instanceof mr){if(8==this._type._bits)return new Uint8Array(t.read(n));if(16==this._type._bits)return new Uint16Array(t.read(2*n));if(32==this._type._bits)return new Uint32Array(t.read(4*n));if(64==this._type._bits)return new BigUint64Array(t.read(8*n))}if(this._type instanceof yr){if(8==this._type._bits)return new Int8Array(t.read(n));if(16==this._type._bits)return new Int16Array(t.read(2*n));if(32==this._type._bits)return new Int32Array(t.read(4*n));if(64==this._type._bits)return new BigInt64Array(t.read(8*n))}const i=[];for(let e=0;e<n;e++)i.push(this._type.decodeValue(t,r._type));return i}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(t){return"vec {"+t.map((t=>this._type.valueToString(t))).join("; ")+"}"}}class vr extends ar{constructor(t){super(),this._type=t}accept(t,e){return t.visitOpt(this,this._type,e)}covariant(t){try{if(Array.isArray(t)&&(0===t.length||1===t.length&&this._type.covariant(t[0])))return!0}catch(e){throw new Error(`Invalid ${this.display()} argument: ${Nr(t)} \n\n-> ${e.message}`)}throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){return 0===t.length?new Uint8Array([0]):qe(new Uint8Array([1]),this._type.encodeValue(t[0]))}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const e=Je(-18),r=this._type.encodeType(t);t.add(this,qe(e,r))}decodeValue(t,e){if(e instanceof lr)return[];if(e instanceof dr)return[];let r=e;if(e instanceof Br){const t=e.getType();if(void 0===t)throw new Error("type mismatch with uninitialized type");r=t}if(r instanceof vr)switch(Ze(t)){case 0:return[];case 1:{const e=t.save();try{return[this._type.decodeValue(t,r._type)]}catch(n){return t.restore(e),r._type.decodeValue(t,r._type),[]}}default:throw new Error("Not an option value")}else{if(this._type instanceof lr||this._type instanceof vr||this._type instanceof dr)return r.decodeValue(t,r),[];{const n=t.save();try{return[this._type.decodeValue(t,e)]}catch(i){return t.restore(n),r.decodeValue(t,e),[]}}}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(t){return 0===t.length?"null":`opt ${this._type.valueToString(t[0])}`}}class Er extends ar{constructor(t={}){super(),this._fields=Object.entries(t).sort(((t,e)=>Ge(t[0])-Ge(e[0])))}accept(t,e){return t.visitRecord(this,this._fields,e)}tryAsTuple(){const t=[];for(let e=0;e<this._fields.length;e++){const[r,n]=this._fields[e];if(r!==`_${e}_`)return null;t.push(n)}return t}covariant(t){if("object"==typeof t&&this._fields.every((([e,r])=>{if(!t.hasOwnProperty(e))throw new Error(`Record is missing key "${e}".`);try{return r.covariant(t[e])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nfield ${e} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){const e=this._fields.map((([e])=>t[e])),r=nr(this._fields,e,(([,t],e)=>t.encodeValue(e)));return qe(...r)}_buildTypeTableImpl(t){this._fields.forEach((([e,r])=>r.buildTypeTable(t)));const e=Je(-20),r=We(this._fields.length),n=this._fields.map((([e,r])=>qe(We(Ge(e)),r.encodeType(t))));t.add(this,qe(e,r,qe(...n)))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof Er))throw new Error("Not a record type");const n={};let i=0,o=0;for(;o<r._fields.length;){const[e,s]=r._fields[o];if(i>=this._fields.length){s.decodeValue(t,s),o++;continue}const[a,c]=this._fields[i],u=Ge(this._fields[i][0]),f=Ge(e);if(u===f)n[a]=c.decodeValue(t,s),i++,o++;else if(f>u){if(!(c instanceof vr||c instanceof dr))throw new Error("Cannot find required field "+a);n[a]=[],i++}else s.decodeValue(t,s),o++}for(const[t,e]of this._fields.slice(i)){if(!(e instanceof vr||e instanceof dr))throw new Error("Cannot find required field "+t);n[t]=[]}return n}get name(){const t=this._fields.map((([t,e])=>t+":"+e.name));return`record {${t.join("; ")}}`}display(){const t=this._fields.map((([t,e])=>t+":"+e.display()));return`record {${t.join("; ")}}`}valueToString(t){const e=this._fields.map((([e])=>t[e])),r=nr(this._fields,e,(([t,e],r)=>t+"="+e.valueToString(r)));return`record {${r.join("; ")}}`}}class _r extends Er{constructor(t){const e={};t.forEach(((t,r)=>e["_"+r+"_"]=t)),super(e),this._components=t}accept(t,e){return t.visitTuple(this,this._components,e)}covariant(t){if(Array.isArray(t)&&t.length>=this._fields.length&&this._components.every(((e,r)=>{try{return e.covariant(t[r])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nindex ${r} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){const e=nr(this._components,t,((t,e)=>t.encodeValue(e)));return qe(...e)}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof _r))throw new Error("not a tuple type");if(r._components.length<this._components.length)throw new Error("tuple mismatch");const n=[];for(const[e,i]of r._components.entries())e>=this._components.length?i.decodeValue(t,i):n.push(this._components[e].decodeValue(t,i));return n}display(){const t=this._components.map((t=>t.display()));return`record {${t.join("; ")}}`}valueToString(t){const e=nr(this._components,t,((t,e)=>t.valueToString(e)));return`record {${e.join("; ")}}`}}class xr extends ar{constructor(t={}){super(),this._fields=Object.entries(t).sort(((t,e)=>Ge(t[0])-Ge(e[0])))}accept(t,e){return t.visitVariant(this,this._fields,e)}covariant(t){if("object"==typeof t&&1===Object.entries(t).length&&this._fields.every((([e,r])=>{try{return!t.hasOwnProperty(e)||r.covariant(t[e])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nvariant ${e} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){for(let e=0;e<this._fields.length;e++){const[r,n]=this._fields[e];if(t.hasOwnProperty(r)){return qe(We(e),n.encodeValue(t[r]))}}throw Error("Variant has no data: "+t)}_buildTypeTableImpl(t){this._fields.forEach((([,e])=>{e.buildTypeTable(t)}));const e=Je(-21),r=We(this._fields.length),n=this._fields.map((([e,r])=>qe(We(Ge(e)),r.encodeType(t))));t.add(this,qe(e,r,...n))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof xr))throw new Error("Not a variant type");const n=Number(Ye(t));if(n>=r._fields.length)throw Error("Invalid variant index: "+n);const[i,o]=r._fields[n];for(const[e,r]of this._fields)if(Ge(i)===Ge(e)){return{[e]:r.decodeValue(t,o)}}throw new Error("Cannot find field hash "+i)}get name(){return`variant {${this._fields.map((([t,e])=>t+":"+e.name)).join("; ")}}`}display(){return`variant {${this._fields.map((([t,e])=>t+("null"===e.name?"":`:${e.display()}`))).join("; ")}}`}valueToString(t){for(const[e,r]of this._fields)if(t.hasOwnProperty(e)){const n=r.valueToString(t[e]);return"null"===n?`variant {${e}}`:`variant {${e}=${n}}`}throw new Error("Variant has no data: "+t)}}class Br extends ar{constructor(){super(...arguments),this._id=Br._counter++,this._type=void 0}accept(t,e){if(!this._type)throw Error("Recursive type uninitialized.");return t.visitRec(this,this._type,e)}fill(t){this._type=t}getType(){return this._type}covariant(t){if(this._type&&this._type.covariant(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(t)}_buildTypeTableImpl(t){if(!this._type)throw Error("Recursive type uninitialized.");t.add(this,new Uint8Array([])),this._type.buildTypeTable(t),t.merge(this,this._type.name)}decodeValue(t,e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(t,e)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`${this.name}.${this._type.name}`}valueToString(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(t)}}function Ir(t){if(1!==Ze(t))throw new Error("Cannot decode principal");const e=Number(Ye(t));return Re.fromUint8Array(new Uint8Array(He(t,e)))}Br._counter=0;class Ar extends sr{accept(t,e){return t.visitPrincipal(this,e)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){const e=t.toUint8Array(),r=We(e.byteLength);return qe(new Uint8Array([1]),r,e)}encodeType(){return Je(-24)}decodeValue(t,e){return this.checkType(e),Ir(t)}get name(){return"principal"}valueToString(t){return`${this.name} "${t.toText()}"`}}class Sr extends ar{constructor(t,e,r=[]){super(),this.argTypes=t,this.retTypes=e,this.annotations=r}static argsToString(t,e){if(t.length!==e.length)throw new Error("arity mismatch");return"("+t.map(((t,r)=>t.valueToString(e[r]))).join(", ")+")"}accept(t,e){return t.visitFunc(this,e)}covariant(t){if(Array.isArray(t)&&2===t.length&&t[0]&&t[0]._isPrincipal&&"string"==typeof t[1])return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue([t,e]){const r=t.toUint8Array(),n=We(r.byteLength),i=qe(new Uint8Array([1]),n,r),o=(new TextEncoder).encode(e),s=We(o.byteLength);return qe(new Uint8Array([1]),i,s,o)}_buildTypeTableImpl(t){this.argTypes.forEach((e=>e.buildTypeTable(t))),this.retTypes.forEach((e=>e.buildTypeTable(t)));const e=Je(-22),r=We(this.argTypes.length),n=qe(...this.argTypes.map((e=>e.encodeType(t)))),i=We(this.retTypes.length),o=qe(...this.retTypes.map((e=>e.encodeType(t)))),s=We(this.annotations.length),a=qe(...this.annotations.map((t=>this.encodeAnnotation(t))));t.add(this,qe(e,r,n,i,o,s,a))}decodeValue(t){if(1!==Ze(t))throw new Error("Cannot decode function reference");const e=Ir(t),r=He(t,Number(Ye(t)));return[e,new TextDecoder("utf8",{fatal:!0}).decode(r)]}get name(){return`(${this.argTypes.map((t=>t.name)).join(", ")}) -> (${this.retTypes.map((t=>t.name)).join(", ")})${" "+this.annotations.join(" ")}`}valueToString([t,e]){return`func "${t.toText()}".${e}`}display(){return`(${this.argTypes.map((t=>t.display())).join(", ")})  (${this.retTypes.map((t=>t.display())).join(", ")})${" "+this.annotations.join(" ")}`}encodeAnnotation(t){if("query"===t)return new Uint8Array([1]);if("oneway"===t)return new Uint8Array([2]);if("composite_query"===t)return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class Tr extends ar{constructor(t){super(),this._fields=Object.entries(t).sort(((t,e)=>t[0]<e[0]?-1:t[0]>e[0]?1:0))}accept(t,e){return t.visitService(this,e)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Nr(t)}`)}encodeValue(t){const e=t.toUint8Array(),r=We(e.length);return qe(new Uint8Array([1]),r,e)}_buildTypeTableImpl(t){this._fields.forEach((([e,r])=>r.buildTypeTable(t)));const e=Je(-23),r=We(this._fields.length),n=this._fields.map((([e,r])=>{const n=(new TextEncoder).encode(e);return qe(We(n.length),n,r.encodeType(t))}));t.add(this,qe(e,r,...n))}decodeValue(t){return Ir(t)}get name(){const t=this._fields.map((([t,e])=>t+":"+e.name));return`service {${t.join("; ")}}`}valueToString(t){return`service "${t.toText()}"`}}function Nr(t){const e=JSON.stringify(t,((t,e)=>"bigint"==typeof e?`BigInt(${e})`:e));return e&&e.length>400?e.substring(0,397)+"...":e}function Or(t,e){if(e.length<t.length)throw Error("Wrong number of message arguments");const r=new ir;t.forEach((t=>t.buildTypeTable(r)));const n=(new TextEncoder).encode(rr),i=r.encode(),o=We(e.length),s=qe(...t.map((t=>t.encodeType(r)))),a=qe(...nr(t,e,((t,e)=>{try{t.covariant(e)}catch(t){throw new Error(t.message+"\n\n")}return t.encodeValue(e)})));return qe(n,i,o,s,a)}function Rr(t,e){const r=new Me(e);if(e.byteLength<rr.length)throw new Error("Message length smaller than magic number");const n=He(r,rr.length),i=(new TextDecoder).decode(n);if(i!==rr)throw new Error("Wrong magic number: "+JSON.stringify(i));const[o,s]=function(t){const e=[],r=Number(Ye(t));for(let n=0;n<r;n++){const r=Number(Xe(t));switch(r){case-18:case-19:{const n=Number(Xe(t));e.push([r,n]);break}case-20:case-21:{const n=[];let i,o=Number(Ye(t));for(;o--;){const e=Number(Ye(t));if(e>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if("number"==typeof i&&i>=e)throw new Error("field id collision or not sorted");i=e;const r=Number(Xe(t));n.push([e,r])}e.push([r,n]);break}case-22:{const n=[];let i=Number(Ye(t));for(;i--;)n.push(Number(Xe(t)));const o=[];let s=Number(Ye(t));for(;s--;)o.push(Number(Xe(t)));const a=[];let c=Number(Ye(t));for(;c--;){switch(Number(Ye(t))){case 1:a.push("query");break;case 2:a.push("oneway");break;case 3:a.push("composite_query");break;default:throw new Error("unknown annotation")}}e.push([r,[n,o,a]]);break}case-23:{let n=Number(Ye(t));const i=[];for(;n--;){const e=Number(Ye(t)),r=(new TextDecoder).decode(He(t,e)),n=Xe(t);i.push([r,n])}e.push([r,i]);break}default:throw new Error("Illegal op_code: "+r)}}const n=[],i=Number(Ye(t));for(let e=0;e<i;e++)n.push(Number(Xe(t)));return[e,n]}(r);if(s.length<t.length)throw new Error("Wrong number of return values");const a=o.map((t=>rn()));function c(t){if(t<-24)throw new Error("future value not supported");if(t<0)switch(t){case-1:return Lr;case-2:return Fr;case-3:return jr;case-4:return Dr;case-5:return Kr;case-6:return Hr;case-7:return Zr;case-8:return Wr;case-9:return Mr;case-10:return Vr;case-11:return zr;case-12:return Gr;case-13:return $r;case-14:return qr;case-15:return Cr;case-16:return Pr;case-17:return Ur;case-24:return Yr;default:throw new Error("Illegal op_code: "+t)}if(t>=o.length)throw new Error("type index out of range");return a[t]}function u(t){switch(t[0]){case-19:return Xr(c(t[1]));case-18:return Qr(c(t[1]));case-20:{const e={};for(const[r,n]of t[1]){e[`_${r}_`]=c(n)}const r=tn(e),n=r.tryAsTuple();return Array.isArray(n)?Jr(...n):r}case-21:{const e={};for(const[r,n]of t[1]){e[`_${r}_`]=c(n)}return en(e)}case-22:{const[e,r,n]=t[1];return nn(e.map((t=>c(t))),r.map((t=>c(t))),n)}case-23:{const e={},r=t[1];for(const[t,n]of r){let r=c(n);if(r instanceof Br&&(r=r.getType()),!(r instanceof Sr))throw new Error("Illegal service definition: services can only contain functions");e[t]=r}return on(e)}default:throw new Error("Illegal op_code: "+t[0])}}o.forEach(((t,e)=>{if(-22===t[0]){const r=u(t);a[e].fill(r)}})),o.forEach(((t,e)=>{if(-22!==t[0]){const r=u(t);a[e].fill(r)}}));const f=s.map((t=>c(t))),l=t.map(((t,e)=>t.decodeValue(r,f[e])));for(let e=t.length;e<f.length;e++)f[e].decodeValue(r,f[e]);if(r.byteLength>0)throw new Error("decode: Left-over bytes");return l}const Ur=new cr,Pr=new dr,kr=new ur,Fr=new fr,Lr=new lr,Cr=new hr,Dr=new pr,jr=new gr,$r=new br(32),qr=new br(64),Mr=new yr(8),Vr=new yr(16),zr=new yr(32),Gr=new yr(64),Kr=new mr(8),Hr=new mr(16),Zr=new mr(32),Wr=new mr(64),Yr=new Ar;function Jr(...t){return new _r(t)}function Xr(t){return new wr(t)}function Qr(t){return new vr(t)}function tn(t){return new Er(t)}function en(t){return new xr(t)}function rn(){return new Br}function nn(t,e,r=[]){return new Sr(t,e,r)}function on(t){return new Tr(t)}var sn=Object.freeze({__proto__:null,Bool:Fr,BoolClass:fr,ConstructType:ar,Empty:Ur,EmptyClass:cr,FixedIntClass:yr,FixedNatClass:mr,Float32:$r,Float64:qr,FloatClass:br,Func:nn,FuncClass:Sr,Int:Dr,Int16:Vr,Int32:zr,Int64:Gr,Int8:Mr,IntClass:pr,Nat:jr,Nat16:Hr,Nat32:Zr,Nat64:Wr,Nat8:Kr,NatClass:gr,Null:Lr,NullClass:lr,Opt:Qr,OptClass:vr,PrimitiveType:sr,Principal:Yr,PrincipalClass:Ar,Rec:rn,RecClass:Br,Record:tn,RecordClass:Er,Reserved:Pr,ReservedClass:dr,Service:on,ServiceClass:Tr,Text:Cr,TextClass:hr,Tuple:Jr,TupleClass:_r,Type:or,Unknown:kr,UnknownClass:ur,Variant:en,VariantClass:xr,Vec:Xr,VecClass:wr,Visitor:class{visitType(t,e){throw new Error("Not implemented")}visitPrimitive(t,e){return this.visitType(t,e)}visitEmpty(t,e){return this.visitPrimitive(t,e)}visitBool(t,e){return this.visitPrimitive(t,e)}visitNull(t,e){return this.visitPrimitive(t,e)}visitReserved(t,e){return this.visitPrimitive(t,e)}visitText(t,e){return this.visitPrimitive(t,e)}visitNumber(t,e){return this.visitPrimitive(t,e)}visitInt(t,e){return this.visitNumber(t,e)}visitNat(t,e){return this.visitNumber(t,e)}visitFloat(t,e){return this.visitPrimitive(t,e)}visitFixedInt(t,e){return this.visitNumber(t,e)}visitFixedNat(t,e){return this.visitNumber(t,e)}visitPrincipal(t,e){return this.visitPrimitive(t,e)}visitConstruct(t,e){return this.visitType(t,e)}visitVec(t,e,r){return this.visitConstruct(t,r)}visitOpt(t,e,r){return this.visitConstruct(t,r)}visitRecord(t,e,r){return this.visitConstruct(t,r)}visitTuple(t,e,r){const n=e.map(((t,e)=>[`_${e}_`,t]));return this.visitRecord(t,n,r)}visitVariant(t,e,r){return this.visitConstruct(t,r)}visitRec(t,e,r){return this.visitConstruct(e,r)}visitFunc(t,e){return this.visitConstruct(t,e)}visitService(t,e){return this.visitConstruct(t,e)}},decode:Rr,encode:Or}),an={},cn={};!function(t){var e=Bt,r=Pt,n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=function(t){+t!=t&&(t=0);return s.alloc(+t)},t.INSPECT_MAX_BYTES=50;var i=2147483647;function o(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return a(t,e,r)}function a(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|h(t,e),n=o(r),i=n.write(t,e);i!==r&&(n=n.slice(0,i));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(j(t,Uint8Array)){var e=new Uint8Array(t);return l(e.buffer,e.byteOffset,e.byteLength)}return f(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(j(t,ArrayBuffer)||t&&j(t.buffer,ArrayBuffer))return l(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(j(t,SharedArrayBuffer)||t&&j(t.buffer,SharedArrayBuffer)))return l(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return s.from(n,e,r);var i=function(t){if(s.isBuffer(t)){var e=0|d(t.length),r=o(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||$(t.length)?o(0):f(t);if("Buffer"===t.type&&Array.isArray(t.data))return f(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return c(t),o(t<0?0:0|d(t))}function f(t){for(var e=t.length<0?0:0|d(t.length),r=o(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function l(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,s.prototype),n}function d(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function h(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||j(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return C(t).length;default:if(i)return n?-1:L(t).length;e=(""+e).toLowerCase(),i=!0}}function p(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,r);case"utf8":case"utf-8":return B(this,e,r);case"ascii":return A(this,e,r);case"latin1":case"binary":return S(this,e,r);case"base64":return x(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function b(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),$(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=s.from(e,n)),s.isBuffer(e))return 0===e.length?-1:y(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):y(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function y(t,e,r,n,i){var o,s=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var f=-1;for(o=r;o<a;o++)if(u(t,o)===u(e,-1===f?0:o-f)){if(-1===f&&(f=o),o-f+1===c)return f*s}else-1!==f&&(o-=o-f),f=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){for(var l=!0,d=0;d<c;d++)if(u(t,o+d)!==u(e,d)){l=!1;break}if(l)return o}return-1}function m(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if($(a))return s;t[r+s]=a}return s}function w(t,e,r,n){return D(L(e,t.length-r),t,r,n)}function v(t,e,r,n){return D(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function E(t,e,r,n){return D(C(e),t,r,n)}function _(t,e,r,n){return D(function(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=(r=t.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function x(t,r,n){return 0===r&&n===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(r,n))}function B(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,s,a,c,u=t[i],f=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l<=r)switch(l){case 1:u<128&&(f=u);break;case 2:128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)>127&&(f=c);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(f=c)}null===f?(f=65533,l=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),i+=l}return function(t){var e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=I));return r}(n)}t.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,r){return a(t,e,r)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,r){return function(t,e,r){return c(t),t<=0?o(t):void 0!==e?"string"==typeof r?o(t).fill(e,r):o(t).fill(e):o(t)}(t,e,r)},s.allocUnsafe=function(t){return u(t)},s.allocUnsafeSlow=function(t){return u(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(j(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),j(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=s.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var o=t[r];if(j(o,Uint8Array))i+o.length>n.length?s.from(o).copy(n,i):Uint8Array.prototype.set.call(n,o,i);else{if(!s.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i)}i+=o.length}return n},s.byteLength=h,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},s.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},s.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},s.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?B(this,0,t):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},n&&(s.prototype[n]=s.prototype.inspect),s.prototype.compare=function(t,e,r,n,i){if(j(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0),c=Math.min(o,a),u=this.slice(n,i),f=t.slice(e,r),l=0;l<c;++l)if(u[l]!==f[l]){o=u[l],a=f[l];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},s.prototype.indexOf=function(t,e,r){return b(this,t,e,r,!0)},s.prototype.lastIndexOf=function(t,e,r){return b(this,t,e,r,!1)},s.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return m(this,t,e,r);case"utf8":case"utf-8":return w(this,t,e,r);case"ascii":case"latin1":case"binary":return v(this,t,e,r);case"base64":return E(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function A(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function S(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function T(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=q[t[o]];return i}function N(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function O(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,r,n,i,o){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function U(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function P(t,e,n,i,o){return e=+e,n>>>=0,o||U(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function k(t,e,n,i,o){return e=+e,n>>>=0,o||U(t,0,n,8),r.write(t,e,n,i,52,8),n+8}s.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,s.prototype),n},s.prototype.readUintLE=s.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},s.prototype.readUintBE=s.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},s.prototype.readUint8=s.prototype.readUInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},s.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},s.prototype.readInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||O(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(t,e){t>>>=0,e||O(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readFloatLE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||R(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||R(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},s.prototype.writeUint8=s.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);R(this,t,e,r,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},s.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);R(this,t,e,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},s.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeFloatLE=function(t,e,r){return P(this,t,e,!0,r)},s.prototype.writeFloatBE=function(t,e,r){return P(this,t,e,!1,r)},s.prototype.writeDoubleLE=function(t,e,r){return k(this,t,e,!0,r)},s.prototype.writeDoubleBE=function(t,e,r){return k(this,t,e,!1,r)},s.prototype.copy=function(t,e,r,n){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},s.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var i=t.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{var a=s.isBuffer(t)?t:s.from(t,n),c=a.length;if(0===c)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<r-e;++o)this[o+e]=a[o%c]}return this};var F=/[^+/0-9A-Za-z-_]/g;function L(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function C(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function D(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function j(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function $(t){return t!=t}var q=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)e[n+i]=t[r]+t[i];return e}()}(cn);var un,fn={exports:{}};un=fn,function(t){var e,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,i=Math.floor,o="[BigNumber Error] ",s=o+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],l=1e7,d=1e9;function h(t){var e=0|t;return t>0||t===e?e:e-1}function p(t){for(var e,r,n=1,i=t.length,o=t[0]+"";n<i;){for(e=t[n++]+"",r=c-e.length;r--;e="0"+e);o+=e}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function g(t,e){var r,n,i=t.c,o=e.c,s=t.s,a=e.s,c=t.e,u=e.e;if(!s||!a)return null;if(r=i&&!i[0],n=o&&!o[0],r||n)return r?n?0:-a:s;if(s!=a)return s;if(r=s<0,n=c==u,!i||!o)return n?0:!i^r?1:-1;if(!n)return c>u^r?1:-1;for(a=(c=i.length)<(u=o.length)?c:u,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^r?1:-1;return c==u?0:c>u^r?1:-1}function b(t,e,r,n){if(t<e||t>r||t!==i(t))throw Error(o+(n||"Argument")+("number"==typeof t?t<e||t>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function y(t){var e=t.c.length-1;return h(t.e/c)==e&&t.c[e]%2!=0}function m(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function w(t,e,r){var n,i;if(e<0){for(i=r+".";++e;i+=r);t=i+t}else if(++e>(n=t.length)){for(i=r,e-=n;--e;i+=r);t+=i}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}e=function t(e){var v,E,_,x,B,I,A,S,T,N,O=z.prototype={constructor:z,toString:null,valueOf:null},R=new z(1),U=20,P=4,k=-7,F=21,L=-1e7,C=1e7,D=!1,j=1,$=0,q={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},M="0123456789abcdefghijklmnopqrstuvwxyz",V=!0;function z(t,e){var n,o,a,f,l,d,h,p,g=this;if(!(g instanceof z))return new z(t,e);if(null==e){if(t&&!0===t._isBigNumber)return g.s=t.s,void(!t.c||t.e>C?g.c=g.e=null:t.e<L?g.c=[g.e=0]:(g.e=t.e,g.c=t.c.slice()));if((d="number"==typeof t)&&0*t==0){if(g.s=1/t<0?(t=-t,-1):1,t===~~t){for(f=0,l=t;l>=10;l/=10,f++);return void(f>C?g.c=g.e=null:(g.e=f,g.c=[t]))}p=String(t)}else{if(!r.test(p=String(t)))return _(g,p,d);g.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(f=p.indexOf("."))>-1&&(p=p.replace(".","")),(l=p.search(/e/i))>0?(f<0&&(f=l),f+=+p.slice(l+1),p=p.substring(0,l)):f<0&&(f=p.length)}else{if(b(e,2,M.length,"Base"),10==e&&V)return Z(g=new z(t),U+g.e+1,P);if(p=String(t),d="number"==typeof t){if(0*t!=0)return _(g,p,d,e);if(g.s=1/t<0?(p=p.slice(1),-1):1,z.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(s+t)}else g.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(n=M.slice(0,e),f=l=0,h=p.length;l<h;l++)if(n.indexOf(o=p.charAt(l))<0){if("."==o){if(l>f){f=h;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,l=-1,f=0;continue}return _(g,String(t),d,e)}d=!1,(f=(p=E(p,e,10,g.s)).indexOf("."))>-1?p=p.replace(".",""):f=p.length}for(l=0;48===p.charCodeAt(l);l++);for(h=p.length;48===p.charCodeAt(--h););if(p=p.slice(l,++h)){if(h-=l,d&&z.DEBUG&&h>15&&(t>u||t!==i(t)))throw Error(s+g.s*t);if((f=f-l-1)>C)g.c=g.e=null;else if(f<L)g.c=[g.e=0];else{if(g.e=f,g.c=[],l=(f+1)%c,f<0&&(l+=c),l<h){for(l&&g.c.push(+p.slice(0,l)),h-=c;l<h;)g.c.push(+p.slice(l,l+=c));l=c-(p=p.slice(l)).length}else l-=h;for(;l--;p+="0");g.c.push(+p)}}else g.c=[g.e=0]}function G(t,e,r,n){var i,o,s,a,c;if(null==r?r=P:b(r,0,8),!t.c)return t.toString();if(i=t.c[0],s=t.e,null==e)c=p(t.c),c=1==n||2==n&&(s<=k||s>=F)?m(c,s):w(c,s,"0");else if(o=(t=Z(new z(t),e,r)).e,a=(c=p(t.c)).length,1==n||2==n&&(e<=o||o<=k)){for(;a<e;c+="0",a++);c=m(c,o)}else if(e-=s,c=w(c,o,"0"),o+1>a){if(--e>0)for(c+=".";e--;c+="0");}else if((e+=o-a)>0)for(o+1==a&&(c+=".");e--;c+="0");return t.s<0&&i?"-"+c:c}function K(t,e){for(var r,n=1,i=new z(t[0]);n<t.length;n++){if(!(r=new z(t[n])).s){i=r;break}e.call(i,r)&&(i=r)}return i}function H(t,e,r){for(var n=1,i=e.length;!e[--i];e.pop());for(i=e[0];i>=10;i/=10,n++);return(r=n+r*c-1)>C?t.c=t.e=null:r<L?t.c=[t.e=0]:(t.e=r,t.c=e),t}function Z(t,e,r,o){var s,u,l,d,h,p,g,b=t.c,y=f;if(b){t:{for(s=1,d=b[0];d>=10;d/=10,s++);if((u=e-s)<0)u+=c,l=e,g=(h=b[p=0])/y[s-l-1]%10|0;else if((p=n((u+1)/c))>=b.length){if(!o)break t;for(;b.length<=p;b.push(0));h=g=0,s=1,l=(u%=c)-c+1}else{for(h=d=b[p],s=1;d>=10;d/=10,s++);g=(l=(u%=c)-c+s)<0?0:h/y[s-l-1]%10|0}if(o=o||e<0||null!=b[p+1]||(l<0?h:h%y[s-l-1]),o=r<4?(g||o)&&(0==r||r==(t.s<0?3:2)):g>5||5==g&&(4==r||o||6==r&&(u>0?l>0?h/y[s-l]:0:b[p-1])%10&1||r==(t.s<0?8:7)),e<1||!b[0])return b.length=0,o?(e-=t.e+1,b[0]=y[(c-e%c)%c],t.e=-e||0):b[0]=t.e=0,t;if(0==u?(b.length=p,d=1,p--):(b.length=p+1,d=y[c-u],b[p]=l>0?i(h/y[s-l]%y[l])*d:0),o)for(;;){if(0==p){for(u=1,l=b[0];l>=10;l/=10,u++);for(l=b[0]+=d,d=1;l>=10;l/=10,d++);u!=d&&(t.e++,b[0]==a&&(b[0]=1));break}if(b[p]+=d,b[p]!=a)break;b[p--]=0,d=1}for(u=b.length;0===b[--u];b.pop());}t.e>C?t.c=t.e=null:t.e<L&&(t.c=[t.e=0])}return t}function W(t){var e,r=t.e;return null===r?t.toString():(e=p(t.c),e=r<=k||r>=F?m(e,r):w(e,r,"0"),t.s<0?"-"+e:e)}return z.clone=t,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(t){var e,r;if(null!=t){if("object"!=typeof t)throw Error(o+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(b(r=t[e],0,d,e),U=r),t.hasOwnProperty(e="ROUNDING_MODE")&&(b(r=t[e],0,8,e),P=r),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((r=t[e])&&r.pop?(b(r[0],-d,0,e),b(r[1],0,d,e),k=r[0],F=r[1]):(b(r,-d,d,e),k=-(F=r<0?-r:r))),t.hasOwnProperty(e="RANGE"))if((r=t[e])&&r.pop)b(r[0],-d,-1,e),b(r[1],1,d,e),L=r[0],C=r[1];else{if(b(r,-d,d,e),!r)throw Error(o+e+" cannot be zero: "+r);L=-(C=r<0?-r:r)}if(t.hasOwnProperty(e="CRYPTO")){if((r=t[e])!==!!r)throw Error(o+e+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw D=!r,Error(o+"crypto unavailable");D=r}else D=r}if(t.hasOwnProperty(e="MODULO_MODE")&&(b(r=t[e],0,9,e),j=r),t.hasOwnProperty(e="POW_PRECISION")&&(b(r=t[e],0,d,e),$=r),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(r=t[e]))throw Error(o+e+" not an object: "+r);q=r}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(r=t[e])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(o+e+" invalid: "+r);V="0123456789"==r.slice(0,10),M=r}}return{DECIMAL_PLACES:U,ROUNDING_MODE:P,EXPONENTIAL_AT:[k,F],RANGE:[L,C],CRYPTO:D,MODULO_MODE:j,POW_PRECISION:$,FORMAT:q,ALPHABET:M}},z.isBigNumber=function(t){if(!t||!0!==t._isBigNumber)return!1;if(!z.DEBUG)return!0;var e,r,n=t.c,s=t.e,u=t.s;t:if("[object Array]"=={}.toString.call(n)){if((1===u||-1===u)&&s>=-d&&s<=d&&s===i(s)){if(0===n[0]){if(0===s&&1===n.length)return!0;break t}if((e=(s+1)%c)<1&&(e+=c),String(n[0]).length==e){for(e=0;e<n.length;e++)if((r=n[e])<0||r>=a||r!==i(r))break t;if(0!==r)return!0}}}else if(null===n&&null===s&&(null===u||1===u||-1===u))return!0;throw Error(o+"Invalid BigNumber: "+t)},z.maximum=z.max=function(){return K(arguments,O.lt)},z.minimum=z.min=function(){return K(arguments,O.gt)},z.random=(x=9007199254740992,B=Math.random()*x&2097151?function(){return i(Math.random()*x)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,r,s,a,u,l=0,h=[],p=new z(R);if(null==t?t=U:b(t,0,d),a=n(t/c),D)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(a*=2));l<a;)(u=131072*e[l]+(e[l+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),e[l]=r[0],e[l+1]=r[1]):(h.push(u%1e14),l+=2);l=a/2}else{if(!crypto.randomBytes)throw D=!1,Error(o+"crypto unavailable");for(e=crypto.randomBytes(a*=7);l<a;)(u=281474976710656*(31&e[l])+1099511627776*e[l+1]+4294967296*e[l+2]+16777216*e[l+3]+(e[l+4]<<16)+(e[l+5]<<8)+e[l+6])>=9e15?crypto.randomBytes(7).copy(e,l):(h.push(u%1e14),l+=7);l=a/7}if(!D)for(;l<a;)(u=B())<9e15&&(h[l++]=u%1e14);for(a=h[--l],t%=c,a&&t&&(u=f[c-t],h[l]=i(a/u)*u);0===h[l];h.pop(),l--);if(l<0)h=[s=0];else{for(s=-1;0===h[0];h.splice(0,1),s-=c);for(l=1,u=h[0];u>=10;u/=10,l++);l<c&&(s-=c-l)}return p.e=s,p.c=h,p}),z.sum=function(){for(var t=1,e=arguments,r=new z(e[0]);t<e.length;)r=r.plus(e[t++]);return r},E=function(){var t="0123456789";function e(t,e,r,n){for(var i,o,s=[0],a=0,c=t.length;a<c;){for(o=s.length;o--;s[o]*=e);for(s[0]+=n.indexOf(t.charAt(a++)),i=0;i<s.length;i++)s[i]>r-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/r|0,s[i]%=r)}return s.reverse()}return function(r,n,i,o,s){var a,c,u,f,l,d,h,g,b=r.indexOf("."),y=U,m=P;for(b>=0&&(f=$,$=0,r=r.replace(".",""),d=(g=new z(n)).pow(r.length-b),$=f,g.c=e(w(p(d.c),d.e,"0"),10,i,t),g.e=g.c.length),u=f=(h=e(r,n,i,s?(a=M,t):(a=t,M))).length;0==h[--f];h.pop());if(!h[0])return a.charAt(0);if(b<0?--u:(d.c=h,d.e=u,d.s=o,h=(d=v(d,g,y,m,i)).c,l=d.r,u=d.e),b=h[c=u+y+1],f=i/2,l=l||c<0||null!=h[c+1],l=m<4?(null!=b||l)&&(0==m||m==(d.s<0?3:2)):b>f||b==f&&(4==m||l||6==m&&1&h[c-1]||m==(d.s<0?8:7)),c<1||!h[0])r=l?w(a.charAt(1),-y,a.charAt(0)):a.charAt(0);else{if(h.length=c,l)for(--i;++h[--c]>i;)h[c]=0,c||(++u,h=[1].concat(h));for(f=h.length;!h[--f];);for(b=0,r="";b<=f;r+=a.charAt(h[b++]));r=w(r,u,a.charAt(0))}return r}}(),v=function(){function t(t,e,r){var n,i,o,s,a=0,c=t.length,u=e%l,f=e/l|0;for(t=t.slice();c--;)a=((i=u*(o=t[c]%l)+(n=f*o+(s=t[c]/l|0)*u)%l*l+a)/r|0)+(n/l|0)+f*s,t[c]=i%r;return a&&(t=[a].concat(t)),t}function e(t,e,r,n){var i,o;if(r!=n)o=r>n?1:-1;else for(i=o=0;i<r;i++)if(t[i]!=e[i]){o=t[i]>e[i]?1:-1;break}return o}function r(t,e,r,n){for(var i=0;r--;)t[r]-=i,i=t[r]<e[r]?1:0,t[r]=i*n+t[r]-e[r];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(n,o,s,u,f){var l,d,p,g,b,y,m,w,v,E,_,x,B,I,A,S,T,N=n.s==o.s?1:-1,O=n.c,R=o.c;if(!(O&&O[0]&&R&&R[0]))return new z(n.s&&o.s&&(O?!R||O[0]!=R[0]:R)?O&&0==O[0]||!R?0*N:N/0:NaN);for(v=(w=new z(N)).c=[],N=s+(d=n.e-o.e)+1,f||(f=a,d=h(n.e/c)-h(o.e/c),N=N/c|0),p=0;R[p]==(O[p]||0);p++);if(R[p]>(O[p]||0)&&d--,N<0)v.push(1),g=!0;else{for(I=O.length,S=R.length,p=0,N+=2,(b=i(f/(R[0]+1)))>1&&(R=t(R,b,f),O=t(O,b,f),S=R.length,I=O.length),B=S,_=(E=O.slice(0,S)).length;_<S;E[_++]=0);T=R.slice(),T=[0].concat(T),A=R[0],R[1]>=f/2&&A++;do{if(b=0,(l=e(R,E,S,_))<0){if(x=E[0],S!=_&&(x=x*f+(E[1]||0)),(b=i(x/A))>1)for(b>=f&&(b=f-1),m=(y=t(R,b,f)).length,_=E.length;1==e(y,E,m,_);)b--,r(y,S<m?T:R,m,f),m=y.length,l=1;else 0==b&&(l=b=1),m=(y=R.slice()).length;if(m<_&&(y=[0].concat(y)),r(E,y,_,f),_=E.length,-1==l)for(;e(R,E,S,_)<1;)b++,r(E,S<_?T:R,_,f),_=E.length}else 0===l&&(b++,E=[0]);v[p++]=b,E[0]?E[_++]=O[B]||0:(E=[O[B]],_=1)}while((B++<I||null!=E[0])&&N--);g=null!=E[0],v[0]||v.splice(0,1)}if(f==a){for(p=1,N=v[0];N>=10;N/=10,p++);Z(w,s+(w.e=p+d*c-1)+1,u,g)}else w.e=d,w.r=+g;return w}}(),I=/^(-?)0([xbo])(?=\w[\w.]*$)/i,A=/^([^.]+)\.$/,S=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,N=/^\s*\+(?=[\w.])|^\s+|\s+$/g,_=function(t,e,r,n){var i,s=r?e:e.replace(N,"");if(T.test(s))t.s=isNaN(s)?null:s<0?-1:1;else{if(!r&&(s=s.replace(I,(function(t,e,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?t:e})),n&&(i=n,s=s.replace(A,"$1").replace(S,"0.$1")),e!=s))return new z(s,i);if(z.DEBUG)throw Error(o+"Not a"+(n?" base "+n:"")+" number: "+e);t.s=null}t.c=t.e=null},O.absoluteValue=O.abs=function(){var t=new z(this);return t.s<0&&(t.s=1),t},O.comparedTo=function(t,e){return g(this,new z(t,e))},O.decimalPlaces=O.dp=function(t,e){var r,n,i,o=this;if(null!=t)return b(t,0,d),null==e?e=P:b(e,0,8),Z(new z(o),t+o.e+1,e);if(!(r=o.c))return null;if(n=((i=r.length-1)-h(this.e/c))*c,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},O.dividedBy=O.div=function(t,e){return v(this,new z(t,e),U,P)},O.dividedToIntegerBy=O.idiv=function(t,e){return v(this,new z(t,e),0,1)},O.exponentiatedBy=O.pow=function(t,e){var r,s,a,u,f,l,d,h,p=this;if((t=new z(t)).c&&!t.isInteger())throw Error(o+"Exponent not an integer: "+W(t));if(null!=e&&(e=new z(e)),f=t.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!t.c||!t.c[0])return h=new z(Math.pow(+W(p),f?2-y(t):+W(t))),e?h.mod(e):h;if(l=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new z(NaN);(s=!l&&p.isInteger()&&e.isInteger())&&(p=p.mod(e))}else{if(t.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||f&&p.c[1]>=24e7:p.c[0]<8e13||f&&p.c[0]<=9999975e7)))return u=p.s<0&&y(t)?-0:0,p.e>-1&&(u=1/u),new z(l?1/u:u);$&&(u=n($/c+2))}for(f?(r=new z(.5),l&&(t.s=1),d=y(t)):d=(a=Math.abs(+W(t)))%2,h=new z(R);;){if(d){if(!(h=h.times(p)).c)break;u?h.c.length>u&&(h.c.length=u):s&&(h=h.mod(e))}if(a){if(0===(a=i(a/2)))break;d=a%2}else if(Z(t=t.times(r),t.e+1,1),t.e>14)d=y(t);else{if(0==(a=+W(t)))break;d=a%2}p=p.times(p),u?p.c&&p.c.length>u&&(p.c.length=u):s&&(p=p.mod(e))}return s?h:(l&&(h=R.div(h)),e?h.mod(e):u?Z(h,$,P,void 0):h)},O.integerValue=function(t){var e=new z(this);return null==t?t=P:b(t,0,8),Z(e,e.e+1,t)},O.isEqualTo=O.eq=function(t,e){return 0===g(this,new z(t,e))},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(t,e){return g(this,new z(t,e))>0},O.isGreaterThanOrEqualTo=O.gte=function(t,e){return 1===(e=g(this,new z(t,e)))||0===e},O.isInteger=function(){return!!this.c&&h(this.e/c)>this.c.length-2},O.isLessThan=O.lt=function(t,e){return g(this,new z(t,e))<0},O.isLessThanOrEqualTo=O.lte=function(t,e){return-1===(e=g(this,new z(t,e)))||0===e},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&0==this.c[0]},O.minus=function(t,e){var r,n,i,o,s=this,u=s.s;if(e=(t=new z(t,e)).s,!u||!e)return new z(NaN);if(u!=e)return t.s=-e,s.plus(t);var f=s.e/c,l=t.e/c,d=s.c,p=t.c;if(!f||!l){if(!d||!p)return d?(t.s=-e,t):new z(p?s:NaN);if(!d[0]||!p[0])return p[0]?(t.s=-e,t):new z(d[0]?s:3==P?-0:0)}if(f=h(f),l=h(l),d=d.slice(),u=f-l){for((o=u<0)?(u=-u,i=d):(l=f,i=p),i.reverse(),e=u;e--;i.push(0));i.reverse()}else for(n=(o=(u=d.length)<(e=p.length))?u:e,u=e=0;e<n;e++)if(d[e]!=p[e]){o=d[e]<p[e];break}if(o&&(i=d,d=p,p=i,t.s=-t.s),(e=(n=p.length)-(r=d.length))>0)for(;e--;d[r++]=0);for(e=a-1;n>u;){if(d[--n]<p[n]){for(r=n;r&&!d[--r];d[r]=e);--d[r],d[n]+=a}d[n]-=p[n]}for(;0==d[0];d.splice(0,1),--l);return d[0]?H(t,d,l):(t.s=3==P?-1:1,t.c=[t.e=0],t)},O.modulo=O.mod=function(t,e){var r,n,i=this;return t=new z(t,e),!i.c||!t.s||t.c&&!t.c[0]?new z(NaN):!t.c||i.c&&!i.c[0]?new z(i):(9==j?(n=t.s,t.s=1,r=v(i,t,0,3),t.s=n,r.s*=n):r=v(i,t,0,j),(t=i.minus(r.times(t))).c[0]||1!=j||(t.s=i.s),t)},O.multipliedBy=O.times=function(t,e){var r,n,i,o,s,u,f,d,p,g,b,y,m,w,v,E=this,_=E.c,x=(t=new z(t,e)).c;if(!(_&&x&&_[0]&&x[0]))return!E.s||!t.s||_&&!_[0]&&!x||x&&!x[0]&&!_?t.c=t.e=t.s=null:(t.s*=E.s,_&&x?(t.c=[0],t.e=0):t.c=t.e=null),t;for(n=h(E.e/c)+h(t.e/c),t.s*=E.s,(f=_.length)<(g=x.length)&&(m=_,_=x,x=m,i=f,f=g,g=i),i=f+g,m=[];i--;m.push(0));for(w=a,v=l,i=g;--i>=0;){for(r=0,b=x[i]%v,y=x[i]/v|0,o=i+(s=f);o>i;)r=((d=b*(d=_[--s]%v)+(u=y*d+(p=_[s]/v|0)*b)%v*v+m[o]+r)/w|0)+(u/v|0)+y*p,m[o--]=d%w;m[o]=r}return r?++n:m.splice(0,1),H(t,m,n)},O.negated=function(){var t=new z(this);return t.s=-t.s||null,t},O.plus=function(t,e){var r,n=this,i=n.s;if(e=(t=new z(t,e)).s,!i||!e)return new z(NaN);if(i!=e)return t.s=-e,n.minus(t);var o=n.e/c,s=t.e/c,u=n.c,f=t.c;if(!o||!s){if(!u||!f)return new z(i/0);if(!u[0]||!f[0])return f[0]?t:new z(u[0]?n:0*i)}if(o=h(o),s=h(s),u=u.slice(),i=o-s){for(i>0?(s=o,r=f):(i=-i,r=u),r.reverse();i--;r.push(0));r.reverse()}for((i=u.length)-(e=f.length)<0&&(r=f,f=u,u=r,e=i),i=0;e;)i=(u[--e]=u[e]+f[e]+i)/a|0,u[e]=a===u[e]?0:u[e]%a;return i&&(u=[i].concat(u),++s),H(t,u,s)},O.precision=O.sd=function(t,e){var r,n,i,o=this;if(null!=t&&t!==!!t)return b(t,1,d),null==e?e=P:b(e,0,8),Z(new z(o),t,e);if(!(r=o.c))return null;if(n=(i=r.length-1)*c+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return t&&o.e+1>n&&(n=o.e+1),n},O.shiftedBy=function(t){return b(t,-9007199254740991,u),this.times("1e"+t)},O.squareRoot=O.sqrt=function(){var t,e,r,n,i,o=this,s=o.c,a=o.s,c=o.e,u=U+4,f=new z("0.5");if(1!==a||!s||!s[0])return new z(!a||a<0&&(!s||s[0])?NaN:s?o:1/0);if(0==(a=Math.sqrt(+W(o)))||a==1/0?(((e=p(s)).length+c)%2==0&&(e+="0"),a=Math.sqrt(+e),c=h((c+1)/2)-(c<0||c%2),r=new z(e=a==1/0?"5e"+c:(e=a.toExponential()).slice(0,e.indexOf("e")+1)+c)):r=new z(a+""),r.c[0])for((a=(c=r.e)+u)<3&&(a=0);;)if(i=r,r=f.times(i.plus(v(o,i,u,1))),p(i.c).slice(0,a)===(e=p(r.c)).slice(0,a)){if(r.e<c&&--a,"9999"!=(e=e.slice(a-3,a+1))&&(n||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(Z(r,r.e+U+2,1),t=!r.times(r).eq(o));break}if(!n&&(Z(i,i.e+U+2,0),i.times(i).eq(o))){r=i;break}u+=4,a+=4,n=1}return Z(r,r.e+U+1,P,t)},O.toExponential=function(t,e){return null!=t&&(b(t,0,d),t++),G(this,t,e,1)},O.toFixed=function(t,e){return null!=t&&(b(t,0,d),t=t+this.e+1),G(this,t,e)},O.toFormat=function(t,e,r){var n,i=this;if(null==r)null!=t&&e&&"object"==typeof e?(r=e,e=null):t&&"object"==typeof t?(r=t,t=e=null):r=q;else if("object"!=typeof r)throw Error(o+"Argument not an object: "+r);if(n=i.toFixed(t,e),i.c){var s,a=n.split("."),c=+r.groupSize,u=+r.secondaryGroupSize,f=r.groupSeparator||"",l=a[0],d=a[1],h=i.s<0,p=h?l.slice(1):l,g=p.length;if(u&&(s=c,c=u,u=s,g-=s),c>0&&g>0){for(s=g%c||c,l=p.substr(0,s);s<g;s+=c)l+=f+p.substr(s,c);u>0&&(l+=f+p.slice(s)),h&&(l="-"+l)}n=d?l+(r.decimalSeparator||"")+((u=+r.fractionGroupSize)?d.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):d):l}return(r.prefix||"")+n+(r.suffix||"")},O.toFraction=function(t){var e,r,n,i,s,a,u,l,d,h,g,b,y=this,m=y.c;if(null!=t&&(!(u=new z(t)).isInteger()&&(u.c||1!==u.s)||u.lt(R)))throw Error(o+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+W(u));if(!m)return new z(y);for(e=new z(R),d=r=new z(R),n=l=new z(R),b=p(m),s=e.e=b.length-y.e-1,e.c[0]=f[(a=s%c)<0?c+a:a],t=!t||u.comparedTo(e)>0?s>0?e:d:u,a=C,C=1/0,u=new z(b),l.c[0]=0;h=v(u,e,0,1),1!=(i=r.plus(h.times(n))).comparedTo(t);)r=n,n=i,d=l.plus(h.times(i=d)),l=i,e=u.minus(h.times(i=e)),u=i;return i=v(t.minus(r),n,0,1),l=l.plus(i.times(d)),r=r.plus(i.times(n)),l.s=d.s=y.s,g=v(d,n,s*=2,P).minus(y).abs().comparedTo(v(l,r,s,P).minus(y).abs())<1?[d,n]:[l,r],C=a,g},O.toNumber=function(){return+W(this)},O.toPrecision=function(t,e){return null!=t&&b(t,1,d),G(this,t,e,2)},O.toString=function(t){var e,r=this,n=r.s,i=r.e;return null===i?n?(e="Infinity",n<0&&(e="-"+e)):e="NaN":(null==t?e=i<=k||i>=F?m(p(r.c),i):w(p(r.c),i,"0"):10===t&&V?e=w(p((r=Z(new z(r),U+i+1,P)).c),r.e,"0"):(b(t,2,M.length,"Base"),e=E(w(p(r.c),i,"0"),10,t,n,!0)),n<0&&r.c[0]&&(e="-"+e)),e},O.valueOf=O.toJSON=function(){return W(this)},O._isBigNumber=!0,null!=e&&z.set(e),z}(),e.default=e.BigNumber=e,un.exports?un.exports=e:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=e)}(Et);var ln=fn.exports,dn={},hn={};const pn=ln.BigNumber;hn.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},hn.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36},hn.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},hn.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},hn.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")},hn.SHIFT32=Math.pow(2,32),hn.SHIFT16=Math.pow(2,16),hn.MAX_SAFE_HIGH=2097151,hn.NEG_ONE=new pn(-1),hn.TEN=new pn(10),hn.TWO=new pn(2),hn.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5},function(t){const{Buffer:e}=cn,r=ln.BigNumber,n=hn,i=n.SHIFT32,o=n.SHIFT16;t.parseHalf=function(t){var e,r,n;return n=128&t[0]?-1:1,e=(124&t[0])>>2,r=(3&t[0])<<8|t[1],e?31===e?n*(r?NaN:Infinity):n*Math.pow(2,e-25)*(1024+r):5.960464477539063e-8*n*r},t.arrayBufferToBignumber=function(t){const e=t.byteLength;let n="";for(let r=0;r<e;r++)n+=(i=t[r])<16?"0"+i.toString(16):i.toString(16);var i;return new r(n,16)},t.buildMap=t=>{const e=new Map,r=Object.keys(t),n=r.length;for(let i=0;i<n;i++)e.set(r[i],t[r[i]]);return e},t.buildInt32=(t,e)=>t*o+e,t.buildInt64=(e,n,o,s)=>{const a=t.buildInt32(e,n),c=t.buildInt32(o,s);return a>2097151?new r(a).times(i).plus(c):a*i+c},t.writeHalf=function(t,r){const n=e.allocUnsafe(4);n.writeFloatBE(r,0);const i=n.readUInt32BE(0);if(0!=(8191&i))return!1;var o=i>>16&32768;const s=i>>23&255,a=8388607&i;if(s>=113&&s<=142)o+=(s-112<<10)+(a>>13);else{if(!(s>=103&&s<113))return!1;if(a&(1<<126-s)-1)return!1;o+=a+8388608>>126-s}return t.writeUInt16BE(o,0),!0},t.keySorter=function(t,e){var r=t[0].byteLength,n=e[0].byteLength;return r>n?1:n>r?-1:t[0].compare(e[0])},t.isNegativeZero=t=>0===t&&1/t<0,t.nextPowerOf2=t=>{let e=0;if(t&&!(t&t-1))return t;for(;0!==t;)t>>=1,e+=1;return 1<<e}}(dn);const gn=hn,bn=gn.MT,yn=gn.SIMPLE,mn=gn.SYMS;var wn=class t{constructor(t){if("number"!=typeof t)throw new Error("Invalid Simple type: "+typeof t);if(t<0||t>255||(0|t)!==t)throw new Error("value must be a small positive integer: "+t);this.value=t}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(t){return t._pushInt(this.value,bn.SIMPLE_FLOAT)}static isSimple(e){return e instanceof t}static decode(e,r){switch(null==r&&(r=!0),e){case yn.FALSE:return!1;case yn.TRUE:return!0;case yn.NULL:return r?null:mn.NULL;case yn.UNDEFINED:return r?void 0:mn.UNDEFINED;case-1:if(!r)throw new Error("Invalid BREAK");return mn.BREAK;default:return new t(e)}}};var vn=class t{constructor(t,e,r){if(this.tag=t,this.value=e,this.err=r,"number"!=typeof this.tag)throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(0|this.tag)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(t){return t._pushTag(this.tag),t.pushAny(this.value)}convert(e){var r,n;if("function"!=typeof(n=null!=e?e[this.tag]:void 0)&&"function"!=typeof(n=t["_tag"+this.tag]))return this;try{return n.call(t,this.value)}catch(t){return r=t,this.err=r,this}}};const En=self.location?self.location.protocol+"//"+self.location.host:"",_n=self.URL;var xn={URLWithLegacySupport:class{constructor(t="",e=En){this.super=new _n(t,e),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(t){this.super.hash=t}set host(t){this.super.host=t}set hostname(t){this.super.hostname=t}set href(t){this.super.href=t}set origin(t){this.super.origin=t}set password(t){this.super.password=t}set pathname(t){this.super.pathname=t}set port(t){this.super.port=t}set protocol(t){this.super.protocol=t}set search(t){this.super.search=t}set searchParams(t){this.super.searchParams=t}set username(t){this.super.username=t}createObjectURL(t){return this.super.createObjectURL(t)}revokeObjectURL(t){this.super.revokeObjectURL(t)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:En,format:function(t){if("string"==typeof t){return new _n(t).toString()}if(!(t instanceof _n)){const e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",n=t.port?":"+t.port:"",i=t.protocol?t.protocol+"//":"",o=t.host||"",s=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),c=t.hash||"",u=t.pathname||"";return`${i}${e||r}${o||s+n}${t.path||u+a}${c}`}}};const{URLWithLegacySupport:Bn,format:In}=xn;const{URLWithLegacySupport:An,format:Sn,URLSearchParams:Tn,defaultBase:Nn}=xn;var On={URL:An,URLSearchParams:Tn,format:Sn,relative:(t,e={},r={},n)=>{let i,o=e.protocol?e.protocol.replace(":",""):"http";o=(r[o]||n||o)+":";try{i=new Bn(t)}catch(t){i={}}const s=Object.assign({},e,{protocol:o||i.protocol,host:e.host||i.host});return new Bn(t,In(s)).toString()},defaultBase:Nn};const{Buffer:Rn}=cn,Un=Pt,Pn=ln.BigNumber,kn=function(t,e,r){"use asm";var n=new t.Uint8Array(r),i=e.pushInt,o=e.pushInt32,s=e.pushInt32Neg,a=e.pushInt64,c=e.pushInt64Neg,u=e.pushFloat,f=e.pushFloatSingle,l=e.pushFloatDouble,d=e.pushTrue,h=e.pushFalse,p=e.pushUndefined,g=e.pushNull,b=e.pushInfinity,y=e.pushInfinityNeg,m=e.pushNaN,w=e.pushNaNNeg,v=e.pushArrayStart,E=e.pushArrayStartFixed,_=e.pushArrayStartFixed32,x=e.pushArrayStartFixed64,B=e.pushObjectStart,I=e.pushObjectStartFixed,A=e.pushObjectStartFixed32,S=e.pushObjectStartFixed64,T=e.pushByteString,N=e.pushByteStringStart,O=e.pushUtf8String,R=e.pushUtf8StringStart,U=e.pushSimpleUnassigned,P=e.pushTagStart,k=e.pushTagStart4,F=e.pushTagStart8,L=e.pushTagUnassigned,C=e.pushBreak,D=t.Math.pow,j=0,$=0,q=0;function M(t){t=t|0;j=0;$=t;while((j|0)<($|0)){q=Yt[n[j]&255](n[j]|0)|0;if((q|0)>0){break}}return q|0}function V(t){t=t|0;if(((j|0)+(t|0)|0)<($|0)){return 0}return 1}function z(t){t=t|0;return n[t|0]<<8|n[t+1|0]|0}function G(t){t=t|0;return n[t|0]<<24|n[t+1|0]<<16|n[t+2|0]<<8|n[t+3|0]|0}function K(t){t=t|0;i(t|0);j=j+1|0;return 0}function H(t){t=t|0;if(V(1)|0){return 1}i(n[j+1|0]|0);j=j+2|0;return 0}function Z(t){t=t|0;if(V(2)|0){return 1}i(z(j+1|0)|0);j=j+3|0;return 0}function W(t){t=t|0;if(V(4)|0){return 1}o(z(j+1|0)|0,z(j+3|0)|0);j=j+5|0;return 0}function Y(t){t=t|0;if(V(8)|0){return 1}a(z(j+1|0)|0,z(j+3|0)|0,z(j+5|0)|0,z(j+7|0)|0);j=j+9|0;return 0}function J(t){t=t|0;i(-1-(t-32|0)|0);j=j+1|0;return 0}function X(t){t=t|0;if(V(1)|0){return 1}i(-1-(n[j+1|0]|0)|0);j=j+2|0;return 0}function Q(t){t=t|0;var e=0;if(V(2)|0){return 1}e=z(j+1|0)|0;i(-1-(e|0)|0);j=j+3|0;return 0}function tt(t){t=t|0;if(V(4)|0){return 1}s(z(j+1|0)|0,z(j+3|0)|0);j=j+5|0;return 0}function et(t){t=t|0;if(V(8)|0){return 1}c(z(j+1|0)|0,z(j+3|0)|0,z(j+5|0)|0,z(j+7|0)|0);j=j+9|0;return 0}function rt(t){t=t|0;var e=0;var r=0;var n=0;n=t-64|0;if(V(n|0)|0){return 1}e=j+1|0;r=(j+1|0)+(n|0)|0;T(e|0,r|0);j=r|0;return 0}function nt(t){t=t|0;var e=0;var r=0;var i=0;if(V(1)|0){return 1}i=n[j+1|0]|0;e=j+2|0;r=(j+2|0)+(i|0)|0;if(V(i+1|0)|0){return 1}T(e|0,r|0);j=r|0;return 0}function it(t){t=t|0;var e=0;var r=0;var n=0;if(V(2)|0){return 1}n=z(j+1|0)|0;e=j+3|0;r=(j+3|0)+(n|0)|0;if(V(n+2|0)|0){return 1}T(e|0,r|0);j=r|0;return 0}function ot(t){t=t|0;var e=0;var r=0;var n=0;if(V(4)|0){return 1}n=G(j+1|0)|0;e=j+5|0;r=(j+5|0)+(n|0)|0;if(V(n+4|0)|0){return 1}T(e|0,r|0);j=r|0;return 0}function st(t){t=t|0;return 1}function at(t){t=t|0;N();j=j+1|0;return 0}function ct(t){t=t|0;var e=0;var r=0;var n=0;n=t-96|0;if(V(n|0)|0){return 1}e=j+1|0;r=(j+1|0)+(n|0)|0;O(e|0,r|0);j=r|0;return 0}function ut(t){t=t|0;var e=0;var r=0;var i=0;if(V(1)|0){return 1}i=n[j+1|0]|0;e=j+2|0;r=(j+2|0)+(i|0)|0;if(V(i+1|0)|0){return 1}O(e|0,r|0);j=r|0;return 0}function ft(t){t=t|0;var e=0;var r=0;var n=0;if(V(2)|0){return 1}n=z(j+1|0)|0;e=j+3|0;r=(j+3|0)+(n|0)|0;if(V(n+2|0)|0){return 1}O(e|0,r|0);j=r|0;return 0}function lt(t){t=t|0;var e=0;var r=0;var n=0;if(V(4)|0){return 1}n=G(j+1|0)|0;e=j+5|0;r=(j+5|0)+(n|0)|0;if(V(n+4|0)|0){return 1}O(e|0,r|0);j=r|0;return 0}function dt(t){t=t|0;return 1}function ht(t){t=t|0;R();j=j+1|0;return 0}function pt(t){t=t|0;E(t-128|0);j=j+1|0;return 0}function gt(t){t=t|0;if(V(1)|0){return 1}E(n[j+1|0]|0);j=j+2|0;return 0}function bt(t){t=t|0;if(V(2)|0){return 1}E(z(j+1|0)|0);j=j+3|0;return 0}function yt(t){t=t|0;if(V(4)|0){return 1}_(z(j+1|0)|0,z(j+3|0)|0);j=j+5|0;return 0}function mt(t){t=t|0;if(V(8)|0){return 1}x(z(j+1|0)|0,z(j+3|0)|0,z(j+5|0)|0,z(j+7|0)|0);j=j+9|0;return 0}function wt(t){t=t|0;v();j=j+1|0;return 0}function vt(t){t=t|0;var e=0;e=t-160|0;if(V(e|0)|0){return 1}I(e|0);j=j+1|0;return 0}function Et(t){t=t|0;if(V(1)|0){return 1}I(n[j+1|0]|0);j=j+2|0;return 0}function _t(t){t=t|0;if(V(2)|0){return 1}I(z(j+1|0)|0);j=j+3|0;return 0}function xt(t){t=t|0;if(V(4)|0){return 1}A(z(j+1|0)|0,z(j+3|0)|0);j=j+5|0;return 0}function Bt(t){t=t|0;if(V(8)|0){return 1}S(z(j+1|0)|0,z(j+3|0)|0,z(j+5|0)|0,z(j+7|0)|0);j=j+9|0;return 0}function It(t){t=t|0;B();j=j+1|0;return 0}function At(t){t=t|0;P(t-192|0|0);j=j+1|0;return 0}function St(t){t=t|0;P(t|0);j=j+1|0;return 0}function Tt(t){t=t|0;P(t|0);j=j+1|0;return 0}function Nt(t){t=t|0;P(t|0);j=j+1|0;return 0}function Ot(t){t=t|0;P(t|0);j=j+1|0;return 0}function Rt(t){t=t|0;P(t-192|0|0);j=j+1|0;return 0}function Ut(t){t=t|0;P(t|0);j=j+1|0;return 0}function Pt(t){t=t|0;P(t|0);j=j+1|0;return 0}function kt(t){t=t|0;P(t|0);j=j+1|0;return 0}function Ft(t){t=t|0;if(V(1)|0){return 1}P(n[j+1|0]|0);j=j+2|0;return 0}function Lt(t){t=t|0;if(V(2)|0){return 1}P(z(j+1|0)|0);j=j+3|0;return 0}function Ct(t){t=t|0;if(V(4)|0){return 1}k(z(j+1|0)|0,z(j+3|0)|0);j=j+5|0;return 0}function Dt(t){t=t|0;if(V(8)|0){return 1}F(z(j+1|0)|0,z(j+3|0)|0,z(j+5|0)|0,z(j+7|0)|0);j=j+9|0;return 0}function jt(t){t=t|0;U((t|0)-224|0);j=j+1|0;return 0}function $t(t){t=t|0;h();j=j+1|0;return 0}function qt(t){t=t|0;d();j=j+1|0;return 0}function Mt(t){t=t|0;g();j=j+1|0;return 0}function Vt(t){t=t|0;p();j=j+1|0;return 0}function zt(t){t=t|0;if(V(1)|0){return 1}U(n[j+1|0]|0);j=j+2|0;return 0}function Gt(t){t=t|0;var e=0;var r=0;var i=1.0;var o=0.0;var s=0.0;var a=0.0;if(V(2)|0){return 1}e=n[j+1|0]|0;r=n[j+2|0]|0;if((e|0)&0x80){i=-1.0}o=+(((e|0)&0x7C)>>2);s=+(((e|0)&0x03)<<8|r);if(+o==0.0){u(+(+i*+5.9604644775390625e-8*+s))}else if(+o==31.0){if(+i==1.0){if(+s>0.0){m()}else{b()}}else{if(+s>0.0){w()}else{y()}}}else{u(+(+i*D(+2,+(+o-25.0))*+(1024.0+s)))}j=j+3|0;return 0}function Kt(t){t=t|0;if(V(4)|0){return 1}f(n[j+1|0]|0,n[j+2|0]|0,n[j+3|0]|0,n[j+4|0]|0);j=j+5|0;return 0}function Ht(t){t=t|0;if(V(8)|0){return 1}l(n[j+1|0]|0,n[j+2|0]|0,n[j+3|0]|0,n[j+4|0]|0,n[j+5|0]|0,n[j+6|0]|0,n[j+7|0]|0,n[j+8|0]|0);j=j+9|0;return 0}function Zt(t){t=t|0;return 1}function Wt(t){t=t|0;C();j=j+1|0;return 0}var Yt=[K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,H,Z,W,Y,Zt,Zt,Zt,Zt,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,J,X,Q,tt,et,Zt,Zt,Zt,Zt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,nt,it,ot,st,Zt,Zt,Zt,at,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ut,ft,lt,dt,Zt,Zt,Zt,ht,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,gt,bt,yt,mt,Zt,Zt,Zt,wt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,Et,_t,xt,Bt,Zt,Zt,Zt,It,At,At,At,At,At,At,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Ft,Lt,Ct,Dt,Zt,Zt,Zt,Zt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,$t,qt,Mt,Vt,zt,Gt,Kt,Ht,Zt,Zt,Zt,Wt];return{parse:M}},Fn=dn,Ln=hn,Cn=wn,Dn=vn,{URL:jn}=On;let $n=class t{constructor(t){!(t=t||{}).size||t.size<65536?t.size=65536:t.size=Fn.nextPowerOf2(t.size),this._heap=new ArrayBuffer(t.size),this._heap8=new Uint8Array(this._heap),this._buffer=Rn.from(this._heap),this._reset(),this._knownTags=Object.assign({0:t=>new Date(t),1:t=>new Date(1e3*t),2:t=>Fn.arrayBufferToBignumber(t),3:t=>Ln.NEG_ONE.minus(Fn.arrayBufferToBignumber(t)),4:t=>Ln.TEN.pow(t[0]).times(t[1]),5:t=>Ln.TWO.pow(t[0]).times(t[1]),32:t=>new jn(t),35:t=>new RegExp(t)},t.tags),this.parser=kn(Et,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var t=this._parents.pop();if(t.length>0)throw new Error(`Missing ${t.length} elements`);switch(t.type){case Ln.PARENT.TAG:this._push(this.createTag(t.ref[0],t.ref[1]));break;case Ln.PARENT.BYTE_STRING:this._push(this.createByteString(t.ref,t.length));break;case Ln.PARENT.UTF8_STRING:this._push(this.createUtf8String(t.ref,t.length));break;case Ln.PARENT.MAP:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(t.ref,t.length));break;case Ln.PARENT.OBJECT:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(t.ref,t.length));break;case Ln.PARENT.ARRAY:this._push(this.createArray(t.ref,t.length))}this._currentParent&&this._currentParent.type===Ln.PARENT.TAG&&this._dec()}_dec(){const t=this._currentParent;t.length<0||(t.length--,0===t.length&&this._closeParent())}_push(t,e){const r=this._currentParent;switch(r.values++,r.type){case Ln.PARENT.ARRAY:case Ln.PARENT.BYTE_STRING:case Ln.PARENT.UTF8_STRING:r.length>-1?this._ref[this._ref.length-r.length]=t:this._ref.push(t),this._dec();break;case Ln.PARENT.OBJECT:null!=r.tmpKey?(this._ref[r.tmpKey]=t,r.tmpKey=null,this._dec()):(r.tmpKey=t,"string"!=typeof r.tmpKey&&(r.type=Ln.PARENT.MAP,r.ref=Fn.buildMap(r.ref)));break;case Ln.PARENT.MAP:null!=r.tmpKey?(this._ref.set(r.tmpKey,t),r.tmpKey=null,this._dec()):r.tmpKey=t;break;case Ln.PARENT.TAG:this._ref.push(t),e||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(t,e,r){this._parents[this._depth]={type:e,length:r,ref:t,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:Ln.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(t,e){const r=this._knownTags[t];return r?r(e):new Dn(t,e)}createMap(t,e){return t}createObject(t,e){return t}createArray(t,e){return t}createByteString(t,e){return Rn.concat(t)}createByteStringFromHeap(t,e){return t===e?Rn.alloc(0):Rn.from(this._heap.slice(t,e))}createInt(t){return t}createInt32(t,e){return Fn.buildInt32(t,e)}createInt64(t,e,r,n){return Fn.buildInt64(t,e,r,n)}createFloat(t){return t}createFloatSingle(t,e,r,n){return Un.read([t,e,r,n],0,!1,23,4)}createFloatDouble(t,e,r,n,i,o,s,a){return Un.read([t,e,r,n,i,o,s,a],0,!1,52,8)}createInt32Neg(t,e){return-1-Fn.buildInt32(t,e)}createInt64Neg(t,e,r,n){const i=Fn.buildInt32(t,e),o=Fn.buildInt32(r,n);return i>Ln.MAX_SAFE_HIGH?Ln.NEG_ONE.minus(new Pn(i).times(Ln.SHIFT32).plus(o)):-1-(i*Ln.SHIFT32+o)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(t,e){return t.join("")}createUtf8StringFromHeap(t,e){return t===e?"":this._buffer.toString("utf8",t,e)}createSimpleUnassigned(t){return new Cn(t)}pushInt(t){this._push(this.createInt(t))}pushInt32(t,e){this._push(this.createInt32(t,e))}pushInt64(t,e,r,n){this._push(this.createInt64(t,e,r,n))}pushFloat(t){this._push(this.createFloat(t))}pushFloatSingle(t,e,r,n){this._push(this.createFloatSingle(t,e,r,n))}pushFloatDouble(t,e,r,n,i,o,s,a){this._push(this.createFloatDouble(t,e,r,n,i,o,s,a))}pushInt32Neg(t,e){this._push(this.createInt32Neg(t,e))}pushInt64Neg(t,e,r,n){this._push(this.createInt64Neg(t,e,r,n))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],Ln.PARENT.ARRAY,-1)}pushArrayStartFixed(t){this._createArrayStartFixed(t)}pushArrayStartFixed32(t,e){const r=Fn.buildInt32(t,e);this._createArrayStartFixed(r)}pushArrayStartFixed64(t,e,r,n){const i=Fn.buildInt64(t,e,r,n);this._createArrayStartFixed(i)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(t){this._createObjectStartFixed(t)}pushObjectStartFixed32(t,e){const r=Fn.buildInt32(t,e);this._createObjectStartFixed(r)}pushObjectStartFixed64(t,e,r,n){const i=Fn.buildInt64(t,e,r,n);this._createObjectStartFixed(i)}pushByteStringStart(){this._parents[this._depth]={type:Ln.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(t,e){this._push(this.createByteStringFromHeap(t,e))}pushUtf8StringStart(){this._parents[this._depth]={type:Ln.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(t,e){this._push(this.createUtf8StringFromHeap(t,e))}pushSimpleUnassigned(t){this._push(this.createSimpleUnassigned(t))}pushTagStart(t){this._parents[this._depth]={type:Ln.PARENT.TAG,length:1,ref:[t]}}pushTagStart4(t,e){this.pushTagStart(Fn.buildInt32(t,e))}pushTagStart8(t,e,r,n){this.pushTagStart(Fn.buildInt64(t,e,r,n))}pushTagUnassigned(t){this._push(this.createTag(t))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(t){0!==t?this._createParent({},Ln.PARENT.OBJECT,t):this._push(this.createObject({}))}_createArrayStartFixed(t){0!==t?this._createParent(new Array(t),Ln.PARENT.ARRAY,t):this._push(this.createArray([]))}_decode(t){if(0===t.byteLength)throw new Error("Input too short");this._reset(),this._heap8.set(t);const e=this.parser.parse(t.byteLength);if(this._depth>1){for(;0===this._currentParent.length;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(e>0)throw new Error("Failed to parse");if(0===this._res.length)throw new Error("No valid result")}decodeFirst(t){return this._decode(t),this._res[0]}decodeAll(t){return this._decode(t),this._res}static decode(e,r){"string"==typeof e&&(e=Rn.from(e,r||"hex"));return new t({size:e.length}).decodeFirst(e)}static decodeAll(e,r){"string"==typeof e&&(e=Rn.from(e,r||"hex"));return new t({size:e.length}).decodeAll(e)}};$n.decodeFirst=$n.decode;var qn=$n;const{Buffer:Mn}=cn,Vn=qn,zn=dn;class Gn extends Vn{createTag(t,e){return`${t}(${e})`}createInt(t){return super.createInt(t).toString()}createInt32(t,e){return super.createInt32(t,e).toString()}createInt64(t,e,r,n){return super.createInt64(t,e,r,n).toString()}createInt32Neg(t,e){return super.createInt32Neg(t,e).toString()}createInt64Neg(t,e,r,n){return super.createInt64Neg(t,e,r,n).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(t){const e=super.createFloat(t);return zn.isNegativeZero(t)?"-0_1":`${e}_1`}createFloatSingle(t,e,r,n){return`${super.createFloatSingle(t,e,r,n)}_2`}createFloatDouble(t,e,r,n,i,o,s,a){return`${super.createFloatDouble(t,e,r,n,i,o,s,a)}_3`}createByteString(t,e){const r=t.join(", ");return-1===e?`(_ ${r})`:`h'${r}`}createByteStringFromHeap(t,e){return`h'${Mn.from(super.createByteStringFromHeap(t,e)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(t){return`simple(${t})`}createArray(t,e){const r=super.createArray(t,e);return-1===e?`[_ ${r.join(", ")}]`:`[${r.join(", ")}]`}createMap(t,e){const r=super.createMap(t),n=Array.from(r.keys()).reduce(Hn(r),"");return-1===e?`{_ ${n}}`:`{${n}}`}createObject(t,e){const r=super.createObject(t),n=Object.keys(r).reduce(Hn(r),"");return-1===e?`{_ ${n}}`:`{${n}}`}createUtf8String(t,e){const r=t.join(", ");return-1===e?`(_ ${r})`:`"${r}"`}createUtf8StringFromHeap(t,e){return`"${Mn.from(super.createUtf8StringFromHeap(t,e)).toString("utf8")}"`}static diagnose(t,e){"string"==typeof t&&(t=Mn.from(t,e||"hex"));return(new Gn).decodeFirst(t)}}var Kn=Gn;function Hn(t){return(e,r)=>e?`${e}, ${r}: ${t[r]}`:`${r}: ${t[r]}`}const{Buffer:Zn}=cn,{URL:Wn}=On,Yn=ln.BigNumber,Jn=dn,Xn=hn,Qn=Xn.MT,ti=Xn.NUMBYTES,ei=Xn.SHIFT32,ri=Xn.SYMS,ni=Xn.TAG,ii=Xn.MT.SIMPLE_FLOAT<<5|Xn.NUMBYTES.TWO,oi=Xn.MT.SIMPLE_FLOAT<<5|Xn.NUMBYTES.FOUR,si=Xn.MT.SIMPLE_FLOAT<<5|Xn.NUMBYTES.EIGHT,ai=Xn.MT.SIMPLE_FLOAT<<5|Xn.SIMPLE.TRUE,ci=Xn.MT.SIMPLE_FLOAT<<5|Xn.SIMPLE.FALSE,ui=Xn.MT.SIMPLE_FLOAT<<5|Xn.SIMPLE.UNDEFINED,fi=Xn.MT.SIMPLE_FLOAT<<5|Xn.SIMPLE.NULL,li=new Yn("0x20000000000000"),di=Zn.from("f97e00","hex"),hi=Zn.from("f9fc00","hex"),pi=Zn.from("f97c00","hex");class gi{constructor(t){t=t||{},this.streaming="function"==typeof t.stream,this.onData=t.stream,this.semanticTypes=[[Wn,this._pushUrl],[Yn,this._pushBigNumber]];const e=t.genTypes||[],r=e.length;for(let t=0;t<r;t++)this.addSemanticType(e[t][0],e[t][1]);this._reset()}addSemanticType(t,e){const r=this.semanticTypes.length;for(let n=0;n<r;n++){if(this.semanticTypes[n][0]===t){const t=this.semanticTypes[n][1];return this.semanticTypes[n][1]=e,t}}return this.semanticTypes.push([t,e]),null}push(t){return!t||(this.result[this.offset]=t,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=t.length,this.offset++,this.streaming&&this.onData(this.finalize()),!0)}pushWrite(t,e,r){return this.result[this.offset]=t,this.resultMethod[this.offset]=e,this.resultLength[this.offset]=r,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(t){return this.pushWrite(t,1,1)}_pushUInt16BE(t){return this.pushWrite(t,2,2)}_pushUInt32BE(t){return this.pushWrite(t,3,4)}_pushDoubleBE(t){return this.pushWrite(t,4,8)}_pushNaN(){return this.push(di)}_pushInfinity(t){const e=t<0?hi:pi;return this.push(e)}_pushFloat(t){const e=Zn.allocUnsafe(2);if(Jn.writeHalf(e,t)&&Jn.parseHalf(e)===t)return this._pushUInt8(ii)&&this.push(e);const r=Zn.allocUnsafe(4);return r.writeFloatBE(t,0),r.readFloatBE(0)===t?this._pushUInt8(oi)&&this.push(r):this._pushUInt8(si)&&this._pushDoubleBE(t)}_pushInt(t,e,r){const n=e<<5;return t<24?this._pushUInt8(n|t):t<=255?this._pushUInt8(n|ti.ONE)&&this._pushUInt8(t):t<=65535?this._pushUInt8(n|ti.TWO)&&this._pushUInt16BE(t):t<=4294967295?this._pushUInt8(n|ti.FOUR)&&this._pushUInt32BE(t):t<=Number.MAX_SAFE_INTEGER?this._pushUInt8(n|ti.EIGHT)&&this._pushUInt32BE(Math.floor(t/ei))&&this._pushUInt32BE(t%ei):e===Qn.NEG_INT?this._pushFloat(r):this._pushFloat(t)}_pushIntNum(t){return t<0?this._pushInt(-t-1,Qn.NEG_INT,t):this._pushInt(t,Qn.POS_INT)}_pushNumber(t){switch(!1){case t==t:return this._pushNaN(t);case isFinite(t):return this._pushInfinity(t);case t%1!=0:return this._pushIntNum(t);default:return this._pushFloat(t)}}_pushString(t){const e=Zn.byteLength(t,"utf8");return this._pushInt(e,Qn.UTF8_STRING)&&this.pushWrite(t,5,e)}_pushBoolean(t){return this._pushUInt8(t?ai:ci)}_pushUndefined(t){return this._pushUInt8(ui)}_pushArray(t,e){const r=e.length;if(!t._pushInt(r,Qn.ARRAY))return!1;for(let n=0;n<r;n++)if(!t.pushAny(e[n]))return!1;return!0}_pushTag(t){return this._pushInt(t,Qn.TAG)}_pushDate(t,e){return t._pushTag(ni.DATE_EPOCH)&&t.pushAny(Math.round(e/1e3))}_pushBuffer(t,e){return t._pushInt(e.length,Qn.BYTE_STRING)&&t.push(e)}_pushNoFilter(t,e){return t._pushBuffer(t,e.slice())}_pushRegexp(t,e){return t._pushTag(ni.REGEXP)&&t.pushAny(e.source)}_pushSet(t,e){if(!t._pushInt(e.size,Qn.ARRAY))return!1;for(const r of e)if(!t.pushAny(r))return!1;return!0}_pushUrl(t,e){return t._pushTag(ni.URI)&&t.pushAny(e.format())}_pushBigint(t){let e=ni.POS_BIGINT;t.isNegative()&&(t=t.negated().minus(1),e=ni.NEG_BIGINT);let r=t.toString(16);r.length%2&&(r="0"+r);const n=Zn.from(r,"hex");return this._pushTag(e)&&this._pushBuffer(this,n)}_pushBigNumber(t,e){if(e.isNaN())return t._pushNaN();if(!e.isFinite())return t._pushInfinity(e.isNegative()?-1/0:1/0);if(e.isInteger())return t._pushBigint(e);if(!t._pushTag(ni.DECIMAL_FRAC)||!t._pushInt(2,Qn.ARRAY))return!1;const r=e.decimalPlaces(),n=e.multipliedBy(new Yn(10).pow(r));return!!t._pushIntNum(-r)&&(n.abs().isLessThan(li)?t._pushIntNum(n.toNumber()):t._pushBigint(n))}_pushMap(t,e){return!!t._pushInt(e.size,Qn.MAP)&&this._pushRawMap(e.size,Array.from(e))}_pushObject(t){if(!t)return this._pushUInt8(fi);for(var e=this.semanticTypes.length,r=0;r<e;r++)if(t instanceof this.semanticTypes[r][0])return this.semanticTypes[r][1].call(t,this,t);var n=t.encodeCBOR;if("function"==typeof n)return n.call(t,this);var i=Object.keys(t),o=i.length;return!!this._pushInt(o,Qn.MAP)&&this._pushRawMap(o,i.map((e=>[e,t[e]])))}_pushRawMap(t,e){e=e.map((function(t){return t[0]=gi.encode(t[0]),t})).sort(Jn.keySorter);for(var r=0;r<t;r++){if(!this.push(e[r][0]))return!1;if(!this.pushAny(e[r][1]))return!1}return!0}write(t){return this.pushAny(t)}pushAny(t){var e=function(t){return{}.toString.call(t).slice(8,-1)}(t);switch(e){case"Number":return this._pushNumber(t);case"String":return this._pushString(t);case"Boolean":return this._pushBoolean(t);case"Object":return this._pushObject(t);case"Array":return this._pushArray(this,t);case"Uint8Array":return this._pushBuffer(this,Zn.isBuffer(t)?t:Zn.from(t));case"Null":return this._pushUInt8(fi);case"Undefined":return this._pushUndefined(t);case"Map":return this._pushMap(this,t);case"Set":return this._pushSet(this,t);case"URL":return this._pushUrl(this,t);case"BigNumber":return this._pushBigNumber(this,t);case"Date":return this._pushDate(this,t);case"RegExp":return this._pushRegexp(this,t);case"Symbol":switch(t){case ri.NULL:return this._pushObject(null);case ri.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+t.toString())}default:throw new Error("Unknown type: "+typeof t+", "+(t?t.toString():""))}}finalize(){if(0===this.offset)return null;for(var t=this.result,e=this.resultLength,r=this.resultMethod,n=this.offset,i=0,o=0;o<n;o++)i+=e[o];var s=Zn.allocUnsafe(i),a=0,c=0;for(o=0;o<n;o++){switch(c=e[o],r[o]){case 0:t[o].copy(s,a);break;case 1:s.writeUInt8(t[o],a,!0);break;case 2:s.writeUInt16BE(t[o],a,!0);break;case 3:s.writeUInt32BE(t[o],a,!0);break;case 4:s.writeDoubleBE(t[o],a,!0);break;case 5:s.write(t[o],a,c,"utf8");break;default:throw new Error("unkown method")}a+=c}var u=s;return this._reset(),u}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(t){const e=new gi;if(!e.pushAny(t))throw new Error("Failed to encode input");return e.finalize()}}var bi,yi=gi;(bi=an).Diagnose=Kn,bi.Decoder=qn,bi.Encoder=yi,bi.Simple=wn,bi.Tagged=vn,bi.decodeAll=bi.Decoder.decodeAll,bi.decodeFirst=bi.Decoder.decodeFirst,bi.diagnose=bi.Diagnose.diagnose,bi.encode=bi.Encoder.encode,bi.decode=bi.Decoder.decode,bi.leveldb={decode:bi.Decoder.decodeAll,encode:bi.Encoder.encode,buffer:!0,name:"cbor"};var mi=_t(an);function wi(t){return De(Te.create().update(new Uint8Array(t)).digest())}function vi(t){if(t instanceof mi.Tagged)return vi(t.value);if("string"==typeof t)return Ei(t);if("number"==typeof t)return wi(We(t));if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return wi(t);if(Array.isArray(t)){return wi(Ue(...t.map(vi)))}if(t&&"object"==typeof t&&t._isPrincipal)return wi(t.toUint8Array());if("object"==typeof t&&null!==t&&"function"==typeof t.toHash)return vi(t.toHash());if("object"==typeof t)return xi(t);if("bigint"==typeof t)return wi(We(t));throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${t}`),{value:t})}const Ei=t=>wi((new TextEncoder).encode(t));function _i(t){return xi(t)}function xi(t){const e=Object.entries(t).filter((([,t])=>void 0!==t)).map((([t,e])=>[Ei(t),vi(e)]));return wi(Ue(...e.sort((([t],[e])=>Le(t,e))).map((t=>Ue(...t)))))}var Bi=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r};const Ii=(new TextEncoder).encode("\nic-request");class Ai{getPrincipal(){return this._principal||(this._principal=Re.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(t){const{body:e}=t,r=Bi(t,["body"]),n=_i(e);return Object.assign(Object.assign({},r),{body:{content:e,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(Ue(Ii,n))}})}}class Si{getPrincipal(){return Re.anonymous()}async transformRequest(t){return Object.assign(Object.assign({},t),{body:{content:t.body}})}}var Ti={},Ni={},Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});const Ri=9007199254740992;function Ui(t,...e){const r=new Uint8Array(t.byteLength+e.reduce(((t,e)=>t+e.byteLength),0));r.set(new Uint8Array(t),0);let n=t.byteLength;for(const t of e)r.set(new Uint8Array(t),n),n+=t.byteLength;return r.buffer}function Pi(t,e,r){const n=2**(e-24);r=(r=r.replace(/[^0-9a-fA-F]/g,"")).slice(2*-n).padStart(2*n,"0");const i=[(t<<5)+e].concat(r.match(/../g).map((t=>parseInt(t,16))));return new Uint8Array(i).buffer}function ki(t,e){if(e<24)return new Uint8Array([(t<<5)+e]).buffer;return Pi(t,e<=255?24:e<=65535?25:e<=4294967295?26:27,e.toString(16))}function Fi(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|63&n):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=(1023&n)<<10|1023&t.charCodeAt(r),e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return Ui(new Uint8Array(ki(3,t.length)),new Uint8Array(e))}function Li(t){return new Uint8Array(t).buffer}function Ci(t){if(isNaN(t))throw new RangeError("Invalid number.");t=Math.min(Math.max(0,t),23);return new Uint8Array([0+t]).buffer}function Di(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Pi(0,24,t=(t=Math.min(Math.max(0,t),255)).toString(16))}function ji(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Pi(0,25,t=(t=Math.min(Math.max(0,t),65535)).toString(16))}function $i(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Pi(0,26,t=(t=Math.min(Math.max(0,t),4294967295)).toString(16))}function qi(t,e){if("string"==typeof t&&16==e){if(t.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return Pi(0,27,t)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Pi(0,27,t=(t=Math.min(Math.max(0,t),Ri)).toString(16))}function Mi(t){if(isNaN(t))throw new RangeError("Invalid number.");if(0===t)return Ci(0);t=Math.min(Math.max(0,-t),24)-1;return new Uint8Array([32+t]).buffer}function Vi(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Pi(1,24,t=(t=Math.min(Math.max(0,-t-1),255)).toString(16))}function zi(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Pi(1,25,t=(t=Math.min(Math.max(0,-t-1),65535)).toString(16))}function Gi(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Pi(1,26,t=(t=Math.min(Math.max(0,-t-1),4294967295)).toString(16))}function Ki(t,e){if("string"==typeof t&&16==e){if((t=t.startsWith("-")?t.slice(1):"0").match(/[^0-9a-fA-F]/)||t.length>16)throw new RangeError("Invalid number.");let e=!1,r=t.split("").reduceRight(((t,r)=>{if(e)return r+t;let n=parseInt(r,16)-1;return n>=0?(e=!0,n.toString(16)+t):"f"+t}),"");return e?Pi(1,27,r):qi(0)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Pi(1,27,t=(t=Math.min(Math.max(0,-t-1),9007199254740992)).toString(16))}function Hi(){return Li(new Uint8Array([245]))}function Zi(){return Li(new Uint8Array([244]))}Oi.tagged=function(t,e){if(14277111==t)return Ui(new Uint8Array([217,217,247]),e);if(t<24)return Ui(new Uint8Array([192+t]),e);{const e=t<=255?24:t<=65535?25:t<=4294967295?26:27,r=2**(e-24),n=t.toString(16).slice(2*-r).padStart(2*r,"0"),i=[192+e].concat(n.match(/../g).map((t=>parseInt(t,16))));return new Uint8Array(i).buffer}},Oi.raw=Li,Oi.uSmall=Ci,Oi.u8=Di,Oi.u16=ji,Oi.u32=$i,Oi.u64=qi,Oi.iSmall=Mi,Oi.i8=Vi,Oi.i16=zi,Oi.i32=Gi,Oi.i64=Ki,Oi.number=function(t){return t>=0?t<24?Ci(t):t<=255?Di(t):t<=65535?ji(t):t<=4294967295?$i(t):qi(t):t>=-24?Mi(t):t>=-255?Vi(t):t>=-65535?zi(t):t>=-4294967295?Gi(t):Ki(t)},Oi.bytes=function(t){return Ui(ki(2,t.byteLength),t)},Oi.string=function(t){return Fi(t)},Oi.array=function(t){return Ui(ki(4,t.length),...t)},Oi.map=function(t,e=!1){t instanceof Map||(t=new Map(Object.entries(t)));let r=Array.from(t.entries());return e&&(r=r.sort((([t],[e])=>t.localeCompare(e)))),Ui(ki(5,t.size),...r.map((([t,e])=>Ui(Fi(t),e))))},Oi.singleFloat=function(t){const e=new Float32Array([t]);return Ui(new Uint8Array([250]),new Uint8Array(e.buffer))},Oi.doubleFloat=function(t){const e=new Float64Array([t]);return Ui(new Uint8Array([251]),new Uint8Array(e.buffer))},Oi.bool=function(t){return t?Hi():Zi()},Oi.true_=Hi,Oi.false_=Zi,Oi.null_=function(){return Li(new Uint8Array([246]))},Oi.undefined_=function(){return Li(new Uint8Array([247]))};var Wi=Et&&Et.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(Ni,"__esModule",{value:!0});const Yi=Wi(Oi),Ji=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class Xi{constructor(t,e=!1){this._serializer=t,this._stable=e,this.name="jsonDefault",this.priority=-100}match(t){return-1!=["undefined","boolean","number","string","object"].indexOf(typeof t)}encode(t){switch(typeof t){case"undefined":return Yi.undefined_();case"boolean":return Yi.bool(t);case"number":return Math.floor(t)===t?Yi.number(t):Yi.doubleFloat(t);case"string":return Yi.string(t);case"object":if(null===t)return Yi.null_();if(Array.isArray(t))return Yi.array(t.map((t=>this._serializer.serializeValue(t))));if(Ji.find((e=>t instanceof e)))return Yi.bytes(t.buffer);if(-1!==Object.getOwnPropertyNames(t).indexOf("toJSON"))return this.encode(t.toJSON());if(t instanceof Map){const e=new Map;for(const[r,n]of t.entries())e.set(r,this._serializer.serializeValue(n));return Yi.map(e,this._stable)}{const e=new Map;for(const[r,n]of Object.entries(t))e.set(r,this._serializer.serializeValue(n));return Yi.map(e,this._stable)}default:throw new Error("Invalid value.")}}}Ni.JsonDefaultCborEncoder=Xi;class Qi{constructor(){this.name="cborEncoder",this.priority=-90}match(t){return"object"==typeof t&&"function"==typeof t.toCBOR}encode(t){return t.toCBOR()}}Ni.ToCborEncoder=Qi;class to{constructor(){this._encoders=new Set}static withDefaultEncoders(t=!1){const e=new this;return e.addEncoder(new Xi(e,t)),e.addEncoder(new Qi),e}removeEncoder(t){for(const e of this._encoders.values())e.name==t&&this._encoders.delete(e)}addEncoder(t){this._encoders.add(t)}getEncoderFor(t){let e=null;for(const r of this._encoders)(!e||r.priority>e.priority)&&r.match(t)&&(e=r);if(null===e)throw new Error("Could not find an encoder for value.");return e}serializeValue(t){return this.getEncoderFor(t).encode(t)}serialize(t){return this.serializeValue(t)}}Ni.CborSerializer=to;Ni.SelfDescribeCborSerializer=class extends to{serialize(t){return Yi.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(t))]))}},function(t){var e=Et&&Et.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(Ni);const r=e(Oi);t.value=r}(Ti);const eo=Ti.SelfDescribeCborSerializer.withDefaultEncoders(!0);var ro;function no(t){return eo.serialize(t)}function io(t){const e=t.byteLength;let r=BigInt(0);for(let n=0;n<e;n++)r=r*BigInt(256)+BigInt(t[n]);return r}eo.addEncoder(new class{get name(){return"Principal"}get priority(){return 0}match(t){return t&&!0===t._isPrincipal}encode(t){return Ti.value.bytes(t.toUint8Array())}}),eo.addEncoder(new class{get name(){return"Buffer"}get priority(){return 1}match(t){return t instanceof ArrayBuffer||ArrayBuffer.isView(t)}encode(t){return Ti.value.bytes(new Uint8Array(t))}}),eo.addEncoder(new class{get name(){return"BigInt"}get priority(){return 1}match(t){return"bigint"==typeof t}encode(t){return t>BigInt(0)?Ti.value.tagged(2,Ti.value.bytes(Fe(t.toString(16)))):Ti.value.tagged(3,Ti.value.bytes(Fe((BigInt("-1")*t).toString(16))))}}),function(t){t[t.Uint64LittleEndian=71]="Uint64LittleEndian",t[t.Semantic=55799]="Semantic"}(ro||(ro={}));class oo extends mi.Decoder{createByteString(t){return Ue(...t)}createByteStringFromHeap(t,e){return t===e?new ArrayBuffer(0):new Uint8Array(this._heap.slice(t,e))}}function so(t){const e=new Uint8Array(t),r=new oo({size:e.byteLength,tags:{2:t=>io(t),3:t=>-io(t),[ro.Semantic]:t=>t}});try{return r.decodeFirst(e)}catch(t){throw new Error(`Failed to decode CBOR: ${t}, input: ${Pe(e)}`)}}const ao=()=>{if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){const t=new Uint32Array(1);return window.crypto.getRandomValues(t),t[0]}if("undefined"!=typeof crypto&&crypto.getRandomValues){const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]}return"undefined"!=typeof crypto&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(4294967295*Math.random())};var co;function uo(){const t=new ArrayBuffer(16),e=new DataView(t),r=ao(),n=ao(),i=ao(),o=ao();return e.setUint32(0,r),e.setUint32(4,n),e.setUint32(8,i),e.setUint32(12,o),t}!function(t){t.Call="call"}(co||(co={}));const fo=BigInt(1e6);class lo{constructor(t){if(t<9e4){const e=BigInt(Date.now()+t)*fo/BigInt(1e9);return void(this._value=e*BigInt(1e9))}const e=BigInt(Math.floor(Date.now()+t-6e4))*fo/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=e}toCBOR(){return Ti.value.u64(this._value.toString(16),16)}toHash(){return We(this._value)}}function ho(t=uo){return async e=>{const r=e.request.headers;e.request.headers=r,"call"===e.endpoint&&(e.body.nonce=t())}}function po(t){const e=[];return t.forEach(((t,r)=>{e.push([r,t])})),e}class go extends $e{constructor(t,e){super(t),this.response=e,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class bo extends $e{constructor(t,e,r,n,i,o){super(t),this.response=e,this.requestId=r,this.senderPubkey=n,this.senderSig=i,this.ingressExpiry=o,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class yo extends $e{constructor(t,e,r,n,i,o){super(t),this.response=e,this.requestId=r,this.senderPubkey=n,this.senderSig=i,this.ingressExpiry=o,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class mo extends $e{constructor(t,e,r,n,i,o){super(t),this.response=e,this.requestId=r,this.senderPubkey=n,this.senderSig=i,this.ingressExpiry=o,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const wo=BigInt(0),vo=BigInt(1);function Eo(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function _o(t){if(!Eo(t))throw new Error("Uint8Array expected")}function xo(t,e){if("boolean"!=typeof e)throw new Error(t+" boolean expected, got "+e)}function Bo(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return""===t?wo:BigInt("0x"+t)}const Io="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,Ao=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function So(t){if(_o(t),Io)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=Ao[t[r]];return e}const To={_0:48,_9:57,A:65,F:70,a:97,f:102};function No(t){return t>=To._0&&t<=To._9?t-To._0:t>=To.A&&t<=To.F?t-(To.A-10):t>=To.a&&t<=To.f?t-(To.a-10):void 0}function Oo(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);if(Io)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){const r=No(t.charCodeAt(i)),o=No(t.charCodeAt(i+1));if(void 0===r||void 0===o){const e=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+i)}n[e]=16*r+o}return n}function Ro(t){return Bo(So(t))}function Uo(t){return _o(t),Bo(So(Uint8Array.from(t).reverse()))}function Po(t,e){return Oo(t.toString(16).padStart(2*e,"0"))}function ko(t,e){return Po(t,e).reverse()}function Fo(t,e,r){let n;if("string"==typeof e)try{n=Oo(e)}catch(e){throw new Error(t+" must be hex string or Uint8Array, cause: "+e)}else{if(!Eo(e))throw new Error(t+" must be hex string or Uint8Array");n=Uint8Array.from(e)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function Lo(...t){let e=0;for(let r=0;r<t.length;r++){const n=t[r];_o(n),e+=n.length}const r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}function Co(t){if("string"!=typeof t)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}const Do=t=>"bigint"==typeof t&&wo<=t;function jo(t,e,r){return Do(t)&&Do(e)&&Do(r)&&e<=t&&t<r}function $o(t,e,r,n){if(!jo(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function qo(t){let e;for(e=0;t>wo;t>>=vo,e+=1);return e}function Mo(t,e){return t>>BigInt(e)&vo}const Vo=t=>(vo<<BigInt(t))-vo,zo={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||Eo(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function Go(t,e,r={}){const n=(e,r,n)=>{const i=zo[r];if("function"!=typeof i)throw new Error("invalid validator function");const o=t[e];if(!(n&&void 0===o||i(o,t)))throw new Error("param "+String(e)+" is invalid. Expected "+r+", got "+o)};for(const[t,r]of Object.entries(e))n(t,r,!1);for(const[t,e]of Object.entries(r))n(t,e,!0);return t}const Ko=()=>{throw new Error("not implemented")};function Ho(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(void 0!==i)return i;const o=t(r,...n);return e.set(r,o),o}}const Zo=BigInt(0),Wo=BigInt(1),Yo=BigInt(2),Jo=BigInt(3),Xo=BigInt(4),Qo=BigInt(5),ts=BigInt(8);function es(t,e){const r=t%e;return r>=Zo?r:e+r}function rs(t,e,r){let n=t;for(;e-- >Zo;)n*=n,n%=r;return n}function ns(t,e){if(t===Zo)throw new Error("invert: expected non-zero number");if(e<=Zo)throw new Error("invert: expected positive modulus, got "+e);let r=es(t,e),n=e,i=Zo,o=Wo;for(;r!==Zo;){const t=n%r,e=i-o*(n/r);n=r,r=t,i=o,o=e}if(n!==Wo)throw new Error("invert: does not exist");return es(i,e)}function is(t,e){const r=(t.ORDER+Wo)/Xo,n=t.pow(e,r);if(!t.eql(t.sqr(n),e))throw new Error("Cannot find square root");return n}function os(t,e){const r=(t.ORDER-Qo)/ts,n=t.mul(e,Yo),i=t.pow(n,r),o=t.mul(e,i),s=t.mul(t.mul(o,Yo),i),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function ss(t){return t%Xo===Jo?is:t%ts===Qo?os:function(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-Wo,r=0;for(;e%Yo===Zo;)e/=Yo,r++;let n=Yo;const i=hs(t);for(;1===ls(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return is;let o=i.pow(n,e);const s=(e+Wo)/Yo;return function(t,n){if(t.is0(n))return n;if(1!==ls(t,n))throw new Error("Cannot find square root");let i=r,a=t.mul(t.ONE,o),c=t.pow(n,e),u=t.pow(n,s);for(;!t.eql(c,t.ONE);){if(t.is0(c))return t.ZERO;let e=1,r=t.sqr(c);for(;!t.eql(r,t.ONE);)if(e++,r=t.sqr(r),e===i)throw new Error("Cannot find square root");const n=Wo<<BigInt(i-e-1),o=t.pow(a,n);i=e,a=t.sqr(o),c=t.mul(c,a),u=t.mul(u,o)}return u}}(t)}const as=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function cs(t){const e=as.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return Go(t,e)}function us(t,e,r){if(r<Zo)throw new Error("invalid exponent, negatives unsupported");if(r===Zo)return t.ONE;if(r===Wo)return e;let n=t.ONE,i=e;for(;r>Zo;)r&Wo&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Wo;return n}function fs(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),i=e.reduce(((e,r,i)=>t.is0(r)?e:(n[i]=e,t.mul(e,r))),t.ONE),o=t.inv(i);return e.reduceRight(((e,r,i)=>t.is0(r)?e:(n[i]=t.mul(e,n[i]),t.mul(e,r))),o),n}function ls(t,e){const r=(t.ORDER-Wo)/Yo,n=t.pow(e,r),i=t.eql(n,t.ONE),o=t.eql(n,t.ZERO),s=t.eql(n,t.neg(t.ONE));if(!i&&!o&&!s)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function ds(t,e){void 0!==e&&function(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}(e);const r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function hs(t,e,r=!1,n={}){if(t<=Zo)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:o}=ds(t,e);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let s;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:o,MASK:Vo(i),ZERO:Zo,ONE:Wo,create:e=>es(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("invalid field element: expected bigint, got "+typeof e);return Zo<=e&&e<t},is0:t=>t===Zo,isOdd:t=>(t&Wo)===Wo,neg:e=>es(-e,t),eql:(t,e)=>t===e,sqr:e=>es(e*e,t),add:(e,r)=>es(e+r,t),sub:(e,r)=>es(e-r,t),mul:(e,r)=>es(e*r,t),pow:(t,e)=>us(a,t,e),div:(e,r)=>es(e*ns(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>ns(e,t),sqrt:n.sqrt||(e=>(s||(s=ss(t)),s(a,e))),toBytes:t=>r?ko(t,o):Po(t,o),fromBytes:t=>{if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);return r?Uo(t):Ro(t)},invertBatch:t=>fs(a,t),cmov:(t,e,r)=>r?e:t});return Object.freeze(a)}function ps(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function gs(t){const e=ps(t);return e+Math.ceil(e/2)}const bs=Ro;function ys(t,e){if(ws(t),ws(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=255&t,t>>>=8;return new Uint8Array(r)}function ms(t,e){const r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}function ws(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function vs(t,e,r){Go(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:n,k:i,m:o,hash:s,expand:a,DST:c}=r;_o(t),ws(e);const u="string"==typeof c?Co(c):c,f=n.toString(2).length,l=Math.ceil((f+i)/8),d=e*o*l;let h;if("xmd"===a)h=function(t,e,r,n){_o(t),_o(e),ws(r),e.length>255&&(e=n(Lo(Co("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:o}=n,s=Math.ceil(r/i);if(r>65535||s>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=Lo(e,ys(e.length,1)),c=ys(0,o),u=ys(r,2),f=new Array(s),l=n(Lo(c,t,u,ys(0,1),a));f[0]=n(Lo(l,ys(1,1),a));for(let t=1;t<=s;t++){const e=[ms(l,f[t-1]),ys(t+1,1),a];f[t]=n(Lo(...e))}return Lo(...f).slice(0,r)}(t,u,d,s);else if("xof"===a)h=function(t,e,r,n,i){if(_o(t),_o(e),ws(r),e.length>255){const t=Math.ceil(2*n/8);e=i.create({dkLen:t}).update(Co("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(ys(r,2)).update(e).update(ys(e.length,1)).digest()}(t,u,d,i,s);else{if("_internal_pass"!==a)throw new Error('expand must be "xmd" or "xof"');h=t}const p=new Array(e);for(let t=0;t<e;t++){const e=new Array(o);for(let r=0;r<o;r++){const i=l*(r+t*o),s=h.subarray(i,i+l);e[r]=es(bs(s),n)}p[t]=e}return p}function Es(t,e){const r=e.map((t=>Array.from(t).reverse()));return(e,n)=>{const[i,o,s,a]=r.map((r=>r.reduce(((r,n)=>t.add(t.mul(r,e),n))))),[c,u]=fs(t,[o,a],!0);return e=t.mul(i,c),n=t.mul(n,t.mul(s,u)),{x:e,y:n}}}function _s(t,e,r){if("function"!=typeof e)throw new Error("mapToCurve() must be defined");function n(r){return t.fromAffine(e(r))}function i(e){const r=e.clearCofactor();return r.equals(t.ZERO)?t.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(t,e){const o=vs(t,2,{...r,DST:r.DST,...e}),s=n(o[0]),a=n(o[1]);return i(s.add(a))},encodeToCurve:(t,e)=>i(n(vs(t,1,{...r,DST:r.encodeDST,...e})[0])),mapToCurve(t){if(!Array.isArray(t))throw new Error("expected array of bigints");for(const e of t)if("bigint"!=typeof e)throw new Error("expected array of bigints");return i(n(t))}}}const xs=BigInt(0),Bs=BigInt(1);function Is(t,e){const r=e.negate();return t?r:e}function As(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Ss(t,e){As(t,e);const r=2**t;return{windows:Math.ceil(e/t)+1,windowSize:2**(t-1),mask:Vo(t),maxNumber:r,shiftBy:BigInt(t)}}function Ts(t,e,r){const{windowSize:n,mask:i,maxNumber:o,shiftBy:s}=r;let a=Number(t&i),c=t>>s;a>n&&(a-=o,c+=Bs);const u=e*n;return{nextN:c,offset:u+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:e%2!=0,offsetF:u}}const Ns=new WeakMap,Os=new WeakMap;function Rs(t){return Os.get(t)||1}function Us(t,e){return{constTimeNegate:Is,hasPrecomputes:t=>1!==Rs(t),unsafeLadder(e,r,n=t.ZERO){let i=e;for(;r>xs;)r&Bs&&(n=n.add(i)),i=i.double(),r>>=Bs;return n},precomputeWindow(t,r){const{windows:n,windowSize:i}=Ss(r,e),o=[];let s=t,a=s;for(let t=0;t<n;t++){a=s,o.push(a);for(let t=1;t<i;t++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(r,n,i){let o=t.ZERO,s=t.BASE;const a=Ss(r,e);for(let t=0;t<a.windows;t++){const{nextN:e,offset:r,isZero:c,isNeg:u,isNegF:f,offsetF:l}=Ts(i,t,a);i=e,c?s=s.add(Is(f,n[l])):o=o.add(Is(u,n[r]))}return{p:o,f:s}},wNAFUnsafe(r,n,i,o=t.ZERO){const s=Ss(r,e);for(let t=0;t<s.windows&&i!==xs;t++){const{nextN:e,offset:r,isZero:a,isNeg:c}=Ts(i,t,s);if(i=e,!a){const t=n[r];o=o.add(c?t.negate():t)}}return o},getPrecomputes(t,e,r){let n=Ns.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&Ns.set(e,r(n))),n},wNAFCached(t,e,r){const n=Rs(t);return this.wNAF(n,this.getPrecomputes(n,t,r),e)},wNAFCachedUnsafe(t,e,r,n){const i=Rs(t);return 1===i?this.unsafeLadder(t,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),e,n)},setWindowSize(t,r){As(r,e),Os.set(t,r),Ns.delete(t)}}}function Ps(t,e,r,n){!function(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach(((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)}))}(r,t),function(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach(((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)}))}(n,e);const i=r.length,o=n.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,a=qo(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=Vo(c),f=new Array(Number(u)+1).fill(s);let l=s;for(let t=Math.floor((e.BITS-1)/c)*c;t>=0;t-=c){f.fill(s);for(let e=0;e<o;e++){const i=n[e],o=Number(i>>BigInt(t)&u);f[o]=f[o].add(r[e])}let e=s;for(let t=f.length-1,r=s;t>0;t--)r=r.add(f[t]),e=e.add(r);if(l=l.add(e),0!==t)for(let t=0;t<c;t++)l=l.double()}return l}function ks(t){return cs(t.Fp),Go(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ds(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const Fs=BigInt(0),Ls=BigInt(1),Cs=BigInt(2),Ds=BigInt(3),js=BigInt(4);function $s(t){const e=function(t){const e=ks(t);Go(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}(t),{Fp:r}=e,n=hs(e.n,e.nBitLength),i=e.toBytes||((t,e,n)=>{const i=e.toAffine();return Lo(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),o=e.fromBytes||(t=>{const e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function s(t){const{a:n,b:i}=e,o=r.sqr(t),s=r.mul(o,t);return r.add(r.add(s,r.mul(t,n)),i)}function a(t,e){const n=r.sqr(e),i=s(t);return r.eql(n,i)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=r.mul(r.pow(e.a,Ds),js),u=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(c,u)))throw new Error("bad curve params: a or b");function f(t){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:i,n:o}=e;if(r&&"bigint"!=typeof t){if(Eo(t)&&(t=So(t)),"string"!=typeof t||!r.includes(t.length))throw new Error("invalid private key");t=t.padStart(2*n,"0")}let s;try{s="bigint"==typeof t?t:Ro(Fo("private key",t,n))}catch(e){throw new Error("invalid private key, expected hex or "+n+" bytes, got "+typeof t)}return i&&(s=es(s,o)),$o("private key",s,Ls,o),s}function l(t){if(!(t instanceof p))throw new Error("ProjectivePoint expected")}const d=Ho(((t,e)=>{const{px:n,py:i,pz:o}=t;if(r.eql(o,r.ONE))return{x:n,y:i};const s=t.is0();null==e&&(e=s?r.ONE:r.inv(o));const a=r.mul(n,e),c=r.mul(i,e),u=r.mul(o,e);if(s)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw new Error("invZ was invalid");return{x:a,y:c}})),h=Ho((t=>{if(t.is0()){if(e.allowInfinityPoint&&!r.is0(t.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=t.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not FE");if(!a(n,i))throw new Error("bad point: equation left != right");if(!t.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));class p{constructor(t,e,n){if(null==t||!r.isValid(t))throw new Error("x required");if(null==e||!r.isValid(e)||r.is0(e))throw new Error("y required");if(null==n||!r.isValid(n))throw new Error("z required");this.px=t,this.py=e,this.pz=n,Object.freeze(this)}static fromAffine(t){const{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw new Error("invalid affine point");if(t instanceof p)throw new Error("projective point not allowed");const i=t=>r.eql(t,r.ZERO);return i(e)&&i(n)?p.ZERO:new p(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=fs(r,t.map((t=>t.pz)));return t.map(((t,r)=>t.toAffine(e[r]))).map(p.fromAffine)}static fromHex(t){const e=p.fromAffine(o(Fo("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return p.BASE.multiply(f(t))}static msm(t,e){return Ps(p,n,t,e)}_setWindowSize(t){y.setWindowSize(this,t)}assertValidity(){h(this)}hasEvenY(){const{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){l(t);const{px:e,py:n,pz:i}=this,{px:o,py:s,pz:a}=t,c=r.eql(r.mul(e,a),r.mul(o,i)),u=r.eql(r.mul(n,a),r.mul(s,i));return c&&u}negate(){return new p(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:n}=e,i=r.mul(n,Ds),{px:o,py:s,pz:a}=this;let c=r.ZERO,u=r.ZERO,f=r.ZERO,l=r.mul(o,o),d=r.mul(s,s),h=r.mul(a,a),g=r.mul(o,s);return g=r.add(g,g),f=r.mul(o,a),f=r.add(f,f),c=r.mul(t,f),u=r.mul(i,h),u=r.add(c,u),c=r.sub(d,u),u=r.add(d,u),u=r.mul(c,u),c=r.mul(g,c),f=r.mul(i,f),h=r.mul(t,h),g=r.sub(l,h),g=r.mul(t,g),g=r.add(g,f),f=r.add(l,l),l=r.add(f,l),l=r.add(l,h),l=r.mul(l,g),u=r.add(u,l),h=r.mul(s,a),h=r.add(h,h),l=r.mul(h,g),c=r.sub(c,l),f=r.mul(h,d),f=r.add(f,f),f=r.add(f,f),new p(c,u,f)}add(t){l(t);const{px:n,py:i,pz:o}=this,{px:s,py:a,pz:c}=t;let u=r.ZERO,f=r.ZERO,d=r.ZERO;const h=e.a,g=r.mul(e.b,Ds);let b=r.mul(n,s),y=r.mul(i,a),m=r.mul(o,c),w=r.add(n,i),v=r.add(s,a);w=r.mul(w,v),v=r.add(b,y),w=r.sub(w,v),v=r.add(n,o);let E=r.add(s,c);return v=r.mul(v,E),E=r.add(b,m),v=r.sub(v,E),E=r.add(i,o),u=r.add(a,c),E=r.mul(E,u),u=r.add(y,m),E=r.sub(E,u),d=r.mul(h,v),u=r.mul(g,m),d=r.add(u,d),u=r.sub(y,d),d=r.add(y,d),f=r.mul(u,d),y=r.add(b,b),y=r.add(y,b),m=r.mul(h,m),v=r.mul(g,v),y=r.add(y,m),m=r.sub(b,m),m=r.mul(h,m),v=r.add(v,m),b=r.mul(y,v),f=r.add(f,b),b=r.mul(E,v),u=r.mul(w,u),u=r.sub(u,b),b=r.mul(w,y),d=r.mul(E,d),d=r.add(d,b),new p(u,f,d)}subtract(t){return this.add(t.negate())}is0(){return this.equals(p.ZERO)}wNAF(t){return y.wNAFCached(this,t,p.normalizeZ)}multiplyUnsafe(t){const{endo:n,n:i}=e;$o("scalar",t,Fs,i);const o=p.ZERO;if(t===Fs)return o;if(this.is0()||t===Ls)return this;if(!n||y.hasPrecomputes(this))return y.wNAFCachedUnsafe(this,t,p.normalizeZ);let{k1neg:s,k1:a,k2neg:c,k2:u}=n.splitScalar(t),f=o,l=o,d=this;for(;a>Fs||u>Fs;)a&Ls&&(f=f.add(d)),u&Ls&&(l=l.add(d)),d=d.double(),a>>=Ls,u>>=Ls;return s&&(f=f.negate()),c&&(l=l.negate()),l=new p(r.mul(l.px,n.beta),l.py,l.pz),f.add(l)}multiply(t){const{endo:n,n:i}=e;let o,s;if($o("scalar",t,Ls,i),n){const{k1neg:e,k1:i,k2neg:a,k2:c}=n.splitScalar(t);let{p:u,f:f}=this.wNAF(i),{p:l,f:d}=this.wNAF(c);u=y.constTimeNegate(e,u),l=y.constTimeNegate(a,l),l=new p(r.mul(l.px,n.beta),l.py,l.pz),o=u.add(l),s=f.add(d)}else{const{p:e,f:r}=this.wNAF(t);o=e,s=r}return p.normalizeZ([o,s])[0]}multiplyAndAddUnsafe(t,e,r){const n=p.BASE,i=(t,e)=>e!==Fs&&e!==Ls&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),o=i(this,e).add(i(t,r));return o.is0()?void 0:o}toAffine(t){return d(this,t)}isTorsionFree(){const{h:t,isTorsionFree:r}=e;if(t===Ls)return!0;if(r)return r(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:r}=e;return t===Ls?this:r?r(p,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return xo("isCompressed",t),this.assertValidity(),i(p,this,t)}toHex(t=!0){return xo("isCompressed",t),So(this.toRawBytes(t))}}p.BASE=new p(e.Gx,e.Gy,r.ONE),p.ZERO=new p(r.ZERO,r.ONE,r.ZERO);const{endo:g,nBitLength:b}=e,y=Us(p,g?Math.ceil(b/2):b);return{CURVE:e,ProjectivePoint:p,normPrivateKeyToScalar:f,weierstrassEquation:s,isWithinCurveOrder:function(t){return jo(t,Ls,e.n)}}}function qs(t,e){if(cs(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const r=function(t,e){const r=t.ORDER;let n=Fs;for(let t=r-Ls;t%Cs===Fs;t/=Cs)n+=Ls;const i=n,o=Cs<<i-Ls-Ls,s=o*Cs,a=(r-Ls)/s,c=(a-Ls)/Cs,u=s-Ls,f=o,l=t.pow(e,a),d=t.pow(e,(a+Ls)/Cs);let h=(e,r)=>{let n=l,o=t.pow(r,u),s=t.sqr(o);s=t.mul(s,r);let a=t.mul(e,s);a=t.pow(a,c),a=t.mul(a,o),o=t.mul(a,r),s=t.mul(a,e);let h=t.mul(s,o);a=t.pow(h,f);let p=t.eql(a,t.ONE);o=t.mul(s,d),a=t.mul(h,n),s=t.cmov(o,s,p),h=t.cmov(a,h,p);for(let e=i;e>Ls;e--){let r=e-Cs;r=Cs<<r-Ls;let i=t.pow(h,r);const a=t.eql(i,t.ONE);o=t.mul(s,n),n=t.mul(n,n),i=t.mul(h,n),s=t.cmov(o,s,a),h=t.cmov(i,h,a)}return{isValid:p,value:s}};if(t.ORDER%js===Ds){const r=(t.ORDER-Ds)/js,n=t.sqrt(t.neg(e));h=(e,i)=>{let o=t.sqr(i);const s=t.mul(e,i);o=t.mul(o,s);let a=t.pow(o,r);a=t.mul(a,s);const c=t.mul(a,n),u=t.mul(t.sqr(a),i),f=t.eql(u,e);return{isValid:f,value:t.cmov(c,a,f)}}}return h}(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,o,s,a,c,u,f,l;i=t.sqr(n),i=t.mul(i,e.Z),o=t.sqr(i),o=t.add(o,i),s=t.add(o,t.ONE),s=t.mul(s,e.B),a=t.cmov(e.Z,t.neg(o),!t.eql(o,t.ZERO)),a=t.mul(a,e.A),o=t.sqr(s),u=t.sqr(a),c=t.mul(u,e.A),o=t.add(o,c),o=t.mul(o,s),u=t.mul(u,a),c=t.mul(u,e.B),o=t.add(o,c),f=t.mul(i,s);const{isValid:d,value:h}=r(o,u);l=t.mul(i,n),l=t.mul(l,h),f=t.cmov(f,s,d),l=t.cmov(l,h,d);const p=t.isOdd(n)===t.isOdd(l);l=t.cmov(t.neg(l),l,p);const g=fs(t,[a],!0)[0];return f=t.mul(f,g),{x:f,y:l}}}const Ms=BigInt(0),Vs=BigInt(1),zs=BigInt(2),Gs=BigInt(3);const Ks=BigInt(0),Hs=BigInt(1),Zs=BigInt(2),Ws=BigInt(3);function Ys(t,e,r,n,i=1,o){const s=BigInt(void 0===o?n:o),a=r**BigInt(n),c=[];for(let o=0;o<i;o++){const i=BigInt(o+1),u=[];for(let o=0,c=Hs;o<n;o++){const n=(i*c-i)/s%a;u.push(t.pow(e,n)),c*=r}c.push(u)}return c}const Js=BigInt(0),Xs=BigInt(1),Qs=BigInt(2),ta=BigInt(3),ea=BigInt(4),ra=BigInt("0xd201000000010000"),na=qo(ra),{Fp:ia,Fp2:oa,Fp6:sa,Fp4Square:aa,Fp12:ca}=function(t){const{ORDER:e}=t,r=hs(e),n=r.create(t.NONRESIDUE||BigInt(-1)),i=r.div(r.ONE,Zs),o=Ys(r,n,r.ORDER,2)[0],s=({c0:t,c1:e},{c0:n,c1:i})=>({c0:r.add(t,n),c1:r.add(e,i)}),a=({c0:t,c1:e},{c0:n,c1:i})=>({c0:r.sub(t,n),c1:r.sub(e,i)}),c=({c0:t,c1:e},n)=>{if("bigint"==typeof n)return{c0:r.mul(t,n),c1:r.mul(e,n)};const{c0:i,c1:o}=n;let s=r.mul(t,i),a=r.mul(e,o);return{c0:r.sub(s,a),c1:r.sub(r.mul(r.add(t,e),r.add(i,o)),r.add(s,a))}},u=({c0:t,c1:e})=>{const n=r.add(t,e),i=r.sub(t,e),o=r.add(t,t);return{c0:r.mul(n,i),c1:r.mul(o,e)}},f=t=>{if(2!==t.length)throw new Error("invalid tuple");const e=t.map((t=>r.create(t)));return{c0:e[0],c1:e[1]}},l=e*e,d=f(t.FP2_NONRESIDUE),h={ORDER:l,isLE:r.isLE,NONRESIDUE:d,BITS:qo(l),BYTES:Math.ceil(qo(l)/8),MASK:Vo(qo(l)),ZERO:{c0:r.ZERO,c1:r.ZERO},ONE:{c0:r.ONE,c1:r.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>"bigint"==typeof t&&"bigint"==typeof e,is0:({c0:t,c1:e})=>r.is0(t)&&r.is0(e),eql:({c0:t,c1:e},{c0:n,c1:i})=>r.eql(t,n)&&r.eql(e,i),neg:({c0:t,c1:e})=>({c0:r.neg(t),c1:r.neg(e)}),pow:(t,e)=>us(h,t,e),invertBatch:t=>fs(h,t),add:s,sub:a,mul:c,sqr:u,addN:s,subN:a,mulN:c,sqrN:u,div:(t,e)=>h.mul(t,"bigint"==typeof e?r.inv(r.create(e)):h.inv(e)),inv:({c0:t,c1:e})=>{const n=r.inv(r.create(t*t+e*e));return{c0:r.mul(n,r.create(t)),c1:r.mul(n,r.create(-e))}},sqrt:e=>{if(t.Fp2sqrt)return t.Fp2sqrt(e);const{c0:o,c1:s}=e;if(r.is0(s))return 1===ls(r,o)?h.create({c0:r.sqrt(o),c1:r.ZERO}):h.create({c0:r.ZERO,c1:r.sqrt(r.div(o,n))});const a=r.sqrt(r.sub(r.sqr(o),r.mul(r.sqr(s),n)));let c=r.mul(r.add(a,o),i);-1===ls(r,c)&&(c=r.sub(c,a));const u=r.sqrt(c),f=h.create({c0:u,c1:r.div(r.mul(s,i),u)});if(!h.eql(h.sqr(f),e))throw new Error("Cannot find square root");const l=f,d=h.neg(l),{re:p,im:g}=h.reim(l),{re:b,im:y}=h.reim(d);return g>y||g===y&&p>b?l:d},isOdd:t=>{const{re:e,im:r}=h.reim(t);return BigInt(e%Zs||e===Ks&&r%Zs)==Hs},fromBytes(t){if(t.length!==h.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:r.fromBytes(t.subarray(0,r.BYTES)),c1:r.fromBytes(t.subarray(r.BYTES))}},toBytes:({c0:t,c1:e})=>Lo(r.toBytes(t),r.toBytes(e)),cmov:({c0:t,c1:e},{c0:n,c1:i},o)=>({c0:r.cmov(t,n,o),c1:r.cmov(e,i,o)}),reim:({c0:t,c1:e})=>({re:t,im:e}),mulByNonresidue:({c0:t,c1:e})=>h.mul({c0:t,c1:e},d),mulByB:t.Fp2mulByB,fromBigTuple:f,frobeniusMap:({c0:t,c1:e},n)=>({c0:t,c1:r.mul(e,o[n%2])})},p=({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o})=>({c0:h.add(t,n),c1:h.add(e,i),c2:h.add(r,o)}),g=({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o})=>({c0:h.sub(t,n),c1:h.sub(e,i),c2:h.sub(r,o)}),b=({c0:t,c1:e,c2:r},n)=>{if("bigint"==typeof n)return{c0:h.mul(t,n),c1:h.mul(e,n),c2:h.mul(r,n)};const{c0:i,c1:o,c2:s}=n,a=h.mul(t,i),c=h.mul(e,o),u=h.mul(r,s);return{c0:h.add(a,h.mulByNonresidue(h.sub(h.mul(h.add(e,r),h.add(o,s)),h.add(c,u)))),c1:h.add(h.sub(h.mul(h.add(t,e),h.add(i,o)),h.add(a,c)),h.mulByNonresidue(u)),c2:h.sub(h.add(c,h.mul(h.add(t,r),h.add(i,s))),h.add(a,u))}},y=({c0:t,c1:e,c2:r})=>{let n=h.sqr(t),i=h.mul(h.mul(t,e),Zs),o=h.mul(h.mul(e,r),Zs),s=h.sqr(r);return{c0:h.add(h.mulByNonresidue(o),n),c1:h.add(h.mulByNonresidue(s),i),c2:h.sub(h.sub(h.add(h.add(i,h.sqr(h.add(h.sub(t,e),r))),o),n),s)}},[m,w]=Ys(h,d,r.ORDER,6,2,3),v={ORDER:h.ORDER,isLE:h.isLE,BITS:3*h.BITS,BYTES:3*h.BYTES,MASK:Vo(3*h.BITS),ZERO:{c0:h.ZERO,c1:h.ZERO,c2:h.ZERO},ONE:{c0:h.ONE,c1:h.ZERO,c2:h.ZERO},create:t=>t,isValid:({c0:t,c1:e,c2:r})=>h.isValid(t)&&h.isValid(e)&&h.isValid(r),is0:({c0:t,c1:e,c2:r})=>h.is0(t)&&h.is0(e)&&h.is0(r),neg:({c0:t,c1:e,c2:r})=>({c0:h.neg(t),c1:h.neg(e),c2:h.neg(r)}),eql:({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o})=>h.eql(t,n)&&h.eql(e,i)&&h.eql(r,o),sqrt:Ko,div:(t,e)=>v.mul(t,"bigint"==typeof e?r.inv(r.create(e)):v.inv(e)),pow:(t,e)=>us(v,t,e),invertBatch:t=>fs(v,t),add:p,sub:g,mul:b,sqr:y,addN:p,subN:g,mulN:b,sqrN:y,inv:({c0:t,c1:e,c2:r})=>{let n=h.sub(h.sqr(t),h.mulByNonresidue(h.mul(r,e))),i=h.sub(h.mulByNonresidue(h.sqr(r)),h.mul(t,e)),o=h.sub(h.sqr(e),h.mul(t,r)),s=h.inv(h.add(h.mulByNonresidue(h.add(h.mul(r,i),h.mul(e,o))),h.mul(t,n)));return{c0:h.mul(s,n),c1:h.mul(s,i),c2:h.mul(s,o)}},fromBytes:t=>{if(t.length!==v.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:h.fromBytes(t.subarray(0,h.BYTES)),c1:h.fromBytes(t.subarray(h.BYTES,2*h.BYTES)),c2:h.fromBytes(t.subarray(2*h.BYTES))}},toBytes:({c0:t,c1:e,c2:r})=>Lo(h.toBytes(t),h.toBytes(e),h.toBytes(r)),cmov:({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o},s)=>({c0:h.cmov(t,n,s),c1:h.cmov(e,i,s),c2:h.cmov(r,o,s)}),fromBigSix:t=>{if(!Array.isArray(t)||6!==t.length)throw new Error("invalid Fp6 usage");return{c0:h.fromBigTuple(t.slice(0,2)),c1:h.fromBigTuple(t.slice(2,4)),c2:h.fromBigTuple(t.slice(4,6))}},frobeniusMap:({c0:t,c1:e,c2:r},n)=>({c0:h.frobeniusMap(t,n),c1:h.mul(h.frobeniusMap(e,n),m[n%6]),c2:h.mul(h.frobeniusMap(r,n),w[n%6])}),mulByFp2:({c0:t,c1:e,c2:r},n)=>({c0:h.mul(t,n),c1:h.mul(e,n),c2:h.mul(r,n)}),mulByNonresidue:({c0:t,c1:e,c2:r})=>({c0:h.mulByNonresidue(r),c1:t,c2:e}),mul1:({c0:t,c1:e,c2:r},n)=>({c0:h.mulByNonresidue(h.mul(r,n)),c1:h.mul(t,n),c2:h.mul(e,n)}),mul01({c0:t,c1:e,c2:r},n,i){let o=h.mul(t,n),s=h.mul(e,i);return{c0:h.add(h.mulByNonresidue(h.sub(h.mul(h.add(e,r),i),s)),o),c1:h.sub(h.sub(h.mul(h.add(n,i),h.add(t,e)),o),s),c2:h.add(h.sub(h.mul(h.add(t,r),n),o),s)}}},E=Ys(h,d,r.ORDER,12,1,6)[0],_=({c0:t,c1:e},{c0:r,c1:n})=>({c0:v.add(t,r),c1:v.add(e,n)}),x=({c0:t,c1:e},{c0:r,c1:n})=>({c0:v.sub(t,r),c1:v.sub(e,n)}),B=({c0:t,c1:e},r)=>{if("bigint"==typeof r)return{c0:v.mul(t,r),c1:v.mul(e,r)};let{c0:n,c1:i}=r,o=v.mul(t,n),s=v.mul(e,i);return{c0:v.add(o,v.mulByNonresidue(s)),c1:v.sub(v.mul(v.add(t,e),v.add(n,i)),v.add(o,s))}},I=({c0:t,c1:e})=>{let r=v.mul(t,e);return{c0:v.sub(v.sub(v.mul(v.add(v.mulByNonresidue(e),t),v.add(t,e)),r),v.mulByNonresidue(r)),c1:v.add(r,r)}},A={ORDER:h.ORDER,isLE:v.isLE,BITS:2*v.BITS,BYTES:2*v.BYTES,MASK:Vo(2*v.BITS),ZERO:{c0:v.ZERO,c1:v.ZERO},ONE:{c0:v.ONE,c1:v.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>v.isValid(t)&&v.isValid(e),is0:({c0:t,c1:e})=>v.is0(t)&&v.is0(e),neg:({c0:t,c1:e})=>({c0:v.neg(t),c1:v.neg(e)}),eql:({c0:t,c1:e},{c0:r,c1:n})=>v.eql(t,r)&&v.eql(e,n),sqrt:Ko,inv:({c0:t,c1:e})=>{let r=v.inv(v.sub(v.sqr(t),v.mulByNonresidue(v.sqr(e))));return{c0:v.mul(t,r),c1:v.neg(v.mul(e,r))}},div:(t,e)=>A.mul(t,"bigint"==typeof e?r.inv(r.create(e)):A.inv(e)),pow:(t,e)=>us(A,t,e),invertBatch:t=>fs(A,t),add:_,sub:x,mul:B,sqr:I,addN:_,subN:x,mulN:B,sqrN:I,fromBytes:t=>{if(t.length!==A.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:v.fromBytes(t.subarray(0,v.BYTES)),c1:v.fromBytes(t.subarray(v.BYTES))}},toBytes:({c0:t,c1:e})=>Lo(v.toBytes(t),v.toBytes(e)),cmov:({c0:t,c1:e},{c0:r,c1:n},i)=>({c0:v.cmov(t,r,i),c1:v.cmov(e,n,i)}),fromBigTwelve:t=>({c0:v.fromBigSix(t.slice(0,6)),c1:v.fromBigSix(t.slice(6,12))}),frobeniusMap(t,e){const{c0:r,c1:n,c2:i}=v.frobeniusMap(t.c1,e),o=E[e%12];return{c0:v.frobeniusMap(t.c0,e),c1:v.create({c0:h.mul(r,o),c1:h.mul(n,o),c2:h.mul(i,o)})}},mulByFp2:({c0:t,c1:e},r)=>({c0:v.mulByFp2(t,r),c1:v.mulByFp2(e,r)}),conjugate:({c0:t,c1:e})=>({c0:t,c1:v.neg(e)}),mul014:({c0:t,c1:e},r,n,i)=>{let o=v.mul01(t,r,n),s=v.mul1(e,i);return{c0:v.add(v.mulByNonresidue(s),o),c1:v.sub(v.sub(v.mul01(v.add(e,t),r,h.add(n,i)),o),s)}},mul034:({c0:t,c1:e},r,n,i)=>{const o=v.create({c0:h.mul(t.c0,r),c1:h.mul(t.c1,r),c2:h.mul(t.c2,r)}),s=v.mul01(e,n,i),a=v.mul01(v.add(t,e),h.add(r,n),i);return{c0:v.add(v.mulByNonresidue(s),o),c1:v.sub(a,v.add(o,s))}},_cyclotomicSquare:t.Fp12cyclotomicSquare,_cyclotomicExp:t.Fp12cyclotomicExp,finalExponentiate:t.Fp12finalExponentiate};return{Fp:r,Fp2:h,Fp6:v,Fp4Square:function(t,e){const r=h.sqr(t),n=h.sqr(e);return{first:h.add(h.mulByNonresidue(n),r),second:h.sub(h.sub(h.sqr(h.add(t,e)),r),n)}},Fp12:A}}({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[Xs,Xs],Fp2mulByB:({c0:t,c1:e})=>{const r=ia.mul(t,ea),n=ia.mul(e,ea);return{c0:ia.sub(r,n),c1:ia.add(r,n)}},Fp12cyclotomicSquare:({c0:t,c1:e})=>{const{c0:r,c1:n,c2:i}=t,{c0:o,c1:s,c2:a}=e,{first:c,second:u}=aa(r,s),{first:f,second:l}=aa(o,i),{first:d,second:h}=aa(n,a),p=oa.mulByNonresidue(h);return{c0:sa.create({c0:oa.add(oa.mul(oa.sub(c,r),Qs),c),c1:oa.add(oa.mul(oa.sub(f,n),Qs),f),c2:oa.add(oa.mul(oa.sub(d,i),Qs),d)}),c1:sa.create({c0:oa.add(oa.mul(oa.add(p,o),Qs),p),c1:oa.add(oa.mul(oa.add(u,s),Qs),u),c2:oa.add(oa.mul(oa.add(l,a),Qs),l)})}},Fp12cyclotomicExp(t,e){let r=ca.ONE;for(let n=na-1;n>=0;n--)r=ca._cyclotomicSquare(r),Mo(e,n)&&(r=ca.mul(r,t));return r},Fp12finalExponentiate:t=>{const e=ra,r=ca.div(ca.frobeniusMap(t,6),t),n=ca.mul(ca.frobeniusMap(r,2),r),i=ca.conjugate(ca._cyclotomicExp(n,e)),o=ca.mul(ca.conjugate(ca._cyclotomicSquare(n)),i),s=ca.conjugate(ca._cyclotomicExp(o,e)),a=ca.conjugate(ca._cyclotomicExp(s,e)),c=ca.mul(ca.conjugate(ca._cyclotomicExp(a,e)),ca._cyclotomicSquare(i)),u=ca.conjugate(ca._cyclotomicExp(c,e)),f=ca.frobeniusMap(ca.mul(i,a),2),l=ca.frobeniusMap(ca.mul(s,n),3),d=ca.frobeniusMap(ca.mul(c,ca.conjugate(n)),1),h=ca.mul(ca.mul(u,ca.conjugate(o)),n);return ca.mul(ca.mul(ca.mul(f,l),d),h)}}),ua=hs(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),fa=Es(oa,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map((t=>t.map((t=>oa.fromBigTuple(t.map(BigInt))))))),la=Es(ia,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map((t=>t.map((t=>BigInt(t)))))),da=qs(oa,{A:oa.create({c0:ia.create(Js),c1:ia.create(BigInt(240))}),B:oa.create({c0:ia.create(BigInt(1012)),c1:ia.create(BigInt(1012))}),Z:oa.create({c0:ia.create(BigInt(-2)),c1:ia.create(BigInt(-1))})}),ha=qs(ia,{A:ia.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:ia.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:ia.create(BigInt(11))}),{G2psi:pa,G2psi2:ba}=function(t,e,r){const n=e.pow(r,(t.ORDER-Hs)/Ws),i=e.pow(r,(t.ORDER-Hs)/Zs);function o(t,r){return[e.mul(e.frobeniusMap(t,1),n),e.mul(e.frobeniusMap(r,1),i)]}const s=e.pow(r,(t.ORDER**Zs-Hs)/Ws),a=e.pow(r,(t.ORDER**Zs-Hs)/Zs);if(!e.eql(a,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function c(t,r){return[e.mul(t,s),e.neg(r)]}const u=t=>(e,r)=>{const n=r.toAffine(),i=t(n.x,n.y);return e.fromAffine({x:i[0],y:i[1]})};return{psi:o,psi2:c,G2psi:u(o),G2psi2:u(c),PSI_X:n,PSI_Y:i,PSI2_X:s,PSI2_Y:a}}(ia,oa,oa.div(oa.ONE,oa.NONRESIDUE)),ya=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:ia.ORDER,m:2,k:128,expand:"xmd",hash:Ie}),ma=va(ia.toBytes(Js),{infinity:!0,compressed:!0});function wa(t){const e=224&(t=t.slice())[0],r=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return t[0]&=31,{compressed:r,infinity:n,sort:i,value:t}}function va(t,e){if(224&t[0])throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function Ea(t){t.assertValidity();const e=t.equals(xa.G1.ProjectivePoint.ZERO),{x:r,y:n}=t.toAffine();if(e)return ma.slice();const i=ia.ORDER,o=Boolean(n*Qs/i);return va(Po(r,ia.BYTES),{compressed:!0,sort:o})}function _a(t){t.assertValidity();const e=ia.BYTES;if(t.equals(xa.G2.ProjectivePoint.ZERO))return Lo(ma,Po(Js,e));const{x:r,y:n}=t.toAffine(),{re:i,im:o}=oa.reim(r),{re:s,im:a}=oa.reim(n),c=Boolean((a>Js?a*Qs:s*Qs)/ia.ORDER&Xs),u=i;return Lo(va(Po(o,e),{sort:c,compressed:!0}),Po(u,e))}const xa=function(t){const{Fp:e,Fr:r,Fp2:n,Fp6:i,Fp12:o}=t.fields,s=t.params.xNegative,a=t.params.twistType,c=$s({n:r.ORDER,...t.G1}),u=Object.assign(c,_s(c.ProjectivePoint,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),f=$s({n:r.ORDER,...t.G2}),l=Object.assign(f,_s(f.ProjectivePoint,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults}));let d;if("multiplicative"===a)d=(t,e,r,i,s,a)=>o.mul014(i,t,n.mul(e,s),n.mul(r,a));else{if("divisive"!==a)throw new Error("bls: unknown twist type");d=(t,e,r,i,s,a)=>o.mul034(i,n.mul(r,a),n.mul(e,s),t)}const h=n.div(n.ONE,n.mul(n.ONE,zs));function p(t,e,r,i){const o=n.sqr(r),s=n.sqr(i),a=n.mulByB(n.mul(s,Gs)),c=n.mul(a,Gs),u=n.sub(n.sub(n.sqr(n.add(r,i)),s),o),f=n.sub(a,o),l=n.mul(n.sqr(e),Gs),d=n.neg(u);return t.push([f,l,d]),{Rx:e=n.mul(n.mul(n.mul(n.sub(o,c),e),r),h),Ry:r=n.sub(n.sqr(n.mul(n.add(o,c),h)),n.mul(n.sqr(a),Gs)),Rz:i=n.mul(o,u)}}function g(t,e,r,i,o,s){const a=n.sub(r,n.mul(s,i)),c=n.sub(e,n.mul(o,i)),u=n.sub(n.mul(a,o),n.mul(c,s)),f=n.neg(a),l=c;t.push([u,f,l]);const d=n.sqr(c),h=n.mul(d,c),p=n.mul(d,e),g=n.add(n.sub(h,n.mul(p,zs)),n.mul(n.sqr(a),i));return{Rx:e=n.mul(c,g),Ry:r=n.sub(n.mul(n.sub(p,g),a),n.mul(h,r)),Rz:i=n.mul(i,h)}}const b=function(t){const e=[];for(;t>Vs;t>>=Vs)(t&Vs)===Ms?e.unshift(0):(t&Gs)===Gs?(e.unshift(-1),t+=Vs):e.unshift(1);return e}(t.params.ateLoopSize),y=Ho((e=>{const r=e,{x:i,y:o}=r.toAffine(),s=i,a=o,c=n.neg(o);let u=s,f=a,l=n.ONE;const d=[];for(const t of b){const e=[];({Rx:u,Ry:f,Rz:l}=p(e,u,f,l)),t&&({Rx:u,Ry:f,Rz:l}=g(e,u,f,l,s,-1===t?c:a)),d.push(e)}if(t.postPrecompute){const e=d[d.length-1];t.postPrecompute(u,f,l,s,a,g.bind(null,e))}return d}));function m(t,e=!1){let r=o.ONE;if(t.length){const e=t[0][0].length;for(let n=0;n<e;n++){r=o.sqr(r);for(const[e,i,o]of t)for(const[t,s,a]of e[n])r=d(t,s,a,r,i,o)}}return s&&(r=o.conjugate(r)),e?o.finalExponentiate(r):r}function w(t,e=!0){const r=[];u.ProjectivePoint.normalizeZ(t.map((({g1:t})=>t))),l.ProjectivePoint.normalizeZ(t.map((({g2:t})=>t)));for(const{g1:e,g2:n}of t){if(e.equals(u.ProjectivePoint.ZERO)||n.equals(l.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");e.assertValidity(),n.assertValidity();const t=e.toAffine();r.push([y(n),t.x,t.y])}return m(r,e)}const v={randomPrivateKey:()=>{const e=gs(r.ORDER);return function(t,e,r=!1){const n=t.length,i=ps(e),o=gs(e);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const s=es(r?Uo(t):Ro(t),e-Wo)+Wo;return r?ko(s,i):Po(s,i)}(t.randomBytes(e),r.ORDER)},calcPairingPrecomputes:y},{ShortSignature:E}=t.G1,{Signature:_}=t.G2;function x(t){return t instanceof u.ProjectivePoint?t:u.ProjectivePoint.fromHex(t)}function B(t,e){return t instanceof u.ProjectivePoint?t:u.hashToCurve(Fo("point",t),e)}function I(t){return t instanceof l.ProjectivePoint?t:_.fromHex(t)}function A(t,e){return t instanceof l.ProjectivePoint?t:l.hashToCurve(Fo("point",t),e)}function S(t){if(!Array.isArray(t)||0===t.length)throw new Error("expected non-empty array")}return u.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:function(t){return u.ProjectivePoint.fromPrivateKey(t).toRawBytes(!0)},getPublicKeyForShortSignatures:function(t){return l.ProjectivePoint.fromPrivateKey(t).toRawBytes(!0)},sign:function(t,e,r){const n=A(t,r);n.assertValidity();const i=n.multiply(u.normPrivateKeyToScalar(e));return t instanceof l.ProjectivePoint?i:_.toRawBytes(i)},signShortSignature:function(t,e,r){const n=B(t,r);n.assertValidity();const i=n.multiply(u.normPrivateKeyToScalar(e));return t instanceof u.ProjectivePoint?i:E.toRawBytes(i)},verify:function(t,e,r,n){const i=x(r),s=A(e,n),a=u.ProjectivePoint.BASE,c=I(t),f=w([{g1:i.negate(),g2:s},{g1:a,g2:c}]);return o.eql(f,o.ONE)},verifyBatch:function(t,e,r,n){if(S(e),r.length!==e.length)throw new Error("amount of public keys and messages should be equal");const i=I(t),s=e.map((t=>A(t,n))),a=r.map(x),c=new Map;for(let t=0;t<a.length;t++){const e=a[t],r=s[t];let n=c.get(r);void 0===n&&(n=[],c.set(r,n)),n.push(e)}const f=[];try{for(const[t,e]of c){const r=e.reduce(((t,e)=>t.add(e)));f.push({g1:r,g2:t})}return f.push({g1:u.ProjectivePoint.BASE.negate(),g2:i}),o.eql(w(f),o.ONE)}catch{return!1}},verifyShortSignature:function(t,e,r,n){const i=I(r),s=B(e,n),a=l.ProjectivePoint.BASE,c=w([{g1:s,g2:i},{g1:x(t),g2:a.negate()}]);return o.eql(c,o.ONE)},aggregatePublicKeys:function(t){S(t);const e=t.map(x).reduce(((t,e)=>t.add(e)),u.ProjectivePoint.ZERO);return t[0]instanceof u.ProjectivePoint?(e.assertValidity(),e):e.toRawBytes(!0)},aggregateSignatures:function(t){S(t);const e=t.map(I).reduce(((t,e)=>t.add(e)),l.ProjectivePoint.ZERO);return t[0]instanceof l.ProjectivePoint?(e.assertValidity(),e):_.toRawBytes(e)},aggregateShortSignatures:function(t){S(t);const e=t.map(x).reduce(((t,e)=>t.add(e)),u.ProjectivePoint.ZERO);return t[0]instanceof u.ProjectivePoint?(e.assertValidity(),e):E.toRawBytes(e)},millerLoopBatch:m,pairing:function(t,e,r=!0){return w([{g1:t,g2:e}],r)},pairingBatch:w,G1:u,G2:l,Signature:_,ShortSignature:E,fields:{Fr:r,Fp:e,Fp2:n,Fp6:i,Fp12:o},params:{ateLoopSize:t.params.ateLoopSize,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:v}}({fields:{Fp:ia,Fp2:oa,Fp6:sa,Fp12:ca,Fr:ua},G1:{Fp:ia,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:ia.ZERO,b:ea,htfDefaults:{...ya,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const r=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new t(ia.mul(e.px,r),e.py,e.pz);return e.multiplyUnsafe(ra).negate().multiplyUnsafe(ra).equals(n)},clearCofactor:(t,e)=>e.multiplyUnsafe(ra).add(e),mapToCurve:t=>{const{x:e,y:r}=ha(ia.create(t[0]));return la(e,r)},fromBytes:t=>{const{compressed:e,infinity:r,sort:n,value:i}=wa(t);if(48===i.length&&e){const t=ia.ORDER,e=Ro(i),o=ia.create(e&ia.MASK);if(r){if(o!==Js)throw new Error("G1: non-empty compressed point at infinity");return{x:Js,y:Js}}const s=ia.add(ia.pow(o,ta),ia.create(xa.params.G1b));let a=ia.sqrt(s);if(!a)throw new Error("invalid compressed G1 point");return a*Qs/t!==BigInt(n)&&(a=ia.neg(a)),{x:ia.create(o),y:ia.create(a)}}if(96!==i.length||e)throw new Error("invalid point G1, expected 48/96 bytes");{const t=Ro(i.subarray(0,ia.BYTES)),e=Ro(i.subarray(ia.BYTES));if(r){if(t!==Js||e!==Js)throw new Error("G1: non-empty point at infinity");return xa.G1.ProjectivePoint.ZERO.toAffine()}return{x:ia.create(t),y:ia.create(e)}}},toBytes:(t,e,r)=>{const n=e.equals(t.ZERO),{x:i,y:o}=e.toAffine();if(r){if(n)return ma.slice();const t=ia.ORDER,e=Boolean(o*Qs/t);return va(Po(i,ia.BYTES),{compressed:!0,sort:e})}if(n){return Lo(new Uint8Array([64]),new Uint8Array(2*ia.BYTES-1))}return Lo(Po(i,ia.BYTES),Po(o,ia.BYTES))},ShortSignature:{fromHex(t){const{infinity:e,sort:r,value:n}=wa(Fo("signatureHex",t,48)),i=ia.ORDER,o=Ro(n);if(e)return xa.G1.ProjectivePoint.ZERO;const s=ia.create(o&ia.MASK),a=ia.add(ia.pow(s,ta),ia.create(xa.params.G1b));let c=ia.sqrt(a);if(!c)throw new Error("invalid compressed G1 point");const u=BigInt(r);c*Qs/i!==u&&(c=ia.neg(c));const f=xa.G1.ProjectivePoint.fromAffine({x:s,y:c});return f.assertValidity(),f},toRawBytes:t=>Ea(t),toHex:t=>So(Ea(t))}},G2:{Fp:oa,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:oa.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:oa.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:oa.ZERO,b:oa.fromBigTuple([ea,ea]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...ya},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:t=>{const{x:e,y:r}=da(oa.fromBigTuple(t));return fa(e,r)},isTorsionFree:(t,e)=>e.multiplyUnsafe(ra).negate().equals(pa(t,e)),clearCofactor:(t,e)=>{const r=ra;let n=e.multiplyUnsafe(r).negate(),i=pa(t,e),o=e.double();o=ba(t,o),o=o.subtract(i),i=n.add(i),i=i.multiplyUnsafe(r).negate(),o=o.add(i),o=o.subtract(n);return o.subtract(e)},fromBytes:t=>{const{compressed:e,infinity:r,sort:n,value:i}=wa(t);if(!e&&!r&&n||!e&&r&&n||n&&r&&e)throw new Error("invalid encoding flag: "+(224&t[0]));const o=ia.BYTES,s=(t,e,r)=>Ro(t.slice(e,r));if(96===i.length&&e){const t=xa.params.G2b,e=ia.ORDER;if(r){if(i.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid compressed G2 point");return{x:oa.ZERO,y:oa.ZERO}}const a=s(i,0,o),c=s(i,o,2*o),u=oa.create({c0:ia.create(c),c1:ia.create(a)}),f=oa.add(oa.pow(u,ta),t);let l=oa.sqrt(f);const d=l.c1===Js?l.c0*Qs/e:l.c1*Qs/e?Xs:Js;return l=n&&d>0?l:oa.neg(l),{x:u,y:l}}if(192!==i.length||e)throw new Error("invalid point G2, expected 96/192 bytes");{if(r){if(i.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid uncompressed G2 point");return{x:oa.ZERO,y:oa.ZERO}}const t=s(i,0,o),e=s(i,o,2*o),n=s(i,2*o,3*o),a=s(i,3*o,4*o);return{x:oa.fromBigTuple([e,t]),y:oa.fromBigTuple([a,n])}}},toBytes:(t,e,r)=>{const{BYTES:n,ORDER:i}=ia,o=e.equals(t.ZERO),{x:s,y:a}=e.toAffine();if(r){if(o)return Lo(ma,Po(Js,n));const t=Boolean(a.c1===Js?a.c0*Qs/i:a.c1*Qs/i);return Lo(va(Po(s.c1,n),{compressed:!0,sort:t}),Po(s.c0,n))}{if(o)return Lo(new Uint8Array([64]),new Uint8Array(4*n-1));const{re:t,im:e}=oa.reim(s),{re:r,im:i}=oa.reim(a);return Lo(Po(e,n),Po(t,n),Po(i,n),Po(r,n))}},Signature:{fromHex(t){const{infinity:e,sort:r,value:n}=wa(Fo("signatureHex",t)),i=ia.ORDER,o=n.length/2;if(48!==o&&96!==o)throw new Error("invalid compressed signature length, must be 96 or 192");const s=Ro(n.slice(0,o)),a=Ro(n.slice(o));if(e)return xa.G2.ProjectivePoint.ZERO;const c=ia.create(s&ia.MASK),u=ia.create(a),f=oa.create({c0:u,c1:c}),l=oa.add(oa.pow(f,ta),xa.params.G2b);let d=oa.sqrt(l);if(!d)throw new Error("Failed to find a square root");const{re:h,im:p}=oa.reim(d),g=BigInt(r);(p>Js&&p*Qs/i!==g||p===Js&&h*Qs/i!==g)&&(d=oa.neg(d));const b=xa.G2.ProjectivePoint.fromAffine({x:f,y:d});return b.assertValidity(),b},toRawBytes:t=>_a(t),toHex:t=>So(_a(t))}},params:{ateLoopSize:ra,r:ua.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:ya,hash:Ie,randomBytes:Kt});function Ba(t,e,r){const n="string"==typeof t?t:Pe(t),i="string"==typeof e?e:Pe(e),o="string"==typeof r?r:Pe(r);return xa.verifyShortSignature(i,o,n)}const Ia=t=>Ye(new Me(t)),Aa=t=>{const e=Ia(t);return new Date(Number(e)/1e6)};var Sa,Ta,Na=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},Oa=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class Ra extends $e{constructor(t){super(`Invalid certificate: ${t}`)}}!function(t){t[t.Empty=0]="Empty",t[t.Fork=1]="Fork",t[t.Labeled=2]="Labeled",t[t.Leaf=3]="Leaf",t[t.Pruned=4]="Pruned"}(Ta||(Ta={}));class Ua{constructor(t,e,r,n,i=5,o=!1){this._rootKey=e,this._canisterId=r,this._blsVerify=n,this._maxAgeInMinutes=i,Sa.set(this,!1),Na(this,Sa,o,"f"),this.cert=so(new Uint8Array(t))}static async create(t){const e=Ua.createUnverified(t);return await e.verify(),e}static createUnverified(t){let e=t.blsVerify;return e||(e=Ba),new Ua(t.certificate,t.rootKey,t.canisterId,e,t.maxAgeInMinutes,t.disableTimeVerification)}lookup(t){return $a(t,this.cert.tree)}lookup_label(t){return this.lookup([t])}async verify(){const t=await La(this.cert.tree),e=await this._checkDelegationAndGetKey(this.cert.delegation),r=this.cert.signature,n=function(t){const e=Pa.byteLength+ka;if(t.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const r=t.slice(0,Pa.byteLength);if(!Ce(r,Pa))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${Pa}, but get ${r}`);return t.slice(Pa.byteLength)}(e),i=Ue(Ca("ic-state-root"),t);let o=!1;const s=Fa(this.lookup(["time"]));if(!s)throw new Ra("Certificate does not contain a time");if(!Oa(this,Sa,"f")){const t=3e5,e=60*this._maxAgeInMinutes*1e3,r=Date.now(),n=r-e,i=r+t,o=Aa(s);if(o.getTime()<n)throw new Ra(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+o.toISOString()+" Current time: "+new Date(r).toISOString());if(o.getTime()>i)throw new Ra("Certificate is signed more than 5 minutes in the future. Certificate time: "+o.toISOString()+" Current time: "+new Date(r).toISOString())}try{o=await this._blsVerify(new Uint8Array(n),new Uint8Array(r),new Uint8Array(i))}catch(t){o=!1}if(!o)throw new Ra("Signature verification failed")}async _checkDelegationAndGetKey(t){if(!t)return this._rootKey;const e=await Ua.createUnverified({certificate:t.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(e.cert.delegation)throw new Ra("Delegation certificates cannot be nested");if(await e.verify(),this._canisterId.toString()!==Bu){if(!Va({canisterId:this._canisterId,subnetId:Re.fromUint8Array(new Uint8Array(t.subnet_id)),tree:e.cert.tree}))throw new Ra(`Canister ${this._canisterId} not in range of delegations for subnet 0x${Pe(t.subnet_id)}`)}const r=Fa(e.lookup(["subnet",t.subnet_id,"public_key"]));if(!r)throw new Error(`Could not find subnet key for subnet 0x${Pe(t.subnet_id)}`);return r}}Sa=new WeakMap;const Pa=Fe("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),ka=96;function Fa(t){if(t.status===Da.Found)return t.value instanceof ArrayBuffer?t.value:t.value instanceof Uint8Array?t.value.buffer:void 0}async function La(t){switch(t[0]){case Ta.Empty:return wi(Ca("ic-hashtree-empty"));case Ta.Pruned:return t[1];case Ta.Leaf:return wi(Ue(Ca("ic-hashtree-leaf"),t[1]));case Ta.Labeled:return wi(Ue(Ca("ic-hashtree-labeled"),t[1],await La(t[2])));case Ta.Fork:return wi(Ue(Ca("ic-hashtree-fork"),await La(t[1]),await La(t[2])));default:throw new Error("unreachable")}}function Ca(t){return Ue(new Uint8Array([t.length]),(new TextEncoder).encode(t))}var Da,ja;function $a(t,e){if(0===t.length){if(e[0]===Ta.Leaf){if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:Da.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:Da.Found,value:e[1].buffer}:{status:Da.Found,value:e[1]}}return{status:Da.Found,value:e}}const r=Ma("string"==typeof t[0]?(new TextEncoder).encode(t[0]):t[0],e);switch(r.status){case Da.Found:return $a(t.slice(1),r.value);case ja.Greater:case ja.Less:return{status:Da.Absent};default:return r}}function qa(t){switch(t[0]){case Ta.Empty:return[];case Ta.Fork:return qa(t[1]).concat(qa(t[2]));default:return[t]}}function Ma(t,e){switch(e[0]){case Ta.Labeled:return function(t,e){const r=new Uint8Array(t),n=new Uint8Array(e);for(let t=0;t<r.length;t++)if(r[t]>n[t])return!0;return!1}(t,e[1])?{status:ja.Greater}:Ce(t,e[1])?{status:Da.Found,value:e[2]}:{status:ja.Less};case Ta.Fork:const r=Ma(t,e[1]);switch(r.status){case ja.Greater:{const r=Ma(t,e[2]);return r.status===ja.Less?{status:Da.Absent}:r}case Da.Unknown:{let r=Ma(t,e[2]);return r.status===ja.Less?{status:Da.Unknown}:r}default:return r}case Ta.Pruned:return{status:Da.Unknown};default:return{status:Da.Absent}}}function Va(t){const{canisterId:e,subnetId:r,tree:n}=t,i=$a(["subnet",r.toUint8Array(),"canister_ranges"],n);if(i.status!==Da.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${r}`);return so(i.value).map((t=>[Re.fromUint8Array(t[0]),Re.fromUint8Array(t[1])])).some((t=>t[0].ltEq(e)&&t[1].gtEq(e)))}!function(t){t.Unknown="unknown",t.Absent="absent",t.Found="found"}(Da||(Da={})),function(t){t.Less="less",t.Greater="greater"}(ja||(ja={}));const za=async t=>{const{agent:e,paths:r}=t,n=Re.from(t.canisterId),i=[...new Set(r)],o=i.map((t=>Ka(t,n))),s=new Map,a=i.map(((t,r)=>(async()=>{var a;try{const t=await e.readState(n,{paths:[o[r]]});if(null==e.rootKey)throw new Error("Agent is missing root key");const a=await Ua.create({certificate:t.certificate,rootKey:e.rootKey,canisterId:n,disableTimeVerification:!0}),c=(r,i)=>{if("subnet"===i){if(null==e.rootKey)throw new Error("Agent is missing root key");return{path:i,data:Ga(t.certificate,n,e.rootKey)}}return{path:i,data:Fa(r.lookup(Ka(i,n)))}},{path:u,data:f}=c(a,i[r]);if(f)switch(u){case"time":s.set(u,Aa(f));break;case"controllers":s.set(u,Ya(f));break;case"module_hash":s.set(u,Ha(f));break;case"subnet":s.set(u,f);break;case"candid":s.set(u,(new TextDecoder).decode(f));break;default:if("string"!=typeof u&&"key"in u&&"path"in u)switch(u.decodeStrategy){case"raw":s.set(u.key,f);break;case"leb128":s.set(u.key,Ia(f));break;case"cbor":s.set(u.key,Za(f));break;case"hex":s.set(u.key,Ha(f));break;case"utf-8":s.set(u.key,Wa(f))}}else console.warn(`Expected to find result for path ${u}, but instead found nothing.`),"string"==typeof u?s.set(u,null):s.set(u.key,null)}catch(e){if(null===(a=null==e?void 0:e.message)||void 0===a?void 0:a.includes("Invalid certificate"))throw new $e(e.message);"string"!=typeof t&&"key"in t&&"path"in t?s.set(t.key,null):s.set(t,null),console.group(),console.warn(`Expected to find result for path ${t}, but instead found nothing.`),console.warn(e),console.groupEnd()}})()));return await Promise.all(a),s},Ga=(t,e,r)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const n=so(new Uint8Array(t)),i=n.tree;let o,s=n.delegation;s&&s.subnet_id?o=Re.fromUint8Array(new Uint8Array(s.subnet_id)):s||void 0===r?(o=Re.selfAuthenticating(Re.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),s={subnet_id:o.toUint8Array(),certificate:new ArrayBuffer(0)}):(o=Re.selfAuthenticating(new Uint8Array(r)),s={subnet_id:o.toUint8Array(),certificate:new ArrayBuffer(0)});if(!Va({canisterId:e,subnetId:o,tree:i}))throw new Error("Canister not in range");const a=$a(["subnet",s.subnet_id,"node"],i);if(a.status!==Da.Found)throw new Error("Node not found");if(a.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const c=qa(a.value),u=new Map;return c.forEach((t=>{const e=Re.from(new Uint8Array(t[1])).toText(),r=$a(["public_key"],t[2]);if(r.status!==Da.Found)throw new Error("Public key not found");const n=r.value;if(44!==n.byteLength)throw new Error("Invalid public key length");u.set(e,n)})),{subnetId:Re.fromUint8Array(new Uint8Array(s.subnet_id)).toText(),nodeKeys:u}},Ka=(t,e)=>{const r=new TextEncoder,n=t=>new DataView(r.encode(t).buffer).buffer,i=new DataView(e.toUint8Array().buffer).buffer;switch(t){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in t&&"path"in t){if("string"==typeof t.path||t.path instanceof ArrayBuffer){const e=t.path,r="string"==typeof e?n(e):e;return[n("canister"),i,n("metadata"),r]}return t.path}}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${t} was formatted correctly.`)},Ha=t=>Pe(t),Za=t=>so(t),Wa=t=>(new TextDecoder).decode(t),Ya=t=>Za(t).map((t=>Re.fromUint8Array(new Uint8Array(t))));var Ja=Object.freeze({__proto__:null,CustomPath:class{constructor(t,e,r){this.key=t,this.path=e,this.decodeStrategy=r}},encodePath:Ka,fetchNodeKeys:Ga,request:za});const Xa=BigInt(0),Qa=BigInt(1),tc=BigInt(2),ec=BigInt(8),rc={zip215:!0};function nc(t){const e=function(t){const e=ks(t);return Go(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:r,n:n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=e,u=tc<<BigInt(8*a)-Qa,f=r.create,l=hs(e.n,e.nBitLength);if(!function(t,n){const i=r.sqr(t),o=r.sqr(n),s=r.add(r.mul(e.a,i),o),a=r.add(r.ONE,r.mul(e.d,r.mul(i,o)));return r.eql(s,a)}(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const d=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:r.sqrt(t*r.inv(e))}}catch(t){return{isValid:!1,value:Xa}}}),h=e.adjustScalarBytes||(t=>t),p=e.domain||((t,e,r)=>{if(xo("phflag",r),e.length||r)throw new Error("Contexts/pre-hash are not supported");return t});function g(t,e,r=!1){$o("coordinate "+t,e,r?Qa:Xa,u)}function b(t){if(!(t instanceof w))throw new Error("ExtendedPoint expected")}const y=Ho(((t,e)=>{const{ex:n,ey:i,ez:o}=t,s=t.is0();null==e&&(e=s?ec:r.inv(o));const a=f(n*e),c=f(i*e),u=f(o*e);if(s)return{x:Xa,y:Qa};if(u!==Qa)throw new Error("invZ was invalid");return{x:a,y:c}})),m=Ho((t=>{const{a:r,d:n}=e;if(t.is0())throw new Error("bad point: ZERO");const{ex:i,ey:o,ez:s,et:a}=t,c=f(i*i),u=f(o*o),l=f(s*s),d=f(l*l),h=f(c*r);if(f(l*f(h+u))!==f(d+f(n*f(c*u))))throw new Error("bad point: equation left != right (1)");if(f(i*o)!==f(s*a))throw new Error("bad point: equation left != right (2)");return!0}));class w{constructor(t,e,r,n){g("x",t),g("y",e),g("z",r,!0),g("t",n),this.ex=t,this.ey=e,this.ez=r,this.et=n,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof w)throw new Error("extended point not allowed");const{x:e,y:r}=t||{};return g("x",e),g("y",r),new w(e,r,Qa,f(e*r))}static normalizeZ(t){const e=fs(r,t.map((t=>t.ez)));return t.map(((t,r)=>t.toAffine(e[r]))).map(w.fromAffine)}static msm(t,e){return Ps(w,l,t,e)}_setWindowSize(t){_.setWindowSize(this,t)}assertValidity(){m(this)}equals(t){b(t);const{ex:e,ey:r,ez:n}=this,{ex:i,ey:o,ez:s}=t,a=f(e*s),c=f(i*n),u=f(r*s),l=f(o*n);return a===c&&u===l}is0(){return this.equals(w.ZERO)}negate(){return new w(f(-this.ex),this.ey,this.ez,f(-this.et))}double(){const{a:t}=e,{ex:r,ey:n,ez:i}=this,o=f(r*r),s=f(n*n),a=f(tc*f(i*i)),c=f(t*o),u=r+n,l=f(f(u*u)-o-s),d=c+s,h=d-a,p=c-s,g=f(l*h),b=f(d*p),y=f(l*p),m=f(h*d);return new w(g,b,m,y)}add(t){b(t);const{a:r,d:n}=e,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:u,ez:l,et:d}=t,h=f(i*c),p=f(o*u),g=f(a*n*d),y=f(s*l),m=f((i+o)*(c+u)-h-p),v=y-g,E=y+g,_=f(p-r*h),x=f(m*v),B=f(E*_),I=f(m*_),A=f(v*E);return new w(x,B,A,I)}subtract(t){return this.add(t.negate())}wNAF(t){return _.wNAFCached(this,t,w.normalizeZ)}multiply(t){const e=t;$o("scalar",e,Qa,n);const{p:r,f:i}=this.wNAF(e);return w.normalizeZ([r,i])[0]}multiplyUnsafe(t,e=w.ZERO){const r=t;return $o("scalar",r,Xa,n),r===Xa?E:this.is0()||r===Qa?this:_.wNAFCachedUnsafe(this,r,w.normalizeZ,e)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return _.unsafeLadder(this,n).is0()}toAffine(t){return y(this,t)}clearCofactor(){const{h:t}=e;return t===Qa?this:this.multiplyUnsafe(t)}static fromHex(t,n=!1){const{d:i,a:o}=e,s=r.BYTES;t=Fo("pointHex",t,s),xo("zip215",n);const a=t.slice(),c=t[s-1];a[s-1]=-129&c;const l=Uo(a),h=n?u:r.ORDER;$o("pointHex.y",l,Xa,h);const p=f(l*l),g=f(p-Qa),b=f(i*p-o);let{isValid:y,value:m}=d(g,b);if(!y)throw new Error("Point.fromHex: invalid y coordinate");const v=(m&Qa)===Qa,E=0!=(128&c);if(!n&&m===Xa&&E)throw new Error("Point.fromHex: x=0 and x_0=1");return E!==v&&(m=f(-m)),w.fromAffine({x:m,y:l})}static fromPrivateKey(t){const{scalar:e}=I(t);return v.multiply(e)}toRawBytes(){const{x:t,y:e}=this.toAffine(),n=ko(e,r.BYTES);return n[n.length-1]|=t&Qa?128:0,n}toHex(){return So(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,Qa,f(e.Gx*e.Gy)),w.ZERO=new w(Xa,Qa,Qa,Xa);const{BASE:v,ZERO:E}=w,_=Us(w,8*a);function x(t){return es(t,n)}function B(t){return x(Uo(t))}function I(t){const e=r.BYTES;t=Fo("private key",t,e);const n=Fo("hashed private key",o(t),2*e),i=h(n.slice(0,e));return{head:i,prefix:n.slice(e,2*e),scalar:B(i)}}function A(t){const{head:e,prefix:r,scalar:n}=I(t),i=v.multiply(n),o=i.toRawBytes();return{head:e,prefix:r,scalar:n,point:i,pointBytes:o}}function S(t=Uint8Array.of(),...e){const r=Lo(...e);return B(o(p(r,Fo("context",t),!!i)))}const T=rc;v._setWindowSize(8);return{CURVE:e,getPublicKey:function(t){return A(t).pointBytes},sign:function(t,e,o={}){t=Fo("message",t),i&&(t=i(t));const{prefix:s,scalar:a,pointBytes:c}=A(e),u=S(o.context,s,t),f=v.multiply(u).toRawBytes(),l=x(u+S(o.context,f,c,t)*a);return $o("signature.s",l,Xa,n),Fo("result",Lo(f,ko(l,r.BYTES)),2*r.BYTES)},verify:function(t,e,n,o=T){const{context:s,zip215:a}=o,c=r.BYTES;t=Fo("signature",t,2*c),e=Fo("message",e),n=Fo("publicKey",n,c),void 0!==a&&xo("zip215",a),i&&(e=i(e));const u=Uo(t.slice(c,2*c));let f,l,d;try{f=w.fromHex(n,a),l=w.fromHex(t.slice(0,c),a),d=v.multiplyUnsafe(u)}catch(t){return!1}if(!a&&f.isSmallOrder())return!1;const h=S(s,l.toRawBytes(),f.toRawBytes(),e);return l.add(f.multiplyUnsafe(h)).subtract(d).clearCofactor().equals(w.ZERO)},ExtendedPoint:w,utils:{getExtendedPublicKey:A,randomPrivateKey:()=>s(r.BYTES),precompute:(t=8,e=w.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}const ic=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),oc=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const sc=BigInt(1),ac=BigInt(2);BigInt(3);const cc=BigInt(5),uc=BigInt(8);function fc(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function lc(t,e){const r=ic,n=es(e*e*e,r),i=function(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),o=ic,s=t*t%o*t%o,a=rs(s,ac,o)*s%o,c=rs(a,sc,o)*t%o,u=rs(c,cc,o)*c%o,f=rs(u,e,o)*u%o,l=rs(f,r,o)*f%o,d=rs(l,n,o)*l%o,h=rs(d,i,o)*d%o,p=rs(h,i,o)*d%o,g=rs(p,e,o)*u%o;return{pow_p_5_8:rs(g,ac,o)*t%o,b2:s}}(t*es(n*n*e,r)).pow_p_5_8;let o=es(t*n*i,r);const s=es(e*o*o,r),a=o,c=es(o*oc,r),u=s===t,f=s===es(-t,r),l=s===es(-t*oc,r);return u&&(o=a),(f||l)&&(o=c),(es(o,r)&Wo)===Wo&&(o=es(-o,r)),{isValid:u||f,value:o}}const dc=(()=>hs(ic,void 0,!0))(),hc=(()=>({a:dc.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:dc,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:uc,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Se,randomBytes:Kt,adjustScalarBytes:fc,uvRatio:lc}))(),pc=(()=>nc(hc))();var gc,bc,yc,mc,wc=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},vc=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class Ec{constructor(t={}){gc.set(this,void 0),bc.set(this,void 0),this[yc]=this.entries.bind(this),this[mc]="ExpirableMap";const{source:e=[],expirationTime:r=6e5}=t,n=Date.now();wc(this,gc,new Map([...e].map((([t,e])=>[t,{value:e,timestamp:n}]))),"f"),wc(this,bc,r,"f")}prune(){const t=Date.now();for(const[e,r]of vc(this,gc,"f").entries())t-r.timestamp>vc(this,bc,"f")&&vc(this,gc,"f").delete(e);return this}set(t,e){this.prune();const r={value:e,timestamp:Date.now()};return vc(this,gc,"f").set(t,r),this}get(t){const e=vc(this,gc,"f").get(t);if(void 0!==e){if(!(Date.now()-e.timestamp>vc(this,bc,"f")))return e.value;vc(this,gc,"f").delete(t)}}clear(){vc(this,gc,"f").clear()}entries(){const t=vc(this,gc,"f").entries();return function*(){for(const[e,r]of t)yield[e,r.value]}()}values(){const t=vc(this,gc,"f").values();return function*(){for(const e of t)yield e.value}()}keys(){return vc(this,gc,"f").keys()}forEach(t,e){for(const[r,n]of vc(this,gc,"f").entries())t.call(e,n.value,r,this)}has(t){return vc(this,gc,"f").has(t)}delete(t){return vc(this,gc,"f").delete(t)}get size(){return vc(this,gc,"f").size}}gc=new WeakMap,bc=new WeakMap,yc=Symbol.iterator,mc=Symbol.toStringTag;const _c=t=>{if(t<=127)return 1;if(t<=255)return 2;if(t<=65535)return 3;if(t<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},xc=(t,e,r)=>{if(r<=127)return t[e]=r,1;if(r<=255)return t[e]=129,t[e+1]=r,2;if(r<=65535)return t[e]=130,t[e+1]=r>>8,t[e+2]=r,3;if(r<=16777215)return t[e]=131,t[e+1]=r>>16,t[e+2]=r>>8,t[e+3]=r,4;throw new Error("Length too long (> 4 bytes)")},Bc=(t,e)=>{if(t[e]<128)return 1;if(128===t[e])throw new Error("Invalid length 0");if(129===t[e])return 2;if(130===t[e])return 3;if(131===t[e])return 4;throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const Ic=Uint8Array.from([48,5,6,3,43,101,112]);function Ac(t,e){const r=2+_c(t.byteLength+1),n=e.byteLength+r+t.byteLength;let i=0;const o=new Uint8Array(1+_c(n)+n);return o[i++]=48,i+=xc(o,i,n),o.set(e,i),i+=e.byteLength,o[i++]=3,i+=xc(o,i,t.byteLength+1),o[i++]=0,o.set(new Uint8Array(t),i),o}Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);const Sc=(t,e)=>{let r=0;const n=(t,e)=>{if(i[r++]!==t)throw new Error("Expected: "+e)},i=new Uint8Array(t);if(n(48,"sequence"),r+=Bc(i,r),!Ce(i.slice(r,r+e.byteLength),e))throw new Error("Not the expected OID.");r+=e.byteLength,n(3,"bit string");const o=((t,e)=>{const r=Bc(t,e);if(1===r)return t[e];if(2===r)return t[e+1];if(3===r)return(t[e+1]<<8)+t[e+2];if(4===r)return(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];throw new Error("Length too long (> 4 bytes)")})(i,r)-1;r+=Bc(i,r),n(0,"0 padding");const s=i.slice(r);if(o!==s.length)throw new Error(`DER payload mismatch: Expected length ${o} actual length ${s.length}`);return s};var Tc,Nc,Oc=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},Rc=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};let Uc=class t{constructor(e){if(Tc.set(this,void 0),Nc.set(this,void 0),e.byteLength!==t.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Oc(this,Tc,e,"f"),Oc(this,Nc,t.derEncode(e),"f")}static from(t){return this.fromDer(t.toDer())}static fromRaw(e){return new t(e)}static fromDer(e){return new t(this.derDecode(e))}static derEncode(t){return Ac(t,Ic).buffer}static derDecode(t){const e=Sc(t,Ic);if(e.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return e}get rawKey(){return Rc(this,Tc,"f")}get derKey(){return Rc(this,Nc,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};Tc=new WeakMap,Nc=new WeakMap,Uc.RAW_KEY_LENGTH=32;class Pc{constructor(){this.observers=[]}subscribe(t){this.observers.push(t)}unsubscribe(t){this.observers=this.observers.filter((e=>e!==t))}notify(t,...e){this.observers.forEach((r=>r(t,...e)))}}class kc extends Pc{constructor(){super()}print(t,...e){this.notify({message:t,level:"info"},...e)}warn(t,...e){this.notify({message:t,level:"warn"},...e)}error(t,e,...r){this.notify({message:t,level:"error",error:e},...r)}}var Fc,Lc,Cc,Dc,jc,$c,qc,Mc,Vc,zc=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},Gc=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};const Kc=.5,Hc=1.5,Zc=500,Wc=6e4,Yc=9e5,Jc=10;class Xc{constructor(t=Xc.default){Fc.set(this,void 0),Lc.set(this,void 0),Cc.set(this,void 0),Dc.set(this,void 0),jc.set(this,void 0),$c.set(this,void 0),qc.set(this,void 0),Mc.set(this,void 0),Vc.set(this,0);const{initialInterval:e=Zc,randomizationFactor:r=Kc,multiplier:n=Hc,maxInterval:i=Wc,maxElapsedTime:o=Yc,maxIterations:s=Jc,date:a=Date}=t;zc(this,Fc,e,"f"),zc(this,Lc,r,"f"),zc(this,Cc,n,"f"),zc(this,Dc,i,"f"),zc(this,Mc,a,"f"),zc(this,jc,a.now(),"f"),zc(this,$c,o,"f"),zc(this,qc,s,"f")}get ellapsedTimeInMsec(){return Gc(this,Mc,"f").now()-Gc(this,jc,"f")}get currentInterval(){return Gc(this,Fc,"f")}get count(){return Gc(this,Vc,"f")}get randomValueFromInterval(){const t=Gc(this,Lc,"f")*Gc(this,Fc,"f"),e=Gc(this,Fc,"f")-t,r=Gc(this,Fc,"f")+t;return Math.random()*(r-e)+e}incrementCurrentInterval(){var t;return zc(this,Fc,Math.min(Gc(this,Fc,"f")*Gc(this,Cc,"f"),Gc(this,Dc,"f")),"f"),zc(this,Vc,(t=Gc(this,Vc,"f"),++t),"f"),Gc(this,Fc,"f")}next(){return this.ellapsedTimeInMsec>=Gc(this,$c,"f")||Gc(this,Vc,"f")>=Gc(this,qc,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}Fc=new WeakMap,Lc=new WeakMap,Cc=new WeakMap,Dc=new WeakMap,jc=new WeakMap,$c=new WeakMap,qc=new WeakMap,Mc=new WeakMap,Vc=new WeakMap,Xc.default={initialInterval:Zc,randomizationFactor:Kc,multiplier:Hc,maxInterval:Wc,maxElapsedTime:Yc,maxIterations:Jc,date:Date};var Qc,tu,eu,ru,nu,iu,ou,su,au,cu,uu,fu,lu,du,hu,pu,gu,bu,yu,mu,wu,vu,Eu=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},_u=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};!function(t){t.Received="received",t.Processing="processing",t.Replied="replied",t.Rejected="rejected",t.Unknown="unknown",t.Done="done"}(vu||(vu={}));const xu=6e4,Bu="aaaaa-aa";class Iu extends $e{constructor(t){super(t),this.message=t}}class Au extends $e{constructor(t){super(t),this.message=t}}class Su{constructor(t={}){var e,r;Qc.add(this),tu.set(this,null),eu.set(this,!1),ru.set(this,void 0),nu.set(this,void 0),iu.set(this,void 0),ou.set(this,void 0),su.set(this,0),au.set(this,void 0),cu.set(this,void 0),uu.set(this,void 0),fu.set(this,void 0),this._isAgent=!0,this.config={},lu.set(this,0),this.log=new kc,du.set(this,[]),hu.set(this,[]),pu.set(this,new Ec({expirationTime:3e5})),gu.set(this,!0),mu.set(this,((t,e)=>{if(!1===_u(this,gu,"f"))return t;if(!e)throw new Ra("Invalid signature from replica signed query: no matching node key found.");const{status:r,signatures:n=[],requestId:i}=t,o=je((new TextEncoder).encode("\vic-response"));for(const s of n){const{timestamp:n,identity:a}=s,c=Re.fromUint8Array(a).toText();let u;if("replied"===r){const{reply:e}=t;u=xi({status:r,reply:e,timestamp:BigInt(n),request_id:i})}else{if("rejected"!==r)throw new Error(`Unknown status: ${r}`);{const{reject_code:e,reject_message:o,error_code:s}=t;u=xi({status:r,reject_code:e,reject_message:o,error_code:s,timestamp:BigInt(n),request_id:i})}}const f=Ue(o,je(new Uint8Array(u))),l=null==e?void 0:e.nodeKeys.get(c);if(!l)throw new Ra("Invalid signature from replica signed query: no matching node key found.");const d=Uc.fromDer(l).rawKey;if(pc.verify(s.signature,new Uint8Array(f),new Uint8Array(d)))return t;throw new Ra(`Invalid signature from replica ${c} signed query.`)}return t})),this.config=t,Eu(this,nu,t.fetch||function(){let t;if("undefined"!=typeof window){if(!window.fetch)throw new Iu("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");t=window.fetch.bind(window)}else if("undefined"!=typeof global){if(!global.fetch)throw new Iu("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");t=global.fetch.bind(global)}else"undefined"!=typeof self&&self.fetch&&(t=self.fetch.bind(self));if(t)return t;throw new Iu("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}()||fetch.bind(global),"f"),Eu(this,iu,t.fetchOptions,"f"),Eu(this,ou,t.callOptions,"f"),Eu(this,eu,null!==(e=t.shouldFetchRootKey)&&void 0!==e&&e,"f"),t.rootKey?this.rootKey=t.rootKey:_u(this,eu,"f")?this.rootKey=null:this.rootKey=Fe("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae");const n=function(t){let e;if(void 0!==t)e=t.match(/^[a-z]+:/)||"undefined"==typeof window?new URL(t):new URL(window.location.protocol+"//"+t);else{const t=["ic0.app","icp0.io","127.0.0.1","localhost"],r=[".github.dev",".gitpod.io"],n="undefined"!=typeof window?window.location:void 0,i=null==n?void 0:n.hostname;let o;i&&"string"==typeof i&&(o=r.some((t=>i.endsWith(t)))?i:t.find((t=>i.endsWith(t)))),e=n&&o?new URL(`${n.protocol}//${o}${n.port?":"+n.port:""}`):new URL("https://icp-api.io")}return e.toString()}(t.host);this.host=new URL(n),void 0!==t.verifyQuerySignatures&&Eu(this,gu,t.verifyQuerySignatures,"f"),Eu(this,cu,null!==(r=t.retryTimes)&&void 0!==r?r:3,"f");if(Eu(this,uu,t.backoffStrategy||(()=>new Xc({maxIterations:_u(this,cu,"f")})),"f"),this.host.hostname.endsWith(".ic0.app")?this.host.hostname="ic0.app":this.host.hostname.endsWith(".icp0.io")?this.host.hostname="icp0.io":this.host.hostname.endsWith(".icp-api.io")&&(this.host.hostname="icp-api.io"),t.credentials){const{name:e,password:r}=t.credentials;Eu(this,au,`${e}${r?":"+r:""}`,"f")}if(Eu(this,ru,Promise.resolve(t.identity||new Si),"f"),t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes>5)throw new $e(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);if(t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes<=0)throw new $e(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);Eu(this,fu,t.ingressExpiryInMinutes||5,"f"),this.addTransform("update",ho(uo)),t.useQueryNonces&&this.addTransform("query",ho(uo)),t.logToConsole&&this.log.subscribe((t=>{"error"===t.level?console.error(t.message):"warn"===t.level?console.warn(t.message):console.log(t.message)}))}get waterMark(){return _u(this,lu,"f")}static createSync(t={}){return new this(Object.assign({},t))}static async create(t={shouldFetchRootKey:!1}){const e=Su.createSync(t),r=[e.syncTime()];return"https://icp-api.io"!==e.host.toString()&&t.shouldFetchRootKey&&r.push(e.fetchRootKey()),await Promise.all(r),e}static async from(t){var e;try{return"config"in t?await Su.create(t.config):await Su.create({fetch:t._fetch,fetchOptions:t._fetchOptions,callOptions:t._callOptions,host:t._host.toString(),identity:null!==(e=t._identity)&&void 0!==e?e:void 0})}catch(t){throw new $e("Failed to create agent from provided agent")}}isLocal(){const t=this.host.hostname;return"127.0.0.1"===t||t.endsWith("127.0.0.1")}addTransform(t,e,r=e.priority||0){if("update"===t){const t=_u(this,hu,"f").findIndex((t=>(t.priority||0)<r));_u(this,hu,"f").splice(t>=0?t:_u(this,hu,"f").length,0,Object.assign(e,{priority:r}))}else if("query"===t){const t=_u(this,du,"f").findIndex((t=>(t.priority||0)<r));_u(this,du,"f").splice(t>=0?t:_u(this,du,"f").length,0,Object.assign(e,{priority:r}))}}async getPrincipal(){if(!_u(this,ru,"f"))throw new Au("This identity has expired due this application's security policy. Please refresh your authentication.");return(await _u(this,ru,"f")).getPrincipal()}async call(t,e,r){var n,i;await _u(this,Qc,"m",wu).call(this);const o=null===(n=e.callSync)||void 0===n||n,s=await(void 0!==r?await r:await _u(this,ru,"f"));if(!s)throw new Au("This identity has expired due this application's security policy. Please refresh your authentication.");const a=Re.from(t),c=e.effectiveCanisterId?Re.from(e.effectiveCanisterId):a,u=s.getPrincipal()||Re.anonymous();let f=new lo(_u(this,fu,"f")*xu);Math.abs(_u(this,su,"f"))>3e4&&(f=new lo(_u(this,fu,"f")*xu+_u(this,su,"f")));const l={request_type:co.Call,canister_id:a,method_name:e.methodName,arg:e.arg,sender:u,ingress_expiry:f};let d,h=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},_u(this,au,"f")?{Authorization:"Basic "+btoa(_u(this,au,"f"))}:{})},endpoint:"call",body:l});function p(t){return new Uint8Array(t)}d=(null==e?void 0:e.nonce)?p(e.nonce):h.body.nonce?p(h.body.nonce):void 0,l.nonce=d,h=await s.transformRequest(h);const g=no(h.body),b=_u(this,uu,"f").call(this),y=_i(l);try{const t=()=>(this.log.print(`fetching "/api/v3/canister/${c.toText()}/call" with request:`,h),_u(this,nu,"f").call(this,""+new URL(`/api/v3/canister/${c.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},_u(this,ou,"f")),h.request),{body:g}))),e=()=>(this.log.print(`fetching "/api/v2/canister/${c.toText()}/call" with request:`,h),_u(this,nu,"f").call(this,""+new URL(`/api/v2/canister/${c.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},_u(this,ou,"f")),h.request),{body:g}))),r=_u(this,Qc,"m",yu).call(this,{request:o?t:e,backoff:b,tries:0}),n=await r,i=await n.arrayBuffer(),s=200===n.status&&i.byteLength>0?so(i):null;if(s&&"certificate"in s){const t=await this.parseTimeFromResponse({certificate:s.certificate});Eu(this,lu,t,"f")}return{requestId:y,response:{ok:n.ok,status:n.status,statusText:n.statusText,body:s,headers:po(n.headers)},requestDetails:l}}catch(n){if(n.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(t,Object.assign(Object.assign({},e),{callSync:!1}),r);const o=`Error while making call: ${null!==(i=n.message)&&void 0!==i?i:String(n)}`,s=new bo(o,n,Pe(y),Pe(h.body.sender_pubkey),Pe(h.body.sender_sig),String(h.body.content.ingress_expiry._value));throw this.log.error(o,s),s}}async query(t,e,r){var n,i,o,s;await _u(this,Qc,"m",wu).call(this);const a=_u(this,uu,"f").call(this),c=e.effectiveCanisterId?Re.from(e.effectiveCanisterId):Re.from(t);let u,f;this.log.print(`ecid ${c.toString()}`),this.log.print(`canisterId ${t.toString()}`);const l=await(void 0!==r?r:_u(this,ru,"f"));if(!l)throw new Au("This identity has expired due this application's security policy. Please refresh your authentication.");const d=Re.from(t),h=(null==l?void 0:l.getPrincipal())||Re.anonymous(),p={request_type:"query",canister_id:d,method_name:e.methodName,arg:e.arg,sender:h,ingress_expiry:new lo(_u(this,fu,"f")*xu)},g=_i(p);u=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},_u(this,au,"f")?{Authorization:"Basic "+btoa(_u(this,au,"f"))}:{})},endpoint:"read",body:p}),u=await(null==l?void 0:l.transformRequest(u));const b=no(u.body),y={canister:d.toText(),ecid:c,transformedRequest:u,body:b,requestId:g,backoff:a,tries:0},m=async()=>({requestDetails:p,query:await _u(this,Qc,"m",bu).call(this,y)}),w=async()=>{if(!_u(this,gu,"f"))return;const t=_u(this,pu,"f").get(c.toString());return t||(await this.fetchSubnetKeys(c.toString()),_u(this,pu,"f").get(c.toString()))};try{const[e,r]=await Promise.all([m(),w()]);f=e;const{requestDetails:n,query:i}=f,o=Object.assign(Object.assign({},i),{requestDetails:n});if(this.log.print("Query response:",o),!_u(this,gu,"f"))return o;try{return _u(this,mu,"f").call(this,o,r)}catch(e){this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),_u(this,pu,"f").delete(t.toString()),await this.fetchSubnetKeys(c.toString());const r=_u(this,pu,"f").get(t.toString());if(!r)throw new Ra("Invalid signature from replica signed query: no matching node key found.");return _u(this,mu,"f").call(this,o,r)}}catch(t){const e=`Error while making call: ${null!==(n=t.message)&&void 0!==n?n:String(t)}`,r=new yo(e,t,String(g),Pe(null===(i=null==u?void 0:u.body)||void 0===i?void 0:i.sender_pubkey),Pe(null===(o=null==u?void 0:u.body)||void 0===o?void 0:o.sender_sig),String(null===(s=null==u?void 0:u.body)||void 0===s?void 0:s.content.ingress_expiry._value));throw this.log.error(e,r),r}}async createReadStateRequest(t,e){await _u(this,Qc,"m",wu).call(this);const r=await(void 0!==e?await e:await _u(this,ru,"f"));if(!r)throw new Au("This identity has expired due this application's security policy. Please refresh your authentication.");const n=(null==r?void 0:r.getPrincipal())||Re.anonymous(),i=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},_u(this,au,"f")?{Authorization:"Basic "+btoa(_u(this,au,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:t.paths,sender:n,ingress_expiry:new lo(_u(this,fu,"f")*xu)}});return null==r?void 0:r.transformRequest(i)}async readState(t,e,r,n){var i,o,s,a;const c=function(t){for(const e of t.paths){const[t,r]=e;if(Ce(t,je((new TextEncoder).encode("request_status"))))return r}}(e);await _u(this,Qc,"m",wu).call(this);const u="string"==typeof t?Re.fromText(t):t,f=null!=n?n:await this.createReadStateRequest(e,r),l=no(f.body);this.log.print(`fetching "/api/v2/canister/${u}/read_state" with request:`,f);const d=_u(this,uu,"f").call(this);try{const t=await _u(this,Qc,"m",yu).call(this,{request:()=>_u(this,nu,"f").call(this,""+new URL(`/api/v2/canister/${u.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},_u(this,iu,"f")),f.request),{body:l})),backoff:d,tries:0});if(!t.ok)throw new Error(`Server returned an error:\n  Code: ${t.status} (${t.statusText})\n  Body: ${await t.text()}\n`);const e=so(await t.arrayBuffer());this.log.print("Read state response:",e);const r=await this.parseTimeFromResponse(e);return r>0&&(this.log.print("Read state response time:",r),Eu(this,lu,r,"f")),e}catch(t){const e=`Caught exception while attempting to read state: ${null!==(i=t.message)&&void 0!==i?i:String(t)}`,r=new mo(e,t,String(c),Pe(null===(o=null==f?void 0:f.body)||void 0===o?void 0:o.sender_pubkey),Pe(null===(s=null==f?void 0:f.body)||void 0===s?void 0:s.sender_sig),String(null===(a=null==f?void 0:f.body)||void 0===a?void 0:a.content.ingress_expiry._value));throw this.log.error(e,r),r}}async parseTimeFromResponse(t){let e;if(t.certificate){const r=so(t.certificate);if(!r||!("tree"in r))throw new Error("Could not decode time from response");e=r.tree;const n=$a(["time"],e);if(n.status!==Da.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(n.value instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Time was not found in the response or was not in its expected format.");const i=Aa(je(n.value));return this.log.print("Time from response:",i),this.log.print("Time from response in milliseconds:",Number(i)),Number(i)}return this.log.warn("No certificate found in response"),0}async syncTime(t){await _u(this,Qc,"m",wu).call(this);const e=await Promise.resolve().then((function(){return Ja})),r=Date.now();try{t||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const n=Su.createSync({identity:new Si,host:this.host.toString(),fetch:_u(this,nu,"f"),retryTimes:0}),i=(await e.request({canisterId:null!=t?t:Re.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:n,paths:["time"]})).get("time");i&&(Eu(this,su,Number(i)-Number(r),"f"),this.log.notify({message:`Syncing time: offset of ${_u(this,su,"f")}`,level:"info"}))}catch(t){this.log.error("Caught exception while attempting to sync time",t)}}async status(){const t=_u(this,au,"f")?{Authorization:"Basic "+btoa(_u(this,au,"f"))}:{};this.log.print('fetching "/api/v2/status"');const e=_u(this,uu,"f").call(this),r=await _u(this,Qc,"m",yu).call(this,{backoff:e,request:()=>_u(this,nu,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:t},_u(this,iu,"f"))),tries:0});return so(await r.arrayBuffer())}async fetchRootKey(){let t;return _u(this,tu,"f")||Eu(this,tu,new Promise(((t,e)=>{this.status().then((e=>{const r=e.root_key;this.rootKey=r,t(r)})).catch(e)})),"f"),t=await _u(this,tu,"f"),Eu(this,tu,null,"f"),t}invalidateIdentity(){Eu(this,ru,null,"f")}replaceIdentity(t){Eu(this,ru,Promise.resolve(t),"f")}async fetchSubnetKeys(t){await _u(this,Qc,"m",wu).call(this);const e=Re.from(t),r=(await za({canisterId:e,paths:["subnet"],agent:this})).get("subnet");if(r&&"object"==typeof r&&"nodeKeys"in r)return _u(this,pu,"f").set(e.toText(),r),r}_transform(t){let e=Promise.resolve(t);if("call"===t.endpoint)for(const t of _u(this,hu,"f"))e=e.then((e=>t(e).then((t=>t||e))));else for(const t of _u(this,du,"f"))e=e.then((e=>t(e).then((t=>t||e))));return e}}var Tu;function Nu(){const t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!t)throw new Error("No Agent could be found.");return t}tu=new WeakMap,eu=new WeakMap,ru=new WeakMap,nu=new WeakMap,iu=new WeakMap,ou=new WeakMap,su=new WeakMap,au=new WeakMap,cu=new WeakMap,uu=new WeakMap,fu=new WeakMap,lu=new WeakMap,du=new WeakMap,hu=new WeakMap,pu=new WeakMap,gu=new WeakMap,mu=new WeakMap,Qc=new WeakSet,bu=async function t(e){var r,n;const{ecid:i,transformedRequest:o,body:s,requestId:a,backoff:c,tries:u}=e,f=0===u?0:c.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:u,backoff:c,delay:f}),null===f)throw new $e(`Timestamp failed to pass the watermark after retrying the configured ${_u(this,cu,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);let l;f>0&&await new Promise((t=>setTimeout(t,f)));try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,o);const t=await _u(this,nu,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},_u(this,iu,"f")),o.request),{body:s}));if(200!==t.status)throw new go(`Gateway returned an error:\n  Code: ${t.status} (${t.statusText})\n  Body: ${await t.text()}\n`,{ok:t.ok,status:t.status,statusText:t.statusText,headers:po(t.headers)});{const e=so(await t.arrayBuffer());l=Object.assign(Object.assign({},e),{httpDetails:{ok:t.ok,status:t.status,statusText:t.statusText,headers:po(t.headers)},requestId:a})}}catch(r){if(u<_u(this,cu,"f"))return this.log.warn(`Caught exception while attempting to make query:\n  ${r}\n  Retrying query.`),await _u(this,Qc,"m",t).call(this,Object.assign(Object.assign({},e),{tries:u+1}));throw r}const d=null===(n=null===(r=l.signatures)||void 0===r?void 0:r[0])||void 0===n?void 0:n.timestamp;if(!_u(this,gu,"f"))return l;if(!d)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const h=Number(BigInt(d)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:h}),Number(this.waterMark)>h){const r=new $e("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",r,{timestamp:d,waterMark:this.waterMark}),u<_u(this,cu,"f"))return await _u(this,Qc,"m",t).call(this,Object.assign(Object.assign({},e),{tries:u+1}));throw new $e(`Timestamp failed to pass the watermark after retrying the configured ${_u(this,cu,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return l},yu=async function t(e){const{request:r,backoff:n,tries:i}=e,o=0===i?0:n.next();if(null===o)throw new $e(`Timestamp failed to pass the watermark after retrying the configured ${_u(this,cu,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);let s;o>0&&await new Promise((t=>setTimeout(t,o)));try{s=await r()}catch(e){if(_u(this,cu,"f")>i)return this.log.warn(`Caught exception while attempting to make request:\n  ${e}\n  Retrying request.`),await _u(this,Qc,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw e}if(s.ok)return s;const a=await s.clone().text(),c=`Server returned an error:\n  Code: ${s.status} (${s.statusText})\n  Body: ${a}\n`;if(404===s.status&&s.url.includes("api/v3"))throw new go("v3 api not supported. Fall back to v2",{ok:s.ok,status:s.status,statusText:s.statusText,headers:po(s.headers)});if(i<_u(this,cu,"f"))return await _u(this,Qc,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw new go(c,{ok:s.ok,status:s.status,statusText:s.statusText,headers:po(s.headers)})},wu=async function(){if(!this.rootKey){if(null!==this.rootKey||!_u(this,eu,"f"))throw new $e(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${_u(this,eu,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`);await this.fetchRootKey()}},function(t){t.Error="err",t.GetPrincipal="gp",t.GetPrincipalResponse="gpr",t.Query="q",t.QueryResponse="qr",t.Call="c",t.CallResponse="cr",t.ReadState="rs",t.ReadStateResponse="rsr",t.Status="s",t.StatusResponse="sr"}(Tu||(Tu={}));const Ou=3e5;function Ru(){return function(...t){return async(e,r,n)=>{for(const i of t)await i(e,r,n)}}((t=function(){let t=!0;return async()=>!!t&&(t=!1,!0)}(),e=1e3,async(r,n,i)=>{if(await t(r,n,i))return new Promise((t=>setTimeout(t,e)))}),function(t,e){let r=t;return()=>new Promise((t=>setTimeout((()=>{r*=e,t()}),r)))}(1e3,1.2),function(t){const e=Date.now()+t;return async(r,n,i)=>{if(Date.now()>e)throw new Error(`Request timed out after ${t} msec:\n  Request ID: ${Pe(n)}\n  Request status: ${i}\n`)}}(Ou));var t,e}async function Uu(t,e,r,n=Ru(),i,o){var s;const a=[(new TextEncoder).encode("request_status"),r],c=null!=i?i:await(null===(s=t.createReadStateRequest)||void 0===s?void 0:s.call(t,{paths:[a]})),u=await t.readState(e,{paths:[a]},void 0,c);if(null==t.rootKey)throw new Error("Agent root key not initialized before polling");const f=await Ua.create({certificate:u.certificate,rootKey:t.rootKey,canisterId:e,blsVerify:o}),l=Fa(f.lookup([...a,(new TextEncoder).encode("status")]));let d;switch(d=void 0===l?vu.Unknown:(new TextDecoder).decode(l),d){case vu.Replied:return{reply:Fa(f.lookup([...a,"reply"])),certificate:f};case vu.Received:case vu.Unknown:case vu.Processing:return await n(e,r,d),Uu(t,e,r,n,c,o);case vu.Rejected:{const t=new Uint8Array(Fa(f.lookup([...a,"reject_code"])))[0],e=(new TextDecoder).decode(Fa(f.lookup([...a,"reject_message"])));throw new Error(`Call was rejected:\n  Request ID: ${Pe(r)}\n  Reject code: ${t}\n  Reject text: ${e}\n`)}case vu.Done:throw new Error(`Call was marked as done but we never saw the reply:\n  Request ID: ${Pe(r)}\n`)}throw new Error("unreachable")}var Pu=({IDL:t})=>{const e=t.Variant({mainnet:t.Null,testnet:t.Null}),r=t.Text,n=t.Record({network:e,address:r,min_confirmations:t.Opt(t.Nat32)}),i=t.Nat64,o=i,s=t.Nat32,a=t.Record({start_height:s,end_height:t.Opt(s),network:e}),c=t.Vec(t.Nat8),u=t.Record({tip_height:s,block_headers:t.Vec(c)}),f=t.Record({network:e}),l=t.Nat64,d=t.Vec(l),h=t.Record({network:e,filter:t.Opt(t.Variant({page:t.Vec(t.Nat8),min_confirmations:t.Nat32})),address:r}),p=t.Vec(t.Nat8),g=t.Record({txid:t.Vec(t.Nat8),vout:t.Nat32}),b=t.Record({height:t.Nat32,value:i,outpoint:g}),y=t.Record({next_page:t.Opt(t.Vec(t.Nat8)),tip_height:s,tip_block_hash:p,utxos:t.Vec(b)}),m=t.Record({transaction:t.Vec(t.Nat8),network:e}),w=t.Principal,v=t.Record({canister_id:w,num_requested_changes:t.Opt(t.Nat64)}),E=t.Variant({from_user:t.Record({user_id:t.Principal}),from_canister:t.Record({canister_version:t.Opt(t.Nat64),canister_id:t.Principal})}),_=t.Vec(t.Nat8),x=t.Variant({creation:t.Record({controllers:t.Vec(t.Principal)}),code_deployment:t.Record({mode:t.Variant({reinstall:t.Null,upgrade:t.Null,install:t.Null}),module_hash:t.Vec(t.Nat8)}),load_snapshot:t.Record({canister_version:t.Nat64,taken_at_timestamp:t.Nat64,snapshot_id:_}),controllers_change:t.Record({controllers:t.Vec(t.Principal)}),code_uninstall:t.Null}),B=t.Record({timestamp_nanos:t.Nat64,canister_version:t.Nat64,origin:E,details:x}),I=t.Record({controllers:t.Vec(t.Principal),module_hash:t.Opt(t.Vec(t.Nat8)),recent_changes:t.Vec(B),total_num_changes:t.Nat64}),A=t.Record({canister_id:w}),S=t.Variant({controllers:t.Null,public:t.Null,allowed_viewers:t.Vec(t.Principal)}),T=t.Record({freezing_threshold:t.Nat,controllers:t.Vec(t.Principal),reserved_cycles_limit:t.Nat,log_visibility:S,wasm_memory_limit:t.Nat,memory_allocation:t.Nat,compute_allocation:t.Nat}),N=t.Record({status:t.Variant({stopped:t.Null,stopping:t.Null,running:t.Null}),memory_size:t.Nat,cycles:t.Nat,settings:T,query_stats:t.Record({response_payload_bytes_total:t.Nat,num_instructions_total:t.Nat,num_calls_total:t.Nat,request_payload_bytes_total:t.Nat}),idle_cycles_burned_per_day:t.Nat,module_hash:t.Opt(t.Vec(t.Nat8)),reserved_cycles:t.Nat}),O=t.Record({canister_id:w}),R=t.Record({freezing_threshold:t.Opt(t.Nat),controllers:t.Opt(t.Vec(t.Principal)),reserved_cycles_limit:t.Opt(t.Nat),log_visibility:t.Opt(S),wasm_memory_limit:t.Opt(t.Nat),memory_allocation:t.Opt(t.Nat),compute_allocation:t.Opt(t.Nat)}),U=t.Record({settings:t.Opt(R),sender_canister_version:t.Opt(t.Nat64)}),P=t.Record({canister_id:w}),k=t.Record({canister_id:w}),F=t.Record({canister_id:w,snapshot_id:_}),L=t.Record({canister_id:w}),C=t.Variant({secp256k1:t.Null}),D=t.Record({key_id:t.Record({name:t.Text,curve:C}),canister_id:t.Opt(w),derivation_path:t.Vec(t.Vec(t.Nat8))}),j=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),$=t.Record({canister_id:w}),q=t.Record({idx:t.Nat64,timestamp_nanos:t.Nat64,content:t.Vec(t.Nat8)}),M=t.Record({canister_log_records:t.Vec(q)}),V=t.Record({value:t.Text,name:t.Text}),z=t.Record({status:t.Nat,body:t.Vec(t.Nat8),headers:t.Vec(V)}),G=t.Record({url:t.Text,method:t.Variant({get:t.Null,head:t.Null,post:t.Null}),max_response_bytes:t.Opt(t.Nat64),body:t.Opt(t.Vec(t.Nat8)),transform:t.Opt(t.Record({function:t.Func([t.Record({context:t.Vec(t.Nat8),response:z})],[z],["query"]),context:t.Vec(t.Nat8)})),headers:t.Vec(V)}),K=t.Variant({reinstall:t.Null,upgrade:t.Opt(t.Record({wasm_memory_persistence:t.Opt(t.Variant({keep:t.Null,replace:t.Null})),skip_pre_upgrade:t.Opt(t.Bool)})),install:t.Null}),H=t.Record({hash:t.Vec(t.Nat8)}),Z=t.Record({arg:t.Vec(t.Nat8),wasm_module_hash:t.Vec(t.Nat8),mode:K,chunk_hashes_list:t.Vec(H),target_canister:w,store_canister:t.Opt(w),sender_canister_version:t.Opt(t.Nat64)}),W=t.Vec(t.Nat8),Y=t.Record({arg:t.Vec(t.Nat8),wasm_module:W,mode:K,canister_id:w,sender_canister_version:t.Opt(t.Nat64)}),J=t.Record({canister_id:w}),X=t.Record({id:_,total_size:t.Nat64,taken_at_timestamp:t.Nat64}),Q=t.Vec(X),tt=t.Record({canister_id:w,sender_canister_version:t.Opt(t.Nat64),snapshot_id:_}),et=t.Record({start_at_timestamp_nanos:t.Nat64,subnet_id:t.Principal}),rt=t.Record({num_block_failures_total:t.Nat64,node_id:t.Principal,num_blocks_proposed_total:t.Nat64}),nt=t.Vec(t.Record({timestamp_nanos:t.Nat64,node_metrics:t.Vec(rt)})),it=t.Record({settings:t.Opt(R),specified_id:t.Opt(w),amount:t.Opt(t.Nat),sender_canister_version:t.Opt(t.Nat64)}),ot=t.Record({canister_id:w}),st=t.Record({canister_id:w,amount:t.Nat}),at=t.Vec(t.Nat8),ct=t.Variant({ed25519:t.Null,bip340secp256k1:t.Null}),ut=t.Record({key_id:t.Record({algorithm:ct,name:t.Text}),canister_id:t.Opt(w),derivation_path:t.Vec(t.Vec(t.Nat8))}),ft=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),lt=t.Record({key_id:t.Record({name:t.Text,curve:C}),derivation_path:t.Vec(t.Vec(t.Nat8)),message_hash:t.Vec(t.Nat8)}),dt=t.Record({signature:t.Vec(t.Nat8)}),ht=t.Variant({bip341:t.Record({merkle_root_hash:t.Vec(t.Nat8)})}),pt=t.Record({aux:t.Opt(ht),key_id:t.Record({algorithm:ct,name:t.Text}),derivation_path:t.Vec(t.Vec(t.Nat8)),message:t.Vec(t.Nat8)}),gt=t.Record({signature:t.Vec(t.Nat8)}),bt=t.Record({canister_id:w}),yt=t.Record({canister_id:w}),mt=t.Record({canister_id:w}),wt=t.Vec(H),vt=t.Record({subnet_id:t.Principal}),Et=t.Record({replica_version:t.Text}),_t=t.Record({replace_snapshot:t.Opt(_),canister_id:w}),xt=X,Bt=t.Record({canister_id:w,sender_canister_version:t.Opt(t.Nat64)}),It=t.Record({canister_id:t.Principal,settings:R,sender_canister_version:t.Opt(t.Nat64)}),At=t.Record({chunk:t.Vec(t.Nat8),canister_id:t.Principal}),St=H;return t.Service({bitcoin_get_balance:t.Func([n],[o],[]),bitcoin_get_block_headers:t.Func([a],[u],[]),bitcoin_get_current_fee_percentiles:t.Func([f],[d],[]),bitcoin_get_utxos:t.Func([h],[y],[]),bitcoin_send_transaction:t.Func([m],[],[]),canister_info:t.Func([v],[I],[]),canister_status:t.Func([A],[N],[]),clear_chunk_store:t.Func([O],[],[]),create_canister:t.Func([U],[P],[]),delete_canister:t.Func([k],[],[]),delete_canister_snapshot:t.Func([F],[],[]),deposit_cycles:t.Func([L],[],[]),ecdsa_public_key:t.Func([D],[j],[]),fetch_canister_logs:t.Func([$],[M],["query"]),http_request:t.Func([G],[z],[]),install_chunked_code:t.Func([Z],[],[]),install_code:t.Func([Y],[],[]),list_canister_snapshots:t.Func([J],[Q],[]),load_canister_snapshot:t.Func([tt],[],[]),node_metrics_history:t.Func([et],[nt],[]),provisional_create_canister_with_cycles:t.Func([it],[ot],[]),provisional_top_up_canister:t.Func([st],[],[]),raw_rand:t.Func([],[at],[]),schnorr_public_key:t.Func([ut],[ft],[]),sign_with_ecdsa:t.Func([lt],[dt],[]),sign_with_schnorr:t.Func([pt],[gt],[]),start_canister:t.Func([bt],[],[]),stop_canister:t.Func([yt],[],[]),stored_chunks:t.Func([mt],[wt],[]),subnet_info:t.Func([vt],[Et],[]),take_canister_snapshot:t.Func([_t],[xt],[]),uninstall_code:t.Func([Bt],[],[]),update_settings:t.Func([It],[],[]),upload_chunk:t.Func([At],[St],[])})};class ku extends $e{constructor(t,e,r,n){super(["Call failed:",`  Canister: ${t.toText()}`,`  Method: ${e} (${r})`,...Object.getOwnPropertyNames(n).map((t=>`  "${t}": ${JSON.stringify(n[t])}`))].join("\n")),this.canisterId=t,this.methodName=e,this.type=r,this.props=n}}class Fu extends ku{constructor(t,e,r){var n;super(t,e,"query",{Status:r.status,Code:null!==(n=Ut[r.reject_code])&&void 0!==n?n:`Unknown Code "${r.reject_code}"`,Message:r.reject_message}),this.result=r}}class Lu extends ku{constructor(t,e,r,n,i,o,s){super(t,e,"update",Object.assign({"Request ID":Pe(r)},n.body?Object.assign(Object.assign({},s?{"Error code":s}:{}),{"Reject code":String(i),"Reject message":o}):{"HTTP status code":n.status.toString(),"HTTP status text":n.statusText})),this.requestId=r,this.response=n,this.reject_code=i,this.reject_message=o,this.error_code=s}}const Cu=Symbol.for("ic-agent-metadata");class Du{constructor(t){this[Cu]=Object.freeze(t)}static agentOf(t){return t[Cu].config.agent}static interfaceOf(t){return t[Cu].service}static canisterIdOf(t){return Re.from(t[Cu].config.canisterId)}static async install(t,e){const r=void 0===t.mode?{install:null}:t.mode,n=t.arg?[...new Uint8Array(t.arg)]:[],i=[...new Uint8Array(t.module)],o="string"==typeof e.canisterId?Re.fromText(e.canisterId):e.canisterId;await zu(e).install_code({mode:r,arg:n,wasm_module:i,canister_id:o,sender_canister_version:[]})}static async createCanister(t,e){const{canister_id:r}=await zu(t||{}).provisional_create_canister_with_cycles({amount:[],settings:function(t){return[{controllers:t.controllers?[t.controllers]:[],compute_allocation:t.compute_allocation?[t.compute_allocation]:[],freezing_threshold:t.freezing_threshold?[t.freezing_threshold]:[],memory_allocation:t.memory_allocation?[t.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}(e||{}),specified_id:[],sender_canister_version:[]});return r}static async createAndInstallCanister(t,e,r){const n=await this.createCanister(r);return await this.install(Object.assign({},e),Object.assign(Object.assign({},r),{canisterId:n})),this.createActor(t,Object.assign(Object.assign({},r),{canisterId:n}))}static createActorClass(t,e){const r=t({IDL:sn});return class extends Du{constructor(t){if(!t.canisterId)throw new $e(`Canister ID is required, but received ${typeof t.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const n="string"==typeof t.canisterId?Re.fromText(t.canisterId):t.canisterId;super({config:Object.assign(Object.assign(Object.assign({},$u),t),{canisterId:n}),service:r});for(const[n,i]of r._fields)(null==e?void 0:e.httpDetails)&&i.annotations.push(qu),(null==e?void 0:e.certificate)&&i.annotations.push(Mu),this[n]=Vu(this,n,i,t.blsVerify)}}}static createActor(t,e){if(!e.canisterId)throw new $e(`Canister ID is required, but received ${typeof e.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(t))(e)}static createActorWithHttpDetails(t,e){return new(this.createActorClass(t,{httpDetails:!0}))(e)}static createActorWithExtendedDetails(t,e,r={httpDetails:!0,certificate:!0}){return new(this.createActorClass(t,r))(e)}}function ju(t,e){const r=Rr(t,xt.Buffer.from(e));switch(r.length){case 0:return;case 1:return r[0];default:return r}}const $u={pollingStrategyFactory:Ru},qu="http-details",Mu="certificate";function Vu(t,e,r,n){let i;i=r.annotations.includes("query")||r.annotations.includes("composite_query")?async(n,...i)=>{var o,s;const a=(n=Object.assign(Object.assign({},n),null===(s=(o=t[Cu].config).queryTransform)||void 0===s?void 0:s.call(o,e,i,Object.assign(Object.assign({},t[Cu].config),n)))).agent||t[Cu].config.agent||Nu(),c=Re.from(n.canisterId||t[Cu].config.canisterId),u=Or(r.argTypes,i),f=await a.query(c,{methodName:e,arg:u,effectiveCanisterId:n.effectiveCanisterId}),l=Object.assign(Object.assign({},f.httpDetails),{requestDetails:f.requestDetails});switch(f.status){case"rejected":throw new Fu(c,e,f);case"replied":return r.annotations.includes(qu)?{httpDetails:l,result:ju(r.retTypes,f.reply.arg)}:ju(r.retTypes,f.reply.arg)}}:async(i,...o)=>{var s,a;const c=(i=Object.assign(Object.assign({},i),null===(a=(s=t[Cu].config).callTransform)||void 0===a?void 0:a.call(s,e,o,Object.assign(Object.assign({},t[Cu].config),i)))).agent||t[Cu].config.agent||Nu(),{canisterId:u,effectiveCanisterId:f,pollingStrategyFactory:l}=Object.assign(Object.assign(Object.assign({},$u),t[Cu].config),i),d=Re.from(u),h=void 0!==f?Re.from(f):d,p=Or(r.argTypes,o),{requestId:g,response:b,requestDetails:y}=await c.call(d,{methodName:e,arg:p,effectiveCanisterId:h});let m,w;if(b.body&&b.body.certificate){if(null==c.rootKey)throw new Error("Agent is missing root key");const t=b.body.certificate;w=await Ua.create({certificate:ze(t),rootKey:c.rootKey,canisterId:Re.from(u),blsVerify:n});const r=[(new TextEncoder).encode("request_status"),g];switch((new TextDecoder).decode(Fa(w.lookup([...r,"status"])))){case"replied":m=Fa(w.lookup([...r,"reply"]));break;case"rejected":{const t=new Uint8Array(Fa(w.lookup([...r,"reject_code"])))[0],n=(new TextDecoder).decode(Fa(w.lookup([...r,"reject_message"]))),i=Fa(w.lookup([...r,"error_code"])),o=i?(new TextDecoder).decode(i):void 0;throw new Lu(d,e,g,b,t,n,o)}}}else if(b.body&&"reject_message"in b.body){const{reject_code:t,reject_message:r,error_code:n}=b.body;throw new Lu(d,e,g,b,t,r,n)}if(202===b.status){const t=l(),e=await Uu(c,h,g,t,n);w=e.certificate,m=e.reply}const v=r.annotations.includes(qu),E=r.annotations.includes(Mu),_=Object.assign(Object.assign({},b),{requestDetails:y});if(void 0!==m)return v&&E?{httpDetails:_,certificate:w,result:ju(r.retTypes,m)}:E?{certificate:w,result:ju(r.retTypes,m)}:v?{httpDetails:_,result:ju(r.retTypes,m)}:ju(r.retTypes,m);if(0===r.retTypes.length)return v?{httpDetails:b,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${r.retTypes.join(",")}].`)};const o=(...t)=>i({},...t);return o.withOptions=t=>(...e)=>i(t,...e),o}function zu(t){function e(e,r){if(t.effectiveCanisterId)return{effectiveCanisterId:Re.from(t.effectiveCanisterId)};const n=r[0];let i=Re.fromHex("");return n&&"object"==typeof n&&n.target_canister&&"install_chunked_code"===e&&(i=Re.from(n.target_canister)),n&&"object"==typeof n&&n.canister_id&&(i=Re.from(n.canister_id)),{effectiveCanisterId:i}}return Du.createActor(Pu,Object.assign(Object.assign(Object.assign({},t),{canisterId:Re.fromHex("")}),{callTransform:e,queryTransform:e}))}const Gu=({IDL:t})=>{const e=t.Record({id:t.Nat,passport_id:t.Nat,owner:t.Text,memory_type:t.Text,encrypted_content:t.Text,created_at:t.Nat64,importance_score:t.Nat8}),r=t.Record({id:t.Nat,capabilities:t.Vec(t.Text),owner:t.Text,encrypted_specifications:t.Text,created_at:t.Nat64,api_endpoints:t.Vec(t.Text),last_active:t.Nat64,agent_name:t.Text,agent_type:t.Text,is_active:t.Bool}),n=t.Record({id:t.Nat,encrypted_text:t.Text,owner:t.Text,users:t.Vec(t.Text)});return t.Service({add_agent_memory:t.Func([t.Nat,t.Text,t.Text,t.Nat8],[t.Nat],[]),add_user:t.Func([t.Nat,t.Text],[],[]),create_agent_passport:t.Func([t.Text,t.Text,t.Vec(t.Text),t.Text],[t.Nat],[]),create_note:t.Func([],[t.Nat],[]),delete_note:t.Func([t.Nat],[],[]),encrypted_symmetric_key_for_note:t.Func([t.Nat,t.Vec(t.Nat8)],[t.Text],[]),get_agent_memories:t.Func([t.Nat,t.Opt(t.Text)],[t.Vec(e)],[]),get_agent_passport:t.Func([t.Nat],[t.Opt(r)],[]),get_my_passports:t.Func([],[t.Vec(r)],[]),get_notes:t.Func([],[t.Vec(n)],[]),remove_user:t.Func([t.Nat,t.Text],[],[]),symmetric_key_verification_key_for_note:t.Func([],[t.Text],[]),update_agent_specifications:t.Func([t.Nat,t.Text],[],[]),update_note:t.Func([t.Nat,t.Text],[],[]),whoami:t.Func([],[t.Text],[])})};function Ku(t){const e=process.env.CANISTER_ID_ENCRYPTED_NOTES||"uxrrr-q7777-77774-qaaaq-cai",r={host:"ic"===process.env.DFX_NETWORK?`https://${e}.ic0.app`:"http://localhost:8000"};t?t.agentOptions?t.agentOptions.host=r.host:t.agentOptions=r:t={agentOptions:r};const n=new Su(Object.assign({},t.agentOptions));return"production"!==process.env.NODE_ENV&&(console.log("Dev environment - fetching root key..."),n.fetchRootKey().catch((t=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(t)}))),Du.createActor(Gu,Object.assign({agent:n,canisterId:e},null==t?void 0:t.actorOptions))}var Hu,Zu,Wu,Yu,Ju=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},Xu=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};function Qu(t){return null!==t&&"object"==typeof t}class tf{constructor(t){if(Hu.set(this,void 0),Zu.set(this,void 0),t.byteLength!==tf.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Ju(this,Hu,je(t),"f"),Ju(this,Zu,tf.derEncode(t),"f")}static from(t){if("string"==typeof t){const e=Fe(t);return this.fromRaw(e)}if(Qu(t)){const e=t;if(Qu(e)&&Object.hasOwnProperty.call(e,"__derEncodedPublicKey__"))return this.fromDer(e);if(ArrayBuffer.isView(e)){const t=e;return this.fromRaw(je(t.buffer))}if(e instanceof ArrayBuffer)return this.fromRaw(e);if("rawKey"in e)return this.fromRaw(e.rawKey);if("derKey"in e)return this.fromDer(e.derKey);if("toDer"in e)return this.fromDer(e.toDer())}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(t){return new tf(t)}static fromDer(t){return new tf(this.derDecode(t))}static derEncode(t){const e=Ac(t,Ic).buffer;return e.__derEncodedPublicKey__=void 0,e}static derDecode(t){const e=Sc(t,Ic);if(e.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return je(e)}get rawKey(){return Xu(this,Hu,"f")}get derKey(){return Xu(this,Zu,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}Hu=new WeakMap,Zu=new WeakMap,tf.RAW_KEY_LENGTH=32;class ef extends Ai{constructor(t,e){super(),Wu.set(this,void 0),Yu.set(this,void 0),Ju(this,Wu,tf.from(t),"f"),Ju(this,Yu,new Uint8Array(e),"f")}static generate(t){if(t&&32!==t.length)throw new Error("Ed25519 Seed needs to be 32 bytes long.");t||(t=pc.utils.randomPrivateKey()),Ce(t,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const e=new Uint8Array(32);for(let r=0;r<32;r++)e[r]=new Uint8Array(t)[r];const r=pc.getPublicKey(e);return ef.fromKeyPair(r,e)}static fromParsedJson(t){const[e,r]=t;return new ef(tf.fromDer(Fe(e)),Fe(r))}static fromJSON(t){const e=JSON.parse(t);if(Array.isArray(e)){if("string"==typeof e[0]&&"string"==typeof e[1])return this.fromParsedJson([e[0],e[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(t)}`)}static fromKeyPair(t,e){return new ef(tf.fromRaw(t),e)}static fromSecretKey(t){const e=pc.getPublicKey(new Uint8Array(t));return ef.fromKeyPair(e,t)}toJSON(){return[Pe(Xu(this,Wu,"f").toDer()),Pe(Xu(this,Yu,"f"))]}getKeyPair(){return{secretKey:Xu(this,Yu,"f"),publicKey:Xu(this,Wu,"f")}}getPublicKey(){return Xu(this,Wu,"f")}async sign(t){const e=new Uint8Array(t),r=De(pc.sign(e,Xu(this,Yu,"f").slice(0,32)));return Object.defineProperty(r,"__signature__",{enumerable:!1,value:void 0}),r}static verify(t,e,r){const[n,i,o]=[t,e,r].map((t=>("string"==typeof t&&(t=Fe(t)),t instanceof Uint8Array&&(t=je(t.buffer)),new Uint8Array(t))));return pc.verify(n,i,o)}}Wu=new WeakMap,Yu=new WeakMap;class rf extends Error{constructor(t){super(t),this.message=t,Object.setPrototypeOf(this,rf.prototype)}}function nf(t){if("undefined"!=typeof global&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(t)return t;if("undefined"!=typeof crypto&&crypto.subtle)return crypto.subtle;throw new rf("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class of extends Ai{constructor(t,e,r){super(),this._keyPair=t,this._derKey=e,this._subtleCrypto=r}static async generate(t){const{extractable:e=!1,keyUsages:r=["sign","verify"],subtleCrypto:n}=null!=t?t:{},i=nf(n),o=await i.generateKey({name:"ECDSA",namedCurve:"P-256"},e,r);return new this(o,await i.exportKey("spki",o.publicKey),i)}static async fromKeyPair(t,e){const r=nf(e),n=await r.exportKey("spki",t.publicKey);return new of(t,n,r)}getKeyPair(){return this._keyPair}getPublicKey(){const t=this._derKey,e=Object.create(this._keyPair.publicKey);return e.toDer=function(){return t},e}async sign(t){return await this._subtleCrypto.sign({name:"ECDSA",hash:{name:"SHA-256"}},this._keyPair.privateKey,t)}}var sf,af=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},cf=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class uf{constructor(t){sf.set(this,void 0),af(this,sf,t,"f")}get rawKey(){return cf(this,sf,"f").rawKey}get derKey(){return cf(this,sf,"f").derKey}toDer(){return cf(this,sf,"f").toDer()}getPublicKey(){return cf(this,sf,"f")}getPrincipal(){if(!cf(this,sf,"f").rawKey)throw new Error("Cannot get principal from a public key without a raw key.");return Re.fromUint8Array(new Uint8Array(cf(this,sf,"f").rawKey))}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}sf=new WeakMap;var ff,lf=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},df=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)},hf=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r};const pf=(new TextEncoder).encode("ic-request-auth-delegation"),gf=(new TextEncoder).encode("\nic-request");function bf(t){if("string"!=typeof t||t.length<64)throw new Error("Invalid public key.");return Fe(t)}class yf{constructor(t,e,r){this.pubkey=t,this.expiration=e,this.targets=r}toCBOR(){return Ti.value.map(Object.assign({pubkey:Ti.value.bytes(this.pubkey),expiration:Ti.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:Ti.value.array(this.targets.map((t=>Ti.value.bytes(ze(t.toUint8Array())))))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:Pe(this.pubkey)},this.targets&&{targets:this.targets.map((t=>t.toHex()))})}}class mf{constructor(t,e){this.delegations=t,this.publicKey=e}static async create(t,e,r=new Date(Date.now()+9e5),n={}){var i,o;const s=await async function(t,e,r,n){const i=new yf(e.toDer(),BigInt(+r)*BigInt(1e6),n),o=new Uint8Array([...pf,...new Uint8Array(_i(Object.assign({},i)))]);return{delegation:i,signature:await t.sign(ze(o))}}(t,e,r,n.targets);return new mf([...(null===(i=n.previous)||void 0===i?void 0:i.delegations)||[],s],(null===(o=n.previous)||void 0===o?void 0:o.publicKey)||t.getPublicKey().toDer())}static fromJSON(t){const{publicKey:e,delegations:r}="string"==typeof t?JSON.parse(t):t;if(!Array.isArray(r))throw new Error("Invalid delegations.");return new this(r.map((t=>{const{delegation:e,signature:r}=t,{pubkey:n,expiration:i,targets:o}=e;if(void 0!==o&&!Array.isArray(o))throw new Error("Invalid targets.");return{delegation:new yf(bf(n),BigInt("0x"+i),o&&o.map((t=>{if("string"!=typeof t)throw new Error("Invalid target.");return Re.fromHex(t)}))),signature:bf(r)}})),bf(e))}static fromDelegations(t,e){return new this(t,e)}toJSON(){return{delegations:this.delegations.map((t=>{const{delegation:e,signature:r}=t,{targets:n}=e;return{delegation:Object.assign({expiration:e.expiration.toString(16),pubkey:Pe(e.pubkey)},n&&{targets:n.map((t=>t.toHex()))}),signature:Pe(r)}})),publicKey:Pe(this.publicKey)}}}class wf extends Ai{constructor(t,e){super(),this._inner=t,this._delegation=e}static fromDelegation(t,e){return new this(t,e)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(t){return this._inner.sign(t)}async transformRequest(t){const{body:e}=t,r=hf(t,["body"]),n=await _i(e);return Object.assign(Object.assign({},r),{body:{content:e,sender_sig:await this.sign(ze(new Uint8Array([...gf,...new Uint8Array(n)]))),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class vf extends uf{constructor(t,e){super(t),ff.set(this,void 0),lf(this,ff,e,"f")}get delegation(){return df(this,ff,"f")}static fromDelegation(t,e){return new vf(t,e)}}var Ef;ff=new WeakMap,function(t){t[t.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"}(Ef||(Ef={}));const _f=["mousedown","mousemove","keydown","touchstart","wheel"];class xf{constructor(t={}){var e;this.callbacks=[],this.idleTimeout=6e5,this.timeoutID=void 0;const{onIdle:r,idleTimeout:n=6e5}=t||{};this.callbacks=r?[r]:[],this.idleTimeout=n;const i=this._resetTimer.bind(this);window.addEventListener("load",i,!0),_f.forEach((function(t){document.addEventListener(t,i,!0)}));const o=(t,e)=>{let r;return(...n)=>{const i=this;clearTimeout(r),r=window.setTimeout((function(){r=void 0,t.apply(i,n)}),e)}};if(null==t?void 0:t.captureScroll){const r=o(i,null!==(e=null==t?void 0:t.scrollDebounce)&&void 0!==e?e:100);window.addEventListener("scroll",r,!0)}i()}static create(t={}){return new this(t)}registerCallback(t){this.callbacks.push(t)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const t=this._resetTimer.bind(this);_f.forEach((function(e){document.removeEventListener(e,t,!0)})),this.callbacks.forEach((t=>t()))}_resetTimer(){const t=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(t,this.idleTimeout)}}const Bf=(t,e)=>e.some((e=>t instanceof e));let If,Af;const Sf=new WeakMap,Tf=new WeakMap,Nf=new WeakMap,Of=new WeakMap,Rf=new WeakMap;let Uf={get(t,e,r){if(t instanceof IDBTransaction){if("done"===e)return Tf.get(t);if("objectStoreNames"===e)return t.objectStoreNames||Nf.get(t);if("store"===e)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ff(t[e])},set:(t,e,r)=>(t[e]=r,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function Pf(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Af||(Af=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Lf(this),e),Ff(Sf.get(this))}:function(...e){return Ff(t.apply(Lf(this),e))}:function(e,...r){const n=t.call(Lf(this),e,...r);return Nf.set(n,e.sort?e.sort():[e]),Ff(n)}}function kf(t){return"function"==typeof t?Pf(t):(t instanceof IDBTransaction&&function(t){if(Tf.has(t))return;const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{e(),n()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)}));Tf.set(t,e)}(t),Bf(t,If||(If=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,Uf):t)}function Ff(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{e(Ff(t.result)),n()},o=()=>{r(t.error),n()};t.addEventListener("success",i),t.addEventListener("error",o)}));return e.then((e=>{e instanceof IDBCursor&&Sf.set(e,t)})).catch((()=>{})),Rf.set(e,t),e}(t);if(Of.has(t))return Of.get(t);const e=kf(t);return e!==t&&(Of.set(t,e),Rf.set(e,t)),e}const Lf=t=>Rf.get(t);const Cf=["get","getKey","getAll","getAllKeys","count"],Df=["put","add","delete","clear"],jf=new Map;function $f(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(jf.get(e))return jf.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=Df.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!Cf.includes(r))return;const o=async function(t,...e){const o=this.transaction(t,i?"readwrite":"readonly");let s=o.store;return n&&(s=s.index(e.shift())),(await Promise.all([s[r](...e),i&&o.done]))[0]};return jf.set(e,o),o}Uf=(t=>({...t,get:(e,r,n)=>$f(e,r)||t.get(e,r,n),has:(e,r)=>!!$f(e,r)||t.has(e,r)}))(Uf);const qf="auth-client-db",Mf="ic-keyval",Vf=async(t=qf,e=Mf,r)=>(Jf&&(null===localStorage||void 0===localStorage?void 0:localStorage.getItem(Wf))&&(localStorage.removeItem(Wf),localStorage.removeItem(Zf)),await function(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),a=Ff(s);return n&&s.addEventListener("upgradeneeded",(t=>{n(Ff(s.result),t.oldVersion,t.newVersion,Ff(s.transaction),t)})),r&&s.addEventListener("blocked",(t=>r(t.oldVersion,t.newVersion,t))),a.then((t=>{o&&t.addEventListener("close",(()=>o())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(t,r,{upgrade:t=>{t.objectStoreNames.contains(e)&&t.clear(e),t.createObjectStore(e)}}));class zf{constructor(t,e){this._db=t,this._storeName=e}static async create(t){const{dbName:e=qf,storeName:r=Mf,version:n=Yf}=null!=t?t:{},i=await Vf(e,r,n);return new zf(i,r)}async set(t,e){return await async function(t,e,r,n){return await t.put(e,n,r)}(this._db,this._storeName,t,e)}async get(t){var e;return null!==(e=await async function(t,e,r){return await t.get(e,r)}(this._db,this._storeName,t))&&void 0!==e?e:null}async remove(t){return await async function(t,e,r){return await t.delete(e,r)}(this._db,this._storeName,t)}}var Gf,Kf=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},Hf=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};const Zf="identity",Wf="delegation",Yf=1,Jf="undefined"!=typeof window;class Xf{constructor(t="ic-",e){this.prefix=t,this._localStorage=e}get(t){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+t))}set(t,e){return this._getLocalStorage().setItem(this.prefix+t,e),Promise.resolve()}remove(t){return this._getLocalStorage().removeItem(this.prefix+t),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?void 0:self.localStorage:global.localStorage:window.localStorage;if(!t)throw new Error("Could not find local storage.");return t}}class Qf{constructor(t){Gf.set(this,void 0),Kf(this,Gf,null!=t?t:{},"f")}get _db(){return new Promise((t=>{this.initializedDb?t(this.initializedDb):zf.create(Hf(this,Gf,"f")).then((e=>{this.initializedDb=e,t(e)}))}))}async get(t){const e=await this._db;return await e.get(t)}async set(t,e){const r=await this._db;await r.set(t,e)}async remove(t){const e=await this._db;await e.remove(t)}}Gf=new WeakMap;const tl="ECDSA",el="Ed25519";class rl{constructor(t,e,r,n,i,o,s,a){this._identity=t,this._key=e,this._chain=r,this._storage=n,this.idleManager=i,this._createOptions=o,this._idpWindow=s,this._eventHandler=a,this._registerDefaultIdleCallback()}static async create(t={}){var e,r,n;const i=null!==(e=t.storage)&&void 0!==e?e:new Qf,o=null!==(r=t.keyType)&&void 0!==r?r:tl;let s=null;if(t.identity)s=t.identity;else{let t=await i.get(Zf);if(!t&&Jf)try{const e=new Xf,r=await e.get(Wf),n=await e.get(Zf);r&&n&&o===tl&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await i.set(Wf,r),await i.set(Zf,n),t=r,await e.remove(Wf),await e.remove(Zf))}catch(t){console.error("error while attempting to recover localstorage: "+t)}if(t)try{"object"==typeof t?s=o===el&&"string"==typeof t?await ef.fromJSON(t):await of.fromKeyPair(t):"string"==typeof t&&(s=ef.fromJSON(t))}catch(t){}}let a,c=new Si,u=null;if(s)try{const e=await i.get(Wf);if("object"==typeof e&&null!==e)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");t.identity?c=t.identity:e&&(u=mf.fromJSON(e),!function(t,e){for(const{delegation:e}of t.delegations)if(+new Date(Number(e.expiration/BigInt(1e6)))<=+Date.now())return!1;const r=[],n=null==e?void 0:e.scope;n&&(Array.isArray(n)?r.push(...n.map((t=>"string"==typeof t?Re.fromText(t):t))):r.push("string"==typeof n?Re.fromText(n):n));for(const e of r){const r=e.toText();for(const{delegation:e}of t.delegations){if(void 0===e.targets)continue;let t=!0;for(const n of e.targets)if(n.toText()===r){t=!1;break}if(t)return!1}}return!0}(u)?(await nl(i),s=null):c="toDer"in s?vf.fromDelegation(s,u):wf.fromDelegation(s,u))}catch(t){console.error(t),await nl(i),s=null}return(null===(n=t.idleOptions)||void 0===n?void 0:n.disableIdle)?a=void 0:(u||t.identity)&&(a=xf.create(t.idleOptions)),s||(o===el?(s=await ef.generate(),await i.set(Zf,JSON.stringify(s.toJSON()))):(t.storage&&o===tl&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${el}' as the key type, as it can serialize to a string`),s=await of.generate(),await i.set(Zf,s.getKeyPair()))),new this(c,s,u,i,a,t)}_registerDefaultIdleCallback(){var t,e;const r=null===(t=this._createOptions)||void 0===t?void 0:t.idleOptions;(null==r?void 0:r.onIdle)||(null==r?void 0:r.disableDefaultIdleCallback)||null===(e=this.idleManager)||void 0===e||e.registerCallback((()=>{this.logout(),location.reload()}))}async _handleSuccess(t,e){var r,n;const i=t.delegations.map((t=>({delegation:new yf(t.delegation.pubkey,t.delegation.expiration,t.delegation.targets),signature:t.signature.buffer}))),o=mf.fromDelegations(i,t.userPublicKey.buffer),s=this._key;if(!s)return;this._chain=o,this._identity="toDer"in s?vf.fromDelegation(s,this._chain):wf.fromDelegation(s,this._chain),null===(r=this._idpWindow)||void 0===r||r.close();const a=null===(n=this._createOptions)||void 0===n?void 0:n.idleOptions;this.idleManager||(null==a?void 0:a.disableIdle)||(this.idleManager=xf.create(a),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(Wf,JSON.stringify(this._chain.toJSON())),null==e||e(t)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&null!==this._chain}async login(t){var e,r,n,i;const o=BigInt(8)*BigInt(36e11),s=new URL((null===(e=null==t?void 0:t.identityProvider)||void 0===e?void 0:e.toString())||"https://identity.internetcomputer.org");s.hash="#authorize",null===(r=this._idpWindow)||void 0===r||r.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(s,Object.assign({maxTimeToLive:null!==(n=null==t?void 0:t.maxTimeToLive)&&void 0!==n?n:o},t)),window.addEventListener("message",this._eventHandler),this._idpWindow=null!==(i=window.open(s.toString(),"idpWindow",null==t?void 0:t.windowOpenerFeatures))&&void 0!==i?i:void 0;const a=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure("UserInterrupt",null==t?void 0:t.onError):setTimeout(a,500))};a()}_getEventHandler(t,e){return async r=>{var n,i,o;if(r.origin!==t.origin)return;const s=r.data;switch(s.kind){case"authorize-ready":{const r=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array(null===(n=this._key)||void 0===n?void 0:n.getPublicKey().toDer()),maxTimeToLive:null==e?void 0:e.maxTimeToLive,allowPinAuthentication:null==e?void 0:e.allowPinAuthentication,derivationOrigin:null===(i=null==e?void 0:e.derivationOrigin)||void 0===i?void 0:i.toString()},null==e?void 0:e.customValues);null===(o=this._idpWindow)||void 0===o||o.postMessage(r,t.origin);break}case"authorize-client-success":try{await this._handleSuccess(s,null==e?void 0:e.onSuccess)}catch(t){this._handleFailure(t.message,null==e?void 0:e.onError)}break;case"authorize-client-failure":this._handleFailure(s.text,null==e?void 0:e.onError)}}}_handleFailure(t,e){var r;null===(r=this._idpWindow)||void 0===r||r.close(),null==e||e(t),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(t={}){if(await nl(this._storage),this._identity=new Si,this._chain=null,t.returnTo)try{window.history.pushState({},"",t.returnTo)}catch(e){window.location.href=t.returnTo}}}async function nl(t){await t.remove(Zf),await t.remove(Wf),await t.remove("iv")}function il(t){return new Promise(((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)}))}let ol;function sl(){return ol||(ol=function(t,e){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(e);const n=il(r);return(t,r)=>n.then((n=>r(n.transaction(e,t).objectStore(e))))}("keyval-store","keyval")),ol}function al(t,e=sl()){return e("readonly",(e=>il(e.get(t))))}const cl="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ul(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function fl(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function ll(t,...e){if(!ul(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function dl(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.createHasher");fl(t.outputLen),fl(t.blockLen)}function hl(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function pl(t,e){ll(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function gl(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function bl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function yl(t,e){return t<<32-e|t>>>e}function ml(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const wl=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]?t=>t:function(t){for(let e=0;e<t.length;e++)t[e]=ml(t[e]);return t},vl="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,El=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function _l(t){if(ll(t),vl)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=El[t[r]];return e}const xl={_0:48,_9:57,A:65,F:70,a:97,f:102};function Bl(t){return t>=xl._0&&t<=xl._9?t-xl._0:t>=xl.A&&t<=xl.F?t-(xl.A-10):t>=xl.a&&t<=xl.f?t-(xl.a-10):void 0}function Il(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);if(vl)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){const r=Bl(t.charCodeAt(i)),o=Bl(t.charCodeAt(i+1));if(void 0===r||void 0===o){const e=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+i)}n[e]=16*r+o}return n}function Al(t){if("string"!=typeof t)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}function Sl(t){return"string"==typeof t&&(t=Al(t)),ll(t),t}function Tl(...t){let e=0;for(let r=0;r<t.length;r++){const n=t[r];ll(n),e+=n.length}const r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}class Nl{}function Ol(t){const e=e=>t().update(Sl(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Rl(t=32){if(cl&&"function"==typeof cl.getRandomValues)return cl.getRandomValues(new Uint8Array(t));if(cl&&"function"==typeof cl.randomBytes)return Uint8Array.from(cl.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function Ul(t,e,r){return t&e^~t&r}function Pl(t,e,r){return t&e^t&r^e&r}class kl extends Nl{constructor(t,e,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(t),this.view=bl(this.buffer)}update(t){hl(this),ll(t=Sl(t));const{view:e,buffer:r,blockLen:n}=this,i=t.length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s!==n)r.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=bl(t);for(;n<=i-o;o+=n)this.process(e,o)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){hl(this),pl(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;e[o++]=128,gl(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(r,0),o=0);for(let t=o;t<n;t++)e[t]=0;(function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,u=n?0:4;t.setUint32(e+c,s,n),t.setUint32(e+u,a,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=bl(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return t.destroyed=o,t.finished=i,t.length=n,t.pos=s,n%e&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const Fl=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ll=BigInt(2**32-1),Cl=BigInt(32);function Dl(t,e=!1){return e?{h:Number(t&Ll),l:Number(t>>Cl&Ll)}:{h:0|Number(t>>Cl&Ll),l:0|Number(t&Ll)}}function jl(t,e=!1){const r=t.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let o=0;o<r;o++){const{h:r,l:s}=Dl(t[o],e);[n[o],i[o]]=[r,s]}return[n,i]}const $l=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ql=new Uint32Array(64);class Ml extends kl{constructor(t=32){super(64,t,8,!1),this.A=0|Fl[0],this.B=0|Fl[1],this.C=0|Fl[2],this.D=0|Fl[3],this.E=0|Fl[4],this.F=0|Fl[5],this.G=0|Fl[6],this.H=0|Fl[7]}get(){const{A:t,B:e,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[t,e,r,n,i,o,s,a]}set(t,e,r,n,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)ql[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=ql[t-15],r=ql[t-2],n=yl(e,7)^yl(e,18)^e>>>3,i=yl(r,17)^yl(r,19)^r>>>10;ql[t]=i+ql[t-7]+n+ql[t-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(yl(s,6)^yl(s,11)^yl(s,25))+Ul(s,a,c)+$l[t]+ql[t]|0,f=(yl(r,2)^yl(r,13)^yl(r,22))+Pl(r,n,i)|0;u=c,c=a,a=s,s=o+e|0,o=i,i=n,n=r,r=e+f|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,o,s,a,c,u)}roundClean(){gl(ql)}destroy(){this.set(0,0,0,0,0,0,0,0),gl(this.buffer)}}jl(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t))));const Vl=Ol((()=>new Ml)),zl=BigInt(0),Gl=BigInt(1);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Kl(t,e){if("boolean"!=typeof e)throw new Error(t+" boolean expected, got "+e)}function Hl(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return""===t?zl:BigInt("0x"+t)}function Zl(t){return Hl(_l(t))}function Wl(t){return ll(t),Hl(_l(Uint8Array.from(t).reverse()))}function Yl(t,e){return Il(t.toString(16).padStart(2*e,"0"))}function Jl(t,e){return Yl(t,e).reverse()}function Xl(t,e,r){let n;if("string"==typeof e)try{n=Il(e)}catch(e){throw new Error(t+" must be hex string or Uint8Array, cause: "+e)}else{if(!ul(e))throw new Error(t+" must be hex string or Uint8Array");n=Uint8Array.from(e)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}const Ql=t=>"bigint"==typeof t&&zl<=t;function td(t){let e;for(e=0;t>zl;t>>=Gl,e+=1);return e}function ed(t,e){return t>>BigInt(e)&Gl}const rd=t=>(Gl<<BigInt(t))-Gl;function nd(t,e,r={}){if(!t||"object"!=typeof t)throw new Error("expected valid options object");function n(e,r,n){const i=t[e];if(n&&void 0===i)return;const o=typeof i;if(o!==r||null===i)throw new Error(`param "${e}" is invalid: expected ${r}, got ${o}`)}Object.entries(e).forEach((([t,e])=>n(t,e,!1))),Object.entries(r).forEach((([t,e])=>n(t,e,!0)))}const id=()=>{throw new Error("not implemented")};function od(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(void 0!==i)return i;const o=t(r,...n);return e.set(r,o),o}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const sd=BigInt(0),ad=BigInt(1),cd=BigInt(2),ud=BigInt(3),fd=BigInt(4),ld=BigInt(5),dd=BigInt(8);function hd(t,e){const r=t%e;return r>=sd?r:e+r}function pd(t,e){if(t===sd)throw new Error("invert: expected non-zero number");if(e<=sd)throw new Error("invert: expected positive modulus, got "+e);let r=hd(t,e),n=e,i=sd,o=ad;for(;r!==sd;){const t=n%r,e=i-o*(n/r);n=r,r=t,i=o,o=e}if(n!==ad)throw new Error("invert: does not exist");return hd(i,e)}function gd(t,e){const r=(t.ORDER+ad)/fd,n=t.pow(e,r);if(!t.eql(t.sqr(n),e))throw new Error("Cannot find square root");return n}function bd(t,e){const r=(t.ORDER-ld)/dd,n=t.mul(e,cd),i=t.pow(n,r),o=t.mul(e,i),s=t.mul(t.mul(o,cd),i),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function yd(t){return t%fd===ud?gd:t%dd===ld?bd:function(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-ad,r=0;for(;e%cd===sd;)e/=cd,r++;let n=cd;const i=xd(t);for(;1===_d(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return gd;let o=i.pow(n,e);const s=(e+ad)/cd;return function(t,n){if(t.is0(n))return n;if(1!==_d(t,n))throw new Error("Cannot find square root");let i=r,a=t.mul(t.ONE,o),c=t.pow(n,e),u=t.pow(n,s);for(;!t.eql(c,t.ONE);){if(t.is0(c))return t.ZERO;let e=1,r=t.sqr(c);for(;!t.eql(r,t.ONE);)if(e++,r=t.sqr(r),e===i)throw new Error("Cannot find square root");const n=ad<<BigInt(i-e-1),o=t.pow(a,n);i=e,a=t.sqr(o),c=t.mul(c,a),u=t.mul(u,o)}return u}}(t)}const md=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function wd(t){return nd(t,md.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),t}function vd(t,e,r){if(r<sd)throw new Error("invalid exponent, negatives unsupported");if(r===sd)return t.ONE;if(r===ad)return e;let n=t.ONE,i=e;for(;r>sd;)r&ad&&(n=t.mul(n,i)),i=t.sqr(i),r>>=ad;return n}function Ed(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),i=e.reduce(((e,r,i)=>t.is0(r)?e:(n[i]=e,t.mul(e,r))),t.ONE),o=t.inv(i);return e.reduceRight(((e,r,i)=>t.is0(r)?e:(n[i]=t.mul(e,n[i]),t.mul(e,r))),o),n}function _d(t,e){const r=(t.ORDER-ad)/cd,n=t.pow(e,r),i=t.eql(n,t.ONE),o=t.eql(n,t.ZERO),s=t.eql(n,t.neg(t.ONE));if(!i&&!o&&!s)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function xd(t,e,r=!1,n={}){if(t<=sd)throw new Error("invalid field: expected ORDER > 0, got "+t);let i,o;if("object"==typeof e&&null!=e){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const t=e;t.BITS&&(i=t.BITS),t.sqrt&&(o=t.sqrt),"boolean"==typeof t.isLE&&(r=t.isLE)}else"number"==typeof e&&(i=e),n.sqrt&&(o=n.sqrt);const{nBitLength:s,nByteLength:a}=function(t,e){void 0!==e&&fl(e);const r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}(t,i);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const u=Object.freeze({ORDER:t,isLE:r,BITS:s,BYTES:a,MASK:rd(s),ZERO:sd,ONE:ad,create:e=>hd(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("invalid field element: expected bigint, got "+typeof e);return sd<=e&&e<t},is0:t=>t===sd,isValidNot0:t=>!u.is0(t)&&u.isValid(t),isOdd:t=>(t&ad)===ad,neg:e=>hd(-e,t),eql:(t,e)=>t===e,sqr:e=>hd(e*e,t),add:(e,r)=>hd(e+r,t),sub:(e,r)=>hd(e-r,t),mul:(e,r)=>hd(e*r,t),pow:(t,e)=>vd(u,t,e),div:(e,r)=>hd(e*pd(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>pd(e,t),sqrt:o||(e=>(c||(c=yd(t)),c(u,e))),toBytes:t=>r?Jl(t,a):Yl(t,a),fromBytes:t=>{if(t.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+t.length);return r?Wl(t):Zl(t)},invertBatch:t=>Ed(u,t),cmov:(t,e,r)=>r?e:t});return Object.freeze(u)}function Bd(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Id(t){const e=Bd(t);return e+Math.ceil(e/2)}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const Ad=BigInt(0),Sd=BigInt(1);function Td(t,e){const r=e.negate();return t?r:e}function Nd(t,e,r){const n="pz"===e?t=>t.pz:t=>t.ez,i=Ed(t.Fp,r.map(n));return r.map(((t,e)=>t.toAffine(i[e]))).map(t.fromAffine)}function Od(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Rd(t,e){Od(t,e);const r=2**t;return{windows:Math.ceil(e/t)+1,windowSize:2**(t-1),mask:rd(t),maxNumber:r,shiftBy:BigInt(t)}}function Ud(t,e,r){const{windowSize:n,mask:i,maxNumber:o,shiftBy:s}=r;let a=Number(t&i),c=t>>s;a>n&&(a-=o,c+=Sd);const u=e*n;return{nextN:c,offset:u+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:e%2!=0,offsetF:u}}const Pd=new WeakMap,kd=new WeakMap;function Fd(t){return kd.get(t)||1}function Ld(t){if(t!==Ad)throw new Error("invalid wNAF")}function Cd(t,e,r,n){(function(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach(((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)}))})(r,t),function(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach(((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)}))}(n,e);const i=r.length,o=n.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,a=td(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=rd(c),f=new Array(Number(u)+1).fill(s);let l=s;for(let t=Math.floor((e.BITS-1)/c)*c;t>=0;t-=c){f.fill(s);for(let e=0;e<o;e++){const i=n[e],o=Number(i>>BigInt(t)&u);f[o]=f[o].add(r[e])}let e=s;for(let t=f.length-1,r=s;t>0;t--)r=r.add(f[t]),e=e.add(r);if(l=l.add(e),0!==t)for(let t=0;t<c;t++)l=l.double()}return l}function Dd(t,e){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return wd(e),e}return xd(t)}const jd=Zl;function $d(t,e){if(Md(t),Md(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=255&t,t>>>=8;return new Uint8Array(r)}function qd(t,e){const r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}function Md(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Vd(t,e,r){nd(r,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:n,k:i,m:o,hash:s,expand:a,DST:c}=r;if(!ul(c)&&"string"!=typeof c)throw new Error("DST must be string or uint8array");if(!function(t){return"function"==typeof t&&Number.isSafeInteger(t.outputLen)}(r.hash))throw new Error("expected valid hash");ll(t),Md(e);const u="string"==typeof c?Al(c):c,f=n.toString(2).length,l=Math.ceil((f+i)/8),d=e*o*l;let h;if("xmd"===a)h=function(t,e,r,n){ll(t),ll(e),Md(r),e.length>255&&(e=n(Tl(Al("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:o}=n,s=Math.ceil(r/i);if(r>65535||s>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=Tl(e,$d(e.length,1)),c=$d(0,o),u=$d(r,2),f=new Array(s),l=n(Tl(c,t,u,$d(0,1),a));f[0]=n(Tl(l,$d(1,1),a));for(let t=1;t<=s;t++){const e=[qd(l,f[t-1]),$d(t+1,1),a];f[t]=n(Tl(...e))}return Tl(...f).slice(0,r)}(t,u,d,s);else if("xof"===a)h=function(t,e,r,n,i){if(ll(t),ll(e),Md(r),e.length>255){const t=Math.ceil(2*n/8);e=i.create({dkLen:t}).update(Al("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update($d(r,2)).update(e).update($d(e.length,1)).digest()}(t,u,d,i,s);else{if("_internal_pass"!==a)throw new Error('expand must be "xmd" or "xof"');h=t}const p=new Array(e);for(let t=0;t<e;t++){const e=new Array(o);for(let r=0;r<o;r++){const i=l*(r+t*o),s=h.subarray(i,i+l);e[r]=hd(jd(s),n)}p[t]=e}return p}function zd(t,e){const r=e.map((t=>Array.from(t).reverse()));return(e,n)=>{const[i,o,s,a]=r.map((r=>r.reduce(((r,n)=>t.add(t.mul(r,e),n))))),[c,u]=Ed(t,[o,a],!0);return e=t.mul(i,c),n=t.mul(n,t.mul(s,u)),{x:e,y:n}}}function Gd(t,e,r){if("function"!=typeof e)throw new Error("mapToCurve() must be defined");function n(r){return t.fromAffine(e(r))}function i(e){const r=e.clearCofactor();return r.equals(t.ZERO)?t.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(t,e){const o=r.DST?r.DST:{},s=Vd(t,2,Object.assign({},r,o,e)),a=n(s[0]),c=n(s[1]);return i(a.add(c))},encodeToCurve(t,e){const o=r.encodeDST?r.encodeDST:{};return i(n(Vd(t,1,Object.assign({},r,o,e))[0]))},mapToCurve(t){if(!Array.isArray(t))throw new Error("expected array of bigints");for(const e of t)if("bigint"!=typeof e)throw new Error("expected array of bigints");return i(n(t))}}}class Kd extends Nl{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,dl(t);const r=Sl(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?t.create().update(r).digest():r);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),gl(i)}update(t){return hl(this),this.iHash.update(t),this}digestInto(t){hl(this),ll(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return t.finished=n,t.destroyed=i,t.blockLen=o,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Hd=(t,e,r)=>new Kd(t,e).update(r).digest();Hd.create=(t,e)=>new Kd(t,e)
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */;const Zd=BigInt(0),Wd=BigInt(1),Yd=BigInt(2),Jd=BigInt(3),Xd=BigInt(4);function Qd(t,e,r){return function(n){const i=t.sqr(n),o=t.mul(i,n);return t.add(t.add(o,t.mul(n,e)),r)}}function th(t,e,r){const{BYTES:n}=t;return function(i){let o;if("bigint"==typeof i)o=i;else{let r=Xl("private key",i);if(e){if(!e.includes(2*r.length))throw new Error("invalid private key");const t=new Uint8Array(n);t.set(r,t.length-r.length),r=t}try{o=t.fromBytes(r)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof i}`)}}if(r&&(o=t.create(o)),!t.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}}function eh(t,e={}){const{Fp:r,Fn:n}=function(t,e,r={}){if(!e||"object"!=typeof e)throw new Error(`expected valid ${t} CURVE object`);for(const t of["p","n","h"]){const r=e[t];if(!("bigint"==typeof r&&r>Ad))throw new Error(`CURVE.${t} must be positive bigint`)}const n=Dd(e.p,r.Fp),i=Dd(e.n,r.Fn),o=["Gx","Gy","a","weierstrass"===t?"b":"d"];for(const t of o)if(!n.isValid(e[t]))throw new Error(`CURVE.${t} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:i}}("weierstrass",t,e),{h:i,n:o}=t;nd(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:s}=e;if(s&&(!r.is0(t.a)||"bigint"!=typeof s.beta||"function"!=typeof s.splitScalar))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const c=e.toBytes||function(t,e,n){const{x:i,y:o}=e.toAffine(),s=r.toBytes(i);if(Kl("isCompressed",n),n){a();return Tl(function(t){return Uint8Array.of(t?2:3)}(!r.isOdd(o)),s)}return Tl(Uint8Array.of(4),s,r.toBytes(o))},u=e.fromBytes||function(t){ll(t);const e=r.BYTES,n=e+1,i=2*e+1,o=t.length,s=t[0],c=t.subarray(1);if(o!==n||2!==s&&3!==s){if(o===i&&4===s){const t=r.fromBytes(c.subarray(0*e,1*e)),n=r.fromBytes(c.subarray(1*e,2*e));if(!l(t,n))throw new Error("bad point: is not on curve");return{x:t,y:n}}throw new Error(`bad point: got length ${o}, expected compressed=${n} or uncompressed=${i}`)}{const t=r.fromBytes(c);if(!r.isValid(t))throw new Error("bad point: is not on curve, wrong x");const e=f(t);let n;try{n=r.sqrt(e)}catch(t){const e=t instanceof Error?": "+t.message:"";throw new Error("bad point: is not on curve, sqrt error"+e)}a();return 1==(1&s)!==r.isOdd(n)&&(n=r.neg(n)),{x:t,y:n}}},f=Qd(r,t.a,t.b);function l(t,e){const n=r.sqr(e),i=f(t);return r.eql(n,i)}if(!l(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const d=r.mul(r.pow(t.a,Jd),Xd),h=r.mul(r.sqr(t.b),BigInt(27));if(r.is0(r.add(d,h)))throw new Error("bad curve params: a or b");function p(t,e,n=!1){if(!r.isValid(e)||n&&r.is0(e))throw new Error(`bad point coordinate ${t}`);return e}function g(t){if(!(t instanceof w))throw new Error("ProjectivePoint expected")}const b=od(((t,e)=>{const{px:n,py:i,pz:o}=t;if(r.eql(o,r.ONE))return{x:n,y:i};const s=t.is0();null==e&&(e=s?r.ONE:r.inv(o));const a=r.mul(n,e),c=r.mul(i,e),u=r.mul(o,e);if(s)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw new Error("invZ was invalid");return{x:a,y:c}})),y=od((t=>{if(t.is0()){if(e.allowInfinityPoint&&!r.is0(t.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=t.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not field elements");if(!l(n,i))throw new Error("bad point: equation left != right");if(!t.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));function m(t,e,n,i,o){return n=new w(r.mul(n.px,t),n.py,n.pz),e=Td(i,e),n=Td(o,n),e.add(n)}class w{constructor(t,e,r){this.px=p("x",t),this.py=p("y",e,!0),this.pz=p("z",r),Object.freeze(this)}static fromAffine(t){const{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw new Error("invalid affine point");if(t instanceof w)throw new Error("projective point not allowed");return r.is0(e)&&r.is0(n)?w.ZERO:new w(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){return Nd(w,"pz",t)}static fromBytes(t){return ll(t),w.fromHex(t)}static fromHex(t){const e=w.fromAffine(u(Xl("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){const r=th(n,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return w.BASE.multiply(r(t))}static msm(t,e){return Cd(w,n,t,e)}precompute(t=8,e=!0){return E.setWindowSize(this,t),e||this.multiply(Jd),this}_setWindowSize(t){this.precompute(t)}assertValidity(){y(this)}hasEvenY(){const{y:t}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(t)}equals(t){g(t);const{px:e,py:n,pz:i}=this,{px:o,py:s,pz:a}=t,c=r.eql(r.mul(e,a),r.mul(o,i)),u=r.eql(r.mul(n,a),r.mul(s,i));return c&&u}negate(){return new w(this.px,r.neg(this.py),this.pz)}double(){const{a:e,b:n}=t,i=r.mul(n,Jd),{px:o,py:s,pz:a}=this;let c=r.ZERO,u=r.ZERO,f=r.ZERO,l=r.mul(o,o),d=r.mul(s,s),h=r.mul(a,a),p=r.mul(o,s);return p=r.add(p,p),f=r.mul(o,a),f=r.add(f,f),c=r.mul(e,f),u=r.mul(i,h),u=r.add(c,u),c=r.sub(d,u),u=r.add(d,u),u=r.mul(c,u),c=r.mul(p,c),f=r.mul(i,f),h=r.mul(e,h),p=r.sub(l,h),p=r.mul(e,p),p=r.add(p,f),f=r.add(l,l),l=r.add(f,l),l=r.add(l,h),l=r.mul(l,p),u=r.add(u,l),h=r.mul(s,a),h=r.add(h,h),l=r.mul(h,p),c=r.sub(c,l),f=r.mul(h,d),f=r.add(f,f),f=r.add(f,f),new w(c,u,f)}add(e){g(e);const{px:n,py:i,pz:o}=this,{px:s,py:a,pz:c}=e;let u=r.ZERO,f=r.ZERO,l=r.ZERO;const d=t.a,h=r.mul(t.b,Jd);let p=r.mul(n,s),b=r.mul(i,a),y=r.mul(o,c),m=r.add(n,i),v=r.add(s,a);m=r.mul(m,v),v=r.add(p,b),m=r.sub(m,v),v=r.add(n,o);let E=r.add(s,c);return v=r.mul(v,E),E=r.add(p,y),v=r.sub(v,E),E=r.add(i,o),u=r.add(a,c),E=r.mul(E,u),u=r.add(b,y),E=r.sub(E,u),l=r.mul(d,v),u=r.mul(h,y),l=r.add(u,l),u=r.sub(b,l),l=r.add(b,l),f=r.mul(u,l),b=r.add(p,p),b=r.add(b,p),y=r.mul(d,y),v=r.mul(h,v),b=r.add(b,y),y=r.sub(p,y),y=r.mul(d,y),v=r.add(v,y),p=r.mul(b,v),f=r.add(f,p),p=r.mul(E,v),u=r.mul(m,u),u=r.sub(u,p),p=r.mul(m,b),l=r.mul(E,l),l=r.add(l,p),new w(u,f,l)}subtract(t){return this.add(t.negate())}is0(){return this.equals(w.ZERO)}multiply(t){const{endo:r}=e;if(!n.isValidNot0(t))throw new Error("invalid scalar: out of range");let i,o;const s=t=>E.wNAFCached(this,t,w.normalizeZ);if(r){const{k1neg:e,k1:n,k2neg:a,k2:c}=r.splitScalar(t),{p:u,f:f}=s(n),{p:l,f:d}=s(c);o=f.add(d),i=m(r.beta,u,l,e,a)}else{const{p:e,f:r}=s(t);i=e,o=r}return w.normalizeZ([i,o])[0]}multiplyUnsafe(t){const{endo:r}=e,i=this;if(!n.isValid(t))throw new Error("invalid scalar: out of range");if(t===Zd||i.is0())return w.ZERO;if(t===Wd)return i;if(E.hasPrecomputes(this))return this.multiply(t);if(r){const{k1neg:e,k1:n,k2neg:o,k2:s}=r.splitScalar(t),{p1:a,p2:c}=function(t,e,r,n){let i=e,o=t.ZERO,s=t.ZERO;for(;r>Ad||n>Ad;)r&Sd&&(o=o.add(i)),n&Sd&&(s=s.add(i)),i=i.double(),r>>=Sd,n>>=Sd;return{p1:o,p2:s}}(w,i,n,s);return m(r.beta,a,c,e,o)}return E.wNAFCachedUnsafe(i,t)}multiplyAndAddUnsafe(t,e,r){const n=this.multiplyUnsafe(e).add(t.multiplyUnsafe(r));return n.is0()?void 0:n}toAffine(t){return b(this,t)}isTorsionFree(){const{isTorsionFree:t}=e;return i===Wd||(t?t(w,this):E.wNAFCachedUnsafe(this,o).is0())}clearCofactor(){const{clearCofactor:t}=e;return i===Wd?this:t?t(w,this):this.multiplyUnsafe(i)}toBytes(t=!0){return Kl("isCompressed",t),this.assertValidity(),c(w,this,t)}toRawBytes(t=!0){return this.toBytes(t)}toHex(t=!0){return _l(this.toBytes(t))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}w.BASE=new w(t.Gx,t.Gy,r.ONE),w.ZERO=new w(r.ZERO,r.ONE,r.ZERO),w.Fp=r,w.Fn=n;const v=n.BITS,E=function(t,e){return{constTimeNegate:Td,hasPrecomputes:t=>1!==Fd(t),unsafeLadder(e,r,n=t.ZERO){let i=e;for(;r>Ad;)r&Sd&&(n=n.add(i)),i=i.double(),r>>=Sd;return n},precomputeWindow(t,r){const{windows:n,windowSize:i}=Rd(r,e),o=[];let s=t,a=s;for(let t=0;t<n;t++){a=s,o.push(a);for(let t=1;t<i;t++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(r,n,i){let o=t.ZERO,s=t.BASE;const a=Rd(r,e);for(let t=0;t<a.windows;t++){const{nextN:e,offset:r,isZero:c,isNeg:u,isNegF:f,offsetF:l}=Ud(i,t,a);i=e,c?s=s.add(Td(f,n[l])):o=o.add(Td(u,n[r]))}return Ld(i),{p:o,f:s}},wNAFUnsafe(r,n,i,o=t.ZERO){const s=Rd(r,e);for(let t=0;t<s.windows&&i!==Ad;t++){const{nextN:e,offset:r,isZero:a,isNeg:c}=Ud(i,t,s);if(i=e,!a){const t=n[r];o=o.add(c?t.negate():t)}}return Ld(i),o},getPrecomputes(t,e,r){let n=Pd.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&("function"==typeof r&&(n=r(n)),Pd.set(e,n))),n},wNAFCached(t,e,r){const n=Fd(t);return this.wNAF(n,this.getPrecomputes(n,t,r),e)},wNAFCachedUnsafe(t,e,r,n){const i=Fd(t);return 1===i?this.unsafeLadder(t,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),e,n)},setWindowSize(t,r){Od(r,e),kd.set(t,r),Pd.delete(t)}}}(w,e.endo?Math.ceil(v/2):v);return w}function rh(t){const{CURVE:e,curveOpts:r}=function(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp,n=xd(e.n,t.nBitLength),i={Fp:r,Fn:n,allowedPrivateKeyLengths:t.allowedPrivateKeyLengths,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,wrapPrivateKey:t.wrapPrivateKey,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:i}}(t);return function(t,e){const{Fp:r,Fn:n}=e;function i(t){return function(t,e,r){return Ql(t)&&Ql(e)&&Ql(r)&&e<=t&&t<r}(t,Wd,n.ORDER)}const o=Qd(r,t.a,t.b),s=th(n,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return Object.assign({},{CURVE:t,Point:e,ProjectivePoint:e,normPrivateKeyToScalar:s,weierstrassEquation:o,isWithinCurveOrder:i})}(t,eh(e,r))}function nh(t,e){wd(t);const{A:r,B:n,Z:i}=e;if(!t.isValid(r)||!t.isValid(n)||!t.isValid(i))throw new Error("mapToCurveSimpleSWU: invalid opts");const o=function(t,e){const r=t.ORDER;let n=Zd;for(let t=r-Wd;t%Yd===Zd;t/=Yd)n+=Wd;const i=n,o=Yd<<i-Wd-Wd,s=o*Yd,a=(r-Wd)/s,c=(a-Wd)/Yd,u=s-Wd,f=o,l=t.pow(e,a),d=t.pow(e,(a+Wd)/Yd);let h=(e,r)=>{let n=l,o=t.pow(r,u),s=t.sqr(o);s=t.mul(s,r);let a=t.mul(e,s);a=t.pow(a,c),a=t.mul(a,o),o=t.mul(a,r),s=t.mul(a,e);let h=t.mul(s,o);a=t.pow(h,f);let p=t.eql(a,t.ONE);o=t.mul(s,d),a=t.mul(h,n),s=t.cmov(o,s,p),h=t.cmov(a,h,p);for(let e=i;e>Wd;e--){let r=e-Yd;r=Yd<<r-Wd;let i=t.pow(h,r);const a=t.eql(i,t.ONE);o=t.mul(s,n),n=t.mul(n,n),i=t.mul(h,n),s=t.cmov(o,s,a),h=t.cmov(i,h,a)}return{isValid:p,value:s}};if(t.ORDER%Xd===Jd){const r=(t.ORDER-Jd)/Xd,n=t.sqrt(t.neg(e));h=(e,i)=>{let o=t.sqr(i);const s=t.mul(e,i);o=t.mul(o,s);let a=t.pow(o,r);a=t.mul(a,s);const c=t.mul(a,n),u=t.mul(t.sqr(a),i),f=t.eql(u,e);return{isValid:f,value:t.cmov(c,a,f)}}}return h}(t,i);if(!t.isOdd)throw new Error("Field does not have .isOdd()");return e=>{let s,a,c,u,f,l,d,h;s=t.sqr(e),s=t.mul(s,i),a=t.sqr(s),a=t.add(a,s),c=t.add(a,t.ONE),c=t.mul(c,n),u=t.cmov(i,t.neg(a),!t.eql(a,t.ZERO)),u=t.mul(u,r),a=t.sqr(c),l=t.sqr(u),f=t.mul(l,r),a=t.add(a,f),a=t.mul(a,c),l=t.mul(l,u),f=t.mul(l,n),a=t.add(a,f),d=t.mul(s,c);const{isValid:p,value:g}=o(a,l);h=t.mul(s,e),h=t.mul(h,g),d=t.cmov(d,c,p),h=t.cmov(h,g,p);const b=t.isOdd(e)===t.isOdd(h);h=t.cmov(t.neg(h),h,b);const y=Ed(t,[u],!0)[0];return d=t.mul(d,y),{x:d,y:h}}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ih=BigInt(0),oh=BigInt(1),sh=BigInt(2),ah=BigInt(3);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const ch=BigInt(0),uh=BigInt(1),fh=BigInt(2),lh=BigInt(3);function dh(t,e,r,n,i=1,o){const s=BigInt(void 0===o?n:o),a=r**BigInt(n),c=[];for(let o=0;o<i;o++){const i=BigInt(o+1),u=[];for(let o=0,c=uh;o<n;o++){const n=(i*c-i)/s%a;u.push(t.pow(e,n)),c*=r}c.push(u)}return c}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const hh=BigInt(0),ph=BigInt(1),gh=BigInt(2),bh=BigInt(3),yh=BigInt(4),mh=BigInt("0xd201000000010000"),wh=td(mh),vh={p:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),n:BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001"),h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),a:hh,b:yh,Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1")},Eh=xd(vh.n),{Fp:_h,Fp2:xh,Fp6:Bh,Fp4Square:Ih,Fp12:Ah}=function(t){const{ORDER:e}=t,r=xd(e),n=r.create(t.NONRESIDUE||BigInt(-1)),i=r.div(r.ONE,fh),o=dh(r,n,r.ORDER,2)[0],s=({c0:t,c1:e},{c0:n,c1:i})=>({c0:r.add(t,n),c1:r.add(e,i)}),a=({c0:t,c1:e},{c0:n,c1:i})=>({c0:r.sub(t,n),c1:r.sub(e,i)}),c=({c0:t,c1:e},n)=>{if("bigint"==typeof n)return{c0:r.mul(t,n),c1:r.mul(e,n)};const{c0:i,c1:o}=n;let s=r.mul(t,i),a=r.mul(e,o);return{c0:r.sub(s,a),c1:r.sub(r.mul(r.add(t,e),r.add(i,o)),r.add(s,a))}},u=({c0:t,c1:e})=>{const n=r.add(t,e),i=r.sub(t,e),o=r.add(t,t);return{c0:r.mul(n,i),c1:r.mul(o,e)}},f=t=>{if(2!==t.length)throw new Error("invalid tuple");const e=t.map((t=>r.create(t)));return{c0:e[0],c1:e[1]}};function l(t,e){return"bigint"==typeof t&&ch<=t&&t<e}const d=e*e,h=f(t.FP2_NONRESIDUE),p={ORDER:d,isLE:r.isLE,NONRESIDUE:h,BITS:td(d),BYTES:Math.ceil(td(d)/8),MASK:rd(td(d)),ZERO:{c0:r.ZERO,c1:r.ZERO},ONE:{c0:r.ONE,c1:r.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>l(t,d)&&l(e,d),is0:({c0:t,c1:e})=>r.is0(t)&&r.is0(e),isValidNot0:t=>!p.is0(t)&&p.isValid(t),eql:({c0:t,c1:e},{c0:n,c1:i})=>r.eql(t,n)&&r.eql(e,i),neg:({c0:t,c1:e})=>({c0:r.neg(t),c1:r.neg(e)}),pow:(t,e)=>vd(p,t,e),invertBatch:t=>Ed(p,t),add:s,sub:a,mul:c,sqr:u,addN:s,subN:a,mulN:c,sqrN:u,div:(t,e)=>p.mul(t,"bigint"==typeof e?r.inv(r.create(e)):p.inv(e)),inv:({c0:t,c1:e})=>{const n=r.inv(r.create(t*t+e*e));return{c0:r.mul(n,r.create(t)),c1:r.mul(n,r.create(-e))}},sqrt:e=>{if(t.Fp2sqrt)return t.Fp2sqrt(e);const{c0:o,c1:s}=e;if(r.is0(s))return 1===_d(r,o)?p.create({c0:r.sqrt(o),c1:r.ZERO}):p.create({c0:r.ZERO,c1:r.sqrt(r.div(o,n))});const a=r.sqrt(r.sub(r.sqr(o),r.mul(r.sqr(s),n)));let c=r.mul(r.add(a,o),i);-1===_d(r,c)&&(c=r.sub(c,a));const u=r.sqrt(c),f=p.create({c0:u,c1:r.div(r.mul(s,i),u)});if(!p.eql(p.sqr(f),e))throw new Error("Cannot find square root");const l=f,d=p.neg(l),{re:h,im:g}=p.reim(l),{re:b,im:y}=p.reim(d);return g>y||g===y&&h>b?l:d},isOdd:t=>{const{re:e,im:r}=p.reim(t);return BigInt(e%fh||e===ch&&r%fh)==uh},fromBytes(t){if(t.length!==p.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:r.fromBytes(t.subarray(0,r.BYTES)),c1:r.fromBytes(t.subarray(r.BYTES))}},toBytes:({c0:t,c1:e})=>Tl(r.toBytes(t),r.toBytes(e)),cmov:({c0:t,c1:e},{c0:n,c1:i},o)=>({c0:r.cmov(t,n,o),c1:r.cmov(e,i,o)}),reim:({c0:t,c1:e})=>({re:t,im:e}),mulByNonresidue:({c0:t,c1:e})=>p.mul({c0:t,c1:e},h),mulByB:t.Fp2mulByB,fromBigTuple:f,frobeniusMap:({c0:t,c1:e},n)=>({c0:t,c1:r.mul(e,o[n%2])})},g=({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o})=>({c0:p.add(t,n),c1:p.add(e,i),c2:p.add(r,o)}),b=({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o})=>({c0:p.sub(t,n),c1:p.sub(e,i),c2:p.sub(r,o)}),y=({c0:t,c1:e,c2:r},n)=>{if("bigint"==typeof n)return{c0:p.mul(t,n),c1:p.mul(e,n),c2:p.mul(r,n)};const{c0:i,c1:o,c2:s}=n,a=p.mul(t,i),c=p.mul(e,o),u=p.mul(r,s);return{c0:p.add(a,p.mulByNonresidue(p.sub(p.mul(p.add(e,r),p.add(o,s)),p.add(c,u)))),c1:p.add(p.sub(p.mul(p.add(t,e),p.add(i,o)),p.add(a,c)),p.mulByNonresidue(u)),c2:p.sub(p.add(c,p.mul(p.add(t,r),p.add(i,s))),p.add(a,u))}},m=({c0:t,c1:e,c2:r})=>{let n=p.sqr(t),i=p.mul(p.mul(t,e),fh),o=p.mul(p.mul(e,r),fh),s=p.sqr(r);return{c0:p.add(p.mulByNonresidue(o),n),c1:p.add(p.mulByNonresidue(s),i),c2:p.sub(p.sub(p.add(p.add(i,p.sqr(p.add(p.sub(t,e),r))),o),n),s)}},[w,v]=dh(p,h,r.ORDER,6,2,3),E={ORDER:p.ORDER,isLE:p.isLE,BITS:3*p.BITS,BYTES:3*p.BYTES,MASK:rd(3*p.BITS),ZERO:{c0:p.ZERO,c1:p.ZERO,c2:p.ZERO},ONE:{c0:p.ONE,c1:p.ZERO,c2:p.ZERO},create:t=>t,isValid:({c0:t,c1:e,c2:r})=>p.isValid(t)&&p.isValid(e)&&p.isValid(r),is0:({c0:t,c1:e,c2:r})=>p.is0(t)&&p.is0(e)&&p.is0(r),isValidNot0:t=>!E.is0(t)&&E.isValid(t),neg:({c0:t,c1:e,c2:r})=>({c0:p.neg(t),c1:p.neg(e),c2:p.neg(r)}),eql:({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o})=>p.eql(t,n)&&p.eql(e,i)&&p.eql(r,o),sqrt:id,div:(t,e)=>E.mul(t,"bigint"==typeof e?r.inv(r.create(e)):E.inv(e)),pow:(t,e)=>vd(E,t,e),invertBatch:t=>Ed(E,t),add:g,sub:b,mul:y,sqr:m,addN:g,subN:b,mulN:y,sqrN:m,inv:({c0:t,c1:e,c2:r})=>{let n=p.sub(p.sqr(t),p.mulByNonresidue(p.mul(r,e))),i=p.sub(p.mulByNonresidue(p.sqr(r)),p.mul(t,e)),o=p.sub(p.sqr(e),p.mul(t,r)),s=p.inv(p.add(p.mulByNonresidue(p.add(p.mul(r,i),p.mul(e,o))),p.mul(t,n)));return{c0:p.mul(s,n),c1:p.mul(s,i),c2:p.mul(s,o)}},fromBytes:t=>{if(t.length!==E.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:p.fromBytes(t.subarray(0,p.BYTES)),c1:p.fromBytes(t.subarray(p.BYTES,2*p.BYTES)),c2:p.fromBytes(t.subarray(2*p.BYTES))}},toBytes:({c0:t,c1:e,c2:r})=>Tl(p.toBytes(t),p.toBytes(e),p.toBytes(r)),cmov:({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o},s)=>({c0:p.cmov(t,n,s),c1:p.cmov(e,i,s),c2:p.cmov(r,o,s)}),fromBigSix:t=>{if(!Array.isArray(t)||6!==t.length)throw new Error("invalid Fp6 usage");return{c0:p.fromBigTuple(t.slice(0,2)),c1:p.fromBigTuple(t.slice(2,4)),c2:p.fromBigTuple(t.slice(4,6))}},frobeniusMap:({c0:t,c1:e,c2:r},n)=>({c0:p.frobeniusMap(t,n),c1:p.mul(p.frobeniusMap(e,n),w[n%6]),c2:p.mul(p.frobeniusMap(r,n),v[n%6])}),mulByFp2:({c0:t,c1:e,c2:r},n)=>({c0:p.mul(t,n),c1:p.mul(e,n),c2:p.mul(r,n)}),mulByNonresidue:({c0:t,c1:e,c2:r})=>({c0:p.mulByNonresidue(r),c1:t,c2:e}),mul1:({c0:t,c1:e,c2:r},n)=>({c0:p.mulByNonresidue(p.mul(r,n)),c1:p.mul(t,n),c2:p.mul(e,n)}),mul01({c0:t,c1:e,c2:r},n,i){let o=p.mul(t,n),s=p.mul(e,i);return{c0:p.add(p.mulByNonresidue(p.sub(p.mul(p.add(e,r),i),s)),o),c1:p.sub(p.sub(p.mul(p.add(n,i),p.add(t,e)),o),s),c2:p.add(p.sub(p.mul(p.add(t,r),n),o),s)}}},_=dh(p,h,r.ORDER,12,1,6)[0],x=({c0:t,c1:e},{c0:r,c1:n})=>({c0:E.add(t,r),c1:E.add(e,n)}),B=({c0:t,c1:e},{c0:r,c1:n})=>({c0:E.sub(t,r),c1:E.sub(e,n)}),I=({c0:t,c1:e},r)=>{if("bigint"==typeof r)return{c0:E.mul(t,r),c1:E.mul(e,r)};let{c0:n,c1:i}=r,o=E.mul(t,n),s=E.mul(e,i);return{c0:E.add(o,E.mulByNonresidue(s)),c1:E.sub(E.mul(E.add(t,e),E.add(n,i)),E.add(o,s))}},A=({c0:t,c1:e})=>{let r=E.mul(t,e);return{c0:E.sub(E.sub(E.mul(E.add(E.mulByNonresidue(e),t),E.add(t,e)),r),E.mulByNonresidue(r)),c1:E.add(r,r)}},S={ORDER:p.ORDER,isLE:E.isLE,BITS:2*E.BITS,BYTES:2*E.BYTES,MASK:rd(2*E.BITS),ZERO:{c0:E.ZERO,c1:E.ZERO},ONE:{c0:E.ONE,c1:E.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>E.isValid(t)&&E.isValid(e),is0:({c0:t,c1:e})=>E.is0(t)&&E.is0(e),isValidNot0:t=>!S.is0(t)&&S.isValid(t),neg:({c0:t,c1:e})=>({c0:E.neg(t),c1:E.neg(e)}),eql:({c0:t,c1:e},{c0:r,c1:n})=>E.eql(t,r)&&E.eql(e,n),sqrt:id,inv:({c0:t,c1:e})=>{let r=E.inv(E.sub(E.sqr(t),E.mulByNonresidue(E.sqr(e))));return{c0:E.mul(t,r),c1:E.neg(E.mul(e,r))}},div:(t,e)=>S.mul(t,"bigint"==typeof e?r.inv(r.create(e)):S.inv(e)),pow:(t,e)=>vd(S,t,e),invertBatch:t=>Ed(S,t),add:x,sub:B,mul:I,sqr:A,addN:x,subN:B,mulN:I,sqrN:A,fromBytes:t=>{if(t.length!==S.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:E.fromBytes(t.subarray(0,E.BYTES)),c1:E.fromBytes(t.subarray(E.BYTES))}},toBytes:({c0:t,c1:e})=>Tl(E.toBytes(t),E.toBytes(e)),cmov:({c0:t,c1:e},{c0:r,c1:n},i)=>({c0:E.cmov(t,r,i),c1:E.cmov(e,n,i)}),fromBigTwelve:t=>({c0:E.fromBigSix(t.slice(0,6)),c1:E.fromBigSix(t.slice(6,12))}),frobeniusMap(t,e){const{c0:r,c1:n,c2:i}=E.frobeniusMap(t.c1,e),o=_[e%12];return{c0:E.frobeniusMap(t.c0,e),c1:E.create({c0:p.mul(r,o),c1:p.mul(n,o),c2:p.mul(i,o)})}},mulByFp2:({c0:t,c1:e},r)=>({c0:E.mulByFp2(t,r),c1:E.mulByFp2(e,r)}),conjugate:({c0:t,c1:e})=>({c0:t,c1:E.neg(e)}),mul014:({c0:t,c1:e},r,n,i)=>{let o=E.mul01(t,r,n),s=E.mul1(e,i);return{c0:E.add(E.mulByNonresidue(s),o),c1:E.sub(E.sub(E.mul01(E.add(e,t),r,p.add(n,i)),o),s)}},mul034:({c0:t,c1:e},r,n,i)=>{const o=E.create({c0:p.mul(t.c0,r),c1:p.mul(t.c1,r),c2:p.mul(t.c2,r)}),s=E.mul01(e,n,i),a=E.mul01(E.add(t,e),p.add(r,n),i);return{c0:E.add(E.mulByNonresidue(s),o),c1:E.sub(a,E.add(o,s))}},_cyclotomicSquare:t.Fp12cyclotomicSquare,_cyclotomicExp:t.Fp12cyclotomicExp,finalExponentiate:t.Fp12finalExponentiate};return{Fp:r,Fp2:p,Fp6:E,Fp12:S,Fp4Square:function(t,e){const r=p.sqr(t),n=p.sqr(e);return{first:p.add(p.mulByNonresidue(n),r),second:p.sub(p.sub(p.sqr(p.add(t,e)),r),n)}}}}({ORDER:vh.p,FP2_NONRESIDUE:[ph,ph],Fp2mulByB:({c0:t,c1:e})=>{const r=_h.mul(t,yh),n=_h.mul(e,yh);return{c0:_h.sub(r,n),c1:_h.add(r,n)}},Fp12cyclotomicSquare:({c0:t,c1:e})=>{const{c0:r,c1:n,c2:i}=t,{c0:o,c1:s,c2:a}=e,{first:c,second:u}=Ih(r,s),{first:f,second:l}=Ih(o,i),{first:d,second:h}=Ih(n,a),p=xh.mulByNonresidue(h);return{c0:Bh.create({c0:xh.add(xh.mul(xh.sub(c,r),gh),c),c1:xh.add(xh.mul(xh.sub(f,n),gh),f),c2:xh.add(xh.mul(xh.sub(d,i),gh),d)}),c1:Bh.create({c0:xh.add(xh.mul(xh.add(p,o),gh),p),c1:xh.add(xh.mul(xh.add(u,s),gh),u),c2:xh.add(xh.mul(xh.add(l,a),gh),l)})}},Fp12cyclotomicExp(t,e){let r=Ah.ONE;for(let n=wh-1;n>=0;n--)r=Ah._cyclotomicSquare(r),ed(e,n)&&(r=Ah.mul(r,t));return r},Fp12finalExponentiate:t=>{const e=mh,r=Ah.div(Ah.frobeniusMap(t,6),t),n=Ah.mul(Ah.frobeniusMap(r,2),r),i=Ah.conjugate(Ah._cyclotomicExp(n,e)),o=Ah.mul(Ah.conjugate(Ah._cyclotomicSquare(n)),i),s=Ah.conjugate(Ah._cyclotomicExp(o,e)),a=Ah.conjugate(Ah._cyclotomicExp(s,e)),c=Ah.mul(Ah.conjugate(Ah._cyclotomicExp(a,e)),Ah._cyclotomicSquare(i)),u=Ah.conjugate(Ah._cyclotomicExp(c,e)),f=Ah.frobeniusMap(Ah.mul(i,a),2),l=Ah.frobeniusMap(Ah.mul(s,n),3),d=Ah.frobeniusMap(Ah.mul(c,Ah.conjugate(n)),1),h=Ah.mul(Ah.mul(u,Ah.conjugate(o)),n);return Ah.mul(Ah.mul(Ah.mul(f,l),d),h)}}),{G2psi:Sh,G2psi2:Th}=function(t,e,r){const n=e.pow(r,(t.ORDER-uh)/lh),i=e.pow(r,(t.ORDER-uh)/fh);function o(t,r){return[e.mul(e.frobeniusMap(t,1),n),e.mul(e.frobeniusMap(r,1),i)]}const s=e.pow(r,(t.ORDER**fh-uh)/lh),a=e.pow(r,(t.ORDER**fh-uh)/fh);if(!e.eql(a,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function c(t,r){return[e.mul(t,s),e.neg(r)]}const u=t=>(e,r)=>{const n=r.toAffine(),i=t(n.x,n.y);return e.fromAffine({x:i[0],y:i[1]})};return{psi:o,psi2:c,G2psi:u(o),G2psi2:u(c),PSI_X:n,PSI_Y:i,PSI2_X:s,PSI2_Y:a}}(_h,xh,xh.div(xh.ONE,xh.NONRESIDUE)),Nh=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:_h.ORDER,m:2,k:128,expand:"xmd",hash:Vl}),Oh={p:xh.ORDER,n:vh.n,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),a:xh.ZERO,b:xh.fromBigTuple([yh,yh]),Gx:xh.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:xh.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")])},Rh=Ph(_h.toBytes(hh),{infinity:!0,compressed:!0});function Uh(t){const e=224&(t=t.slice())[0],r=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return t[0]&=31,{compressed:r,infinity:n,sort:i,value:t}}function Ph(t,e){if(224&t[0])throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function kh(t){t.assertValidity();const{BYTES:e,ORDER:r}=_h,{x:n,y:i}=t.toAffine();if(t.is0())return Rh.slice();const o=!!(i*gh/r);return Ph(Yl(n,e),{compressed:!0,sort:o})}function Fh(t){const{infinity:e,sort:r,value:n}=Uh(Xl("signatureHex",t,48)),i=_h.ORDER,o=Dh.G1.Point,s=Zl(n);if(e)return o.ZERO;const a=_h.create(s&_h.MASK),c=_h.add(_h.pow(a,bh),_h.create(vh.b));let u=_h.sqrt(c);if(!u)throw new Error("invalid G1 point: compressed");const f=BigInt(r);u*gh/i!==f&&(u=_h.neg(u));const l=o.fromAffine({x:a,y:u});return l.assertValidity(),l}function Lh(t){t.assertValidity();const{BYTES:e}=_h;if(t.is0())return Tl(Rh,Yl(hh,e));const{x:r,y:n}=t.toAffine(),{re:i,im:o}=xh.reim(r),{re:s,im:a}=xh.reim(n),c=!!((a>hh?a*gh:s*gh)/_h.ORDER&ph),u=i;return Tl(Ph(Yl(o,e),{sort:c,compressed:!0}),Yl(u,e))}function Ch(t){const{ORDER:e}=_h,{infinity:r,sort:n,value:i}=Uh(Xl("signatureHex",t)),o=Dh.G2.Point,s=i.length/2;if(48!==s&&96!==s)throw new Error("invalid compressed signature length, expected 96/192 bytes");const a=Zl(i.slice(0,s)),c=Zl(i.slice(s));if(r)return o.ZERO;const u=_h.create(a&_h.MASK),f=_h.create(c),l=xh.create({c0:f,c1:u}),d=xh.add(xh.pow(l,bh),Oh.b);let h=xh.sqrt(d);if(!h)throw new Error("Failed to find a square root");const{re:p,im:g}=xh.reim(h),b=BigInt(n);(g>hh&&g*gh/e!==b||g===hh&&p*gh/e!==b)&&(h=xh.neg(h));const y=o.fromAffine({x:l,y:h});return y.assertValidity(),y}const Dh=function(t){const{Fp:e,Fr:r,Fp2:n,Fp6:i,Fp12:o}=t.fields,s=t.params.xNegative,a=t.params.twistType,c=rh(t.G1),u=Object.assign(c,Gd(c.Point,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),f=rh(t.G2),l=Object.assign(f,Gd(f.Point,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults}));let d;if("multiplicative"===a)d=(t,e,r,i,s,a)=>o.mul014(i,t,n.mul(e,s),n.mul(r,a));else{if("divisive"!==a)throw new Error("bls: unknown twist type");d=(t,e,r,i,s,a)=>o.mul034(i,n.mul(r,a),n.mul(e,s),t)}const h=n.div(n.ONE,n.mul(n.ONE,sh));function p(t,e,r,i){const o=n.sqr(r),s=n.sqr(i),a=n.mulByB(n.mul(s,ah)),c=n.mul(a,ah),u=n.sub(n.sub(n.sqr(n.add(r,i)),s),o),f=n.sub(a,o),l=n.mul(n.sqr(e),ah),d=n.neg(u);return t.push([f,l,d]),{Rx:e=n.mul(n.mul(n.mul(n.sub(o,c),e),r),h),Ry:r=n.sub(n.sqr(n.mul(n.add(o,c),h)),n.mul(n.sqr(a),ah)),Rz:i=n.mul(o,u)}}function g(t,e,r,i,o,s){const a=n.sub(r,n.mul(s,i)),c=n.sub(e,n.mul(o,i)),u=n.sub(n.mul(a,o),n.mul(c,s)),f=n.neg(a),l=c;t.push([u,f,l]);const d=n.sqr(c),h=n.mul(d,c),p=n.mul(d,e),g=n.add(n.sub(h,n.mul(p,sh)),n.mul(n.sqr(a),i));return{Rx:e=n.mul(c,g),Ry:r=n.sub(n.mul(n.sub(p,g),a),n.mul(h,r)),Rz:i=n.mul(i,h)}}const b=function(t){const e=[];for(;t>oh;t>>=oh)(t&oh)===ih?e.unshift(0):(t&ah)===ah?(e.unshift(-1),t+=oh):e.unshift(1);return e}(t.params.ateLoopSize),y=od((e=>{const r=e,{x:i,y:o}=r.toAffine(),s=i,a=o,c=n.neg(o);let u=s,f=a,l=n.ONE;const d=[];for(const t of b){const e=[];({Rx:u,Ry:f,Rz:l}=p(e,u,f,l)),t&&({Rx:u,Ry:f,Rz:l}=g(e,u,f,l,s,-1===t?c:a)),d.push(e)}if(t.postPrecompute){const e=d[d.length-1];t.postPrecompute(u,f,l,s,a,g.bind(null,e))}return d}));function m(t,e=!1){let r=o.ONE;if(t.length){const e=t[0][0].length;for(let n=0;n<e;n++){r=o.sqr(r);for(const[e,i,o]of t)for(const[t,s,a]of e[n])r=d(t,s,a,r,i,o)}}return s&&(r=o.conjugate(r)),e?o.finalExponentiate(r):r}function w(t,e=!0){const r=[];Nd(u.Point,"pz",t.map((({g1:t})=>t))),Nd(l.Point,"pz",t.map((({g2:t})=>t)));for(const{g1:e,g2:n}of t){if(e.is0()||n.is0())throw new Error("pairing is not available for ZERO point");e.assertValidity(),n.assertValidity();const t=e.toAffine();r.push([y(n),t.x,t.y])}return m(r,e)}const v=t.randomBytes||Rl,E={randomPrivateKey:()=>{const t=Id(r.ORDER);return function(t,e,r=!1){const n=t.length,i=Bd(e),o=Id(e);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const s=hd(r?Wl(t):Zl(t),e-ad)+ad;return r?Jl(s,i):Yl(s,i)}(v(t),r.ORDER)},calcPairingPrecomputes:y};function _(t){if(!Array.isArray(t)||0===t.length)throw new Error("expected non-empty array")}function x(t){return t instanceof u.Point?t:u.Point.fromHex(t)}function B(e,r){function n(t){return t instanceof e.Point?t:e.Point.fromHex(t)}function i(t){return t instanceof r.Point?t:r.Point.fromHex(t)}function s(t){if(!(t instanceof r.Point))throw new Error(`expected valid message hashed to ${a?"G2":"G1"} curve`);return t}const a=r.Point.Fp.BYTES>e.Point.Fp.BYTES;return{getPublicKey:t=>e.Point.fromPrivateKey(t),sign(t,r,n){if(null!=n)throw new Error("sign() expects 2 arguments");return s(t).assertValidity(),t.multiply(e.normPrivateKeyToScalar(r))},verify(t,r,c,u){if(null!=u)throw new Error("verify() expects 3 arguments");t=i(t);const f=(c=n(c)).negate(),l=e.Point.BASE,d=s(r),h=w(a?[{g1:f,g2:d},{g1:l,g2:t}]:[{g1:d,g2:f},{g1:t,g2:l}]);return o.eql(h,o.ONE)},aggregatePublicKeys(t){_(t);const r=(t=t.map((t=>n(t)))).reduce(((t,e)=>t.add(e)),e.Point.ZERO);return r.assertValidity(),r},aggregateSignatures(t){_(t);const e=(t=t.map((t=>i(t)))).reduce(((t,e)=>t.add(e)),r.Point.ZERO);return e.assertValidity(),e},hash(t,e){ll(t);const n=e?{DST:e}:void 0;return r.hashToCurve(t,n)},Signature:a?t.G2.Signature:t.G1.ShortSignature}}const I=B(u,l),A=B(l,u),{ShortSignature:S}=t.G1,{Signature:T}=t.G2;function N(t,e){return t instanceof u.Point?t:A.hash(Xl("point",t),e?.DST)}function O(t,e){return t instanceof l.Point?t:I.hash(Xl("point",t),e?.DST)}return u.Point.BASE.precompute(4),{longSignatures:I,shortSignatures:A,millerLoopBatch:m,pairing:function(t,e,r=!0){return w([{g1:t,g2:e}],r)},pairingBatch:w,verifyBatch:function(t,e,r,n){if(_(e),r.length!==e.length)throw new Error("amount of public keys and messages should be equal");const i=function(t){return t instanceof l.Point?t:T.fromHex(t)}(t),s=e.map((t=>O(t,n))),a=r.map(x),c=new Map;for(let t=0;t<a.length;t++){const e=a[t],r=s[t];let n=c.get(r);void 0===n&&(n=[],c.set(r,n)),n.push(e)}const f=[];try{for(const[t,e]of c){const r=e.reduce(((t,e)=>t.add(e)));f.push({g1:r,g2:t})}return f.push({g1:u.Point.BASE.negate(),g2:i}),o.eql(w(f),o.ONE)}catch{return!1}},curves:{G1:c.Point,G2:f.Point},fields:{Fr:r,Fp:e,Fp2:n,Fp6:i,Fp12:o},params:{ateLoopSize:t.params.ateLoopSize,twistType:t.params.twistType,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:E,getPublicKey:function(t){return I.getPublicKey(t).toBytes(!0)},getPublicKeyForShortSignatures:function(t){return A.getPublicKey(t).toBytes(!0)},sign:function(t,e,r){const n=O(t,r),i=I.sign(n,e);return t instanceof l.Point?i:T.toBytes(i)},signShortSignature:function(t,e,r){const n=N(t,r),i=A.sign(n,e);return t instanceof u.Point?i:S.toBytes(i)},verify:function(t,e,r,n){const i=O(e,n);return I.verify(t,i,r)},verifyShortSignature:function(t,e,r,n){const i=N(e,n);return A.verify(t,i,r)},aggregatePublicKeys:function(t){const e=I.aggregatePublicKeys(t);return t[0]instanceof u.Point?e:e.toBytes(!0)},aggregateSignatures:function(t){const e=I.aggregateSignatures(t);return t[0]instanceof l.Point?e:T.toBytes(e)},aggregateShortSignatures:function(t){const e=A.aggregateSignatures(t);return t[0]instanceof u.Point?e:S.toBytes(e)},G1:u,G2:l,Signature:T,ShortSignature:S}}({fields:{Fp:_h,Fp2:xh,Fp6:Bh,Fp12:Ah,Fr:Eh},G1:{...vh,Fp:_h,htfDefaults:{...Nh,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const r=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new t(_h.mul(e.px,r),e.py,e.pz);return e.multiplyUnsafe(mh).negate().multiplyUnsafe(mh).equals(n)},clearCofactor:(t,e)=>e.multiplyUnsafe(mh).add(e),mapToCurve:function(t){const{x:e,y:r}=qh(_h.create(t[0]));return $h(e,r)},fromBytes:function(t){const{compressed:e,infinity:r,sort:n,value:i}=Uh(t),{BYTES:o,ORDER:s}=_h;if(48===i.length&&e){const t=Zl(i),e=_h.create(t&_h.MASK);if(r){if(e!==hh)throw new Error("invalid G1 point: non-empty, at infinity, with compression");return{x:hh,y:hh}}const o=_h.add(_h.pow(e,bh),_h.create(vh.b));let a=_h.sqrt(o);if(!a)throw new Error("invalid G1 point: compressed point");return a*gh/s!==BigInt(n)&&(a=_h.neg(a)),{x:_h.create(e),y:_h.create(a)}}if(96!==i.length||e)throw new Error("invalid G1 point: expected 48/96 bytes");{const t=Zl(i.subarray(0,o)),e=Zl(i.subarray(o));if(r){if(t!==hh||e!==hh)throw new Error("G1: non-empty point at infinity");return Dh.G1.Point.ZERO.toAffine()}return{x:_h.create(t),y:_h.create(e)}}},toBytes:function(t,e,r){const{BYTES:n,ORDER:i}=_h,o=e.is0(),{x:s,y:a}=e.toAffine();if(r){if(o)return Rh.slice();const t=!!(a*gh/i);return Ph(Yl(s,n),{compressed:!0,sort:t})}return o?Tl(Uint8Array.of(64),new Uint8Array(2*n-1)):Tl(Yl(s,n),Yl(a,n))},ShortSignature:{fromBytes:t=>(ll(t),Fh(t)),fromHex:t=>Fh(t),toBytes:t=>kh(t),toRawBytes:t=>kh(t),toHex:t=>_l(kh(t))}},G2:{...Oh,Fp:xh,hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...Nh},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:function(t){const{x:e,y:r}=Mh(xh.fromBigTuple(t));return jh(e,r)},isTorsionFree:(t,e)=>e.multiplyUnsafe(mh).negate().equals(Sh(t,e)),clearCofactor:(t,e)=>{const r=mh;let n=e.multiplyUnsafe(r).negate(),i=Sh(t,e),o=e.double();return o=Th(t,o),o=o.subtract(i),i=n.add(i),i=i.multiplyUnsafe(r).negate(),o=o.add(i),o=o.subtract(n),o.subtract(e)},fromBytes:function(t){const{BYTES:e,ORDER:r}=_h,{compressed:n,infinity:i,sort:o,value:s}=Uh(t);if(!n&&!i&&o||!n&&i&&o||o&&i&&n)throw new Error("invalid encoding flag: "+(224&t[0]));const a=(t,e,r)=>Zl(t.slice(e,r));if(96===s.length&&n){if(i){if(s.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid G2 point: compressed");return{x:xh.ZERO,y:xh.ZERO}}const t=a(s,0,e),n=a(s,e,2*e),c=xh.create({c0:_h.create(n),c1:_h.create(t)}),u=xh.add(xh.pow(c,bh),Oh.b);let f=xh.sqrt(u);const l=f.c1===hh?f.c0*gh/r:f.c1*gh/r?ph:hh;return f=o&&l>0?f:xh.neg(f),{x:c,y:f}}if(192!==s.length||n)throw new Error("invalid G2 point: expected 96/192 bytes");{if(i){if(s.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid G2 point: uncompressed");return{x:xh.ZERO,y:xh.ZERO}}const t=a(s,0*e,1*e),r=a(s,1*e,2*e),n=a(s,2*e,3*e),o=a(s,3*e,4*e);return{x:xh.fromBigTuple([r,t]),y:xh.fromBigTuple([o,n])}}},toBytes:function(t,e,r){const{BYTES:n,ORDER:i}=_h,o=e.is0(),{x:s,y:a}=e.toAffine();if(r){if(o)return Tl(Rh,Yl(hh,n));const t=!!(a.c1===hh?a.c0*gh/i:a.c1*gh/i);return Tl(Ph(Yl(s.c1,n),{compressed:!0,sort:t}),Yl(s.c0,n))}{if(o)return Tl(Uint8Array.of(64),new Uint8Array(4*n-1));const{re:t,im:e}=xh.reim(s),{re:r,im:i}=xh.reim(a);return Tl(Yl(e,n),Yl(t,n),Yl(i,n),Yl(r,n))}},Signature:{fromBytes:t=>(ll(t),Ch(t)),fromHex:t=>Ch(t),toBytes:t=>Lh(t),toRawBytes:t=>Lh(t),toHex:t=>_l(Lh(t))}},params:{ateLoopSize:mh,r:vh.n,xNegative:!0,twistType:"multiplicative"},htfDefaults:Nh,hash:Vl}),jh=zd(xh,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map((t=>t.map((t=>xh.fromBigTuple(t.map(BigInt))))))),$h=zd(_h,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map((t=>t.map((t=>BigInt(t)))))),qh=nh(_h,{A:_h.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:_h.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:_h.create(BigInt(11))}),Mh=nh(xh,{A:xh.create({c0:_h.create(hh),c1:_h.create(BigInt(240))}),B:xh.create({c0:_h.create(BigInt(1012)),c1:_h.create(BigInt(1012))}),Z:xh.create({c0:_h.create(BigInt(-2)),c1:_h.create(BigInt(-1))})});const Vh=BigInt(0),zh=BigInt(1),Gh=BigInt(2),Kh=BigInt(7),Hh=BigInt(256),Zh=BigInt(113),Wh=[],Yh=[],Jh=[];for(let t=0,e=zh,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],Wh.push(2*(5*n+r)),Yh.push((t+1)*(t+2)/2%64);let i=Vh;for(let t=0;t<7;t++)e=(e<<zh^(e>>Kh)*Zh)%Hh,e&Gh&&(i^=zh<<(zh<<BigInt(t))-zh);Jh.push(i)}const Xh=jl(Jh,!0),Qh=Xh[0],tp=Xh[1],ep=(t,e,r)=>r>32?((t,e,r)=>e<<r-32|t>>>64-r)(t,e,r):((t,e,r)=>t<<r|e>>>32-r)(t,e,r),rp=(t,e,r)=>r>32?((t,e,r)=>t<<r-32|e>>>64-r)(t,e,r):((t,e,r)=>e<<r|t>>>32-r)(t,e,r);class np extends Nl{constructor(t,e,r,n=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=i,fl(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");var o;this.state=new Uint8Array(200),this.state32=(o=this.state,new Uint32Array(o.buffer,o.byteOffset,Math.floor(o.byteLength/4)))}clone(){return this._cloneInto()}keccak(){wl(this.state32),function(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){const n=(e+8)%10,i=(e+2)%10,o=r[i],s=r[i+1],a=ep(o,s,1)^r[n],c=rp(o,s,1)^r[n+1];for(let r=0;r<50;r+=10)t[e+r]^=a,t[e+r+1]^=c}let e=t[2],i=t[3];for(let r=0;r<24;r++){const n=Yh[r],o=ep(e,i,n),s=rp(e,i,n),a=Wh[r];e=t[a],i=t[a+1],t[a]=o,t[a+1]=s}for(let e=0;e<50;e+=10){for(let n=0;n<10;n++)r[n]=t[e+n];for(let n=0;n<10;n++)t[e+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=Qh[n],t[1]^=tp[n]}gl(r)}(this.state32,this.rounds),wl(this.state32),this.posOut=0,this.pos=0}update(t){hl(this),ll(t=Sl(t));const{blockLen:e,state:r}=this,n=t.length;for(let i=0;i<n;){const o=Math.min(e-this.pos,n-i);for(let e=0;e<o;e++)r[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:r,blockLen:n}=this;t[r]^=e,0!=(128&e)&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){hl(this,!1),ll(t),this.finish();const e=this.state,{blockLen:r}=this;for(let n=0,i=t.length;n<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-n);t.set(e.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return fl(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(pl(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,gl(this.state)}_cloneInto(t){const{blockLen:e,suffix:r,outputLen:n,rounds:i,enableXOF:o}=this;return t||(t=new np(e,r,n,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=n,t.enableXOF=o,t.destroyed=this.destroyed,t}}var ip,op,sp;ip=31,op=136,sp=32,function(t){const e=(e,r)=>t(r).update(Sl(e)).digest(),r=t({});e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e)}(((t={})=>new np(op,ip,void 0===t.dkLen?sp:t.dkLen,!0)));const ap=Uint8Array.from([0]),cp=Uint8Array.of();const up=(t,e,r,n,i)=>function(t,e,r,n=32){dl(t),fl(n);const i=t.outputLen;if(n>255*i)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(n/i);void 0===r&&(r=cp);const s=new Uint8Array(o*i),a=Hd.create(t,e),c=a._cloneInto(),u=new Uint8Array(a.outputLen);for(let t=0;t<o;t++)ap[0]=t+1,c.update(0===t?cp:u).update(r).update(ap).digestInto(u),s.set(u,i*t),a._cloneInto(c);return a.destroy(),c.destroy(),gl(u,ap),s.slice(0,n)}(t,function(t,e,r){return dl(t),void 0===r&&(r=new Uint8Array(t.outputLen)),Hd(t,Sl(r),Sl(e))}(t,e,r),n,i),fp=Vl,lp=48;class dp{#t;#e;static random(){return new dp(Dh.utils.randomPrivateKey())}static deserialize(t){if(32!==t.length)throw new Error("Invalid size for transport secret key");return new dp(t)}publicKeyBytes(){return this.#e.toRawBytes(!0)}serialize(){return this.#t}constructor(t){this.#t=t;const e=Dh.G1.ProjectivePoint.fromPrivateKey(this.#t);this.#e=e}}function hp(t){let e=t.length;const r=new Uint8Array(8+e);for(let t=7;t>=0;t--)r[t]=255&e,e>>>=8;return r.set(t,8),r}class pp{#t;static deserialize(t){return new pp(Dh.G2.ProjectivePoint.fromHex(t))}deriveKey(t){if(0===t.length)return this;{const e="ic-vetkd-bls12-381-g2-context",r=this.publicKeyBytes(),n=function(t,e){const r={p:Dh.params.r,m:1,DST:e},n=Object.assign({},Dh.G2.CURVE.htfDefaults,r);return Vd(t,1,n)[0][0]}(new Uint8Array([...hp(r),...hp(t)]),e),i=Dh.G2.ProjectivePoint.BASE.multiply(n);return new pp(this.getPoint().add(i))}}publicKeyBytes(){return this.#t.toRawBytes(!0)}getPoint(){return this.#t}constructor(t){this.#t=t}}function gp(t){return"string"==typeof t?(new TextEncoder).encode(t):t}function bp(t,e,r){const n=Dh.G2.ProjectivePoint.BASE.negate(),i=Dh.fields.Fp12.ONE,o=r instanceof Dh.G1.ProjectivePoint?r:Dh.G1.ProjectivePoint.fromHex(r),s=function(t,e){const r=t.publicKeyBytes(),n=new Uint8Array([...r,...e]);return Dh.G1.ProjectivePoint.fromAffine(Dh.G1.hashToCurve(n,{DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_AUG_"}).toAffine())}(t,e),a=Dh.pairingBatch([{g1:o,g2:n},{g1:s,g2:t.getPoint()}]);return Dh.fields.Fp12.eql(a,i)}class yp{#t;#e;signatureBytes(){return this.#e}serialize(){return this.#e}deriveSymmetricKey(t,e){return function(t,e,r){const n=new Uint8Array;return up(fp,t,n,e,r)}(this.#e,t,e)}async asDerivedKeyMaterial(){return mp.setup(this.#e)}static deserialize(t){return new yp(Dh.G1.ProjectivePoint.fromHex(t))}getPoint(){return this.#t}constructor(t){this.#t=t,this.#e=t.toRawBytes(!0)}}class mp{#t;constructor(t){this.#t=t}static fromCryptoKey(t){return new mp(t)}static async setup(t){const e=await globalThis.crypto.subtle.importKey("raw",t,"HKDF",!1,["deriveKey"]);return new mp(e)}getCryptoKey(){return this.#t}async deriveAesGcmCryptoKey(t){const e={name:"HKDF",hash:"SHA-256",length:256,info:gp(t),salt:new Uint8Array};return globalThis.crypto.subtle.deriveKey(e,this.#t,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async encryptMessage(t,e){const r=await this.deriveAesGcmCryptoKey(e),n=globalThis.crypto.getRandomValues(new Uint8Array(12)),i=new Uint8Array(await globalThis.crypto.subtle.encrypt({name:"AES-GCM",iv:n},r,gp(t)));return new Uint8Array([...n,...i])}async decryptMessage(t,e){if(t.length<28)throw new Error("Invalid ciphertext, too short to possibly be valid");const r=t.slice(0,12),n=t.slice(12),i=await this.deriveAesGcmCryptoKey(e);try{const t=await globalThis.crypto.subtle.decrypt({name:"AES-GCM",iv:r},i,n);return new Uint8Array(t)}catch{throw new Error("Decryption failed")}}}class wp{#t;#e;#r;static deserialize(t){if(192!==t.length)throw new Error("Invalid EncryptedVetKey serialization");const e=Dh.G1.ProjectivePoint.fromHex(t.subarray(0,lp)),r=Dh.G2.ProjectivePoint.fromHex(t.subarray(lp,144)),n=Dh.G1.ProjectivePoint.fromHex(t.subarray(144));return new wp(e,r,n)}decryptAndVerify(t,e,r){const n=Dh.G1.ProjectivePoint.BASE,i=Dh.G2.ProjectivePoint.BASE.negate(),o=Dh.fields.Fp12.ONE,s=Dh.pairingBatch([{g1:this.#t,g2:i},{g1:n,g2:this.#e}]);if(!Dh.fields.Fp12.eql(s,o))throw new Error("Invalid VetKey");const a=this.#r.subtract(this.#t.multiply(Dh.G1.normPrivateKeyToScalar(t.serialize())));if(bp(e,r,a))return new yp(a);throw new Error("Invalid VetKey")}constructor(t,e,r){this.#t=t,this.#e=e,this.#r=r}}class vp{constructor(t){this.actor=t}async encryptWithNoteKey(t,e,r){await this.fetch_note_key_if_needed(t,e);const n=await al([t.toString(),e]),i=Uint8Array.from([...r].map((t=>t.charCodeAt(0)))).buffer,o=window.crypto.getRandomValues(new Uint8Array(12)),s=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},n,i);return String.fromCharCode(...new Uint8Array(o))+String.fromCharCode(...new Uint8Array(s))}async decryptWithNoteKey(t,e,r){await this.fetch_note_key_if_needed(t,e);const n=await al([t.toString(),e]);if(r.length<13)throw new Error("wrong encoding, too short to contain iv");const i=r.slice(0,12),o=r.slice(12),s=Uint8Array.from([...i].map((t=>t.charCodeAt(0)))).buffer,a=Uint8Array.from([...o].map((t=>t.charCodeAt(0)))).buffer;let c=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:s},n,a);return String.fromCharCode(...new Uint8Array(c))}async fetch_note_key_if_needed(t,e){if(!await al([t.toString(),e])){const r=dp.random(),n=await this.actor.encrypted_symmetric_key_for_note(t,r.publicKeyBytes()),i=wp.deserialize(Ep(n)),o=await this.actor.symmetric_key_verification_key_for_note(),s=pp.deserialize(Ep(o)),a=function(t){var e=BigInt(t).toString(16);for(;e.length<32;)e="0"+e;var r=e.length/2,n=new Uint8Array(r),i=0,o=0;for(;i<r;)n[i]=parseInt(e.slice(o,o+2),16),i+=1,o+=2;return n}(t),c=(new TextEncoder).encode(e);let u=new Uint8Array(a.length+c.length);u.set(a),u.set(c,a.length);const f=i.decryptAndVerify(r,s,u),l=await(await f.asDerivedKeyMaterial()).deriveAesGcmCryptoKey("note-key");await function(t,e,r=sl()){return r("readwrite",(r=>(r.put(e,t),il(r.transaction))))}([t.toString(),e],l)}}}const Ep=t=>Uint8Array.from(t.match(/.{1,2}/g).map((t=>parseInt(t,16))));let _p=0;const xp=vt([]);function Bp(t,e=2e3){const r=_p++;xp.update((e=>[...e,Object.assign(Object.assign({},t),{id:r})])),setTimeout((()=>{xp.update((t=>t.filter((t=>t.id!=r))))}),e)}function Ip(t){Bp({type:"error",message:t})}function Ap(t){Bp({type:"success",message:t})}const{set:Sp,subscribe:Tp}=vt({}),Np={subscribe:Tp,set:Sp,remove:()=>{Sp({})}},Op=(t,e="")=>{const r=new URL(t);function n(){return o(e).reduce(((t,e,r)=>(":"===e[0]&&t.push({value:e.slice(1),index:r}),t)),[])}function i(){return o(r.pathname)}function o(t){return"/"===t||0===t.trim().length?[t]:("/"===t.slice(-1)&&(t=t.slice(0,-1)),"/"===t[0]&&(t=t.slice(1)),t.split("/"))}return Object.freeze({hash:r.hash,host:r.host,hostname:r.hostname,namedParams:function(){const t=i();return n().reduce(((e,r)=>(e[r.value]=t[r.index],e)),{})}(),namedParamsKeys:n().reduce(((t,e)=>(t.push(e.value),t)),[]),namedParamsValues:function(){const t=i();return n().reduce(((e,r)=>(e.push(t[r.index]),e)),[])}(),pathNames:i(),port:r.port,pathname:r.pathname,protocol:r.protocol,search:r.search,queryParams:function(){const t={};return r.searchParams.forEach(((e,r)=>{t[r]=e})),t}(),queryParamsKeys:function(){const t=[];return r.searchParams.forEach(((e,r)=>{t.push(r)})),t}(),queryParamsValues:function(){const t=[];return r.searchParams.forEach((e=>{t.push(e)})),t}()})},Rp=t=>{let e=!1;return 0===Object.keys(t).length||(t.childRoute&&0===Object.keys(t.childRoute).length?e=!0:t.childRoute&&(e=Rp(t.childRoute)),e)},Up=(t,e)=>(e=Dp(e)).includes(":")?e.includes(t):e.startsWith(t),Pp=(t,e,r)=>{let n=!1;if(r)return{exists:e.lang&&e.lang[r]&&e.lang[r].includes(t),language:r};if(n=Up(t,e.name),!n&&e.lang&&"object"==typeof e.lang)for(const[i,o]of Object.entries(e.lang))Up(t,o)&&(n=!0,r=i);return{exists:n,language:r}},kp=(t="")=>{if(0===t.trim().length)return[];return Fp(t).reduce(((t,e)=>(":"===e[0]&&t.push(e.slice(1)),t)),[])},Fp=t=>"/"===t||0===t.trim().length?[t]:(t=Dp(t,"both")).split("/"),Lp=(t="")=>{let e;return"/"===t||0===t.trim().length?t:(e=(t=Dp(t,"lead")).split(":")[0],e=Dp(e,"trail"),e.toLowerCase())},Cp=(t,e)=>{const r=e.split("/");return r.length>1&&r.forEach((function(e,r){e.length>0&&r>0&&t.shift()})),t},Dp=(t,e="lead")=>("trail"!==e&&"both"!==e||(t=t.replace(/\/$/,"")),"lead"!==e&&"both"!==e||(t=t.replace(/^\//,"")),t),jp=(t,e=null)=>e&&t.lang&&t.lang[e]?t.lang[e]:t.name,$p=(t,e,r,n,i=!1)=>{if("/"===t||0===t.trim().length)return{result:t,language:null};let o=t,s=r.name,a=n;if(i&&(a=""),s=Dp(s),o=Dp(o),r.childRoute)return{result:t,language:a};{let t=Pp(o,r,a);t.exists&&i&&(o=jp(r,n));let c=s.split(":")[0];return c=Dp(c,"trail"),c=c.split("/"),c.shift(),c.forEach((()=>{const s=e[0];if(t=Pp(`${o}/${s}`,r,a),!s||!t.exists)return{result:o,language:t.language};o=i?jp(r,n):`${o}/${s}`,e.shift()})),{result:o,language:t.language}}},qp=t=>{const e=t||!1;let r="";const n=(t,r)=>{if("undefined"!=typeof window){const n=(t=>{let e=[];if(t.queryParams)for(let[r,n]of Object.entries(t.queryParams))e.push(`${r}=${n}`);const r=t.hash?t.hash:"";return e.length>0?`${t.path}?${e.join("&")}${r}`:t.path+r})(t);r&&window.history.pushState({page:n},"",n),e&&i(n)}},i=t=>{"undefined"!=typeof ga&&(ga("set","page",t),ga("send","pageview"))};return Object.freeze({active:()=>r,isActive:(t,e=!1)=>{"/"!==t[0]&&(t="/"+t);let n=Op(`http://fake.com${t}`).pathname,i=Op(`http://fake.com${r}`).pathname;return n=Dp(n,"trail"),i=Dp(i,"trail"),e?i.includes(n):i===n},setActive:(t,e)=>{r=t.path,n(t,e)}})},Mp=(t,e)=>{const r=(t=>{const e=t;return Object.freeze({valid:()=>e&&e.guard&&"function"==typeof e.guard,redirect:()=>!e.guard(),redirectPath:()=>{let t="/";return e.redirect&&e.redirect.length>0&&(t=e.redirect),t}})})(t.onlyIf);return Object.freeze({path:()=>{let n=e;return t.redirectTo&&t.redirectTo.length>0&&(n=t.redirectTo),r.valid()&&r.redirect()&&(n=r.redirectPath()),n}})};function Vp({routes:t,currentUrl:e,routerOptions:r,convert:n}){const i=r.defaultLanguage,o=r.prefix?r.prefix.toLowerCase():"",s=function(t,e){if(e&&e.trim().length>0){const r=t.endsWith(e)?e:e+"/",n=t.replace(r,"");return Op(n)}return Op(t)}(e,o);let a="",c={},u=!1;function f(t,e,r,n,o){let l={};const d=function({basePath:t,basePathName:e,pathNames:r,convert:n,currentLanguage:i}){let o,s,a=i;function c(){return jp(s,a)}function u(){return Lp(c())}function f(){return Lp(o.result)}return Object.freeze({basePathSameAsLocalised:function(){return f()===u()},updatedPath:function(t){return s=t,o=$p(e,r,s,a,n),a=n?i:o.language,o},basePathNameWithoutNamedParams:f,localisedPathName:c,localisedRouteWithoutNamedParams:u,namedPath:function(){let e=c();return e&&!e.startsWith("/")&&(e="/"+e),t?`${t}${e}`:e},pathNames:r,routeLanguage:function(){return a},routePath:function(){let e=`${t}/${f()}`;"//"===e&&(e="/"),a&&(r=Cp(r,u()));const n=kp(c());return n&&n.length>0&&n.forEach((function(){r.length>0&&(e+=`/${r.shift()}`)})),e}})}({basePath:e,basePathName:r.shift().toLowerCase(),pathNames:r,convert:o,currentLanguage:n});return u=!1,t.forEach((function(t){if(d.updatedPath(t),function(t,e){const r=t.basePathSameAsLocalised();r&&(u=!0);return r||!u&&(t=>Dp(t).startsWith(":"))(e)}(d,t.name)){let e=d.routePath();if(a=Mp(t,a).path(),l.name!==e&&(l=function({route:t,routePath:e,routeLanguage:r,urlParser:n,namedPath:o}){const s=function({routeInfo:t,path:e,routeNamedParams:r,urlParser:n,namedPath:i,language:o}){const s=()=>{const t=Op(`https://fake.com${n.pathname}`,i).namedParams;return{...r,...t}};return Object.freeze({get:()=>({name:e,component:t.component,hash:n.hash,layout:t.layout,queryParams:n.queryParams,namedParams:s(),path:e,language:o}),namedParams:s})}({routeInfo:t,urlParser:n,path:e,routeNamedParams:c,namedPath:o,language:r||i});return c=s.namedParams(),s.get()}({route:t,routePath:e,routeLanguage:d.routeLanguage(),urlParser:s,namedPath:d.namedPath()})),t.nestedRoutes&&t.nestedRoutes.length>0&&d.pathNames.length>0)l.childRoute=f(t.nestedRoutes,e,d.pathNames,d.routeLanguage(),o),l.path=l.childRoute.path,l.language=l.childRoute.language;else if(function(t,e){return t.nestedRoutes&&t.nestedRoutes.length>0&&0===e.length}(t,d.pathNames)){const r=f(t.nestedRoutes,e,["index"],d.routeLanguage(),o);r&&Object.keys(r).length>0&&(l.childRoute=r,l.language=l.childRoute.language)}}})),a&&(l.redirectTo=a),l}const l=e=>{const r=t.find((t=>"404"==t.name)),n=e||i||"";return r?{...r,language:n,path:"404"}:{name:"404",component:"",path:"404",redirectTo:"/404.html"}};return Object.freeze({findActiveRoute:function(){let e=f(t,"",s.pathNames,r.lang,n);return e&&Object.keys(e).length&&!Rp(e)?(e.path=e.path.split("?")[0],o&&(e.path=`/${o}${e.path}`)):"undefined"!=typeof window&&(e=l(r.lang)),e}})}const zp="/404.html";let Gp,Kp=[],Hp={};const Zp=(t,e,r={})=>{Hp={...r},void 0!==e&&""!==e||(e=document.location.href),Gp=qp(Hp.gaPageviews),e=Dp(e,"trail"),Kp=t;const n=()=>{let r=!1;return Hp.langConvertTo&&(Hp.lang=Hp.langConvertTo,r=!0),Vp({routes:t,currentUrl:e,routerOptions:Hp,convert:r}).findActiveRoute()};return Object.freeze({setActiveRoute:(t=!0)=>{const e=n();return e.redirectTo?((t,e)=>("undefined"!=typeof window&&(t===zp?Gp.setActive({path:zp},e):Wp(t)),t))(e.redirectTo,t):(Gp.setActive(e,t),Np.set(e),e)},findActiveRoute:n})},Wp=(t,e=null,r=!0)=>(t=Dp(t,"lead"),e&&(Hp.langConvertTo=e),Zp(Kp,"http://fake.com/"+t,Hp).setActiveRoute(r));"undefined"!=typeof window&&(window.addEventListener("click",(t=>{if("a"!==t.target.localName.toLowerCase())return;if(t.metaKey||t.ctrlKey||t.shiftKey)return;const e=Hp.prefix?`/${Hp.prefix.toLowerCase()}`:"",r=t.target.pathname&&t.target.host===window.location.host,n=!(e.length>1)||t.target.pathname.startsWith(e);if(r&&n){t.preventDefault();const e=t.target.pathname+t.target.search+t.target.search+t.target.hash;"_blank"===t.target.target?window.open(e,"newTab"):Wp(e)}})),window.onpopstate=function(t){let e=window.location.pathname+window.location.search+window.location.hash;Wp(e,null,!1)});const Yp=vt({state:"initializing-auth"});function Jp(){const t=c(Yp);"anonymous"===t.state&&t.client.login({maxTimeToLive:BigInt(1800)*BigInt(1e9),identityProvider:"ic"===process.env.DFX_NETWORK?"https://identity.ic0.app/#authorize":"http://rdmx6-jaaaa-aaaaa-aaadq-cai.localhost:8000/#authorize",onSuccess:()=>Xp(t.client)})}async function Xp(t){setTimeout((()=>{try{const t=JSON.parse(window.localStorage.getItem("ic-delegation")),e=Number.parseInt(t.delegations[0].delegation.expiration,16)/1e6;setTimeout((()=>{!async function(){const t=c(Yp);"initialized"===t.state&&(await t.client.logout(),Yp.update((()=>({state:"anonymous",actor:Ku(),client:t.client}))),Wp("/"))}()}),e-Date.now())}catch(t){console.error("Could not handle delegation expiry.")}}));try{const e=Ku({agentOptions:{identity:t.getIdentity()}});Yp.update((()=>({state:"initializing-crypto",actor:e,client:t})));const r=new vp(e);Yp.update((()=>({state:"initialized",actor:e,client:t,crypto:r})))}catch(t){Yp.update((()=>({state:"error",error:t.message||"An error occurred"})))}}function Qp(e){let r,n;return{c(){r=x("strong"),r.textContent="Disclaimer:",n=I(" This sample dapp is intended exclusively for experimental\npurpose. You are advised not to use this dapp for storing your critical data such\nas keys or passwords.")},m(t,e){v(t,r,e),v(t,n,e)},p:t,i:t,o:t,d(t){t&&E(r),t&&E(n)}}}!async function(){const t=await rl.create();await t.isAuthenticated()?Xp(t):Yp.update((()=>({state:"anonymous",actor:Ku(),client:t})))}();class tg extends mt{constructor(t){super(),yt(this,t,null,Qp,s,{})}}function eg(e){let r;return{c(){r=x("span"),N(r,"class","inline-block h-4 w-4 rounded-full mr-2 border-2 animate-spin border-b-current border-r-current border-t-transparent border-l-transparent")},m(t,e){v(t,r,e)},p:t,i:t,o:t,d(t){t&&E(r)}}}class rg extends mt{constructor(t){super(),yt(this,t,null,eg,s,{})}}function ng(e){let r;return{c(){r=x("div"),r.textContent="An error occurred.",N(r,"class","text-lg font-semibold mt-8")},m(t,e){v(t,r,e)},p:t,i:t,o:t,d(t){t&&E(r)}}}function ig(e){let r,n,i;return{c(){r=x("button"),r.textContent="Login with Internet Identity to manage synthetic datasets",N(r,"class","btn btn-primary")},m(t,o){v(t,r,o),n||(i=T(r,"click",e[1]),n=!0)},p:t,i:t,o:t,d(t){t&&E(r),n=!1,i()}}}function og(e){let r,n,i,o;return n=new rg({}),{c(){r=x("div"),ht(n.$$.fragment),i=I("\n          Synchronizing... Please keep the app open on a device that's already added."),N(r,"class","text-lg font-semibold")},m(t,e){v(t,r,e),pt(n,r,null),y(r,i),o=!0},p:t,i(t){o||(ut(n.$$.fragment,t),o=!0)},o(t){ft(n.$$.fragment,t),o=!1},d(t){t&&E(r),gt(n)}}}function sg(e){let r,n,i,o;return n=new rg({}),{c(){r=x("div"),ht(n.$$.fragment),i=I("\n          Initializing..."),N(r,"class","text-lg font-semibold mt-8")},m(t,e){v(t,r,e),pt(n,r,null),y(r,i),o=!0},p:t,i(t){o||(ut(n.$$.fragment,t),o=!0)},o(t){ft(n.$$.fragment,t),o=!1},d(t){t&&E(r),gt(n)}}}function ag(t){let e,r,n,i,o,s,a,c,u,f,l,d,h,p,g,b,m;const w=[sg,og,ig,ng],_=[];function B(t,e){return"initializing-auth"===t[0].state||"initializing-crypto"===t[0].state?0:"synchronizing"===t[0].state?1:"anonymous"===t[0].state?2:"error"===t[0].state?3:-1}return~(f=B(t))&&(l=_[f]=w[f](t)),p=new tg({}),{c(){e=x("div"),r=x("div"),n=x("div"),i=x("h1"),i.textContent="Synthetic Data Manager",o=A(),s=x("p"),s.textContent="Secure synthetic data management platform on the Internet Computer.",a=A(),c=x("p"),c.textContent="Upload, manage, and share synthetic datasets with privacy-preserving encryption and access controls.",u=A(),l&&l.c(),d=A(),h=x("div"),ht(p.$$.fragment),g=A(),b=x("div"),b.innerHTML='<img src="/img/ic-badge-powered-by-crypto_label-stripe-white-text.png" alt="Powered by the Internet Computer" class="hidden dark:inline h-4"/> \n    <img src="/img/ic-badge-powered-by-crypto_label-stripe-dark-text.png" alt="Powered by the Internet Computer" class="dark:hidden inline h-4"/>',N(i,"class","mb-5 text-4xl sm:text-5xl font-bold text-primary dark:text-white"),N(s,"class","mb-5 text-xl font-semibold"),N(c,"class","mb-5"),N(h,"class","text-xs mt-8 sm:mt-12 opacity-75 mb-12 sm:mb-32"),N(n,"class","max-w-xl "),N(r,"class","text-center hero-content "),N(b,"class","fixed bottom-0 text-center left-0 right-0 pb-4 sm:pb-8"),N(e,"class","hero min-h-screen pt-8 sm:pt-0 content-start sm:content-center")},m(t,l){v(t,e,l),y(e,r),y(r,n),y(n,i),y(n,o),y(n,s),y(n,a),y(n,c),y(n,u),~f&&_[f].m(n,null),y(n,d),y(n,h),pt(p,h,null),y(e,g),y(e,b),m=!0},p(t,[e]){let r=f;f=B(t),f===r?~f&&_[f].p(t,e):(l&&(at(),ft(_[r],1,1,(()=>{_[r]=null})),ct()),~f?(l=_[f],l?l.p(t,e):(l=_[f]=w[f](t),l.c()),ut(l,1),l.m(n,d)):l=null)},i(t){m||(ut(l),ut(p.$$.fragment,t),m=!0)},o(t){ft(l),ft(p.$$.fragment,t),m=!1},d(t){t&&E(e),~f&&_[f].d(),gt(p)}}}function cg(t,e,r){let{auth:n}=e;return t.$$set=t=>{"auth"in t&&r(0,n=t.auth)},[n,()=>Jp()]}class ug extends mt{constructor(t){super(),yt(this,t,cg,ag,s,{auth:0})}}function fg(e){let r;return{c(){r=x("div"),r.innerHTML='<svg class="w-12 h-12 mx-auto mb-4" stroke="currentColor" fill="none" viewBox="0 0 48 48"><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg> \n          <p class="text-lg font-semibold mb-2">Drop your CSV file here</p> \n          <p class="text-sm mb-4">or click to browse</p>',N(r,"class","text-base-content/70")},m(t,e){v(t,r,e)},p:t,d(t){t&&E(r)}}}function lg(t){let e,r,n,i,o,s,a,c,u,f,l,d=t[1].split("\n").length-1+"";return{c(){e=x("div"),r=B("svg"),n=B("path"),i=B("path"),o=A(),s=x("p"),a=I(t[0]),c=A(),u=x("p"),f=I(d),l=I(" rows detected"),N(n,"d","M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"),N(i,"fill-rule","evenodd"),N(i,"d","M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6.5a1.5 1.5 0 01-1.5 1.5h-7A1.5 1.5 0 014 11.5V5zm8 5a1 1 0 10-2 0v1.5a.5.5 0 01-.5.5h-3a.5.5 0 01-.5-.5V10a1 1 0 10-2 0v1.5A2.5 2.5 0 006.5 14h3a2.5 2.5 0 002.5-2.5V10z"),N(i,"clip-rule","evenodd"),N(r,"class","w-12 h-12 mx-auto mb-2"),N(r,"fill","currentColor"),N(r,"viewBox","0 0 20 20"),N(s,"class","font-semibold"),N(u,"class","text-sm opacity-70"),N(e,"class","text-success mb-4")},m(t,d){v(t,e,d),y(e,r),y(r,n),y(r,i),y(e,o),y(e,s),y(s,a),y(e,c),y(e,u),y(u,f),y(u,l)},p(t,e){1&e&&O(a,t[0]),2&e&&d!==(d=t[1].split("\n").length-1+"")&&O(f,d)},d(t){t&&E(e)}}}function dg(t){let e,r,n,i,o,s,a,c=t[1].split("\n").slice(0,6).join("\n")+"",u=t[1].split("\n").length>6?"\n...":"";return{c(){e=x("div"),r=x("h3"),r.textContent="Preview",n=A(),i=x("div"),o=x("pre"),s=I(c),a=I(u),N(r,"class","font-semibold mb-2"),N(o,"class","text-xs"),N(i,"class","bg-base-200 p-4 rounded-lg max-h-48 overflow-auto"),N(e,"class","mt-6")},m(t,c){v(t,e,c),y(e,r),y(e,n),y(e,i),y(i,o),y(o,s),y(o,a)},p(t,e){2&e&&c!==(c=t[1].split("\n").slice(0,6).join("\n")+"")&&O(s,c),2&e&&u!==(u=t[1].split("\n").length>6?"\n...":"")&&O(a,u)},d(t){t&&E(e)}}}function hg(t){let e;return{c(){e=I("Upload Dataset")},m(t,r){v(t,e,r)},d(t){t&&E(e)}}}function pg(t){let e,r;return{c(){e=x("span"),r=I("\n          Uploading..."),N(e,"class","loading loading-spinner loading-sm")},m(t,n){v(t,e,n),v(t,r,n)},d(t){t&&E(e),t&&E(r)}}}function gg(e){let r,n,o,s,a,c,u,f,l,d,h,p,g,b,m,w,_,B,S,O,R,U,P,k,F,L;function C(t,e){return t[0]?lg:fg}let D=C(e),j=D(e),$=e[1]&&dg(e);function q(t,e){return t[2]?pg:hg}let M=q(e),V=M(e);return{c(){r=x("div"),n=x("div"),o=x("h2"),o.textContent="Upload CSV Dataset",s=A(),a=x("div"),j.c(),c=A(),u=x("input"),f=A(),l=x("button"),d=I("Browse Files"),p=A(),g=x("div"),g.textContent="OR",b=A(),m=x("div"),w=x("button"),_=I("Load Sample Employee Data"),B=A(),S=x("p"),S.textContent="Loads a sample CSV with employee information for testing",O=A(),$&&$.c(),R=A(),U=x("div"),P=x("button"),V.c(),N(o,"class","card-title mb-4"),N(u,"type","file"),N(u,"accept",".csv"),N(u,"class","hidden"),N(l,"class","btn btn-outline btn-sm"),l.disabled=e[2],N(a,"class",h="border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(e[3]?"border-primary bg-primary/10":"border-base-300")),N(g,"class","divider"),N(w,"class","btn btn-secondary btn-outline"),w.disabled=e[2],N(S,"class","text-xs text-base-content/60 mt-2"),N(m,"class","text-center"),N(P,"class","btn btn-primary"),P.disabled=k=!e[1]||e[2],N(U,"class","card-actions justify-end mt-6"),N(n,"class","card-body"),N(r,"class","card bg-base-100 shadow-xl")},m(t,i){v(t,r,i),y(r,n),y(n,o),y(n,s),y(n,a),j.m(a,null),y(a,c),y(a,u),e[11](u),y(a,f),y(a,l),y(l,d),y(n,p),y(n,g),y(n,b),y(n,m),y(m,w),y(w,_),y(m,B),y(m,S),y(n,O),$&&$.m(n,null),y(n,R),y(n,U),y(U,P),V.m(P,null),F||(L=[T(u,"change",e[5]),T(l,"click",e[12]),T(a,"drop",e[6]),T(a,"dragover",e[7]),T(a,"dragleave",e[8]),T(w,"click",e[9]),T(P,"click",e[10])],F=!0)},p(t,[e]){D===(D=C(t))&&j?j.p(t,e):(j.d(1),j=D(t),j&&(j.c(),j.m(a,c))),4&e&&(l.disabled=t[2]),8&e&&h!==(h="border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(t[3]?"border-primary bg-primary/10":"border-base-300"))&&N(a,"class",h),4&e&&(w.disabled=t[2]),t[1]?$?$.p(t,e):($=dg(t),$.c(),$.m(n,R)):$&&($.d(1),$=null),M!==(M=q(t))&&(V.d(1),V=M(t),V&&(V.c(),V.m(P,null))),6&e&&k!==(k=!t[1]||t[2])&&(P.disabled=k)},i:t,o:t,d(t){t&&E(r),j.d(),e[11](null),$&&$.d(),V.d(),F=!1,i(L)}}}function bg(t,e,r){const n=z();let i,o="",s="",a=!1,u=!1;async function f(t){r(0,o=t.name);try{r(1,s=await t.text()),Ap(`File "${o}" loaded successfully`)}catch(t){Ip("Failed to read file")}}return[o,s,a,u,i,function(t){var e;const r=null===(e=t.target.files)||void 0===e?void 0:e[0];r&&f(r)},function(t){var e;t.preventDefault(),r(3,u=!1);const n=null===(e=t.dataTransfer)||void 0===e?void 0:e.files[0];n&&"text/csv"===n.type?f(n):Ip("Please upload a CSV file")},function(t){t.preventDefault(),r(3,u=!0)},function(){r(3,u=!1)},function(){r(0,o="sample_employees.csv"),r(1,s="name,email,age,city,salary\nJohn Doe,john.doe@email.com,28,New York,75000\nJane Smith,jane.smith@email.com,32,Los Angeles,82000\nMike Johnson,mike.johnson@email.com,25,Chicago,68000\nSarah Wilson,sarah.wilson@email.com,29,Houston,71000\nDavid Brown,david.brown@email.com,35,Phoenix,85000"),Ap("Sample data loaded")},async function(){if(s){r(2,a=!0);try{const t=c(Yp);if(!t||"initialized"!==t.state)return void Ip("Authentication required");const e=s.split("\n"),a=e[0].split(",").map((t=>t.trim())),u=e.slice(1).filter((t=>t.trim())),f=await t.actor.create_agent_passport(o.replace(".csv",""),"csv_dataset",a,await t.crypto.encryptWithNoteKey(BigInt(Date.now()),t.actor.getPrincipal().toString(),s));console.log("Dataset uploaded successfully:",f),Ap("Dataset uploaded successfully"),n("uploaded",{datasetId:f,fileName:o,headers:a,rowCount:u.length}),r(0,o=""),r(1,s=""),i&&r(4,i.value="",i)}catch(t){Ip(`Failed to upload dataset: ${t.message}`)}finally{r(2,a=!1)}}else Ip("Please select a CSV file first")},function(t){K[t?"unshift":"push"]((()=>{i=t,r(4,i)}))},()=>i?.click()]}class yg extends mt{constructor(t){super(),yt(this,t,bg,gg,s,{})}}function mg(t,e,r){const n=t.slice();return n[5]=e[r],n}function wg(t){let e;return{c(){e=I("Load Dataset")},m(t,r){v(t,e,r)},d(t){t&&E(e)}}}function vg(t){let e;return{c(){e=x("span"),N(e,"class","loading loading-spinner loading-xs")},m(t,r){v(t,e,r)},d(t){t&&E(e)}}}function Eg(t){let e,r,n,i,o,s,a,c,u,f,l,d,h,p,g,b,m,w,_,B,S,O,R,U,P,k,F,L,C=t[5].name+"",D=t[5].description+"",j=t[5].rowCount.toLocaleString()+"",$=t[5].headers.length+"",q=t[5].headers.join(", ")+"";function M(t,e){return t[0]?vg:wg}let V=M(t),z=V(t);function G(){return t[3](t[5])}return{c(){e=x("div"),r=x("div"),n=x("div"),i=x("div"),o=x("h3"),s=I(C),a=A(),c=x("p"),u=I(D),f=A(),l=x("div"),d=x("div"),h=I(j),p=I(" rows"),g=A(),b=x("div"),m=I($),w=I(" columns"),_=A(),B=x("div"),S=x("strong"),S.textContent="Columns:",O=A(),R=I(q),U=A(),P=x("button"),z.c(),k=A(),N(o,"class","font-semibold text-lg"),N(c,"class","text-sm text-base-content/70 mb-3"),N(d,"class","badge badge-outline badge-sm"),N(b,"class","badge badge-outline badge-sm"),N(l,"class","flex flex-wrap gap-2 mb-3"),N(B,"class","text-xs text-base-content/60"),N(i,"class","flex-1"),N(P,"class","btn btn-primary btn-sm ml-4"),P.disabled=t[0],N(n,"class","flex justify-between items-start"),N(r,"class","card-body p-4"),N(e,"class","card bg-base-200 shadow-sm")},m(t,E){v(t,e,E),y(e,r),y(r,n),y(n,i),y(i,o),y(o,s),y(i,a),y(i,c),y(c,u),y(i,f),y(i,l),y(l,d),y(d,h),y(d,p),y(l,g),y(l,b),y(b,m),y(b,w),y(i,_),y(i,B),y(B,S),y(B,O),y(B,R),y(n,U),y(n,P),z.m(P,null),y(e,k),F||(L=T(P,"click",G),F=!0)},p(e,r){V!==(V=M(t=e))&&(z.d(1),z=V(t),z&&(z.c(),z.m(P,null))),1&r&&(P.disabled=t[0])},d(t){t&&E(e),z.d(),F=!1,L()}}}function _g(e){let r,n,i,o,s,a,c,u,f,l=e[1],d=[];for(let t=0;t<l.length;t+=1)d[t]=Eg(mg(e,l,t));return{c(){r=x("div"),n=x("div"),i=x("h2"),i.textContent="Load Sample Datasets",o=A(),s=x("p"),s.textContent="Choose from pre-configured synthetic datasets to explore the platform features",a=A(),c=x("div");for(let t=0;t<d.length;t+=1)d[t].c();u=A(),f=x("div"),f.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> \n      <div><h3 class="font-bold">About Sample Data</h3> \n        <div class="text-sm">All sample datasets contain synthetic data generated for demonstration purposes. \n          Sensitive fields are pre-masked for privacy compliance.</div></div>',N(i,"class","card-title mb-4"),N(s,"class","text-base-content/70 mb-6"),N(c,"class","grid gap-4"),N(f,"class","alert alert-info mt-6"),N(n,"class","card-body"),N(r,"class","card bg-base-100 shadow-xl")},m(t,e){v(t,r,e),y(r,n),y(n,i),y(n,o),y(n,s),y(n,a),y(n,c);for(let t=0;t<d.length;t+=1)d[t]&&d[t].m(c,null);y(n,u),y(n,f)},p(t,[e]){if(7&e){let r;for(l=t[1],r=0;r<l.length;r+=1){const n=mg(t,l,r);d[r]?d[r].p(n,e):(d[r]=Eg(n),d[r].c(),d[r].m(c,null))}for(;r<d.length;r+=1)d[r].d(1);d.length=l.length}},i:t,o:t,d(t){t&&E(r),_(d,t)}}}function xg(t,e,r){const n=z();let i=!1;async function o(t){r(0,i=!0);try{const e=c(Yp);if(!e||"initialized"!==e.state)return void Ip("Authentication required");const r=await e.actor.create_agent_passport(t.name,"synthetic_dataset",t.headers,await e.crypto.encryptWithNoteKey(BigInt(Date.now()),e.actor.getPrincipal().toString(),t.data));console.log("Sample dataset loaded successfully:",r),Ap(`Sample dataset "${t.name}" loaded successfully`),n("loaded",{datasetId:r,fileName:`${t.name.toLowerCase().replace(/\s+/g,"_")}.csv`,headers:t.headers,rowCount:t.rowCount})}catch(t){Ip(`Failed to load sample dataset: ${t.message}`)}finally{r(0,i=!1)}}return[i,[{name:"Customer Demographics",description:"Synthetic customer data with demographics and purchasing behavior",headers:["customer_id","name","email","age","city","income","segment"],rowCount:1e3,data:"customer_id,name,email,age,city,income,segment\n1001,Alice Johnson,alice.j@email.com,32,Seattle,75000,Premium\n1002,Bob Smith,bob.smith@email.com,28,Portland,52000,Standard\n1003,Carol Davis,carol.d@email.com,45,San Francisco,95000,Premium\n1004,David Wilson,david.w@email.com,35,Los Angeles,68000,Standard\n1005,Emma Brown,emma.b@email.com,29,Denver,71000,Standard"},{name:"Financial Transactions",description:"Synthetic financial transaction data with privacy masking",headers:["transaction_id","account_id","amount","category","date","merchant"],rowCount:2500,data:"transaction_id,account_id,amount,category,date,merchant\nTXN001,ACC****1234,125.50,Groceries,2024-01-15,SafeWay Store\nTXN002,ACC****5678,45.00,Gas,2024-01-15,Shell Station\nTXN003,ACC****9012,89.99,Electronics,2024-01-16,Best Buy\nTXN004,ACC****3456,12.75,Coffee,2024-01-16,Starbucks\nTXN005,ACC****7890,250.00,Utilities,2024-01-17,City Power"},{name:"Healthcare Records",description:"De-identified patient data for research purposes",headers:["patient_id","age_group","condition","treatment","outcome","region"],rowCount:750,data:"patient_id,age_group,condition,treatment,outcome,region\nP****001,25-35,Hypertension,Medication A,Improved,North\nP****002,45-55,Diabetes,Insulin,Stable,South\nP****003,35-45,Asthma,Inhaler,Improved,East\nP****004,55-65,Arthritis,Physical Therapy,Stable,West\nP****005,25-35,Migraine,Medication B,Improved,North"},{name:"IoT Sensor Data",description:"Synthetic sensor readings from smart devices",headers:["device_id","timestamp","temperature","humidity","location","status"],rowCount:5e3,data:"device_id,timestamp,temperature,humidity,location,status\nDEV001,2024-01-15T08:00:00Z,22.5,45,Building A Floor 1,Normal\nDEV002,2024-01-15T08:00:00Z,21.8,48,Building A Floor 2,Normal\nDEV003,2024-01-15T08:00:00Z,23.1,42,Building B Floor 1,Normal\nDEV004,2024-01-15T08:00:00Z,20.9,51,Building B Floor 2,Alert\nDEV005,2024-01-15T08:00:00Z,22.3,46,Building C Floor 1,Normal"}],o,t=>o(t)]}class Bg extends mt{constructor(t){super(),yt(this,t,xg,_g,s,{})}}function Ig(t,e,r){const n=t.slice();return n[16]=e[r],n}function Ag(t,e,r){const n=t.slice();return n[19]=e[r],n}function Sg(t,e,r){const n=t.slice();return n[19]=e[r],n}function Tg(e){let r,n,i=e[19]+"";return{c(){r=x("option"),n=I(i),r.__value=e[19],r.value=r.__value},m(t,e){v(t,r,e),y(r,n)},p:t,d(t){t&&E(r)}}}function Ng(e){let r,n,i=e[19]+"";return{c(){r=x("option"),n=I(i),r.__value=e[19],r.value=r.__value},m(t,e){v(t,r,e),y(r,n)},p:t,d(t){t&&E(r)}}}function Og(t){let e,r=t[0],n=[];for(let e=0;e<r.length;e+=1)n[e]=Pg(Ig(t,r,e));return{c(){e=x("div");for(let t=0;t<n.length;t+=1)n[t].c();N(e,"class","space-y-3 max-h-96 overflow-y-auto")},m(t,r){v(t,e,r);for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,null)},p(t,i){if(1&i){let o;for(r=t[0],o=0;o<r.length;o+=1){const s=Ig(t,r,o);n[o]?n[o].p(s,i):(n[o]=Pg(s),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=r.length}},d(t){t&&E(e),_(n,t)}}}function Rg(e){let r;return{c(){r=x("div"),r.textContent="No memories found. Add some memories to get started!",N(r,"class","text-center text-gray-500 py-8")},m(t,e){v(t,r,e)},p:t,d(t){t&&E(r)}}}function Ug(e){let r;return{c(){r=x("div"),r.innerHTML='<span class="loading loading-spinner loading-md"></span>',N(r,"class","flex justify-center items-center h-32")},m(t,e){v(t,r,e)},p:t,d(t){t&&E(r)}}}function Pg(t){let e,r,n,i,o,s,a,c,u,f,l,d,h,p,g,b,m,w,_,B,S,T,R,U,P=t[16].memory_type+"",k=Cg(t[16].importance_score)+"",F=t[16].importance_score+"",L=Fg(t[16].created_at)+"",C=t[16].decrypted_content+"",D=t[16].id+"";return{c(){e=x("div"),r=x("div"),n=x("div"),i=x("div"),o=x("div"),s=I(P),a=A(),c=x("div"),u=I(k),f=I(" ("),l=I(F),d=I(")"),p=A(),g=x("div"),b=I(L),m=A(),w=x("div"),_=I(C),B=A(),S=x("div"),T=I("ID: "),R=I(D),U=A(),N(o,"class","badge badge-outline text-xs"),N(c,"class",h="badge "+Lg(t[16].importance_score)+" text-xs"),N(i,"class","flex gap-2 items-center"),N(g,"class","text-xs opacity-60"),N(n,"class","flex justify-between items-start mb-2"),N(w,"class","text-sm"),N(S,"class","text-xs opacity-50 mt-2"),N(r,"class","card-body p-4"),N(e,"class","card bg-base-200 shadow-sm")},m(t,h){v(t,e,h),y(e,r),y(r,n),y(n,i),y(i,o),y(o,s),y(i,a),y(i,c),y(c,u),y(c,f),y(c,l),y(c,d),y(n,p),y(n,g),y(g,b),y(r,m),y(r,w),y(w,_),y(r,B),y(r,S),y(S,T),y(S,R),y(e,U)},p(t,e){1&e&&P!==(P=t[16].memory_type+"")&&O(s,P),1&e&&k!==(k=Cg(t[16].importance_score)+"")&&O(u,k),1&e&&F!==(F=t[16].importance_score+"")&&O(l,F),1&e&&h!==(h="badge "+Lg(t[16].importance_score)+" text-xs")&&N(c,"class",h),1&e&&L!==(L=Fg(t[16].created_at)+"")&&O(b,L),1&e&&C!==(C=t[16].decrypted_content+"")&&O(_,C),1&e&&D!==(D=t[16].id+"")&&O(R,D)},d(t){t&&E(e)}}}function kg(e){let r,n,o,s,a,c,u,f,l,d,h,p,g,b,m,w,B,S,P,F,L,C,D,j,$,q,M,V,z,G,K,H,Z,W,Y,X,Q,tt,et,rt,nt,it,ot=e[7],st=[];for(let t=0;t<ot.length;t+=1)st[t]=Tg(Sg(e,ot,t));let at=e[7],ct=[];for(let t=0;t<at.length;t+=1)ct[t]=Ng(Ag(e,at,t));function ut(t,e){return t[1]?Ug:0===t[0].length?Rg:Og}let ft=ut(e),lt=ft(e);return{c(){r=x("div"),n=x("div"),o=x("h3"),o.textContent="Agent Memories",s=A(),a=x("div"),c=x("select"),u=x("option"),u.textContent="All Types";for(let t=0;t<st.length;t+=1)st[t].c();f=A(),l=x("button"),l.textContent="Refresh",d=A(),h=x("div"),p=x("input"),g=A(),b=x("div"),b.textContent="Add New Memory",m=A(),w=x("div"),B=x("div"),S=x("div"),P=x("label"),P.textContent="Type",F=A(),L=x("select");for(let t=0;t<ct.length;t+=1)ct[t].c();C=A(),D=x("div"),j=x("label"),j.textContent="Importance (0-100)",$=A(),q=x("input"),M=A(),V=x("div"),z=I(e[6]),G=A(),K=x("div"),H=x("label"),H.textContent="Action",Z=A(),W=x("button"),Y=I("Add Memory"),Q=A(),tt=x("div"),et=x("textarea"),rt=A(),lt.c(),N(o,"class","card-title"),u.__value="",u.value=u.__value,N(c,"class","select select-bordered select-sm"),void 0===e[3]&&J((()=>e[12].call(c))),N(l,"class","btn btn-sm btn-outline"),N(a,"class","flex gap-2 mb-4"),N(p,"type","checkbox"),N(b,"class","collapse-title text-sm font-medium"),N(P,"class","label label-text text-xs"),N(L,"class","select select-bordered select-sm"),void 0===e[4]&&J((()=>e[13].call(L))),N(S,"class","form-control"),N(j,"class","label label-text text-xs"),N(q,"type","range"),N(q,"min","0"),N(q,"max","100"),N(q,"class","range range-sm"),N(V,"class","text-xs text-center"),N(D,"class","form-control"),N(H,"class","label label-text text-xs"),N(W,"class","btn btn-primary btn-sm"),W.disabled=X=e[2]||!e[5].trim(),k(W,"loading",e[2]),N(K,"class","form-control"),N(B,"class","grid grid-cols-1 md:grid-cols-3 gap-4 mt-2"),N(et,"class","textarea textarea-bordered textarea-sm"),N(et,"placeholder","Enter memory content..."),et.disabled=e[2],N(tt,"class","form-control mt-2"),N(w,"class","collapse-content"),N(h,"class","collapse collapse-arrow bg-base-200 mb-4"),N(n,"class","card-body"),N(r,"class","card bg-base-100 shadow-xl")},m(t,i){v(t,r,i),y(r,n),y(n,o),y(n,s),y(n,a),y(a,c),y(c,u);for(let t=0;t<st.length;t+=1)st[t]&&st[t].m(c,null);U(c,e[3],!0),y(a,f),y(a,l),y(n,d),y(n,h),y(h,p),y(h,g),y(h,b),y(h,m),y(h,w),y(w,B),y(B,S),y(S,P),y(S,F),y(S,L);for(let t=0;t<ct.length;t+=1)ct[t]&&ct[t].m(L,null);U(L,e[4],!0),y(B,C),y(B,D),y(D,j),y(D,$),y(D,q),R(q,e[6]),y(D,M),y(D,V),y(V,z),y(B,G),y(B,K),y(K,H),y(K,Z),y(K,W),y(W,Y),y(w,Q),y(w,tt),y(tt,et),R(et,e[5]),y(n,rt),lt.m(n,null),nt||(it=[T(c,"change",e[12]),T(c,"change",e[10]),T(l,"click",e[8]),T(L,"change",e[13]),T(q,"change",e[14]),T(q,"input",e[14]),T(W,"click",e[9]),T(et,"input",e[15])],nt=!0)},p(t,[e]){if(128&e){let r;for(ot=t[7],r=0;r<ot.length;r+=1){const n=Sg(t,ot,r);st[r]?st[r].p(n,e):(st[r]=Tg(n),st[r].c(),st[r].m(c,null))}for(;r<st.length;r+=1)st[r].d(1);st.length=ot.length}if(136&e&&U(c,t[3]),128&e){let r;for(at=t[7],r=0;r<at.length;r+=1){const n=Ag(t,at,r);ct[r]?ct[r].p(n,e):(ct[r]=Ng(n),ct[r].c(),ct[r].m(L,null))}for(;r<ct.length;r+=1)ct[r].d(1);ct.length=at.length}144&e&&U(L,t[4]),64&e&&R(q,t[6]),64&e&&O(z,t[6]),36&e&&X!==(X=t[2]||!t[5].trim())&&(W.disabled=X),4&e&&k(W,"loading",t[2]),4&e&&(et.disabled=t[2]),32&e&&R(et,t[5]),ft===(ft=ut(t))&&lt?lt.p(t,e):(lt.d(1),lt=ft(t),lt&&(lt.c(),lt.m(n,null)))},i:t,o:t,d(t){t&&E(r),_(st,t),_(ct,t),lt.d(),nt=!1,i(it)}}}function Fg(t){return new Date(Number(t)/1e6).toLocaleString()}function Lg(t){return t>=80?"badge-error":t>=60?"badge-warning":t>=40?"badge-info":"badge-ghost"}function Cg(t){return t>=80?"Critical":t>=60?"High":t>=40?"Medium":"Low"}function Dg(t,e,r){let{passportId:n}=e,i=[],o=!0,s=!1,a="",c="conversation",u="",f=50;const l=["conversation","preference","skill","context","goal","instruction","feedback","error"];async function d(){r(1,o=!0);try{const t=Yp;if("initialized"!==t.state)return void Ip("Authentication required");const e=await t.actor.get_agent_memories(n,a?[a]:[]);r(0,i=e);for(let e of i)try{e.decrypted_content=await t.crypto.decryptWithNoteKey(BigInt(e.id),e.owner,e.encrypted_content)}catch(t){console.warn("Could not decrypt memory:",t),e.decrypted_content="[Encrypted]"}i.sort(((t,e)=>t.importance_score!==e.importance_score?e.importance_score-t.importance_score:Number(e.created_at)-Number(t.created_at)))}catch(t){Ip(`Failed to load memories: ${t.message}`)}finally{r(1,o=!1)}}return V((async()=>{await d()})),t.$$set=t=>{"passportId"in t&&r(11,n=t.passportId)},[i,o,s,a,c,u,f,l,d,async function(){if(u.trim()){r(2,s=!0);try{const t=Yp;if("initialized"!==t.state)return void Ip("Authentication required");const e=await t.crypto.encryptWithNoteKey(BigInt(Date.now()),t.actor.getPrincipal().toString(),u);Ap(`Memory added successfully! ID: ${await t.actor.add_agent_memory(n,c,e,f)}`),r(5,u=""),r(6,f=50),await d()}catch(t){Ip(`Failed to add memory: ${t.message}`)}finally{r(2,s=!1)}}else Ip("Memory content is required")},async function(){await d()},n,function(){a=P(this),r(3,a),r(7,l)},function(){c=P(this),r(4,c),r(7,l)},function(){f=function(t){return""===t?null:+t}(this.value),r(6,f)},function(){u=this.value,r(5,u)}]}class jg extends mt{constructor(t){super(),yt(this,t,Dg,kg,s,{passportId:11})}}function $g(t,e,r){const n=t.slice();return n[6]=e[r],n}function qg(t,e,r){const n=t.slice();return n[9]=e[r],n}function Mg(e){let r;return{c(){r=x("div"),r.innerHTML="<span>Passport not found or access denied</span>",N(r,"class","alert alert-error")},m(t,e){v(t,r,e)},p:t,i:t,o:t,d(t){t&&E(r)}}}function Vg(t){let e,r,n,o,s,a,c,u,f,l,d,h,p,g,b,m,w,B,R,U,P,k,F,L,C,D,j,$,q,M,V,z,G,K,H,Z,W,Y,J,X,Q,tt,et,rt,nt,it,ot,st,lt,dt,ht,pt,gt,bt,yt,mt,wt,vt,Et,_t,xt,Bt,It,At,St,Tt=t[1].agent_name+"",Nt=t[1].is_active?"Available":"Archived",Ot=t[1].agent_type+"",Rt=t[1].owner+"",Ut=t[1].owner+"",Pt=new Date(Number(t[1].created_at)/1e6).toLocaleString()+"",kt=Jg(t[1].last_active)+"",Ft=t[3]?"Hide":"Show",Lt=t[1].capabilities,Ct=[];for(let e=0;e<Lt.length;e+=1)Ct[e]=Gg(qg(t,Lt,e));let Dt=t[1].api_endpoints&&t[1].api_endpoints.length>0&&Kg(t),jt=t[1].decrypted_specifications&&Zg(t),$t=t[3]&&Wg(t);return{c(){e=x("div"),r=x("div"),n=x("div"),o=x("h1"),s=I(Tt),a=A(),c=x("div"),u=x("p"),f=x("strong"),f.textContent="Status:",l=A(),d=I(Nt),p=A(),g=x("p"),b=x("strong"),b.textContent="Type:",m=A(),w=I(Ot),B=A(),R=x("div"),U=x("div"),P=x("h3"),P.textContent="Passport ID",k=A(),F=x("p"),L=x("strong"),L.textContent="Owner:",C=A(),D=I(Rt),j=A(),$=x("div"),q=x("h3"),q.textContent="Owner",M=A(),V=x("p"),z=I(Ut),G=A(),K=x("div"),H=x("h3"),H.textContent="Created",Z=A(),W=x("p"),Y=x("strong"),Y.textContent="Created:",J=A(),X=I(Pt),Q=A(),tt=x("div"),et=x("h3"),et.textContent="Last Active",rt=A(),nt=x("p"),it=I(kt),ot=A(),st=x("div"),lt=x("h3"),lt.textContent="Columns",dt=A(),ht=x("div");for(let t=0;t<Ct.length;t+=1)Ct[t].c();pt=A(),Dt&&Dt.c(),gt=A(),jt&&jt.c(),bt=A(),yt=x("div"),mt=x("button"),wt=I(Ft),vt=I(" Memories"),Et=A(),_t=x("button"),_t.textContent="Refresh",xt=A(),$t&&$t.c(),Bt=S(),N(o,"class","text-3xl font-bold mb-6"),N(c,"class",h="badge "+Xg(t[1].is_active)),N(n,"class","flex justify-between items-start"),N(P,"class","font-semibold text-sm opacity-70"),N(q,"class","font-semibold text-sm opacity-70"),N(V,"class","font-mono text-xs break-all"),N(H,"class","font-semibold text-sm opacity-70"),N(et,"class","font-semibold text-sm opacity-70"),N(nt,"class","text-sm"),N(R,"class","grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"),N(lt,"class","text-lg font-semibold mb-2"),N(ht,"class","flex flex-wrap gap-2"),N(st,"class","mt-4"),N(mt,"class","btn btn-outline"),N(_t,"class","btn btn-primary"),N(yt,"class","card-actions justify-end mt-6"),N(r,"class","card-body"),N(e,"class","card bg-base-100 shadow-xl")},m(i,h){v(i,e,h),y(e,r),y(r,n),y(n,o),y(o,s),y(n,a),y(n,c),y(c,u),y(u,f),y(u,l),y(u,d),y(n,p),y(n,g),y(g,b),y(g,m),y(g,w),y(r,B),y(r,R),y(R,U),y(U,P),y(U,k),y(U,F),y(F,L),y(F,C),y(F,D),y(R,j),y(R,$),y($,q),y($,M),y($,V),y(V,z),y(R,G),y(R,K),y(K,H),y(K,Z),y(K,W),y(W,Y),y(W,J),y(W,X),y(R,Q),y(R,tt),y(tt,et),y(tt,rt),y(tt,nt),y(nt,it),y(r,ot),y(r,st),y(st,lt),y(st,dt),y(st,ht);for(let t=0;t<Ct.length;t+=1)Ct[t]&&Ct[t].m(ht,null);y(r,pt),Dt&&Dt.m(r,null),y(r,gt),jt&&jt.m(r,null),y(r,bt),y(r,yt),y(yt,mt),y(mt,wt),y(mt,vt),y(yt,Et),y(yt,_t),v(i,xt,h),$t&&$t.m(i,h),v(i,Bt,h),It=!0,At||(St=[T(mt,"click",t[5]),T(_t,"click",t[4])],At=!0)},p(t,e){if((!It||2&e)&&Tt!==(Tt=t[1].agent_name+"")&&O(s,Tt),(!It||2&e)&&Nt!==(Nt=t[1].is_active?"Available":"Archived")&&O(d,Nt),(!It||2&e&&h!==(h="badge "+Xg(t[1].is_active)))&&N(c,"class",h),(!It||2&e)&&Ot!==(Ot=t[1].agent_type+"")&&O(w,Ot),(!It||2&e)&&Rt!==(Rt=t[1].owner+"")&&O(D,Rt),(!It||2&e)&&Ut!==(Ut=t[1].owner+"")&&O(z,Ut),(!It||2&e)&&Pt!==(Pt=new Date(Number(t[1].created_at)/1e6).toLocaleString()+"")&&O(X,Pt),(!It||2&e)&&kt!==(kt=Jg(t[1].last_active)+"")&&O(it,kt),2&e){let r;for(Lt=t[1].capabilities,r=0;r<Lt.length;r+=1){const n=qg(t,Lt,r);Ct[r]?Ct[r].p(n,e):(Ct[r]=Gg(n),Ct[r].c(),Ct[r].m(ht,null))}for(;r<Ct.length;r+=1)Ct[r].d(1);Ct.length=Lt.length}t[1].api_endpoints&&t[1].api_endpoints.length>0?Dt?Dt.p(t,e):(Dt=Kg(t),Dt.c(),Dt.m(r,gt)):Dt&&(Dt.d(1),Dt=null),t[1].decrypted_specifications?jt?jt.p(t,e):(jt=Zg(t),jt.c(),jt.m(r,bt)):jt&&(jt.d(1),jt=null),(!It||8&e)&&Ft!==(Ft=t[3]?"Hide":"Show")&&O(wt,Ft),t[3]?$t?($t.p(t,e),8&e&&ut($t,1)):($t=Wg(t),$t.c(),ut($t,1),$t.m(Bt.parentNode,Bt)):$t&&(at(),ft($t,1,1,(()=>{$t=null})),ct())},i(t){It||(ut($t),It=!0)},o(t){ft($t),It=!1},d(t){t&&E(e),_(Ct,t),Dt&&Dt.d(),jt&&jt.d(),t&&E(xt),$t&&$t.d(t),t&&E(Bt),At=!1,i(St)}}}function zg(e){let r;return{c(){r=x("div"),r.innerHTML='<span class="loading loading-spinner loading-lg"></span>',N(r,"class","flex justify-center items-center h-64")},m(t,e){v(t,r,e)},p:t,i:t,o:t,d(t){t&&E(r)}}}function Gg(t){let e,r,n=t[9]+"";return{c(){e=x("span"),r=I(n),N(e,"class","badge badge-primary")},m(t,n){v(t,e,n),y(e,r)},p(t,e){2&e&&n!==(n=t[9]+"")&&O(r,n)},d(t){t&&E(e)}}}function Kg(t){let e,r,n,i,o=t[1].api_endpoints,s=[];for(let e=0;e<o.length;e+=1)s[e]=Hg($g(t,o,e));return{c(){e=x("div"),r=x("h3"),r.textContent="Data Access",n=A(),i=x("div");for(let t=0;t<s.length;t+=1)s[t].c();N(r,"class","text-lg font-semibold mb-2"),N(i,"class","flex flex-wrap gap-2"),N(e,"class","mt-4")},m(t,o){v(t,e,o),y(e,r),y(e,n),y(e,i);for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(i,null)},p(t,e){if(2&e){let r;for(o=t[1].api_endpoints,r=0;r<o.length;r+=1){const n=$g(t,o,r);s[r]?s[r].p(n,e):(s[r]=Hg(n),s[r].c(),s[r].m(i,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=o.length}},d(t){t&&E(e),_(s,t)}}}function Hg(t){let e,r,n=t[6]+"";return{c(){e=x("div"),r=I(n),N(e,"class","badge badge-secondary")},m(t,n){v(t,e,n),y(e,r)},p(t,e){2&e&&n!==(n=t[6]+"")&&O(r,n)},d(t){t&&E(e)}}}function Zg(t){let e,r,n,i,o,s=t[1].encrypted_specifications+"";return{c(){e=x("div"),r=x("h3"),r.textContent="Dataset Content",n=A(),i=x("div"),o=I(s),N(r,"class","text-lg font-semibold mb-2"),N(i,"class","bg-base-200 p-4 rounded-lg font-mono text-sm whitespace-pre-wrap"),N(e,"class","mt-4")},m(t,s){v(t,e,s),y(e,r),y(e,n),y(e,i),y(i,o)},p(t,e){2&e&&s!==(s=t[1].encrypted_specifications+"")&&O(o,s)},d(t){t&&E(e)}}}function Wg(t){let e,r,n;return r=new jg({props:{passportId:t[0]}}),{c(){e=x("div"),ht(r.$$.fragment),N(e,"class","mt-6")},m(t,i){v(t,e,i),pt(r,e,null),n=!0},p(t,e){const n={};1&e&&(n.passportId=t[0]),r.$set(n)},i(t){n||(ut(r.$$.fragment,t),n=!0)},o(t){ft(r.$$.fragment,t),n=!1},d(t){t&&E(e),gt(r)}}}function Yg(t){let e,r,n,i;const o=[zg,Vg,Mg],s=[];function a(t,e){return t[2]?0:t[1]?1:2}return e=a(t),r=s[e]=o[e](t),{c(){r.c(),n=S()},m(t,r){s[e].m(t,r),v(t,n,r),i=!0},p(t,[i]){let c=e;e=a(t),e===c?s[e].p(t,i):(at(),ft(s[c],1,1,(()=>{s[c]=null})),ct(),r=s[e],r?r.p(t,i):(r=s[e]=o[e](t),r.c()),ut(r,1),r.m(n.parentNode,n))},i(t){i||(ut(r),i=!0)},o(t){ft(r),i=!1},d(t){s[e].d(t),t&&E(n)}}}function Jg(t){return new Date(Number(t)/1e6).toLocaleString()}function Xg(t){return t?"badge-success":"badge-error"}function Qg(t,e,r){let{syntheticId:n}=e,i=null,o=!0,s=!1;async function a(){r(2,o=!0);try{const t=c(Yp);if(console.log(" PassportViewer - Loading synthetic data details..."),!t||"initialized"!==t.state)return console.error("Error loading synthetic data:",null==t?void 0:t.state),void Ip("Authentication required");const e=await t.actor.get_agent_passport(n);if(e.length>0&&(r(1,i=e[0]),i.encrypted_specifications))try{r(1,i.decrypted_specifications=await t.crypto.decryptWithNoteKey(n,i.owner,i.encrypted_specifications),i)}catch(t){console.warn("Could not decrypt specifications:",t),r(1,i.decrypted_specifications="[Encrypted]",i)}}catch(t){console.error("Failed to load synthetic data:",t.message)}finally{r(2,o=!1)}}V((()=>{const t=c(Yp);if(t&&"initialized"===t.state)a();else{const t=Yp.subscribe((e=>{e&&"initialized"===e.state&&(a(),t())}))}}));return t.$$set=t=>{"syntheticId"in t&&r(0,n=t.syntheticId)},[n,i,o,s,a,()=>r(3,s=!s)]}class tb extends mt{constructor(t){super(),yt(this,t,Qg,Yg,s,{syntheticId:0})}}function eb(t,e,r){const n=t.slice();return n[7]=e[r],n}function rb(t,e,r){const n=t.slice();return n[10]=e[r],n}function nb(e){let r,n,i,o,s,a,c,u;function f(t,e){return t[1]?ab:0===t[0].length?sb:ob}let l=f(e),d=l(e);return{c(){r=x("div"),n=x("h2"),n.textContent="My Synthetic Datasets",i=A(),o=x("button"),o.textContent="Refresh",s=A(),d.c(),a=S(),N(n,"class","text-xl font-bold"),N(o,"class","btn btn-sm btn-outline"),N(r,"class","flex justify-between items-center")},m(t,f){v(t,r,f),y(r,n),y(r,i),y(r,o),v(t,s,f),d.m(t,f),v(t,a,f),c||(u=T(o,"click",e[3]),c=!0)},p(t,e){l===(l=f(t))&&d?d.p(t,e):(d.d(1),d=l(t),d&&(d.c(),d.m(a.parentNode,a)))},i:t,o:t,d(t){t&&E(r),t&&E(s),d.d(t),t&&E(a),c=!1,u()}}}function ib(t){let e,r,n,i,o,s,a,c,u;return s=new tb({props:{syntheticId:t[2]}}),{c(){e=x("div"),r=x("button"),r.textContent=" Back to List",n=A(),i=x("h2"),i.textContent="Dataset Details",o=A(),ht(s.$$.fragment),N(r,"class","btn btn-sm btn-outline"),N(i,"class","text-lg font-semibold"),N(e,"class","flex items-center gap-2 mb-4")},m(f,l){v(f,e,l),y(e,r),y(e,n),y(e,i),v(f,o,l),pt(s,f,l),a=!0,c||(u=T(r,"click",t[5]),c=!0)},p(t,e){const r={};4&e&&(r.syntheticId=t[2]),s.$set(r)},i(t){a||(ut(s.$$.fragment,t),a=!0)},o(t){ft(s.$$.fragment,t),a=!1},d(t){t&&E(e),t&&E(o),gt(s,t),c=!1,u()}}}function ob(t){let e,r=t[0],n=[];for(let e=0;e<r.length;e+=1)n[e]=fb(eb(t,r,e));return{c(){e=x("div");for(let t=0;t<n.length;t+=1)n[t].c();N(e,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4")},m(t,r){v(t,e,r);for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,null)},p(t,i){if(17&i){let o;for(r=t[0],o=0;o<r.length;o+=1){const s=eb(t,r,o);n[o]?n[o].p(s,i):(n[o]=fb(s),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=r.length}},d(t){t&&E(e),_(n,t)}}}function sb(e){let r;return{c(){r=x("div"),r.innerHTML='<div class="text-gray-500 mb-4"><svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17H7A5 5 0 0 1 7 7h2m0 10v3a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-3m0 0V7a1 1 0 0 0-1-1H10a1 1 0 0 0-1 1v10z"></path></svg> \n          <p class="text-lg">No datasets found</p> \n          <p class="text-sm">Upload your first CSV or load sample data to get started!</p></div>',N(r,"class","text-center py-12")},m(t,e){v(t,r,e)},p:t,d(t){t&&E(r)}}}function ab(e){let r;return{c(){r=x("div"),r.innerHTML='<span class="loading loading-spinner loading-lg"></span>',N(r,"class","flex justify-center items-center h-64")},m(t,e){v(t,r,e)},p:t,d(t){t&&E(r)}}}function cb(t){let e,r,n=t[10]+"";return{c(){e=x("div"),r=I(n),N(e,"class","badge badge-primary badge-xs")},m(t,n){v(t,e,n),y(e,r)},p(t,e){1&e&&n!==(n=t[10]+"")&&O(r,n)},d(t){t&&E(e)}}}function ub(t){let e,r,n,i,o=t[7].capabilities.length-3+"";return{c(){e=x("div"),r=I("+"),n=I(o),i=I(" more"),N(e,"class","badge badge-ghost badge-xs")},m(t,o){v(t,e,o),y(e,r),y(e,n),y(e,i)},p(t,e){1&e&&o!==(o=t[7].capabilities.length-3+"")&&O(n,o)},d(t){t&&E(e)}}}function fb(t){let e,r,n,i,o,s,a,c,u,f,l,d,h,p,g,b,m,w,B,S,R,U,P,k,F,L,C,D,j,$,q,M=db(t[7].agent_type)+"",V=t[7].agent_name+"",z=t[7].is_active?"Available":"Archived",G=hb(t[7].agent_type)+"",K=t[7].capabilities.length+"",H=pb(t[7].created_at)+"",Z=t[7].capabilities.slice(0,3),W=[];for(let e=0;e<Z.length;e+=1)W[e]=cb(rb(t,Z,e));let Y=t[7].capabilities.length>3&&ub(t);function J(){return t[6](t[7])}return{c(){e=x("div"),r=x("div"),n=x("div"),i=x("div"),o=x("span"),s=I(M),a=A(),c=x("h3"),u=I(V),f=A(),l=x("div"),d=I(z),p=A(),g=x("div"),b=x("div"),m=I(G),w=A(),B=x("div"),S=I("Columns: "),R=I(K),U=I(" | Created: "),P=I(H),k=A(),F=x("div");for(let t=0;t<W.length;t+=1)W[t].c();L=A(),Y&&Y.c(),C=A(),D=x("div"),D.innerHTML='<button class="btn btn-primary btn-sm">View Dataset</button>',j=A(),N(o,"class","text-2xl"),N(c,"class","card-title text-lg"),N(i,"class","flex items-center gap-2"),N(l,"class",h="badge "+gb(t[7].is_active)+" text-xs"),N(n,"class","flex justify-between items-start mb-2"),N(b,"class","badge badge-outline"),N(B,"class","text-sm opacity-70"),N(F,"class","flex flex-wrap gap-1 mt-2"),N(g,"class","space-y-2"),N(D,"class","card-actions justify-end mt-4"),N(r,"class","card-body p-4"),N(e,"class","card bg-base-100 shadow-lg hover:shadow-xl transition-shadow cursor-pointer")},m(t,h){v(t,e,h),y(e,r),y(r,n),y(n,i),y(i,o),y(o,s),y(i,a),y(i,c),y(c,u),y(n,f),y(n,l),y(l,d),y(r,p),y(r,g),y(g,b),y(b,m),y(g,w),y(g,B),y(B,S),y(B,R),y(B,U),y(B,P),y(g,k),y(g,F);for(let t=0;t<W.length;t+=1)W[t]&&W[t].m(F,null);y(F,L),Y&&Y.m(F,null),y(r,C),y(r,D),y(e,j),$||(q=T(e,"click",J),$=!0)},p(e,r){if(t=e,1&r&&M!==(M=db(t[7].agent_type)+"")&&O(s,M),1&r&&V!==(V=t[7].agent_name+"")&&O(u,V),1&r&&z!==(z=t[7].is_active?"Available":"Archived")&&O(d,z),1&r&&h!==(h="badge "+gb(t[7].is_active)+" text-xs")&&N(l,"class",h),1&r&&G!==(G=hb(t[7].agent_type)+"")&&O(m,G),1&r&&K!==(K=t[7].capabilities.length+"")&&O(R,K),1&r&&H!==(H=pb(t[7].created_at)+"")&&O(P,H),1&r){let e;for(Z=t[7].capabilities.slice(0,3),e=0;e<Z.length;e+=1){const n=rb(t,Z,e);W[e]?W[e].p(n,r):(W[e]=cb(n),W[e].c(),W[e].m(F,L))}for(;e<W.length;e+=1)W[e].d(1);W.length=Z.length}t[7].capabilities.length>3?Y?Y.p(t,r):(Y=ub(t),Y.c(),Y.m(F,null)):Y&&(Y.d(1),Y=null)},d(t){t&&E(e),_(W,t),Y&&Y.d(),$=!1,q()}}}function lb(t){let e,r,n,i;const o=[ib,nb],s=[];function a(t,e){return t[2]?0:1}return r=a(t),n=s[r]=o[r](t),{c(){e=x("div"),n.c(),N(e,"class","space-y-4")},m(t,n){v(t,e,n),s[r].m(e,null),i=!0},p(t,[i]){let c=r;r=a(t),r===c?s[r].p(t,i):(at(),ft(s[c],1,1,(()=>{s[c]=null})),ct(),n=s[r],n?n.p(t,i):(n=s[r]=o[r](t),n.c()),ut(n,1),n.m(e,null))},i(t){i||(ut(n),i=!0)},o(t){ft(n),i=!1},d(t){t&&E(e),s[r].d()}}}function db(t){switch(t){case"csv_dataset":return"";case"synthetic_dataset":return"";default:return""}}function hb(t){switch(t){case"csv_dataset":return"CSV Dataset";case"synthetic_dataset":return"Synthetic Data";default:return"Dataset"}}function pb(t){return new Date(Number(t)/1e6).toLocaleDateString()}function gb(t){return t?"badge-success":"badge-error"}function bb(t,e,r){let n=[],i=!0,o=null;async function s(){r(1,i=!0);try{const t=c(Yp);if(console.log(" DatasetList - Loading datasets, auth state:",null==t?void 0:t.state),!t||"initialized"!==t.state)return console.error(" DatasetList - Authentication not initialized:",null==t?void 0:t.state),void Ip("Authentication required");console.log(" DatasetList - Calling get_my_passports..."),r(0,n=await t.actor.get_my_passports()),n.sort(((t,e)=>Number(e.created_at)-Number(t.created_at)))}catch(t){Ip(`Failed to load datasets: ${t.message}`)}finally{r(1,i=!1)}}function a(t){r(2,o=t)}V((()=>{const t=c(Yp);if(t&&"initialized"===t.state)s();else{const t=Yp.subscribe((e=>{e&&"initialized"===e.state&&(s(),t())}))}}));return[n,i,o,s,a,()=>r(2,o=null),t=>a(t.id)]}class yb extends mt{constructor(t){super(),yt(this,t,bb,lb,s,{})}}function mb(e){let r;return{c(){r=x("div"),r.innerHTML='<div class="card bg-base-100 shadow-xl"><div class="card-body text-center"><div class="loading loading-spinner loading-lg"></div> \n        <p class="mt-4">Initializing authentication...</p></div></div>',N(r,"class","container mx-auto p-4 max-w-md")},m(t,e){v(t,r,e)},p:t,i:t,o:t,d(t){t&&E(r)}}}function wb(e){let r,n,i,o,s,a,c,u,f,l;return{c(){r=x("div"),n=x("div"),i=x("div"),o=x("h2"),o.textContent="Authentication Required",s=A(),a=x("p"),a.textContent="Please log in with Internet Identity to access your synthetic datasets.",c=A(),u=x("button"),u.textContent="Login with Internet Identity",N(o,"class","card-title justify-center mb-4"),N(a,"class","mb-6"),N(u,"class","btn btn-primary"),N(i,"class","card-body text-center"),N(n,"class","card bg-base-100 shadow-xl"),N(r,"class","container mx-auto p-4 max-w-md")},m(t,e){v(t,r,e),y(r,n),y(n,i),y(i,o),y(i,s),y(i,a),y(i,c),y(i,u),f||(l=T(u,"click",Jp),f=!0)},p:t,i:t,o:t,d(t){t&&E(r),f=!1,l()}}}function vb(t){let e,r,n,o,s,a,c,u,f,l,d,h,p,g,b,m,w,_,B,S,O,R;const U=[Bb,xb,_b,Eb],P=[];function k(t,e){return"list"===t[1]?0:"upload"===t[1]?1:"sample"===t[1]?2:3}return _=k(t),B=P[_]=U[_](t),{c(){e=x("div"),r=x("div"),r.innerHTML='<h1 class="text-3xl font-bold mb-2">Synthetic Data Manager</h1> \n      <p class="text-gray-600">Upload, store, and manage your synthetic datasets with privacy controls</p>',n=A(),o=x("div"),s=x("button"),a=I("My Datasets"),u=A(),f=x("button"),l=I("Upload CSV"),h=A(),p=x("button"),g=I("Sample Data"),m=A(),w=x("div"),B.c(),N(r,"class","mb-6"),N(s,"class",c="tab "+("list"===t[1]?"tab-active":"")),N(f,"class",d="tab "+("upload"===t[1]?"tab-active":"")),N(p,"class",b="tab "+("sample"===t[1]?"tab-active":"")),N(o,"class","tabs tabs-boxed mb-6"),N(w,"class","tab-content svelte-v7wdpz"),N(e,"class","container mx-auto p-4 max-w-6xl")},m(i,c){v(i,e,c),y(e,r),y(e,n),y(e,o),y(o,s),y(s,a),y(o,u),y(o,f),y(f,l),y(o,h),y(o,p),y(p,g),y(e,m),y(e,w),P[_].m(w,null),S=!0,O||(R=[T(s,"click",t[5]),T(f,"click",t[6]),T(p,"click",t[7])],O=!0)},p(t,e){(!S||2&e&&c!==(c="tab "+("list"===t[1]?"tab-active":"")))&&N(s,"class",c),(!S||2&e&&d!==(d="tab "+("upload"===t[1]?"tab-active":"")))&&N(f,"class",d),(!S||2&e&&b!==(b="tab "+("sample"===t[1]?"tab-active":"")))&&N(p,"class",b);let r=_;_=k(t),_===r?P[_].p(t,e):(at(),ft(P[r],1,1,(()=>{P[r]=null})),ct(),B=P[_],B?B.p(t,e):(B=P[_]=U[_](t),B.c()),ut(B,1),B.m(w,null))},i(t){S||(ut(B),S=!0)},o(t){ft(B),S=!1},d(t){t&&E(e),P[_].d(),O=!1,i(R)}}}function Eb(e){let r,n,i,o;return{c(){r=x("div"),n=x("span"),i=I("Unknown tab: "),o=I(e[1]),N(r,"class","alert alert-warning")},m(t,e){v(t,r,e),y(r,n),y(n,i),y(n,o)},p(t,e){2&e&&O(o,t[1])},i:t,o:t,d(t){t&&E(r)}}}function _b(e){let r,n;return r=new Bg({}),r.$on("loaded",e[3]),{c(){ht(r.$$.fragment)},m(t,e){pt(r,t,e),n=!0},p:t,i(t){n||(ut(r.$$.fragment,t),n=!0)},o(t){ft(r.$$.fragment,t),n=!1},d(t){gt(r,t)}}}function xb(e){let r,n;return r=new yg({}),r.$on("uploaded",e[3]),{c(){ht(r.$$.fragment)},m(t,e){pt(r,t,e),n=!0},p:t,i(t){n||(ut(r.$$.fragment,t),n=!0)},o(t){ft(r.$$.fragment,t),n=!1},d(t){gt(r,t)}}}function Bb(e){let r,n,i=e[2],o=Ib();return{c(){o.c(),r=S()},m(t,e){o.m(t,e),v(t,r,e),n=!0},p(e,n){4&n&&s(i,i=e[2])?(at(),ft(o,1,1,t),ct(),o=Ib(),o.c(),ut(o,1),o.m(r.parentNode,r)):o.p(e,n)},i(t){n||(ut(o),n=!0)},o(t){ft(o),n=!1},d(t){t&&E(r),o.d(t)}}}function Ib(e){let r,n;return r=new yb({}),{c(){ht(r.$$.fragment)},m(t,e){pt(r,t,e),n=!0},p:t,i(t){n||(ut(r.$$.fragment,t),n=!0)},o(t){ft(r.$$.fragment,t),n=!1},d(t){gt(r,t)}}}function Ab(t){let e,r,n,i,o,s,a,c,u,f,l,d,h,p,g,b,m,w,_=(t[0]?.state||"undefined")+"",B=t[0]?.actor?"":"",T=t[0]?.client?"":"",R=t[0]?.crypto?"":"";const U=[vb,wb,mb],P=[];function k(t,e){return t[0]&&"initialized"===t[0].state?0:t[0]&&"anonymous"===t[0].state?1:2}return g=k(t),b=P[g]=U[g](t),{c(){e=x("div"),r=x("strong"),r.textContent=" Debug Info:",n=I(' Auth State = "'),i=I(_),o=I('" | \n  Actor: '),s=I(B),a=I(" | \n  Client: "),c=I(T),u=I(" | \n  Crypto: "),f=I(R),l=I(' | \n  Active Tab: "'),d=I(t[1]),h=I('"'),p=A(),b.c(),m=S(),N(e,"class","bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-4")},m(t,b){v(t,e,b),y(e,r),y(e,n),y(e,i),y(e,o),y(e,s),y(e,a),y(e,c),y(e,u),y(e,f),y(e,l),y(e,d),y(e,h),v(t,p,b),P[g].m(t,b),v(t,m,b),w=!0},p(t,[e]){(!w||1&e)&&_!==(_=(t[0]?.state||"undefined")+"")&&O(i,_),(!w||1&e)&&B!==(B=t[0]?.actor?"":"")&&O(s,B),(!w||1&e)&&T!==(T=t[0]?.client?"":"")&&O(c,T),(!w||1&e)&&R!==(R=t[0]?.crypto?"":"")&&O(f,R),(!w||2&e)&&O(d,t[1]);let r=g;g=k(t),g===r?P[g].p(t,e):(at(),ft(P[r],1,1,(()=>{P[r]=null})),ct(),b=P[g],b?b.p(t,e):(b=P[g]=U[g](t),b.c()),ut(b,1),b.m(m.parentNode,m))},i(t){w||(ut(b),w=!0)},o(t){ft(b),w=!1},d(t){t&&E(e),t&&E(p),P[g].d(t),t&&E(m)}}}function Sb(t,e,r){let n;u(t,Yp,(t=>r(0,n=t)));let i="list",o=0;function s(t){console.log(" Switching to tab:",t),r(1,i=t),console.log(" Active tab is now:",i)}return t.$$.update=()=>{1&t.$$.dirty&&console.log(" Synthetic.svelte - Auth State Debug:",{state:null==n?void 0:n.state,hasActor:!!(null==n?void 0:n.actor),hasClient:!!(null==n?void 0:n.client),hasCrypto:!!(null==n?void 0:n.crypto),timestamp:(new Date).toISOString()})},[n,i,o,function(){r(1,i="list"),r(2,o++,o)},s,()=>s("list"),()=>{console.log(" Upload CSV button clicked"),s("upload")},()=>s("sample")]}class Tb extends mt{constructor(t){super(),yt(this,t,Sb,Ab,s,{})}}function Nb(t){const e=t-1;return e*e*e+1}function Ob(t,{delay:r=0,duration:n=400,easing:i=e}={}){const o=+getComputedStyle(t).opacity;return{delay:r,duration:n,easing:i,css:t=>"opacity: "+t*o}}function Rb(t,{delay:e=0,duration:r=400,easing:n=Nb,x:i=0,y:o=0,opacity:s=0}={}){const a=getComputedStyle(t),c=+a.opacity,u="none"===a.transform?"":a.transform,l=c*(1-s),[d,h]=f(i),[p,g]=f(o);return{delay:e,duration:r,easing:n,css:(t,e)=>`\n\t\t\ttransform: ${u} translate(${(1-t)*d}${h}, ${(1-t)*p}${g});\n\t\t\topacity: ${c-l*e}`}}function Ub(t,e,r){const n=t.slice();return n[2]=e[r],n}function Pb(r,n){let s,a,c,u,f,l,h,p,g=n[2].message+"";return{key:r,first:null,c(){s=x("div"),a=x("p"),c=I(g),u=A(),N(s,"class",f="alert "+n[1][n[2].type]+" bg-opacity-100 text-white"),this.first=s},m(t,e){v(t,s,e),y(s,a),y(a,c),y(s,u),p=!0},p(t,e){n=t,(!p||1&e)&&g!==(g=n[2].message+"")&&O(c,g),(!p||1&e&&f!==(f="alert "+n[1][n[2].type]+" bg-opacity-100 text-white"))&&N(s,"class",f)},i(r){p||(J((()=>{p&&(h&&h.end(1),l=function(r,n,i){const s={direction:"in"};let a,c,u=n(r,i,s),f=!1,l=0;function h(){a&&$(r,a)}function p(){const{delay:n=0,duration:i=300,easing:o=e,tick:s=t,css:p}=u||lt;p&&(a=j(r,0,1,i,n,o,p,l++)),s(0,1);const g=d()+n,y=g+i;c&&c.abort(),f=!0,J((()=>it(r,!0,"start"))),c=b((t=>{if(f){if(t>=y)return s(1,0),it(r,!0,"end"),h(),f=!1;if(t>=g){const e=o((t-g)/i);s(e,1-e)}}return f}))}let g=!1;return{start(){g||(g=!0,$(r),o(u)?(u=u(s),nt().then(p)):p())},invalidate(){g=!1},end(){f&&(h(),f=!1)}}}(s,Rb,{x:100,duration:200}),l.start())})),p=!0)},o(r){l&&l.invalidate(),h=function(r,n,s){const a={direction:"out"};let c,u=n(r,s,a),f=!0;const l=st;function h(){const{delay:n=0,duration:o=300,easing:s=e,tick:a=t,css:h}=u||lt;h&&(c=j(r,1,0,o,n,s,h));const p=d()+n,g=p+o;J((()=>it(r,!1,"start"))),b((t=>{if(f){if(t>=g)return a(0,1),it(r,!1,"end"),--l.r||i(l.c),!1;if(t>=p){const e=s((t-p)/o);a(1-e,e)}}return f}))}return l.r+=1,o(u)?nt().then((()=>{u=u(a),h()})):h(),{end(t){t&&u.tick&&u.tick(1,0),f&&(c&&$(r,c),f=!1)}}}(s,Ob,{}),p=!1},d(t){t&&E(s),t&&h&&h.end()}}}function kb(t){let e,r,n=[],o=new Map,s=t[0];const a=t=>t[2].id;for(let e=0;e<s.length;e+=1){let r=Ub(t,s,e),i=a(r);o.set(i,n[e]=Pb(i,r))}return{c(){e=x("div");for(let t=0;t<n.length;t+=1)n[t].c();N(e,"class","absolute right-4 bottom-4 flex flex-col max-w-xs space-y-4")},m(t,i){v(t,e,i);for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,null);r=!0},p(t,[r]){3&r&&(s=t[0],at(),n=function(t,e,r,n,o,s,a,c,u,f,l,d){let h=t.length,p=s.length,g=h;const b={};for(;g--;)b[t[g].key]=g;const y=[],m=new Map,w=new Map,v=[];for(g=p;g--;){const t=d(o,s,g),i=r(t);let c=a.get(i);c?n&&v.push((()=>c.p(t,e))):(c=f(i,t),c.c()),m.set(i,y[g]=c),i in b&&w.set(i,Math.abs(g-b[i]))}const E=new Set,_=new Set;function x(t){ut(t,1),t.m(c,l),a.set(t.key,t),l=t.first,p--}for(;h&&p;){const e=y[p-1],r=t[h-1],n=e.key,i=r.key;e===r?(l=e.first,h--,p--):m.has(i)?!a.has(n)||E.has(n)?x(e):_.has(i)?h--:w.get(n)>w.get(i)?(_.add(n),x(e)):(E.add(i),h--):(u(r,a),h--)}for(;h--;){const e=t[h];m.has(e.key)||u(e,a)}for(;p;)x(y[p-1]);return i(v),y}(n,r,a,1,t,s,o,e,dt,Pb,null,Ub),ct())},i(t){if(!r){for(let t=0;t<s.length;t+=1)ut(n[t]);r=!0}},o(t){for(let t=0;t<n.length;t+=1)ft(n[t]);r=!1},d(t){t&&E(e);for(let t=0;t<n.length;t+=1)n[t].d()}}}function Fb(t,e,r){let n;u(t,xp,(t=>r(0,n=t)));return[n,{info:"alert-info",error:"alert-error",success:"alert-success"}]}class Lb extends mt{constructor(t){super(),yt(this,t,Fb,kb,s,{})}}function Cb(t){let e,r;return e=new ug({props:{auth:t[0]}}),{c(){ht(e.$$.fragment)},m(t,n){pt(e,t,n),r=!0},p(t,r){const n={};1&r&&(n.auth=t[0]),e.$set(n)},i(t){r||(ut(e.$$.fragment,t),r=!0)},o(t){ft(e.$$.fragment,t),r=!1},d(t){gt(e,t)}}}function Db(e){let r,n;return r=new Tb({}),{c(){ht(r.$$.fragment)},m(t,e){pt(r,t,e),n=!0},p:t,i(t){n||(ut(r.$$.fragment,t),n=!0)},o(t){ft(r.$$.fragment,t),n=!1},d(t){gt(r,t)}}}function jb(t){let e,r,n,i,o;const s=[Db,Cb],a=[];function c(t,e){return"initialized"===t[0].state?0:1}return e=c(t),r=a[e]=s[e](t),i=new Lb({}),{c(){r.c(),n=A(),ht(i.$$.fragment)},m(t,r){a[e].m(t,r),v(t,n,r),pt(i,t,r),o=!0},p(t,[i]){let o=e;e=c(t),e===o?a[e].p(t,i):(at(),ft(a[o],1,1,(()=>{a[o]=null})),ct(),r=a[e],r?r.p(t,i):(r=a[e]=s[e](t),r.c()),ut(r,1),r.m(n.parentNode,n))},i(t){o||(ut(r),ut(i.$$.fragment,t),o=!0)},o(t){ft(r),ft(i.$$.fragment,t),o=!1},d(t){a[e].d(t),t&&E(n),gt(i,t)}}}function $b(t,e,r){let n;return u(t,Yp,(t=>r(0,n=t))),[n]}class qb extends mt{constructor(t){super(),yt(this,t,$b,jb,s,{})}}(async()=>{new qb({target:document.body})})()}();
//# sourceMappingURL=main.js.map
