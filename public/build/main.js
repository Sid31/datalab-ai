!function(){"use strict";function e(){}!function(){const e={DFX_NETWORK:"local",CANISTER_ID_ENCRYPTED_NOTES:"uxrrr-q7777-77774-qaaaq-cai"};try{if(process)return process.env=Object.assign({},process.env),void Object.assign(process.env,e)}catch(e){}globalThis.process={env:e}}();const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function r(e){return e()}function i(){return Object.create(null)}function o(e){e.forEach(r)}function s(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function u(e){let t;return c(e,(e=>t=e))(),t}function f(e,t,n){e.$$.on_destroy.push(c(t,n))}function l(e,t,n,r){if(e){const i=d(e,t,n,r);return e[0](i)}}function d(e,t,r,i){return e[1]&&i?n(r.ctx.slice(),e[1](i(t))):r.ctx}function h(e,t,n,r){if(e[2]&&r){const i=e[2](r(n));if(void 0===t.dirty)return i;if("object"==typeof i){const e=[],n=Math.max(t.dirty.length,i.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|i[r];return e}return t.dirty|i}return t.dirty}function p(e,t,n,r,i,o){if(i){const s=d(t,n,r,o);e.p(s,i)}}function g(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function m(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function y(t){return t&&s(t.destroy)?t.destroy:e}function b(e){const t="string"==typeof e&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||"px"]:[e,"px"]}const w="undefined"!=typeof window;let v=w?()=>window.performance.now():()=>Date.now(),E=w?e=>requestAnimationFrame(e):e;const x=new Set;function _(e){x.forEach((t=>{t.c(e)||(x.delete(t),t.f())})),0!==x.size&&E(_)}function A(e){let t;return 0===x.size&&E(_),{promise:new Promise((n=>{x.add(t={c:e,f:n})})),abort(){x.delete(t)}}}function T(e,t){e.appendChild(t)}function S(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function B(e){const t=R("style");return function(e,t){T(e.head||e,t),t.sheet}(S(e),t),t.sheet}function N(e,t,n){e.insertBefore(t,n||null)}function O(e){e.parentNode&&e.parentNode.removeChild(e)}function I(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function R(e){return document.createElement(e)}function k(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function L(e){return document.createTextNode(e)}function $(){return L(" ")}function P(){return L("")}function U(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function D(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function F(e,t){t=""+t,e.data!==t&&(e.data=t)}function C(e,t){e.value=null==t?"":t}function M(e,t,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n,r,t),i}function j(e,t){return new e(t)}const q=new Map;let V,z=0;function H(e,t,n,r,i,o,s,a=0){const c=16.666/r;let u="{\n";for(let e=0;e<=1;e+=c){const r=t+(n-t)*o(e);u+=100*e+`%{${s(r,1-r)}}\n`}const f=u+`100% {${s(n,1-n)}}\n}`,l=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(f)}_${a}`,d=S(e),{stylesheet:h,rules:p}=q.get(d)||function(e,t){const n={stylesheet:B(t),rules:{}};return q.set(e,n),n}(d,e);p[l]||(p[l]=!0,h.insertRule(`@keyframes ${l} ${f}`,h.cssRules.length));const g=e.style.animation||"";return e.style.animation=`${g?`${g}, `:""}${l} ${r}ms linear ${i}ms 1 both`,z+=1,l}function G(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),i=n.length-r.length;i&&(e.style.animation=r.join(", "),z-=i,z||E((()=>{z||(q.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&O(t)})),q.clear())})))}function K(e){V=e}function W(){if(!V)throw new Error("Function called outside component initialization");return V}function Z(e){W().$$.on_destroy.push(e)}function Y(){const e=W();return(t,n,{cancelable:r=!1}={})=>{const i=e.$$.callbacks[t];if(i){const o=M(t,n,{cancelable:r});return i.slice().forEach((t=>{t.call(e,o)})),!o.defaultPrevented}return!0}}const X=[],J=[];let Q=[];const ee=[],te=Promise.resolve();let ne=!1;function re(e){Q.push(e)}const ie=new Set;let oe,se=0;function ae(){if(0!==se)return;const e=V;do{try{for(;se<X.length;){const e=X[se];se++,K(e),ce(e.$$)}}catch(e){throw X.length=0,se=0,e}for(K(null),X.length=0,se=0;J.length;)J.pop()();for(let e=0;e<Q.length;e+=1){const t=Q[e];ie.has(t)||(ie.add(t),t())}Q.length=0}while(X.length);for(;ee.length;)ee.pop()();ne=!1,ie.clear(),K(e)}function ce(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(re)}}function ue(){return oe||(oe=Promise.resolve(),oe.then((()=>{oe=null}))),oe}function fe(e,t,n){e.dispatchEvent(M(`${t?"intro":"outro"}${n}`))}const le=new Set;let de;function he(){de={r:0,c:[],p:de}}function pe(){de.r||o(de.c),de=de.p}function ge(e,t){e&&e.i&&(le.delete(e),e.i(t))}function me(e,t,n,r){if(e&&e.o){if(le.has(e))return;le.add(e),de.c.push((()=>{le.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}const ye={duration:0};function be(n,r,i){const a={direction:"out"};let c,u=r(n,i,a),f=!0;const l=de;function d(){const{delay:r=0,duration:i=300,easing:s=t,tick:a=e,css:d}=u||ye;d&&(c=H(n,1,0,i,r,s,d));const h=v()+r,p=h+i;re((()=>fe(n,!1,"start"))),A((e=>{if(f){if(e>=p)return a(0,1),fe(n,!1,"end"),--l.r||o(l.c),!1;if(e>=h){const t=s((e-h)/i);a(1-t,t)}}return f}))}return l.r+=1,s(u)?ue().then((()=>{u=u(a),d()})):d(),{end(e){e&&u.tick&&u.tick(1,0),f&&(c&&G(n,c),f=!1)}}}function we(e,t){me(e,1,1,(()=>{t.delete(e.key)}))}function ve(e,t,n,r,i,s,a,c,u,f,l,d){let h=e.length,p=s.length,g=h;const m={};for(;g--;)m[e[g].key]=g;const y=[],b=new Map,w=new Map,v=[];for(g=p;g--;){const e=d(i,s,g),o=n(e);let c=a.get(o);c?r&&v.push((()=>c.p(e,t))):(c=f(o,e),c.c()),b.set(o,y[g]=c),o in m&&w.set(o,Math.abs(g-m[o]))}const E=new Set,x=new Set;function _(e){ge(e,1),e.m(c,l),a.set(e.key,e),l=e.first,p--}for(;h&&p;){const t=y[p-1],n=e[h-1],r=t.key,i=n.key;t===n?(l=t.first,h--,p--):b.has(i)?!a.has(r)||E.has(r)?_(t):x.has(i)?h--:w.get(r)>w.get(i)?(x.add(r),_(t)):(E.add(i),h--):(u(n,a),h--)}for(;h--;){const t=e[h];b.has(t.key)||u(t,a)}for(;p;)_(y[p-1]);return o(v),y}function Ee(e,t){const n={},r={},i={$$scope:1};let o=e.length;for(;o--;){const s=e[o],a=t[o];if(a){for(const e in s)e in a||(r[e]=1);for(const e in a)i[e]||(n[e]=a[e],i[e]=1);e[o]=a}else for(const e in s)i[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}function xe(e){return"object"==typeof e&&null!==e?e:{}}function _e(e){e&&e.c()}function Ae(e,t,n,i){const{fragment:a,after_update:c}=e.$$;a&&a.m(t,n),i||re((()=>{const t=e.$$.on_mount.map(r).filter(s);e.$$.on_destroy?e.$$.on_destroy.push(...t):o(t),e.$$.on_mount=[]})),c.forEach(re)}function Te(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];Q.forEach((r=>-1===e.indexOf(r)?t.push(r):n.push(r))),n.forEach((e=>e())),Q=t}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Se(e,t){-1===e.$$.dirty[0]&&(X.push(e),ne||(ne=!0,te.then(ae)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Be(t,n,r,s,a,c,u,f=[-1]){const l=V;K(t);const d=t.$$={fragment:null,ctx:[],props:c,update:e,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(l?l.$$.context:[])),callbacks:i(),dirty:f,skip_bound:!1,root:n.target||l.$$.root};u&&u(d.root);let h=!1;if(d.ctx=r?r(t,n.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return d.ctx&&a(d.ctx[e],d.ctx[e]=i)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](i),h&&Se(t,e)),n})):[],d.update(),h=!0,o(d.before_update),d.fragment=!!s&&s(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(O)}else d.fragment&&d.fragment.c();n.intro&&ge(t.$$.fragment),Ae(t,n.target,n.anchor,n.customElement),ae()}K(l)}class Ne{$destroy(){Te(this,1),this.$destroy=e}$on(t,n){if(!s(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Oe=[];function Ie(e,t){return{subscribe:Re(e,t).subscribe}}function Re(t,n=e){let r;const i=new Set;function o(e){if(a(t,e)&&(t=e,r)){const e=!Oe.length;for(const e of i)e[1](),Oe.push(e,t);if(e){for(let e=0;e<Oe.length;e+=2)Oe[e][0](Oe[e+1]);Oe.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(s,a=e){const c=[s,a];return i.add(c),1===i.size&&(r=n(o)||e),s(t),()=>{i.delete(c),0===i.size&&r&&(r(),r=null)}}}}var ke="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Le(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}for(var $e={},Pe={byteLength:function(e){var t=je(e),n=t[0],r=t[1];return 3*(n+r)/4-r},toByteArray:function(e){var t,n,r=je(e),i=r[0],o=r[1],s=new Fe(function(e,t,n){return 3*(t+n)/4-n}(0,i,o)),a=0,c=o>0?i-4:i;for(n=0;n<c;n+=4)t=De[e.charCodeAt(n)]<<18|De[e.charCodeAt(n+1)]<<12|De[e.charCodeAt(n+2)]<<6|De[e.charCodeAt(n+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=255&t;2===o&&(t=De[e.charCodeAt(n)]<<2|De[e.charCodeAt(n+1)]>>4,s[a++]=255&t);1===o&&(t=De[e.charCodeAt(n)]<<10|De[e.charCodeAt(n+1)]<<4|De[e.charCodeAt(n+2)]>>2,s[a++]=t>>8&255,s[a++]=255&t);return s},fromByteArray:function(e){for(var t,n=e.length,r=n%3,i=[],o=16383,s=0,a=n-r;s<a;s+=o)i.push(qe(e,s,s+o>a?a:s+o));1===r?(t=e[n-1],i.push(Ue[t>>2]+Ue[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(Ue[t>>10]+Ue[t>>4&63]+Ue[t<<2&63]+"="));return i.join("")}},Ue=[],De=[],Fe="undefined"!=typeof Uint8Array?Uint8Array:Array,Ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Me=0;Me<64;++Me)Ue[Me]=Ce[Me],De[Ce.charCodeAt(Me)]=Me;function je(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function qe(e,t,n){for(var r,i,o=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(Ue[(i=r)>>18&63]+Ue[i>>12&63]+Ue[i>>6&63]+Ue[63&i]);return o.join("")}De["-".charCodeAt(0)]=62,De["_".charCodeAt(0)]=63;var Ve,ze={};ze.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,f=-7,l=n?i-1:0,d=n?-1:1,h=e[t+l];for(l+=d,o=h&(1<<-f)-1,h>>=-f,f+=a;f>0;o=256*o+e[t+l],l+=d,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=r;f>0;s=256*s+e[t+l],l+=d,f-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,r),o-=u}return(h?-1:1)*s*Math.pow(2,o-r)},ze.write=function(e,t,n,r,i,o){var s,a,c,u=8*o-i-1,f=(1<<u)-1,l=f>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:o-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=f):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+l>=1?d/c:d*Math.pow(2,1-l))*c>=2&&(s++,c/=2),s+l>=f?(a=0,s=f):s+l>=1?(a=(t*c-1)*Math.pow(2,i),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;e[n+h]=255&a,h+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[n+h]=255&s,h+=p,s/=256,u-=8);e[n+h-p]|=128*g},function(e){const t=Pe,n=ze,r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=s,e.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},e.INSPECT_MAX_BYTES=50;const i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return a(e,t,n)}function a(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|h(e,t);let r=o(n);const i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(K(e,Uint8Array)){const t=new Uint8Array(e);return l(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(K(e,ArrayBuffer)||e&&K(e.buffer,ArrayBuffer))return l(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(K(e,SharedArrayBuffer)||e&&K(e.buffer,SharedArrayBuffer)))return l(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return s.from(r,t,n);const i=function(e){if(s.isBuffer(e)){const t=0|d(e.length),n=o(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||W(e.length)?o(0):f(e);if("Buffer"===e.type&&Array.isArray(e.data))return f(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),o(e<0?0:0|d(e))}function f(e){const t=e.length<0?0:0|d(e.length),n=o(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function l(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,s.prototype),r}function d(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function h(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||K(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(i)return r?-1:z(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return A(this,t,n);case"ascii":return S(this,t,n);case"latin1":case"binary":return B(this,t,n);case"base64":return _(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),W(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=s.from(t,r)),s.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){let o,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){let r=-1;for(o=n;o<a;o++)if(u(e,o)===u(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===c)return r*s}else-1!==r&&(o-=o-r),r=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){let n=!0;for(let r=0;r<c;r++)if(u(e,o+r)!==u(t,r)){n=!1;break}if(n)return o}return-1}function b(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=t.length;let s;for(r>o/2&&(r=o/2),s=0;s<r;++s){const r=parseInt(t.substr(2*s,2),16);if(W(r))return s;e[n+s]=r}return s}function w(e,t,n,r){return G(z(t,e.length-n),e,n,r)}function v(e,t,n,r){return G(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function E(e,t,n,r){return G(H(t),e,n,r)}function x(e,t,n,r){return G(function(e,t){let n,r,i;const o=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function _(e,n,r){return 0===n&&r===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(n,r))}function A(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let o=null,s=t>239?4:t>223?3:t>191?2:1;if(i+s<=n){let n,r,a,c;switch(s){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128==(192&n)&&(c=(31&t)<<6|63&n,c>127&&(o=c));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(e){const t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=T));return n}(r)}e.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,n){return a(e,t,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,n){return function(e,t,n){return c(e),e<=0?o(e):void 0!==t?"string"==typeof n?o(e).fill(t,n):o(e).fill(t):o(e)}(e,t,n)},s.allocUnsafe=function(e){return u(e)},s.allocUnsafeSlow=function(e){return u(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(K(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),K(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=s.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(K(t,Uint8Array))i+t.length>r.length?(s.isBuffer(t)||(t=s.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!s.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},s.byteLength=h,s.prototype._isBuffer=!0,s.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)g(this,t,t+1);return this},s.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},s.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},s.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?A(this,0,e):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){let t="";const n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(e,t,n,r,i){if(K(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0);const c=Math.min(o,a),u=this.slice(r,i),f=e.slice(t,n);for(let e=0;e<c;++e)if(u[e]!==f[e]){o=u[e],a=f[e];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},s.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":case"latin1":case"binary":return v(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const T=4096;function S(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function B(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function N(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=Z[e[r]];return i}function O(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function I(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,r,i,o){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function k(e,t,n,r,i){M(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,n}function L(e,t,n,r,i){M(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let s=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=s,s>>=8,e[n+2]=s,s>>=8,e[n+1]=s,s>>=8,e[n]=s,n+8}function $(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function P(e,t,r,i,o){return t=+t,r>>>=0,o||$(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function U(e,t,r,i,o){return t=+t,r>>>=0,o||$(e,0,r,8),n.write(e,t,r,i,52,8),r+8}s.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,s.prototype),r},s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readBigUInt64LE=Y((function(e){j(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||q(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),s.prototype.readBigUInt64BE=Y((function(e){j(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||q(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),s.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},s.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},s.prototype.readInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||I(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){e>>>=0,t||I(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readBigInt64LE=Y((function(e){j(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||q(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),s.prototype.readBigInt64BE=Y((function(e){j(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||q(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),s.prototype.readFloatLE=function(e,t){return e>>>=0,t||I(e,4,this.length),n.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||I(e,4,this.length),n.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||I(e,8,this.length),n.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||I(e,8,this.length),n.read(this,e,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){R(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){R(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigUInt64LE=Y((function(e,t=0){return k(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeBigUInt64BE=Y((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);R(this,e,t,n,r-1,-r)}let i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},s.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);R(this,e,t,n,r-1,-r)}let i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigInt64LE=Y((function(e,t=0){return k(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeBigInt64BE=Y((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeFloatLE=function(e,t,n){return P(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return P(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,r){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},s.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=s.isBuffer(e)?e:s.from(e,r),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%a]}return this};const D={};function F(e,t,n){D[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function C(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function M(e,t,n,r,i,o){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new D.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){j(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||q(t,e.length-(n+1))}(r,i,o)}function j(e,t){if("number"!=typeof e)throw new D.ERR_INVALID_ARG_TYPE(t,"number",e)}function q(e,t,n){if(Math.floor(e)!==e)throw j(e,n),new D.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new D.ERR_BUFFER_OUT_OF_BOUNDS;throw new D.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}F("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),F("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),F("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=C(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=C(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);const V=/[^+/0-9A-Za-z-_]/g;function z(e,t){let n;t=t||1/0;const r=e.length;let i=null;const o=[];for(let s=0;s<r;++s){if(n=e.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function H(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function K(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function W(e){return e!=e}const Z=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function Y(e){return"undefined"==typeof BigInt?X:e}function X(){throw new Error("BigInt not supported")}}($e),function(e){e[e.SysFatal=1]="SysFatal",e[e.SysTransient=2]="SysTransient",e[e.DestinationInvalid=3]="DestinationInvalid",e[e.CanisterReject=4]="CanisterReject",e[e.CanisterError=5]="CanisterError"}(Ve||(Ve={}));const He="abcdefghijklmnopqrstuvwxyz234567",Ge=Object.create(null);for(let e=0;e<32;e++)Ge[He[e]]=e;Ge[0]=Ge.o,Ge[1]=Ge.i;const Ke=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);const We="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function Ze(e,...t){if(!((n=e)instanceof Uint8Array||ArrayBuffer.isView(n)&&"Uint8Array"===n.constructor.name))throw new Error("Uint8Array expected");var n;if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Ye(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Xe(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Je(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Qe(e,t){return e<<32-t|e>>>t}function et(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e)),Ze(e),e}class tt{}function nt(e){const t=t=>e().update(et(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function rt(e=32){if(We&&"function"==typeof We.getRandomValues)return We.getRandomValues(new Uint8Array(e));if(We&&"function"==typeof We.randomBytes)return Uint8Array.from(We.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function it(e,t,n){return e&t^~e&n}function ot(e,t,n){return e&t^e&n^t&n}class st extends tt{constructor(e,t,n,r){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.buffer=new Uint8Array(e),this.view=Je(this.buffer)}update(e){Ye(this),Ze(e=et(e));const{view:t,buffer:n,blockLen:r}=this,i=e.length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=Je(e);for(;r<=i-o;o+=r)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ye(this),function(e,t){Ze(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;t[o++]=128,Xe(this.buffer.subarray(o)),this.padOffset>r-o&&(this.process(n,0),o=0);for(let e=o;e<r;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)}(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=Je(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return e.destroyed=o,e.finished=i,e.length=r,e.pos=s,r%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const at=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ct=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),ut=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),ft=BigInt(2**32-1),lt=BigInt(32);function dt(e,t=!1){return t?{h:Number(e&ft),l:Number(e>>lt&ft)}:{h:0|Number(e>>lt&ft),l:0|Number(e&ft)}}const ht=(e,t,n)=>e>>>n,pt=(e,t,n)=>e<<32-n|t>>>n,gt=(e,t,n)=>e>>>n|t<<32-n,mt=(e,t,n)=>e<<32-n|t>>>n,yt=(e,t,n)=>e<<64-n|t>>>n-32,bt=(e,t,n)=>e>>>n-32|t<<64-n;function wt(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:0|i}}const vt=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Et=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,xt=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),_t=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,At=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),Tt=(e,t,n,r,i,o)=>t+n+r+i+o+(e/2**32|0)|0,St=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Bt=new Uint32Array(64);class Nt extends st{constructor(e=32){super(64,e,8,!1),this.A=0|at[0],this.B=0|at[1],this.C=0|at[2],this.D=0|at[3],this.E=0|at[4],this.F=0|at[5],this.G=0|at[6],this.H=0|at[7]}get(){const{A:e,B:t,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[e,t,n,r,i,o,s,a]}set(e,t,n,r,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)Bt[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=Bt[e-15],n=Bt[e-2],r=Qe(t,7)^Qe(t,18)^t>>>3,i=Qe(n,17)^Qe(n,19)^n>>>10;Bt[e]=i+Bt[e-7]+r+Bt[e-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(Qe(s,6)^Qe(s,11)^Qe(s,25))+it(s,a,c)+St[e]+Bt[e]|0,f=(Qe(n,2)^Qe(n,13)^Qe(n,22))+ot(n,r,i)|0;u=c,c=a,a=s,s=o+t|0,o=i,i=r,r=n,n=t+f|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,i,o,s,a,c,u)}roundClean(){Xe(Bt)}destroy(){this.set(0,0,0,0,0,0,0,0),Xe(this.buffer)}}class Ot extends Nt{constructor(){super(28),this.A=0|ct[0],this.B=0|ct[1],this.C=0|ct[2],this.D=0|ct[3],this.E=0|ct[4],this.F=0|ct[5],this.G=0|ct[6],this.H=0|ct[7]}}const It=(()=>function(e,t=!1){const n=e.length;let r=new Uint32Array(n),i=new Uint32Array(n);for(let o=0;o<n;o++){const{h:n,l:s}=dt(e[o],t);[r[o],i[o]]=[n,s]}return[r,i]}(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),Rt=(()=>It[0])(),kt=(()=>It[1])(),Lt=new Uint32Array(80),$t=new Uint32Array(80);class Pt extends st{constructor(e=64){super(128,e,16,!1),this.Ah=0|ut[0],this.Al=0|ut[1],this.Bh=0|ut[2],this.Bl=0|ut[3],this.Ch=0|ut[4],this.Cl=0|ut[5],this.Dh=0|ut[6],this.Dl=0|ut[7],this.Eh=0|ut[8],this.El=0|ut[9],this.Fh=0|ut[10],this.Fl=0|ut[11],this.Gh=0|ut[12],this.Gl=0|ut[13],this.Hh=0|ut[14],this.Hl=0|ut[15]}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:u,Fh:f,Fl:l,Gh:d,Gl:h,Hh:p,Hl:g}=this;return[e,t,n,r,i,o,s,a,c,u,f,l,d,h,p,g]}set(e,t,n,r,i,o,s,a,c,u,f,l,d,h,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|f,this.Fl=0|l,this.Gh=0|d,this.Gl=0|h,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let n=0;n<16;n++,t+=4)Lt[n]=e.getUint32(t),$t[n]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|Lt[e-15],n=0|$t[e-15],r=gt(t,n,1)^gt(t,n,8)^ht(t,0,7),i=mt(t,n,1)^mt(t,n,8)^pt(t,n,7),o=0|Lt[e-2],s=0|$t[e-2],a=gt(o,s,19)^yt(o,s,61)^ht(o,0,6),c=mt(o,s,19)^bt(o,s,61)^pt(o,s,6),u=xt(i,c,$t[e-7],$t[e-16]),f=_t(u,r,a,Lt[e-7],Lt[e-16]);Lt[e]=0|f,$t[e]=0|u}let{Ah:n,Al:r,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:u,Eh:f,El:l,Fh:d,Fl:h,Gh:p,Gl:g,Hh:m,Hl:y}=this;for(let e=0;e<80;e++){const t=gt(f,l,14)^gt(f,l,18)^yt(f,l,41),b=mt(f,l,14)^mt(f,l,18)^bt(f,l,41),w=f&d^~f&p,v=At(y,b,l&h^~l&g,kt[e],$t[e]),E=Tt(v,m,t,w,Rt[e],Lt[e]),x=0|v,_=gt(n,r,28)^yt(n,r,34)^yt(n,r,39),A=mt(n,r,28)^bt(n,r,34)^bt(n,r,39),T=n&i^n&s^i&s,S=r&o^r&a^o&a;m=0|p,y=0|g,p=0|d,g=0|h,d=0|f,h=0|l,({h:f,l:l}=wt(0|c,0|u,0|E,0|x)),c=0|s,u=0|a,s=0|i,a=0|o,i=0|n,o=0|r;const B=vt(x,A,S);n=Et(B,E,_,T),r=0|B}({h:n,l:r}=wt(0|this.Ah,0|this.Al,0|n,0|r)),({h:i,l:o}=wt(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=wt(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=wt(0|this.Dh,0|this.Dl,0|c,0|u)),({h:f,l:l}=wt(0|this.Eh,0|this.El,0|f,0|l)),({h:d,l:h}=wt(0|this.Fh,0|this.Fl,0|d,0|h)),({h:p,l:g}=wt(0|this.Gh,0|this.Gl,0|p,0|g)),({h:m,l:y}=wt(0|this.Hh,0|this.Hl,0|m,0|y)),this.set(n,r,i,o,s,a,c,u,f,l,d,h,p,g,m,y)}roundClean(){Xe(Lt,$t)}destroy(){Xe(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Ut=nt((()=>new Nt)),Dt=nt((()=>new Ot)),Ft=nt((()=>new Pt)),Ct=Ut,Mt=Dt;const jt="__principal__";let qt=class e{constructor(e){this._arr=e,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([4]))}static managementCanister(){return this.fromText("aaaaa-aa")}static selfAuthenticating(e){const t=(n=e,Mt.create().update(new Uint8Array(n)).digest());var n;return new this(new Uint8Array([...t,2]))}static from(t){if("string"==typeof t)return e.fromText(t);if(Object.getPrototypeOf(t)===Uint8Array.prototype)return new e(t);if("object"==typeof t&&null!==t&&!0===t._isPrincipal)return new e(t._arr);throw new Error(`Impossible to convert ${JSON.stringify(t)} to Principal.`)}static fromHex(e){return new this((e=>{var t;return new Uint8Array((null!==(t=e.match(/.{1,2}/g))&&void 0!==t?t:[]).map((e=>parseInt(e,16))))})(e))}static fromText(e){let t=e;if(e.includes(jt)){const n=JSON.parse(e);jt in n&&(t=n[jt])}let n=function(e){let t=0,n=0;const r=new Uint8Array(4*e.length/3|0);let i=0;function o(e){let o=Ge[e.toLowerCase()];if(void 0===o)throw new Error(`Invalid character: ${JSON.stringify(e)}`);o<<=3,n|=o>>>t,t+=5,t>=8&&(r[i++]=n,t-=8,n=t>0?o<<5-t&255:0)}for(const t of e)o(t);return r.slice(0,i)}(t.toLowerCase().replace(/-/g,""));n=n.slice(4,n.length);const r=new this(n);if(r.toText()!==t)throw new Error(`Principal "${r.toText()}" does not have a valid checksum (original value "${t}" may not be a valid Principal ID).`);return r}static fromUint8Array(e){return new this(e)}isAnonymous(){return 1===this._arr.byteLength&&4===this._arr[0]}toUint8Array(){return this._arr}toHex(){return(e=>e.reduce(((e,t)=>e+t.toString(16).padStart(2,"0")),""))(this._arr).toUpperCase()}toText(){const e=new ArrayBuffer(4);new DataView(e).setUint32(0,function(e){const t=new Uint8Array(e);let n=-1;for(let e=0;e<t.length;e++){const r=t[e];n=Ke[255&(r^n)]^n>>>8}return(-1^n)>>>0}(this._arr));const t=new Uint8Array(e),n=Uint8Array.from(this._arr),r=function(e){let t=0,n=0,r="";for(let o=0;o<e.length;)o+=(i=e[o],t<0?n|=i>>-t:n=i<<t&248,t>3?(t-=8,1):(t<4&&(r+=He[n>>3],t+=5),0));var i;return r+(t<0?He[n>>3]:"")}(new Uint8Array([...t,...n])),i=r.match(/.{1,5}/g);if(!i)throw new Error;return i.join("-")}toString(){return this.toText()}toJSON(){return{[jt]:this.toText()}}compareTo(e){for(let t=0;t<Math.min(this._arr.length,e._arr.length);t++){if(this._arr[t]<e._arr[t])return"lt";if(this._arr[t]>e._arr[t])return"gt"}return this._arr.length<e._arr.length?"lt":this._arr.length>e._arr.length?"gt":"eq"}ltEq(e){const t=this.compareTo(e);return"lt"==t||"eq"==t}gtEq(e){const t=this.compareTo(e);return"gt"==t||"eq"==t}};function Vt(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.byteLength),0));let n=0;for(const r of e)t.set(new Uint8Array(r),n),n+=r.byteLength;return t.buffer}function zt(e){return[...new Uint8Array(e)].map((e=>e.toString(16).padStart(2,"0"))).join("")}const Ht=new RegExp(/^[0-9a-fA-F]+$/);function Gt(e){if(!Ht.test(e))throw new Error("Invalid hexadecimal string.");const t=[...e].reduce(((e,t,n)=>(e[n/2|0]=(e[n/2|0]||"")+t,e)),[]).map((e=>Number.parseInt(e,16)));return new Uint8Array(t).buffer}function Kt(e,t){if(e.byteLength!==t.byteLength)return e.byteLength-t.byteLength;const n=new Uint8Array(e),r=new Uint8Array(t);for(let e=0;e<n.length;e++)if(n[e]!==r[e])return n[e]-r[e];return 0}function Wt(e,t){return 0===Kt(e,t)}function Zt(e){return new DataView(e.buffer,e.byteOffset,e.byteLength).buffer}function Yt(e){return e instanceof Uint8Array?Zt(e):e instanceof ArrayBuffer?e:Array.isArray(e)?Zt(new Uint8Array(e)):"buffer"in e?Yt(e.buffer):Zt(new Uint8Array(e))}class Xt extends Error{constructor(e){super(e),this.message=e,this.name="AgentError",this.__proto__=Xt.prototype,Object.setPrototypeOf(this,Xt.prototype)}}function Jt(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.byteLength),0));let n=0;for(const r of e)t.set(new Uint8Array(r),n),n+=r.byteLength;return t}class Qt{constructor(e,t=(null==e?void 0:e.byteLength)||0){this._buffer=tn(e||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,t)}save(){return this._view}restore(e){this._view=e}get buffer(){return tn(this._view.slice())}get byteLength(){return this._view.byteLength}read(e){const t=this._view.subarray(0,e);return this._view=this._view.subarray(e),t.slice().buffer}readUint8(){const e=this._view[0];return this._view=this._view.subarray(1),e}write(e){const t=new Uint8Array(e),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+t.byteLength>=this._buffer.byteLength?this.alloc(t.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+t.byteLength),this._view.set(t,n)}get end(){return 0===this._view.byteLength}alloc(e){const t=new ArrayBuffer(1.2*(this._buffer.byteLength+e)|0),n=new Uint8Array(t,0,this._view.byteLength+e);n.set(this._view),this._buffer=t,this._view=n}}function en(e){return new DataView(e.buffer,e.byteOffset,e.byteLength).buffer}function tn(e){return e instanceof Uint8Array?en(e):e instanceof ArrayBuffer?e:Array.isArray(e)?en(new Uint8Array(e)):"buffer"in e?tn(e.buffer):en(new Uint8Array(e))}function nn(e){if(/^_\d+_$/.test(e)||/^_0x[0-9a-fA-F]+_$/.test(e)){const t=+e.slice(1,-1);if(Number.isSafeInteger(t)&&t>=0&&t<2**32)return t}return function(e){const t=(new TextEncoder).encode(e);let n=0;for(const e of t)n=(223*n+e)%2**32;return n}(e)}function rn(){throw new Error("unexpected end of buffer")}function on(e,t){return e.byteLength<t&&rn(),e.read(t)}function sn(e){const t=e.readUint8();return void 0===t&&rn(),t}function an(e){if("number"==typeof e&&(e=BigInt(e)),e<BigInt(0))throw new Error("Cannot leb encode negative values.");const t=(e===BigInt(0)?0:Math.ceil(Math.log2(Number(e))))+1,n=new Qt(new ArrayBuffer(t),0);for(;;){const t=Number(e&BigInt(127));if((e/=BigInt(128))===BigInt(0)){n.write(new Uint8Array([t]));break}n.write(new Uint8Array([128|t]))}return n.buffer}function cn(e){let t,n=BigInt(1),r=BigInt(0);do{t=sn(e),r+=BigInt(127&t).valueOf()*n,n*=BigInt(128)}while(t>=128);return r}function un(e){"number"==typeof e&&(e=BigInt(e));const t=e<BigInt(0);t&&(e=-e-BigInt(1));const n=(e===BigInt(0)?0:Math.ceil(Math.log2(Number(e))))+1,r=new Qt(new ArrayBuffer(n),0);for(;;){const n=i(e);if(e/=BigInt(128),t&&e===BigInt(0)&&0!=(64&n)||!t&&e===BigInt(0)&&0==(64&n)){r.write(new Uint8Array([n]));break}r.write(new Uint8Array([128|n]))}function i(e){const n=e%BigInt(128);return Number(t?BigInt(128)-n-BigInt(1):n)}return r.buffer}function fn(e){const t=new Uint8Array(e.buffer);let n=0;for(;n<t.byteLength;n++)if(t[n]<128){if(0==(64&t[n]))return cn(e);break}const r=new Uint8Array(on(e,n+1));let i=BigInt(0);for(let e=r.byteLength-1;e>=0;e--)i=i*BigInt(128)+BigInt(128-(127&r[e])-1);return-i-BigInt(1)}function ln(e,t){e=BigInt(e);const n=new Qt(new ArrayBuffer(Math.min(1,t)),0);let r=0,i=BigInt(256),o=BigInt(0),s=Number(e%i);for(n.write(new Uint8Array([s]));++r<t;)e<0&&o===BigInt(0)&&0!==s&&(o=BigInt(1)),s=Number((e/i-o)%BigInt(256)),n.write(new Uint8Array([s])),i*=BigInt(256);return n.buffer}function dn(e,t){let n=BigInt(sn(e)),r=BigInt(1),i=0;for(;++i<t;){r*=BigInt(256);n+=r*BigInt(sn(e))}return n}function hn(e){const t=BigInt(e);if(e<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<t}const pn="DIDL";function gn(e,t,n){return e.map(((e,r)=>n(e,t[r])))}class mn{constructor(){this._typs=[],this._idx=new Map}has(e){return this._idx.has(e.name)}add(e,t){const n=this._typs.length;this._idx.set(e.name,n),this._typs.push(t)}merge(e,t){const n=this._idx.get(e.name),r=this._idx.get(t);if(void 0===n)throw new Error("Missing type index for "+e);if(void 0===r)throw new Error("Missing type index for "+t);this._typs[n]=this._typs[r],this._typs.splice(r,1),this._idx.delete(t)}encode(){const e=an(this._typs.length),t=Jt(...this._typs);return Jt(e,t)}indexOf(e){if(!this._idx.has(e))throw new Error("Missing type index for "+e);return un(this._idx.get(e)||0)}}class yn{display(){return this.name}valueToString(e){return jn(e)}buildTypeTable(e){e.has(this)||this._buildTypeTableImpl(e)}}class bn extends yn{checkType(e){if(this.name!==e.name)throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`);return e}_buildTypeTableImpl(e){}}class wn extends yn{checkType(e){if(e instanceof Un){const t=e.getType();if(void 0===t)throw new Error("type mismatch with uninitialized type");return t}throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`)}encodeType(e){return e.indexOf(this.name)}}class vn extends bn{accept(e,t){return e.visitEmpty(this,t)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return un(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class En extends yn{checkType(e){throw new Error("Method not implemented for unknown.")}accept(e,t){throw e.visitType(this,t)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(e,t){let n,r=t.decodeValue(e,t);return Object(r)!==r&&(r=Object(r)),n=t instanceof Un?()=>t.getType():()=>t,Object.defineProperty(r,"type",{value:n,writable:!0,enumerable:!1,configurable:!0}),r}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class xn extends bn{accept(e,t){return e.visitBool(this,t)}covariant(e){if("boolean"==typeof e)return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){return new Uint8Array([e?1:0])}encodeType(){return un(-2)}decodeValue(e,t){switch(this.checkType(t),sn(e)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class _n extends bn{accept(e,t){return e.visitNull(this,t)}covariant(e){if(null===e)return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return un(-1)}decodeValue(e,t){return this.checkType(t),null}get name(){return"null"}}class An extends bn{accept(e,t){return e.visitReserved(this,t)}covariant(e){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return un(-16)}decodeValue(e,t){return t.name!==this.name&&t.decodeValue(e,t),null}get name(){return"reserved"}}class Tn extends bn{accept(e,t){return e.visitText(this,t)}covariant(e){if("string"==typeof e)return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){const t=(new TextEncoder).encode(e);return Jt(an(t.byteLength),t)}encodeType(){return un(-15)}decodeValue(e,t){this.checkType(t);const n=cn(e),r=on(e,Number(n));return new TextDecoder("utf8",{fatal:!0}).decode(r)}get name(){return"text"}valueToString(e){return'"'+e+'"'}}class Sn extends bn{accept(e,t){return e.visitInt(this,t)}covariant(e){if("bigint"==typeof e||Number.isInteger(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){return un(e)}encodeType(){return un(-4)}decodeValue(e,t){return this.checkType(t),fn(e)}get name(){return"int"}valueToString(e){return e.toString()}}class Bn extends bn{accept(e,t){return e.visitNat(this,t)}covariant(e){if("bigint"==typeof e&&e>=BigInt(0)||Number.isInteger(e)&&e>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){return an(e)}encodeType(){return un(-3)}decodeValue(e,t){return this.checkType(t),cn(e)}get name(){return"nat"}valueToString(e){return e.toString()}}class Nn extends bn{constructor(e){if(super(),this._bits=e,32!==e&&64!==e)throw new Error("not a valid float type")}accept(e,t){return e.visitFloat(this,t)}covariant(e){if("number"==typeof e||e instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){const t=new ArrayBuffer(this._bits/8),n=new DataView(t);return 32===this._bits?n.setFloat32(0,e,!0):n.setFloat64(0,e,!0),t}encodeType(){return un(32===this._bits?-13:-14)}decodeValue(e,t){this.checkType(t);const n=on(e,this._bits/8),r=new DataView(n);return 32===this._bits?r.getFloat32(0,!0):r.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(e){return e.toString()}}class On extends bn{constructor(e){super(),this._bits=e}accept(e,t){return e.visitFixedInt(this,t)}covariant(e){const t=hn(this._bits-1)*BigInt(-1),n=hn(this._bits-1)-BigInt(1);let r=!1;if("bigint"==typeof e)r=e>=t&&e<=n;else if(Number.isInteger(e)){const i=BigInt(e);r=i>=t&&i<=n}else r=!1;if(r)return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){return ln(e,this._bits/8)}encodeType(){return un(-9-(Math.log2(this._bits)-3))}decodeValue(e,t){this.checkType(t);const n=function(e,t){let n=dn(e,t);const r=BigInt(2)**(BigInt(8)*BigInt(t-1)+BigInt(7));return n>=r&&(n-=r*BigInt(2)),n}(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`int${this._bits}`}valueToString(e){return e.toString()}}class In extends bn{constructor(e){super(),this._bits=e}accept(e,t){return e.visitFixedNat(this,t)}covariant(e){const t=hn(this._bits);let n=!1;if("bigint"==typeof e&&e>=BigInt(0))n=e<t;else if(Number.isInteger(e)&&e>=0){n=BigInt(e)<t}else n=!1;if(n)return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){return function(e,t){if(BigInt(e)<BigInt(0))throw new Error("Cannot write negative values.");return ln(e,t)}(e,this._bits/8)}encodeType(){return un(-5-(Math.log2(this._bits)-3))}decodeValue(e,t){this.checkType(t);const n=dn(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`nat${this._bits}`}valueToString(e){return e.toString()}}class Rn extends wn{constructor(e){super(),this._type=e,this._blobOptimization=!1,e instanceof In&&8===e._bits&&(this._blobOptimization=!0)}accept(e,t){return e.visitVec(this,this._type,t)}covariant(e){const t=this._type instanceof In||this._type instanceof On?this._type._bits:0;if(ArrayBuffer.isView(e)&&t==8*e.BYTES_PER_ELEMENT||Array.isArray(e)&&e.every(((e,t)=>{try{return this._type.covariant(e)}catch(e){throw new Error(`Invalid ${this.display()} argument: \n\nindex ${t} -> ${e.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){const t=an(e.length);if(this._blobOptimization)return Jt(t,new Uint8Array(e));if(ArrayBuffer.isView(e))return Jt(t,new Uint8Array(e.buffer));const n=new Qt(new ArrayBuffer(t.byteLength+e.length),0);n.write(t);for(const t of e){const e=this._type.encodeValue(t);n.write(new Uint8Array(e))}return n.buffer}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const t=un(-19),n=this._type.encodeType(e);e.add(this,Jt(t,n))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof Rn))throw new Error("Not a vector type");const r=Number(cn(e));if(this._type instanceof In){if(8==this._type._bits)return new Uint8Array(e.read(r));if(16==this._type._bits)return new Uint16Array(e.read(2*r));if(32==this._type._bits)return new Uint32Array(e.read(4*r));if(64==this._type._bits)return new BigUint64Array(e.read(8*r))}if(this._type instanceof On){if(8==this._type._bits)return new Int8Array(e.read(r));if(16==this._type._bits)return new Int16Array(e.read(2*r));if(32==this._type._bits)return new Int32Array(e.read(4*r));if(64==this._type._bits)return new BigInt64Array(e.read(8*r))}const i=[];for(let t=0;t<r;t++)i.push(this._type.decodeValue(e,n._type));return i}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(e){return"vec {"+e.map((e=>this._type.valueToString(e))).join("; ")+"}"}}class kn extends wn{constructor(e){super(),this._type=e}accept(e,t){return e.visitOpt(this,this._type,t)}covariant(e){try{if(Array.isArray(e)&&(0===e.length||1===e.length&&this._type.covariant(e[0])))return!0}catch(t){throw new Error(`Invalid ${this.display()} argument: ${jn(e)} \n\n-> ${t.message}`)}throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){return 0===e.length?new Uint8Array([0]):Jt(new Uint8Array([1]),this._type.encodeValue(e[0]))}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const t=un(-18),n=this._type.encodeType(e);e.add(this,Jt(t,n))}decodeValue(e,t){if(t instanceof _n)return[];if(t instanceof An)return[];let n=t;if(t instanceof Un){const e=t.getType();if(void 0===e)throw new Error("type mismatch with uninitialized type");n=e}if(n instanceof kn)switch(sn(e)){case 0:return[];case 1:{const t=e.save();try{return[this._type.decodeValue(e,n._type)]}catch(r){return e.restore(t),n._type.decodeValue(e,n._type),[]}}default:throw new Error("Not an option value")}else{if(this._type instanceof _n||this._type instanceof kn||this._type instanceof An)return n.decodeValue(e,n),[];{const r=e.save();try{return[this._type.decodeValue(e,t)]}catch(i){return e.restore(r),n.decodeValue(e,t),[]}}}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(e){return 0===e.length?"null":`opt ${this._type.valueToString(e[0])}`}}class Ln extends wn{constructor(e={}){super(),this._fields=Object.entries(e).sort(((e,t)=>nn(e[0])-nn(t[0])))}accept(e,t){return e.visitRecord(this,this._fields,t)}tryAsTuple(){const e=[];for(let t=0;t<this._fields.length;t++){const[n,r]=this._fields[t];if(n!==`_${t}_`)return null;e.push(r)}return e}covariant(e){if("object"==typeof e&&this._fields.every((([t,n])=>{if(!e.hasOwnProperty(t))throw new Error(`Record is missing key "${t}".`);try{return n.covariant(e[t])}catch(e){throw new Error(`Invalid ${this.display()} argument: \n\nfield ${t} -> ${e.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){const t=this._fields.map((([t])=>e[t])),n=gn(this._fields,t,(([,e],t)=>e.encodeValue(t)));return Jt(...n)}_buildTypeTableImpl(e){this._fields.forEach((([t,n])=>n.buildTypeTable(e)));const t=un(-20),n=an(this._fields.length),r=this._fields.map((([t,n])=>Jt(an(nn(t)),n.encodeType(e))));e.add(this,Jt(t,n,Jt(...r)))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof Ln))throw new Error("Not a record type");const r={};let i=0,o=0;for(;o<n._fields.length;){const[t,s]=n._fields[o];if(i>=this._fields.length){s.decodeValue(e,s),o++;continue}const[a,c]=this._fields[i],u=nn(this._fields[i][0]),f=nn(t);if(u===f)r[a]=c.decodeValue(e,s),i++,o++;else if(f>u){if(!(c instanceof kn||c instanceof An))throw new Error("Cannot find required field "+a);r[a]=[],i++}else s.decodeValue(e,s),o++}for(const[e,t]of this._fields.slice(i)){if(!(t instanceof kn||t instanceof An))throw new Error("Cannot find required field "+e);r[e]=[]}return r}get name(){const e=this._fields.map((([e,t])=>e+":"+t.name));return`record {${e.join("; ")}}`}display(){const e=this._fields.map((([e,t])=>e+":"+t.display()));return`record {${e.join("; ")}}`}valueToString(e){const t=this._fields.map((([t])=>e[t])),n=gn(this._fields,t,(([e,t],n)=>e+"="+t.valueToString(n)));return`record {${n.join("; ")}}`}}class $n extends Ln{constructor(e){const t={};e.forEach(((e,n)=>t["_"+n+"_"]=e)),super(t),this._components=e}accept(e,t){return e.visitTuple(this,this._components,t)}covariant(e){if(Array.isArray(e)&&e.length>=this._fields.length&&this._components.every(((t,n)=>{try{return t.covariant(e[n])}catch(e){throw new Error(`Invalid ${this.display()} argument: \n\nindex ${n} -> ${e.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){const t=gn(this._components,e,((e,t)=>e.encodeValue(t)));return Jt(...t)}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof $n))throw new Error("not a tuple type");if(n._components.length<this._components.length)throw new Error("tuple mismatch");const r=[];for(const[t,i]of n._components.entries())t>=this._components.length?i.decodeValue(e,i):r.push(this._components[t].decodeValue(e,i));return r}display(){const e=this._components.map((e=>e.display()));return`record {${e.join("; ")}}`}valueToString(e){const t=gn(this._components,e,((e,t)=>e.valueToString(t)));return`record {${t.join("; ")}}`}}class Pn extends wn{constructor(e={}){super(),this._fields=Object.entries(e).sort(((e,t)=>nn(e[0])-nn(t[0])))}accept(e,t){return e.visitVariant(this,this._fields,t)}covariant(e){if("object"==typeof e&&1===Object.entries(e).length&&this._fields.every((([t,n])=>{try{return!e.hasOwnProperty(t)||n.covariant(e[t])}catch(e){throw new Error(`Invalid ${this.display()} argument: \n\nvariant ${t} -> ${e.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){for(let t=0;t<this._fields.length;t++){const[n,r]=this._fields[t];if(e.hasOwnProperty(n)){return Jt(an(t),r.encodeValue(e[n]))}}throw Error("Variant has no data: "+e)}_buildTypeTableImpl(e){this._fields.forEach((([,t])=>{t.buildTypeTable(e)}));const t=un(-21),n=an(this._fields.length),r=this._fields.map((([t,n])=>Jt(an(nn(t)),n.encodeType(e))));e.add(this,Jt(t,n,...r))}decodeValue(e,t){const n=this.checkType(t);if(!(n instanceof Pn))throw new Error("Not a variant type");const r=Number(cn(e));if(r>=n._fields.length)throw Error("Invalid variant index: "+r);const[i,o]=n._fields[r];for(const[t,n]of this._fields)if(nn(i)===nn(t)){return{[t]:n.decodeValue(e,o)}}throw new Error("Cannot find field hash "+i)}get name(){return`variant {${this._fields.map((([e,t])=>e+":"+t.name)).join("; ")}}`}display(){return`variant {${this._fields.map((([e,t])=>e+("null"===t.name?"":`:${t.display()}`))).join("; ")}}`}valueToString(e){for(const[t,n]of this._fields)if(e.hasOwnProperty(t)){const r=n.valueToString(e[t]);return"null"===r?`variant {${t}}`:`variant {${t}=${r}}`}throw new Error("Variant has no data: "+e)}}class Un extends wn{constructor(){super(...arguments),this._id=Un._counter++,this._type=void 0}accept(e,t){if(!this._type)throw Error("Recursive type uninitialized.");return e.visitRec(this,this._type,t)}fill(e){this._type=e}getType(){return this._type}covariant(e){if(this._type&&this._type.covariant(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(e)}_buildTypeTableImpl(e){if(!this._type)throw Error("Recursive type uninitialized.");e.add(this,new Uint8Array([])),this._type.buildTypeTable(e),e.merge(this,this._type.name)}decodeValue(e,t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(e,t)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`μ${this.name}.${this._type.name}`}valueToString(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(e)}}function Dn(e){if(1!==sn(e))throw new Error("Cannot decode principal");const t=Number(cn(e));return qt.fromUint8Array(new Uint8Array(on(e,t)))}Un._counter=0;class Fn extends bn{accept(e,t){return e.visitPrincipal(this,t)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){const t=e.toUint8Array(),n=an(t.byteLength);return Jt(new Uint8Array([1]),n,t)}encodeType(){return un(-24)}decodeValue(e,t){return this.checkType(t),Dn(e)}get name(){return"principal"}valueToString(e){return`${this.name} "${e.toText()}"`}}class Cn extends wn{constructor(e,t,n=[]){super(),this.argTypes=e,this.retTypes=t,this.annotations=n}static argsToString(e,t){if(e.length!==t.length)throw new Error("arity mismatch");return"("+e.map(((e,n)=>e.valueToString(t[n]))).join(", ")+")"}accept(e,t){return e.visitFunc(this,t)}covariant(e){if(Array.isArray(e)&&2===e.length&&e[0]&&e[0]._isPrincipal&&"string"==typeof e[1])return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue([e,t]){const n=e.toUint8Array(),r=an(n.byteLength),i=Jt(new Uint8Array([1]),r,n),o=(new TextEncoder).encode(t),s=an(o.byteLength);return Jt(new Uint8Array([1]),i,s,o)}_buildTypeTableImpl(e){this.argTypes.forEach((t=>t.buildTypeTable(e))),this.retTypes.forEach((t=>t.buildTypeTable(e)));const t=un(-22),n=an(this.argTypes.length),r=Jt(...this.argTypes.map((t=>t.encodeType(e)))),i=an(this.retTypes.length),o=Jt(...this.retTypes.map((t=>t.encodeType(e)))),s=an(this.annotations.length),a=Jt(...this.annotations.map((e=>this.encodeAnnotation(e))));e.add(this,Jt(t,n,r,i,o,s,a))}decodeValue(e){if(1!==sn(e))throw new Error("Cannot decode function reference");const t=Dn(e),n=on(e,Number(cn(e)));return[t,new TextDecoder("utf8",{fatal:!0}).decode(n)]}get name(){return`(${this.argTypes.map((e=>e.name)).join(", ")}) -> (${this.retTypes.map((e=>e.name)).join(", ")})${" "+this.annotations.join(" ")}`}valueToString([e,t]){return`func "${e.toText()}".${t}`}display(){return`(${this.argTypes.map((e=>e.display())).join(", ")}) → (${this.retTypes.map((e=>e.display())).join(", ")})${" "+this.annotations.join(" ")}`}encodeAnnotation(e){if("query"===e)return new Uint8Array([1]);if("oneway"===e)return new Uint8Array([2]);if("composite_query"===e)return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class Mn extends wn{constructor(e){super(),this._fields=Object.entries(e).sort(((e,t)=>e[0]<t[0]?-1:e[0]>t[0]?1:0))}accept(e,t){return e.visitService(this,t)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${jn(e)}`)}encodeValue(e){const t=e.toUint8Array(),n=an(t.length);return Jt(new Uint8Array([1]),n,t)}_buildTypeTableImpl(e){this._fields.forEach((([t,n])=>n.buildTypeTable(e)));const t=un(-23),n=an(this._fields.length),r=this._fields.map((([t,n])=>{const r=(new TextEncoder).encode(t);return Jt(an(r.length),r,n.encodeType(e))}));e.add(this,Jt(t,n,...r))}decodeValue(e){return Dn(e)}get name(){const e=this._fields.map((([e,t])=>e+":"+t.name));return`service {${e.join("; ")}}`}valueToString(e){return`service "${e.toText()}"`}}function jn(e){const t=JSON.stringify(e,((e,t)=>"bigint"==typeof t?`BigInt(${t})`:t));return t&&t.length>400?t.substring(0,397)+"...":t}function qn(e,t){if(t.length<e.length)throw Error("Wrong number of message arguments");const n=new mn;e.forEach((e=>e.buildTypeTable(n)));const r=(new TextEncoder).encode(pn),i=n.encode(),o=an(t.length),s=Jt(...e.map((e=>e.encodeType(n)))),a=Jt(...gn(e,t,((e,t)=>{try{e.covariant(t)}catch(e){throw new Error(e.message+"\n\n")}return e.encodeValue(t)})));return Jt(r,i,o,s,a)}function Vn(e,t){const n=new Qt(t);if(t.byteLength<pn.length)throw new Error("Message length smaller than magic number");const r=on(n,pn.length),i=(new TextDecoder).decode(r);if(i!==pn)throw new Error("Wrong magic number: "+JSON.stringify(i));const[o,s]=function(e){const t=[],n=Number(cn(e));for(let r=0;r<n;r++){const n=Number(fn(e));switch(n){case-18:case-19:{const r=Number(fn(e));t.push([n,r]);break}case-20:case-21:{const r=[];let i,o=Number(cn(e));for(;o--;){const t=Number(cn(e));if(t>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if("number"==typeof i&&i>=t)throw new Error("field id collision or not sorted");i=t;const n=Number(fn(e));r.push([t,n])}t.push([n,r]);break}case-22:{const r=[];let i=Number(cn(e));for(;i--;)r.push(Number(fn(e)));const o=[];let s=Number(cn(e));for(;s--;)o.push(Number(fn(e)));const a=[];let c=Number(cn(e));for(;c--;){switch(Number(cn(e))){case 1:a.push("query");break;case 2:a.push("oneway");break;case 3:a.push("composite_query");break;default:throw new Error("unknown annotation")}}t.push([n,[r,o,a]]);break}case-23:{let r=Number(cn(e));const i=[];for(;r--;){const t=Number(cn(e)),n=(new TextDecoder).decode(on(e,t)),r=fn(e);i.push([n,r])}t.push([n,i]);break}default:throw new Error("Illegal op_code: "+n)}}const r=[],i=Number(cn(e));for(let t=0;t<i;t++)r.push(Number(fn(e)));return[t,r]}(n);if(s.length<e.length)throw new Error("Wrong number of return values");const a=o.map((e=>pr()));function c(e){if(e<-24)throw new Error("future value not supported");if(e<0)switch(e){case-1:return Wn;case-2:return Kn;case-3:return Xn;case-4:return Yn;case-5:return ir;case-6:return or;case-7:return sr;case-8:return ar;case-9:return er;case-10:return tr;case-11:return nr;case-12:return rr;case-13:return Jn;case-14:return Qn;case-15:return Zn;case-16:return Hn;case-17:return zn;case-24:return cr;default:throw new Error("Illegal op_code: "+e)}if(e>=o.length)throw new Error("type index out of range");return a[e]}function u(e){switch(e[0]){case-19:return fr(c(e[1]));case-18:return lr(c(e[1]));case-20:{const t={};for(const[n,r]of e[1]){t[`_${n}_`]=c(r)}const n=dr(t),r=n.tryAsTuple();return Array.isArray(r)?ur(...r):n}case-21:{const t={};for(const[n,r]of e[1]){t[`_${n}_`]=c(r)}return hr(t)}case-22:{const[t,n,r]=e[1];return gr(t.map((e=>c(e))),n.map((e=>c(e))),r)}case-23:{const t={},n=e[1];for(const[e,r]of n){let n=c(r);if(n instanceof Un&&(n=n.getType()),!(n instanceof Cn))throw new Error("Illegal service definition: services can only contain functions");t[e]=n}return mr(t)}default:throw new Error("Illegal op_code: "+e[0])}}o.forEach(((e,t)=>{if(-22===e[0]){const n=u(e);a[t].fill(n)}})),o.forEach(((e,t)=>{if(-22!==e[0]){const n=u(e);a[t].fill(n)}}));const f=s.map((e=>c(e))),l=e.map(((e,t)=>e.decodeValue(n,f[t])));for(let t=e.length;t<f.length;t++)f[t].decodeValue(n,f[t]);if(n.byteLength>0)throw new Error("decode: Left-over bytes");return l}const zn=new vn,Hn=new An,Gn=new En,Kn=new xn,Wn=new _n,Zn=new Tn,Yn=new Sn,Xn=new Bn,Jn=new Nn(32),Qn=new Nn(64),er=new On(8),tr=new On(16),nr=new On(32),rr=new On(64),ir=new In(8),or=new In(16),sr=new In(32),ar=new In(64),cr=new Fn;function ur(...e){return new $n(e)}function fr(e){return new Rn(e)}function lr(e){return new kn(e)}function dr(e){return new Ln(e)}function hr(e){return new Pn(e)}function pr(){return new Un}function gr(e,t,n=[]){return new Cn(e,t,n)}function mr(e){return new Mn(e)}var yr=Object.freeze({__proto__:null,Bool:Kn,BoolClass:xn,ConstructType:wn,Empty:zn,EmptyClass:vn,FixedIntClass:On,FixedNatClass:In,Float32:Jn,Float64:Qn,FloatClass:Nn,Func:gr,FuncClass:Cn,Int:Yn,Int16:tr,Int32:nr,Int64:rr,Int8:er,IntClass:Sn,Nat:Xn,Nat16:or,Nat32:sr,Nat64:ar,Nat8:ir,NatClass:Bn,Null:Wn,NullClass:_n,Opt:lr,OptClass:kn,PrimitiveType:bn,Principal:cr,PrincipalClass:Fn,Rec:pr,RecClass:Un,Record:dr,RecordClass:Ln,Reserved:Hn,ReservedClass:An,Service:mr,ServiceClass:Mn,Text:Zn,TextClass:Tn,Tuple:ur,TupleClass:$n,Type:yn,Unknown:Gn,UnknownClass:En,Variant:hr,VariantClass:Pn,Vec:fr,VecClass:Rn,Visitor:class{visitType(e,t){throw new Error("Not implemented")}visitPrimitive(e,t){return this.visitType(e,t)}visitEmpty(e,t){return this.visitPrimitive(e,t)}visitBool(e,t){return this.visitPrimitive(e,t)}visitNull(e,t){return this.visitPrimitive(e,t)}visitReserved(e,t){return this.visitPrimitive(e,t)}visitText(e,t){return this.visitPrimitive(e,t)}visitNumber(e,t){return this.visitPrimitive(e,t)}visitInt(e,t){return this.visitNumber(e,t)}visitNat(e,t){return this.visitNumber(e,t)}visitFloat(e,t){return this.visitPrimitive(e,t)}visitFixedInt(e,t){return this.visitNumber(e,t)}visitFixedNat(e,t){return this.visitNumber(e,t)}visitPrincipal(e,t){return this.visitPrimitive(e,t)}visitConstruct(e,t){return this.visitType(e,t)}visitVec(e,t,n){return this.visitConstruct(e,n)}visitOpt(e,t,n){return this.visitConstruct(e,n)}visitRecord(e,t,n){return this.visitConstruct(e,n)}visitTuple(e,t,n){const r=t.map(((e,t)=>[`_${t}_`,e]));return this.visitRecord(e,r,n)}visitVariant(e,t,n){return this.visitConstruct(e,n)}visitRec(e,t,n){return this.visitConstruct(t,n)}visitFunc(e,t){return this.visitConstruct(e,t)}visitService(e,t){return this.visitConstruct(e,t)}},decode:Vn,encode:qn}),br={},wr={};!function(e){var t=Pe,n=ze,r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=s,e.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},e.INSPECT_MAX_BYTES=50;var i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return a(e,t,n)}function a(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|h(e,t),r=o(n),i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(C(e,Uint8Array)){var t=new Uint8Array(e);return l(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(C(e,ArrayBuffer)||e&&C(e.buffer,ArrayBuffer))return l(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(C(e,SharedArrayBuffer)||e&&C(e.buffer,SharedArrayBuffer)))return l(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return s.from(r,t,n);var i=function(e){if(s.isBuffer(e)){var t=0|d(e.length),n=o(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||M(e.length)?o(0):f(e);if("Buffer"===e.type&&Array.isArray(e.data))return f(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),o(e<0?0:0|d(e))}function f(e){for(var t=e.length<0?0:0|d(e.length),n=o(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function l(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,s.prototype),r}function d(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function h(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||C(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return D(e).length;default:if(i)return r?-1:U(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return A(this,t,n);case"ascii":return S(this,t,n);case"latin1":case"binary":return B(this,t,n);case"base64":return _(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),M(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=s.from(t,r)),s.isBuffer(t))return 0===t.length?-1:y(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):y(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,n,r,i){var o,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var f=-1;for(o=n;o<a;o++)if(u(e,o)===u(t,-1===f?0:o-f)){if(-1===f&&(f=o),o-f+1===c)return f*s}else-1!==f&&(o-=o-f),f=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){for(var l=!0,d=0;d<c;d++)if(u(e,o+d)!==u(t,d)){l=!1;break}if(l)return o}return-1}function b(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(M(a))return s;e[n+s]=a}return s}function w(e,t,n,r){return F(U(t,e.length-n),e,n,r)}function v(e,t,n,r){return F(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function E(e,t,n,r){return F(D(t),e,n,r)}function x(e,t,n,r){return F(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=(n=e.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function _(e,n,r){return 0===n&&r===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(n,r))}function A(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,c,u=e[i],f=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l<=n)switch(l){case 1:u<128&&(f=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(f=c);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(f=c)}null===f?(f=65533,l=1):f>65535&&(f-=65536,r.push(f>>>10&1023|55296),f=56320|1023&f),r.push(f),i+=l}return function(e){var t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=T));return n}(r)}e.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,n){return a(e,t,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,n){return function(e,t,n){return c(e),e<=0?o(e):void 0!==t?"string"==typeof n?o(e).fill(t,n):o(e).fill(t):o(e)}(e,t,n)},s.allocUnsafe=function(e){return u(e)},s.allocUnsafeSlow=function(e){return u(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(C(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),C(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=s.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(C(o,Uint8Array))i+o.length>r.length?s.from(o).copy(r,i):Uint8Array.prototype.set.call(r,o,i);else{if(!s.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i)}i+=o.length}return r},s.byteLength=h,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},s.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?A(this,0,e):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(e,t,n,r,i){if(C(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),c=Math.min(o,a),u=this.slice(r,i),f=e.slice(t,n),l=0;l<c;++l)if(u[l]!==f[l]){o=u[l],a=f[l];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},s.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},s.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},s.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":case"latin1":case"binary":return v(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function S(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function B(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function N(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=j[e[o]];return i}function O(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function I(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,n,r,i,o){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function k(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,r,i,o){return t=+t,r>>>=0,o||k(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function $(e,t,r,i,o){return t=+t,r>>>=0,o||k(e,0,r,8),n.write(e,t,r,i,52,8),r+8}s.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,s.prototype),r},s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},s.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||I(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},s.prototype.readInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||I(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(e,t){e>>>=0,t||I(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e>>>=0,t||I(e,4,this.length),n.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||I(e,4,this.length),n.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||I(e,8,this.length),n.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||I(e,8,this.length),n.read(this,e,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||R(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);R(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},s.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);R(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},s.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},s.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},s.prototype.writeDoubleLE=function(e,t,n){return $(this,e,t,!0,n)},s.prototype.writeDoubleBE=function(e,t,n){return $(this,e,t,!1,n)},s.prototype.copy=function(e,t,n,r){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},s.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=s.isBuffer(e)?e:s.from(e,r),c=a.length;if(0===c)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=a[o%c]}return this};var P=/[^+/0-9A-Za-z-_]/g;function U(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function D(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(P,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function F(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function C(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function M(e){return e!=e}var j=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)t[r+i]=e[n]+e[i];return t}()}(wr);var vr,Er={exports:{}};vr=Er,function(e){var t,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,i=Math.floor,o="[BigNumber Error] ",s=o+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],l=1e7,d=1e9;function h(e){var t=0|e;return e>0||e===t?t:t-1}function p(e){for(var t,n,r=1,i=e.length,o=e[0]+"";r<i;){for(t=e[r++]+"",n=c-t.length;n--;t="0"+t);o+=t}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function g(e,t){var n,r,i=e.c,o=t.c,s=e.s,a=t.s,c=e.e,u=t.e;if(!s||!a)return null;if(n=i&&!i[0],r=o&&!o[0],n||r)return n?r?0:-a:s;if(s!=a)return s;if(n=s<0,r=c==u,!i||!o)return r?0:!i^n?1:-1;if(!r)return c>u^n?1:-1;for(a=(c=i.length)<(u=o.length)?c:u,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^n?1:-1;return c==u?0:c>u^n?1:-1}function m(e,t,n,r){if(e<t||e>n||e!==i(e))throw Error(o+(r||"Argument")+("number"==typeof e?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function y(e){var t=e.c.length-1;return h(e.e/c)==t&&e.c[t]%2!=0}function b(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function w(e,t,n){var r,i;if(t<0){for(i=n+".";++t;i+=n);e=i+e}else if(++t>(r=e.length)){for(i=n,t-=r;--t;i+=n);e+=i}else t<r&&(e=e.slice(0,t)+"."+e.slice(t));return e}t=function e(t){var v,E,x,_,A,T,S,B,N,O,I=z.prototype={constructor:z,toString:null,valueOf:null},R=new z(1),k=20,L=4,$=-7,P=21,U=-1e7,D=1e7,F=!1,C=1,M=0,j={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},q="0123456789abcdefghijklmnopqrstuvwxyz",V=!0;function z(e,t){var r,o,a,f,l,d,h,p,g=this;if(!(g instanceof z))return new z(e,t);if(null==t){if(e&&!0===e._isBigNumber)return g.s=e.s,void(!e.c||e.e>D?g.c=g.e=null:e.e<U?g.c=[g.e=0]:(g.e=e.e,g.c=e.c.slice()));if((d="number"==typeof e)&&0*e==0){if(g.s=1/e<0?(e=-e,-1):1,e===~~e){for(f=0,l=e;l>=10;l/=10,f++);return void(f>D?g.c=g.e=null:(g.e=f,g.c=[e]))}p=String(e)}else{if(!n.test(p=String(e)))return x(g,p,d);g.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(f=p.indexOf("."))>-1&&(p=p.replace(".","")),(l=p.search(/e/i))>0?(f<0&&(f=l),f+=+p.slice(l+1),p=p.substring(0,l)):f<0&&(f=p.length)}else{if(m(t,2,q.length,"Base"),10==t&&V)return W(g=new z(e),k+g.e+1,L);if(p=String(e),d="number"==typeof e){if(0*e!=0)return x(g,p,d,t);if(g.s=1/e<0?(p=p.slice(1),-1):1,z.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(s+e)}else g.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=q.slice(0,t),f=l=0,h=p.length;l<h;l++)if(r.indexOf(o=p.charAt(l))<0){if("."==o){if(l>f){f=h;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,l=-1,f=0;continue}return x(g,String(e),d,t)}d=!1,(f=(p=E(p,t,10,g.s)).indexOf("."))>-1?p=p.replace(".",""):f=p.length}for(l=0;48===p.charCodeAt(l);l++);for(h=p.length;48===p.charCodeAt(--h););if(p=p.slice(l,++h)){if(h-=l,d&&z.DEBUG&&h>15&&(e>u||e!==i(e)))throw Error(s+g.s*e);if((f=f-l-1)>D)g.c=g.e=null;else if(f<U)g.c=[g.e=0];else{if(g.e=f,g.c=[],l=(f+1)%c,f<0&&(l+=c),l<h){for(l&&g.c.push(+p.slice(0,l)),h-=c;l<h;)g.c.push(+p.slice(l,l+=c));l=c-(p=p.slice(l)).length}else l-=h;for(;l--;p+="0");g.c.push(+p)}}else g.c=[g.e=0]}function H(e,t,n,r){var i,o,s,a,c;if(null==n?n=L:m(n,0,8),!e.c)return e.toString();if(i=e.c[0],s=e.e,null==t)c=p(e.c),c=1==r||2==r&&(s<=$||s>=P)?b(c,s):w(c,s,"0");else if(o=(e=W(new z(e),t,n)).e,a=(c=p(e.c)).length,1==r||2==r&&(t<=o||o<=$)){for(;a<t;c+="0",a++);c=b(c,o)}else if(t-=s,c=w(c,o,"0"),o+1>a){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=o-a)>0)for(o+1==a&&(c+=".");t--;c+="0");return e.s<0&&i?"-"+c:c}function G(e,t){for(var n,r=1,i=new z(e[0]);r<e.length;r++){if(!(n=new z(e[r])).s){i=n;break}t.call(i,n)&&(i=n)}return i}function K(e,t,n){for(var r=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,r++);return(n=r+n*c-1)>D?e.c=e.e=null:n<U?e.c=[e.e=0]:(e.e=n,e.c=t),e}function W(e,t,n,o){var s,u,l,d,h,p,g,m=e.c,y=f;if(m){e:{for(s=1,d=m[0];d>=10;d/=10,s++);if((u=t-s)<0)u+=c,l=t,g=(h=m[p=0])/y[s-l-1]%10|0;else if((p=r((u+1)/c))>=m.length){if(!o)break e;for(;m.length<=p;m.push(0));h=g=0,s=1,l=(u%=c)-c+1}else{for(h=d=m[p],s=1;d>=10;d/=10,s++);g=(l=(u%=c)-c+s)<0?0:h/y[s-l-1]%10|0}if(o=o||t<0||null!=m[p+1]||(l<0?h:h%y[s-l-1]),o=n<4?(g||o)&&(0==n||n==(e.s<0?3:2)):g>5||5==g&&(4==n||o||6==n&&(u>0?l>0?h/y[s-l]:0:m[p-1])%10&1||n==(e.s<0?8:7)),t<1||!m[0])return m.length=0,o?(t-=e.e+1,m[0]=y[(c-t%c)%c],e.e=-t||0):m[0]=e.e=0,e;if(0==u?(m.length=p,d=1,p--):(m.length=p+1,d=y[c-u],m[p]=l>0?i(h/y[s-l]%y[l])*d:0),o)for(;;){if(0==p){for(u=1,l=m[0];l>=10;l/=10,u++);for(l=m[0]+=d,d=1;l>=10;l/=10,d++);u!=d&&(e.e++,m[0]==a&&(m[0]=1));break}if(m[p]+=d,m[p]!=a)break;m[p--]=0,d=1}for(u=m.length;0===m[--u];m.pop());}e.e>D?e.c=e.e=null:e.e<U&&(e.c=[e.e=0])}return e}function Z(e){var t,n=e.e;return null===n?e.toString():(t=p(e.c),t=n<=$||n>=P?b(t,n):w(t,n,"0"),e.s<0?"-"+t:t)}return z.clone=e,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(e){var t,n;if(null!=e){if("object"!=typeof e)throw Error(o+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(m(n=e[t],0,d,t),k=n),e.hasOwnProperty(t="ROUNDING_MODE")&&(m(n=e[t],0,8,t),L=n),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((n=e[t])&&n.pop?(m(n[0],-d,0,t),m(n[1],0,d,t),$=n[0],P=n[1]):(m(n,-d,d,t),$=-(P=n<0?-n:n))),e.hasOwnProperty(t="RANGE"))if((n=e[t])&&n.pop)m(n[0],-d,-1,t),m(n[1],1,d,t),U=n[0],D=n[1];else{if(m(n,-d,d,t),!n)throw Error(o+t+" cannot be zero: "+n);U=-(D=n<0?-n:n)}if(e.hasOwnProperty(t="CRYPTO")){if((n=e[t])!==!!n)throw Error(o+t+" not true or false: "+n);if(n){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw F=!n,Error(o+"crypto unavailable");F=n}else F=n}if(e.hasOwnProperty(t="MODULO_MODE")&&(m(n=e[t],0,9,t),C=n),e.hasOwnProperty(t="POW_PRECISION")&&(m(n=e[t],0,d,t),M=n),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(n=e[t]))throw Error(o+t+" not an object: "+n);j=n}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(n=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(n))throw Error(o+t+" invalid: "+n);V="0123456789"==n.slice(0,10),q=n}}return{DECIMAL_PLACES:k,ROUNDING_MODE:L,EXPONENTIAL_AT:[$,P],RANGE:[U,D],CRYPTO:F,MODULO_MODE:C,POW_PRECISION:M,FORMAT:j,ALPHABET:q}},z.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!z.DEBUG)return!0;var t,n,r=e.c,s=e.e,u=e.s;e:if("[object Array]"=={}.toString.call(r)){if((1===u||-1===u)&&s>=-d&&s<=d&&s===i(s)){if(0===r[0]){if(0===s&&1===r.length)return!0;break e}if((t=(s+1)%c)<1&&(t+=c),String(r[0]).length==t){for(t=0;t<r.length;t++)if((n=r[t])<0||n>=a||n!==i(n))break e;if(0!==n)return!0}}}else if(null===r&&null===s&&(null===u||1===u||-1===u))return!0;throw Error(o+"Invalid BigNumber: "+e)},z.maximum=z.max=function(){return G(arguments,I.lt)},z.minimum=z.min=function(){return G(arguments,I.gt)},z.random=(_=9007199254740992,A=Math.random()*_&2097151?function(){return i(Math.random()*_)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,n,s,a,u,l=0,h=[],p=new z(R);if(null==e?e=k:m(e,0,d),a=r(e/c),F)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(a*=2));l<a;)(u=131072*t[l]+(t[l+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),t[l]=n[0],t[l+1]=n[1]):(h.push(u%1e14),l+=2);l=a/2}else{if(!crypto.randomBytes)throw F=!1,Error(o+"crypto unavailable");for(t=crypto.randomBytes(a*=7);l<a;)(u=281474976710656*(31&t[l])+1099511627776*t[l+1]+4294967296*t[l+2]+16777216*t[l+3]+(t[l+4]<<16)+(t[l+5]<<8)+t[l+6])>=9e15?crypto.randomBytes(7).copy(t,l):(h.push(u%1e14),l+=7);l=a/7}if(!F)for(;l<a;)(u=A())<9e15&&(h[l++]=u%1e14);for(a=h[--l],e%=c,a&&e&&(u=f[c-e],h[l]=i(a/u)*u);0===h[l];h.pop(),l--);if(l<0)h=[s=0];else{for(s=-1;0===h[0];h.splice(0,1),s-=c);for(l=1,u=h[0];u>=10;u/=10,l++);l<c&&(s-=c-l)}return p.e=s,p.c=h,p}),z.sum=function(){for(var e=1,t=arguments,n=new z(t[0]);e<t.length;)n=n.plus(t[e++]);return n},E=function(){var e="0123456789";function t(e,t,n,r){for(var i,o,s=[0],a=0,c=e.length;a<c;){for(o=s.length;o--;s[o]*=t);for(s[0]+=r.indexOf(e.charAt(a++)),i=0;i<s.length;i++)s[i]>n-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/n|0,s[i]%=n)}return s.reverse()}return function(n,r,i,o,s){var a,c,u,f,l,d,h,g,m=n.indexOf("."),y=k,b=L;for(m>=0&&(f=M,M=0,n=n.replace(".",""),d=(g=new z(r)).pow(n.length-m),M=f,g.c=t(w(p(d.c),d.e,"0"),10,i,e),g.e=g.c.length),u=f=(h=t(n,r,i,s?(a=q,e):(a=e,q))).length;0==h[--f];h.pop());if(!h[0])return a.charAt(0);if(m<0?--u:(d.c=h,d.e=u,d.s=o,h=(d=v(d,g,y,b,i)).c,l=d.r,u=d.e),m=h[c=u+y+1],f=i/2,l=l||c<0||null!=h[c+1],l=b<4?(null!=m||l)&&(0==b||b==(d.s<0?3:2)):m>f||m==f&&(4==b||l||6==b&&1&h[c-1]||b==(d.s<0?8:7)),c<1||!h[0])n=l?w(a.charAt(1),-y,a.charAt(0)):a.charAt(0);else{if(h.length=c,l)for(--i;++h[--c]>i;)h[c]=0,c||(++u,h=[1].concat(h));for(f=h.length;!h[--f];);for(m=0,n="";m<=f;n+=a.charAt(h[m++]));n=w(n,u,a.charAt(0))}return n}}(),v=function(){function e(e,t,n){var r,i,o,s,a=0,c=e.length,u=t%l,f=t/l|0;for(e=e.slice();c--;)a=((i=u*(o=e[c]%l)+(r=f*o+(s=e[c]/l|0)*u)%l*l+a)/n|0)+(r/l|0)+f*s,e[c]=i%n;return a&&(e=[a].concat(e)),e}function t(e,t,n,r){var i,o;if(n!=r)o=n>r?1:-1;else for(i=o=0;i<n;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function n(e,t,n,r){for(var i=0;n--;)e[n]-=i,i=e[n]<t[n]?1:0,e[n]=i*r+e[n]-t[n];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(r,o,s,u,f){var l,d,p,g,m,y,b,w,v,E,x,_,A,T,S,B,N,O=r.s==o.s?1:-1,I=r.c,R=o.c;if(!(I&&I[0]&&R&&R[0]))return new z(r.s&&o.s&&(I?!R||I[0]!=R[0]:R)?I&&0==I[0]||!R?0*O:O/0:NaN);for(v=(w=new z(O)).c=[],O=s+(d=r.e-o.e)+1,f||(f=a,d=h(r.e/c)-h(o.e/c),O=O/c|0),p=0;R[p]==(I[p]||0);p++);if(R[p]>(I[p]||0)&&d--,O<0)v.push(1),g=!0;else{for(T=I.length,B=R.length,p=0,O+=2,(m=i(f/(R[0]+1)))>1&&(R=e(R,m,f),I=e(I,m,f),B=R.length,T=I.length),A=B,x=(E=I.slice(0,B)).length;x<B;E[x++]=0);N=R.slice(),N=[0].concat(N),S=R[0],R[1]>=f/2&&S++;do{if(m=0,(l=t(R,E,B,x))<0){if(_=E[0],B!=x&&(_=_*f+(E[1]||0)),(m=i(_/S))>1)for(m>=f&&(m=f-1),b=(y=e(R,m,f)).length,x=E.length;1==t(y,E,b,x);)m--,n(y,B<b?N:R,b,f),b=y.length,l=1;else 0==m&&(l=m=1),b=(y=R.slice()).length;if(b<x&&(y=[0].concat(y)),n(E,y,x,f),x=E.length,-1==l)for(;t(R,E,B,x)<1;)m++,n(E,B<x?N:R,x,f),x=E.length}else 0===l&&(m++,E=[0]);v[p++]=m,E[0]?E[x++]=I[A]||0:(E=[I[A]],x=1)}while((A++<T||null!=E[0])&&O--);g=null!=E[0],v[0]||v.splice(0,1)}if(f==a){for(p=1,O=v[0];O>=10;O/=10,p++);W(w,s+(w.e=p+d*c-1)+1,u,g)}else w.e=d,w.r=+g;return w}}(),T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,S=/^([^.]+)\.$/,B=/^\.([^.]+)$/,N=/^-?(Infinity|NaN)$/,O=/^\s*\+(?=[\w.])|^\s+|\s+$/g,x=function(e,t,n,r){var i,s=n?t:t.replace(O,"");if(N.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!n&&(s=s.replace(T,(function(e,t,n){return i="x"==(n=n.toLowerCase())?16:"b"==n?2:8,r&&r!=i?e:t})),r&&(i=r,s=s.replace(S,"$1").replace(B,"0.$1")),t!=s))return new z(s,i);if(z.DEBUG)throw Error(o+"Not a"+(r?" base "+r:"")+" number: "+t);e.s=null}e.c=e.e=null},I.absoluteValue=I.abs=function(){var e=new z(this);return e.s<0&&(e.s=1),e},I.comparedTo=function(e,t){return g(this,new z(e,t))},I.decimalPlaces=I.dp=function(e,t){var n,r,i,o=this;if(null!=e)return m(e,0,d),null==t?t=L:m(t,0,8),W(new z(o),e+o.e+1,t);if(!(n=o.c))return null;if(r=((i=n.length-1)-h(this.e/c))*c,i=n[i])for(;i%10==0;i/=10,r--);return r<0&&(r=0),r},I.dividedBy=I.div=function(e,t){return v(this,new z(e,t),k,L)},I.dividedToIntegerBy=I.idiv=function(e,t){return v(this,new z(e,t),0,1)},I.exponentiatedBy=I.pow=function(e,t){var n,s,a,u,f,l,d,h,p=this;if((e=new z(e)).c&&!e.isInteger())throw Error(o+"Exponent not an integer: "+Z(e));if(null!=t&&(t=new z(t)),f=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return h=new z(Math.pow(+Z(p),f?2-y(e):+Z(e))),t?h.mod(t):h;if(l=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new z(NaN);(s=!l&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||f&&p.c[1]>=24e7:p.c[0]<8e13||f&&p.c[0]<=9999975e7)))return u=p.s<0&&y(e)?-0:0,p.e>-1&&(u=1/u),new z(l?1/u:u);M&&(u=r(M/c+2))}for(f?(n=new z(.5),l&&(e.s=1),d=y(e)):d=(a=Math.abs(+Z(e)))%2,h=new z(R);;){if(d){if(!(h=h.times(p)).c)break;u?h.c.length>u&&(h.c.length=u):s&&(h=h.mod(t))}if(a){if(0===(a=i(a/2)))break;d=a%2}else if(W(e=e.times(n),e.e+1,1),e.e>14)d=y(e);else{if(0==(a=+Z(e)))break;d=a%2}p=p.times(p),u?p.c&&p.c.length>u&&(p.c.length=u):s&&(p=p.mod(t))}return s?h:(l&&(h=R.div(h)),t?h.mod(t):u?W(h,M,L,void 0):h)},I.integerValue=function(e){var t=new z(this);return null==e?e=L:m(e,0,8),W(t,t.e+1,e)},I.isEqualTo=I.eq=function(e,t){return 0===g(this,new z(e,t))},I.isFinite=function(){return!!this.c},I.isGreaterThan=I.gt=function(e,t){return g(this,new z(e,t))>0},I.isGreaterThanOrEqualTo=I.gte=function(e,t){return 1===(t=g(this,new z(e,t)))||0===t},I.isInteger=function(){return!!this.c&&h(this.e/c)>this.c.length-2},I.isLessThan=I.lt=function(e,t){return g(this,new z(e,t))<0},I.isLessThanOrEqualTo=I.lte=function(e,t){return-1===(t=g(this,new z(e,t)))||0===t},I.isNaN=function(){return!this.s},I.isNegative=function(){return this.s<0},I.isPositive=function(){return this.s>0},I.isZero=function(){return!!this.c&&0==this.c[0]},I.minus=function(e,t){var n,r,i,o,s=this,u=s.s;if(t=(e=new z(e,t)).s,!u||!t)return new z(NaN);if(u!=t)return e.s=-t,s.plus(e);var f=s.e/c,l=e.e/c,d=s.c,p=e.c;if(!f||!l){if(!d||!p)return d?(e.s=-t,e):new z(p?s:NaN);if(!d[0]||!p[0])return p[0]?(e.s=-t,e):new z(d[0]?s:3==L?-0:0)}if(f=h(f),l=h(l),d=d.slice(),u=f-l){for((o=u<0)?(u=-u,i=d):(l=f,i=p),i.reverse(),t=u;t--;i.push(0));i.reverse()}else for(r=(o=(u=d.length)<(t=p.length))?u:t,u=t=0;t<r;t++)if(d[t]!=p[t]){o=d[t]<p[t];break}if(o&&(i=d,d=p,p=i,e.s=-e.s),(t=(r=p.length)-(n=d.length))>0)for(;t--;d[n++]=0);for(t=a-1;r>u;){if(d[--r]<p[r]){for(n=r;n&&!d[--n];d[n]=t);--d[n],d[r]+=a}d[r]-=p[r]}for(;0==d[0];d.splice(0,1),--l);return d[0]?K(e,d,l):(e.s=3==L?-1:1,e.c=[e.e=0],e)},I.modulo=I.mod=function(e,t){var n,r,i=this;return e=new z(e,t),!i.c||!e.s||e.c&&!e.c[0]?new z(NaN):!e.c||i.c&&!i.c[0]?new z(i):(9==C?(r=e.s,e.s=1,n=v(i,e,0,3),e.s=r,n.s*=r):n=v(i,e,0,C),(e=i.minus(n.times(e))).c[0]||1!=C||(e.s=i.s),e)},I.multipliedBy=I.times=function(e,t){var n,r,i,o,s,u,f,d,p,g,m,y,b,w,v,E=this,x=E.c,_=(e=new z(e,t)).c;if(!(x&&_&&x[0]&&_[0]))return!E.s||!e.s||x&&!x[0]&&!_||_&&!_[0]&&!x?e.c=e.e=e.s=null:(e.s*=E.s,x&&_?(e.c=[0],e.e=0):e.c=e.e=null),e;for(r=h(E.e/c)+h(e.e/c),e.s*=E.s,(f=x.length)<(g=_.length)&&(b=x,x=_,_=b,i=f,f=g,g=i),i=f+g,b=[];i--;b.push(0));for(w=a,v=l,i=g;--i>=0;){for(n=0,m=_[i]%v,y=_[i]/v|0,o=i+(s=f);o>i;)n=((d=m*(d=x[--s]%v)+(u=y*d+(p=x[s]/v|0)*m)%v*v+b[o]+n)/w|0)+(u/v|0)+y*p,b[o--]=d%w;b[o]=n}return n?++r:b.splice(0,1),K(e,b,r)},I.negated=function(){var e=new z(this);return e.s=-e.s||null,e},I.plus=function(e,t){var n,r=this,i=r.s;if(t=(e=new z(e,t)).s,!i||!t)return new z(NaN);if(i!=t)return e.s=-t,r.minus(e);var o=r.e/c,s=e.e/c,u=r.c,f=e.c;if(!o||!s){if(!u||!f)return new z(i/0);if(!u[0]||!f[0])return f[0]?e:new z(u[0]?r:0*i)}if(o=h(o),s=h(s),u=u.slice(),i=o-s){for(i>0?(s=o,n=f):(i=-i,n=u),n.reverse();i--;n.push(0));n.reverse()}for((i=u.length)-(t=f.length)<0&&(n=f,f=u,u=n,t=i),i=0;t;)i=(u[--t]=u[t]+f[t]+i)/a|0,u[t]=a===u[t]?0:u[t]%a;return i&&(u=[i].concat(u),++s),K(e,u,s)},I.precision=I.sd=function(e,t){var n,r,i,o=this;if(null!=e&&e!==!!e)return m(e,1,d),null==t?t=L:m(t,0,8),W(new z(o),e,t);if(!(n=o.c))return null;if(r=(i=n.length-1)*c+1,i=n[i]){for(;i%10==0;i/=10,r--);for(i=n[0];i>=10;i/=10,r++);}return e&&o.e+1>r&&(r=o.e+1),r},I.shiftedBy=function(e){return m(e,-9007199254740991,u),this.times("1e"+e)},I.squareRoot=I.sqrt=function(){var e,t,n,r,i,o=this,s=o.c,a=o.s,c=o.e,u=k+4,f=new z("0.5");if(1!==a||!s||!s[0])return new z(!a||a<0&&(!s||s[0])?NaN:s?o:1/0);if(0==(a=Math.sqrt(+Z(o)))||a==1/0?(((t=p(s)).length+c)%2==0&&(t+="0"),a=Math.sqrt(+t),c=h((c+1)/2)-(c<0||c%2),n=new z(t=a==1/0?"5e"+c:(t=a.toExponential()).slice(0,t.indexOf("e")+1)+c)):n=new z(a+""),n.c[0])for((a=(c=n.e)+u)<3&&(a=0);;)if(i=n,n=f.times(i.plus(v(o,i,u,1))),p(i.c).slice(0,a)===(t=p(n.c)).slice(0,a)){if(n.e<c&&--a,"9999"!=(t=t.slice(a-3,a+1))&&(r||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(W(n,n.e+k+2,1),e=!n.times(n).eq(o));break}if(!r&&(W(i,i.e+k+2,0),i.times(i).eq(o))){n=i;break}u+=4,a+=4,r=1}return W(n,n.e+k+1,L,e)},I.toExponential=function(e,t){return null!=e&&(m(e,0,d),e++),H(this,e,t,1)},I.toFixed=function(e,t){return null!=e&&(m(e,0,d),e=e+this.e+1),H(this,e,t)},I.toFormat=function(e,t,n){var r,i=this;if(null==n)null!=e&&t&&"object"==typeof t?(n=t,t=null):e&&"object"==typeof e?(n=e,e=t=null):n=j;else if("object"!=typeof n)throw Error(o+"Argument not an object: "+n);if(r=i.toFixed(e,t),i.c){var s,a=r.split("."),c=+n.groupSize,u=+n.secondaryGroupSize,f=n.groupSeparator||"",l=a[0],d=a[1],h=i.s<0,p=h?l.slice(1):l,g=p.length;if(u&&(s=c,c=u,u=s,g-=s),c>0&&g>0){for(s=g%c||c,l=p.substr(0,s);s<g;s+=c)l+=f+p.substr(s,c);u>0&&(l+=f+p.slice(s)),h&&(l="-"+l)}r=d?l+(n.decimalSeparator||"")+((u=+n.fractionGroupSize)?d.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(n.fractionGroupSeparator||"")):d):l}return(n.prefix||"")+r+(n.suffix||"")},I.toFraction=function(e){var t,n,r,i,s,a,u,l,d,h,g,m,y=this,b=y.c;if(null!=e&&(!(u=new z(e)).isInteger()&&(u.c||1!==u.s)||u.lt(R)))throw Error(o+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+Z(u));if(!b)return new z(y);for(t=new z(R),d=n=new z(R),r=l=new z(R),m=p(b),s=t.e=m.length-y.e-1,t.c[0]=f[(a=s%c)<0?c+a:a],e=!e||u.comparedTo(t)>0?s>0?t:d:u,a=D,D=1/0,u=new z(m),l.c[0]=0;h=v(u,t,0,1),1!=(i=n.plus(h.times(r))).comparedTo(e);)n=r,r=i,d=l.plus(h.times(i=d)),l=i,t=u.minus(h.times(i=t)),u=i;return i=v(e.minus(n),r,0,1),l=l.plus(i.times(d)),n=n.plus(i.times(r)),l.s=d.s=y.s,g=v(d,r,s*=2,L).minus(y).abs().comparedTo(v(l,n,s,L).minus(y).abs())<1?[d,r]:[l,n],D=a,g},I.toNumber=function(){return+Z(this)},I.toPrecision=function(e,t){return null!=e&&m(e,1,d),H(this,e,t,2)},I.toString=function(e){var t,n=this,r=n.s,i=n.e;return null===i?r?(t="Infinity",r<0&&(t="-"+t)):t="NaN":(null==e?t=i<=$||i>=P?b(p(n.c),i):w(p(n.c),i,"0"):10===e&&V?t=w(p((n=W(new z(n),k+i+1,L)).c),n.e,"0"):(m(e,2,q.length,"Base"),t=E(w(p(n.c),i,"0"),10,e,r,!0)),r<0&&n.c[0]&&(t="-"+t)),t},I.valueOf=I.toJSON=function(){return Z(this)},I._isBigNumber=!0,null!=t&&z.set(t),z}(),t.default=t.BigNumber=t,vr.exports?vr.exports=t:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=t)}(ke);var xr=Er.exports,_r={},Ar={};const Tr=xr.BigNumber;Ar.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},Ar.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36},Ar.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},Ar.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},Ar.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")},Ar.SHIFT32=Math.pow(2,32),Ar.SHIFT16=Math.pow(2,16),Ar.MAX_SAFE_HIGH=2097151,Ar.NEG_ONE=new Tr(-1),Ar.TEN=new Tr(10),Ar.TWO=new Tr(2),Ar.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5},function(e){const{Buffer:t}=wr,n=xr.BigNumber,r=Ar,i=r.SHIFT32,o=r.SHIFT16;e.parseHalf=function(e){var t,n,r;return r=128&e[0]?-1:1,t=(124&e[0])>>2,n=(3&e[0])<<8|e[1],t?31===t?r*(n?NaN:Infinity):r*Math.pow(2,t-25)*(1024+n):5.960464477539063e-8*r*n},e.arrayBufferToBignumber=function(e){const t=e.byteLength;let r="";for(let n=0;n<t;n++)r+=(i=e[n])<16?"0"+i.toString(16):i.toString(16);var i;return new n(r,16)},e.buildMap=e=>{const t=new Map,n=Object.keys(e),r=n.length;for(let i=0;i<r;i++)t.set(n[i],e[n[i]]);return t},e.buildInt32=(e,t)=>e*o+t,e.buildInt64=(t,r,o,s)=>{const a=e.buildInt32(t,r),c=e.buildInt32(o,s);return a>2097151?new n(a).times(i).plus(c):a*i+c},e.writeHalf=function(e,n){const r=t.allocUnsafe(4);r.writeFloatBE(n,0);const i=r.readUInt32BE(0);if(0!=(8191&i))return!1;var o=i>>16&32768;const s=i>>23&255,a=8388607&i;if(s>=113&&s<=142)o+=(s-112<<10)+(a>>13);else{if(!(s>=103&&s<113))return!1;if(a&(1<<126-s)-1)return!1;o+=a+8388608>>126-s}return e.writeUInt16BE(o,0),!0},e.keySorter=function(e,t){var n=e[0].byteLength,r=t[0].byteLength;return n>r?1:r>n?-1:e[0].compare(t[0])},e.isNegativeZero=e=>0===e&&1/e<0,e.nextPowerOf2=e=>{let t=0;if(e&&!(e&e-1))return e;for(;0!==e;)e>>=1,t+=1;return 1<<t}}(_r);const Sr=Ar,Br=Sr.MT,Nr=Sr.SIMPLE,Or=Sr.SYMS;var Ir=class e{constructor(e){if("number"!=typeof e)throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(0|e)!==e)throw new Error("value must be a small positive integer: "+e);this.value=e}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(e){return e._pushInt(this.value,Br.SIMPLE_FLOAT)}static isSimple(t){return t instanceof e}static decode(t,n){switch(null==n&&(n=!0),t){case Nr.FALSE:return!1;case Nr.TRUE:return!0;case Nr.NULL:return n?null:Or.NULL;case Nr.UNDEFINED:return n?void 0:Or.UNDEFINED;case-1:if(!n)throw new Error("Invalid BREAK");return Or.BREAK;default:return new e(t)}}};var Rr=class e{constructor(e,t,n){if(this.tag=e,this.value=t,this.err=n,"number"!=typeof this.tag)throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(0|this.tag)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(t){var n,r;if("function"!=typeof(r=null!=t?t[this.tag]:void 0)&&"function"!=typeof(r=e["_tag"+this.tag]))return this;try{return r.call(e,this.value)}catch(e){return n=e,this.err=n,this}}};const kr=self.location?self.location.protocol+"//"+self.location.host:"",Lr=self.URL;var $r={URLWithLegacySupport:class{constructor(e="",t=kr){this.super=new Lr(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set origin(e){this.super.origin=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set searchParams(e){this.super.searchParams=e}set username(e){this.super.username=e}createObjectURL(e){return this.super.createObjectURL(e)}revokeObjectURL(e){this.super.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:kr,format:function(e){if("string"==typeof e){return new Lr(e).toString()}if(!(e instanceof Lr)){const t=e.username&&e.password?`${e.username}:${e.password}@`:"",n=e.auth?e.auth+"@":"",r=e.port?":"+e.port:"",i=e.protocol?e.protocol+"//":"",o=e.host||"",s=e.hostname||"",a=e.search||(e.query?"?"+e.query:""),c=e.hash||"",u=e.pathname||"";return`${i}${t||n}${o||s+r}${e.path||u+a}${c}`}}};const{URLWithLegacySupport:Pr,format:Ur}=$r;const{URLWithLegacySupport:Dr,format:Fr,URLSearchParams:Cr,defaultBase:Mr}=$r;var jr={URL:Dr,URLSearchParams:Cr,format:Fr,relative:(e,t={},n={},r)=>{let i,o=t.protocol?t.protocol.replace(":",""):"http";o=(n[o]||r||o)+":";try{i=new Pr(e)}catch(e){i={}}const s=Object.assign({},t,{protocol:o||i.protocol,host:t.host||i.host});return new Pr(e,Ur(s)).toString()},defaultBase:Mr};const{Buffer:qr}=wr,Vr=ze,zr=xr.BigNumber,Hr=function(e,t,n){"use asm";var r=new e.Uint8Array(n),i=t.pushInt,o=t.pushInt32,s=t.pushInt32Neg,a=t.pushInt64,c=t.pushInt64Neg,u=t.pushFloat,f=t.pushFloatSingle,l=t.pushFloatDouble,d=t.pushTrue,h=t.pushFalse,p=t.pushUndefined,g=t.pushNull,m=t.pushInfinity,y=t.pushInfinityNeg,b=t.pushNaN,w=t.pushNaNNeg,v=t.pushArrayStart,E=t.pushArrayStartFixed,x=t.pushArrayStartFixed32,_=t.pushArrayStartFixed64,A=t.pushObjectStart,T=t.pushObjectStartFixed,S=t.pushObjectStartFixed32,B=t.pushObjectStartFixed64,N=t.pushByteString,O=t.pushByteStringStart,I=t.pushUtf8String,R=t.pushUtf8StringStart,k=t.pushSimpleUnassigned,L=t.pushTagStart,$=t.pushTagStart4,P=t.pushTagStart8,U=t.pushTagUnassigned,D=t.pushBreak,F=e.Math.pow,C=0,M=0,j=0;function q(e){e=e|0;C=0;M=e;while((C|0)<(M|0)){j=Ye[r[C]&255](r[C]|0)|0;if((j|0)>0){break}}return j|0}function V(e){e=e|0;if(((C|0)+(e|0)|0)<(M|0)){return 0}return 1}function z(e){e=e|0;return r[e|0]<<8|r[e+1|0]|0}function H(e){e=e|0;return r[e|0]<<24|r[e+1|0]<<16|r[e+2|0]<<8|r[e+3|0]|0}function G(e){e=e|0;i(e|0);C=C+1|0;return 0}function K(e){e=e|0;if(V(1)|0){return 1}i(r[C+1|0]|0);C=C+2|0;return 0}function W(e){e=e|0;if(V(2)|0){return 1}i(z(C+1|0)|0);C=C+3|0;return 0}function Z(e){e=e|0;if(V(4)|0){return 1}o(z(C+1|0)|0,z(C+3|0)|0);C=C+5|0;return 0}function Y(e){e=e|0;if(V(8)|0){return 1}a(z(C+1|0)|0,z(C+3|0)|0,z(C+5|0)|0,z(C+7|0)|0);C=C+9|0;return 0}function X(e){e=e|0;i(-1-(e-32|0)|0);C=C+1|0;return 0}function J(e){e=e|0;if(V(1)|0){return 1}i(-1-(r[C+1|0]|0)|0);C=C+2|0;return 0}function Q(e){e=e|0;var t=0;if(V(2)|0){return 1}t=z(C+1|0)|0;i(-1-(t|0)|0);C=C+3|0;return 0}function ee(e){e=e|0;if(V(4)|0){return 1}s(z(C+1|0)|0,z(C+3|0)|0);C=C+5|0;return 0}function te(e){e=e|0;if(V(8)|0){return 1}c(z(C+1|0)|0,z(C+3|0)|0,z(C+5|0)|0,z(C+7|0)|0);C=C+9|0;return 0}function ne(e){e=e|0;var t=0;var n=0;var r=0;r=e-64|0;if(V(r|0)|0){return 1}t=C+1|0;n=(C+1|0)+(r|0)|0;N(t|0,n|0);C=n|0;return 0}function re(e){e=e|0;var t=0;var n=0;var i=0;if(V(1)|0){return 1}i=r[C+1|0]|0;t=C+2|0;n=(C+2|0)+(i|0)|0;if(V(i+1|0)|0){return 1}N(t|0,n|0);C=n|0;return 0}function ie(e){e=e|0;var t=0;var n=0;var r=0;if(V(2)|0){return 1}r=z(C+1|0)|0;t=C+3|0;n=(C+3|0)+(r|0)|0;if(V(r+2|0)|0){return 1}N(t|0,n|0);C=n|0;return 0}function oe(e){e=e|0;var t=0;var n=0;var r=0;if(V(4)|0){return 1}r=H(C+1|0)|0;t=C+5|0;n=(C+5|0)+(r|0)|0;if(V(r+4|0)|0){return 1}N(t|0,n|0);C=n|0;return 0}function se(e){e=e|0;return 1}function ae(e){e=e|0;O();C=C+1|0;return 0}function ce(e){e=e|0;var t=0;var n=0;var r=0;r=e-96|0;if(V(r|0)|0){return 1}t=C+1|0;n=(C+1|0)+(r|0)|0;I(t|0,n|0);C=n|0;return 0}function ue(e){e=e|0;var t=0;var n=0;var i=0;if(V(1)|0){return 1}i=r[C+1|0]|0;t=C+2|0;n=(C+2|0)+(i|0)|0;if(V(i+1|0)|0){return 1}I(t|0,n|0);C=n|0;return 0}function fe(e){e=e|0;var t=0;var n=0;var r=0;if(V(2)|0){return 1}r=z(C+1|0)|0;t=C+3|0;n=(C+3|0)+(r|0)|0;if(V(r+2|0)|0){return 1}I(t|0,n|0);C=n|0;return 0}function le(e){e=e|0;var t=0;var n=0;var r=0;if(V(4)|0){return 1}r=H(C+1|0)|0;t=C+5|0;n=(C+5|0)+(r|0)|0;if(V(r+4|0)|0){return 1}I(t|0,n|0);C=n|0;return 0}function de(e){e=e|0;return 1}function he(e){e=e|0;R();C=C+1|0;return 0}function pe(e){e=e|0;E(e-128|0);C=C+1|0;return 0}function ge(e){e=e|0;if(V(1)|0){return 1}E(r[C+1|0]|0);C=C+2|0;return 0}function me(e){e=e|0;if(V(2)|0){return 1}E(z(C+1|0)|0);C=C+3|0;return 0}function ye(e){e=e|0;if(V(4)|0){return 1}x(z(C+1|0)|0,z(C+3|0)|0);C=C+5|0;return 0}function be(e){e=e|0;if(V(8)|0){return 1}_(z(C+1|0)|0,z(C+3|0)|0,z(C+5|0)|0,z(C+7|0)|0);C=C+9|0;return 0}function we(e){e=e|0;v();C=C+1|0;return 0}function ve(e){e=e|0;var t=0;t=e-160|0;if(V(t|0)|0){return 1}T(t|0);C=C+1|0;return 0}function Ee(e){e=e|0;if(V(1)|0){return 1}T(r[C+1|0]|0);C=C+2|0;return 0}function xe(e){e=e|0;if(V(2)|0){return 1}T(z(C+1|0)|0);C=C+3|0;return 0}function _e(e){e=e|0;if(V(4)|0){return 1}S(z(C+1|0)|0,z(C+3|0)|0);C=C+5|0;return 0}function Ae(e){e=e|0;if(V(8)|0){return 1}B(z(C+1|0)|0,z(C+3|0)|0,z(C+5|0)|0,z(C+7|0)|0);C=C+9|0;return 0}function Te(e){e=e|0;A();C=C+1|0;return 0}function Se(e){e=e|0;L(e-192|0|0);C=C+1|0;return 0}function Be(e){e=e|0;L(e|0);C=C+1|0;return 0}function Ne(e){e=e|0;L(e|0);C=C+1|0;return 0}function Oe(e){e=e|0;L(e|0);C=C+1|0;return 0}function Ie(e){e=e|0;L(e|0);C=C+1|0;return 0}function Re(e){e=e|0;L(e-192|0|0);C=C+1|0;return 0}function ke(e){e=e|0;L(e|0);C=C+1|0;return 0}function Le(e){e=e|0;L(e|0);C=C+1|0;return 0}function $e(e){e=e|0;L(e|0);C=C+1|0;return 0}function Pe(e){e=e|0;if(V(1)|0){return 1}L(r[C+1|0]|0);C=C+2|0;return 0}function Ue(e){e=e|0;if(V(2)|0){return 1}L(z(C+1|0)|0);C=C+3|0;return 0}function De(e){e=e|0;if(V(4)|0){return 1}$(z(C+1|0)|0,z(C+3|0)|0);C=C+5|0;return 0}function Fe(e){e=e|0;if(V(8)|0){return 1}P(z(C+1|0)|0,z(C+3|0)|0,z(C+5|0)|0,z(C+7|0)|0);C=C+9|0;return 0}function Ce(e){e=e|0;k((e|0)-224|0);C=C+1|0;return 0}function Me(e){e=e|0;h();C=C+1|0;return 0}function je(e){e=e|0;d();C=C+1|0;return 0}function qe(e){e=e|0;g();C=C+1|0;return 0}function Ve(e){e=e|0;p();C=C+1|0;return 0}function ze(e){e=e|0;if(V(1)|0){return 1}k(r[C+1|0]|0);C=C+2|0;return 0}function He(e){e=e|0;var t=0;var n=0;var i=1.0;var o=0.0;var s=0.0;var a=0.0;if(V(2)|0){return 1}t=r[C+1|0]|0;n=r[C+2|0]|0;if((t|0)&0x80){i=-1.0}o=+(((t|0)&0x7C)>>2);s=+(((t|0)&0x03)<<8|n);if(+o==0.0){u(+(+i*+5.9604644775390625e-8*+s))}else if(+o==31.0){if(+i==1.0){if(+s>0.0){b()}else{m()}}else{if(+s>0.0){w()}else{y()}}}else{u(+(+i*F(+2,+(+o-25.0))*+(1024.0+s)))}C=C+3|0;return 0}function Ge(e){e=e|0;if(V(4)|0){return 1}f(r[C+1|0]|0,r[C+2|0]|0,r[C+3|0]|0,r[C+4|0]|0);C=C+5|0;return 0}function Ke(e){e=e|0;if(V(8)|0){return 1}l(r[C+1|0]|0,r[C+2|0]|0,r[C+3|0]|0,r[C+4|0]|0,r[C+5|0]|0,r[C+6|0]|0,r[C+7|0]|0,r[C+8|0]|0);C=C+9|0;return 0}function We(e){e=e|0;return 1}function Ze(e){e=e|0;D();C=C+1|0;return 0}var Ye=[G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,G,K,W,Z,Y,We,We,We,We,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,J,Q,ee,te,We,We,We,We,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,ne,re,ie,oe,se,We,We,We,ae,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ce,ue,fe,le,de,We,We,We,he,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,ge,me,ye,be,We,We,We,we,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,ve,Ee,xe,_e,Ae,We,We,We,Te,Se,Se,Se,Se,Se,Se,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Re,Pe,Ue,De,Fe,We,We,We,We,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Ce,Me,je,qe,Ve,ze,He,Ge,Ke,We,We,We,Ze];return{parse:q}},Gr=_r,Kr=Ar,Wr=Ir,Zr=Rr,{URL:Yr}=jr;let Xr=class e{constructor(e){!(e=e||{}).size||e.size<65536?e.size=65536:e.size=Gr.nextPowerOf2(e.size),this._heap=new ArrayBuffer(e.size),this._heap8=new Uint8Array(this._heap),this._buffer=qr.from(this._heap),this._reset(),this._knownTags=Object.assign({0:e=>new Date(e),1:e=>new Date(1e3*e),2:e=>Gr.arrayBufferToBignumber(e),3:e=>Kr.NEG_ONE.minus(Gr.arrayBufferToBignumber(e)),4:e=>Kr.TEN.pow(e[0]).times(e[1]),5:e=>Kr.TWO.pow(e[0]).times(e[1]),32:e=>new Yr(e),35:e=>new RegExp(e)},e.tags),this.parser=Hr(ke,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var e=this._parents.pop();if(e.length>0)throw new Error(`Missing ${e.length} elements`);switch(e.type){case Kr.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case Kr.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case Kr.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case Kr.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case Kr.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case Kr.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length))}this._currentParent&&this._currentParent.type===Kr.PARENT.TAG&&this._dec()}_dec(){const e=this._currentParent;e.length<0||(e.length--,0===e.length&&this._closeParent())}_push(e,t){const n=this._currentParent;switch(n.values++,n.type){case Kr.PARENT.ARRAY:case Kr.PARENT.BYTE_STRING:case Kr.PARENT.UTF8_STRING:n.length>-1?this._ref[this._ref.length-n.length]=e:this._ref.push(e),this._dec();break;case Kr.PARENT.OBJECT:null!=n.tmpKey?(this._ref[n.tmpKey]=e,n.tmpKey=null,this._dec()):(n.tmpKey=e,"string"!=typeof n.tmpKey&&(n.type=Kr.PARENT.MAP,n.ref=Gr.buildMap(n.ref)));break;case Kr.PARENT.MAP:null!=n.tmpKey?(this._ref.set(n.tmpKey,e),n.tmpKey=null,this._dec()):n.tmpKey=e;break;case Kr.PARENT.TAG:this._ref.push(e),t||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(e,t,n){this._parents[this._depth]={type:t,length:n,ref:e,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:Kr.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(e,t){const n=this._knownTags[e];return n?n(t):new Zr(e,t)}createMap(e,t){return e}createObject(e,t){return e}createArray(e,t){return e}createByteString(e,t){return qr.concat(e)}createByteStringFromHeap(e,t){return e===t?qr.alloc(0):qr.from(this._heap.slice(e,t))}createInt(e){return e}createInt32(e,t){return Gr.buildInt32(e,t)}createInt64(e,t,n,r){return Gr.buildInt64(e,t,n,r)}createFloat(e){return e}createFloatSingle(e,t,n,r){return Vr.read([e,t,n,r],0,!1,23,4)}createFloatDouble(e,t,n,r,i,o,s,a){return Vr.read([e,t,n,r,i,o,s,a],0,!1,52,8)}createInt32Neg(e,t){return-1-Gr.buildInt32(e,t)}createInt64Neg(e,t,n,r){const i=Gr.buildInt32(e,t),o=Gr.buildInt32(n,r);return i>Kr.MAX_SAFE_HIGH?Kr.NEG_ONE.minus(new zr(i).times(Kr.SHIFT32).plus(o)):-1-(i*Kr.SHIFT32+o)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(e,t){return e.join("")}createUtf8StringFromHeap(e,t){return e===t?"":this._buffer.toString("utf8",e,t)}createSimpleUnassigned(e){return new Wr(e)}pushInt(e){this._push(this.createInt(e))}pushInt32(e,t){this._push(this.createInt32(e,t))}pushInt64(e,t,n,r){this._push(this.createInt64(e,t,n,r))}pushFloat(e){this._push(this.createFloat(e))}pushFloatSingle(e,t,n,r){this._push(this.createFloatSingle(e,t,n,r))}pushFloatDouble(e,t,n,r,i,o,s,a){this._push(this.createFloatDouble(e,t,n,r,i,o,s,a))}pushInt32Neg(e,t){this._push(this.createInt32Neg(e,t))}pushInt64Neg(e,t,n,r){this._push(this.createInt64Neg(e,t,n,r))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],Kr.PARENT.ARRAY,-1)}pushArrayStartFixed(e){this._createArrayStartFixed(e)}pushArrayStartFixed32(e,t){const n=Gr.buildInt32(e,t);this._createArrayStartFixed(n)}pushArrayStartFixed64(e,t,n,r){const i=Gr.buildInt64(e,t,n,r);this._createArrayStartFixed(i)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(e){this._createObjectStartFixed(e)}pushObjectStartFixed32(e,t){const n=Gr.buildInt32(e,t);this._createObjectStartFixed(n)}pushObjectStartFixed64(e,t,n,r){const i=Gr.buildInt64(e,t,n,r);this._createObjectStartFixed(i)}pushByteStringStart(){this._parents[this._depth]={type:Kr.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(e,t){this._push(this.createByteStringFromHeap(e,t))}pushUtf8StringStart(){this._parents[this._depth]={type:Kr.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(e,t){this._push(this.createUtf8StringFromHeap(e,t))}pushSimpleUnassigned(e){this._push(this.createSimpleUnassigned(e))}pushTagStart(e){this._parents[this._depth]={type:Kr.PARENT.TAG,length:1,ref:[e]}}pushTagStart4(e,t){this.pushTagStart(Gr.buildInt32(e,t))}pushTagStart8(e,t,n,r){this.pushTagStart(Gr.buildInt64(e,t,n,r))}pushTagUnassigned(e){this._push(this.createTag(e))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(e){0!==e?this._createParent({},Kr.PARENT.OBJECT,e):this._push(this.createObject({}))}_createArrayStartFixed(e){0!==e?this._createParent(new Array(e),Kr.PARENT.ARRAY,e):this._push(this.createArray([]))}_decode(e){if(0===e.byteLength)throw new Error("Input too short");this._reset(),this._heap8.set(e);const t=this.parser.parse(e.byteLength);if(this._depth>1){for(;0===this._currentParent.length;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(t>0)throw new Error("Failed to parse");if(0===this._res.length)throw new Error("No valid result")}decodeFirst(e){return this._decode(e),this._res[0]}decodeAll(e){return this._decode(e),this._res}static decode(t,n){"string"==typeof t&&(t=qr.from(t,n||"hex"));return new e({size:t.length}).decodeFirst(t)}static decodeAll(t,n){"string"==typeof t&&(t=qr.from(t,n||"hex"));return new e({size:t.length}).decodeAll(t)}};Xr.decodeFirst=Xr.decode;var Jr=Xr;const{Buffer:Qr}=wr,ei=Jr,ti=_r;class ni extends ei{createTag(e,t){return`${e}(${t})`}createInt(e){return super.createInt(e).toString()}createInt32(e,t){return super.createInt32(e,t).toString()}createInt64(e,t,n,r){return super.createInt64(e,t,n,r).toString()}createInt32Neg(e,t){return super.createInt32Neg(e,t).toString()}createInt64Neg(e,t,n,r){return super.createInt64Neg(e,t,n,r).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(e){const t=super.createFloat(e);return ti.isNegativeZero(e)?"-0_1":`${t}_1`}createFloatSingle(e,t,n,r){return`${super.createFloatSingle(e,t,n,r)}_2`}createFloatDouble(e,t,n,r,i,o,s,a){return`${super.createFloatDouble(e,t,n,r,i,o,s,a)}_3`}createByteString(e,t){const n=e.join(", ");return-1===t?`(_ ${n})`:`h'${n}`}createByteStringFromHeap(e,t){return`h'${Qr.from(super.createByteStringFromHeap(e,t)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(e){return`simple(${e})`}createArray(e,t){const n=super.createArray(e,t);return-1===t?`[_ ${n.join(", ")}]`:`[${n.join(", ")}]`}createMap(e,t){const n=super.createMap(e),r=Array.from(n.keys()).reduce(ii(n),"");return-1===t?`{_ ${r}}`:`{${r}}`}createObject(e,t){const n=super.createObject(e),r=Object.keys(n).reduce(ii(n),"");return-1===t?`{_ ${r}}`:`{${r}}`}createUtf8String(e,t){const n=e.join(", ");return-1===t?`(_ ${n})`:`"${n}"`}createUtf8StringFromHeap(e,t){return`"${Qr.from(super.createUtf8StringFromHeap(e,t)).toString("utf8")}"`}static diagnose(e,t){"string"==typeof e&&(e=Qr.from(e,t||"hex"));return(new ni).decodeFirst(e)}}var ri=ni;function ii(e){return(t,n)=>t?`${t}, ${n}: ${e[n]}`:`${n}: ${e[n]}`}const{Buffer:oi}=wr,{URL:si}=jr,ai=xr.BigNumber,ci=_r,ui=Ar,fi=ui.MT,li=ui.NUMBYTES,di=ui.SHIFT32,hi=ui.SYMS,pi=ui.TAG,gi=ui.MT.SIMPLE_FLOAT<<5|ui.NUMBYTES.TWO,mi=ui.MT.SIMPLE_FLOAT<<5|ui.NUMBYTES.FOUR,yi=ui.MT.SIMPLE_FLOAT<<5|ui.NUMBYTES.EIGHT,bi=ui.MT.SIMPLE_FLOAT<<5|ui.SIMPLE.TRUE,wi=ui.MT.SIMPLE_FLOAT<<5|ui.SIMPLE.FALSE,vi=ui.MT.SIMPLE_FLOAT<<5|ui.SIMPLE.UNDEFINED,Ei=ui.MT.SIMPLE_FLOAT<<5|ui.SIMPLE.NULL,xi=new ai("0x20000000000000"),_i=oi.from("f97e00","hex"),Ai=oi.from("f9fc00","hex"),Ti=oi.from("f97c00","hex");class Si{constructor(e){e=e||{},this.streaming="function"==typeof e.stream,this.onData=e.stream,this.semanticTypes=[[si,this._pushUrl],[ai,this._pushBigNumber]];const t=e.genTypes||[],n=t.length;for(let e=0;e<n;e++)this.addSemanticType(t[e][0],t[e][1]);this._reset()}addSemanticType(e,t){const n=this.semanticTypes.length;for(let r=0;r<n;r++){if(this.semanticTypes[r][0]===e){const e=this.semanticTypes[r][1];return this.semanticTypes[r][1]=t,e}}return this.semanticTypes.push([e,t]),null}push(e){return!e||(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize()),!0)}pushWrite(e,t,n){return this.result[this.offset]=e,this.resultMethod[this.offset]=t,this.resultLength[this.offset]=n,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(e){return this.pushWrite(e,1,1)}_pushUInt16BE(e){return this.pushWrite(e,2,2)}_pushUInt32BE(e){return this.pushWrite(e,3,4)}_pushDoubleBE(e){return this.pushWrite(e,4,8)}_pushNaN(){return this.push(_i)}_pushInfinity(e){const t=e<0?Ai:Ti;return this.push(t)}_pushFloat(e){const t=oi.allocUnsafe(2);if(ci.writeHalf(t,e)&&ci.parseHalf(t)===e)return this._pushUInt8(gi)&&this.push(t);const n=oi.allocUnsafe(4);return n.writeFloatBE(e,0),n.readFloatBE(0)===e?this._pushUInt8(mi)&&this.push(n):this._pushUInt8(yi)&&this._pushDoubleBE(e)}_pushInt(e,t,n){const r=t<<5;return e<24?this._pushUInt8(r|e):e<=255?this._pushUInt8(r|li.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(r|li.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(r|li.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(r|li.EIGHT)&&this._pushUInt32BE(Math.floor(e/di))&&this._pushUInt32BE(e%di):t===fi.NEG_INT?this._pushFloat(n):this._pushFloat(e)}_pushIntNum(e){return e<0?this._pushInt(-e-1,fi.NEG_INT,e):this._pushInt(e,fi.POS_INT)}_pushNumber(e){switch(!1){case e==e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!=0:return this._pushIntNum(e);default:return this._pushFloat(e)}}_pushString(e){const t=oi.byteLength(e,"utf8");return this._pushInt(t,fi.UTF8_STRING)&&this.pushWrite(e,5,t)}_pushBoolean(e){return this._pushUInt8(e?bi:wi)}_pushUndefined(e){return this._pushUInt8(vi)}_pushArray(e,t){const n=t.length;if(!e._pushInt(n,fi.ARRAY))return!1;for(let r=0;r<n;r++)if(!e.pushAny(t[r]))return!1;return!0}_pushTag(e){return this._pushInt(e,fi.TAG)}_pushDate(e,t){return e._pushTag(pi.DATE_EPOCH)&&e.pushAny(Math.round(t/1e3))}_pushBuffer(e,t){return e._pushInt(t.length,fi.BYTE_STRING)&&e.push(t)}_pushNoFilter(e,t){return e._pushBuffer(e,t.slice())}_pushRegexp(e,t){return e._pushTag(pi.REGEXP)&&e.pushAny(t.source)}_pushSet(e,t){if(!e._pushInt(t.size,fi.ARRAY))return!1;for(const n of t)if(!e.pushAny(n))return!1;return!0}_pushUrl(e,t){return e._pushTag(pi.URI)&&e.pushAny(t.format())}_pushBigint(e){let t=pi.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),t=pi.NEG_BIGINT);let n=e.toString(16);n.length%2&&(n="0"+n);const r=oi.from(n,"hex");return this._pushTag(t)&&this._pushBuffer(this,r)}_pushBigNumber(e,t){if(t.isNaN())return e._pushNaN();if(!t.isFinite())return e._pushInfinity(t.isNegative()?-1/0:1/0);if(t.isInteger())return e._pushBigint(t);if(!e._pushTag(pi.DECIMAL_FRAC)||!e._pushInt(2,fi.ARRAY))return!1;const n=t.decimalPlaces(),r=t.multipliedBy(new ai(10).pow(n));return!!e._pushIntNum(-n)&&(r.abs().isLessThan(xi)?e._pushIntNum(r.toNumber()):e._pushBigint(r))}_pushMap(e,t){return!!e._pushInt(t.size,fi.MAP)&&this._pushRawMap(t.size,Array.from(t))}_pushObject(e){if(!e)return this._pushUInt8(Ei);for(var t=this.semanticTypes.length,n=0;n<t;n++)if(e instanceof this.semanticTypes[n][0])return this.semanticTypes[n][1].call(e,this,e);var r=e.encodeCBOR;if("function"==typeof r)return r.call(e,this);var i=Object.keys(e),o=i.length;return!!this._pushInt(o,fi.MAP)&&this._pushRawMap(o,i.map((t=>[t,e[t]])))}_pushRawMap(e,t){t=t.map((function(e){return e[0]=Si.encode(e[0]),e})).sort(ci.keySorter);for(var n=0;n<e;n++){if(!this.push(t[n][0]))return!1;if(!this.pushAny(t[n][1]))return!1}return!0}write(e){return this.pushAny(e)}pushAny(e){var t=function(e){return{}.toString.call(e).slice(8,-1)}(e);switch(t){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,oi.isBuffer(e)?e:oi.from(e));case"Null":return this._pushUInt8(Ei);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case hi.NULL:return this._pushObject(null);case hi.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(0===this.offset)return null;for(var e=this.result,t=this.resultLength,n=this.resultMethod,r=this.offset,i=0,o=0;o<r;o++)i+=t[o];var s=oi.allocUnsafe(i),a=0,c=0;for(o=0;o<r;o++){switch(c=t[o],n[o]){case 0:e[o].copy(s,a);break;case 1:s.writeUInt8(e[o],a,!0);break;case 2:s.writeUInt16BE(e[o],a,!0);break;case 3:s.writeUInt32BE(e[o],a,!0);break;case 4:s.writeDoubleBE(e[o],a,!0);break;case 5:s.write(e[o],a,c,"utf8");break;default:throw new Error("unkown method")}a+=c}var u=s;return this._reset(),u}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(e){const t=new Si;if(!t.pushAny(e))throw new Error("Failed to encode input");return t.finalize()}}var Bi,Ni=Si;(Bi=br).Diagnose=ri,Bi.Decoder=Jr,Bi.Encoder=Ni,Bi.Simple=Ir,Bi.Tagged=Rr,Bi.decodeAll=Bi.Decoder.decodeAll,Bi.decodeFirst=Bi.Decoder.decodeFirst,Bi.diagnose=Bi.Diagnose.diagnose,Bi.encode=Bi.Encoder.encode,Bi.decode=Bi.Decoder.decode,Bi.leveldb={decode:Bi.Decoder.decodeAll,encode:Bi.Encoder.encode,buffer:!0,name:"cbor"};var Oi=Le(br);function Ii(e){return Zt(Ct.create().update(new Uint8Array(e)).digest())}function Ri(e){if(e instanceof Oi.Tagged)return Ri(e.value);if("string"==typeof e)return ki(e);if("number"==typeof e)return Ii(an(e));if(e instanceof ArrayBuffer||ArrayBuffer.isView(e))return Ii(e);if(Array.isArray(e)){return Ii(Vt(...e.map(Ri)))}if(e&&"object"==typeof e&&e._isPrincipal)return Ii(e.toUint8Array());if("object"==typeof e&&null!==e&&"function"==typeof e.toHash)return Ri(e.toHash());if("object"==typeof e)return $i(e);if("bigint"==typeof e)return Ii(an(e));throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${e}`),{value:e})}const ki=e=>Ii((new TextEncoder).encode(e));function Li(e){return $i(e)}function $i(e){const t=Object.entries(e).filter((([,e])=>void 0!==e)).map((([e,t])=>[ki(e),Ri(t)]));return Ii(Vt(...t.sort((([e],[t])=>Kt(e,t))).map((e=>Vt(...e)))))}var Pi=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Ui=(new TextEncoder).encode("\nic-request");class Di{getPrincipal(){return this._principal||(this._principal=qt.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(e){const{body:t}=e,n=Pi(e,["body"]),r=Li(t);return Object.assign(Object.assign({},n),{body:{content:t,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(Vt(Ui,r))}})}}class Fi{getPrincipal(){return qt.anonymous()}async transformRequest(e){return Object.assign(Object.assign({},e),{body:{content:e.body}})}}var Ci={},Mi={},ji={};Object.defineProperty(ji,"__esModule",{value:!0});const qi=9007199254740992;function Vi(e,...t){const n=new Uint8Array(e.byteLength+t.reduce(((e,t)=>e+t.byteLength),0));n.set(new Uint8Array(e),0);let r=e.byteLength;for(const e of t)n.set(new Uint8Array(e),r),r+=e.byteLength;return n.buffer}function zi(e,t,n){const r=2**(t-24);n=(n=n.replace(/[^0-9a-fA-F]/g,"")).slice(2*-r).padStart(2*r,"0");const i=[(e<<5)+t].concat(n.match(/../g).map((e=>parseInt(e,16))));return new Uint8Array(i).buffer}function Hi(e,t){if(t<24)return new Uint8Array([(e<<5)+t]).buffer;return zi(e,t<=255?24:t<=65535?25:t<=4294967295?26:27,t.toString(16))}function Gi(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(n++,r=(1023&r)<<10|1023&e.charCodeAt(n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return Vi(new Uint8Array(Hi(3,e.length)),new Uint8Array(t))}function Ki(e){return new Uint8Array(e).buffer}function Wi(e){if(isNaN(e))throw new RangeError("Invalid number.");e=Math.min(Math.max(0,e),23);return new Uint8Array([0+e]).buffer}function Zi(e,t){if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return zi(0,24,e=(e=Math.min(Math.max(0,e),255)).toString(16))}function Yi(e,t){if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return zi(0,25,e=(e=Math.min(Math.max(0,e),65535)).toString(16))}function Xi(e,t){if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return zi(0,26,e=(e=Math.min(Math.max(0,e),4294967295)).toString(16))}function Ji(e,t){if("string"==typeof e&&16==t){if(e.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return zi(0,27,e)}if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return zi(0,27,e=(e=Math.min(Math.max(0,e),qi)).toString(16))}function Qi(e){if(isNaN(e))throw new RangeError("Invalid number.");if(0===e)return Wi(0);e=Math.min(Math.max(0,-e),24)-1;return new Uint8Array([32+e]).buffer}function eo(e,t){if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return zi(1,24,e=(e=Math.min(Math.max(0,-e-1),255)).toString(16))}function to(e,t){if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return zi(1,25,e=(e=Math.min(Math.max(0,-e-1),65535)).toString(16))}function no(e,t){if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return zi(1,26,e=(e=Math.min(Math.max(0,-e-1),4294967295)).toString(16))}function ro(e,t){if("string"==typeof e&&16==t){if((e=e.startsWith("-")?e.slice(1):"0").match(/[^0-9a-fA-F]/)||e.length>16)throw new RangeError("Invalid number.");let t=!1,n=e.split("").reduceRight(((e,n)=>{if(t)return n+e;let r=parseInt(n,16)-1;return r>=0?(t=!0,r.toString(16)+e):"f"+e}),"");return t?zi(1,27,n):Ji(0)}if(e=parseInt(""+e,t),isNaN(e))throw new RangeError("Invalid number.");return zi(1,27,e=(e=Math.min(Math.max(0,-e-1),9007199254740992)).toString(16))}function io(){return Ki(new Uint8Array([245]))}function oo(){return Ki(new Uint8Array([244]))}ji.tagged=function(e,t){if(14277111==e)return Vi(new Uint8Array([217,217,247]),t);if(e<24)return Vi(new Uint8Array([192+e]),t);{const t=e<=255?24:e<=65535?25:e<=4294967295?26:27,n=2**(t-24),r=e.toString(16).slice(2*-n).padStart(2*n,"0"),i=[192+t].concat(r.match(/../g).map((e=>parseInt(e,16))));return new Uint8Array(i).buffer}},ji.raw=Ki,ji.uSmall=Wi,ji.u8=Zi,ji.u16=Yi,ji.u32=Xi,ji.u64=Ji,ji.iSmall=Qi,ji.i8=eo,ji.i16=to,ji.i32=no,ji.i64=ro,ji.number=function(e){return e>=0?e<24?Wi(e):e<=255?Zi(e):e<=65535?Yi(e):e<=4294967295?Xi(e):Ji(e):e>=-24?Qi(e):e>=-255?eo(e):e>=-65535?to(e):e>=-4294967295?no(e):ro(e)},ji.bytes=function(e){return Vi(Hi(2,e.byteLength),e)},ji.string=function(e){return Gi(e)},ji.array=function(e){return Vi(Hi(4,e.length),...e)},ji.map=function(e,t=!1){e instanceof Map||(e=new Map(Object.entries(e)));let n=Array.from(e.entries());return t&&(n=n.sort((([e],[t])=>e.localeCompare(t)))),Vi(Hi(5,e.size),...n.map((([e,t])=>Vi(Gi(e),t))))},ji.singleFloat=function(e){const t=new Float32Array([e]);return Vi(new Uint8Array([250]),new Uint8Array(t.buffer))},ji.doubleFloat=function(e){const t=new Float64Array([e]);return Vi(new Uint8Array([251]),new Uint8Array(t.buffer))},ji.bool=function(e){return e?io():oo()},ji.true_=io,ji.false_=oo,ji.null_=function(){return Ki(new Uint8Array([246]))},ji.undefined_=function(){return Ki(new Uint8Array([247]))};var so=ke&&ke.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(Mi,"__esModule",{value:!0});const ao=so(ji),co=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class uo{constructor(e,t=!1){this._serializer=e,this._stable=t,this.name="jsonDefault",this.priority=-100}match(e){return-1!=["undefined","boolean","number","string","object"].indexOf(typeof e)}encode(e){switch(typeof e){case"undefined":return ao.undefined_();case"boolean":return ao.bool(e);case"number":return Math.floor(e)===e?ao.number(e):ao.doubleFloat(e);case"string":return ao.string(e);case"object":if(null===e)return ao.null_();if(Array.isArray(e))return ao.array(e.map((e=>this._serializer.serializeValue(e))));if(co.find((t=>e instanceof t)))return ao.bytes(e.buffer);if(-1!==Object.getOwnPropertyNames(e).indexOf("toJSON"))return this.encode(e.toJSON());if(e instanceof Map){const t=new Map;for(const[n,r]of e.entries())t.set(n,this._serializer.serializeValue(r));return ao.map(t,this._stable)}{const t=new Map;for(const[n,r]of Object.entries(e))t.set(n,this._serializer.serializeValue(r));return ao.map(t,this._stable)}default:throw new Error("Invalid value.")}}}Mi.JsonDefaultCborEncoder=uo;class fo{constructor(){this.name="cborEncoder",this.priority=-90}match(e){return"object"==typeof e&&"function"==typeof e.toCBOR}encode(e){return e.toCBOR()}}Mi.ToCborEncoder=fo;class lo{constructor(){this._encoders=new Set}static withDefaultEncoders(e=!1){const t=new this;return t.addEncoder(new uo(t,e)),t.addEncoder(new fo),t}removeEncoder(e){for(const t of this._encoders.values())t.name==e&&this._encoders.delete(t)}addEncoder(e){this._encoders.add(e)}getEncoderFor(e){let t=null;for(const n of this._encoders)(!t||n.priority>t.priority)&&n.match(e)&&(t=n);if(null===t)throw new Error("Could not find an encoder for value.");return t}serializeValue(e){return this.getEncoderFor(e).encode(e)}serialize(e){return this.serializeValue(e)}}Mi.CborSerializer=lo;Mi.SelfDescribeCborSerializer=class extends lo{serialize(e){return ao.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(e))]))}},function(e){var t=ke&&ke.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(Mi);const n=t(ji);e.value=n}(Ci);const ho=Ci.SelfDescribeCborSerializer.withDefaultEncoders(!0);var po;function go(e){return ho.serialize(e)}function mo(e){const t=e.byteLength;let n=BigInt(0);for(let r=0;r<t;r++)n=n*BigInt(256)+BigInt(e[r]);return n}ho.addEncoder(new class{get name(){return"Principal"}get priority(){return 0}match(e){return e&&!0===e._isPrincipal}encode(e){return Ci.value.bytes(e.toUint8Array())}}),ho.addEncoder(new class{get name(){return"Buffer"}get priority(){return 1}match(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)}encode(e){return Ci.value.bytes(new Uint8Array(e))}}),ho.addEncoder(new class{get name(){return"BigInt"}get priority(){return 1}match(e){return"bigint"==typeof e}encode(e){return e>BigInt(0)?Ci.value.tagged(2,Ci.value.bytes(Gt(e.toString(16)))):Ci.value.tagged(3,Ci.value.bytes(Gt((BigInt("-1")*e).toString(16))))}}),function(e){e[e.Uint64LittleEndian=71]="Uint64LittleEndian",e[e.Semantic=55799]="Semantic"}(po||(po={}));class yo extends Oi.Decoder{createByteString(e){return Vt(...e)}createByteStringFromHeap(e,t){return e===t?new ArrayBuffer(0):new Uint8Array(this._heap.slice(e,t))}}function bo(e){const t=new Uint8Array(e),n=new yo({size:t.byteLength,tags:{2:e=>mo(e),3:e=>-mo(e),[po.Semantic]:e=>e}});try{return n.decodeFirst(t)}catch(e){throw new Error(`Failed to decode CBOR: ${e}, input: ${zt(t)}`)}}const wo=()=>{if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){const e=new Uint32Array(1);return window.crypto.getRandomValues(e),e[0]}if("undefined"!=typeof crypto&&crypto.getRandomValues){const e=new Uint32Array(1);return crypto.getRandomValues(e),e[0]}return"undefined"!=typeof crypto&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(4294967295*Math.random())};var vo;function Eo(){const e=new ArrayBuffer(16),t=new DataView(e),n=wo(),r=wo(),i=wo(),o=wo();return t.setUint32(0,n),t.setUint32(4,r),t.setUint32(8,i),t.setUint32(12,o),e}!function(e){e.Call="call"}(vo||(vo={}));const xo=BigInt(1e6);class _o{constructor(e){if(e<9e4){const t=BigInt(Date.now()+e)*xo/BigInt(1e9);return void(this._value=t*BigInt(1e9))}const t=BigInt(Math.floor(Date.now()+e-6e4))*xo/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=t}toCBOR(){return Ci.value.u64(this._value.toString(16),16)}toHash(){return an(this._value)}}function Ao(e=Eo){return async t=>{const n=t.request.headers;t.request.headers=n,"call"===t.endpoint&&(t.body.nonce=e())}}function To(e){const t=[];return e.forEach(((e,n)=>{t.push([n,e])})),t}class So extends Xt{constructor(e,t){super(e),this.response=t,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class Bo extends Xt{constructor(e,t,n,r,i,o){super(e),this.response=t,this.requestId=n,this.senderPubkey=r,this.senderSig=i,this.ingressExpiry=o,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class No extends Xt{constructor(e,t,n,r,i,o){super(e),this.response=t,this.requestId=n,this.senderPubkey=r,this.senderSig=i,this.ingressExpiry=o,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class Oo extends Xt{constructor(e,t,n,r,i,o){super(e),this.response=t,this.requestId=n,this.senderPubkey=r,this.senderSig=i,this.ingressExpiry=o,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Io=BigInt(0),Ro=BigInt(1);function ko(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Lo(e){if(!ko(e))throw new Error("Uint8Array expected")}function $o(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}function Po(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?Io:BigInt("0x"+e)}const Uo="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,Do=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Fo(e){if(Lo(e),Uo)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=Do[e[n]];return t}const Co={_0:48,_9:57,A:65,F:70,a:97,f:102};function Mo(e){return e>=Co._0&&e<=Co._9?e-Co._0:e>=Co.A&&e<=Co.F?e-(Co.A-10):e>=Co.a&&e<=Co.f?e-(Co.a-10):void 0}function jo(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(Uo)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let t=0,i=0;t<n;t++,i+=2){const n=Mo(e.charCodeAt(i)),o=Mo(e.charCodeAt(i+1));if(void 0===n||void 0===o){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}r[t]=16*n+o}return r}function qo(e){return Po(Fo(e))}function Vo(e){return Lo(e),Po(Fo(Uint8Array.from(e).reverse()))}function zo(e,t){return jo(e.toString(16).padStart(2*t,"0"))}function Ho(e,t){return zo(e,t).reverse()}function Go(e,t,n){let r;if("string"==typeof t)try{r=jo(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!ko(t))throw new Error(e+" must be hex string or Uint8Array");r=Uint8Array.from(t)}const i=r.length;if("number"==typeof n&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}function Ko(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];Lo(r),t+=r.length}const n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const i=e[t];n.set(i,r),r+=i.length}return n}function Wo(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}const Zo=e=>"bigint"==typeof e&&Io<=e;function Yo(e,t,n){return Zo(e)&&Zo(t)&&Zo(n)&&t<=e&&e<n}function Xo(e,t,n,r){if(!Yo(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function Jo(e){let t;for(t=0;e>Io;e>>=Ro,t+=1);return t}function Qo(e,t){return e>>BigInt(t)&Ro}const es=e=>(Ro<<BigInt(e))-Ro,ts={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||ko(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function ns(e,t,n={}){const r=(t,n,r)=>{const i=ts[n];if("function"!=typeof i)throw new Error("invalid validator function");const o=e[t];if(!(r&&void 0===o||i(o,e)))throw new Error("param "+String(t)+" is invalid. Expected "+n+", got "+o)};for(const[e,n]of Object.entries(t))r(e,n,!1);for(const[e,t]of Object.entries(n))r(e,t,!0);return e}const rs=()=>{throw new Error("not implemented")};function is(e){const t=new WeakMap;return(n,...r)=>{const i=t.get(n);if(void 0!==i)return i;const o=e(n,...r);return t.set(n,o),o}}const os=BigInt(0),ss=BigInt(1),as=BigInt(2),cs=BigInt(3),us=BigInt(4),fs=BigInt(5),ls=BigInt(8);function ds(e,t){const n=e%t;return n>=os?n:t+n}function hs(e,t,n){let r=e;for(;t-- >os;)r*=r,r%=n;return r}function ps(e,t){if(e===os)throw new Error("invert: expected non-zero number");if(t<=os)throw new Error("invert: expected positive modulus, got "+t);let n=ds(e,t),r=t,i=os,o=ss;for(;n!==os;){const e=r%n,t=i-o*(r/n);r=n,n=e,i=o,o=t}if(r!==ss)throw new Error("invert: does not exist");return ds(i,t)}function gs(e,t){const n=(e.ORDER+ss)/us,r=e.pow(t,n);if(!e.eql(e.sqr(r),t))throw new Error("Cannot find square root");return r}function ms(e,t){const n=(e.ORDER-fs)/ls,r=e.mul(t,as),i=e.pow(r,n),o=e.mul(t,i),s=e.mul(e.mul(o,as),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}function ys(e){return e%us===cs?gs:e%ls===fs?ms:function(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-ss,n=0;for(;t%as===os;)t/=as,n++;let r=as;const i=As(e);for(;1===xs(i,r);)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===n)return gs;let o=i.pow(r,t);const s=(t+ss)/as;return function(e,r){if(e.is0(r))return r;if(1!==xs(e,r))throw new Error("Cannot find square root");let i=n,a=e.mul(e.ONE,o),c=e.pow(r,t),u=e.pow(r,s);for(;!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;let t=1,n=e.sqr(c);for(;!e.eql(n,e.ONE);)if(t++,n=e.sqr(n),t===i)throw new Error("Cannot find square root");const r=ss<<BigInt(i-t-1),o=e.pow(a,r);i=t,a=e.sqr(o),c=e.mul(c,a),u=e.mul(u,o)}return u}}(e)}const bs=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ws(e){const t=bs.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return ns(e,t)}function vs(e,t,n){if(n<os)throw new Error("invalid exponent, negatives unsupported");if(n===os)return e.ONE;if(n===ss)return t;let r=e.ONE,i=t;for(;n>os;)n&ss&&(r=e.mul(r,i)),i=e.sqr(i),n>>=ss;return r}function Es(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),i=t.reduce(((t,n,i)=>e.is0(n)?t:(r[i]=t,e.mul(t,n))),e.ONE),o=e.inv(i);return t.reduceRight(((t,n,i)=>e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n))),o),r}function xs(e,t){const n=(e.ORDER-ss)/as,r=e.pow(t,n),i=e.eql(r,e.ONE),o=e.eql(r,e.ZERO),s=e.eql(r,e.neg(e.ONE));if(!i&&!o&&!s)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function _s(e,t){void 0!==t&&function(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}(t);const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function As(e,t,n=!1,r={}){if(e<=os)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:o}=_s(e,t);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let s;const a=Object.freeze({ORDER:e,isLE:n,BITS:i,BYTES:o,MASK:es(i),ZERO:os,ONE:ss,create:t=>ds(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return os<=t&&t<e},is0:e=>e===os,isOdd:e=>(e&ss)===ss,neg:t=>ds(-t,e),eql:(e,t)=>e===t,sqr:t=>ds(t*t,e),add:(t,n)=>ds(t+n,e),sub:(t,n)=>ds(t-n,e),mul:(t,n)=>ds(t*n,e),pow:(e,t)=>vs(a,e,t),div:(t,n)=>ds(t*ps(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>ps(t,e),sqrt:r.sqrt||(t=>(s||(s=ys(e)),s(a,t))),toBytes:e=>n?Ho(e,o):zo(e,o),fromBytes:e=>{if(e.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+e.length);return n?Vo(e):qo(e)},invertBatch:e=>Es(a,e),cmov:(e,t,n)=>n?t:e});return Object.freeze(a)}function Ts(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Ss(e){const t=Ts(e);return t+Math.ceil(t/2)}const Bs=qo;function Ns(e,t){if(Is(e),Is(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);const n=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)n[r]=255&e,e>>>=8;return new Uint8Array(n)}function Os(e,t){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}function Is(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function Rs(e,t,n){ns(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:r,k:i,m:o,hash:s,expand:a,DST:c}=n;Lo(e),Is(t);const u="string"==typeof c?Wo(c):c,f=r.toString(2).length,l=Math.ceil((f+i)/8),d=t*o*l;let h;if("xmd"===a)h=function(e,t,n,r){Lo(e),Lo(t),Is(n),t.length>255&&(t=r(Ko(Wo("H2C-OVERSIZE-DST-"),t)));const{outputLen:i,blockLen:o}=r,s=Math.ceil(n/i);if(n>65535||s>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=Ko(t,Ns(t.length,1)),c=Ns(0,o),u=Ns(n,2),f=new Array(s),l=r(Ko(c,e,u,Ns(0,1),a));f[0]=r(Ko(l,Ns(1,1),a));for(let e=1;e<=s;e++){const t=[Os(l,f[e-1]),Ns(e+1,1),a];f[e]=r(Ko(...t))}return Ko(...f).slice(0,n)}(e,u,d,s);else if("xof"===a)h=function(e,t,n,r,i){if(Lo(e),Lo(t),Is(n),t.length>255){const e=Math.ceil(2*r/8);t=i.create({dkLen:e}).update(Wo("H2C-OVERSIZE-DST-")).update(t).digest()}if(n>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:n}).update(e).update(Ns(n,2)).update(t).update(Ns(t.length,1)).digest()}(e,u,d,i,s);else{if("_internal_pass"!==a)throw new Error('expand must be "xmd" or "xof"');h=e}const p=new Array(t);for(let e=0;e<t;e++){const t=new Array(o);for(let n=0;n<o;n++){const i=l*(n+e*o),s=h.subarray(i,i+l);t[n]=ds(Bs(s),r)}p[e]=t}return p}function ks(e,t){const n=t.map((e=>Array.from(e).reverse()));return(t,r)=>{const[i,o,s,a]=n.map((n=>n.reduce(((n,r)=>e.add(e.mul(n,t),r))))),[c,u]=Es(e,[o,a],!0);return t=e.mul(i,c),r=e.mul(r,e.mul(s,u)),{x:t,y:r}}}function Ls(e,t,n){if("function"!=typeof t)throw new Error("mapToCurve() must be defined");function r(n){return e.fromAffine(t(n))}function i(t){const n=t.clearCofactor();return n.equals(e.ZERO)?e.ZERO:(n.assertValidity(),n)}return{defaults:n,hashToCurve(e,t){const o=Rs(e,2,{...n,DST:n.DST,...t}),s=r(o[0]),a=r(o[1]);return i(s.add(a))},encodeToCurve:(e,t)=>i(r(Rs(e,1,{...n,DST:n.encodeDST,...t})[0])),mapToCurve(e){if(!Array.isArray(e))throw new Error("expected array of bigints");for(const t of e)if("bigint"!=typeof t)throw new Error("expected array of bigints");return i(r(e))}}}const $s=BigInt(0),Ps=BigInt(1);function Us(e,t){const n=t.negate();return e?n:t}function Ds(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Fs(e,t){Ds(e,t);const n=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:es(e),maxNumber:n,shiftBy:BigInt(e)}}function Cs(e,t,n){const{windowSize:r,mask:i,maxNumber:o,shiftBy:s}=n;let a=Number(e&i),c=e>>s;a>r&&(a-=o,c+=Ps);const u=t*r;return{nextN:c,offset:u+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:t%2!=0,offsetF:u}}const Ms=new WeakMap,js=new WeakMap;function qs(e){return js.get(e)||1}function Vs(e,t){return{constTimeNegate:Us,hasPrecomputes:e=>1!==qs(e),unsafeLadder(t,n,r=e.ZERO){let i=t;for(;n>$s;)n&Ps&&(r=r.add(i)),i=i.double(),n>>=Ps;return r},precomputeWindow(e,n){const{windows:r,windowSize:i}=Fs(n,t),o=[];let s=e,a=s;for(let e=0;e<r;e++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(n,r,i){let o=e.ZERO,s=e.BASE;const a=Fs(n,t);for(let e=0;e<a.windows;e++){const{nextN:t,offset:n,isZero:c,isNeg:u,isNegF:f,offsetF:l}=Cs(i,e,a);i=t,c?s=s.add(Us(f,r[l])):o=o.add(Us(u,r[n]))}return{p:o,f:s}},wNAFUnsafe(n,r,i,o=e.ZERO){const s=Fs(n,t);for(let e=0;e<s.windows&&i!==$s;e++){const{nextN:t,offset:n,isZero:a,isNeg:c}=Cs(i,e,s);if(i=t,!a){const e=r[n];o=o.add(c?e.negate():e)}}return o},getPrecomputes(e,t,n){let r=Ms.get(t);return r||(r=this.precomputeWindow(t,e),1!==e&&Ms.set(t,n(r))),r},wNAFCached(e,t,n){const r=qs(e);return this.wNAF(r,this.getPrecomputes(r,e,n),t)},wNAFCachedUnsafe(e,t,n,r){const i=qs(e);return 1===i?this.unsafeLadder(e,t,r):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),t,r)},setWindowSize(e,n){Ds(n,t),js.set(e,n),Ms.delete(e)}}}function zs(e,t,n,r){!function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)}))}(n,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)}))}(r,t);const i=n.length,o=r.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");const s=e.ZERO,a=Jo(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=es(c),f=new Array(Number(u)+1).fill(s);let l=s;for(let e=Math.floor((t.BITS-1)/c)*c;e>=0;e-=c){f.fill(s);for(let t=0;t<o;t++){const i=r[t],o=Number(i>>BigInt(e)&u);f[o]=f[o].add(n[t])}let t=s;for(let e=f.length-1,n=s;e>0;e--)n=n.add(f[e]),t=t.add(n);if(l=l.add(t),0!==e)for(let e=0;e<c;e++)l=l.double()}return l}function Hs(e){return ws(e.Fp),ns(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({..._s(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}const Gs=BigInt(0),Ks=BigInt(1),Ws=BigInt(2),Zs=BigInt(3),Ys=BigInt(4);function Xs(e){const t=function(e){const t=Hs(e);ns(t,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:n,Fp:r,a:i}=t;if(n){if(!r.eql(i,r.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...t})}(e),{Fp:n}=t,r=As(t.n,t.nBitLength),i=t.toBytes||((e,t,r)=>{const i=t.toAffine();return Ko(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))}),o=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function s(e){const{a:r,b:i}=t,o=n.sqr(e),s=n.mul(o,e);return n.add(n.add(s,n.mul(e,r)),i)}function a(e,t){const r=n.sqr(t),i=s(e);return n.eql(r,i)}if(!a(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const c=n.mul(n.pow(t.a,Zs),Ys),u=n.mul(n.sqr(t.b),BigInt(27));if(n.is0(n.add(c,u)))throw new Error("bad curve params: a or b");function f(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:i,n:o}=t;if(n&&"bigint"!=typeof e){if(ko(e)&&(e=Fo(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("invalid private key");e=e.padStart(2*r,"0")}let s;try{s="bigint"==typeof e?e:qo(Go("private key",e,r))}catch(t){throw new Error("invalid private key, expected hex or "+r+" bytes, got "+typeof e)}return i&&(s=ds(s,o)),Xo("private key",s,Ks,o),s}function l(e){if(!(e instanceof p))throw new Error("ProjectivePoint expected")}const d=is(((e,t)=>{const{px:r,py:i,pz:o}=e;if(n.eql(o,n.ONE))return{x:r,y:i};const s=e.is0();null==t&&(t=s?n.ONE:n.inv(o));const a=n.mul(r,t),c=n.mul(i,t),u=n.mul(o,t);if(s)return{x:n.ZERO,y:n.ZERO};if(!n.eql(u,n.ONE))throw new Error("invZ was invalid");return{x:a,y:c}})),h=is((e=>{if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:r,y:i}=e.toAffine();if(!n.isValid(r)||!n.isValid(i))throw new Error("bad point: x or y not FE");if(!a(r,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));class p{constructor(e,t,r){if(null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t)||n.is0(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required");this.px=e,this.py=t,this.pz=r,Object.freeze(this)}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof p)throw new Error("projective point not allowed");const i=e=>n.eql(e,n.ZERO);return i(t)&&i(r)?p.ZERO:new p(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=Es(n,e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(p.fromAffine)}static fromHex(e){const t=p.fromAffine(o(Go("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return p.BASE.multiply(f(e))}static msm(e,t){return zs(p,r,e,t)}_setWindowSize(e){y.setWindowSize(this,e)}assertValidity(){h(this)}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){l(e);const{px:t,py:r,pz:i}=this,{px:o,py:s,pz:a}=e,c=n.eql(n.mul(t,a),n.mul(o,i)),u=n.eql(n.mul(r,a),n.mul(s,i));return c&&u}negate(){return new p(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,i=n.mul(r,Zs),{px:o,py:s,pz:a}=this;let c=n.ZERO,u=n.ZERO,f=n.ZERO,l=n.mul(o,o),d=n.mul(s,s),h=n.mul(a,a),g=n.mul(o,s);return g=n.add(g,g),f=n.mul(o,a),f=n.add(f,f),c=n.mul(e,f),u=n.mul(i,h),u=n.add(c,u),c=n.sub(d,u),u=n.add(d,u),u=n.mul(c,u),c=n.mul(g,c),f=n.mul(i,f),h=n.mul(e,h),g=n.sub(l,h),g=n.mul(e,g),g=n.add(g,f),f=n.add(l,l),l=n.add(f,l),l=n.add(l,h),l=n.mul(l,g),u=n.add(u,l),h=n.mul(s,a),h=n.add(h,h),l=n.mul(h,g),c=n.sub(c,l),f=n.mul(h,d),f=n.add(f,f),f=n.add(f,f),new p(c,u,f)}add(e){l(e);const{px:r,py:i,pz:o}=this,{px:s,py:a,pz:c}=e;let u=n.ZERO,f=n.ZERO,d=n.ZERO;const h=t.a,g=n.mul(t.b,Zs);let m=n.mul(r,s),y=n.mul(i,a),b=n.mul(o,c),w=n.add(r,i),v=n.add(s,a);w=n.mul(w,v),v=n.add(m,y),w=n.sub(w,v),v=n.add(r,o);let E=n.add(s,c);return v=n.mul(v,E),E=n.add(m,b),v=n.sub(v,E),E=n.add(i,o),u=n.add(a,c),E=n.mul(E,u),u=n.add(y,b),E=n.sub(E,u),d=n.mul(h,v),u=n.mul(g,b),d=n.add(u,d),u=n.sub(y,d),d=n.add(y,d),f=n.mul(u,d),y=n.add(m,m),y=n.add(y,m),b=n.mul(h,b),v=n.mul(g,v),y=n.add(y,b),b=n.sub(m,b),b=n.mul(h,b),v=n.add(v,b),m=n.mul(y,v),f=n.add(f,m),m=n.mul(E,v),u=n.mul(w,u),u=n.sub(u,m),m=n.mul(w,y),d=n.mul(E,d),d=n.add(d,m),new p(u,f,d)}subtract(e){return this.add(e.negate())}is0(){return this.equals(p.ZERO)}wNAF(e){return y.wNAFCached(this,e,p.normalizeZ)}multiplyUnsafe(e){const{endo:r,n:i}=t;Xo("scalar",e,Gs,i);const o=p.ZERO;if(e===Gs)return o;if(this.is0()||e===Ks)return this;if(!r||y.hasPrecomputes(this))return y.wNAFCachedUnsafe(this,e,p.normalizeZ);let{k1neg:s,k1:a,k2neg:c,k2:u}=r.splitScalar(e),f=o,l=o,d=this;for(;a>Gs||u>Gs;)a&Ks&&(f=f.add(d)),u&Ks&&(l=l.add(d)),d=d.double(),a>>=Ks,u>>=Ks;return s&&(f=f.negate()),c&&(l=l.negate()),l=new p(n.mul(l.px,r.beta),l.py,l.pz),f.add(l)}multiply(e){const{endo:r,n:i}=t;let o,s;if(Xo("scalar",e,Ks,i),r){const{k1neg:t,k1:i,k2neg:a,k2:c}=r.splitScalar(e);let{p:u,f:f}=this.wNAF(i),{p:l,f:d}=this.wNAF(c);u=y.constTimeNegate(t,u),l=y.constTimeNegate(a,l),l=new p(n.mul(l.px,r.beta),l.py,l.pz),o=u.add(l),s=f.add(d)}else{const{p:t,f:n}=this.wNAF(e);o=t,s=n}return p.normalizeZ([o,s])[0]}multiplyAndAddUnsafe(e,t,n){const r=p.BASE,i=(e,t)=>t!==Gs&&t!==Ks&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),o=i(this,t).add(i(e,n));return o.is0()?void 0:o}toAffine(e){return d(this,e)}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===Ks)return!0;if(n)return n(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===Ks?this:n?n(p,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return $o("isCompressed",e),this.assertValidity(),i(p,this,e)}toHex(e=!0){return $o("isCompressed",e),Fo(this.toRawBytes(e))}}p.BASE=new p(t.Gx,t.Gy,n.ONE),p.ZERO=new p(n.ZERO,n.ONE,n.ZERO);const{endo:g,nBitLength:m}=t,y=Vs(p,g?Math.ceil(m/2):m);return{CURVE:t,ProjectivePoint:p,normPrivateKeyToScalar:f,weierstrassEquation:s,isWithinCurveOrder:function(e){return Yo(e,Ks,t.n)}}}function Js(e,t){if(ws(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const n=function(e,t){const n=e.ORDER;let r=Gs;for(let e=n-Ks;e%Ws===Gs;e/=Ws)r+=Ks;const i=r,o=Ws<<i-Ks-Ks,s=o*Ws,a=(n-Ks)/s,c=(a-Ks)/Ws,u=s-Ks,f=o,l=e.pow(t,a),d=e.pow(t,(a+Ks)/Ws);let h=(t,n)=>{let r=l,o=e.pow(n,u),s=e.sqr(o);s=e.mul(s,n);let a=e.mul(t,s);a=e.pow(a,c),a=e.mul(a,o),o=e.mul(a,n),s=e.mul(a,t);let h=e.mul(s,o);a=e.pow(h,f);let p=e.eql(a,e.ONE);o=e.mul(s,d),a=e.mul(h,r),s=e.cmov(o,s,p),h=e.cmov(a,h,p);for(let t=i;t>Ks;t--){let n=t-Ws;n=Ws<<n-Ks;let i=e.pow(h,n);const a=e.eql(i,e.ONE);o=e.mul(s,r),r=e.mul(r,r),i=e.mul(h,r),s=e.cmov(o,s,a),h=e.cmov(i,h,a)}return{isValid:p,value:s}};if(e.ORDER%Ys===Zs){const n=(e.ORDER-Zs)/Ys,r=e.sqrt(e.neg(t));h=(t,i)=>{let o=e.sqr(i);const s=e.mul(t,i);o=e.mul(o,s);let a=e.pow(o,n);a=e.mul(a,s);const c=e.mul(a,r),u=e.mul(e.sqr(a),i),f=e.eql(u,t);return{isValid:f,value:e.cmov(c,a,f)}}}return h}(e,t.Z);if(!e.isOdd)throw new Error("Fp.isOdd is not implemented!");return r=>{let i,o,s,a,c,u,f,l;i=e.sqr(r),i=e.mul(i,t.Z),o=e.sqr(i),o=e.add(o,i),s=e.add(o,e.ONE),s=e.mul(s,t.B),a=e.cmov(t.Z,e.neg(o),!e.eql(o,e.ZERO)),a=e.mul(a,t.A),o=e.sqr(s),u=e.sqr(a),c=e.mul(u,t.A),o=e.add(o,c),o=e.mul(o,s),u=e.mul(u,a),c=e.mul(u,t.B),o=e.add(o,c),f=e.mul(i,s);const{isValid:d,value:h}=n(o,u);l=e.mul(i,r),l=e.mul(l,h),f=e.cmov(f,s,d),l=e.cmov(l,h,d);const p=e.isOdd(r)===e.isOdd(l);l=e.cmov(e.neg(l),l,p);const g=Es(e,[a],!0)[0];return f=e.mul(f,g),{x:f,y:l}}}const Qs=BigInt(0),ea=BigInt(1),ta=BigInt(2),na=BigInt(3);const ra=BigInt(0),ia=BigInt(1),oa=BigInt(2),sa=BigInt(3);function aa(e,t,n,r,i=1,o){const s=BigInt(void 0===o?r:o),a=n**BigInt(r),c=[];for(let o=0;o<i;o++){const i=BigInt(o+1),u=[];for(let o=0,c=ia;o<r;o++){const r=(i*c-i)/s%a;u.push(e.pow(t,r)),c*=n}c.push(u)}return c}const ca=BigInt(0),ua=BigInt(1),fa=BigInt(2),la=BigInt(3),da=BigInt(4),ha=BigInt("0xd201000000010000"),pa=Jo(ha),{Fp:ma,Fp2:ya,Fp6:ba,Fp4Square:wa,Fp12:va}=function(e){const{ORDER:t}=e,n=As(t),r=n.create(e.NONRESIDUE||BigInt(-1)),i=n.div(n.ONE,oa),o=aa(n,r,n.ORDER,2)[0],s=({c0:e,c1:t},{c0:r,c1:i})=>({c0:n.add(e,r),c1:n.add(t,i)}),a=({c0:e,c1:t},{c0:r,c1:i})=>({c0:n.sub(e,r),c1:n.sub(t,i)}),c=({c0:e,c1:t},r)=>{if("bigint"==typeof r)return{c0:n.mul(e,r),c1:n.mul(t,r)};const{c0:i,c1:o}=r;let s=n.mul(e,i),a=n.mul(t,o);return{c0:n.sub(s,a),c1:n.sub(n.mul(n.add(e,t),n.add(i,o)),n.add(s,a))}},u=({c0:e,c1:t})=>{const r=n.add(e,t),i=n.sub(e,t),o=n.add(e,e);return{c0:n.mul(r,i),c1:n.mul(o,t)}},f=e=>{if(2!==e.length)throw new Error("invalid tuple");const t=e.map((e=>n.create(e)));return{c0:t[0],c1:t[1]}},l=t*t,d=f(e.FP2_NONRESIDUE),h={ORDER:l,isLE:n.isLE,NONRESIDUE:d,BITS:Jo(l),BYTES:Math.ceil(Jo(l)/8),MASK:es(Jo(l)),ZERO:{c0:n.ZERO,c1:n.ZERO},ONE:{c0:n.ONE,c1:n.ZERO},create:e=>e,isValid:({c0:e,c1:t})=>"bigint"==typeof e&&"bigint"==typeof t,is0:({c0:e,c1:t})=>n.is0(e)&&n.is0(t),eql:({c0:e,c1:t},{c0:r,c1:i})=>n.eql(e,r)&&n.eql(t,i),neg:({c0:e,c1:t})=>({c0:n.neg(e),c1:n.neg(t)}),pow:(e,t)=>vs(h,e,t),invertBatch:e=>Es(h,e),add:s,sub:a,mul:c,sqr:u,addN:s,subN:a,mulN:c,sqrN:u,div:(e,t)=>h.mul(e,"bigint"==typeof t?n.inv(n.create(t)):h.inv(t)),inv:({c0:e,c1:t})=>{const r=n.inv(n.create(e*e+t*t));return{c0:n.mul(r,n.create(e)),c1:n.mul(r,n.create(-t))}},sqrt:t=>{if(e.Fp2sqrt)return e.Fp2sqrt(t);const{c0:o,c1:s}=t;if(n.is0(s))return 1===xs(n,o)?h.create({c0:n.sqrt(o),c1:n.ZERO}):h.create({c0:n.ZERO,c1:n.sqrt(n.div(o,r))});const a=n.sqrt(n.sub(n.sqr(o),n.mul(n.sqr(s),r)));let c=n.mul(n.add(a,o),i);-1===xs(n,c)&&(c=n.sub(c,a));const u=n.sqrt(c),f=h.create({c0:u,c1:n.div(n.mul(s,i),u)});if(!h.eql(h.sqr(f),t))throw new Error("Cannot find square root");const l=f,d=h.neg(l),{re:p,im:g}=h.reim(l),{re:m,im:y}=h.reim(d);return g>y||g===y&&p>m?l:d},isOdd:e=>{const{re:t,im:n}=h.reim(e);return BigInt(t%oa||t===ra&&n%oa)==ia},fromBytes(e){if(e.length!==h.BYTES)throw new Error("fromBytes invalid length="+e.length);return{c0:n.fromBytes(e.subarray(0,n.BYTES)),c1:n.fromBytes(e.subarray(n.BYTES))}},toBytes:({c0:e,c1:t})=>Ko(n.toBytes(e),n.toBytes(t)),cmov:({c0:e,c1:t},{c0:r,c1:i},o)=>({c0:n.cmov(e,r,o),c1:n.cmov(t,i,o)}),reim:({c0:e,c1:t})=>({re:e,im:t}),mulByNonresidue:({c0:e,c1:t})=>h.mul({c0:e,c1:t},d),mulByB:e.Fp2mulByB,fromBigTuple:f,frobeniusMap:({c0:e,c1:t},r)=>({c0:e,c1:n.mul(t,o[r%2])})},p=({c0:e,c1:t,c2:n},{c0:r,c1:i,c2:o})=>({c0:h.add(e,r),c1:h.add(t,i),c2:h.add(n,o)}),g=({c0:e,c1:t,c2:n},{c0:r,c1:i,c2:o})=>({c0:h.sub(e,r),c1:h.sub(t,i),c2:h.sub(n,o)}),m=({c0:e,c1:t,c2:n},r)=>{if("bigint"==typeof r)return{c0:h.mul(e,r),c1:h.mul(t,r),c2:h.mul(n,r)};const{c0:i,c1:o,c2:s}=r,a=h.mul(e,i),c=h.mul(t,o),u=h.mul(n,s);return{c0:h.add(a,h.mulByNonresidue(h.sub(h.mul(h.add(t,n),h.add(o,s)),h.add(c,u)))),c1:h.add(h.sub(h.mul(h.add(e,t),h.add(i,o)),h.add(a,c)),h.mulByNonresidue(u)),c2:h.sub(h.add(c,h.mul(h.add(e,n),h.add(i,s))),h.add(a,u))}},y=({c0:e,c1:t,c2:n})=>{let r=h.sqr(e),i=h.mul(h.mul(e,t),oa),o=h.mul(h.mul(t,n),oa),s=h.sqr(n);return{c0:h.add(h.mulByNonresidue(o),r),c1:h.add(h.mulByNonresidue(s),i),c2:h.sub(h.sub(h.add(h.add(i,h.sqr(h.add(h.sub(e,t),n))),o),r),s)}},[b,w]=aa(h,d,n.ORDER,6,2,3),v={ORDER:h.ORDER,isLE:h.isLE,BITS:3*h.BITS,BYTES:3*h.BYTES,MASK:es(3*h.BITS),ZERO:{c0:h.ZERO,c1:h.ZERO,c2:h.ZERO},ONE:{c0:h.ONE,c1:h.ZERO,c2:h.ZERO},create:e=>e,isValid:({c0:e,c1:t,c2:n})=>h.isValid(e)&&h.isValid(t)&&h.isValid(n),is0:({c0:e,c1:t,c2:n})=>h.is0(e)&&h.is0(t)&&h.is0(n),neg:({c0:e,c1:t,c2:n})=>({c0:h.neg(e),c1:h.neg(t),c2:h.neg(n)}),eql:({c0:e,c1:t,c2:n},{c0:r,c1:i,c2:o})=>h.eql(e,r)&&h.eql(t,i)&&h.eql(n,o),sqrt:rs,div:(e,t)=>v.mul(e,"bigint"==typeof t?n.inv(n.create(t)):v.inv(t)),pow:(e,t)=>vs(v,e,t),invertBatch:e=>Es(v,e),add:p,sub:g,mul:m,sqr:y,addN:p,subN:g,mulN:m,sqrN:y,inv:({c0:e,c1:t,c2:n})=>{let r=h.sub(h.sqr(e),h.mulByNonresidue(h.mul(n,t))),i=h.sub(h.mulByNonresidue(h.sqr(n)),h.mul(e,t)),o=h.sub(h.sqr(t),h.mul(e,n)),s=h.inv(h.add(h.mulByNonresidue(h.add(h.mul(n,i),h.mul(t,o))),h.mul(e,r)));return{c0:h.mul(s,r),c1:h.mul(s,i),c2:h.mul(s,o)}},fromBytes:e=>{if(e.length!==v.BYTES)throw new Error("fromBytes invalid length="+e.length);return{c0:h.fromBytes(e.subarray(0,h.BYTES)),c1:h.fromBytes(e.subarray(h.BYTES,2*h.BYTES)),c2:h.fromBytes(e.subarray(2*h.BYTES))}},toBytes:({c0:e,c1:t,c2:n})=>Ko(h.toBytes(e),h.toBytes(t),h.toBytes(n)),cmov:({c0:e,c1:t,c2:n},{c0:r,c1:i,c2:o},s)=>({c0:h.cmov(e,r,s),c1:h.cmov(t,i,s),c2:h.cmov(n,o,s)}),fromBigSix:e=>{if(!Array.isArray(e)||6!==e.length)throw new Error("invalid Fp6 usage");return{c0:h.fromBigTuple(e.slice(0,2)),c1:h.fromBigTuple(e.slice(2,4)),c2:h.fromBigTuple(e.slice(4,6))}},frobeniusMap:({c0:e,c1:t,c2:n},r)=>({c0:h.frobeniusMap(e,r),c1:h.mul(h.frobeniusMap(t,r),b[r%6]),c2:h.mul(h.frobeniusMap(n,r),w[r%6])}),mulByFp2:({c0:e,c1:t,c2:n},r)=>({c0:h.mul(e,r),c1:h.mul(t,r),c2:h.mul(n,r)}),mulByNonresidue:({c0:e,c1:t,c2:n})=>({c0:h.mulByNonresidue(n),c1:e,c2:t}),mul1:({c0:e,c1:t,c2:n},r)=>({c0:h.mulByNonresidue(h.mul(n,r)),c1:h.mul(e,r),c2:h.mul(t,r)}),mul01({c0:e,c1:t,c2:n},r,i){let o=h.mul(e,r),s=h.mul(t,i);return{c0:h.add(h.mulByNonresidue(h.sub(h.mul(h.add(t,n),i),s)),o),c1:h.sub(h.sub(h.mul(h.add(r,i),h.add(e,t)),o),s),c2:h.add(h.sub(h.mul(h.add(e,n),r),o),s)}}},E=aa(h,d,n.ORDER,12,1,6)[0],x=({c0:e,c1:t},{c0:n,c1:r})=>({c0:v.add(e,n),c1:v.add(t,r)}),_=({c0:e,c1:t},{c0:n,c1:r})=>({c0:v.sub(e,n),c1:v.sub(t,r)}),A=({c0:e,c1:t},n)=>{if("bigint"==typeof n)return{c0:v.mul(e,n),c1:v.mul(t,n)};let{c0:r,c1:i}=n,o=v.mul(e,r),s=v.mul(t,i);return{c0:v.add(o,v.mulByNonresidue(s)),c1:v.sub(v.mul(v.add(e,t),v.add(r,i)),v.add(o,s))}},T=({c0:e,c1:t})=>{let n=v.mul(e,t);return{c0:v.sub(v.sub(v.mul(v.add(v.mulByNonresidue(t),e),v.add(e,t)),n),v.mulByNonresidue(n)),c1:v.add(n,n)}},S={ORDER:h.ORDER,isLE:v.isLE,BITS:2*v.BITS,BYTES:2*v.BYTES,MASK:es(2*v.BITS),ZERO:{c0:v.ZERO,c1:v.ZERO},ONE:{c0:v.ONE,c1:v.ZERO},create:e=>e,isValid:({c0:e,c1:t})=>v.isValid(e)&&v.isValid(t),is0:({c0:e,c1:t})=>v.is0(e)&&v.is0(t),neg:({c0:e,c1:t})=>({c0:v.neg(e),c1:v.neg(t)}),eql:({c0:e,c1:t},{c0:n,c1:r})=>v.eql(e,n)&&v.eql(t,r),sqrt:rs,inv:({c0:e,c1:t})=>{let n=v.inv(v.sub(v.sqr(e),v.mulByNonresidue(v.sqr(t))));return{c0:v.mul(e,n),c1:v.neg(v.mul(t,n))}},div:(e,t)=>S.mul(e,"bigint"==typeof t?n.inv(n.create(t)):S.inv(t)),pow:(e,t)=>vs(S,e,t),invertBatch:e=>Es(S,e),add:x,sub:_,mul:A,sqr:T,addN:x,subN:_,mulN:A,sqrN:T,fromBytes:e=>{if(e.length!==S.BYTES)throw new Error("fromBytes invalid length="+e.length);return{c0:v.fromBytes(e.subarray(0,v.BYTES)),c1:v.fromBytes(e.subarray(v.BYTES))}},toBytes:({c0:e,c1:t})=>Ko(v.toBytes(e),v.toBytes(t)),cmov:({c0:e,c1:t},{c0:n,c1:r},i)=>({c0:v.cmov(e,n,i),c1:v.cmov(t,r,i)}),fromBigTwelve:e=>({c0:v.fromBigSix(e.slice(0,6)),c1:v.fromBigSix(e.slice(6,12))}),frobeniusMap(e,t){const{c0:n,c1:r,c2:i}=v.frobeniusMap(e.c1,t),o=E[t%12];return{c0:v.frobeniusMap(e.c0,t),c1:v.create({c0:h.mul(n,o),c1:h.mul(r,o),c2:h.mul(i,o)})}},mulByFp2:({c0:e,c1:t},n)=>({c0:v.mulByFp2(e,n),c1:v.mulByFp2(t,n)}),conjugate:({c0:e,c1:t})=>({c0:e,c1:v.neg(t)}),mul014:({c0:e,c1:t},n,r,i)=>{let o=v.mul01(e,n,r),s=v.mul1(t,i);return{c0:v.add(v.mulByNonresidue(s),o),c1:v.sub(v.sub(v.mul01(v.add(t,e),n,h.add(r,i)),o),s)}},mul034:({c0:e,c1:t},n,r,i)=>{const o=v.create({c0:h.mul(e.c0,n),c1:h.mul(e.c1,n),c2:h.mul(e.c2,n)}),s=v.mul01(t,r,i),a=v.mul01(v.add(e,t),h.add(n,r),i);return{c0:v.add(v.mulByNonresidue(s),o),c1:v.sub(a,v.add(o,s))}},_cyclotomicSquare:e.Fp12cyclotomicSquare,_cyclotomicExp:e.Fp12cyclotomicExp,finalExponentiate:e.Fp12finalExponentiate};return{Fp:n,Fp2:h,Fp6:v,Fp4Square:function(e,t){const n=h.sqr(e),r=h.sqr(t);return{first:h.add(h.mulByNonresidue(r),n),second:h.sub(h.sub(h.sqr(h.add(e,t)),n),r)}},Fp12:S}}({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[ua,ua],Fp2mulByB:({c0:e,c1:t})=>{const n=ma.mul(e,da),r=ma.mul(t,da);return{c0:ma.sub(n,r),c1:ma.add(n,r)}},Fp12cyclotomicSquare:({c0:e,c1:t})=>{const{c0:n,c1:r,c2:i}=e,{c0:o,c1:s,c2:a}=t,{first:c,second:u}=wa(n,s),{first:f,second:l}=wa(o,i),{first:d,second:h}=wa(r,a),p=ya.mulByNonresidue(h);return{c0:ba.create({c0:ya.add(ya.mul(ya.sub(c,n),fa),c),c1:ya.add(ya.mul(ya.sub(f,r),fa),f),c2:ya.add(ya.mul(ya.sub(d,i),fa),d)}),c1:ba.create({c0:ya.add(ya.mul(ya.add(p,o),fa),p),c1:ya.add(ya.mul(ya.add(u,s),fa),u),c2:ya.add(ya.mul(ya.add(l,a),fa),l)})}},Fp12cyclotomicExp(e,t){let n=va.ONE;for(let r=pa-1;r>=0;r--)n=va._cyclotomicSquare(n),Qo(t,r)&&(n=va.mul(n,e));return n},Fp12finalExponentiate:e=>{const t=ha,n=va.div(va.frobeniusMap(e,6),e),r=va.mul(va.frobeniusMap(n,2),n),i=va.conjugate(va._cyclotomicExp(r,t)),o=va.mul(va.conjugate(va._cyclotomicSquare(r)),i),s=va.conjugate(va._cyclotomicExp(o,t)),a=va.conjugate(va._cyclotomicExp(s,t)),c=va.mul(va.conjugate(va._cyclotomicExp(a,t)),va._cyclotomicSquare(i)),u=va.conjugate(va._cyclotomicExp(c,t)),f=va.frobeniusMap(va.mul(i,a),2),l=va.frobeniusMap(va.mul(s,r),3),d=va.frobeniusMap(va.mul(c,va.conjugate(r)),1),h=va.mul(va.mul(u,va.conjugate(o)),r);return va.mul(va.mul(va.mul(f,l),d),h)}}),Ea=As(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),xa=ks(ya,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map((e=>e.map((e=>ya.fromBigTuple(e.map(BigInt))))))),_a=ks(ma,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map((e=>e.map((e=>BigInt(e)))))),Aa=Js(ya,{A:ya.create({c0:ma.create(ca),c1:ma.create(BigInt(240))}),B:ya.create({c0:ma.create(BigInt(1012)),c1:ma.create(BigInt(1012))}),Z:ya.create({c0:ma.create(BigInt(-2)),c1:ma.create(BigInt(-1))})}),Ta=Js(ma,{A:ma.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:ma.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:ma.create(BigInt(11))}),{G2psi:Sa,G2psi2:Ba}=function(e,t,n){const r=t.pow(n,(e.ORDER-ia)/sa),i=t.pow(n,(e.ORDER-ia)/oa);function o(e,n){return[t.mul(t.frobeniusMap(e,1),r),t.mul(t.frobeniusMap(n,1),i)]}const s=t.pow(n,(e.ORDER**oa-ia)/sa),a=t.pow(n,(e.ORDER**oa-ia)/oa);if(!t.eql(a,t.neg(t.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function c(e,n){return[t.mul(e,s),t.neg(n)]}const u=e=>(t,n)=>{const r=n.toAffine(),i=e(r.x,r.y);return t.fromAffine({x:i[0],y:i[1]})};return{psi:o,psi2:c,G2psi:u(o),G2psi2:u(c),PSI_X:r,PSI_Y:i,PSI2_X:s,PSI2_Y:a}}(ma,ya,ya.div(ya.ONE,ya.NONRESIDUE)),Na=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:ma.ORDER,m:2,k:128,expand:"xmd",hash:Ut}),Oa=Ra(ma.toBytes(ca),{infinity:!0,compressed:!0});function Ia(e){const t=224&(e=e.slice())[0],n=!!(t>>7&1),r=!!(t>>6&1),i=!!(t>>5&1);return e[0]&=31,{compressed:n,infinity:r,sort:i,value:e}}function Ra(e,t){if(224&e[0])throw new Error("setMask: non-empty mask");return t.compressed&&(e[0]|=128),t.infinity&&(e[0]|=64),t.sort&&(e[0]|=32),e}function ka(e){e.assertValidity();const t=e.equals($a.G1.ProjectivePoint.ZERO),{x:n,y:r}=e.toAffine();if(t)return Oa.slice();const i=ma.ORDER,o=Boolean(r*fa/i);return Ra(zo(n,ma.BYTES),{compressed:!0,sort:o})}function La(e){e.assertValidity();const t=ma.BYTES;if(e.equals($a.G2.ProjectivePoint.ZERO))return Ko(Oa,zo(ca,t));const{x:n,y:r}=e.toAffine(),{re:i,im:o}=ya.reim(n),{re:s,im:a}=ya.reim(r),c=Boolean((a>ca?a*fa:s*fa)/ma.ORDER&ua),u=i;return Ko(Ra(zo(o,t),{sort:c,compressed:!0}),zo(u,t))}const $a=function(e){const{Fp:t,Fr:n,Fp2:r,Fp6:i,Fp12:o}=e.fields,s=e.params.xNegative,a=e.params.twistType,c=Xs({n:n.ORDER,...e.G1}),u=Object.assign(c,Ls(c.ProjectivePoint,e.G1.mapToCurve,{...e.htfDefaults,...e.G1.htfDefaults})),f=Xs({n:n.ORDER,...e.G2}),l=Object.assign(f,Ls(f.ProjectivePoint,e.G2.mapToCurve,{...e.htfDefaults,...e.G2.htfDefaults}));let d;if("multiplicative"===a)d=(e,t,n,i,s,a)=>o.mul014(i,e,r.mul(t,s),r.mul(n,a));else{if("divisive"!==a)throw new Error("bls: unknown twist type");d=(e,t,n,i,s,a)=>o.mul034(i,r.mul(n,a),r.mul(t,s),e)}const h=r.div(r.ONE,r.mul(r.ONE,ta));function p(e,t,n,i){const o=r.sqr(n),s=r.sqr(i),a=r.mulByB(r.mul(s,na)),c=r.mul(a,na),u=r.sub(r.sub(r.sqr(r.add(n,i)),s),o),f=r.sub(a,o),l=r.mul(r.sqr(t),na),d=r.neg(u);return e.push([f,l,d]),{Rx:t=r.mul(r.mul(r.mul(r.sub(o,c),t),n),h),Ry:n=r.sub(r.sqr(r.mul(r.add(o,c),h)),r.mul(r.sqr(a),na)),Rz:i=r.mul(o,u)}}function g(e,t,n,i,o,s){const a=r.sub(n,r.mul(s,i)),c=r.sub(t,r.mul(o,i)),u=r.sub(r.mul(a,o),r.mul(c,s)),f=r.neg(a),l=c;e.push([u,f,l]);const d=r.sqr(c),h=r.mul(d,c),p=r.mul(d,t),g=r.add(r.sub(h,r.mul(p,ta)),r.mul(r.sqr(a),i));return{Rx:t=r.mul(c,g),Ry:n=r.sub(r.mul(r.sub(p,g),a),r.mul(h,n)),Rz:i=r.mul(i,h)}}const m=function(e){const t=[];for(;e>ea;e>>=ea)(e&ea)===Qs?t.unshift(0):(e&na)===na?(t.unshift(-1),e+=ea):t.unshift(1);return t}(e.params.ateLoopSize),y=is((t=>{const n=t,{x:i,y:o}=n.toAffine(),s=i,a=o,c=r.neg(o);let u=s,f=a,l=r.ONE;const d=[];for(const e of m){const t=[];({Rx:u,Ry:f,Rz:l}=p(t,u,f,l)),e&&({Rx:u,Ry:f,Rz:l}=g(t,u,f,l,s,-1===e?c:a)),d.push(t)}if(e.postPrecompute){const t=d[d.length-1];e.postPrecompute(u,f,l,s,a,g.bind(null,t))}return d}));function b(e,t=!1){let n=o.ONE;if(e.length){const t=e[0][0].length;for(let r=0;r<t;r++){n=o.sqr(n);for(const[t,i,o]of e)for(const[e,s,a]of t[r])n=d(e,s,a,n,i,o)}}return s&&(n=o.conjugate(n)),t?o.finalExponentiate(n):n}function w(e,t=!0){const n=[];u.ProjectivePoint.normalizeZ(e.map((({g1:e})=>e))),l.ProjectivePoint.normalizeZ(e.map((({g2:e})=>e)));for(const{g1:t,g2:r}of e){if(t.equals(u.ProjectivePoint.ZERO)||r.equals(l.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");t.assertValidity(),r.assertValidity();const e=t.toAffine();n.push([y(r),e.x,e.y])}return b(n,t)}const v={randomPrivateKey:()=>{const t=Ss(n.ORDER);return function(e,t,n=!1){const r=e.length,i=Ts(t),o=Ss(t);if(r<16||r<o||r>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+r);const s=ds(n?Vo(e):qo(e),t-ss)+ss;return n?Ho(s,i):zo(s,i)}(e.randomBytes(t),n.ORDER)},calcPairingPrecomputes:y},{ShortSignature:E}=e.G1,{Signature:x}=e.G2;function _(e){return e instanceof u.ProjectivePoint?e:u.ProjectivePoint.fromHex(e)}function A(e,t){return e instanceof u.ProjectivePoint?e:u.hashToCurve(Go("point",e),t)}function T(e){return e instanceof l.ProjectivePoint?e:x.fromHex(e)}function S(e,t){return e instanceof l.ProjectivePoint?e:l.hashToCurve(Go("point",e),t)}function B(e){if(!Array.isArray(e)||0===e.length)throw new Error("expected non-empty array")}return u.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:function(e){return u.ProjectivePoint.fromPrivateKey(e).toRawBytes(!0)},getPublicKeyForShortSignatures:function(e){return l.ProjectivePoint.fromPrivateKey(e).toRawBytes(!0)},sign:function(e,t,n){const r=S(e,n);r.assertValidity();const i=r.multiply(u.normPrivateKeyToScalar(t));return e instanceof l.ProjectivePoint?i:x.toRawBytes(i)},signShortSignature:function(e,t,n){const r=A(e,n);r.assertValidity();const i=r.multiply(u.normPrivateKeyToScalar(t));return e instanceof u.ProjectivePoint?i:E.toRawBytes(i)},verify:function(e,t,n,r){const i=_(n),s=S(t,r),a=u.ProjectivePoint.BASE,c=T(e),f=w([{g1:i.negate(),g2:s},{g1:a,g2:c}]);return o.eql(f,o.ONE)},verifyBatch:function(e,t,n,r){if(B(t),n.length!==t.length)throw new Error("amount of public keys and messages should be equal");const i=T(e),s=t.map((e=>S(e,r))),a=n.map(_),c=new Map;for(let e=0;e<a.length;e++){const t=a[e],n=s[e];let r=c.get(n);void 0===r&&(r=[],c.set(n,r)),r.push(t)}const f=[];try{for(const[e,t]of c){const n=t.reduce(((e,t)=>e.add(t)));f.push({g1:n,g2:e})}return f.push({g1:u.ProjectivePoint.BASE.negate(),g2:i}),o.eql(w(f),o.ONE)}catch{return!1}},verifyShortSignature:function(e,t,n,r){const i=T(n),s=A(t,r),a=l.ProjectivePoint.BASE,c=w([{g1:s,g2:i},{g1:_(e),g2:a.negate()}]);return o.eql(c,o.ONE)},aggregatePublicKeys:function(e){B(e);const t=e.map(_).reduce(((e,t)=>e.add(t)),u.ProjectivePoint.ZERO);return e[0]instanceof u.ProjectivePoint?(t.assertValidity(),t):t.toRawBytes(!0)},aggregateSignatures:function(e){B(e);const t=e.map(T).reduce(((e,t)=>e.add(t)),l.ProjectivePoint.ZERO);return e[0]instanceof l.ProjectivePoint?(t.assertValidity(),t):x.toRawBytes(t)},aggregateShortSignatures:function(e){B(e);const t=e.map(_).reduce(((e,t)=>e.add(t)),u.ProjectivePoint.ZERO);return e[0]instanceof u.ProjectivePoint?(t.assertValidity(),t):E.toRawBytes(t)},millerLoopBatch:b,pairing:function(e,t,n=!0){return w([{g1:e,g2:t}],n)},pairingBatch:w,G1:u,G2:l,Signature:x,ShortSignature:E,fields:{Fr:n,Fp:t,Fp2:r,Fp6:i,Fp12:o},params:{ateLoopSize:e.params.ateLoopSize,r:e.params.r,G1b:e.G1.b,G2b:e.G2.b},utils:v}}({fields:{Fp:ma,Fp2:ya,Fp6:ba,Fp12:va,Fr:Ea},G1:{Fp:ma,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:ma.ZERO,b:da,htfDefaults:{...Na,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(e,t)=>{const n=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),r=new e(ma.mul(t.px,n),t.py,t.pz);return t.multiplyUnsafe(ha).negate().multiplyUnsafe(ha).equals(r)},clearCofactor:(e,t)=>t.multiplyUnsafe(ha).add(t),mapToCurve:e=>{const{x:t,y:n}=Ta(ma.create(e[0]));return _a(t,n)},fromBytes:e=>{const{compressed:t,infinity:n,sort:r,value:i}=Ia(e);if(48===i.length&&t){const e=ma.ORDER,t=qo(i),o=ma.create(t&ma.MASK);if(n){if(o!==ca)throw new Error("G1: non-empty compressed point at infinity");return{x:ca,y:ca}}const s=ma.add(ma.pow(o,la),ma.create($a.params.G1b));let a=ma.sqrt(s);if(!a)throw new Error("invalid compressed G1 point");return a*fa/e!==BigInt(r)&&(a=ma.neg(a)),{x:ma.create(o),y:ma.create(a)}}if(96!==i.length||t)throw new Error("invalid point G1, expected 48/96 bytes");{const e=qo(i.subarray(0,ma.BYTES)),t=qo(i.subarray(ma.BYTES));if(n){if(e!==ca||t!==ca)throw new Error("G1: non-empty point at infinity");return $a.G1.ProjectivePoint.ZERO.toAffine()}return{x:ma.create(e),y:ma.create(t)}}},toBytes:(e,t,n)=>{const r=t.equals(e.ZERO),{x:i,y:o}=t.toAffine();if(n){if(r)return Oa.slice();const e=ma.ORDER,t=Boolean(o*fa/e);return Ra(zo(i,ma.BYTES),{compressed:!0,sort:t})}if(r){return Ko(new Uint8Array([64]),new Uint8Array(2*ma.BYTES-1))}return Ko(zo(i,ma.BYTES),zo(o,ma.BYTES))},ShortSignature:{fromHex(e){const{infinity:t,sort:n,value:r}=Ia(Go("signatureHex",e,48)),i=ma.ORDER,o=qo(r);if(t)return $a.G1.ProjectivePoint.ZERO;const s=ma.create(o&ma.MASK),a=ma.add(ma.pow(s,la),ma.create($a.params.G1b));let c=ma.sqrt(a);if(!c)throw new Error("invalid compressed G1 point");const u=BigInt(n);c*fa/i!==u&&(c=ma.neg(c));const f=$a.G1.ProjectivePoint.fromAffine({x:s,y:c});return f.assertValidity(),f},toRawBytes:e=>ka(e),toHex:e=>Fo(ka(e))}},G2:{Fp:ya,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:ya.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:ya.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:ya.ZERO,b:ya.fromBigTuple([da,da]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...Na},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:e=>{const{x:t,y:n}=Aa(ya.fromBigTuple(e));return xa(t,n)},isTorsionFree:(e,t)=>t.multiplyUnsafe(ha).negate().equals(Sa(e,t)),clearCofactor:(e,t)=>{const n=ha;let r=t.multiplyUnsafe(n).negate(),i=Sa(e,t),o=t.double();o=Ba(e,o),o=o.subtract(i),i=r.add(i),i=i.multiplyUnsafe(n).negate(),o=o.add(i),o=o.subtract(r);return o.subtract(t)},fromBytes:e=>{const{compressed:t,infinity:n,sort:r,value:i}=Ia(e);if(!t&&!n&&r||!t&&n&&r||r&&n&&t)throw new Error("invalid encoding flag: "+(224&e[0]));const o=ma.BYTES,s=(e,t,n)=>qo(e.slice(t,n));if(96===i.length&&t){const e=$a.params.G2b,t=ma.ORDER;if(n){if(i.reduce(((e,t)=>0!==e?t+1:t),0)>0)throw new Error("invalid compressed G2 point");return{x:ya.ZERO,y:ya.ZERO}}const a=s(i,0,o),c=s(i,o,2*o),u=ya.create({c0:ma.create(c),c1:ma.create(a)}),f=ya.add(ya.pow(u,la),e);let l=ya.sqrt(f);const d=l.c1===ca?l.c0*fa/t:l.c1*fa/t?ua:ca;return l=r&&d>0?l:ya.neg(l),{x:u,y:l}}if(192!==i.length||t)throw new Error("invalid point G2, expected 96/192 bytes");{if(n){if(i.reduce(((e,t)=>0!==e?t+1:t),0)>0)throw new Error("invalid uncompressed G2 point");return{x:ya.ZERO,y:ya.ZERO}}const e=s(i,0,o),t=s(i,o,2*o),r=s(i,2*o,3*o),a=s(i,3*o,4*o);return{x:ya.fromBigTuple([t,e]),y:ya.fromBigTuple([a,r])}}},toBytes:(e,t,n)=>{const{BYTES:r,ORDER:i}=ma,o=t.equals(e.ZERO),{x:s,y:a}=t.toAffine();if(n){if(o)return Ko(Oa,zo(ca,r));const e=Boolean(a.c1===ca?a.c0*fa/i:a.c1*fa/i);return Ko(Ra(zo(s.c1,r),{compressed:!0,sort:e}),zo(s.c0,r))}{if(o)return Ko(new Uint8Array([64]),new Uint8Array(4*r-1));const{re:e,im:t}=ya.reim(s),{re:n,im:i}=ya.reim(a);return Ko(zo(t,r),zo(e,r),zo(i,r),zo(n,r))}},Signature:{fromHex(e){const{infinity:t,sort:n,value:r}=Ia(Go("signatureHex",e)),i=ma.ORDER,o=r.length/2;if(48!==o&&96!==o)throw new Error("invalid compressed signature length, must be 96 or 192");const s=qo(r.slice(0,o)),a=qo(r.slice(o));if(t)return $a.G2.ProjectivePoint.ZERO;const c=ma.create(s&ma.MASK),u=ma.create(a),f=ya.create({c0:u,c1:c}),l=ya.add(ya.pow(f,la),$a.params.G2b);let d=ya.sqrt(l);if(!d)throw new Error("Failed to find a square root");const{re:h,im:p}=ya.reim(d),g=BigInt(n);(p>ca&&p*fa/i!==g||p===ca&&h*fa/i!==g)&&(d=ya.neg(d));const m=$a.G2.ProjectivePoint.fromAffine({x:f,y:d});return m.assertValidity(),m},toRawBytes:e=>La(e),toHex:e=>Fo(La(e))}},params:{ateLoopSize:ha,r:Ea.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:Na,hash:Ut,randomBytes:rt});function Pa(e,t,n){const r="string"==typeof e?e:zt(e),i="string"==typeof t?t:zt(t),o="string"==typeof n?n:zt(n);return $a.verifyShortSignature(i,o,r)}const Ua=e=>cn(new Qt(e)),Da=e=>{const t=Ua(e);return new Date(Number(t)/1e6)};var Fa,Ca,Ma=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},ja=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class qa extends Xt{constructor(e){super(`Invalid certificate: ${e}`)}}!function(e){e[e.Empty=0]="Empty",e[e.Fork=1]="Fork",e[e.Labeled=2]="Labeled",e[e.Leaf=3]="Leaf",e[e.Pruned=4]="Pruned"}(Ca||(Ca={}));class Va{constructor(e,t,n,r,i=5,o=!1){this._rootKey=t,this._canisterId=n,this._blsVerify=r,this._maxAgeInMinutes=i,Fa.set(this,!1),Ma(this,Fa,o,"f"),this.cert=bo(new Uint8Array(e))}static async create(e){const t=Va.createUnverified(e);return await t.verify(),t}static createUnverified(e){let t=e.blsVerify;return t||(t=Pa),new Va(e.certificate,e.rootKey,e.canisterId,t,e.maxAgeInMinutes,e.disableTimeVerification)}lookup(e){return Xa(e,this.cert.tree)}lookup_label(e){return this.lookup([e])}async verify(){const e=await Ka(this.cert.tree),t=await this._checkDelegationAndGetKey(this.cert.delegation),n=this.cert.signature,r=function(e){const t=za.byteLength+Ha;if(e.byteLength!==t)throw new TypeError(`BLS DER-encoded public key must be ${t} bytes long`);const n=e.slice(0,za.byteLength);if(!Wt(n,za))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${za}, but get ${n}`);return e.slice(za.byteLength)}(t),i=Vt(Wa("ic-state-root"),e);let o=!1;const s=Ga(this.lookup(["time"]));if(!s)throw new qa("Certificate does not contain a time");if(!ja(this,Fa,"f")){const e=3e5,t=60*this._maxAgeInMinutes*1e3,n=Date.now(),r=n-t,i=n+e,o=Da(s);if(o.getTime()<r)throw new qa(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+o.toISOString()+" Current time: "+new Date(n).toISOString());if(o.getTime()>i)throw new qa("Certificate is signed more than 5 minutes in the future. Certificate time: "+o.toISOString()+" Current time: "+new Date(n).toISOString())}try{o=await this._blsVerify(new Uint8Array(r),new Uint8Array(n),new Uint8Array(i))}catch(e){o=!1}if(!o)throw new qa("Signature verification failed")}async _checkDelegationAndGetKey(e){if(!e)return this._rootKey;const t=await Va.createUnverified({certificate:e.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(t.cert.delegation)throw new qa("Delegation certificates cannot be nested");if(await t.verify(),this._canisterId.toString()!==Pu){if(!ec({canisterId:this._canisterId,subnetId:qt.fromUint8Array(new Uint8Array(e.subnet_id)),tree:t.cert.tree}))throw new qa(`Canister ${this._canisterId} not in range of delegations for subnet 0x${zt(e.subnet_id)}`)}const n=Ga(t.lookup(["subnet",e.subnet_id,"public_key"]));if(!n)throw new Error(`Could not find subnet key for subnet 0x${zt(e.subnet_id)}`);return n}}Fa=new WeakMap;const za=Gt("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),Ha=96;function Ga(e){if(e.status===Za.Found)return e.value instanceof ArrayBuffer?e.value:e.value instanceof Uint8Array?e.value.buffer:void 0}async function Ka(e){switch(e[0]){case Ca.Empty:return Ii(Wa("ic-hashtree-empty"));case Ca.Pruned:return e[1];case Ca.Leaf:return Ii(Vt(Wa("ic-hashtree-leaf"),e[1]));case Ca.Labeled:return Ii(Vt(Wa("ic-hashtree-labeled"),e[1],await Ka(e[2])));case Ca.Fork:return Ii(Vt(Wa("ic-hashtree-fork"),await Ka(e[1]),await Ka(e[2])));default:throw new Error("unreachable")}}function Wa(e){return Vt(new Uint8Array([e.length]),(new TextEncoder).encode(e))}var Za,Ya;function Xa(e,t){if(0===e.length){if(t[0]===Ca.Leaf){if(!t[1])throw new Error("Invalid tree structure for leaf");return t[1]instanceof ArrayBuffer?{status:Za.Found,value:t[1]}:t[1]instanceof Uint8Array?{status:Za.Found,value:t[1].buffer}:{status:Za.Found,value:t[1]}}return{status:Za.Found,value:t}}const n=Qa("string"==typeof e[0]?(new TextEncoder).encode(e[0]):e[0],t);switch(n.status){case Za.Found:return Xa(e.slice(1),n.value);case Ya.Greater:case Ya.Less:return{status:Za.Absent};default:return n}}function Ja(e){switch(e[0]){case Ca.Empty:return[];case Ca.Fork:return Ja(e[1]).concat(Ja(e[2]));default:return[e]}}function Qa(e,t){switch(t[0]){case Ca.Labeled:return function(e,t){const n=new Uint8Array(e),r=new Uint8Array(t);for(let e=0;e<n.length;e++)if(n[e]>r[e])return!0;return!1}(e,t[1])?{status:Ya.Greater}:Wt(e,t[1])?{status:Za.Found,value:t[2]}:{status:Ya.Less};case Ca.Fork:const n=Qa(e,t[1]);switch(n.status){case Ya.Greater:{const n=Qa(e,t[2]);return n.status===Ya.Less?{status:Za.Absent}:n}case Za.Unknown:{let n=Qa(e,t[2]);return n.status===Ya.Less?{status:Za.Unknown}:n}default:return n}case Ca.Pruned:return{status:Za.Unknown};default:return{status:Za.Absent}}}function ec(e){const{canisterId:t,subnetId:n,tree:r}=e,i=Xa(["subnet",n.toUint8Array(),"canister_ranges"],r);if(i.status!==Za.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${n}`);return bo(i.value).map((e=>[qt.fromUint8Array(e[0]),qt.fromUint8Array(e[1])])).some((e=>e[0].ltEq(t)&&e[1].gtEq(t)))}!function(e){e.Unknown="unknown",e.Absent="absent",e.Found="found"}(Za||(Za={})),function(e){e.Less="less",e.Greater="greater"}(Ya||(Ya={}));const tc=async e=>{const{agent:t,paths:n}=e,r=qt.from(e.canisterId),i=[...new Set(n)],o=i.map((e=>rc(e,r))),s=new Map,a=i.map(((e,n)=>(async()=>{var a;try{const e=await t.readState(r,{paths:[o[n]]});if(null==t.rootKey)throw new Error("Agent is missing root key");const a=await Va.create({certificate:e.certificate,rootKey:t.rootKey,canisterId:r,disableTimeVerification:!0}),c=(n,i)=>{if("subnet"===i){if(null==t.rootKey)throw new Error("Agent is missing root key");return{path:i,data:nc(e.certificate,r,t.rootKey)}}return{path:i,data:Ga(n.lookup(rc(i,r)))}},{path:u,data:f}=c(a,i[n]);if(f)switch(u){case"time":s.set(u,Da(f));break;case"controllers":s.set(u,ac(f));break;case"module_hash":s.set(u,ic(f));break;case"subnet":s.set(u,f);break;case"candid":s.set(u,(new TextDecoder).decode(f));break;default:if("string"!=typeof u&&"key"in u&&"path"in u)switch(u.decodeStrategy){case"raw":s.set(u.key,f);break;case"leb128":s.set(u.key,Ua(f));break;case"cbor":s.set(u.key,oc(f));break;case"hex":s.set(u.key,ic(f));break;case"utf-8":s.set(u.key,sc(f))}}else console.warn(`Expected to find result for path ${u}, but instead found nothing.`),"string"==typeof u?s.set(u,null):s.set(u.key,null)}catch(t){if(null===(a=null==t?void 0:t.message)||void 0===a?void 0:a.includes("Invalid certificate"))throw new Xt(t.message);"string"!=typeof e&&"key"in e&&"path"in e?s.set(e.key,null):s.set(e,null),console.group(),console.warn(`Expected to find result for path ${e}, but instead found nothing.`),console.warn(t),console.groupEnd()}})()));return await Promise.all(a),s},nc=(e,t,n)=>{if(!t._isPrincipal)throw new Error("Invalid canisterId");const r=bo(new Uint8Array(e)),i=r.tree;let o,s=r.delegation;s&&s.subnet_id?o=qt.fromUint8Array(new Uint8Array(s.subnet_id)):s||void 0===n?(o=qt.selfAuthenticating(qt.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),s={subnet_id:o.toUint8Array(),certificate:new ArrayBuffer(0)}):(o=qt.selfAuthenticating(new Uint8Array(n)),s={subnet_id:o.toUint8Array(),certificate:new ArrayBuffer(0)});if(!ec({canisterId:t,subnetId:o,tree:i}))throw new Error("Canister not in range");const a=Xa(["subnet",s.subnet_id,"node"],i);if(a.status!==Za.Found)throw new Error("Node not found");if(a.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const c=Ja(a.value),u=new Map;return c.forEach((e=>{const t=qt.from(new Uint8Array(e[1])).toText(),n=Xa(["public_key"],e[2]);if(n.status!==Za.Found)throw new Error("Public key not found");const r=n.value;if(44!==r.byteLength)throw new Error("Invalid public key length");u.set(t,r)})),{subnetId:qt.fromUint8Array(new Uint8Array(s.subnet_id)).toText(),nodeKeys:u}},rc=(e,t)=>{const n=new TextEncoder,r=e=>new DataView(n.encode(e).buffer).buffer,i=new DataView(t.toUint8Array().buffer).buffer;switch(e){case"time":return[r("time")];case"controllers":return[r("canister"),i,r("controllers")];case"module_hash":return[r("canister"),i,r("module_hash")];case"subnet":return[r("subnet")];case"candid":return[r("canister"),i,r("metadata"),r("candid:service")];default:if("key"in e&&"path"in e){if("string"==typeof e.path||e.path instanceof ArrayBuffer){const t=e.path,n="string"==typeof t?r(t):t;return[r("canister"),i,r("metadata"),n]}return e.path}}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${e} was formatted correctly.`)},ic=e=>zt(e),oc=e=>bo(e),sc=e=>(new TextDecoder).decode(e),ac=e=>oc(e).map((e=>qt.fromUint8Array(new Uint8Array(e))));var cc=Object.freeze({__proto__:null,CustomPath:class{constructor(e,t,n){this.key=e,this.path=t,this.decodeStrategy=n}},encodePath:rc,fetchNodeKeys:nc,request:tc});const uc=BigInt(0),fc=BigInt(1),lc=BigInt(2),dc=BigInt(8),hc={zip215:!0};function pc(e){const t=function(e){const t=Hs(e);return ns(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:n,n:r,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=t,u=lc<<BigInt(8*a)-fc,f=n.create,l=As(t.n,t.nBitLength);if(!function(e,r){const i=n.sqr(e),o=n.sqr(r),s=n.add(n.mul(t.a,i),o),a=n.add(n.ONE,n.mul(t.d,n.mul(i,o)));return n.eql(s,a)}(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const d=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:n.sqrt(e*n.inv(t))}}catch(e){return{isValid:!1,value:uc}}}),h=t.adjustScalarBytes||(e=>e),p=t.domain||((e,t,n)=>{if($o("phflag",n),t.length||n)throw new Error("Contexts/pre-hash are not supported");return e});function g(e,t,n=!1){Xo("coordinate "+e,t,n?fc:uc,u)}function m(e){if(!(e instanceof w))throw new Error("ExtendedPoint expected")}const y=is(((e,t)=>{const{ex:r,ey:i,ez:o}=e,s=e.is0();null==t&&(t=s?dc:n.inv(o));const a=f(r*t),c=f(i*t),u=f(o*t);if(s)return{x:uc,y:fc};if(u!==fc)throw new Error("invZ was invalid");return{x:a,y:c}})),b=is((e=>{const{a:n,d:r}=t;if(e.is0())throw new Error("bad point: ZERO");const{ex:i,ey:o,ez:s,et:a}=e,c=f(i*i),u=f(o*o),l=f(s*s),d=f(l*l),h=f(c*n);if(f(l*f(h+u))!==f(d+f(r*f(c*u))))throw new Error("bad point: equation left != right (1)");if(f(i*o)!==f(s*a))throw new Error("bad point: equation left != right (2)");return!0}));class w{constructor(e,t,n,r){g("x",e),g("y",t),g("z",n,!0),g("t",r),this.ex=e,this.ey=t,this.ez=n,this.et=r,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof w)throw new Error("extended point not allowed");const{x:t,y:n}=e||{};return g("x",t),g("y",n),new w(t,n,fc,f(t*n))}static normalizeZ(e){const t=Es(n,e.map((e=>e.ez)));return e.map(((e,n)=>e.toAffine(t[n]))).map(w.fromAffine)}static msm(e,t){return zs(w,l,e,t)}_setWindowSize(e){x.setWindowSize(this,e)}assertValidity(){b(this)}equals(e){m(e);const{ex:t,ey:n,ez:r}=this,{ex:i,ey:o,ez:s}=e,a=f(t*s),c=f(i*r),u=f(n*s),l=f(o*r);return a===c&&u===l}is0(){return this.equals(w.ZERO)}negate(){return new w(f(-this.ex),this.ey,this.ez,f(-this.et))}double(){const{a:e}=t,{ex:n,ey:r,ez:i}=this,o=f(n*n),s=f(r*r),a=f(lc*f(i*i)),c=f(e*o),u=n+r,l=f(f(u*u)-o-s),d=c+s,h=d-a,p=c-s,g=f(l*h),m=f(d*p),y=f(l*p),b=f(h*d);return new w(g,m,b,y)}add(e){m(e);const{a:n,d:r}=t,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:u,ez:l,et:d}=e,h=f(i*c),p=f(o*u),g=f(a*r*d),y=f(s*l),b=f((i+o)*(c+u)-h-p),v=y-g,E=y+g,x=f(p-n*h),_=f(b*v),A=f(E*x),T=f(b*x),S=f(v*E);return new w(_,A,S,T)}subtract(e){return this.add(e.negate())}wNAF(e){return x.wNAFCached(this,e,w.normalizeZ)}multiply(e){const t=e;Xo("scalar",t,fc,r);const{p:n,f:i}=this.wNAF(t);return w.normalizeZ([n,i])[0]}multiplyUnsafe(e,t=w.ZERO){const n=e;return Xo("scalar",n,uc,r),n===uc?E:this.is0()||n===fc?this:x.wNAFCachedUnsafe(this,n,w.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return x.unsafeLadder(this,r).is0()}toAffine(e){return y(this,e)}clearCofactor(){const{h:e}=t;return e===fc?this:this.multiplyUnsafe(e)}static fromHex(e,r=!1){const{d:i,a:o}=t,s=n.BYTES;e=Go("pointHex",e,s),$o("zip215",r);const a=e.slice(),c=e[s-1];a[s-1]=-129&c;const l=Vo(a),h=r?u:n.ORDER;Xo("pointHex.y",l,uc,h);const p=f(l*l),g=f(p-fc),m=f(i*p-o);let{isValid:y,value:b}=d(g,m);if(!y)throw new Error("Point.fromHex: invalid y coordinate");const v=(b&fc)===fc,E=0!=(128&c);if(!r&&b===uc&&E)throw new Error("Point.fromHex: x=0 and x_0=1");return E!==v&&(b=f(-b)),w.fromAffine({x:b,y:l})}static fromPrivateKey(e){const{scalar:t}=T(e);return v.multiply(t)}toRawBytes(){const{x:e,y:t}=this.toAffine(),r=Ho(t,n.BYTES);return r[r.length-1]|=e&fc?128:0,r}toHex(){return Fo(this.toRawBytes())}}w.BASE=new w(t.Gx,t.Gy,fc,f(t.Gx*t.Gy)),w.ZERO=new w(uc,fc,fc,uc);const{BASE:v,ZERO:E}=w,x=Vs(w,8*a);function _(e){return ds(e,r)}function A(e){return _(Vo(e))}function T(e){const t=n.BYTES;e=Go("private key",e,t);const r=Go("hashed private key",o(e),2*t),i=h(r.slice(0,t));return{head:i,prefix:r.slice(t,2*t),scalar:A(i)}}function S(e){const{head:t,prefix:n,scalar:r}=T(e),i=v.multiply(r),o=i.toRawBytes();return{head:t,prefix:n,scalar:r,point:i,pointBytes:o}}function B(e=Uint8Array.of(),...t){const n=Ko(...t);return A(o(p(n,Go("context",e),!!i)))}const N=hc;v._setWindowSize(8);return{CURVE:t,getPublicKey:function(e){return S(e).pointBytes},sign:function(e,t,o={}){e=Go("message",e),i&&(e=i(e));const{prefix:s,scalar:a,pointBytes:c}=S(t),u=B(o.context,s,e),f=v.multiply(u).toRawBytes(),l=_(u+B(o.context,f,c,e)*a);return Xo("signature.s",l,uc,r),Go("result",Ko(f,Ho(l,n.BYTES)),2*n.BYTES)},verify:function(e,t,r,o=N){const{context:s,zip215:a}=o,c=n.BYTES;e=Go("signature",e,2*c),t=Go("message",t),r=Go("publicKey",r,c),void 0!==a&&$o("zip215",a),i&&(t=i(t));const u=Vo(e.slice(c,2*c));let f,l,d;try{f=w.fromHex(r,a),l=w.fromHex(e.slice(0,c),a),d=v.multiplyUnsafe(u)}catch(e){return!1}if(!a&&f.isSmallOrder())return!1;const h=B(s,l.toRawBytes(),f.toRawBytes(),t);return l.add(f.multiplyUnsafe(h)).subtract(d).clearCofactor().equals(w.ZERO)},ExtendedPoint:w,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>s(n.BYTES),precompute:(e=8,t=w.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}const gc=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),mc=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const yc=BigInt(1),bc=BigInt(2);BigInt(3);const wc=BigInt(5),vc=BigInt(8);function Ec(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function xc(e,t){const n=gc,r=ds(t*t*t,n),i=function(e){const t=BigInt(10),n=BigInt(20),r=BigInt(40),i=BigInt(80),o=gc,s=e*e%o*e%o,a=hs(s,bc,o)*s%o,c=hs(a,yc,o)*e%o,u=hs(c,wc,o)*c%o,f=hs(u,t,o)*u%o,l=hs(f,n,o)*f%o,d=hs(l,r,o)*l%o,h=hs(d,i,o)*d%o,p=hs(h,i,o)*d%o,g=hs(p,t,o)*u%o;return{pow_p_5_8:hs(g,bc,o)*e%o,b2:s}}(e*ds(r*r*t,n)).pow_p_5_8;let o=ds(e*r*i,n);const s=ds(t*o*o,n),a=o,c=ds(o*mc,n),u=s===e,f=s===ds(-e,n),l=s===ds(-e*mc,n);return u&&(o=a),(f||l)&&(o=c),(ds(o,n)&ss)===ss&&(o=ds(-o,n)),{isValid:u||f,value:o}}const _c=(()=>As(gc,void 0,!0))(),Ac=(()=>({a:_c.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:_c,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:vc,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Ft,randomBytes:rt,adjustScalarBytes:Ec,uvRatio:xc}))(),Tc=(()=>pc(Ac))();var Sc,Bc,Nc,Oc,Ic=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},Rc=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class kc{constructor(e={}){Sc.set(this,void 0),Bc.set(this,void 0),this[Nc]=this.entries.bind(this),this[Oc]="ExpirableMap";const{source:t=[],expirationTime:n=6e5}=e,r=Date.now();Ic(this,Sc,new Map([...t].map((([e,t])=>[e,{value:t,timestamp:r}]))),"f"),Ic(this,Bc,n,"f")}prune(){const e=Date.now();for(const[t,n]of Rc(this,Sc,"f").entries())e-n.timestamp>Rc(this,Bc,"f")&&Rc(this,Sc,"f").delete(t);return this}set(e,t){this.prune();const n={value:t,timestamp:Date.now()};return Rc(this,Sc,"f").set(e,n),this}get(e){const t=Rc(this,Sc,"f").get(e);if(void 0!==t){if(!(Date.now()-t.timestamp>Rc(this,Bc,"f")))return t.value;Rc(this,Sc,"f").delete(e)}}clear(){Rc(this,Sc,"f").clear()}entries(){const e=Rc(this,Sc,"f").entries();return function*(){for(const[t,n]of e)yield[t,n.value]}()}values(){const e=Rc(this,Sc,"f").values();return function*(){for(const t of e)yield t.value}()}keys(){return Rc(this,Sc,"f").keys()}forEach(e,t){for(const[n,r]of Rc(this,Sc,"f").entries())e.call(t,r.value,n,this)}has(e){return Rc(this,Sc,"f").has(e)}delete(e){return Rc(this,Sc,"f").delete(e)}get size(){return Rc(this,Sc,"f").size}}Sc=new WeakMap,Bc=new WeakMap,Nc=Symbol.iterator,Oc=Symbol.toStringTag;const Lc=e=>{if(e<=127)return 1;if(e<=255)return 2;if(e<=65535)return 3;if(e<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},$c=(e,t,n)=>{if(n<=127)return e[t]=n,1;if(n<=255)return e[t]=129,e[t+1]=n,2;if(n<=65535)return e[t]=130,e[t+1]=n>>8,e[t+2]=n,3;if(n<=16777215)return e[t]=131,e[t+1]=n>>16,e[t+2]=n>>8,e[t+3]=n,4;throw new Error("Length too long (> 4 bytes)")},Pc=(e,t)=>{if(e[t]<128)return 1;if(128===e[t])throw new Error("Invalid length 0");if(129===e[t])return 2;if(130===e[t])return 3;if(131===e[t])return 4;throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const Uc=Uint8Array.from([48,5,6,3,43,101,112]);function Dc(e,t){const n=2+Lc(e.byteLength+1),r=t.byteLength+n+e.byteLength;let i=0;const o=new Uint8Array(1+Lc(r)+r);return o[i++]=48,i+=$c(o,i,r),o.set(t,i),i+=t.byteLength,o[i++]=3,i+=$c(o,i,e.byteLength+1),o[i++]=0,o.set(new Uint8Array(e),i),o}Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);const Fc=(e,t)=>{let n=0;const r=(e,t)=>{if(i[n++]!==e)throw new Error("Expected: "+t)},i=new Uint8Array(e);if(r(48,"sequence"),n+=Pc(i,n),!Wt(i.slice(n,n+t.byteLength),t))throw new Error("Not the expected OID.");n+=t.byteLength,r(3,"bit string");const o=((e,t)=>{const n=Pc(e,t);if(1===n)return e[t];if(2===n)return e[t+1];if(3===n)return(e[t+1]<<8)+e[t+2];if(4===n)return(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];throw new Error("Length too long (> 4 bytes)")})(i,n)-1;n+=Pc(i,n),r(0,"0 padding");const s=i.slice(n);if(o!==s.length)throw new Error(`DER payload mismatch: Expected length ${o} actual length ${s.length}`);return s};var Cc,Mc,jc=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},qc=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};let Vc=class e{constructor(t){if(Cc.set(this,void 0),Mc.set(this,void 0),t.byteLength!==e.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");jc(this,Cc,t,"f"),jc(this,Mc,e.derEncode(t),"f")}static from(e){return this.fromDer(e.toDer())}static fromRaw(t){return new e(t)}static fromDer(t){return new e(this.derDecode(t))}static derEncode(e){return Dc(e,Uc).buffer}static derDecode(e){const t=Fc(e,Uc);if(t.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return t}get rawKey(){return qc(this,Cc,"f")}get derKey(){return qc(this,Mc,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};Cc=new WeakMap,Mc=new WeakMap,Vc.RAW_KEY_LENGTH=32;class zc{constructor(){this.observers=[]}subscribe(e){this.observers.push(e)}unsubscribe(e){this.observers=this.observers.filter((t=>t!==e))}notify(e,...t){this.observers.forEach((n=>n(e,...t)))}}class Hc extends zc{constructor(){super()}print(e,...t){this.notify({message:e,level:"info"},...t)}warn(e,...t){this.notify({message:e,level:"warn"},...t)}error(e,t,...n){this.notify({message:e,level:"error",error:t},...n)}}var Gc,Kc,Wc,Zc,Yc,Xc,Jc,Qc,eu,tu=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},nu=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};const ru=.5,iu=1.5,ou=500,su=6e4,au=9e5,cu=10;class uu{constructor(e=uu.default){Gc.set(this,void 0),Kc.set(this,void 0),Wc.set(this,void 0),Zc.set(this,void 0),Yc.set(this,void 0),Xc.set(this,void 0),Jc.set(this,void 0),Qc.set(this,void 0),eu.set(this,0);const{initialInterval:t=ou,randomizationFactor:n=ru,multiplier:r=iu,maxInterval:i=su,maxElapsedTime:o=au,maxIterations:s=cu,date:a=Date}=e;tu(this,Gc,t,"f"),tu(this,Kc,n,"f"),tu(this,Wc,r,"f"),tu(this,Zc,i,"f"),tu(this,Qc,a,"f"),tu(this,Yc,a.now(),"f"),tu(this,Xc,o,"f"),tu(this,Jc,s,"f")}get ellapsedTimeInMsec(){return nu(this,Qc,"f").now()-nu(this,Yc,"f")}get currentInterval(){return nu(this,Gc,"f")}get count(){return nu(this,eu,"f")}get randomValueFromInterval(){const e=nu(this,Kc,"f")*nu(this,Gc,"f"),t=nu(this,Gc,"f")-e,n=nu(this,Gc,"f")+e;return Math.random()*(n-t)+t}incrementCurrentInterval(){var e;return tu(this,Gc,Math.min(nu(this,Gc,"f")*nu(this,Wc,"f"),nu(this,Zc,"f")),"f"),tu(this,eu,(e=nu(this,eu,"f"),++e),"f"),nu(this,Gc,"f")}next(){return this.ellapsedTimeInMsec>=nu(this,Xc,"f")||nu(this,eu,"f")>=nu(this,Jc,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}Gc=new WeakMap,Kc=new WeakMap,Wc=new WeakMap,Zc=new WeakMap,Yc=new WeakMap,Xc=new WeakMap,Jc=new WeakMap,Qc=new WeakMap,eu=new WeakMap,uu.default={initialInterval:ou,randomizationFactor:ru,multiplier:iu,maxInterval:su,maxElapsedTime:au,maxIterations:cu,date:Date};var fu,lu,du,hu,pu,gu,mu,yu,bu,wu,vu,Eu,xu,_u,Au,Tu,Su,Bu,Nu,Ou,Iu,Ru,ku=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},Lu=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};!function(e){e.Received="received",e.Processing="processing",e.Replied="replied",e.Rejected="rejected",e.Unknown="unknown",e.Done="done"}(Ru||(Ru={}));const $u=6e4,Pu="aaaaa-aa";class Uu extends Xt{constructor(e){super(e),this.message=e}}class Du extends Xt{constructor(e){super(e),this.message=e}}class Fu{constructor(e={}){var t,n;fu.add(this),lu.set(this,null),du.set(this,!1),hu.set(this,void 0),pu.set(this,void 0),gu.set(this,void 0),mu.set(this,void 0),yu.set(this,0),bu.set(this,void 0),wu.set(this,void 0),vu.set(this,void 0),Eu.set(this,void 0),this._isAgent=!0,this.config={},xu.set(this,0),this.log=new Hc,_u.set(this,[]),Au.set(this,[]),Tu.set(this,new kc({expirationTime:3e5})),Su.set(this,!0),Ou.set(this,((e,t)=>{if(!1===Lu(this,Su,"f"))return e;if(!t)throw new qa("Invalid signature from replica signed query: no matching node key found.");const{status:n,signatures:r=[],requestId:i}=e,o=Yt((new TextEncoder).encode("\vic-response"));for(const s of r){const{timestamp:r,identity:a}=s,c=qt.fromUint8Array(a).toText();let u;if("replied"===n){const{reply:t}=e;u=$i({status:n,reply:t,timestamp:BigInt(r),request_id:i})}else{if("rejected"!==n)throw new Error(`Unknown status: ${n}`);{const{reject_code:t,reject_message:o,error_code:s}=e;u=$i({status:n,reject_code:t,reject_message:o,error_code:s,timestamp:BigInt(r),request_id:i})}}const f=Vt(o,Yt(new Uint8Array(u))),l=null==t?void 0:t.nodeKeys.get(c);if(!l)throw new qa("Invalid signature from replica signed query: no matching node key found.");const d=Vc.fromDer(l).rawKey;if(Tc.verify(s.signature,new Uint8Array(f),new Uint8Array(d)))return e;throw new qa(`Invalid signature from replica ${c} signed query.`)}return e})),this.config=e,ku(this,pu,e.fetch||function(){let e;if("undefined"!=typeof window){if(!window.fetch)throw new Uu("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");e=window.fetch.bind(window)}else if("undefined"!=typeof global){if(!global.fetch)throw new Uu("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");e=global.fetch.bind(global)}else"undefined"!=typeof self&&self.fetch&&(e=self.fetch.bind(self));if(e)return e;throw new Uu("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}()||fetch.bind(global),"f"),ku(this,gu,e.fetchOptions,"f"),ku(this,mu,e.callOptions,"f"),ku(this,du,null!==(t=e.shouldFetchRootKey)&&void 0!==t&&t,"f"),e.rootKey?this.rootKey=e.rootKey:Lu(this,du,"f")?this.rootKey=null:this.rootKey=Gt("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae");const r=function(e){let t;if(void 0!==e)t=e.match(/^[a-z]+:/)||"undefined"==typeof window?new URL(e):new URL(window.location.protocol+"//"+e);else{const e=["ic0.app","icp0.io","127.0.0.1","localhost"],n=[".github.dev",".gitpod.io"],r="undefined"!=typeof window?window.location:void 0,i=null==r?void 0:r.hostname;let o;i&&"string"==typeof i&&(o=n.some((e=>i.endsWith(e)))?i:e.find((e=>i.endsWith(e)))),t=r&&o?new URL(`${r.protocol}//${o}${r.port?":"+r.port:""}`):new URL("https://icp-api.io")}return t.toString()}(e.host);this.host=new URL(r),void 0!==e.verifyQuerySignatures&&ku(this,Su,e.verifyQuerySignatures,"f"),ku(this,wu,null!==(n=e.retryTimes)&&void 0!==n?n:3,"f");if(ku(this,vu,e.backoffStrategy||(()=>new uu({maxIterations:Lu(this,wu,"f")})),"f"),this.host.hostname.endsWith(".ic0.app")?this.host.hostname="ic0.app":this.host.hostname.endsWith(".icp0.io")?this.host.hostname="icp0.io":this.host.hostname.endsWith(".icp-api.io")&&(this.host.hostname="icp-api.io"),e.credentials){const{name:t,password:n}=e.credentials;ku(this,bu,`${t}${n?":"+n:""}`,"f")}if(ku(this,hu,Promise.resolve(e.identity||new Fi),"f"),e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes>5)throw new Xt(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);if(e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes<=0)throw new Xt(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);ku(this,Eu,e.ingressExpiryInMinutes||5,"f"),this.addTransform("update",Ao(Eo)),e.useQueryNonces&&this.addTransform("query",Ao(Eo)),e.logToConsole&&this.log.subscribe((e=>{"error"===e.level?console.error(e.message):"warn"===e.level?console.warn(e.message):console.log(e.message)}))}get waterMark(){return Lu(this,xu,"f")}static createSync(e={}){return new this(Object.assign({},e))}static async create(e={shouldFetchRootKey:!1}){const t=Fu.createSync(e),n=[t.syncTime()];return"https://icp-api.io"!==t.host.toString()&&e.shouldFetchRootKey&&n.push(t.fetchRootKey()),await Promise.all(n),t}static async from(e){var t;try{return"config"in e?await Fu.create(e.config):await Fu.create({fetch:e._fetch,fetchOptions:e._fetchOptions,callOptions:e._callOptions,host:e._host.toString(),identity:null!==(t=e._identity)&&void 0!==t?t:void 0})}catch(e){throw new Xt("Failed to create agent from provided agent")}}isLocal(){const e=this.host.hostname;return"127.0.0.1"===e||e.endsWith("127.0.0.1")}addTransform(e,t,n=t.priority||0){if("update"===e){const e=Lu(this,Au,"f").findIndex((e=>(e.priority||0)<n));Lu(this,Au,"f").splice(e>=0?e:Lu(this,Au,"f").length,0,Object.assign(t,{priority:n}))}else if("query"===e){const e=Lu(this,_u,"f").findIndex((e=>(e.priority||0)<n));Lu(this,_u,"f").splice(e>=0?e:Lu(this,_u,"f").length,0,Object.assign(t,{priority:n}))}}async getPrincipal(){if(!Lu(this,hu,"f"))throw new Du("This identity has expired due this application's security policy. Please refresh your authentication.");return(await Lu(this,hu,"f")).getPrincipal()}async call(e,t,n){var r,i;await Lu(this,fu,"m",Iu).call(this);const o=null===(r=t.callSync)||void 0===r||r,s=await(void 0!==n?await n:await Lu(this,hu,"f"));if(!s)throw new Du("This identity has expired due this application's security policy. Please refresh your authentication.");const a=qt.from(e),c=t.effectiveCanisterId?qt.from(t.effectiveCanisterId):a,u=s.getPrincipal()||qt.anonymous();let f=new _o(Lu(this,Eu,"f")*$u);Math.abs(Lu(this,yu,"f"))>3e4&&(f=new _o(Lu(this,Eu,"f")*$u+Lu(this,yu,"f")));const l={request_type:vo.Call,canister_id:a,method_name:t.methodName,arg:t.arg,sender:u,ingress_expiry:f};let d,h=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},Lu(this,bu,"f")?{Authorization:"Basic "+btoa(Lu(this,bu,"f"))}:{})},endpoint:"call",body:l});function p(e){return new Uint8Array(e)}d=(null==t?void 0:t.nonce)?p(t.nonce):h.body.nonce?p(h.body.nonce):void 0,l.nonce=d,h=await s.transformRequest(h);const g=go(h.body),m=Lu(this,vu,"f").call(this),y=Li(l);try{const e=()=>(this.log.print(`fetching "/api/v3/canister/${c.toText()}/call" with request:`,h),Lu(this,pu,"f").call(this,""+new URL(`/api/v3/canister/${c.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},Lu(this,mu,"f")),h.request),{body:g}))),t=()=>(this.log.print(`fetching "/api/v2/canister/${c.toText()}/call" with request:`,h),Lu(this,pu,"f").call(this,""+new URL(`/api/v2/canister/${c.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},Lu(this,mu,"f")),h.request),{body:g}))),n=Lu(this,fu,"m",Nu).call(this,{request:o?e:t,backoff:m,tries:0}),r=await n,i=await r.arrayBuffer(),s=200===r.status&&i.byteLength>0?bo(i):null;if(s&&"certificate"in s){const e=await this.parseTimeFromResponse({certificate:s.certificate});ku(this,xu,e,"f")}return{requestId:y,response:{ok:r.ok,status:r.status,statusText:r.statusText,body:s,headers:To(r.headers)},requestDetails:l}}catch(r){if(r.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(e,Object.assign(Object.assign({},t),{callSync:!1}),n);const o=`Error while making call: ${null!==(i=r.message)&&void 0!==i?i:String(r)}`,s=new Bo(o,r,zt(y),zt(h.body.sender_pubkey),zt(h.body.sender_sig),String(h.body.content.ingress_expiry._value));throw this.log.error(o,s),s}}async query(e,t,n){var r,i,o,s;await Lu(this,fu,"m",Iu).call(this);const a=Lu(this,vu,"f").call(this),c=t.effectiveCanisterId?qt.from(t.effectiveCanisterId):qt.from(e);let u,f;this.log.print(`ecid ${c.toString()}`),this.log.print(`canisterId ${e.toString()}`);const l=await(void 0!==n?n:Lu(this,hu,"f"));if(!l)throw new Du("This identity has expired due this application's security policy. Please refresh your authentication.");const d=qt.from(e),h=(null==l?void 0:l.getPrincipal())||qt.anonymous(),p={request_type:"query",canister_id:d,method_name:t.methodName,arg:t.arg,sender:h,ingress_expiry:new _o(Lu(this,Eu,"f")*$u)},g=Li(p);u=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},Lu(this,bu,"f")?{Authorization:"Basic "+btoa(Lu(this,bu,"f"))}:{})},endpoint:"read",body:p}),u=await(null==l?void 0:l.transformRequest(u));const m=go(u.body),y={canister:d.toText(),ecid:c,transformedRequest:u,body:m,requestId:g,backoff:a,tries:0},b=async()=>({requestDetails:p,query:await Lu(this,fu,"m",Bu).call(this,y)}),w=async()=>{if(!Lu(this,Su,"f"))return;const e=Lu(this,Tu,"f").get(c.toString());return e||(await this.fetchSubnetKeys(c.toString()),Lu(this,Tu,"f").get(c.toString()))};try{const[t,n]=await Promise.all([b(),w()]);f=t;const{requestDetails:r,query:i}=f,o=Object.assign(Object.assign({},i),{requestDetails:r});if(this.log.print("Query response:",o),!Lu(this,Su,"f"))return o;try{return Lu(this,Ou,"f").call(this,o,n)}catch(t){this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),Lu(this,Tu,"f").delete(e.toString()),await this.fetchSubnetKeys(c.toString());const n=Lu(this,Tu,"f").get(e.toString());if(!n)throw new qa("Invalid signature from replica signed query: no matching node key found.");return Lu(this,Ou,"f").call(this,o,n)}}catch(e){const t=`Error while making call: ${null!==(r=e.message)&&void 0!==r?r:String(e)}`,n=new No(t,e,String(g),zt(null===(i=null==u?void 0:u.body)||void 0===i?void 0:i.sender_pubkey),zt(null===(o=null==u?void 0:u.body)||void 0===o?void 0:o.sender_sig),String(null===(s=null==u?void 0:u.body)||void 0===s?void 0:s.content.ingress_expiry._value));throw this.log.error(t,n),n}}async createReadStateRequest(e,t){await Lu(this,fu,"m",Iu).call(this);const n=await(void 0!==t?await t:await Lu(this,hu,"f"));if(!n)throw new Du("This identity has expired due this application's security policy. Please refresh your authentication.");const r=(null==n?void 0:n.getPrincipal())||qt.anonymous(),i=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},Lu(this,bu,"f")?{Authorization:"Basic "+btoa(Lu(this,bu,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:e.paths,sender:r,ingress_expiry:new _o(Lu(this,Eu,"f")*$u)}});return null==n?void 0:n.transformRequest(i)}async readState(e,t,n,r){var i,o,s,a;const c=function(e){for(const t of e.paths){const[e,n]=t;if(Wt(e,Yt((new TextEncoder).encode("request_status"))))return n}}(t);await Lu(this,fu,"m",Iu).call(this);const u="string"==typeof e?qt.fromText(e):e,f=null!=r?r:await this.createReadStateRequest(t,n),l=go(f.body);this.log.print(`fetching "/api/v2/canister/${u}/read_state" with request:`,f);const d=Lu(this,vu,"f").call(this);try{const e=await Lu(this,fu,"m",Nu).call(this,{request:()=>Lu(this,pu,"f").call(this,""+new URL(`/api/v2/canister/${u.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},Lu(this,gu,"f")),f.request),{body:l})),backoff:d,tries:0});if(!e.ok)throw new Error(`Server returned an error:\n  Code: ${e.status} (${e.statusText})\n  Body: ${await e.text()}\n`);const t=bo(await e.arrayBuffer());this.log.print("Read state response:",t);const n=await this.parseTimeFromResponse(t);return n>0&&(this.log.print("Read state response time:",n),ku(this,xu,n,"f")),t}catch(e){const t=`Caught exception while attempting to read state: ${null!==(i=e.message)&&void 0!==i?i:String(e)}`,n=new Oo(t,e,String(c),zt(null===(o=null==f?void 0:f.body)||void 0===o?void 0:o.sender_pubkey),zt(null===(s=null==f?void 0:f.body)||void 0===s?void 0:s.sender_sig),String(null===(a=null==f?void 0:f.body)||void 0===a?void 0:a.content.ingress_expiry._value));throw this.log.error(t,n),n}}async parseTimeFromResponse(e){let t;if(e.certificate){const n=bo(e.certificate);if(!n||!("tree"in n))throw new Error("Could not decode time from response");t=n.tree;const r=Xa(["time"],t);if(r.status!==Za.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(r.value instanceof ArrayBuffer||ArrayBuffer.isView(r)))throw new Error("Time was not found in the response or was not in its expected format.");const i=Da(Yt(r.value));return this.log.print("Time from response:",i),this.log.print("Time from response in milliseconds:",Number(i)),Number(i)}return this.log.warn("No certificate found in response"),0}async syncTime(e){await Lu(this,fu,"m",Iu).call(this);const t=await Promise.resolve().then((function(){return cc})),n=Date.now();try{e||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const r=Fu.createSync({identity:new Fi,host:this.host.toString(),fetch:Lu(this,pu,"f"),retryTimes:0}),i=(await t.request({canisterId:null!=e?e:qt.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:r,paths:["time"]})).get("time");i&&(ku(this,yu,Number(i)-Number(n),"f"),this.log.notify({message:`Syncing time: offset of ${Lu(this,yu,"f")}`,level:"info"}))}catch(e){this.log.error("Caught exception while attempting to sync time",e)}}async status(){const e=Lu(this,bu,"f")?{Authorization:"Basic "+btoa(Lu(this,bu,"f"))}:{};this.log.print('fetching "/api/v2/status"');const t=Lu(this,vu,"f").call(this),n=await Lu(this,fu,"m",Nu).call(this,{backoff:t,request:()=>Lu(this,pu,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:e},Lu(this,gu,"f"))),tries:0});return bo(await n.arrayBuffer())}async fetchRootKey(){let e;return Lu(this,lu,"f")||ku(this,lu,new Promise(((e,t)=>{this.status().then((t=>{const n=t.root_key;this.rootKey=n,e(n)})).catch(t)})),"f"),e=await Lu(this,lu,"f"),ku(this,lu,null,"f"),e}invalidateIdentity(){ku(this,hu,null,"f")}replaceIdentity(e){ku(this,hu,Promise.resolve(e),"f")}async fetchSubnetKeys(e){await Lu(this,fu,"m",Iu).call(this);const t=qt.from(e),n=(await tc({canisterId:t,paths:["subnet"],agent:this})).get("subnet");if(n&&"object"==typeof n&&"nodeKeys"in n)return Lu(this,Tu,"f").set(t.toText(),n),n}_transform(e){let t=Promise.resolve(e);if("call"===e.endpoint)for(const e of Lu(this,Au,"f"))t=t.then((t=>e(t).then((e=>e||t))));else for(const e of Lu(this,_u,"f"))t=t.then((t=>e(t).then((e=>e||t))));return t}}var Cu;function Mu(){const e="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!e)throw new Error("No Agent could be found.");return e}lu=new WeakMap,du=new WeakMap,hu=new WeakMap,pu=new WeakMap,gu=new WeakMap,mu=new WeakMap,yu=new WeakMap,bu=new WeakMap,wu=new WeakMap,vu=new WeakMap,Eu=new WeakMap,xu=new WeakMap,_u=new WeakMap,Au=new WeakMap,Tu=new WeakMap,Su=new WeakMap,Ou=new WeakMap,fu=new WeakSet,Bu=async function e(t){var n,r;const{ecid:i,transformedRequest:o,body:s,requestId:a,backoff:c,tries:u}=t,f=0===u?0:c.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:u,backoff:c,delay:f}),null===f)throw new Xt(`Timestamp failed to pass the watermark after retrying the configured ${Lu(this,wu,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);let l;f>0&&await new Promise((e=>setTimeout(e,f)));try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,o);const e=await Lu(this,pu,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},Lu(this,gu,"f")),o.request),{body:s}));if(200!==e.status)throw new So(`Gateway returned an error:\n  Code: ${e.status} (${e.statusText})\n  Body: ${await e.text()}\n`,{ok:e.ok,status:e.status,statusText:e.statusText,headers:To(e.headers)});{const t=bo(await e.arrayBuffer());l=Object.assign(Object.assign({},t),{httpDetails:{ok:e.ok,status:e.status,statusText:e.statusText,headers:To(e.headers)},requestId:a})}}catch(n){if(u<Lu(this,wu,"f"))return this.log.warn(`Caught exception while attempting to make query:\n  ${n}\n  Retrying query.`),await Lu(this,fu,"m",e).call(this,Object.assign(Object.assign({},t),{tries:u+1}));throw n}const d=null===(r=null===(n=l.signatures)||void 0===n?void 0:n[0])||void 0===r?void 0:r.timestamp;if(!Lu(this,Su,"f"))return l;if(!d)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const h=Number(BigInt(d)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:h}),Number(this.waterMark)>h){const n=new Xt("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",n,{timestamp:d,waterMark:this.waterMark}),u<Lu(this,wu,"f"))return await Lu(this,fu,"m",e).call(this,Object.assign(Object.assign({},t),{tries:u+1}));throw new Xt(`Timestamp failed to pass the watermark after retrying the configured ${Lu(this,wu,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return l},Nu=async function e(t){const{request:n,backoff:r,tries:i}=t,o=0===i?0:r.next();if(null===o)throw new Xt(`Timestamp failed to pass the watermark after retrying the configured ${Lu(this,wu,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);let s;o>0&&await new Promise((e=>setTimeout(e,o)));try{s=await n()}catch(t){if(Lu(this,wu,"f")>i)return this.log.warn(`Caught exception while attempting to make request:\n  ${t}\n  Retrying request.`),await Lu(this,fu,"m",e).call(this,{request:n,backoff:r,tries:i+1});throw t}if(s.ok)return s;const a=await s.clone().text(),c=`Server returned an error:\n  Code: ${s.status} (${s.statusText})\n  Body: ${a}\n`;if(404===s.status&&s.url.includes("api/v3"))throw new So("v3 api not supported. Fall back to v2",{ok:s.ok,status:s.status,statusText:s.statusText,headers:To(s.headers)});if(i<Lu(this,wu,"f"))return await Lu(this,fu,"m",e).call(this,{request:n,backoff:r,tries:i+1});throw new So(c,{ok:s.ok,status:s.status,statusText:s.statusText,headers:To(s.headers)})},Iu=async function(){if(!this.rootKey){if(null!==this.rootKey||!Lu(this,du,"f"))throw new Xt(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${Lu(this,du,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`);await this.fetchRootKey()}},function(e){e.Error="err",e.GetPrincipal="gp",e.GetPrincipalResponse="gpr",e.Query="q",e.QueryResponse="qr",e.Call="c",e.CallResponse="cr",e.ReadState="rs",e.ReadStateResponse="rsr",e.Status="s",e.StatusResponse="sr"}(Cu||(Cu={}));const ju=3e5;function qu(){return function(...e){return async(t,n,r)=>{for(const i of e)await i(t,n,r)}}((e=function(){let e=!0;return async()=>!!e&&(e=!1,!0)}(),t=1e3,async(n,r,i)=>{if(await e(n,r,i))return new Promise((e=>setTimeout(e,t)))}),function(e,t){let n=e;return()=>new Promise((e=>setTimeout((()=>{n*=t,e()}),n)))}(1e3,1.2),function(e){const t=Date.now()+e;return async(n,r,i)=>{if(Date.now()>t)throw new Error(`Request timed out after ${e} msec:\n  Request ID: ${zt(r)}\n  Request status: ${i}\n`)}}(ju));var e,t}async function Vu(e,t,n,r=qu(),i,o){var s;const a=[(new TextEncoder).encode("request_status"),n],c=null!=i?i:await(null===(s=e.createReadStateRequest)||void 0===s?void 0:s.call(e,{paths:[a]})),u=await e.readState(t,{paths:[a]},void 0,c);if(null==e.rootKey)throw new Error("Agent root key not initialized before polling");const f=await Va.create({certificate:u.certificate,rootKey:e.rootKey,canisterId:t,blsVerify:o}),l=Ga(f.lookup([...a,(new TextEncoder).encode("status")]));let d;switch(d=void 0===l?Ru.Unknown:(new TextDecoder).decode(l),d){case Ru.Replied:return{reply:Ga(f.lookup([...a,"reply"])),certificate:f};case Ru.Received:case Ru.Unknown:case Ru.Processing:return await r(t,n,d),Vu(e,t,n,r,c,o);case Ru.Rejected:{const e=new Uint8Array(Ga(f.lookup([...a,"reject_code"])))[0],t=(new TextDecoder).decode(Ga(f.lookup([...a,"reject_message"])));throw new Error(`Call was rejected:\n  Request ID: ${zt(n)}\n  Reject code: ${e}\n  Reject text: ${t}\n`)}case Ru.Done:throw new Error(`Call was marked as done but we never saw the reply:\n  Request ID: ${zt(n)}\n`)}throw new Error("unreachable")}var zu=({IDL:e})=>{const t=e.Variant({mainnet:e.Null,testnet:e.Null}),n=e.Text,r=e.Record({network:t,address:n,min_confirmations:e.Opt(e.Nat32)}),i=e.Nat64,o=i,s=e.Nat32,a=e.Record({start_height:s,end_height:e.Opt(s),network:t}),c=e.Vec(e.Nat8),u=e.Record({tip_height:s,block_headers:e.Vec(c)}),f=e.Record({network:t}),l=e.Nat64,d=e.Vec(l),h=e.Record({network:t,filter:e.Opt(e.Variant({page:e.Vec(e.Nat8),min_confirmations:e.Nat32})),address:n}),p=e.Vec(e.Nat8),g=e.Record({txid:e.Vec(e.Nat8),vout:e.Nat32}),m=e.Record({height:e.Nat32,value:i,outpoint:g}),y=e.Record({next_page:e.Opt(e.Vec(e.Nat8)),tip_height:s,tip_block_hash:p,utxos:e.Vec(m)}),b=e.Record({transaction:e.Vec(e.Nat8),network:t}),w=e.Principal,v=e.Record({canister_id:w,num_requested_changes:e.Opt(e.Nat64)}),E=e.Variant({from_user:e.Record({user_id:e.Principal}),from_canister:e.Record({canister_version:e.Opt(e.Nat64),canister_id:e.Principal})}),x=e.Vec(e.Nat8),_=e.Variant({creation:e.Record({controllers:e.Vec(e.Principal)}),code_deployment:e.Record({mode:e.Variant({reinstall:e.Null,upgrade:e.Null,install:e.Null}),module_hash:e.Vec(e.Nat8)}),load_snapshot:e.Record({canister_version:e.Nat64,taken_at_timestamp:e.Nat64,snapshot_id:x}),controllers_change:e.Record({controllers:e.Vec(e.Principal)}),code_uninstall:e.Null}),A=e.Record({timestamp_nanos:e.Nat64,canister_version:e.Nat64,origin:E,details:_}),T=e.Record({controllers:e.Vec(e.Principal),module_hash:e.Opt(e.Vec(e.Nat8)),recent_changes:e.Vec(A),total_num_changes:e.Nat64}),S=e.Record({canister_id:w}),B=e.Variant({controllers:e.Null,public:e.Null,allowed_viewers:e.Vec(e.Principal)}),N=e.Record({freezing_threshold:e.Nat,controllers:e.Vec(e.Principal),reserved_cycles_limit:e.Nat,log_visibility:B,wasm_memory_limit:e.Nat,memory_allocation:e.Nat,compute_allocation:e.Nat}),O=e.Record({status:e.Variant({stopped:e.Null,stopping:e.Null,running:e.Null}),memory_size:e.Nat,cycles:e.Nat,settings:N,query_stats:e.Record({response_payload_bytes_total:e.Nat,num_instructions_total:e.Nat,num_calls_total:e.Nat,request_payload_bytes_total:e.Nat}),idle_cycles_burned_per_day:e.Nat,module_hash:e.Opt(e.Vec(e.Nat8)),reserved_cycles:e.Nat}),I=e.Record({canister_id:w}),R=e.Record({freezing_threshold:e.Opt(e.Nat),controllers:e.Opt(e.Vec(e.Principal)),reserved_cycles_limit:e.Opt(e.Nat),log_visibility:e.Opt(B),wasm_memory_limit:e.Opt(e.Nat),memory_allocation:e.Opt(e.Nat),compute_allocation:e.Opt(e.Nat)}),k=e.Record({settings:e.Opt(R),sender_canister_version:e.Opt(e.Nat64)}),L=e.Record({canister_id:w}),$=e.Record({canister_id:w}),P=e.Record({canister_id:w,snapshot_id:x}),U=e.Record({canister_id:w}),D=e.Variant({secp256k1:e.Null}),F=e.Record({key_id:e.Record({name:e.Text,curve:D}),canister_id:e.Opt(w),derivation_path:e.Vec(e.Vec(e.Nat8))}),C=e.Record({public_key:e.Vec(e.Nat8),chain_code:e.Vec(e.Nat8)}),M=e.Record({canister_id:w}),j=e.Record({idx:e.Nat64,timestamp_nanos:e.Nat64,content:e.Vec(e.Nat8)}),q=e.Record({canister_log_records:e.Vec(j)}),V=e.Record({value:e.Text,name:e.Text}),z=e.Record({status:e.Nat,body:e.Vec(e.Nat8),headers:e.Vec(V)}),H=e.Record({url:e.Text,method:e.Variant({get:e.Null,head:e.Null,post:e.Null}),max_response_bytes:e.Opt(e.Nat64),body:e.Opt(e.Vec(e.Nat8)),transform:e.Opt(e.Record({function:e.Func([e.Record({context:e.Vec(e.Nat8),response:z})],[z],["query"]),context:e.Vec(e.Nat8)})),headers:e.Vec(V)}),G=e.Variant({reinstall:e.Null,upgrade:e.Opt(e.Record({wasm_memory_persistence:e.Opt(e.Variant({keep:e.Null,replace:e.Null})),skip_pre_upgrade:e.Opt(e.Bool)})),install:e.Null}),K=e.Record({hash:e.Vec(e.Nat8)}),W=e.Record({arg:e.Vec(e.Nat8),wasm_module_hash:e.Vec(e.Nat8),mode:G,chunk_hashes_list:e.Vec(K),target_canister:w,store_canister:e.Opt(w),sender_canister_version:e.Opt(e.Nat64)}),Z=e.Vec(e.Nat8),Y=e.Record({arg:e.Vec(e.Nat8),wasm_module:Z,mode:G,canister_id:w,sender_canister_version:e.Opt(e.Nat64)}),X=e.Record({canister_id:w}),J=e.Record({id:x,total_size:e.Nat64,taken_at_timestamp:e.Nat64}),Q=e.Vec(J),ee=e.Record({canister_id:w,sender_canister_version:e.Opt(e.Nat64),snapshot_id:x}),te=e.Record({start_at_timestamp_nanos:e.Nat64,subnet_id:e.Principal}),ne=e.Record({num_block_failures_total:e.Nat64,node_id:e.Principal,num_blocks_proposed_total:e.Nat64}),re=e.Vec(e.Record({timestamp_nanos:e.Nat64,node_metrics:e.Vec(ne)})),ie=e.Record({settings:e.Opt(R),specified_id:e.Opt(w),amount:e.Opt(e.Nat),sender_canister_version:e.Opt(e.Nat64)}),oe=e.Record({canister_id:w}),se=e.Record({canister_id:w,amount:e.Nat}),ae=e.Vec(e.Nat8),ce=e.Variant({ed25519:e.Null,bip340secp256k1:e.Null}),ue=e.Record({key_id:e.Record({algorithm:ce,name:e.Text}),canister_id:e.Opt(w),derivation_path:e.Vec(e.Vec(e.Nat8))}),fe=e.Record({public_key:e.Vec(e.Nat8),chain_code:e.Vec(e.Nat8)}),le=e.Record({key_id:e.Record({name:e.Text,curve:D}),derivation_path:e.Vec(e.Vec(e.Nat8)),message_hash:e.Vec(e.Nat8)}),de=e.Record({signature:e.Vec(e.Nat8)}),he=e.Variant({bip341:e.Record({merkle_root_hash:e.Vec(e.Nat8)})}),pe=e.Record({aux:e.Opt(he),key_id:e.Record({algorithm:ce,name:e.Text}),derivation_path:e.Vec(e.Vec(e.Nat8)),message:e.Vec(e.Nat8)}),ge=e.Record({signature:e.Vec(e.Nat8)}),me=e.Record({canister_id:w}),ye=e.Record({canister_id:w}),be=e.Record({canister_id:w}),we=e.Vec(K),ve=e.Record({subnet_id:e.Principal}),Ee=e.Record({replica_version:e.Text}),xe=e.Record({replace_snapshot:e.Opt(x),canister_id:w}),_e=J,Ae=e.Record({canister_id:w,sender_canister_version:e.Opt(e.Nat64)}),Te=e.Record({canister_id:e.Principal,settings:R,sender_canister_version:e.Opt(e.Nat64)}),Se=e.Record({chunk:e.Vec(e.Nat8),canister_id:e.Principal}),Be=K;return e.Service({bitcoin_get_balance:e.Func([r],[o],[]),bitcoin_get_block_headers:e.Func([a],[u],[]),bitcoin_get_current_fee_percentiles:e.Func([f],[d],[]),bitcoin_get_utxos:e.Func([h],[y],[]),bitcoin_send_transaction:e.Func([b],[],[]),canister_info:e.Func([v],[T],[]),canister_status:e.Func([S],[O],[]),clear_chunk_store:e.Func([I],[],[]),create_canister:e.Func([k],[L],[]),delete_canister:e.Func([$],[],[]),delete_canister_snapshot:e.Func([P],[],[]),deposit_cycles:e.Func([U],[],[]),ecdsa_public_key:e.Func([F],[C],[]),fetch_canister_logs:e.Func([M],[q],["query"]),http_request:e.Func([H],[z],[]),install_chunked_code:e.Func([W],[],[]),install_code:e.Func([Y],[],[]),list_canister_snapshots:e.Func([X],[Q],[]),load_canister_snapshot:e.Func([ee],[],[]),node_metrics_history:e.Func([te],[re],[]),provisional_create_canister_with_cycles:e.Func([ie],[oe],[]),provisional_top_up_canister:e.Func([se],[],[]),raw_rand:e.Func([],[ae],[]),schnorr_public_key:e.Func([ue],[fe],[]),sign_with_ecdsa:e.Func([le],[de],[]),sign_with_schnorr:e.Func([pe],[ge],[]),start_canister:e.Func([me],[],[]),stop_canister:e.Func([ye],[],[]),stored_chunks:e.Func([be],[we],[]),subnet_info:e.Func([ve],[Ee],[]),take_canister_snapshot:e.Func([xe],[_e],[]),uninstall_code:e.Func([Ae],[],[]),update_settings:e.Func([Te],[],[]),upload_chunk:e.Func([Se],[Be],[])})};class Hu extends Xt{constructor(e,t,n,r){super(["Call failed:",`  Canister: ${e.toText()}`,`  Method: ${t} (${n})`,...Object.getOwnPropertyNames(r).map((e=>`  "${e}": ${JSON.stringify(r[e])}`))].join("\n")),this.canisterId=e,this.methodName=t,this.type=n,this.props=r}}class Gu extends Hu{constructor(e,t,n){var r;super(e,t,"query",{Status:n.status,Code:null!==(r=Ve[n.reject_code])&&void 0!==r?r:`Unknown Code "${n.reject_code}"`,Message:n.reject_message}),this.result=n}}class Ku extends Hu{constructor(e,t,n,r,i,o,s){super(e,t,"update",Object.assign({"Request ID":zt(n)},r.body?Object.assign(Object.assign({},s?{"Error code":s}:{}),{"Reject code":String(i),"Reject message":o}):{"HTTP status code":r.status.toString(),"HTTP status text":r.statusText})),this.requestId=n,this.response=r,this.reject_code=i,this.reject_message=o,this.error_code=s}}const Wu=Symbol.for("ic-agent-metadata");class Zu{constructor(e){this[Wu]=Object.freeze(e)}static agentOf(e){return e[Wu].config.agent}static interfaceOf(e){return e[Wu].service}static canisterIdOf(e){return qt.from(e[Wu].config.canisterId)}static async install(e,t){const n=void 0===e.mode?{install:null}:e.mode,r=e.arg?[...new Uint8Array(e.arg)]:[],i=[...new Uint8Array(e.module)],o="string"==typeof t.canisterId?qt.fromText(t.canisterId):t.canisterId;await tf(t).install_code({mode:n,arg:r,wasm_module:i,canister_id:o,sender_canister_version:[]})}static async createCanister(e,t){const{canister_id:n}=await tf(e||{}).provisional_create_canister_with_cycles({amount:[],settings:function(e){return[{controllers:e.controllers?[e.controllers]:[],compute_allocation:e.compute_allocation?[e.compute_allocation]:[],freezing_threshold:e.freezing_threshold?[e.freezing_threshold]:[],memory_allocation:e.memory_allocation?[e.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}(t||{}),specified_id:[],sender_canister_version:[]});return n}static async createAndInstallCanister(e,t,n){const r=await this.createCanister(n);return await this.install(Object.assign({},t),Object.assign(Object.assign({},n),{canisterId:r})),this.createActor(e,Object.assign(Object.assign({},n),{canisterId:r}))}static createActorClass(e,t){const n=e({IDL:yr});return class extends Zu{constructor(e){if(!e.canisterId)throw new Xt(`Canister ID is required, but received ${typeof e.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const r="string"==typeof e.canisterId?qt.fromText(e.canisterId):e.canisterId;super({config:Object.assign(Object.assign(Object.assign({},Xu),e),{canisterId:r}),service:n});for(const[r,i]of n._fields)(null==t?void 0:t.httpDetails)&&i.annotations.push(Ju),(null==t?void 0:t.certificate)&&i.annotations.push(Qu),this[r]=ef(this,r,i,e.blsVerify)}}}static createActor(e,t){if(!t.canisterId)throw new Xt(`Canister ID is required, but received ${typeof t.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(e))(t)}static createActorWithHttpDetails(e,t){return new(this.createActorClass(e,{httpDetails:!0}))(t)}static createActorWithExtendedDetails(e,t,n={httpDetails:!0,certificate:!0}){return new(this.createActorClass(e,n))(t)}}function Yu(e,t){const n=Vn(e,$e.Buffer.from(t));switch(n.length){case 0:return;case 1:return n[0];default:return n}}const Xu={pollingStrategyFactory:qu},Ju="http-details",Qu="certificate";function ef(e,t,n,r){let i;i=n.annotations.includes("query")||n.annotations.includes("composite_query")?async(r,...i)=>{var o,s;const a=(r=Object.assign(Object.assign({},r),null===(s=(o=e[Wu].config).queryTransform)||void 0===s?void 0:s.call(o,t,i,Object.assign(Object.assign({},e[Wu].config),r)))).agent||e[Wu].config.agent||Mu(),c=qt.from(r.canisterId||e[Wu].config.canisterId),u=qn(n.argTypes,i),f=await a.query(c,{methodName:t,arg:u,effectiveCanisterId:r.effectiveCanisterId}),l=Object.assign(Object.assign({},f.httpDetails),{requestDetails:f.requestDetails});switch(f.status){case"rejected":throw new Gu(c,t,f);case"replied":return n.annotations.includes(Ju)?{httpDetails:l,result:Yu(n.retTypes,f.reply.arg)}:Yu(n.retTypes,f.reply.arg)}}:async(i,...o)=>{var s,a;const c=(i=Object.assign(Object.assign({},i),null===(a=(s=e[Wu].config).callTransform)||void 0===a?void 0:a.call(s,t,o,Object.assign(Object.assign({},e[Wu].config),i)))).agent||e[Wu].config.agent||Mu(),{canisterId:u,effectiveCanisterId:f,pollingStrategyFactory:l}=Object.assign(Object.assign(Object.assign({},Xu),e[Wu].config),i),d=qt.from(u),h=void 0!==f?qt.from(f):d,p=qn(n.argTypes,o),{requestId:g,response:m,requestDetails:y}=await c.call(d,{methodName:t,arg:p,effectiveCanisterId:h});let b,w;if(m.body&&m.body.certificate){if(null==c.rootKey)throw new Error("Agent is missing root key");const e=m.body.certificate;w=await Va.create({certificate:tn(e),rootKey:c.rootKey,canisterId:qt.from(u),blsVerify:r});const n=[(new TextEncoder).encode("request_status"),g];switch((new TextDecoder).decode(Ga(w.lookup([...n,"status"])))){case"replied":b=Ga(w.lookup([...n,"reply"]));break;case"rejected":{const e=new Uint8Array(Ga(w.lookup([...n,"reject_code"])))[0],r=(new TextDecoder).decode(Ga(w.lookup([...n,"reject_message"]))),i=Ga(w.lookup([...n,"error_code"])),o=i?(new TextDecoder).decode(i):void 0;throw new Ku(d,t,g,m,e,r,o)}}}else if(m.body&&"reject_message"in m.body){const{reject_code:e,reject_message:n,error_code:r}=m.body;throw new Ku(d,t,g,m,e,n,r)}if(202===m.status){const e=l(),t=await Vu(c,h,g,e,r);w=t.certificate,b=t.reply}const v=n.annotations.includes(Ju),E=n.annotations.includes(Qu),x=Object.assign(Object.assign({},m),{requestDetails:y});if(void 0!==b)return v&&E?{httpDetails:x,certificate:w,result:Yu(n.retTypes,b)}:E?{certificate:w,result:Yu(n.retTypes,b)}:v?{httpDetails:x,result:Yu(n.retTypes,b)}:Yu(n.retTypes,b);if(0===n.retTypes.length)return v?{httpDetails:m,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${n.retTypes.join(",")}].`)};const o=(...e)=>i({},...e);return o.withOptions=e=>(...t)=>i(e,...t),o}function tf(e){function t(t,n){if(e.effectiveCanisterId)return{effectiveCanisterId:qt.from(e.effectiveCanisterId)};const r=n[0];let i=qt.fromHex("");return r&&"object"==typeof r&&r.target_canister&&"install_chunked_code"===t&&(i=qt.from(r.target_canister)),r&&"object"==typeof r&&r.canister_id&&(i=qt.from(r.canister_id)),{effectiveCanisterId:i}}return Zu.createActor(zu,Object.assign(Object.assign(Object.assign({},e),{canisterId:qt.fromHex("")}),{callTransform:t,queryTransform:t}))}const nf=({IDL:e})=>{const t=e.Record({id:e.Nat,encrypted_text:e.Text,owner:e.Text,users:e.Vec(e.Text)});return e.Service({add_user:e.Func([e.Nat,e.Text],[],[]),create_note:e.Func([],[e.Nat],[]),delete_note:e.Func([e.Nat],[],[]),encrypted_symmetric_key_for_note:e.Func([e.Nat,e.Vec(e.Nat8)],[e.Text],[]),get_notes:e.Func([],[e.Vec(t)],[]),remove_user:e.Func([e.Nat,e.Text],[],[]),symmetric_key_verification_key_for_note:e.Func([],[e.Text],[]),update_note:e.Func([e.Nat,e.Text],[],[]),whoami:e.Func([],[e.Text],[])})};function rf(e){const t={host:"ic"===process.env.DFX_NETWORK?`https://${process.env.CANISTER_ID_ENCRYPTED_NOTES}.ic0.app`:"http://localhost:8000"};e?e.agentOptions?e.agentOptions.host=t.host:e.agentOptions=t:e={agentOptions:t};const n=new Fu(Object.assign({},e.agentOptions));return"production"!==process.env.NODE_ENV&&(console.log("Dev environment - fetching root key..."),n.fetchRootKey().catch((e=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(e)}))),Zu.createActor(nf,Object.assign({agent:n,canisterId:process.env.CANISTER_ID_ENCRYPTED_NOTES},null==e?void 0:e.actorOptions))}var of,sf,af,cf,uf=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},ff=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};function lf(e){return null!==e&&"object"==typeof e}class df{constructor(e){if(of.set(this,void 0),sf.set(this,void 0),e.byteLength!==df.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");uf(this,of,Yt(e),"f"),uf(this,sf,df.derEncode(e),"f")}static from(e){if("string"==typeof e){const t=Gt(e);return this.fromRaw(t)}if(lf(e)){const t=e;if(lf(t)&&Object.hasOwnProperty.call(t,"__derEncodedPublicKey__"))return this.fromDer(t);if(ArrayBuffer.isView(t)){const e=t;return this.fromRaw(Yt(e.buffer))}if(t instanceof ArrayBuffer)return this.fromRaw(t);if("rawKey"in t)return this.fromRaw(t.rawKey);if("derKey"in t)return this.fromDer(t.derKey);if("toDer"in t)return this.fromDer(t.toDer())}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(e){return new df(e)}static fromDer(e){return new df(this.derDecode(e))}static derEncode(e){const t=Dc(e,Uc).buffer;return t.__derEncodedPublicKey__=void 0,t}static derDecode(e){const t=Fc(e,Uc);if(t.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return Yt(t)}get rawKey(){return ff(this,of,"f")}get derKey(){return ff(this,sf,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}of=new WeakMap,sf=new WeakMap,df.RAW_KEY_LENGTH=32;class hf extends Di{constructor(e,t){super(),af.set(this,void 0),cf.set(this,void 0),uf(this,af,df.from(e),"f"),uf(this,cf,new Uint8Array(t),"f")}static generate(e){if(e&&32!==e.length)throw new Error("Ed25519 Seed needs to be 32 bytes long.");e||(e=Tc.utils.randomPrivateKey()),Wt(e,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const t=new Uint8Array(32);for(let n=0;n<32;n++)t[n]=new Uint8Array(e)[n];const n=Tc.getPublicKey(t);return hf.fromKeyPair(n,t)}static fromParsedJson(e){const[t,n]=e;return new hf(df.fromDer(Gt(t)),Gt(n))}static fromJSON(e){const t=JSON.parse(e);if(Array.isArray(t)){if("string"==typeof t[0]&&"string"==typeof t[1])return this.fromParsedJson([t[0],t[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(e)}`)}static fromKeyPair(e,t){return new hf(df.fromRaw(e),t)}static fromSecretKey(e){const t=Tc.getPublicKey(new Uint8Array(e));return hf.fromKeyPair(t,e)}toJSON(){return[zt(ff(this,af,"f").toDer()),zt(ff(this,cf,"f"))]}getKeyPair(){return{secretKey:ff(this,cf,"f"),publicKey:ff(this,af,"f")}}getPublicKey(){return ff(this,af,"f")}async sign(e){const t=new Uint8Array(e),n=Zt(Tc.sign(t,ff(this,cf,"f").slice(0,32)));return Object.defineProperty(n,"__signature__",{enumerable:!1,value:void 0}),n}static verify(e,t,n){const[r,i,o]=[e,t,n].map((e=>("string"==typeof e&&(e=Gt(e)),e instanceof Uint8Array&&(e=Yt(e.buffer)),new Uint8Array(e))));return Tc.verify(r,i,o)}}af=new WeakMap,cf=new WeakMap;class pf extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,pf.prototype)}}function gf(e){if("undefined"!=typeof global&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(e)return e;if("undefined"!=typeof crypto&&crypto.subtle)return crypto.subtle;throw new pf("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class mf extends Di{constructor(e,t,n){super(),this._keyPair=e,this._derKey=t,this._subtleCrypto=n}static async generate(e){const{extractable:t=!1,keyUsages:n=["sign","verify"],subtleCrypto:r}=null!=e?e:{},i=gf(r),o=await i.generateKey({name:"ECDSA",namedCurve:"P-256"},t,n);return new this(o,await i.exportKey("spki",o.publicKey),i)}static async fromKeyPair(e,t){const n=gf(t),r=await n.exportKey("spki",e.publicKey);return new mf(e,r,n)}getKeyPair(){return this._keyPair}getPublicKey(){const e=this._derKey,t=Object.create(this._keyPair.publicKey);return t.toDer=function(){return e},t}async sign(e){return await this._subtleCrypto.sign({name:"ECDSA",hash:{name:"SHA-256"}},this._keyPair.privateKey,e)}}var yf,bf=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},wf=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class vf{constructor(e){yf.set(this,void 0),bf(this,yf,e,"f")}get rawKey(){return wf(this,yf,"f").rawKey}get derKey(){return wf(this,yf,"f").derKey}toDer(){return wf(this,yf,"f").toDer()}getPublicKey(){return wf(this,yf,"f")}getPrincipal(){if(!wf(this,yf,"f").rawKey)throw new Error("Cannot get principal from a public key without a raw key.");return qt.fromUint8Array(new Uint8Array(wf(this,yf,"f").rawKey))}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}yf=new WeakMap;var Ef,xf=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},_f=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},Af=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};const Tf=(new TextEncoder).encode("ic-request-auth-delegation"),Sf=(new TextEncoder).encode("\nic-request");function Bf(e){if("string"!=typeof e||e.length<64)throw new Error("Invalid public key.");return Gt(e)}class Nf{constructor(e,t,n){this.pubkey=e,this.expiration=t,this.targets=n}toCBOR(){return Ci.value.map(Object.assign({pubkey:Ci.value.bytes(this.pubkey),expiration:Ci.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:Ci.value.array(this.targets.map((e=>Ci.value.bytes(tn(e.toUint8Array())))))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:zt(this.pubkey)},this.targets&&{targets:this.targets.map((e=>e.toHex()))})}}class Of{constructor(e,t){this.delegations=e,this.publicKey=t}static async create(e,t,n=new Date(Date.now()+9e5),r={}){var i,o;const s=await async function(e,t,n,r){const i=new Nf(t.toDer(),BigInt(+n)*BigInt(1e6),r),o=new Uint8Array([...Tf,...new Uint8Array(Li(Object.assign({},i)))]);return{delegation:i,signature:await e.sign(tn(o))}}(e,t,n,r.targets);return new Of([...(null===(i=r.previous)||void 0===i?void 0:i.delegations)||[],s],(null===(o=r.previous)||void 0===o?void 0:o.publicKey)||e.getPublicKey().toDer())}static fromJSON(e){const{publicKey:t,delegations:n}="string"==typeof e?JSON.parse(e):e;if(!Array.isArray(n))throw new Error("Invalid delegations.");return new this(n.map((e=>{const{delegation:t,signature:n}=e,{pubkey:r,expiration:i,targets:o}=t;if(void 0!==o&&!Array.isArray(o))throw new Error("Invalid targets.");return{delegation:new Nf(Bf(r),BigInt("0x"+i),o&&o.map((e=>{if("string"!=typeof e)throw new Error("Invalid target.");return qt.fromHex(e)}))),signature:Bf(n)}})),Bf(t))}static fromDelegations(e,t){return new this(e,t)}toJSON(){return{delegations:this.delegations.map((e=>{const{delegation:t,signature:n}=e,{targets:r}=t;return{delegation:Object.assign({expiration:t.expiration.toString(16),pubkey:zt(t.pubkey)},r&&{targets:r.map((e=>e.toHex()))}),signature:zt(n)}})),publicKey:zt(this.publicKey)}}}class If extends Di{constructor(e,t){super(),this._inner=e,this._delegation=t}static fromDelegation(e,t){return new this(e,t)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(e){return this._inner.sign(e)}async transformRequest(e){const{body:t}=e,n=Af(e,["body"]),r=await Li(t);return Object.assign(Object.assign({},n),{body:{content:t,sender_sig:await this.sign(tn(new Uint8Array([...Sf,...new Uint8Array(r)]))),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class Rf extends vf{constructor(e,t){super(e),Ef.set(this,void 0),xf(this,Ef,t,"f")}get delegation(){return _f(this,Ef,"f")}static fromDelegation(e,t){return new Rf(e,t)}}var kf;Ef=new WeakMap,function(e){e[e.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"}(kf||(kf={}));const Lf=["mousedown","mousemove","keydown","touchstart","wheel"];class $f{constructor(e={}){var t;this.callbacks=[],this.idleTimeout=6e5,this.timeoutID=void 0;const{onIdle:n,idleTimeout:r=6e5}=e||{};this.callbacks=n?[n]:[],this.idleTimeout=r;const i=this._resetTimer.bind(this);window.addEventListener("load",i,!0),Lf.forEach((function(e){document.addEventListener(e,i,!0)}));const o=(e,t)=>{let n;return(...r)=>{const i=this;clearTimeout(n),n=window.setTimeout((function(){n=void 0,e.apply(i,r)}),t)}};if(null==e?void 0:e.captureScroll){const n=o(i,null!==(t=null==e?void 0:e.scrollDebounce)&&void 0!==t?t:100);window.addEventListener("scroll",n,!0)}i()}static create(e={}){return new this(e)}registerCallback(e){this.callbacks.push(e)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const e=this._resetTimer.bind(this);Lf.forEach((function(t){document.removeEventListener(t,e,!0)})),this.callbacks.forEach((e=>e()))}_resetTimer(){const e=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(e,this.idleTimeout)}}const Pf=(e,t)=>t.some((t=>e instanceof t));let Uf,Df;const Ff=new WeakMap,Cf=new WeakMap,Mf=new WeakMap,jf=new WeakMap,qf=new WeakMap;let Vf={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Cf.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Mf.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Gf(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function zf(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Df||(Df=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(Kf(this),t),Gf(Ff.get(this))}:function(...t){return Gf(e.apply(Kf(this),t))}:function(t,...n){const r=e.call(Kf(this),t,...n);return Mf.set(r,t.sort?t.sort():[t]),Gf(r)}}function Hf(e){return"function"==typeof e?zf(e):(e instanceof IDBTransaction&&function(e){if(Cf.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));Cf.set(e,t)}(e),Pf(e,Uf||(Uf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Vf):e)}function Gf(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(Gf(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&Ff.set(t,e)})).catch((()=>{})),qf.set(t,e),t}(e);if(jf.has(e))return jf.get(e);const t=Hf(e);return t!==e&&(jf.set(e,t),qf.set(t,e)),t}const Kf=e=>qf.get(e);const Wf=["get","getKey","getAll","getAllKeys","count"],Zf=["put","add","delete","clear"],Yf=new Map;function Xf(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Yf.get(t))return Yf.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Zf.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Wf.includes(n))return;const o=async function(e,...t){const o=this.transaction(e,i?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&o.done]))[0]};return Yf.set(t,o),o}Vf=(e=>({...e,get:(t,n,r)=>Xf(t,n)||e.get(t,n,r),has:(t,n)=>!!Xf(t,n)||e.has(t,n)}))(Vf);const Jf="auth-client-db",Qf="ic-keyval",el=async(e=Jf,t=Qf,n)=>(cl&&(null===localStorage||void 0===localStorage?void 0:localStorage.getItem(sl))&&(localStorage.removeItem(sl),localStorage.removeItem(ol)),await function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(e,t),a=Gf(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(Gf(s.result),e.oldVersion,e.newVersion,Gf(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{o&&e.addEventListener("close",(()=>o())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(e,n,{upgrade:e=>{e.objectStoreNames.contains(t)&&e.clear(t),e.createObjectStore(t)}}));class tl{constructor(e,t){this._db=e,this._storeName=t}static async create(e){const{dbName:t=Jf,storeName:n=Qf,version:r=al}=null!=e?e:{},i=await el(t,n,r);return new tl(i,n)}async set(e,t){return await async function(e,t,n,r){return await e.put(t,r,n)}(this._db,this._storeName,e,t)}async get(e){var t;return null!==(t=await async function(e,t,n){return await e.get(t,n)}(this._db,this._storeName,e))&&void 0!==t?t:null}async remove(e){return await async function(e,t,n){return await e.delete(t,n)}(this._db,this._storeName,e)}}var nl,rl=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},il=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};const ol="identity",sl="delegation",al=1,cl="undefined"!=typeof window;class ul{constructor(e="ic-",t){this.prefix=e,this._localStorage=t}get(e){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+e))}set(e,t){return this._getLocalStorage().setItem(this.prefix+e,t),Promise.resolve()}remove(e){return this._getLocalStorage().removeItem(this.prefix+e),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const e="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?void 0:self.localStorage:global.localStorage:window.localStorage;if(!e)throw new Error("Could not find local storage.");return e}}class fl{constructor(e){nl.set(this,void 0),rl(this,nl,null!=e?e:{},"f")}get _db(){return new Promise((e=>{this.initializedDb?e(this.initializedDb):tl.create(il(this,nl,"f")).then((t=>{this.initializedDb=t,e(t)}))}))}async get(e){const t=await this._db;return await t.get(e)}async set(e,t){const n=await this._db;await n.set(e,t)}async remove(e){const t=await this._db;await t.remove(e)}}nl=new WeakMap;const ll="ECDSA",dl="Ed25519";class hl{constructor(e,t,n,r,i,o,s,a){this._identity=e,this._key=t,this._chain=n,this._storage=r,this.idleManager=i,this._createOptions=o,this._idpWindow=s,this._eventHandler=a,this._registerDefaultIdleCallback()}static async create(e={}){var t,n,r;const i=null!==(t=e.storage)&&void 0!==t?t:new fl,o=null!==(n=e.keyType)&&void 0!==n?n:ll;let s=null;if(e.identity)s=e.identity;else{let e=await i.get(ol);if(!e&&cl)try{const t=new ul,n=await t.get(sl),r=await t.get(ol);n&&r&&o===ll&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await i.set(sl,n),await i.set(ol,r),e=n,await t.remove(sl),await t.remove(ol))}catch(e){console.error("error while attempting to recover localstorage: "+e)}if(e)try{"object"==typeof e?s=o===dl&&"string"==typeof e?await hf.fromJSON(e):await mf.fromKeyPair(e):"string"==typeof e&&(s=hf.fromJSON(e))}catch(e){}}let a,c=new Fi,u=null;if(s)try{const t=await i.get(sl);if("object"==typeof t&&null!==t)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");e.identity?c=e.identity:t&&(u=Of.fromJSON(t),!function(e,t){for(const{delegation:t}of e.delegations)if(+new Date(Number(t.expiration/BigInt(1e6)))<=+Date.now())return!1;const n=[],r=null==t?void 0:t.scope;r&&(Array.isArray(r)?n.push(...r.map((e=>"string"==typeof e?qt.fromText(e):e))):n.push("string"==typeof r?qt.fromText(r):r));for(const t of n){const n=t.toText();for(const{delegation:t}of e.delegations){if(void 0===t.targets)continue;let e=!0;for(const r of t.targets)if(r.toText()===n){e=!1;break}if(e)return!1}}return!0}(u)?(await pl(i),s=null):c="toDer"in s?Rf.fromDelegation(s,u):If.fromDelegation(s,u))}catch(e){console.error(e),await pl(i),s=null}return(null===(r=e.idleOptions)||void 0===r?void 0:r.disableIdle)?a=void 0:(u||e.identity)&&(a=$f.create(e.idleOptions)),s||(o===dl?(s=await hf.generate(),await i.set(ol,JSON.stringify(s.toJSON()))):(e.storage&&o===ll&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${dl}' as the key type, as it can serialize to a string`),s=await mf.generate(),await i.set(ol,s.getKeyPair()))),new this(c,s,u,i,a,e)}_registerDefaultIdleCallback(){var e,t;const n=null===(e=this._createOptions)||void 0===e?void 0:e.idleOptions;(null==n?void 0:n.onIdle)||(null==n?void 0:n.disableDefaultIdleCallback)||null===(t=this.idleManager)||void 0===t||t.registerCallback((()=>{this.logout(),location.reload()}))}async _handleSuccess(e,t){var n,r;const i=e.delegations.map((e=>({delegation:new Nf(e.delegation.pubkey,e.delegation.expiration,e.delegation.targets),signature:e.signature.buffer}))),o=Of.fromDelegations(i,e.userPublicKey.buffer),s=this._key;if(!s)return;this._chain=o,this._identity="toDer"in s?Rf.fromDelegation(s,this._chain):If.fromDelegation(s,this._chain),null===(n=this._idpWindow)||void 0===n||n.close();const a=null===(r=this._createOptions)||void 0===r?void 0:r.idleOptions;this.idleManager||(null==a?void 0:a.disableIdle)||(this.idleManager=$f.create(a),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(sl,JSON.stringify(this._chain.toJSON())),null==t||t(e)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&null!==this._chain}async login(e){var t,n,r,i;const o=BigInt(8)*BigInt(36e11),s=new URL((null===(t=null==e?void 0:e.identityProvider)||void 0===t?void 0:t.toString())||"https://identity.internetcomputer.org");s.hash="#authorize",null===(n=this._idpWindow)||void 0===n||n.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(s,Object.assign({maxTimeToLive:null!==(r=null==e?void 0:e.maxTimeToLive)&&void 0!==r?r:o},e)),window.addEventListener("message",this._eventHandler),this._idpWindow=null!==(i=window.open(s.toString(),"idpWindow",null==e?void 0:e.windowOpenerFeatures))&&void 0!==i?i:void 0;const a=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure("UserInterrupt",null==e?void 0:e.onError):setTimeout(a,500))};a()}_getEventHandler(e,t){return async n=>{var r,i,o;if(n.origin!==e.origin)return;const s=n.data;switch(s.kind){case"authorize-ready":{const n=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array(null===(r=this._key)||void 0===r?void 0:r.getPublicKey().toDer()),maxTimeToLive:null==t?void 0:t.maxTimeToLive,allowPinAuthentication:null==t?void 0:t.allowPinAuthentication,derivationOrigin:null===(i=null==t?void 0:t.derivationOrigin)||void 0===i?void 0:i.toString()},null==t?void 0:t.customValues);null===(o=this._idpWindow)||void 0===o||o.postMessage(n,e.origin);break}case"authorize-client-success":try{await this._handleSuccess(s,null==t?void 0:t.onSuccess)}catch(e){this._handleFailure(e.message,null==t?void 0:t.onError)}break;case"authorize-client-failure":this._handleFailure(s.text,null==t?void 0:t.onError)}}}_handleFailure(e,t){var n;null===(n=this._idpWindow)||void 0===n||n.close(),null==t||t(e),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(e={}){if(await pl(this._storage),this._identity=new Fi,this._chain=null,e.returnTo)try{window.history.pushState({},"",e.returnTo)}catch(t){window.location.href=e.returnTo}}}async function pl(e){await e.remove(ol),await e.remove(sl),await e.remove("iv")}function gl(e){return new Promise(((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)}))}let ml;function yl(){return ml||(ml=function(e,t){const n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);const r=gl(n);return(e,n)=>r.then((r=>n(r.transaction(t,e).objectStore(t))))}("keyval-store","keyval")),ml}function bl(e,t=yl()){return t("readonly",(t=>gl(t.get(e))))}const wl="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function vl(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function El(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function xl(e,...t){if(!vl(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function _l(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");El(e.outputLen),El(e.blockLen)}function Al(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Tl(e,t){xl(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Sl(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Bl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Nl(e,t){return e<<32-t|e>>>t}function Ol(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const Il=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]?e=>e:function(e){for(let t=0;t<e.length;t++)e[t]=Ol(e[t]);return e},Rl="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,kl=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function Ll(e){if(xl(e),Rl)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=kl[e[n]];return t}const $l={_0:48,_9:57,A:65,F:70,a:97,f:102};function Pl(e){return e>=$l._0&&e<=$l._9?e-$l._0:e>=$l.A&&e<=$l.F?e-($l.A-10):e>=$l.a&&e<=$l.f?e-($l.a-10):void 0}function Ul(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(Rl)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let t=0,i=0;t<n;t++,i+=2){const n=Pl(e.charCodeAt(i)),o=Pl(e.charCodeAt(i+1));if(void 0===n||void 0===o){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}r[t]=16*n+o}return r}function Dl(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}function Fl(e){return"string"==typeof e&&(e=Dl(e)),xl(e),e}function Cl(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];xl(r),t+=r.length}const n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const i=e[t];n.set(i,r),r+=i.length}return n}class Ml{}function jl(e){const t=t=>e().update(Fl(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function ql(e=32){if(wl&&"function"==typeof wl.getRandomValues)return wl.getRandomValues(new Uint8Array(e));if(wl&&"function"==typeof wl.randomBytes)return Uint8Array.from(wl.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function Vl(e,t,n){return e&t^~e&n}function zl(e,t,n){return e&t^e&n^t&n}class Hl extends Ml{constructor(e,t,n,r){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.buffer=new Uint8Array(e),this.view=Bl(this.buffer)}update(e){Al(this),xl(e=Fl(e));const{view:t,buffer:n,blockLen:r}=this,i=e.length;for(let o=0;o<i;){const s=Math.min(r-this.pos,i-o);if(s!==r)n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=Bl(e);for(;r<=i-o;o+=r)this.process(t,o)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){Al(this),Tl(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:i}=this;let{pos:o}=this;t[o++]=128,Sl(this.buffer.subarray(o)),this.padOffset>r-o&&(this.process(n,0),o=0);for(let e=o;e<r;e++)t[e]=0;(function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),o=BigInt(4294967295),s=Number(n>>i&o),a=Number(n&o),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)})(n,r-8,BigInt(8*this.length),i),this.process(n,0);const s=Bl(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:o,pos:s}=this;return e.destroyed=o,e.finished=i,e.length=r,e.pos=s,r%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const Gl=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Kl=BigInt(2**32-1),Wl=BigInt(32);function Zl(e,t=!1){return t?{h:Number(e&Kl),l:Number(e>>Wl&Kl)}:{h:0|Number(e>>Wl&Kl),l:0|Number(e&Kl)}}function Yl(e,t=!1){const n=e.length;let r=new Uint32Array(n),i=new Uint32Array(n);for(let o=0;o<n;o++){const{h:n,l:s}=Zl(e[o],t);[r[o],i[o]]=[n,s]}return[r,i]}const Xl=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Jl=new Uint32Array(64);class Ql extends Hl{constructor(e=32){super(64,e,8,!1),this.A=0|Gl[0],this.B=0|Gl[1],this.C=0|Gl[2],this.D=0|Gl[3],this.E=0|Gl[4],this.F=0|Gl[5],this.G=0|Gl[6],this.H=0|Gl[7]}get(){const{A:e,B:t,C:n,D:r,E:i,F:o,G:s,H:a}=this;return[e,t,n,r,i,o,s,a]}set(e,t,n,r,i,o,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)Jl[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=Jl[e-15],n=Jl[e-2],r=Nl(t,7)^Nl(t,18)^t>>>3,i=Nl(n,17)^Nl(n,19)^n>>>10;Jl[e]=i+Jl[e-7]+r+Jl[e-16]|0}let{A:n,B:r,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(Nl(s,6)^Nl(s,11)^Nl(s,25))+Vl(s,a,c)+Xl[e]+Jl[e]|0,f=(Nl(n,2)^Nl(n,13)^Nl(n,22))+zl(n,r,i)|0;u=c,c=a,a=s,s=o+t|0,o=i,i=r,r=n,n=t+f|0}n=n+this.A|0,r=r+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,i,o,s,a,c,u)}roundClean(){Sl(Jl)}destroy(){this.set(0,0,0,0,0,0,0,0),Sl(this.buffer)}}Yl(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e))));const ed=jl((()=>new Ql)),td=BigInt(0),nd=BigInt(1);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function rd(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}function id(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?td:BigInt("0x"+e)}function od(e){return id(Ll(e))}function sd(e){return xl(e),id(Ll(Uint8Array.from(e).reverse()))}function ad(e,t){return Ul(e.toString(16).padStart(2*t,"0"))}function cd(e,t){return ad(e,t).reverse()}function ud(e,t,n){let r;if("string"==typeof t)try{r=Ul(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!vl(t))throw new Error(e+" must be hex string or Uint8Array");r=Uint8Array.from(t)}const i=r.length;if("number"==typeof n&&i!==n)throw new Error(e+" of length "+n+" expected, got "+i);return r}const fd=e=>"bigint"==typeof e&&td<=e;function ld(e){let t;for(t=0;e>td;e>>=nd,t+=1);return t}function dd(e,t){return e>>BigInt(t)&nd}const hd=e=>(nd<<BigInt(e))-nd;function pd(e,t,n={}){if(!e||"object"!=typeof e)throw new Error("expected valid options object");function r(t,n,r){const i=e[t];if(r&&void 0===i)return;const o=typeof i;if(o!==n||null===i)throw new Error(`param "${t}" is invalid: expected ${n}, got ${o}`)}Object.entries(t).forEach((([e,t])=>r(e,t,!1))),Object.entries(n).forEach((([e,t])=>r(e,t,!0)))}const gd=()=>{throw new Error("not implemented")};function md(e){const t=new WeakMap;return(n,...r)=>{const i=t.get(n);if(void 0!==i)return i;const o=e(n,...r);return t.set(n,o),o}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const yd=BigInt(0),bd=BigInt(1),wd=BigInt(2),vd=BigInt(3),Ed=BigInt(4),xd=BigInt(5),_d=BigInt(8);function Ad(e,t){const n=e%t;return n>=yd?n:t+n}function Td(e,t){if(e===yd)throw new Error("invert: expected non-zero number");if(t<=yd)throw new Error("invert: expected positive modulus, got "+t);let n=Ad(e,t),r=t,i=yd,o=bd;for(;n!==yd;){const e=r%n,t=i-o*(r/n);r=n,n=e,i=o,o=t}if(r!==bd)throw new Error("invert: does not exist");return Ad(i,t)}function Sd(e,t){const n=(e.ORDER+bd)/Ed,r=e.pow(t,n);if(!e.eql(e.sqr(r),t))throw new Error("Cannot find square root");return r}function Bd(e,t){const n=(e.ORDER-xd)/_d,r=e.mul(t,wd),i=e.pow(r,n),o=e.mul(t,i),s=e.mul(e.mul(o,wd),i),a=e.mul(o,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}function Nd(e){return e%Ed===vd?Sd:e%_d===xd?Bd:function(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-bd,n=0;for(;t%wd===yd;)t/=wd,n++;let r=wd;const i=$d(e);for(;1===Ld(i,r);)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===n)return Sd;let o=i.pow(r,t);const s=(t+bd)/wd;return function(e,r){if(e.is0(r))return r;if(1!==Ld(e,r))throw new Error("Cannot find square root");let i=n,a=e.mul(e.ONE,o),c=e.pow(r,t),u=e.pow(r,s);for(;!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;let t=1,n=e.sqr(c);for(;!e.eql(n,e.ONE);)if(t++,n=e.sqr(n),t===i)throw new Error("Cannot find square root");const r=bd<<BigInt(i-t-1),o=e.pow(a,r);i=t,a=e.sqr(o),c=e.mul(c,a),u=e.mul(u,o)}return u}}(e)}const Od=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Id(e){return pd(e,Od.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),e}function Rd(e,t,n){if(n<yd)throw new Error("invalid exponent, negatives unsupported");if(n===yd)return e.ONE;if(n===bd)return t;let r=e.ONE,i=t;for(;n>yd;)n&bd&&(r=e.mul(r,i)),i=e.sqr(i),n>>=bd;return r}function kd(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),i=t.reduce(((t,n,i)=>e.is0(n)?t:(r[i]=t,e.mul(t,n))),e.ONE),o=e.inv(i);return t.reduceRight(((t,n,i)=>e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n))),o),r}function Ld(e,t){const n=(e.ORDER-bd)/wd,r=e.pow(t,n),i=e.eql(r,e.ONE),o=e.eql(r,e.ZERO),s=e.eql(r,e.neg(e.ONE));if(!i&&!o&&!s)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function $d(e,t,n=!1,r={}){if(e<=yd)throw new Error("invalid field: expected ORDER > 0, got "+e);let i,o;if("object"==typeof t&&null!=t){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const e=t;e.BITS&&(i=e.BITS),e.sqrt&&(o=e.sqrt),"boolean"==typeof e.isLE&&(n=e.isLE)}else"number"==typeof t&&(i=t),r.sqrt&&(o=r.sqrt);const{nBitLength:s,nByteLength:a}=function(e,t){void 0!==t&&El(t);const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}(e,i);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const u=Object.freeze({ORDER:e,isLE:n,BITS:s,BYTES:a,MASK:hd(s),ZERO:yd,ONE:bd,create:t=>Ad(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return yd<=t&&t<e},is0:e=>e===yd,isValidNot0:e=>!u.is0(e)&&u.isValid(e),isOdd:e=>(e&bd)===bd,neg:t=>Ad(-t,e),eql:(e,t)=>e===t,sqr:t=>Ad(t*t,e),add:(t,n)=>Ad(t+n,e),sub:(t,n)=>Ad(t-n,e),mul:(t,n)=>Ad(t*n,e),pow:(e,t)=>Rd(u,e,t),div:(t,n)=>Ad(t*Td(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>Td(t,e),sqrt:o||(t=>(c||(c=Nd(e)),c(u,t))),toBytes:e=>n?cd(e,a):ad(e,a),fromBytes:e=>{if(e.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+e.length);return n?sd(e):od(e)},invertBatch:e=>kd(u,e),cmov:(e,t,n)=>n?t:e});return Object.freeze(u)}function Pd(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function Ud(e){const t=Pd(e);return t+Math.ceil(t/2)}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const Dd=BigInt(0),Fd=BigInt(1);function Cd(e,t){const n=t.negate();return e?n:t}function Md(e,t,n){const r="pz"===t?e=>e.pz:e=>e.ez,i=kd(e.Fp,n.map(r));return n.map(((e,t)=>e.toAffine(i[t]))).map(e.fromAffine)}function jd(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function qd(e,t){jd(e,t);const n=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:hd(e),maxNumber:n,shiftBy:BigInt(e)}}function Vd(e,t,n){const{windowSize:r,mask:i,maxNumber:o,shiftBy:s}=n;let a=Number(e&i),c=e>>s;a>r&&(a-=o,c+=Fd);const u=t*r;return{nextN:c,offset:u+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:t%2!=0,offsetF:u}}const zd=new WeakMap,Hd=new WeakMap;function Gd(e){return Hd.get(e)||1}function Kd(e){if(e!==Dd)throw new Error("invalid wNAF")}function Wd(e,t,n,r){(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach(((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)}))})(n,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach(((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)}))}(r,t);const i=n.length,o=r.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");const s=e.ZERO,a=ld(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=hd(c),f=new Array(Number(u)+1).fill(s);let l=s;for(let e=Math.floor((t.BITS-1)/c)*c;e>=0;e-=c){f.fill(s);for(let t=0;t<o;t++){const i=r[t],o=Number(i>>BigInt(e)&u);f[o]=f[o].add(n[t])}let t=s;for(let e=f.length-1,n=s;e>0;e--)n=n.add(f[e]),t=t.add(n);if(l=l.add(t),0!==e)for(let e=0;e<c;e++)l=l.double()}return l}function Zd(e,t){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Id(t),t}return $d(e)}const Yd=od;function Xd(e,t){if(Qd(e),Qd(t),e<0||e>=1<<8*t)throw new Error("invalid I2OSP input: "+e);const n=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)n[r]=255&e,e>>>=8;return new Uint8Array(n)}function Jd(e,t){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}function Qd(e){if(!Number.isSafeInteger(e))throw new Error("number expected")}function eh(e,t,n){pd(n,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:r,k:i,m:o,hash:s,expand:a,DST:c}=n;if(!vl(c)&&"string"!=typeof c)throw new Error("DST must be string or uint8array");if(!function(e){return"function"==typeof e&&Number.isSafeInteger(e.outputLen)}(n.hash))throw new Error("expected valid hash");xl(e),Qd(t);const u="string"==typeof c?Dl(c):c,f=r.toString(2).length,l=Math.ceil((f+i)/8),d=t*o*l;let h;if("xmd"===a)h=function(e,t,n,r){xl(e),xl(t),Qd(n),t.length>255&&(t=r(Cl(Dl("H2C-OVERSIZE-DST-"),t)));const{outputLen:i,blockLen:o}=r,s=Math.ceil(n/i);if(n>65535||s>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=Cl(t,Xd(t.length,1)),c=Xd(0,o),u=Xd(n,2),f=new Array(s),l=r(Cl(c,e,u,Xd(0,1),a));f[0]=r(Cl(l,Xd(1,1),a));for(let e=1;e<=s;e++){const t=[Jd(l,f[e-1]),Xd(e+1,1),a];f[e]=r(Cl(...t))}return Cl(...f).slice(0,n)}(e,u,d,s);else if("xof"===a)h=function(e,t,n,r,i){if(xl(e),xl(t),Qd(n),t.length>255){const e=Math.ceil(2*r/8);t=i.create({dkLen:e}).update(Dl("H2C-OVERSIZE-DST-")).update(t).digest()}if(n>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:n}).update(e).update(Xd(n,2)).update(t).update(Xd(t.length,1)).digest()}(e,u,d,i,s);else{if("_internal_pass"!==a)throw new Error('expand must be "xmd" or "xof"');h=e}const p=new Array(t);for(let e=0;e<t;e++){const t=new Array(o);for(let n=0;n<o;n++){const i=l*(n+e*o),s=h.subarray(i,i+l);t[n]=Ad(Yd(s),r)}p[e]=t}return p}function th(e,t){const n=t.map((e=>Array.from(e).reverse()));return(t,r)=>{const[i,o,s,a]=n.map((n=>n.reduce(((n,r)=>e.add(e.mul(n,t),r))))),[c,u]=kd(e,[o,a],!0);return t=e.mul(i,c),r=e.mul(r,e.mul(s,u)),{x:t,y:r}}}function nh(e,t,n){if("function"!=typeof t)throw new Error("mapToCurve() must be defined");function r(n){return e.fromAffine(t(n))}function i(t){const n=t.clearCofactor();return n.equals(e.ZERO)?e.ZERO:(n.assertValidity(),n)}return{defaults:n,hashToCurve(e,t){const o=n.DST?n.DST:{},s=eh(e,2,Object.assign({},n,o,t)),a=r(s[0]),c=r(s[1]);return i(a.add(c))},encodeToCurve(e,t){const o=n.encodeDST?n.encodeDST:{};return i(r(eh(e,1,Object.assign({},n,o,t))[0]))},mapToCurve(e){if(!Array.isArray(e))throw new Error("expected array of bigints");for(const t of e)if("bigint"!=typeof t)throw new Error("expected array of bigints");return i(r(e))}}}class rh extends Ml{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,_l(e);const n=Fl(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,i=new Uint8Array(r);i.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),Sl(i)}update(e){return Al(this),this.iHash.update(e),this}digestInto(e){Al(this),xl(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:o,outputLen:s}=this;return e.finished=r,e.destroyed=i,e.blockLen=o,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ih=(e,t,n)=>new rh(e,t).update(n).digest();ih.create=(e,t)=>new rh(e,t)
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */;const oh=BigInt(0),sh=BigInt(1),ah=BigInt(2),ch=BigInt(3),uh=BigInt(4);function fh(e,t,n){return function(r){const i=e.sqr(r),o=e.mul(i,r);return e.add(e.add(o,e.mul(r,t)),n)}}function lh(e,t,n){const{BYTES:r}=e;return function(i){let o;if("bigint"==typeof i)o=i;else{let n=ud("private key",i);if(t){if(!t.includes(2*n.length))throw new Error("invalid private key");const e=new Uint8Array(r);e.set(n,e.length-n.length),n=e}try{o=e.fromBytes(n)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(n&&(o=e.create(o)),!e.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}}function dh(e,t={}){const{Fp:n,Fn:r}=function(e,t,n={}){if(!t||"object"!=typeof t)throw new Error(`expected valid ${e} CURVE object`);for(const e of["p","n","h"]){const n=t[e];if(!("bigint"==typeof n&&n>Dd))throw new Error(`CURVE.${e} must be positive bigint`)}const r=Zd(t.p,n.Fp),i=Zd(t.n,n.Fn),o=["Gx","Gy","a","weierstrass"===e?"b":"d"];for(const e of o)if(!r.isValid(t[e]))throw new Error(`CURVE.${e} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:i}}("weierstrass",e,t),{h:i,n:o}=e;pd(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:s}=t;if(s&&(!n.is0(e.a)||"bigint"!=typeof s.beta||"function"!=typeof s.splitScalar))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const c=t.toBytes||function(e,t,r){const{x:i,y:o}=t.toAffine(),s=n.toBytes(i);if(rd("isCompressed",r),r){a();return Cl(function(e){return Uint8Array.of(e?2:3)}(!n.isOdd(o)),s)}return Cl(Uint8Array.of(4),s,n.toBytes(o))},u=t.fromBytes||function(e){xl(e);const t=n.BYTES,r=t+1,i=2*t+1,o=e.length,s=e[0],c=e.subarray(1);if(o!==r||2!==s&&3!==s){if(o===i&&4===s){const e=n.fromBytes(c.subarray(0*t,1*t)),r=n.fromBytes(c.subarray(1*t,2*t));if(!l(e,r))throw new Error("bad point: is not on curve");return{x:e,y:r}}throw new Error(`bad point: got length ${o}, expected compressed=${r} or uncompressed=${i}`)}{const e=n.fromBytes(c);if(!n.isValid(e))throw new Error("bad point: is not on curve, wrong x");const t=f(e);let r;try{r=n.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("bad point: is not on curve, sqrt error"+t)}a();return 1==(1&s)!==n.isOdd(r)&&(r=n.neg(r)),{x:e,y:r}}},f=fh(n,e.a,e.b);function l(e,t){const r=n.sqr(t),i=f(e);return n.eql(r,i)}if(!l(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const d=n.mul(n.pow(e.a,ch),uh),h=n.mul(n.sqr(e.b),BigInt(27));if(n.is0(n.add(d,h)))throw new Error("bad curve params: a or b");function p(e,t,r=!1){if(!n.isValid(t)||r&&n.is0(t))throw new Error(`bad point coordinate ${e}`);return t}function g(e){if(!(e instanceof w))throw new Error("ProjectivePoint expected")}const m=md(((e,t)=>{const{px:r,py:i,pz:o}=e;if(n.eql(o,n.ONE))return{x:r,y:i};const s=e.is0();null==t&&(t=s?n.ONE:n.inv(o));const a=n.mul(r,t),c=n.mul(i,t),u=n.mul(o,t);if(s)return{x:n.ZERO,y:n.ZERO};if(!n.eql(u,n.ONE))throw new Error("invZ was invalid");return{x:a,y:c}})),y=md((e=>{if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:r,y:i}=e.toAffine();if(!n.isValid(r)||!n.isValid(i))throw new Error("bad point: x or y not field elements");if(!l(r,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));function b(e,t,r,i,o){return r=new w(n.mul(r.px,e),r.py,r.pz),t=Cd(i,t),r=Cd(o,r),t.add(r)}class w{constructor(e,t,n){this.px=p("x",e),this.py=p("y",t,!0),this.pz=p("z",n),Object.freeze(this)}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof w)throw new Error("projective point not allowed");return n.is0(t)&&n.is0(r)?w.ZERO:new w(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){return Md(w,"pz",e)}static fromBytes(e){return xl(e),w.fromHex(e)}static fromHex(e){const t=w.fromAffine(u(ud("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){const n=lh(r,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return w.BASE.multiply(n(e))}static msm(e,t){return Wd(w,r,e,t)}precompute(e=8,t=!0){return E.setWindowSize(this,e),t||this.multiply(ch),this}_setWindowSize(e){this.precompute(e)}assertValidity(){y(this)}hasEvenY(){const{y:e}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(e)}equals(e){g(e);const{px:t,py:r,pz:i}=this,{px:o,py:s,pz:a}=e,c=n.eql(n.mul(t,a),n.mul(o,i)),u=n.eql(n.mul(r,a),n.mul(s,i));return c&&u}negate(){return new w(this.px,n.neg(this.py),this.pz)}double(){const{a:t,b:r}=e,i=n.mul(r,ch),{px:o,py:s,pz:a}=this;let c=n.ZERO,u=n.ZERO,f=n.ZERO,l=n.mul(o,o),d=n.mul(s,s),h=n.mul(a,a),p=n.mul(o,s);return p=n.add(p,p),f=n.mul(o,a),f=n.add(f,f),c=n.mul(t,f),u=n.mul(i,h),u=n.add(c,u),c=n.sub(d,u),u=n.add(d,u),u=n.mul(c,u),c=n.mul(p,c),f=n.mul(i,f),h=n.mul(t,h),p=n.sub(l,h),p=n.mul(t,p),p=n.add(p,f),f=n.add(l,l),l=n.add(f,l),l=n.add(l,h),l=n.mul(l,p),u=n.add(u,l),h=n.mul(s,a),h=n.add(h,h),l=n.mul(h,p),c=n.sub(c,l),f=n.mul(h,d),f=n.add(f,f),f=n.add(f,f),new w(c,u,f)}add(t){g(t);const{px:r,py:i,pz:o}=this,{px:s,py:a,pz:c}=t;let u=n.ZERO,f=n.ZERO,l=n.ZERO;const d=e.a,h=n.mul(e.b,ch);let p=n.mul(r,s),m=n.mul(i,a),y=n.mul(o,c),b=n.add(r,i),v=n.add(s,a);b=n.mul(b,v),v=n.add(p,m),b=n.sub(b,v),v=n.add(r,o);let E=n.add(s,c);return v=n.mul(v,E),E=n.add(p,y),v=n.sub(v,E),E=n.add(i,o),u=n.add(a,c),E=n.mul(E,u),u=n.add(m,y),E=n.sub(E,u),l=n.mul(d,v),u=n.mul(h,y),l=n.add(u,l),u=n.sub(m,l),l=n.add(m,l),f=n.mul(u,l),m=n.add(p,p),m=n.add(m,p),y=n.mul(d,y),v=n.mul(h,v),m=n.add(m,y),y=n.sub(p,y),y=n.mul(d,y),v=n.add(v,y),p=n.mul(m,v),f=n.add(f,p),p=n.mul(E,v),u=n.mul(b,u),u=n.sub(u,p),p=n.mul(b,m),l=n.mul(E,l),l=n.add(l,p),new w(u,f,l)}subtract(e){return this.add(e.negate())}is0(){return this.equals(w.ZERO)}multiply(e){const{endo:n}=t;if(!r.isValidNot0(e))throw new Error("invalid scalar: out of range");let i,o;const s=e=>E.wNAFCached(this,e,w.normalizeZ);if(n){const{k1neg:t,k1:r,k2neg:a,k2:c}=n.splitScalar(e),{p:u,f:f}=s(r),{p:l,f:d}=s(c);o=f.add(d),i=b(n.beta,u,l,t,a)}else{const{p:t,f:n}=s(e);i=t,o=n}return w.normalizeZ([i,o])[0]}multiplyUnsafe(e){const{endo:n}=t,i=this;if(!r.isValid(e))throw new Error("invalid scalar: out of range");if(e===oh||i.is0())return w.ZERO;if(e===sh)return i;if(E.hasPrecomputes(this))return this.multiply(e);if(n){const{k1neg:t,k1:r,k2neg:o,k2:s}=n.splitScalar(e),{p1:a,p2:c}=function(e,t,n,r){let i=t,o=e.ZERO,s=e.ZERO;for(;n>Dd||r>Dd;)n&Fd&&(o=o.add(i)),r&Fd&&(s=s.add(i)),i=i.double(),n>>=Fd,r>>=Fd;return{p1:o,p2:s}}(w,i,r,s);return b(n.beta,a,c,t,o)}return E.wNAFCachedUnsafe(i,e)}multiplyAndAddUnsafe(e,t,n){const r=this.multiplyUnsafe(t).add(e.multiplyUnsafe(n));return r.is0()?void 0:r}toAffine(e){return m(this,e)}isTorsionFree(){const{isTorsionFree:e}=t;return i===sh||(e?e(w,this):E.wNAFCachedUnsafe(this,o).is0())}clearCofactor(){const{clearCofactor:e}=t;return i===sh?this:e?e(w,this):this.multiplyUnsafe(i)}toBytes(e=!0){return rd("isCompressed",e),this.assertValidity(),c(w,this,e)}toRawBytes(e=!0){return this.toBytes(e)}toHex(e=!0){return Ll(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}w.BASE=new w(e.Gx,e.Gy,n.ONE),w.ZERO=new w(n.ZERO,n.ONE,n.ZERO),w.Fp=n,w.Fn=r;const v=r.BITS,E=function(e,t){return{constTimeNegate:Cd,hasPrecomputes:e=>1!==Gd(e),unsafeLadder(t,n,r=e.ZERO){let i=t;for(;n>Dd;)n&Fd&&(r=r.add(i)),i=i.double(),n>>=Fd;return r},precomputeWindow(e,n){const{windows:r,windowSize:i}=qd(n,t),o=[];let s=e,a=s;for(let e=0;e<r;e++){a=s,o.push(a);for(let e=1;e<i;e++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(n,r,i){let o=e.ZERO,s=e.BASE;const a=qd(n,t);for(let e=0;e<a.windows;e++){const{nextN:t,offset:n,isZero:c,isNeg:u,isNegF:f,offsetF:l}=Vd(i,e,a);i=t,c?s=s.add(Cd(f,r[l])):o=o.add(Cd(u,r[n]))}return Kd(i),{p:o,f:s}},wNAFUnsafe(n,r,i,o=e.ZERO){const s=qd(n,t);for(let e=0;e<s.windows&&i!==Dd;e++){const{nextN:t,offset:n,isZero:a,isNeg:c}=Vd(i,e,s);if(i=t,!a){const e=r[n];o=o.add(c?e.negate():e)}}return Kd(i),o},getPrecomputes(e,t,n){let r=zd.get(t);return r||(r=this.precomputeWindow(t,e),1!==e&&("function"==typeof n&&(r=n(r)),zd.set(t,r))),r},wNAFCached(e,t,n){const r=Gd(e);return this.wNAF(r,this.getPrecomputes(r,e,n),t)},wNAFCachedUnsafe(e,t,n,r){const i=Gd(e);return 1===i?this.unsafeLadder(e,t,r):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),t,r)},setWindowSize(e,n){jd(n,t),Hd.set(e,n),zd.delete(e)}}}(w,t.endo?Math.ceil(v/2):v);return w}function hh(e){const{CURVE:t,curveOpts:n}=function(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp,r=$d(t.n,e.nBitLength),i={Fp:n,Fn:r,allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:i}}(e);return function(e,t){const{Fp:n,Fn:r}=t;function i(e){return function(e,t,n){return fd(e)&&fd(t)&&fd(n)&&t<=e&&e<n}(e,sh,r.ORDER)}const o=fh(n,e.a,e.b),s=lh(r,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return Object.assign({},{CURVE:e,Point:t,ProjectivePoint:t,normPrivateKeyToScalar:s,weierstrassEquation:o,isWithinCurveOrder:i})}(e,dh(t,n))}function ph(e,t){Id(e);const{A:n,B:r,Z:i}=t;if(!e.isValid(n)||!e.isValid(r)||!e.isValid(i))throw new Error("mapToCurveSimpleSWU: invalid opts");const o=function(e,t){const n=e.ORDER;let r=oh;for(let e=n-sh;e%ah===oh;e/=ah)r+=sh;const i=r,o=ah<<i-sh-sh,s=o*ah,a=(n-sh)/s,c=(a-sh)/ah,u=s-sh,f=o,l=e.pow(t,a),d=e.pow(t,(a+sh)/ah);let h=(t,n)=>{let r=l,o=e.pow(n,u),s=e.sqr(o);s=e.mul(s,n);let a=e.mul(t,s);a=e.pow(a,c),a=e.mul(a,o),o=e.mul(a,n),s=e.mul(a,t);let h=e.mul(s,o);a=e.pow(h,f);let p=e.eql(a,e.ONE);o=e.mul(s,d),a=e.mul(h,r),s=e.cmov(o,s,p),h=e.cmov(a,h,p);for(let t=i;t>sh;t--){let n=t-ah;n=ah<<n-sh;let i=e.pow(h,n);const a=e.eql(i,e.ONE);o=e.mul(s,r),r=e.mul(r,r),i=e.mul(h,r),s=e.cmov(o,s,a),h=e.cmov(i,h,a)}return{isValid:p,value:s}};if(e.ORDER%uh===ch){const n=(e.ORDER-ch)/uh,r=e.sqrt(e.neg(t));h=(t,i)=>{let o=e.sqr(i);const s=e.mul(t,i);o=e.mul(o,s);let a=e.pow(o,n);a=e.mul(a,s);const c=e.mul(a,r),u=e.mul(e.sqr(a),i),f=e.eql(u,t);return{isValid:f,value:e.cmov(c,a,f)}}}return h}(e,i);if(!e.isOdd)throw new Error("Field does not have .isOdd()");return t=>{let s,a,c,u,f,l,d,h;s=e.sqr(t),s=e.mul(s,i),a=e.sqr(s),a=e.add(a,s),c=e.add(a,e.ONE),c=e.mul(c,r),u=e.cmov(i,e.neg(a),!e.eql(a,e.ZERO)),u=e.mul(u,n),a=e.sqr(c),l=e.sqr(u),f=e.mul(l,n),a=e.add(a,f),a=e.mul(a,c),l=e.mul(l,u),f=e.mul(l,r),a=e.add(a,f),d=e.mul(s,c);const{isValid:p,value:g}=o(a,l);h=e.mul(s,t),h=e.mul(h,g),d=e.cmov(d,c,p),h=e.cmov(h,g,p);const m=e.isOdd(t)===e.isOdd(h);h=e.cmov(e.neg(h),h,m);const y=kd(e,[u],!0)[0];return d=e.mul(d,y),{x:d,y:h}}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const gh=BigInt(0),mh=BigInt(1),yh=BigInt(2),bh=BigInt(3);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const wh=BigInt(0),vh=BigInt(1),Eh=BigInt(2),xh=BigInt(3);function _h(e,t,n,r,i=1,o){const s=BigInt(void 0===o?r:o),a=n**BigInt(r),c=[];for(let o=0;o<i;o++){const i=BigInt(o+1),u=[];for(let o=0,c=vh;o<r;o++){const r=(i*c-i)/s%a;u.push(e.pow(t,r)),c*=n}c.push(u)}return c}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const Ah=BigInt(0),Th=BigInt(1),Sh=BigInt(2),Bh=BigInt(3),Nh=BigInt(4),Oh=BigInt("0xd201000000010000"),Ih=ld(Oh),Rh={p:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),n:BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001"),h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),a:Ah,b:Nh,Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1")},kh=$d(Rh.n),{Fp:Lh,Fp2:$h,Fp6:Ph,Fp4Square:Uh,Fp12:Dh}=function(e){const{ORDER:t}=e,n=$d(t),r=n.create(e.NONRESIDUE||BigInt(-1)),i=n.div(n.ONE,Eh),o=_h(n,r,n.ORDER,2)[0],s=({c0:e,c1:t},{c0:r,c1:i})=>({c0:n.add(e,r),c1:n.add(t,i)}),a=({c0:e,c1:t},{c0:r,c1:i})=>({c0:n.sub(e,r),c1:n.sub(t,i)}),c=({c0:e,c1:t},r)=>{if("bigint"==typeof r)return{c0:n.mul(e,r),c1:n.mul(t,r)};const{c0:i,c1:o}=r;let s=n.mul(e,i),a=n.mul(t,o);return{c0:n.sub(s,a),c1:n.sub(n.mul(n.add(e,t),n.add(i,o)),n.add(s,a))}},u=({c0:e,c1:t})=>{const r=n.add(e,t),i=n.sub(e,t),o=n.add(e,e);return{c0:n.mul(r,i),c1:n.mul(o,t)}},f=e=>{if(2!==e.length)throw new Error("invalid tuple");const t=e.map((e=>n.create(e)));return{c0:t[0],c1:t[1]}};function l(e,t){return"bigint"==typeof e&&wh<=e&&e<t}const d=t*t,h=f(e.FP2_NONRESIDUE),p={ORDER:d,isLE:n.isLE,NONRESIDUE:h,BITS:ld(d),BYTES:Math.ceil(ld(d)/8),MASK:hd(ld(d)),ZERO:{c0:n.ZERO,c1:n.ZERO},ONE:{c0:n.ONE,c1:n.ZERO},create:e=>e,isValid:({c0:e,c1:t})=>l(e,d)&&l(t,d),is0:({c0:e,c1:t})=>n.is0(e)&&n.is0(t),isValidNot0:e=>!p.is0(e)&&p.isValid(e),eql:({c0:e,c1:t},{c0:r,c1:i})=>n.eql(e,r)&&n.eql(t,i),neg:({c0:e,c1:t})=>({c0:n.neg(e),c1:n.neg(t)}),pow:(e,t)=>Rd(p,e,t),invertBatch:e=>kd(p,e),add:s,sub:a,mul:c,sqr:u,addN:s,subN:a,mulN:c,sqrN:u,div:(e,t)=>p.mul(e,"bigint"==typeof t?n.inv(n.create(t)):p.inv(t)),inv:({c0:e,c1:t})=>{const r=n.inv(n.create(e*e+t*t));return{c0:n.mul(r,n.create(e)),c1:n.mul(r,n.create(-t))}},sqrt:t=>{if(e.Fp2sqrt)return e.Fp2sqrt(t);const{c0:o,c1:s}=t;if(n.is0(s))return 1===Ld(n,o)?p.create({c0:n.sqrt(o),c1:n.ZERO}):p.create({c0:n.ZERO,c1:n.sqrt(n.div(o,r))});const a=n.sqrt(n.sub(n.sqr(o),n.mul(n.sqr(s),r)));let c=n.mul(n.add(a,o),i);-1===Ld(n,c)&&(c=n.sub(c,a));const u=n.sqrt(c),f=p.create({c0:u,c1:n.div(n.mul(s,i),u)});if(!p.eql(p.sqr(f),t))throw new Error("Cannot find square root");const l=f,d=p.neg(l),{re:h,im:g}=p.reim(l),{re:m,im:y}=p.reim(d);return g>y||g===y&&h>m?l:d},isOdd:e=>{const{re:t,im:n}=p.reim(e);return BigInt(t%Eh||t===wh&&n%Eh)==vh},fromBytes(e){if(e.length!==p.BYTES)throw new Error("fromBytes invalid length="+e.length);return{c0:n.fromBytes(e.subarray(0,n.BYTES)),c1:n.fromBytes(e.subarray(n.BYTES))}},toBytes:({c0:e,c1:t})=>Cl(n.toBytes(e),n.toBytes(t)),cmov:({c0:e,c1:t},{c0:r,c1:i},o)=>({c0:n.cmov(e,r,o),c1:n.cmov(t,i,o)}),reim:({c0:e,c1:t})=>({re:e,im:t}),mulByNonresidue:({c0:e,c1:t})=>p.mul({c0:e,c1:t},h),mulByB:e.Fp2mulByB,fromBigTuple:f,frobeniusMap:({c0:e,c1:t},r)=>({c0:e,c1:n.mul(t,o[r%2])})},g=({c0:e,c1:t,c2:n},{c0:r,c1:i,c2:o})=>({c0:p.add(e,r),c1:p.add(t,i),c2:p.add(n,o)}),m=({c0:e,c1:t,c2:n},{c0:r,c1:i,c2:o})=>({c0:p.sub(e,r),c1:p.sub(t,i),c2:p.sub(n,o)}),y=({c0:e,c1:t,c2:n},r)=>{if("bigint"==typeof r)return{c0:p.mul(e,r),c1:p.mul(t,r),c2:p.mul(n,r)};const{c0:i,c1:o,c2:s}=r,a=p.mul(e,i),c=p.mul(t,o),u=p.mul(n,s);return{c0:p.add(a,p.mulByNonresidue(p.sub(p.mul(p.add(t,n),p.add(o,s)),p.add(c,u)))),c1:p.add(p.sub(p.mul(p.add(e,t),p.add(i,o)),p.add(a,c)),p.mulByNonresidue(u)),c2:p.sub(p.add(c,p.mul(p.add(e,n),p.add(i,s))),p.add(a,u))}},b=({c0:e,c1:t,c2:n})=>{let r=p.sqr(e),i=p.mul(p.mul(e,t),Eh),o=p.mul(p.mul(t,n),Eh),s=p.sqr(n);return{c0:p.add(p.mulByNonresidue(o),r),c1:p.add(p.mulByNonresidue(s),i),c2:p.sub(p.sub(p.add(p.add(i,p.sqr(p.add(p.sub(e,t),n))),o),r),s)}},[w,v]=_h(p,h,n.ORDER,6,2,3),E={ORDER:p.ORDER,isLE:p.isLE,BITS:3*p.BITS,BYTES:3*p.BYTES,MASK:hd(3*p.BITS),ZERO:{c0:p.ZERO,c1:p.ZERO,c2:p.ZERO},ONE:{c0:p.ONE,c1:p.ZERO,c2:p.ZERO},create:e=>e,isValid:({c0:e,c1:t,c2:n})=>p.isValid(e)&&p.isValid(t)&&p.isValid(n),is0:({c0:e,c1:t,c2:n})=>p.is0(e)&&p.is0(t)&&p.is0(n),isValidNot0:e=>!E.is0(e)&&E.isValid(e),neg:({c0:e,c1:t,c2:n})=>({c0:p.neg(e),c1:p.neg(t),c2:p.neg(n)}),eql:({c0:e,c1:t,c2:n},{c0:r,c1:i,c2:o})=>p.eql(e,r)&&p.eql(t,i)&&p.eql(n,o),sqrt:gd,div:(e,t)=>E.mul(e,"bigint"==typeof t?n.inv(n.create(t)):E.inv(t)),pow:(e,t)=>Rd(E,e,t),invertBatch:e=>kd(E,e),add:g,sub:m,mul:y,sqr:b,addN:g,subN:m,mulN:y,sqrN:b,inv:({c0:e,c1:t,c2:n})=>{let r=p.sub(p.sqr(e),p.mulByNonresidue(p.mul(n,t))),i=p.sub(p.mulByNonresidue(p.sqr(n)),p.mul(e,t)),o=p.sub(p.sqr(t),p.mul(e,n)),s=p.inv(p.add(p.mulByNonresidue(p.add(p.mul(n,i),p.mul(t,o))),p.mul(e,r)));return{c0:p.mul(s,r),c1:p.mul(s,i),c2:p.mul(s,o)}},fromBytes:e=>{if(e.length!==E.BYTES)throw new Error("fromBytes invalid length="+e.length);return{c0:p.fromBytes(e.subarray(0,p.BYTES)),c1:p.fromBytes(e.subarray(p.BYTES,2*p.BYTES)),c2:p.fromBytes(e.subarray(2*p.BYTES))}},toBytes:({c0:e,c1:t,c2:n})=>Cl(p.toBytes(e),p.toBytes(t),p.toBytes(n)),cmov:({c0:e,c1:t,c2:n},{c0:r,c1:i,c2:o},s)=>({c0:p.cmov(e,r,s),c1:p.cmov(t,i,s),c2:p.cmov(n,o,s)}),fromBigSix:e=>{if(!Array.isArray(e)||6!==e.length)throw new Error("invalid Fp6 usage");return{c0:p.fromBigTuple(e.slice(0,2)),c1:p.fromBigTuple(e.slice(2,4)),c2:p.fromBigTuple(e.slice(4,6))}},frobeniusMap:({c0:e,c1:t,c2:n},r)=>({c0:p.frobeniusMap(e,r),c1:p.mul(p.frobeniusMap(t,r),w[r%6]),c2:p.mul(p.frobeniusMap(n,r),v[r%6])}),mulByFp2:({c0:e,c1:t,c2:n},r)=>({c0:p.mul(e,r),c1:p.mul(t,r),c2:p.mul(n,r)}),mulByNonresidue:({c0:e,c1:t,c2:n})=>({c0:p.mulByNonresidue(n),c1:e,c2:t}),mul1:({c0:e,c1:t,c2:n},r)=>({c0:p.mulByNonresidue(p.mul(n,r)),c1:p.mul(e,r),c2:p.mul(t,r)}),mul01({c0:e,c1:t,c2:n},r,i){let o=p.mul(e,r),s=p.mul(t,i);return{c0:p.add(p.mulByNonresidue(p.sub(p.mul(p.add(t,n),i),s)),o),c1:p.sub(p.sub(p.mul(p.add(r,i),p.add(e,t)),o),s),c2:p.add(p.sub(p.mul(p.add(e,n),r),o),s)}}},x=_h(p,h,n.ORDER,12,1,6)[0],_=({c0:e,c1:t},{c0:n,c1:r})=>({c0:E.add(e,n),c1:E.add(t,r)}),A=({c0:e,c1:t},{c0:n,c1:r})=>({c0:E.sub(e,n),c1:E.sub(t,r)}),T=({c0:e,c1:t},n)=>{if("bigint"==typeof n)return{c0:E.mul(e,n),c1:E.mul(t,n)};let{c0:r,c1:i}=n,o=E.mul(e,r),s=E.mul(t,i);return{c0:E.add(o,E.mulByNonresidue(s)),c1:E.sub(E.mul(E.add(e,t),E.add(r,i)),E.add(o,s))}},S=({c0:e,c1:t})=>{let n=E.mul(e,t);return{c0:E.sub(E.sub(E.mul(E.add(E.mulByNonresidue(t),e),E.add(e,t)),n),E.mulByNonresidue(n)),c1:E.add(n,n)}},B={ORDER:p.ORDER,isLE:E.isLE,BITS:2*E.BITS,BYTES:2*E.BYTES,MASK:hd(2*E.BITS),ZERO:{c0:E.ZERO,c1:E.ZERO},ONE:{c0:E.ONE,c1:E.ZERO},create:e=>e,isValid:({c0:e,c1:t})=>E.isValid(e)&&E.isValid(t),is0:({c0:e,c1:t})=>E.is0(e)&&E.is0(t),isValidNot0:e=>!B.is0(e)&&B.isValid(e),neg:({c0:e,c1:t})=>({c0:E.neg(e),c1:E.neg(t)}),eql:({c0:e,c1:t},{c0:n,c1:r})=>E.eql(e,n)&&E.eql(t,r),sqrt:gd,inv:({c0:e,c1:t})=>{let n=E.inv(E.sub(E.sqr(e),E.mulByNonresidue(E.sqr(t))));return{c0:E.mul(e,n),c1:E.neg(E.mul(t,n))}},div:(e,t)=>B.mul(e,"bigint"==typeof t?n.inv(n.create(t)):B.inv(t)),pow:(e,t)=>Rd(B,e,t),invertBatch:e=>kd(B,e),add:_,sub:A,mul:T,sqr:S,addN:_,subN:A,mulN:T,sqrN:S,fromBytes:e=>{if(e.length!==B.BYTES)throw new Error("fromBytes invalid length="+e.length);return{c0:E.fromBytes(e.subarray(0,E.BYTES)),c1:E.fromBytes(e.subarray(E.BYTES))}},toBytes:({c0:e,c1:t})=>Cl(E.toBytes(e),E.toBytes(t)),cmov:({c0:e,c1:t},{c0:n,c1:r},i)=>({c0:E.cmov(e,n,i),c1:E.cmov(t,r,i)}),fromBigTwelve:e=>({c0:E.fromBigSix(e.slice(0,6)),c1:E.fromBigSix(e.slice(6,12))}),frobeniusMap(e,t){const{c0:n,c1:r,c2:i}=E.frobeniusMap(e.c1,t),o=x[t%12];return{c0:E.frobeniusMap(e.c0,t),c1:E.create({c0:p.mul(n,o),c1:p.mul(r,o),c2:p.mul(i,o)})}},mulByFp2:({c0:e,c1:t},n)=>({c0:E.mulByFp2(e,n),c1:E.mulByFp2(t,n)}),conjugate:({c0:e,c1:t})=>({c0:e,c1:E.neg(t)}),mul014:({c0:e,c1:t},n,r,i)=>{let o=E.mul01(e,n,r),s=E.mul1(t,i);return{c0:E.add(E.mulByNonresidue(s),o),c1:E.sub(E.sub(E.mul01(E.add(t,e),n,p.add(r,i)),o),s)}},mul034:({c0:e,c1:t},n,r,i)=>{const o=E.create({c0:p.mul(e.c0,n),c1:p.mul(e.c1,n),c2:p.mul(e.c2,n)}),s=E.mul01(t,r,i),a=E.mul01(E.add(e,t),p.add(n,r),i);return{c0:E.add(E.mulByNonresidue(s),o),c1:E.sub(a,E.add(o,s))}},_cyclotomicSquare:e.Fp12cyclotomicSquare,_cyclotomicExp:e.Fp12cyclotomicExp,finalExponentiate:e.Fp12finalExponentiate};return{Fp:n,Fp2:p,Fp6:E,Fp12:B,Fp4Square:function(e,t){const n=p.sqr(e),r=p.sqr(t);return{first:p.add(p.mulByNonresidue(r),n),second:p.sub(p.sub(p.sqr(p.add(e,t)),n),r)}}}}({ORDER:Rh.p,FP2_NONRESIDUE:[Th,Th],Fp2mulByB:({c0:e,c1:t})=>{const n=Lh.mul(e,Nh),r=Lh.mul(t,Nh);return{c0:Lh.sub(n,r),c1:Lh.add(n,r)}},Fp12cyclotomicSquare:({c0:e,c1:t})=>{const{c0:n,c1:r,c2:i}=e,{c0:o,c1:s,c2:a}=t,{first:c,second:u}=Uh(n,s),{first:f,second:l}=Uh(o,i),{first:d,second:h}=Uh(r,a),p=$h.mulByNonresidue(h);return{c0:Ph.create({c0:$h.add($h.mul($h.sub(c,n),Sh),c),c1:$h.add($h.mul($h.sub(f,r),Sh),f),c2:$h.add($h.mul($h.sub(d,i),Sh),d)}),c1:Ph.create({c0:$h.add($h.mul($h.add(p,o),Sh),p),c1:$h.add($h.mul($h.add(u,s),Sh),u),c2:$h.add($h.mul($h.add(l,a),Sh),l)})}},Fp12cyclotomicExp(e,t){let n=Dh.ONE;for(let r=Ih-1;r>=0;r--)n=Dh._cyclotomicSquare(n),dd(t,r)&&(n=Dh.mul(n,e));return n},Fp12finalExponentiate:e=>{const t=Oh,n=Dh.div(Dh.frobeniusMap(e,6),e),r=Dh.mul(Dh.frobeniusMap(n,2),n),i=Dh.conjugate(Dh._cyclotomicExp(r,t)),o=Dh.mul(Dh.conjugate(Dh._cyclotomicSquare(r)),i),s=Dh.conjugate(Dh._cyclotomicExp(o,t)),a=Dh.conjugate(Dh._cyclotomicExp(s,t)),c=Dh.mul(Dh.conjugate(Dh._cyclotomicExp(a,t)),Dh._cyclotomicSquare(i)),u=Dh.conjugate(Dh._cyclotomicExp(c,t)),f=Dh.frobeniusMap(Dh.mul(i,a),2),l=Dh.frobeniusMap(Dh.mul(s,r),3),d=Dh.frobeniusMap(Dh.mul(c,Dh.conjugate(r)),1),h=Dh.mul(Dh.mul(u,Dh.conjugate(o)),r);return Dh.mul(Dh.mul(Dh.mul(f,l),d),h)}}),{G2psi:Fh,G2psi2:Ch}=function(e,t,n){const r=t.pow(n,(e.ORDER-vh)/xh),i=t.pow(n,(e.ORDER-vh)/Eh);function o(e,n){return[t.mul(t.frobeniusMap(e,1),r),t.mul(t.frobeniusMap(n,1),i)]}const s=t.pow(n,(e.ORDER**Eh-vh)/xh),a=t.pow(n,(e.ORDER**Eh-vh)/Eh);if(!t.eql(a,t.neg(t.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function c(e,n){return[t.mul(e,s),t.neg(n)]}const u=e=>(t,n)=>{const r=n.toAffine(),i=e(r.x,r.y);return t.fromAffine({x:i[0],y:i[1]})};return{psi:o,psi2:c,G2psi:u(o),G2psi2:u(c),PSI_X:r,PSI_Y:i,PSI2_X:s,PSI2_Y:a}}(Lh,$h,$h.div($h.ONE,$h.NONRESIDUE)),Mh=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:Lh.ORDER,m:2,k:128,expand:"xmd",hash:ed}),jh={p:$h.ORDER,n:Rh.n,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),a:$h.ZERO,b:$h.fromBigTuple([Nh,Nh]),Gx:$h.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:$h.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")])},qh=zh(Lh.toBytes(Ah),{infinity:!0,compressed:!0});function Vh(e){const t=224&(e=e.slice())[0],n=!!(t>>7&1),r=!!(t>>6&1),i=!!(t>>5&1);return e[0]&=31,{compressed:n,infinity:r,sort:i,value:e}}function zh(e,t){if(224&e[0])throw new Error("setMask: non-empty mask");return t.compressed&&(e[0]|=128),t.infinity&&(e[0]|=64),t.sort&&(e[0]|=32),e}function Hh(e){e.assertValidity();const{BYTES:t,ORDER:n}=Lh,{x:r,y:i}=e.toAffine();if(e.is0())return qh.slice();const o=!!(i*Sh/n);return zh(ad(r,t),{compressed:!0,sort:o})}function Gh(e){const{infinity:t,sort:n,value:r}=Vh(ud("signatureHex",e,48)),i=Lh.ORDER,o=Zh.G1.Point,s=od(r);if(t)return o.ZERO;const a=Lh.create(s&Lh.MASK),c=Lh.add(Lh.pow(a,Bh),Lh.create(Rh.b));let u=Lh.sqrt(c);if(!u)throw new Error("invalid G1 point: compressed");const f=BigInt(n);u*Sh/i!==f&&(u=Lh.neg(u));const l=o.fromAffine({x:a,y:u});return l.assertValidity(),l}function Kh(e){e.assertValidity();const{BYTES:t}=Lh;if(e.is0())return Cl(qh,ad(Ah,t));const{x:n,y:r}=e.toAffine(),{re:i,im:o}=$h.reim(n),{re:s,im:a}=$h.reim(r),c=!!((a>Ah?a*Sh:s*Sh)/Lh.ORDER&Th),u=i;return Cl(zh(ad(o,t),{sort:c,compressed:!0}),ad(u,t))}function Wh(e){const{ORDER:t}=Lh,{infinity:n,sort:r,value:i}=Vh(ud("signatureHex",e)),o=Zh.G2.Point,s=i.length/2;if(48!==s&&96!==s)throw new Error("invalid compressed signature length, expected 96/192 bytes");const a=od(i.slice(0,s)),c=od(i.slice(s));if(n)return o.ZERO;const u=Lh.create(a&Lh.MASK),f=Lh.create(c),l=$h.create({c0:f,c1:u}),d=$h.add($h.pow(l,Bh),jh.b);let h=$h.sqrt(d);if(!h)throw new Error("Failed to find a square root");const{re:p,im:g}=$h.reim(h),m=BigInt(r);(g>Ah&&g*Sh/t!==m||g===Ah&&p*Sh/t!==m)&&(h=$h.neg(h));const y=o.fromAffine({x:l,y:h});return y.assertValidity(),y}const Zh=function(e){const{Fp:t,Fr:n,Fp2:r,Fp6:i,Fp12:o}=e.fields,s=e.params.xNegative,a=e.params.twistType,c=hh(e.G1),u=Object.assign(c,nh(c.Point,e.G1.mapToCurve,{...e.htfDefaults,...e.G1.htfDefaults})),f=hh(e.G2),l=Object.assign(f,nh(f.Point,e.G2.mapToCurve,{...e.htfDefaults,...e.G2.htfDefaults}));let d;if("multiplicative"===a)d=(e,t,n,i,s,a)=>o.mul014(i,e,r.mul(t,s),r.mul(n,a));else{if("divisive"!==a)throw new Error("bls: unknown twist type");d=(e,t,n,i,s,a)=>o.mul034(i,r.mul(n,a),r.mul(t,s),e)}const h=r.div(r.ONE,r.mul(r.ONE,yh));function p(e,t,n,i){const o=r.sqr(n),s=r.sqr(i),a=r.mulByB(r.mul(s,bh)),c=r.mul(a,bh),u=r.sub(r.sub(r.sqr(r.add(n,i)),s),o),f=r.sub(a,o),l=r.mul(r.sqr(t),bh),d=r.neg(u);return e.push([f,l,d]),{Rx:t=r.mul(r.mul(r.mul(r.sub(o,c),t),n),h),Ry:n=r.sub(r.sqr(r.mul(r.add(o,c),h)),r.mul(r.sqr(a),bh)),Rz:i=r.mul(o,u)}}function g(e,t,n,i,o,s){const a=r.sub(n,r.mul(s,i)),c=r.sub(t,r.mul(o,i)),u=r.sub(r.mul(a,o),r.mul(c,s)),f=r.neg(a),l=c;e.push([u,f,l]);const d=r.sqr(c),h=r.mul(d,c),p=r.mul(d,t),g=r.add(r.sub(h,r.mul(p,yh)),r.mul(r.sqr(a),i));return{Rx:t=r.mul(c,g),Ry:n=r.sub(r.mul(r.sub(p,g),a),r.mul(h,n)),Rz:i=r.mul(i,h)}}const m=function(e){const t=[];for(;e>mh;e>>=mh)(e&mh)===gh?t.unshift(0):(e&bh)===bh?(t.unshift(-1),e+=mh):t.unshift(1);return t}(e.params.ateLoopSize),y=md((t=>{const n=t,{x:i,y:o}=n.toAffine(),s=i,a=o,c=r.neg(o);let u=s,f=a,l=r.ONE;const d=[];for(const e of m){const t=[];({Rx:u,Ry:f,Rz:l}=p(t,u,f,l)),e&&({Rx:u,Ry:f,Rz:l}=g(t,u,f,l,s,-1===e?c:a)),d.push(t)}if(e.postPrecompute){const t=d[d.length-1];e.postPrecompute(u,f,l,s,a,g.bind(null,t))}return d}));function b(e,t=!1){let n=o.ONE;if(e.length){const t=e[0][0].length;for(let r=0;r<t;r++){n=o.sqr(n);for(const[t,i,o]of e)for(const[e,s,a]of t[r])n=d(e,s,a,n,i,o)}}return s&&(n=o.conjugate(n)),t?o.finalExponentiate(n):n}function w(e,t=!0){const n=[];Md(u.Point,"pz",e.map((({g1:e})=>e))),Md(l.Point,"pz",e.map((({g2:e})=>e)));for(const{g1:t,g2:r}of e){if(t.is0()||r.is0())throw new Error("pairing is not available for ZERO point");t.assertValidity(),r.assertValidity();const e=t.toAffine();n.push([y(r),e.x,e.y])}return b(n,t)}const v=e.randomBytes||ql,E={randomPrivateKey:()=>{const e=Ud(n.ORDER);return function(e,t,n=!1){const r=e.length,i=Pd(t),o=Ud(t);if(r<16||r<o||r>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+r);const s=Ad(n?sd(e):od(e),t-bd)+bd;return n?cd(s,i):ad(s,i)}(v(e),n.ORDER)},calcPairingPrecomputes:y};function x(e){if(!Array.isArray(e)||0===e.length)throw new Error("expected non-empty array")}function _(e){return e instanceof u.Point?e:u.Point.fromHex(e)}function A(t,n){function r(e){return e instanceof t.Point?e:t.Point.fromHex(e)}function i(e){return e instanceof n.Point?e:n.Point.fromHex(e)}function s(e){if(!(e instanceof n.Point))throw new Error(`expected valid message hashed to ${a?"G2":"G1"} curve`);return e}const a=n.Point.Fp.BYTES>t.Point.Fp.BYTES;return{getPublicKey:e=>t.Point.fromPrivateKey(e),sign(e,n,r){if(null!=r)throw new Error("sign() expects 2 arguments");return s(e).assertValidity(),e.multiply(t.normPrivateKeyToScalar(n))},verify(e,n,c,u){if(null!=u)throw new Error("verify() expects 3 arguments");e=i(e);const f=(c=r(c)).negate(),l=t.Point.BASE,d=s(n),h=w(a?[{g1:f,g2:d},{g1:l,g2:e}]:[{g1:d,g2:f},{g1:e,g2:l}]);return o.eql(h,o.ONE)},aggregatePublicKeys(e){x(e);const n=(e=e.map((e=>r(e)))).reduce(((e,t)=>e.add(t)),t.Point.ZERO);return n.assertValidity(),n},aggregateSignatures(e){x(e);const t=(e=e.map((e=>i(e)))).reduce(((e,t)=>e.add(t)),n.Point.ZERO);return t.assertValidity(),t},hash(e,t){xl(e);const r=t?{DST:t}:void 0;return n.hashToCurve(e,r)},Signature:a?e.G2.Signature:e.G1.ShortSignature}}const T=A(u,l),S=A(l,u),{ShortSignature:B}=e.G1,{Signature:N}=e.G2;function O(e,t){return e instanceof u.Point?e:S.hash(ud("point",e),t?.DST)}function I(e,t){return e instanceof l.Point?e:T.hash(ud("point",e),t?.DST)}return u.Point.BASE.precompute(4),{longSignatures:T,shortSignatures:S,millerLoopBatch:b,pairing:function(e,t,n=!0){return w([{g1:e,g2:t}],n)},pairingBatch:w,verifyBatch:function(e,t,n,r){if(x(t),n.length!==t.length)throw new Error("amount of public keys and messages should be equal");const i=function(e){return e instanceof l.Point?e:N.fromHex(e)}(e),s=t.map((e=>I(e,r))),a=n.map(_),c=new Map;for(let e=0;e<a.length;e++){const t=a[e],n=s[e];let r=c.get(n);void 0===r&&(r=[],c.set(n,r)),r.push(t)}const f=[];try{for(const[e,t]of c){const n=t.reduce(((e,t)=>e.add(t)));f.push({g1:n,g2:e})}return f.push({g1:u.Point.BASE.negate(),g2:i}),o.eql(w(f),o.ONE)}catch{return!1}},curves:{G1:c.Point,G2:f.Point},fields:{Fr:n,Fp:t,Fp2:r,Fp6:i,Fp12:o},params:{ateLoopSize:e.params.ateLoopSize,twistType:e.params.twistType,r:e.params.r,G1b:e.G1.b,G2b:e.G2.b},utils:E,getPublicKey:function(e){return T.getPublicKey(e).toBytes(!0)},getPublicKeyForShortSignatures:function(e){return S.getPublicKey(e).toBytes(!0)},sign:function(e,t,n){const r=I(e,n),i=T.sign(r,t);return e instanceof l.Point?i:N.toBytes(i)},signShortSignature:function(e,t,n){const r=O(e,n),i=S.sign(r,t);return e instanceof u.Point?i:B.toBytes(i)},verify:function(e,t,n,r){const i=I(t,r);return T.verify(e,i,n)},verifyShortSignature:function(e,t,n,r){const i=O(t,r);return S.verify(e,i,n)},aggregatePublicKeys:function(e){const t=T.aggregatePublicKeys(e);return e[0]instanceof u.Point?t:t.toBytes(!0)},aggregateSignatures:function(e){const t=T.aggregateSignatures(e);return e[0]instanceof l.Point?t:N.toBytes(t)},aggregateShortSignatures:function(e){const t=S.aggregateSignatures(e);return e[0]instanceof u.Point?t:B.toBytes(t)},G1:u,G2:l,Signature:N,ShortSignature:B}}({fields:{Fp:Lh,Fp2:$h,Fp6:Ph,Fp12:Dh,Fr:kh},G1:{...Rh,Fp:Lh,htfDefaults:{...Mh,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(e,t)=>{const n=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),r=new e(Lh.mul(t.px,n),t.py,t.pz);return t.multiplyUnsafe(Oh).negate().multiplyUnsafe(Oh).equals(r)},clearCofactor:(e,t)=>t.multiplyUnsafe(Oh).add(t),mapToCurve:function(e){const{x:t,y:n}=Jh(Lh.create(e[0]));return Xh(t,n)},fromBytes:function(e){const{compressed:t,infinity:n,sort:r,value:i}=Vh(e),{BYTES:o,ORDER:s}=Lh;if(48===i.length&&t){const e=od(i),t=Lh.create(e&Lh.MASK);if(n){if(t!==Ah)throw new Error("invalid G1 point: non-empty, at infinity, with compression");return{x:Ah,y:Ah}}const o=Lh.add(Lh.pow(t,Bh),Lh.create(Rh.b));let a=Lh.sqrt(o);if(!a)throw new Error("invalid G1 point: compressed point");return a*Sh/s!==BigInt(r)&&(a=Lh.neg(a)),{x:Lh.create(t),y:Lh.create(a)}}if(96!==i.length||t)throw new Error("invalid G1 point: expected 48/96 bytes");{const e=od(i.subarray(0,o)),t=od(i.subarray(o));if(n){if(e!==Ah||t!==Ah)throw new Error("G1: non-empty point at infinity");return Zh.G1.Point.ZERO.toAffine()}return{x:Lh.create(e),y:Lh.create(t)}}},toBytes:function(e,t,n){const{BYTES:r,ORDER:i}=Lh,o=t.is0(),{x:s,y:a}=t.toAffine();if(n){if(o)return qh.slice();const e=!!(a*Sh/i);return zh(ad(s,r),{compressed:!0,sort:e})}return o?Cl(Uint8Array.of(64),new Uint8Array(2*r-1)):Cl(ad(s,r),ad(a,r))},ShortSignature:{fromBytes:e=>(xl(e),Gh(e)),fromHex:e=>Gh(e),toBytes:e=>Hh(e),toRawBytes:e=>Hh(e),toHex:e=>Ll(Hh(e))}},G2:{...jh,Fp:$h,hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...Mh},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:function(e){const{x:t,y:n}=Qh($h.fromBigTuple(e));return Yh(t,n)},isTorsionFree:(e,t)=>t.multiplyUnsafe(Oh).negate().equals(Fh(e,t)),clearCofactor:(e,t)=>{const n=Oh;let r=t.multiplyUnsafe(n).negate(),i=Fh(e,t),o=t.double();return o=Ch(e,o),o=o.subtract(i),i=r.add(i),i=i.multiplyUnsafe(n).negate(),o=o.add(i),o=o.subtract(r),o.subtract(t)},fromBytes:function(e){const{BYTES:t,ORDER:n}=Lh,{compressed:r,infinity:i,sort:o,value:s}=Vh(e);if(!r&&!i&&o||!r&&i&&o||o&&i&&r)throw new Error("invalid encoding flag: "+(224&e[0]));const a=(e,t,n)=>od(e.slice(t,n));if(96===s.length&&r){if(i){if(s.reduce(((e,t)=>0!==e?t+1:t),0)>0)throw new Error("invalid G2 point: compressed");return{x:$h.ZERO,y:$h.ZERO}}const e=a(s,0,t),r=a(s,t,2*t),c=$h.create({c0:Lh.create(r),c1:Lh.create(e)}),u=$h.add($h.pow(c,Bh),jh.b);let f=$h.sqrt(u);const l=f.c1===Ah?f.c0*Sh/n:f.c1*Sh/n?Th:Ah;return f=o&&l>0?f:$h.neg(f),{x:c,y:f}}if(192!==s.length||r)throw new Error("invalid G2 point: expected 96/192 bytes");{if(i){if(s.reduce(((e,t)=>0!==e?t+1:t),0)>0)throw new Error("invalid G2 point: uncompressed");return{x:$h.ZERO,y:$h.ZERO}}const e=a(s,0*t,1*t),n=a(s,1*t,2*t),r=a(s,2*t,3*t),o=a(s,3*t,4*t);return{x:$h.fromBigTuple([n,e]),y:$h.fromBigTuple([o,r])}}},toBytes:function(e,t,n){const{BYTES:r,ORDER:i}=Lh,o=t.is0(),{x:s,y:a}=t.toAffine();if(n){if(o)return Cl(qh,ad(Ah,r));const e=!!(a.c1===Ah?a.c0*Sh/i:a.c1*Sh/i);return Cl(zh(ad(s.c1,r),{compressed:!0,sort:e}),ad(s.c0,r))}{if(o)return Cl(Uint8Array.of(64),new Uint8Array(4*r-1));const{re:e,im:t}=$h.reim(s),{re:n,im:i}=$h.reim(a);return Cl(ad(t,r),ad(e,r),ad(i,r),ad(n,r))}},Signature:{fromBytes:e=>(xl(e),Wh(e)),fromHex:e=>Wh(e),toBytes:e=>Kh(e),toRawBytes:e=>Kh(e),toHex:e=>Ll(Kh(e))}},params:{ateLoopSize:Oh,r:Rh.n,xNegative:!0,twistType:"multiplicative"},htfDefaults:Mh,hash:ed}),Yh=th($h,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map((e=>e.map((e=>$h.fromBigTuple(e.map(BigInt))))))),Xh=th(Lh,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map((e=>e.map((e=>BigInt(e)))))),Jh=ph(Lh,{A:Lh.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:Lh.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:Lh.create(BigInt(11))}),Qh=ph($h,{A:$h.create({c0:Lh.create(Ah),c1:Lh.create(BigInt(240))}),B:$h.create({c0:Lh.create(BigInt(1012)),c1:Lh.create(BigInt(1012))}),Z:$h.create({c0:Lh.create(BigInt(-2)),c1:Lh.create(BigInt(-1))})});const ep=BigInt(0),tp=BigInt(1),np=BigInt(2),rp=BigInt(7),ip=BigInt(256),op=BigInt(113),sp=[],ap=[],cp=[];for(let e=0,t=tp,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],sp.push(2*(5*r+n)),ap.push((e+1)*(e+2)/2%64);let i=ep;for(let e=0;e<7;e++)t=(t<<tp^(t>>rp)*op)%ip,t&np&&(i^=tp<<(tp<<BigInt(e))-tp);cp.push(i)}const up=Yl(cp,!0),fp=up[0],lp=up[1],dp=(e,t,n)=>n>32?((e,t,n)=>t<<n-32|e>>>64-n)(e,t,n):((e,t,n)=>e<<n|t>>>32-n)(e,t,n),hp=(e,t,n)=>n>32?((e,t,n)=>e<<n-32|t>>>64-n)(e,t,n):((e,t,n)=>t<<n|e>>>32-n)(e,t,n);class pp extends Ml{constructor(e,t,n,r=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=n,this.enableXOF=r,this.rounds=i,El(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");var o;this.state=new Uint8Array(200),this.state32=(o=this.state,new Uint32Array(o.buffer,o.byteOffset,Math.floor(o.byteLength/4)))}clone(){return this._cloneInto()}keccak(){Il(this.state32),function(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let t=0;t<10;t++)n[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const r=(t+8)%10,i=(t+2)%10,o=n[i],s=n[i+1],a=dp(o,s,1)^n[r],c=hp(o,s,1)^n[r+1];for(let n=0;n<50;n+=10)e[t+n]^=a,e[t+n+1]^=c}let t=e[2],i=e[3];for(let n=0;n<24;n++){const r=ap[n],o=dp(t,i,r),s=hp(t,i,r),a=sp[n];t=e[a],i=e[a+1],e[a]=o,e[a+1]=s}for(let t=0;t<50;t+=10){for(let r=0;r<10;r++)n[r]=e[t+r];for(let r=0;r<10;r++)e[t+r]^=~n[(r+2)%10]&n[(r+4)%10]}e[0]^=fp[r],e[1]^=lp[r]}Sl(n)}(this.state32,this.rounds),Il(this.state32),this.posOut=0,this.pos=0}update(e){Al(this),xl(e=Fl(e));const{blockLen:t,state:n}=this,r=e.length;for(let i=0;i<r;){const o=Math.min(t-this.pos,r-i);for(let t=0;t<o;t++)n[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:n,blockLen:r}=this;e[n]^=t,0!=(128&t)&&n===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}writeInto(e){Al(this,!1),xl(e),this.finish();const t=this.state,{blockLen:n}=this;for(let r=0,i=e.length;r<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-r);e.set(t.subarray(this.posOut,this.posOut+o),r),this.posOut+=o,r+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return El(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Tl(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Sl(this.state)}_cloneInto(e){const{blockLen:t,suffix:n,outputLen:r,rounds:i,enableXOF:o}=this;return e||(e=new pp(t,n,r,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=r,e.enableXOF=o,e.destroyed=this.destroyed,e}}var gp,mp,yp;gp=31,mp=136,yp=32,function(e){const t=(t,n)=>e(n).update(Fl(t)).digest(),n=e({});t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=t=>e(t)}(((e={})=>new pp(mp,gp,void 0===e.dkLen?yp:e.dkLen,!0)));const bp=Uint8Array.from([0]),wp=Uint8Array.of();const vp=(e,t,n,r,i)=>function(e,t,n,r=32){_l(e),El(r);const i=e.outputLen;if(r>255*i)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/i);void 0===n&&(n=wp);const s=new Uint8Array(o*i),a=ih.create(e,t),c=a._cloneInto(),u=new Uint8Array(a.outputLen);for(let e=0;e<o;e++)bp[0]=e+1,c.update(0===e?wp:u).update(n).update(bp).digestInto(u),s.set(u,i*e),a._cloneInto(c);return a.destroy(),c.destroy(),Sl(u,bp),s.slice(0,r)}(e,function(e,t,n){return _l(e),void 0===n&&(n=new Uint8Array(e.outputLen)),ih(e,Fl(n),Fl(t))}(e,t,n),r,i),Ep=ed,xp=48;class _p{#e;#t;static random(){return new _p(Zh.utils.randomPrivateKey())}static deserialize(e){if(32!==e.length)throw new Error("Invalid size for transport secret key");return new _p(e)}publicKeyBytes(){return this.#t.toRawBytes(!0)}serialize(){return this.#e}constructor(e){this.#e=e;const t=Zh.G1.ProjectivePoint.fromPrivateKey(this.#e);this.#t=t}}function Ap(e){let t=e.length;const n=new Uint8Array(8+t);for(let e=7;e>=0;e--)n[e]=255&t,t>>>=8;return n.set(e,8),n}class Tp{#e;static deserialize(e){return new Tp(Zh.G2.ProjectivePoint.fromHex(e))}deriveKey(e){if(0===e.length)return this;{const t="ic-vetkd-bls12-381-g2-context",n=this.publicKeyBytes(),r=function(e,t){const n={p:Zh.params.r,m:1,DST:t},r=Object.assign({},Zh.G2.CURVE.htfDefaults,n);return eh(e,1,r)[0][0]}(new Uint8Array([...Ap(n),...Ap(e)]),t),i=Zh.G2.ProjectivePoint.BASE.multiply(r);return new Tp(this.getPoint().add(i))}}publicKeyBytes(){return this.#e.toRawBytes(!0)}getPoint(){return this.#e}constructor(e){this.#e=e}}function Sp(e){return"string"==typeof e?(new TextEncoder).encode(e):e}function Bp(e,t,n){const r=Zh.G2.ProjectivePoint.BASE.negate(),i=Zh.fields.Fp12.ONE,o=n instanceof Zh.G1.ProjectivePoint?n:Zh.G1.ProjectivePoint.fromHex(n),s=function(e,t){const n=e.publicKeyBytes(),r=new Uint8Array([...n,...t]);return Zh.G1.ProjectivePoint.fromAffine(Zh.G1.hashToCurve(r,{DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_AUG_"}).toAffine())}(e,t),a=Zh.pairingBatch([{g1:o,g2:r},{g1:s,g2:e.getPoint()}]);return Zh.fields.Fp12.eql(a,i)}class Np{#e;#t;signatureBytes(){return this.#t}serialize(){return this.#t}deriveSymmetricKey(e,t){return function(e,t,n){const r=new Uint8Array;return vp(Ep,e,r,t,n)}(this.#t,e,t)}async asDerivedKeyMaterial(){return Op.setup(this.#t)}static deserialize(e){return new Np(Zh.G1.ProjectivePoint.fromHex(e))}getPoint(){return this.#e}constructor(e){this.#e=e,this.#t=e.toRawBytes(!0)}}class Op{#e;constructor(e){this.#e=e}static fromCryptoKey(e){return new Op(e)}static async setup(e){const t=await globalThis.crypto.subtle.importKey("raw",e,"HKDF",!1,["deriveKey"]);return new Op(t)}getCryptoKey(){return this.#e}async deriveAesGcmCryptoKey(e){const t={name:"HKDF",hash:"SHA-256",length:256,info:Sp(e),salt:new Uint8Array};return globalThis.crypto.subtle.deriveKey(t,this.#e,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async encryptMessage(e,t){const n=await this.deriveAesGcmCryptoKey(t),r=globalThis.crypto.getRandomValues(new Uint8Array(12)),i=new Uint8Array(await globalThis.crypto.subtle.encrypt({name:"AES-GCM",iv:r},n,Sp(e)));return new Uint8Array([...r,...i])}async decryptMessage(e,t){if(e.length<28)throw new Error("Invalid ciphertext, too short to possibly be valid");const n=e.slice(0,12),r=e.slice(12),i=await this.deriveAesGcmCryptoKey(t);try{const e=await globalThis.crypto.subtle.decrypt({name:"AES-GCM",iv:n},i,r);return new Uint8Array(e)}catch{throw new Error("Decryption failed")}}}class Ip{#e;#t;#n;static deserialize(e){if(192!==e.length)throw new Error("Invalid EncryptedVetKey serialization");const t=Zh.G1.ProjectivePoint.fromHex(e.subarray(0,xp)),n=Zh.G2.ProjectivePoint.fromHex(e.subarray(xp,144)),r=Zh.G1.ProjectivePoint.fromHex(e.subarray(144));return new Ip(t,n,r)}decryptAndVerify(e,t,n){const r=Zh.G1.ProjectivePoint.BASE,i=Zh.G2.ProjectivePoint.BASE.negate(),o=Zh.fields.Fp12.ONE,s=Zh.pairingBatch([{g1:this.#e,g2:i},{g1:r,g2:this.#t}]);if(!Zh.fields.Fp12.eql(s,o))throw new Error("Invalid VetKey");const a=this.#n.subtract(this.#e.multiply(Zh.G1.normPrivateKeyToScalar(e.serialize())));if(Bp(t,n,a))return new Np(a);throw new Error("Invalid VetKey")}constructor(e,t,n){this.#e=e,this.#t=t,this.#n=n}}class Rp{constructor(e){this.actor=e}async encryptWithNoteKey(e,t,n){await this.fetch_note_key_if_needed(e,t);const r=await bl([e.toString(),t]),i=Uint8Array.from([...n].map((e=>e.charCodeAt(0)))).buffer,o=window.crypto.getRandomValues(new Uint8Array(12)),s=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},r,i);return String.fromCharCode(...new Uint8Array(o))+String.fromCharCode(...new Uint8Array(s))}async decryptWithNoteKey(e,t,n){await this.fetch_note_key_if_needed(e,t);const r=await bl([e.toString(),t]);if(n.length<13)throw new Error("wrong encoding, too short to contain iv");const i=n.slice(0,12),o=n.slice(12),s=Uint8Array.from([...i].map((e=>e.charCodeAt(0)))).buffer,a=Uint8Array.from([...o].map((e=>e.charCodeAt(0)))).buffer;let c=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:s},r,a);return String.fromCharCode(...new Uint8Array(c))}async fetch_note_key_if_needed(e,t){if(!await bl([e.toString(),t])){const n=_p.random(),r=await this.actor.encrypted_symmetric_key_for_note(e,n.publicKeyBytes()),i=Ip.deserialize(kp(r)),o=await this.actor.symmetric_key_verification_key_for_note(),s=Tp.deserialize(kp(o)),a=function(e){var t=BigInt(e).toString(16);for(;t.length<32;)t="0"+t;var n=t.length/2,r=new Uint8Array(n),i=0,o=0;for(;i<n;)r[i]=parseInt(t.slice(o,o+2),16),i+=1,o+=2;return r}(e),c=(new TextEncoder).encode(t);let u=new Uint8Array(a.length+c.length);u.set(a),u.set(c,a.length);const f=i.decryptAndVerify(n,s,u),l=await(await f.asDerivedKeyMaterial()).deriveAesGcmCryptoKey("note-key");await function(e,t,n=yl()){return n("readwrite",(n=>(n.put(t,e),gl(n.transaction))))}([e.toString(),t],l)}}}const kp=e=>Uint8Array.from(e.match(/.{1,2}/g).map((e=>parseInt(e,16))));let Lp=0;const $p=Re([]);function Pp(e,t=2e3){const n=Lp++;$p.update((t=>[...t,Object.assign(Object.assign({},e),{id:n})])),setTimeout((()=>{$p.update((e=>e.filter((e=>e.id!=n))))}),t)}function Up(e,t){throw Pp({type:"error",message:t}),console.error(e),console.error(e.stack),e}const{set:Dp,subscribe:Fp}=Re({}),Cp={subscribe:Fp,set:Dp,remove:()=>{Dp({})}},Mp=(e,t="")=>{const n=new URL(e);function r(){return o(t).reduce(((e,t,n)=>(":"===t[0]&&e.push({value:t.slice(1),index:n}),e)),[])}function i(){return o(n.pathname)}function o(e){return"/"===e||0===e.trim().length?[e]:("/"===e.slice(-1)&&(e=e.slice(0,-1)),"/"===e[0]&&(e=e.slice(1)),e.split("/"))}return Object.freeze({hash:n.hash,host:n.host,hostname:n.hostname,namedParams:function(){const e=i();return r().reduce(((t,n)=>(t[n.value]=e[n.index],t)),{})}(),namedParamsKeys:r().reduce(((e,t)=>(e.push(t.value),e)),[]),namedParamsValues:function(){const e=i();return r().reduce(((t,n)=>(t.push(e[n.index]),t)),[])}(),pathNames:i(),port:n.port,pathname:n.pathname,protocol:n.protocol,search:n.search,queryParams:function(){const e={};return n.searchParams.forEach(((t,n)=>{e[n]=t})),e}(),queryParamsKeys:function(){const e=[];return n.searchParams.forEach(((t,n)=>{e.push(n)})),e}(),queryParamsValues:function(){const e=[];return n.searchParams.forEach((t=>{e.push(t)})),e}()})},jp=e=>{let t=!1;return 0===Object.keys(e).length||(e.childRoute&&0===Object.keys(e.childRoute).length?t=!0:e.childRoute&&(t=jp(e.childRoute)),t)},qp=(e,t)=>(t=Wp(t)).includes(":")?t.includes(e):t.startsWith(e),Vp=(e,t,n)=>{let r=!1;if(n)return{exists:t.lang&&t.lang[n]&&t.lang[n].includes(e),language:n};if(r=qp(e,t.name),!r&&t.lang&&"object"==typeof t.lang)for(const[i,o]of Object.entries(t.lang))qp(e,o)&&(r=!0,n=i);return{exists:r,language:n}},zp=(e="")=>{if(0===e.trim().length)return[];return Hp(e).reduce(((e,t)=>(":"===t[0]&&e.push(t.slice(1)),e)),[])},Hp=e=>"/"===e||0===e.trim().length?[e]:(e=Wp(e,"both")).split("/"),Gp=(e="")=>{let t;return"/"===e||0===e.trim().length?e:(t=(e=Wp(e,"lead")).split(":")[0],t=Wp(t,"trail"),t.toLowerCase())},Kp=(e,t)=>{const n=t.split("/");return n.length>1&&n.forEach((function(t,n){t.length>0&&n>0&&e.shift()})),e},Wp=(e,t="lead")=>("trail"!==t&&"both"!==t||(e=e.replace(/\/$/,"")),"lead"!==t&&"both"!==t||(e=e.replace(/^\//,"")),e),Zp=(e,t=null)=>t&&e.lang&&e.lang[t]?e.lang[t]:e.name,Yp=(e,t,n,r,i=!1)=>{if("/"===e||0===e.trim().length)return{result:e,language:null};let o=e,s=n.name,a=r;if(i&&(a=""),s=Wp(s),o=Wp(o),n.childRoute)return{result:e,language:a};{let e=Vp(o,n,a);e.exists&&i&&(o=Zp(n,r));let c=s.split(":")[0];return c=Wp(c,"trail"),c=c.split("/"),c.shift(),c.forEach((()=>{const s=t[0];if(e=Vp(`${o}/${s}`,n,a),!s||!e.exists)return{result:o,language:e.language};o=i?Zp(n,r):`${o}/${s}`,t.shift()})),{result:o,language:e.language}}},Xp=e=>{const t=e||!1;let n="";const r=(e,n)=>{if("undefined"!=typeof window){const r=(e=>{let t=[];if(e.queryParams)for(let[n,r]of Object.entries(e.queryParams))t.push(`${n}=${r}`);const n=e.hash?e.hash:"";return t.length>0?`${e.path}?${t.join("&")}${n}`:e.path+n})(e);n&&window.history.pushState({page:r},"",r),t&&i(r)}},i=e=>{"undefined"!=typeof ga&&(ga("set","page",e),ga("send","pageview"))};return Object.freeze({active:()=>n,isActive:(e,t=!1)=>{"/"!==e[0]&&(e="/"+e);let r=Mp(`http://fake.com${e}`).pathname,i=Mp(`http://fake.com${n}`).pathname;return r=Wp(r,"trail"),i=Wp(i,"trail"),t?i.includes(r):i===r},setActive:(e,t)=>{n=e.path,r(e,t)}})},Jp=(e,t)=>{const n=(e=>{const t=e;return Object.freeze({valid:()=>t&&t.guard&&"function"==typeof t.guard,redirect:()=>!t.guard(),redirectPath:()=>{let e="/";return t.redirect&&t.redirect.length>0&&(e=t.redirect),e}})})(e.onlyIf);return Object.freeze({path:()=>{let r=t;return e.redirectTo&&e.redirectTo.length>0&&(r=e.redirectTo),n.valid()&&n.redirect()&&(r=n.redirectPath()),r}})};function Qp({routes:e,currentUrl:t,routerOptions:n,convert:r}){const i=n.defaultLanguage,o=n.prefix?n.prefix.toLowerCase():"",s=function(e,t){if(t&&t.trim().length>0){const n=e.endsWith(t)?t:t+"/",r=e.replace(n,"");return Mp(r)}return Mp(e)}(t,o);let a="",c={},u=!1;function f(e,t,n,r,o){let l={};const d=function({basePath:e,basePathName:t,pathNames:n,convert:r,currentLanguage:i}){let o,s,a=i;function c(){return Zp(s,a)}function u(){return Gp(c())}function f(){return Gp(o.result)}return Object.freeze({basePathSameAsLocalised:function(){return f()===u()},updatedPath:function(e){return s=e,o=Yp(t,n,s,a,r),a=r?i:o.language,o},basePathNameWithoutNamedParams:f,localisedPathName:c,localisedRouteWithoutNamedParams:u,namedPath:function(){let t=c();return t&&!t.startsWith("/")&&(t="/"+t),e?`${e}${t}`:t},pathNames:n,routeLanguage:function(){return a},routePath:function(){let t=`${e}/${f()}`;"//"===t&&(t="/"),a&&(n=Kp(n,u()));const r=zp(c());return r&&r.length>0&&r.forEach((function(){n.length>0&&(t+=`/${n.shift()}`)})),t}})}({basePath:t,basePathName:n.shift().toLowerCase(),pathNames:n,convert:o,currentLanguage:r});return u=!1,e.forEach((function(e){if(d.updatedPath(e),function(e,t){const n=e.basePathSameAsLocalised();n&&(u=!0);return n||!u&&(e=>Wp(e).startsWith(":"))(t)}(d,e.name)){let t=d.routePath();if(a=Jp(e,a).path(),l.name!==t&&(l=function({route:e,routePath:t,routeLanguage:n,urlParser:r,namedPath:o}){const s=function({routeInfo:e,path:t,routeNamedParams:n,urlParser:r,namedPath:i,language:o}){const s=()=>{const e=Mp(`https://fake.com${r.pathname}`,i).namedParams;return{...n,...e}};return Object.freeze({get:()=>({name:t,component:e.component,hash:r.hash,layout:e.layout,queryParams:r.queryParams,namedParams:s(),path:t,language:o}),namedParams:s})}({routeInfo:e,urlParser:r,path:t,routeNamedParams:c,namedPath:o,language:n||i});return c=s.namedParams(),s.get()}({route:e,routePath:t,routeLanguage:d.routeLanguage(),urlParser:s,namedPath:d.namedPath()})),e.nestedRoutes&&e.nestedRoutes.length>0&&d.pathNames.length>0)l.childRoute=f(e.nestedRoutes,t,d.pathNames,d.routeLanguage(),o),l.path=l.childRoute.path,l.language=l.childRoute.language;else if(function(e,t){return e.nestedRoutes&&e.nestedRoutes.length>0&&0===t.length}(e,d.pathNames)){const n=f(e.nestedRoutes,t,["index"],d.routeLanguage(),o);n&&Object.keys(n).length>0&&(l.childRoute=n,l.language=l.childRoute.language)}}})),a&&(l.redirectTo=a),l}const l=t=>{const n=e.find((e=>"404"==e.name)),r=t||i||"";return n?{...n,language:r,path:"404"}:{name:"404",component:"",path:"404",redirectTo:"/404.html"}};return Object.freeze({findActiveRoute:function(){let t=f(e,"",s.pathNames,n.lang,r);return t&&Object.keys(t).length&&!jp(t)?(t.path=t.path.split("?")[0],o&&(t.path=`/${o}${t.path}`)):"undefined"!=typeof window&&(t=l(n.lang)),t}})}const eg="/404.html";let tg,ng=[],rg={};const ig=(e,t,n={})=>{rg={...n},void 0!==t&&""!==t||(t=document.location.href),tg=Xp(rg.gaPageviews),t=Wp(t,"trail"),ng=e;const r=()=>{let n=!1;return rg.langConvertTo&&(rg.lang=rg.langConvertTo,n=!0),Qp({routes:e,currentUrl:t,routerOptions:rg,convert:n}).findActiveRoute()};return Object.freeze({setActiveRoute:(e=!0)=>{const t=r();return t.redirectTo?((e,t)=>("undefined"!=typeof window&&(e===eg?tg.setActive({path:eg},t):og(e)),e))(t.redirectTo,e):(tg.setActive(t,e),Cp.set(t),t)},findActiveRoute:r})},og=(e,t=null,n=!0)=>(e=Wp(e,"lead"),t&&(rg.langConvertTo=t),ig(ng,"http://fake.com/"+e,rg).setActiveRoute(n));function sg(e){let t,n;return t=new lg({props:{currentRoute:e[0].childRoute,params:e[1]}}),{c(){_e(t.$$.fragment)},m(e,r){Ae(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.currentRoute=e[0].childRoute),2&n&&(r.params=e[1]),t.$set(r)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){me(t.$$.fragment,e),n=!1},d(e){Te(t,e)}}}function ag(e){let t,n,r;var i=e[0].component;function o(e){return{props:{currentRoute:{...e[0],component:""},params:e[1]}}}return i&&(t=j(i,o(e))),{c(){t&&_e(t.$$.fragment),n=P()},m(e,i){t&&Ae(t,e,i),N(e,n,i),r=!0},p(e,r){const s={};if(1&r&&(s.currentRoute={...e[0],component:""}),2&r&&(s.params=e[1]),1&r&&i!==(i=e[0].component)){if(t){he();const e=t;me(e.$$.fragment,1,0,(()=>{Te(e,1)})),pe()}i?(t=j(i,o(e)),_e(t.$$.fragment),ge(t.$$.fragment,1),Ae(t,n.parentNode,n)):t=null}else i&&t.$set(s)},i(e){r||(t&&ge(t.$$.fragment,e),r=!0)},o(e){t&&me(t.$$.fragment,e),r=!1},d(e){e&&O(n),t&&Te(t,e)}}}function cg(e){let t,n,r;var i=e[0].layout;function o(e){return{props:{currentRoute:{...e[0],layout:""},params:e[1]}}}return i&&(t=j(i,o(e))),{c(){t&&_e(t.$$.fragment),n=P()},m(e,i){t&&Ae(t,e,i),N(e,n,i),r=!0},p(e,r){const s={};if(1&r&&(s.currentRoute={...e[0],layout:""}),2&r&&(s.params=e[1]),1&r&&i!==(i=e[0].layout)){if(t){he();const e=t;me(e.$$.fragment,1,0,(()=>{Te(e,1)})),pe()}i?(t=j(i,o(e)),_e(t.$$.fragment),ge(t.$$.fragment,1),Ae(t,n.parentNode,n)):t=null}else i&&t.$set(s)},i(e){r||(t&&ge(t.$$.fragment,e),r=!0)},o(e){t&&me(t.$$.fragment,e),r=!1},d(e){e&&O(n),t&&Te(t,e)}}}function ug(e){let t,n,r,i;const o=[cg,ag,sg],s=[];function a(e,t){return e[0].layout?0:e[0].component?1:e[0].childRoute?2:-1}return~(t=a(e))&&(n=s[t]=o[t](e)),{c(){n&&n.c(),r=P()},m(e,n){~t&&s[t].m(e,n),N(e,r,n),i=!0},p(e,[i]){let c=t;t=a(e),t===c?~t&&s[t].p(e,i):(n&&(he(),me(s[c],1,1,(()=>{s[c]=null})),pe()),~t?(n=s[t],n?n.p(e,i):(n=s[t]=o[t](e),n.c()),ge(n,1),n.m(r.parentNode,r)):n=null)},i(e){i||(ge(n),i=!0)},o(e){me(n),i=!1},d(e){~t&&s[t].d(e),e&&O(r)}}}function fg(e,t,n){let{currentRoute:r={}}=t,{params:i={}}=t;return e.$$set=e=>{"currentRoute"in e&&n(0,r=e.currentRoute),"params"in e&&n(1,i=e.params)},[r,i]}"undefined"!=typeof window&&(window.addEventListener("click",(e=>{if("a"!==e.target.localName.toLowerCase())return;if(e.metaKey||e.ctrlKey||e.shiftKey)return;const t=rg.prefix?`/${rg.prefix.toLowerCase()}`:"",n=e.target.pathname&&e.target.host===window.location.host,r=!(t.length>1)||e.target.pathname.startsWith(t);if(n&&r){e.preventDefault();const t=e.target.pathname+e.target.search+e.target.search+e.target.hash;"_blank"===e.target.target?window.open(t,"newTab"):og(t)}})),window.onpopstate=function(e){let t=window.location.pathname+window.location.search+window.location.hash;og(t,null,!1)});class lg extends Ne{constructor(e){super(),Be(this,e,fg,ug,a,{currentRoute:0,params:1})}}function dg(e){let t,n;return t=new lg({props:{currentRoute:e[0]}}),{c(){_e(t.$$.fragment)},m(e,r){Ae(t,e,r),n=!0},p(e,[n]){const r={};1&n&&(r.currentRoute=e[0]),t.$set(r)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){me(t.$$.fragment,e),n=!1},d(e){Te(t,e)}}}function hg(e,t,n){let r;f(e,Cp,(e=>n(0,r=e)));let{routes:i=[]}=t,{options:o={}}=t;return function(e){W().$$.on_mount.push(e)}((()=>{ig(i,document.location.href,o).setActiveRoute()})),e.$$set=e=>{"routes"in e&&n(1,i=e.routes),"options"in e&&n(2,o=e.options)},[r,i,o]}class pg extends Ne{constructor(e){super(),Be(this,e,hg,dg,a,{routes:1,options:2})}}const gg=Re({state:"initializing-auth"});function mg(){const e=u(gg);"anonymous"===e.state&&e.client.login({maxTimeToLive:BigInt(1800)*BigInt(1e9),identityProvider:"ic"===process.env.DFX_NETWORK?"https://identity.ic0.app/#authorize":"http://rdmx6-jaaaa-aaaaa-aaadq-cai.localhost:8000/#authorize",onSuccess:()=>bg(e.client)})}async function yg(){const e=u(gg);"initialized"===e.state&&(await e.client.logout(),gg.update((()=>({state:"anonymous",actor:rf(),client:e.client}))),og("/"))}async function bg(e){setTimeout((()=>{try{const e=JSON.parse(window.localStorage.getItem("ic-delegation")),t=Number.parseInt(e.delegations[0].delegation.expiration,16)/1e6;setTimeout((()=>{yg()}),t-Date.now())}catch(e){console.error("Could not handle delegation expiry.")}}));try{const t=rf({agentOptions:{identity:e.getIdentity()}});gg.update((()=>({state:"initializing-crypto",actor:t,client:e})));const n=new Rp(t);gg.update((()=>({state:"initialized",actor:t,client:e,crypto:n})))}catch(e){gg.update((()=>({state:"error",error:e.message||"An error occurred"})))}}function wg(t){let n,r;return{c(){n=R("strong"),n.textContent="Disclaimer:",r=L(" This sample dapp is intended exclusively for experimental\npurpose. You are advised not to use this dapp for storing your critical data such\nas keys or passwords.")},m(e,t){N(e,n,t),N(e,r,t)},p:e,i:e,o:e,d(e){e&&O(n),e&&O(r)}}}!async function(){const e=await hl.create();await e.isAuthenticated()?bg(e):gg.update((()=>({state:"anonymous",actor:rf(),client:e})))}();class vg extends Ne{constructor(e){super(),Be(this,e,null,wg,a,{})}}function Eg(t){let n;return{c(){n=R("span"),D(n,"class","inline-block h-4 w-4 rounded-full mr-2 border-2 animate-spin border-b-current border-r-current border-t-transparent border-l-transparent")},m(e,t){N(e,n,t)},p:e,i:e,o:e,d(e){e&&O(n)}}}class xg extends Ne{constructor(e){super(),Be(this,e,null,Eg,a,{})}}function _g(t){let n;return{c(){n=R("div"),n.textContent="An error occurred.",D(n,"class","text-lg font-semibold mt-8")},m(e,t){N(e,n,t)},p:e,i:e,o:e,d(e){e&&O(n)}}}function Ag(t){let n,r,i;return{c(){n=R("button"),n.textContent="Please login to start writing notes",D(n,"class","btn btn-primary")},m(e,o){N(e,n,o),r||(i=U(n,"click",t[1]),r=!0)},p:e,i:e,o:e,d(e){e&&O(n),r=!1,i()}}}function Tg(t){let n,r,i,o;return r=new xg({}),{c(){n=R("div"),_e(r.$$.fragment),i=L("\n          Synchronizing... Please keep the app open on a device that's already added."),D(n,"class","text-lg font-semibold")},m(e,t){N(e,n,t),Ae(r,n,null),T(n,i),o=!0},p:e,i(e){o||(ge(r.$$.fragment,e),o=!0)},o(e){me(r.$$.fragment,e),o=!1},d(e){e&&O(n),Te(r)}}}function Sg(t){let n,r,i,o;return r=new xg({}),{c(){n=R("div"),_e(r.$$.fragment),i=L("\n          Initializing..."),D(n,"class","text-lg font-semibold mt-8")},m(e,t){N(e,n,t),Ae(r,n,null),T(n,i),o=!0},p:e,i(e){o||(ge(r.$$.fragment,e),o=!0)},o(e){me(r.$$.fragment,e),o=!1},d(e){e&&O(n),Te(r)}}}function Bg(e){let t,n,r,i,o,s,a,c,u,f,l,d,h,p,g,m,y;const b=[Sg,Tg,Ag,_g],w=[];function v(e,t){return"initializing-auth"===e[0].state||"initializing-crypto"===e[0].state?0:"synchronizing"===e[0].state?1:"anonymous"===e[0].state?2:"error"===e[0].state?3:-1}return~(f=v(e))&&(l=w[f]=b[f](e)),p=new vg({}),{c(){t=R("div"),n=R("div"),r=R("div"),i=R("h1"),i.textContent="Encrypted Notes",o=$(),s=R("p"),s.textContent="Your private notes on the Internet Computer.",a=$(),c=R("p"),c.textContent="A safe place to store your personal lists, thoughts, ideas or\n        passphrases and much more...",u=$(),l&&l.c(),d=$(),h=R("div"),_e(p.$$.fragment),g=$(),m=R("div"),m.innerHTML='<img src="/img/ic-badge-powered-by-crypto_label-stripe-white-text.png" alt="Powered by the Internet Computer" class="hidden dark:inline h-4"/> \n    <img src="/img/ic-badge-powered-by-crypto_label-stripe-dark-text.png" alt="Powered by the Internet Computer" class="dark:hidden inline h-4"/>',D(i,"class","mb-5 text-4xl sm:text-5xl font-bold text-primary dark:text-white"),D(s,"class","mb-5 text-xl font-semibold"),D(c,"class","mb-5"),D(h,"class","text-xs mt-8 sm:mt-12 opacity-75 mb-12 sm:mb-32"),D(r,"class","max-w-xl "),D(n,"class","text-center hero-content "),D(m,"class","fixed bottom-0 text-center left-0 right-0 pb-4 sm:pb-8"),D(t,"class","hero min-h-screen pt-8 sm:pt-0 content-start sm:content-center")},m(e,l){N(e,t,l),T(t,n),T(n,r),T(r,i),T(r,o),T(r,s),T(r,a),T(r,c),T(r,u),~f&&w[f].m(r,null),T(r,d),T(r,h),Ae(p,h,null),T(t,g),T(t,m),y=!0},p(e,[t]){let n=f;f=v(e),f===n?~f&&w[f].p(e,t):(l&&(he(),me(w[n],1,1,(()=>{w[n]=null})),pe()),~f?(l=w[f],l?l.p(e,t):(l=w[f]=b[f](e),l.c()),ge(l,1),l.m(r,d)):l=null)},i(e){y||(ge(l),ge(p.$$.fragment,e),y=!0)},o(e){me(l),me(p.$$.fragment,e),y=!1},d(e){e&&O(t),~f&&w[f].d(),Te(p)}}}function Ng(e,t,n){let{auth:r}=t;return e.$$set=e=>{"auth"in e&&n(0,r=e.auth)},[r,()=>mg()]}class Og extends Ne{constructor(e){super(),Be(this,e,Ng,Bg,a,{auth:0})}}async function Ig(e,t){const n={title:e.title,content:e.content,createdAt:e.createdAt,updatedAt:e.updatedAt,tags:e.tags},r=await t.encryptWithNoteKey(e.id,e.owner,JSON.stringify(n));return{id:e.id,encrypted_text:r,owner:e.owner,users:e.users}}function Rg(e){var t;const n=e.querySelector("h1");if(n)return n.innerText;const r=e.querySelectorAll("h1,h2,p,li");for(const e of r)if((null===(t=e.innerText)||void 0===t?void 0:t.trim().length)>0)return e.innerText.trim();return""}function kg(e){const t=document.createElement("div");return t.innerHTML=e,Rg(t)}const Lg=Re({state:"uninitialized"});let $g;async function Pg(e,t){const n=e.filter((e=>""!=e.encrypted_text));return await Promise.all(n.map((e=>async function(e,t){const n=await t.decryptWithNoteKey(e.id,e.owner,e.encrypted_text),r=JSON.parse(n);return Object.assign({id:e.id,owner:e.owner,users:e.users},r)}(e,t))))}async function Ug(e,t){const n=await e.get_notes();!function(e){Lg.set({state:"loaded",list:e})}(await Pg(n,t))}function Dg(e){if(!e)return e;if("function"==typeof e.toJSON&&(e=e.toJSON()),Array.isArray(e))return e.map(Dg);if("object"==typeof e){const t={};return Object.keys(e).forEach((n=>t[n]=Dg(e[n]))),t}return e}gg.subscribe((async e=>{if("initialized"===e.state){null!==$g&&(clearInterval($g),$g=null),Lg.set({state:"loading"});try{await Ug(e.actor,e.crypto).catch((e=>Up(e,"Could not poll notes."))),$g=setInterval((async()=>{await Ug(e.actor,e.crypto).catch((e=>Up(e,"Could not poll notes.")))}),3e3)}catch(e){Lg.set({state:"error"})}}else"anonymous"===e.state&&null!==$g&&(clearInterval($g),$g=null,Lg.set({state:"uninitialized"}))}));const Fg={};function Cg(e,t,n=Fg){if(e===t)return!0;const r=typeof e,i=typeof e;if("number"===r&&"number"===i&&isNaN(e)&&isNaN(t))return!0;if(!e||!t||"object"!==r||"object"!==i||e.constructor!==t.constructor)return!1;if(e.valueOf()!==e)return Cg(e.valueOf(),t.valueOf(),n);const o=n.shallow?Mg:Cg;if("function"==typeof e[Symbol.iterator]){const r=e[Symbol.iterator](),i=t[Symbol.iterator]();let s=r.next(),a=i.next();for(;!s.done&&!a.done;){if(!o(s.value,a.value,n))return!1;s=r.next(),a=i.next()}return s.done===a.done}let s=Object.keys(e),a=Object.keys(t);if(n.excludeProps){const e=(c=n.excludeProps,e=>!c.has(e));s=s.filter(e),a=a.filter(e)}var c;return(n.partial||s.length===a.length)&&a.every((r=>e.hasOwnProperty(r)&&o(t[r],e[r],n)))}function Mg(e,t){return e===t}var jg=-1,qg=1,Vg=0;function zg(e,t,n,r){if(e===t)return e?[[Vg,e]]:[];if(null!=n){var i=function(e,t,n){var r="number"==typeof n?{index:n,length:0}:n.oldRange,i="number"==typeof n?null:n.newRange,o=e.length,s=t.length;if(0===r.length&&(null===i||0===i.length)){var a=r.index,c=e.slice(0,a),u=e.slice(a),f=i?i.index:null,l=a+s-o;if((null===f||f===l)&&!(l<0||l>s)){var d=t.slice(0,l);if((g=t.slice(l))===u){var h=Math.min(a,l);if((y=c.slice(0,h))===(w=d.slice(0,h)))return Qg(y,c.slice(h),d.slice(h),u)}}if(null===f||f===a){var p=a,g=(d=t.slice(0,p),t.slice(p));if(d===c){var m=Math.min(o-p,s-p);if((b=u.slice(u.length-m))===(v=g.slice(g.length-m)))return Qg(c,u.slice(0,u.length-m),g.slice(0,g.length-m),b)}}}if(r.length>0&&i&&0===i.length){var y=e.slice(0,r.index),b=e.slice(r.index+r.length);if(!(s<(h=y.length)+(m=b.length))){var w=t.slice(0,h),v=t.slice(s-m);if(y===w&&b===v)return Qg(y,e.slice(h,o-m),t.slice(h,s-m),b)}}return null}(e,t,n);if(i)return i}var o=Gg(e,t),s=e.substring(0,o);o=Kg(e=e.substring(o),t=t.substring(o));var a=e.substring(e.length-o),c=function(e,t){var n;if(!e)return[[qg,t]];if(!t)return[[jg,e]];var r=e.length>t.length?e:t,i=e.length>t.length?t:e,o=r.indexOf(i);if(-1!==o)return n=[[qg,r.substring(0,o)],[Vg,i],[qg,r.substring(o+i.length)]],e.length>t.length&&(n[0][0]=n[2][0]=jg),n;if(1===i.length)return[[jg,e],[qg,t]];var s=function(e,t){var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<4||2*r.length<n.length)return null;function i(e,t,n){for(var r,i,o,s,a=e.substring(n,n+Math.floor(e.length/4)),c=-1,u="";-1!==(c=t.indexOf(a,c+1));){var f=Gg(e.substring(n),t.substring(c)),l=Kg(e.substring(0,n),t.substring(0,c));u.length<l+f&&(u=t.substring(c-l,c)+t.substring(c,c+f),r=e.substring(0,n-l),i=e.substring(n+f),o=t.substring(0,c-l),s=t.substring(c+f))}return 2*u.length>=e.length?[r,i,o,s,u]:null}var o,s,a,c,u,f=i(n,r,Math.ceil(n.length/4)),l=i(n,r,Math.ceil(n.length/2));if(!f&&!l)return null;o=l?f&&f[4].length>l[4].length?f:l:f;e.length>t.length?(s=o[0],a=o[1],c=o[2],u=o[3]):(c=o[0],u=o[1],s=o[2],a=o[3]);var d=o[4];return[s,a,c,u,d]}(e,t);if(s){var a=s[0],c=s[1],u=s[2],f=s[3],l=s[4],d=zg(a,u),h=zg(c,f);return d.concat([[Vg,l]],h)}return function(e,t){for(var n=e.length,r=t.length,i=Math.ceil((n+r)/2),o=i,s=2*i,a=new Array(s),c=new Array(s),u=0;u<s;u++)a[u]=-1,c[u]=-1;a[o+1]=0,c[o+1]=0;for(var f=n-r,l=f%2!=0,d=0,h=0,p=0,g=0,m=0;m<i;m++){for(var y=-m+d;y<=m-h;y+=2){for(var b=o+y,w=(A=y===-m||y!==m&&a[b-1]<a[b+1]?a[b+1]:a[b-1]+1)-y;A<n&&w<r&&e.charAt(A)===t.charAt(w);)A++,w++;if(a[b]=A,A>n)h+=2;else if(w>r)d+=2;else if(l){if((x=o+f-y)>=0&&x<s&&-1!==c[x])if(A>=(E=n-c[x]))return Hg(e,t,A,w)}}for(var v=-m+p;v<=m-g;v+=2){for(var E,x=o+v,_=(E=v===-m||v!==m&&c[x-1]<c[x+1]?c[x+1]:c[x-1]+1)-v;E<n&&_<r&&e.charAt(n-E-1)===t.charAt(r-_-1);)E++,_++;if(c[x]=E,E>n)g+=2;else if(_>r)p+=2;else if(!l){if((b=o+f-v)>=0&&b<s&&-1!==a[b]){var A;w=o+(A=a[b])-b;if(A>=(E=n-E))return Hg(e,t,A,w)}}}}return[[jg,e],[qg,t]]}(e,t)}(e=e.substring(0,e.length-o),t=t.substring(0,t.length-o));return s&&c.unshift([Vg,s]),a&&c.push([Vg,a]),Wg(c,r),c}function Hg(e,t,n,r){var i=e.substring(0,n),o=t.substring(0,r),s=e.substring(n),a=t.substring(r),c=zg(i,o),u=zg(s,a);return c.concat(u)}function Gg(e,t){if(!e||!t||e.charAt(0)!==t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(o,i)==t.substring(o,i)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return Zg(e.charCodeAt(i-1))&&i--,i}function Kg(e,t){if(!e||!t||e.slice(-1)!==t.slice(-1))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(e.length-i,e.length-o)==t.substring(t.length-i,t.length-o)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return Yg(e.charCodeAt(e.length-i))&&i--,i}function Wg(e,t){e.push([Vg,""]);for(var n,r=0,i=0,o=0,s="",a="";r<e.length;)if(r<e.length-1&&!e[r][1])e.splice(r,1);else switch(e[r][0]){case qg:o++,a+=e[r][1],r++;break;case jg:i++,s+=e[r][1],r++;break;case Vg:var c=r-o-i-1;if(t){if(c>=0&&Jg(e[c][1])){var u=e[c][1].slice(-1);if(e[c][1]=e[c][1].slice(0,-1),s=u+s,a=u+a,!e[c][1]){e.splice(c,1),r--;var f=c-1;e[f]&&e[f][0]===qg&&(o++,a=e[f][1]+a,f--),e[f]&&e[f][0]===jg&&(i++,s=e[f][1]+s,f--),c=f}}if(Xg(e[r][1])){u=e[r][1].charAt(0);e[r][1]=e[r][1].slice(1),s+=u,a+=u}}if(r<e.length-1&&!e[r][1]){e.splice(r,1);break}if(s.length>0||a.length>0){s.length>0&&a.length>0&&(0!==(n=Gg(a,s))&&(c>=0?e[c][1]+=a.substring(0,n):(e.splice(0,0,[Vg,a.substring(0,n)]),r++),a=a.substring(n),s=s.substring(n)),0!==(n=Kg(a,s))&&(e[r][1]=a.substring(a.length-n)+e[r][1],a=a.substring(0,a.length-n),s=s.substring(0,s.length-n)));var l=o+i;0===s.length&&0===a.length?(e.splice(r-l,l),r-=l):0===s.length?(e.splice(r-l,l,[qg,a]),r=r-l+1):0===a.length?(e.splice(r-l,l,[jg,s]),r=r-l+1):(e.splice(r-l,l,[jg,s],[qg,a]),r=r-l+2)}0!==r&&e[r-1][0]===Vg?(e[r-1][1]+=e[r][1],e.splice(r,1)):r++,o=0,i=0,s="",a=""}""===e[e.length-1][1]&&e.pop();var d=!1;for(r=1;r<e.length-1;)e[r-1][0]===Vg&&e[r+1][0]===Vg&&(e[r][1].substring(e[r][1].length-e[r-1][1].length)===e[r-1][1]?(e[r][1]=e[r-1][1]+e[r][1].substring(0,e[r][1].length-e[r-1][1].length),e[r+1][1]=e[r-1][1]+e[r+1][1],e.splice(r-1,1),d=!0):e[r][1].substring(0,e[r+1][1].length)==e[r+1][1]&&(e[r-1][1]+=e[r+1][1],e[r][1]=e[r][1].substring(e[r+1][1].length)+e[r+1][1],e.splice(r+1,1),d=!0)),r++;d&&Wg(e,t)}function Zg(e){return e>=55296&&e<=56319}function Yg(e){return e>=56320&&e<=57343}function Xg(e){return Yg(e.charCodeAt(0))}function Jg(e){return Zg(e.charCodeAt(e.length-1))}function Qg(e,t,n,r){return Jg(e)||Xg(r)?null:function(e){for(var t=[],n=0;n<e.length;n++)e[n][1].length>0&&t.push(e[n]);return t}([[Vg,e],[jg,t],[qg,n],[Vg,r]])}function em(e,t,n){return zg(e,t,n,!0)}em.INSERT=qg,em.DELETE=jg,em.EQUAL=Vg;var tm=Le(em);const nm=new WeakMap,rm=new WeakMap;class im{on(e,t,n){this.addEventListener(e,t,n)}off(e,t,n){this.removeEventListener(e,t,n)}addEventListener(e,t,n){(null==n?void 0:n.once)&&(t=sm(this,e,t,!0)),om(this,e,!0).add(t)}removeEventListener(e,t,n){if((null==n?void 0:n.once)&&(t=sm(this,e,t)),!t)return;const r=om(this,e);r&&r.delete(t)}dispatchEvent(e,t){const n=om(this,e.type);if(n)for(let r of n){if(t)try{r.call(this,e)}catch(e){try{this.dispatchEvent(new ErrorEvent("error",{error:e}))}catch(e){}}else r.call(this,e);if(e.cancelBubble)break}}}function om(e,t,n=!1){let r=nm.get(e);return!r&&n&&nm.set(e,r=Object.create(null)),r&&r[t]||n&&(r[t]=new Set)}function sm(e,t,n,r=!1){let i=rm.get(e);!i&&r&&nm.set(e,i=Object.create(null));const o=i&&i[t]||r&&(i[t]=new Map);if(!o.has(n)&&r){const r=r=>{const i=om(e,t);i&&i.delete(n),n.call(e,r)};o.set(n,r)}return o&&o.get(n)}var am;function cm(e){return e===Object(e)&&!Array.isArray(e)}!function(e){e.compose=function e(t={},n={},r){"object"!=typeof t&&(t={}),"object"!=typeof n&&(n={});let i=Dg(n);for(const n in t)cm(t[n])&&cm(i[n])&&(i[n]=e(t[n],i[n],r));r||(i=Object.keys(i).reduce(((e,t)=>(null!=i[t]&&(e[t]=i[t]),e)),{}));for(const e in t)void 0!==t[e]&&void 0===n[e]&&(i[e]=t[e]);return Object.keys(i).length>0?i:void 0},e.diff=function e(t={},n={}){"object"!=typeof t&&(t={}),"object"!=typeof n&&(n={});const r=Object.keys(t).concat(Object.keys(n)).reduce(((r,i)=>(Cg(t[i],n[i])||(void 0===n[i]?r[i]=null:cm(t[i])&&cm(n[i])?r[i]=e(t[i],n[i]):r[i]=n[i]),r)),{});return Object.keys(r).length>0?r:void 0},e.invert=function e(t={},n={}){t=t||{};const r=Object.keys(n).reduce(((r,i)=>(Cg(n[i],t[i])||void 0===t[i]||(cm(t[i])&&cm(n[i])?r[i]=e(t[i],n[i]):r[i]=n[i]),r)),{});return Object.keys(t).reduce(((e,r)=>(t[r]!==n[r]&&void 0===n[r]&&(e[r]=null),e)),r)},e.transform=function e(t,n,r=!1){if("object"!=typeof t)return n;if("object"!=typeof n)return;if(!r)return n;const i=Object.keys(n).reduce(((r,i)=>(void 0===t[i]?r[i]=n[i]:cm(t[i])&&cm(n[i])&&(r[i]=e(t[i],n[i],!0)),r)),{});return Object.keys(i).length>0?i:void 0}}(am||(am={}));var um,fm=am;!function(e){e.iterator=function(e){return new dm(e)},e.length=function(e){return"number"==typeof e.delete?e.delete:"number"==typeof e.retain?e.retain:"string"==typeof e.insert?e.insert.length:1}}(um||(um={}));var lm=um;class dm{constructor(e){this.ops=e,this.index=0,this.offset=0}hasNext(){return!!this.peek()}next(e){e||(e=1/0);const t=this.ops[this.index];if(t){const n=this.offset,r=um.length(t);if(e>=r-n?(e=r-n,this.index+=1,this.offset=0):this.offset+=e,"number"==typeof t.delete)return{delete:e};{if(r===e)return t;const i={};return t.attributes&&(i.attributes=t.attributes),"number"==typeof t.retain?i.retain=e:"string"==typeof t.insert?i.insert=t.insert.substr(n,e):i.insert=t.insert,i}}return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?um.length(this.ops[this.index])-this.offset:1/0}peekType(){return this.ops[this.index]?"number"==typeof this.ops[this.index].delete?"delete":"number"==typeof this.ops[this.index].retain?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);{const e=this.offset,t=this.index,n=this.next(),r=this.ops.slice(this.index);return this.offset=e,this.index=t,[n].concat(r)}}return[]}}const hm=String.fromCharCode(0);class pm{constructor(e){Array.isArray(e)?this.ops=e:null!=e&&Array.isArray(e.ops)?this.ops=e.ops:this.ops=[]}insert(e,t){const n={};return"string"==typeof e&&0===e.length?this:(n.insert=e,null!=t&&"object"==typeof t&&Object.keys(t).length>0&&(n.attributes=t),this.push(n))}delete(e){return e<=0?this:this.push({delete:e})}retain(e,t){if(e<=0)return this;const n={retain:e};return null!=t&&"object"==typeof t&&Object.keys(t).length>0&&(n.attributes=t),this.push(n)}push(e){let t=this.ops.length,n=this.ops[t-1];if("object"==typeof n){if("number"==typeof e.delete&&"number"==typeof n.delete)return this.ops[t-1]={delete:n.delete+e.delete},this;if("number"==typeof n.delete&&null!=e.insert&&(t-=1,n=this.ops[t-1],"object"!=typeof n))return this.ops.unshift(e),this;if(Cg(e.attributes,n.attributes)){if("string"==typeof e.insert&&"string"==typeof n.insert)return this.ops[t-1]={insert:n.insert+e.insert},"object"==typeof e.attributes&&(this.ops[t-1].attributes=e.attributes),this;if("number"==typeof e.retain&&"number"==typeof n.retain)return this.ops[t-1]={retain:n.retain+e.retain},"object"==typeof e.attributes&&(this.ops[t-1].attributes=e.attributes),this}}return t===this.ops.length?this.ops.push(e):this.ops.splice(t,0,e),this}chop(){const e=this.ops[this.ops.length-1];return e&&e.retain&&!e.attributes&&this.ops.pop(),this}filter(e){return this.ops.filter(e)}forEach(e){this.ops.forEach(e)}map(e){return this.ops.map(e)}partition(e){const t=[],n=[];return this.forEach((r=>{(e(r)?t:n).push(r)})),[t,n]}reduce(e,t){return this.ops.reduce(e,t)}changeLength(){return this.reduce(((e,t)=>t.insert?e+lm.length(t):t.delete?e-t.delete:e),0)}length(){return this.reduce(((e,t)=>e+lm.length(t)),0)}slice(e=0,t=1/0){const n=[],r=lm.iterator(this.ops);let i=0;for(;i<t&&r.hasNext();){let o;i<e?o=r.next(e-i):(o=r.next(t-i),n.push(o)),i+=lm.length(o)}return new pm(n)}compose(e,t){const n=lm.iterator(this.ops),r=lm.iterator(e.ops),i=[],o=r.peek();if(null!=o&&"number"==typeof o.retain&&null==o.attributes){let e=o.retain;for(;"insert"===n.peekType()&&n.peekLength()<=e;)e-=n.peekLength(),i.push(n.next());o.retain-e>0&&r.next(o.retain-e)}const s=new pm(i);for(;n.hasNext()||r.hasNext();)if("insert"===r.peekType())s.push(r.next());else if("delete"===n.peekType())s.push(n.next());else{const e=Math.min(n.peekLength(),r.peekLength()),i=n.next(e),o=r.next(e);if("number"==typeof o.retain){let a;const c=o.attributes&&fm.compose(i.attributes,o.attributes,!t&&"number"==typeof i.retain);if(o.attributes&&!Cg(c,i.attributes)?(a={},"number"==typeof i.retain?a.retain=e:a.insert=i.insert,c&&(a.attributes=c)):a=i.retain===1/0?o:i,s.push(a),o.retain===1/0||!r.hasNext()&&Cg(s.ops[s.ops.length-1],a)){const e=new pm(n.rest());return s.concat(e).chop()}}else"number"==typeof o.delete&&"number"==typeof i.retain&&s.push(o)}return s.chop()}concat(e){const t=new pm(this.ops.slice());return e.ops.length>0&&(t.push(e.ops[0]),t.ops=t.ops.concat(e.ops.slice(1))),t}diff(e,t){if(this.ops===e.ops)return new pm;const n=[this,e].map((t=>t.map((n=>{if(null!=n.insert)return"string"==typeof n.insert?n.insert:hm;throw new Error("diff() called "+(t===e?"on":"with")+" non-document")})).join(""))),r=new pm,i=tm(n[0],n[1],t),o=lm.iterator(this.ops),s=lm.iterator(e.ops);return i.forEach((e=>{let t=e[1].length;for(;t>0;){let n=0;switch(e[0]){case tm.INSERT:n=Math.min(s.peekLength(),t),r.push(s.next(n));break;case tm.DELETE:n=Math.min(t,o.peekLength()),o.next(n),r.delete(n);break;case tm.EQUAL:n=Math.min(o.peekLength(),s.peekLength(),t);const e=o.next(n),i=s.next(n);Cg(e.insert,i.insert)?r.retain(n,fm.diff(e.attributes,i.attributes)):r.push(i).delete(n)}t-=n}})),r.chop()}eachLine(e,t="\n"){const n=lm.iterator(this.ops);let r=new pm,i=0;for(;n.hasNext();){if("insert"!==n.peekType())return;const o=n.peek(),s=lm.length(o)-n.peekLength(),a="string"==typeof o.insert?o.insert.indexOf(t,s)-s:-1;if(a<0)r.push(n.next());else if(a>0)r.push(n.next(a));else{if(!1===e(r,n.next(1).attributes||{},i))return;i+=1,r=new pm}}r.length()>0&&e(r,{},i,!0)}invert(e){const t=new pm;return this.reduce(((n,r)=>{if(r.insert)t.delete(lm.length(r));else{if(r.retain&&null==r.attributes)return t.retain(r.retain),n+r.retain;if(r.delete||r.retain&&r.attributes){const i=r.delete||r.retain;return e.slice(n,n+i).forEach((e=>{r.delete?t.push(e):r.retain&&r.attributes&&t.retain(lm.length(e),fm.invert(r.attributes,e.attributes))})),n+i}}return n}),0),t.chop()}transform(e,t=!1){if(t=!!t,"number"==typeof e)return this.transformPosition(e,t);const n=e,r=lm.iterator(this.ops),i=lm.iterator(n.ops),o=new pm;for(;r.hasNext()||i.hasNext();)if("insert"!==r.peekType()||!t&&"insert"===i.peekType())if("insert"===i.peekType())o.push(i.next());else{const e=Math.min(r.peekLength(),i.peekLength()),n=r.next(e),s=i.next(e);if(n.delete)continue;s.delete?o.push(s):o.retain(e,fm.transform(n.attributes,s.attributes,t))}else o.retain(lm.length(r.next()));return o.chop()}transformPosition(e,t=!1){t=!!t;const n=lm.iterator(this.ops);let r=0;for(;n.hasNext()&&r<=e;){const i=n.peekLength(),o=n.peekType();n.next(),"delete"!==o?("insert"===o&&(r<e||!t)&&(e+=i),r+=i):e-=Math.min(i,e-r)}return e}}function gm(e){return e?(e[0]>e[1]&&(e=[e[1],e[0]]),e):e}function mm(e){return e.map((e=>"string"==typeof e.insert?e.insert:e.insert?" ":"")).join("")}pm.Op=lm,pm.AttributeMap=fm;const ym=new Map,bm={id:"",attributes:{},content:new pm([{retain:1/0}]),length:1/0};var wm;!function(e){function t(e=ym){let t;for(;e[t=Math.random().toString(36).slice(2)];);return t}e.iterator=function(e,t){return new xm(e,t)},e.linesToLineIds=function(t){const n=new Map;return t.forEach((t=>n.set(t.id||e.createId(n),t))),n},e.length=function(e){return e.length},e.getId=function(e){return console.warn("getId() is deprecated"),e.id},e.equal=function(e,t){return Cg(e.attributes,t.attributes)&&Cg(e.content.ops,t.content.ops)},e.fromDelta=function(t,n){const r=[],i=new Map(n||[]);return t.eachLine(((t,n)=>{const o=e.create(t,Object.keys(n).length?n:void 0,i);i.set(o.id,o),r.push(o)})),r},e.toDelta=function(e){let t=new pm;return e.forEach((e=>{t=t.concat(e.content),t.insert("\n",e.attributes)})),t},e.create=function(e=new pm,n={},r){const i=e.length()+1;return"string"!=typeof r&&(r=t(r)),{id:r,attributes:n,content:e,length:i}},e.createFrom=function(e,n=new pm,r){return{id:e?e.id:t(r),attributes:e?e.attributes:{},content:n,length:1}},e.getLineRanges=function(e){const t=new Map;let n=0;return e.forEach((e=>{t.set(e,[n,n+=e.length])})),t},e.createId=t}(wm||(wm={}));var vm,Em=wm;class xm{constructor(e,t){this.lines=e,this.index=0,this.offset=0,this.lineIds=t?new Map(t):wm.linesToLineIds(e)}hasNext(){return!!this.peek()}next(e){e||(e=1/0);const t=this.lines[this.index];if(t){const n=this.offset,r=t.length;if(e>=r-n?(e=r-n,this.index+=1,this.offset=0):this.offset+=e,0===n&&e>=t.length)return t;{const r=0===n?t.id:wm.createId(this.lineIds),i={id:r,attributes:t.attributes,content:t.content.slice(n,e),length:e-n};return 0!==n&&this.lineIds.set(r,i),i}}return bm}peek(){return this.lines[this.index]}peekLength(){return this.lines[this.index]?this.lines[this.index].length-this.offset:1/0}rest(){if(this.hasNext()){if(0===this.offset)return this.lines.slice(this.index);{const e=this.offset,t=this.index,n=this.next(),r=this.lines.slice(this.index);return this.offset=e,this.index=t,[n].concat(r)}}return[]}}!function(e){e.iterator=function(e,t){return new Am(e,t)},e.length=function(e){return lm.length(e)}}(vm||(vm={}));var _m=vm;class Am{constructor(e,t){this.lineIterator=Em.iterator(e,t);const n=this.lineIterator.peek();this.opIterator=lm.iterator((null==n?void 0:n.content.ops)||[])}hasNext(){return this.opIterator.hasNext()||this.lineIterator.hasNext()}next(e){let t=this.opIterator.next(e);return t.retain===1/0&&this.lineIterator.hasNext()&&(t=Tm(this.nextLine())),t}nextLine(){const e=this.lineIterator.next(),t=this.lineIterator.peek();return this.opIterator=new dm((null==t?void 0:t.content.ops)||[]),e}peek(){return this.opIterator.hasNext()||!this.lineIterator.hasNext()?this.opIterator.peek():Tm(this.peekLine())}peekLine(){return this.lineIterator.peek()}peekLength(){return this.opIterator.hasNext()||!this.lineIterator.hasNext()?this.opIterator.peekLength():1}peekLineLength(){return this.lineIterator.peekLength()}peekType(){return this.opIterator.hasNext()?this.opIterator.peekType():this.lineIterator.hasNext()?"insert":"retain"}restCurrentLine(){return this.opIterator.rest()}restLines(){return this.opIterator.offset&&this.lineIterator.next(this.opIterator.offset),this.lineIterator.rest()}}function Tm(e){const t={insert:"\n"};return e.attributes&&(t.attributes=e.attributes),t}class Sm{constructor(e,t=new pm,n,r){this._pos=0,this.doc=e,this.delta=t,this.selection=n,this.activeFormats=r}get contentChanged(){return this.delta.ops.length>0}get selectionChanged(){var e;return void 0!==this.selection&&!Cg(this.selection,null===(e=this.doc)||void 0===e?void 0:e.selection)}apply(){throw new Error("Must be overridden by creator of change (e.g. Editor).")}setDelta(e){return this.delta=e,this._pos=e.length(),this}setActiveFormats(e){return this.activeFormats=e,this}select(e){return this.selection="number"==typeof e?[e,e]:e,this}delete(e,t){if(!e||!this.doc)return this;let[n,r]=gm(e);if(n=Math.max(0,n),r=Math.min(this.doc.length-1,r),n===r)return this;const i=r-n;this.doc.selection&&(this.selection=[n,n]),this.compose(n,(e=>e.delete(i)),i);const o=this.doc.getLineRange(n);if(!(null==t?void 0:t.dontFixNewline)&&o[1]<=r){const e=this.doc.getLineAt(n).attributes;this.formatLine(r,e)}return this}insert(e,t,n,r){if(!this.doc)return this;if(e=this.normalizePoint(e),this.doc.selection){const n=e+("string"==typeof t?t.length:1);this.selection=[n,n]}const{id:i,...o}=this.doc.getLineAt(e).attributes;if("string"!=typeof t)this.compose(e,(e=>e.insert(t,n)));else if("\n"===t)(null==r?void 0:r.dontFixNewline)?this.compose(e,(e=>e.insert("\n",{...n}))):(this.compose(e,(e=>e.insert("\n",o))),this.formatLine(e,{...n}));else if(n||(n=this.getFormatAt(e)),t.includes("\n")){const r=t.split("\n");this.compose(e,(e=>(r.forEach(((t,r)=>{r&&e.insert("\n",1===r?o:{}),t.length&&e.insert(t,n)})),e))),o&&this.formatLine(e,{...o})}else this.compose(e,(e=>e.insert(t,n)));return this}insertContent(e,t){if(!this.doc)return this;if(e=this.normalizePoint(e),this.doc.selection){const n=t.ops.filter((e=>e.delete));for(;n.length&&n[n.length-1].retain;)n.pop();const r=e+n.reduce(((e,t)=>e+lm.length(t)),0);this.selection=[r,r]}return-1!==mm(t).indexOf("\n")&&this.formatLine(e,{...this.doc.getLineFormat(e)}),this.compose(e,(e=>e.concat(t))),this}formatText(e,t){if(!this.doc)return this;return(e=gm(e))[1]-e[0]?(t&&Object.keys(t).forEach((e=>!1===t[e]&&(t[e]=null))),this.doc.getLineRanges(e).forEach((([n,r])=>{n=Math.max(e[0],n);const i=(r=Math.min(e[1],r-1))-n;this.compose(n,(e=>e.retain(i,t)),i)})),this):this}toggleTextFormat(e,t){if(!this.doc)return this;"number"==typeof e&&(e=[e,e]),e=gm(e);return Bm(t,this.doc.getTextFormat(e))&&(t=fm.invert(t)),this.formatText(e,t)}formatLine(e,t,n){if(!this.doc)return this;const r=this.doc;return"number"==typeof e&&(e=[e,e]),e=gm(e),this.doc.getLineRanges(e).forEach((([e,i])=>{if(i--,!n){const e=fm.invert(r.getLineFormat(i));t={...e,...t}}this.compose(i,(e=>e.retain(1,t)),1)})),this.delta.chop(),this}toggleLineFormat(e,t){if(!this.doc)return this;"number"==typeof e&&(e=[e,e]),e=gm(e);return Bm(t,this.doc.getLineFormat(e))&&(t=fm.invert(t)),this.formatLine(e,t)}removeFormat(e){if(!this.doc)return this;e=gm(e);const t=fm.invert(this.doc.getFormats(e)),n=e[1]-e[0];return this.compose(e[0],(e=>e.retain(n,t)),n)}transform(e,t){const n=this.delta.transform(e.delta,t),r=e.selection&&this.transformSelection(e.selection);return new Sm(null,n,r)}transformSelection(e,t){if(!e)return e;const n=this.delta.transformPosition(e[0],t),r=this.delta.transformPosition(e[1],t);return n===e[0]&&r===e[1]?e:[n,r]}transformAgainst(e,t){return(e instanceof pm?new Sm(null,e):e).transform(this,!t)}isFor(e){return this.doc===e}clone(){var e;return new Sm(this.doc,new pm(this.delta.ops.slice()),null===(e=this.selection)||void 0===e?void 0:e.slice())}compose(e,t,n){return this._pos<=e?this.delta=t(this.delta.retain(e-this._pos)):this.delta=this.delta.compose(t((new pm).retain(e))),this._pos=Math.max(e+(n||0),this._pos),this}normalizePoint(e,t=(this.doc?this.doc.length-1:0)){return Math.max(0,Math.min(t,e))}getFormatAt(e){let t;if(this.doc){const n=this.doc.getTextFormat(e),r=this.doc.getTextFormat(e+1);n&&r&&(t=n===r?n:function(e,t){const n={};return Object.keys(e).forEach((r=>{e[r]===t[r]&&(n[r]=e[r])})),n}(r,Object.keys(n)))}return t}}function Bm(e,t){return Object.keys(e).every((n=>Cg(t[n],e[n])))}const Nm=[0,0],Om={},Im=new WeakMap,Rm=new Set(["id"]);class km{constructor(e,t=null){e instanceof km?(this.lines=e.lines,this.byId=e.byId,this._ranges=e._ranges,this.length=e.length):(this.byId=new Map,Array.isArray(e)?this.lines=e:this.lines=e?Em.fromDelta(e):[Em.create()],this.lines.length||this.lines.push(Em.create()),this.byId=Em.linesToLineIds(this.lines),this.lines.forEach((e=>{if(this.byId.get(e.id)!==e)throw new Error("TextDocument has duplicate line ids: "+e.id)})),this._ranges=Em.getLineRanges(this.lines),this.length=this.lines.reduce(((e,t)=>e+t.length),0)),this.selection=t&&t.map((e=>Math.min(this.length-1,Math.max(0,e))))}get change(){const e=new Sm(this);return e.apply=()=>this.apply(e),e}getText(e){return e&&(e=gm(e)),mm(e?this.slice(e[0],e[1]):this.slice(0,this.length-1))}getLineBy(e){return this.byId.get(e)}getLineAt(e){return this.lines.find((t=>{const[n,r]=this.getLineRange(t);return n<=e&&r>e}))}getLinesAt(e,t){let n=e;return Array.isArray(e)&&([e,n]=gm(e)),this.lines.filter((r=>{const[i,o]=this.getLineRange(r);return t?i>=e&&o<=n:(i<n||i===e)&&o>e}))}getLineRange(e){const{lines:t,_ranges:n}=this;if("number"==typeof e){for(let r=0;r<t.length;r++){const i=n.get(t[r])||Nm;if(i[0]<=e&&i[1]>e)return i}return Nm}return"string"==typeof e&&(e=this.getLineBy(e)),n.get(e)}getLineRanges(e){return null==e?Array.from(this._ranges.values()):this.getLinesAt(e).map((e=>this.getLineRange(e)))}getLineFormat(e=this.selection,t){let n=e;return Array.isArray(e)&&([e,n]=gm(e)),e===n&&n++,Lm(Em,this.lines,e,n,void 0,t)}getTextFormat(e=this.selection,t){let n=e;return Array.isArray(e)&&([e,n]=gm(e)),e===n&&e--,Lm(_m,this.lines,e,n,(e=>"\n"!==e.insert),t)}getFormats(e=this.selection,t){return{...this.getTextFormat(e,t),...this.getLineFormat(e,t)}}slice(e=0,t=1/0){const n=[],r=_m.iterator(this.lines);let i=0;for(;i<t&&r.hasNext();){let o;i<e?o=r.next(e-i):(o=r.next(t-i),n.push(o)),i+=lm.length(o)}return new pm(n)}apply(e,t,n){let r;if(e instanceof Sm?(r=e.delta,t=e.selection):r=e,!r.ops.length&&(void 0===t||Cg(this.selection,t)))return this;if(!r.ops.length&&t)return new km(this,t);void 0===t&&this.selection&&(t=[r.transformPosition(this.selection[0]),r.transformPosition(this.selection[1])],Cg(this.selection,t)&&(t=this.selection));const i=_m.iterator(this.lines,this.byId),o=lm.iterator(r.ops);let s=[];const a=o.peek();if(a&&a.retain&&!a.attributes){let e=a.retain;for(;i.peekLineLength()<=e;)e-=i.peekLineLength(),s.push(i.nextLine());a.retain-e>0&&o.next(a.retain-e)}if(!i.hasNext()&&n)throw new Error("apply() called with change that extends beyond document");let c=Em.createFrom(i.peekLine());function u(e){e.length=e.content.length()+1,s.push(e)}for(;i.hasNext()||o.hasNext();)if("insert"===o.peekType()){const e=o.peek(),t="string"==typeof e.insert?e.insert.indexOf("\n",o.offset):-1;if(t<0)c.content.push(o.next());else{const e=t-o.offset;e&&c.content.push(o.next(e));const n=o.next(1);u(Em.create(c.content,n.attributes)),c.content=new pm}}else{const e=Math.min(i.peekLength(),o.peekLength()),t=i.next(e),r=o.next(e);if("number"==typeof t.retain){if(n)throw new Error("apply() called with change that extends beyond document");continue}if("number"==typeof r.retain){const e="\n"===t.insert;let n=t;const a=r.attributes&&fm.compose(t.attributes,r.attributes);if(r.attributes&&!Cg(a,t.attributes)&&(e?c.attributes=a||{}:(n={insert:t.insert},a&&(n.attributes=a))),e?(u(c),c=Em.createFrom(i.peekLine())):c.content.push(n),r.retain===1/0||!o.hasNext()){if(0!==i.opIterator.index||0!==i.opIterator.offset){const e=i.restCurrentLine();for(let t=0;t<e.length;t++)c.content.push(e[t]);u(c),i.nextLine()}s.push(...i.restLines());break}}else"number"==typeof r.delete&&"\n"===t.insert&&(c=Em.createFrom(i.peekLine(),c.content))}return new km(s,t)}replace(e,t){return new km(e,t)}toDelta(){const e=Im;let t=e.get(this);return t||(t=Em.toDelta(this.lines),e.set(this,t)),t}equals(e,t){return this===e||((null==t?void 0:t.contentOnly)||Cg(this.selection,e.selection))&&Cg(this.lines,e.lines,{excludeProps:Rm})}toJSON(){return this.toDelta()}toString(){return this.lines.map((e=>e.content.map((e=>"string"==typeof e.insert?e.insert:" ")).join(""))).join("\n")+"\n"}}function Lm(e,t,n,r,i,o){const s=e.iterator(t);let a,c=0;for(s.skip&&(c+=s.skip(n));c<r&&s.hasNext();){let t=s.next();c+=e.length(t),c>n&&(!i||i(t))&&(a=t.attributes?a?(null==o?void 0:o.allFormats)?fm.compose(a,t.attributes):$m(a,t.attributes,null==o?void 0:o.nameOnly):{...t.attributes}:{})}return a||Om}function $m(e,t,n){return Object.keys(t).reduce((function(r,i){return n?i in e&&i in t&&(r[i]=!0):Cg(e[i],t[i],{partial:!0})?r[i]=t[i]:Cg(t[i],e[i],{partial:!0})&&(r[i]=e[i]),r}),{})}const Pm=new Set(["value","selected","checked","contentEditable"]),Um=e=>null==e?e:e.key,Dm=(e,t)=>{t&&t!==e.key&&(e.key=t),!t&&e.key&&delete e.key},Fm=e=>{e.currentTarget.events[e.type](e)},Cm=(e,t,n,r,i)=>{"key"===t||("o"===t[0]&&"n"===t[1]?((e.events||(e.events={}))[t=t.slice(2)]=r)?n||e.addEventListener(t,Fm):e.removeEventListener(t,Fm):null==r?e.removeAttribute(t):!i&&"list"!==t&&"form"!==t&&t in e?e[t]=null==r?"":r:e.setAttribute(t,r))},Mm=(e,t)=>{if("string"==typeof e)return document.createTextNode(e);var n=e.props,r=(t=t||"svg"===e.type)?document.createElementNS("http://www.w3.org/2000/svg",e.type,{is:n.is}):document.createElement(e.type,{is:n.is});for(var i in n)Cm(r,i,null,n[i],t);return Dm(r,Um(e)),e.children.forEach((e=>r.appendChild(Mm(Vm(e),t)))),r},jm=(e,t,n,r,i)=>{if("string"==typeof r)null!=n&&n.nodeType===Node.TEXT_NODE?n.nodeValue!==r&&(t.nodeValue=r):(t=e.insertBefore(Mm(r,i),t),null!=n&&e.removeChild(n));else if(null==n||n.nodeName.toLowerCase()!==r.type)t=e.insertBefore(Mm(Vm(r),i),t),null!=n&&e.removeChild(n);else{var o=((e,t)=>{const n={};for(let r=0;r<e.attributes.length;r++){const{name:i,value:o}=e.attributes[r];n[i]=i in e&&"list"!==i&&!t?e[i]:""===o||o}return n})(n,i),s=r.props;for(var a in i=i||"svg"===r.type,{...o,...s})(Pm.has(a)?t[a]:o[a])!==s[a]&&Cm(t,a,o[a],s[a],i);Dm(t,r.key),qm(t,r.children,i)}return t},qm=(e,t,n,r=Array.from(e.childNodes))=>{for(var i,o,s,a,c=0,u=0,f=r.length-1,l=t.length-1;u<=l&&c<=f&&null!=(s=Um(r[c]))&&s===Um(t[u]);)jm(e,r[c],r[c++],t[u]=Vm(t[u++]),n);for(;u<=l&&c<=f&&null!=(s=Um(r[f]))&&s===Um(t[l]);)r[f]=jm(e,r[f],r[f--],t[l]=Vm(t[l--]),n);if(c>f){const i=r[c]||r[c-1]&&r[c-1].nextSibling||null;for(;u<=l;)e.insertBefore(Mm(t[u]=Vm(t[u++]),n),i)}else if(u>l)for(;c<=f;)e.removeChild(r[c++]);else{const d=new Map,h=new Set;for(let e=c;e<=f;e++)null!=(s=Um(r[e]))&&d.set(s,r[e]);for(;u<=l;)s=Um(o=r[c]),a=Um(t[u]=Vm(t[u])),h.has(s)||null!=a&&a===Um(r[c+1])?(null==s&&e.removeChild(o),c++):null==a?(null==s&&(jm(e,o,o,t[u],n),u++),c++):(s===a?(jm(e,o,o,t[u],n),h.add(a),c++):null!=(i=d.get(a))?(jm(e,e.insertBefore(i,o),i,t[u],n),h.add(a)):jm(e,o,null,t[u],n),u++);for(;c<=f;)null==Um(o=r[c++])&&e.removeChild(o);for(const[t,n]of d)h.has(t)||e.removeChild(n)}return e},Vm=e=>!0!==e&&!1!==e&&e?e:"",zm=(e,t,n)=>"function"==typeof e?e(t||{},n):((e,t,n,r)=>({type:e,props:t,children:n,key:r}))(e,t||{},Array.isArray(n)?n:null==n?[]:[n],null==t?void 0:t.key),Hm=(e,t,n)=>e=Array.isArray(t)?qm(e,t,e instanceof window.SVGElement,n):jm(e.parentNode,e,e,t),Gm=[],Km={},Wm={},Zm={},Ym=(e,t)=>!0;class Xm{constructor(e){var t,n,r;const i=null===(t=e.lines)||void 0===t?void 0:t.map((e=>"string"==typeof e?Km[e]:e)).filter(Boolean),o=null===(n=e.formats)||void 0===n?void 0:n.map((e=>"string"==typeof e?Wm[e]:e)).filter(Boolean),s=null===(r=e.embeds)||void 0===r?void 0:r.map((e=>"string"==typeof e?Zm[e]:e)).filter(Boolean);this.lines=new ty(i||Gm),this.formats=new ty(o||Gm),this.embeds=new ty(s||Gm)}}function Jm(e){return e.renderMultiple&&!e.shouldCombine&&(e.shouldCombine=Ym),Km[e.name]=e}function Qm(e){return Wm[e.name]=e}function ey(e){return Zm[e.name]=e}Xm.line=Jm,Xm.format=Qm,Xm.embed=ey;class ty{constructor(e){this.list=e,this.init()}get default(){return this.list[0]}init(){this.selector=this.list.map((e=>e.selector||"")).filter(Boolean).join(", "),this.types=this.list.reduce(((e,t)=>(e[t.name]=t,e)),{}),this.priorities=this.list.reduce(((e,t,n)=>(e[t.name]=n,e)),{})}add(e){this.list.push(e),this.init()}remove(e){const t="string"==typeof e?e:e.name;this.list=this.list.filter((e=>e.name!==t)),this.init()}get(e){return this.types[e]}priority(e){const t=this.priorities[e];return void 0!==t?t:-1}matches(e){if(!e)return!1;if(!e.nodeType)throw new Error("Cannot match against "+e);return e.nodeType===Node.ELEMENT_NODE?!!this.selector&&e.matches(this.selector):void 0}findByNode(e,t=!1){if(e.nodeType!==Node.ELEMENT_NODE)return;let n=this.list.length;for(;n--;){let t=this.list[n];if(e.matches(t.selector))return t}return t?this.default:void 0}findByAttributes(e,t=!1){const n=e&&Object.keys(e);let r;return n&&n.every((e=>!(r=this.get(e)))),r||(t?this.default:void 0)}}const ny=/;\s*$/,ry={name:"decoration",selector:"span.format.decoration",fromDom:!1,render:(e,t)=>ay(zm("span",{},t),e,["format","decoration"])},iy={name:"decoration",selector:".embed.decoration",fromDom:!1,noFill:!0,render:(e,t)=>{const n="embed decoration",{name:r,...i}=e.decoration;return i.class=i.class?n+" "+i.class:n,zm(r||"span",i,t)}};class oy extends Event{constructor(e,t){super(e,t),this.old=t.old,this.doc=t.doc,this.change=t.change,this.changedLines=t.changedLines}}class sy{constructor(e,t,n,r,i){this._name=e,this._doc=t,this.change=new Sm(t),this._decoration=n,this._apply=r,this._remove=i}hasDecorations(){return!!this._decoration&&this._decoration.ops.length>0||this.change.delta.ops.length>0}getDecoration(){return this._decoration?this._decoration.compose(this.change.delta):this.change.delta}apply(){return this._apply(this._name,this.change.delta)}remove(){return this._remove(this._name)}clear(e){return this.hasDecorations()?(e?this.change.setDelta(this.change.delta.compose(this.invert(e))):this.change.setDelta(this.invert()),this):this}clearLines(e){if(!e.length)return this;const t=this._doc,n=[t.getLineRange(e[0])[0],t.getLineRange(e[e.length-1])[1]],r=1===e.length||e.every(((n,r)=>!r||t.getLineRange(e[r-1])[1]===t.getLineRange(n)[0]));if(r)return this.clear(n);const i=this.invert(n),o=new pm;let s=0;return e.forEach((e=>{const[n,r]=t.getLineRange(e);o.retain(n-s).concat(i.slice(n,r)),s=r})),this.change.setDelta(this.change.delta.compose(o)),this}clearLine(e){const t=this._doc,n="number"==typeof e?t.getLineAt(e):"string"==typeof e?t.getLineBy(e):e;return this.clearLines([n])}invert(e){return this._decoration?cy(this._name,this._decoration,this._doc,e):new pm}decorateText(e,t={class:this._name}){return this.change.formatText(e,{decoration:{[this._name]:t}}),this}decorateLine(e,t={class:this._name}){return this.change.formatLine(e,{decoration:{[this._name]:t}},!0),this}insertDecoration(e,t={class:this._name}){if("string"==typeof t)throw new Error("You may only insert embed decorations");return this.change.insert(e,{decoration:t}),this}}function ay(e,t,n){if(!t||!t.decoration)return e;const r=new Set(n);let i="",o=e.props;Object.values(t.decoration).forEach((e=>{const{class:t,style:n,...s}=e;t&&r.add(t.trim()),n&&(i+=n.trim()),i&&!ny.test(i)&&(i+=";"),o={...s,...o}}));const s=Array.from(r).join(" ").trim();return s&&(o.class=o.class?o.class+" "+s:s),i&&(o.style=o.style?o.style+";"+i:i),e.props=o,e}function cy(e,t,n,r){let i=n.toDelta();return r&&(i=i.slice(r[0],r[1]),t=t.slice(r[0],r[1])),(t=t.invert(i)).ops.forEach((t=>{var n;null===(null===(n=t.attributes)||void 0===n?void 0:n.decoration)&&(t.attributes.decoration={[e]:null})})),r&&(t=(new pm).retain(r[0]).concat(t)),t}const uy=[],fy=zm("br",{}),ly=new WeakMap,dy=new WeakMap,hy=new WeakMap,py=new WeakMap,gy=new WeakMap;function my(e,t){var n,r;return null===(r=null===(n=gy.get(e))||void 0===n?void 0:n.get(t))||void 0===r?void 0:r[0]}function yy(e,t){var n,r;return null===(r=null===(n=gy.get(e))||void 0===n?void 0:n.get(t))||void 0===r?void 0:r[1]}function by(e){const{root:t,doc:n}=e,r=_y(e,n.lines),i=new WeakMap;for(let o=0;o<t.children.length;o++){const s=t.children[o];if(!s.key)continue;const a=r.byKey[s.key];if(a)if(Array.isArray(a)){i.set(s,[n.getLineRange(a[0])[0],n.getLineRange(a[a.length-1])[1]]);const t=s.querySelectorAll(e.typeset.lines.selector);for(let e=0;e<t.length;e++){const r=t[e],o=n.getLineBy(r.key);o&&i.set(r,n.getLineRange(o))}}else i.set(s,n.getLineRange(a))}const o=t.querySelectorAll(e.typeset.lines.selector);for(let e=0;e<o.length;e++){const t=o[e];if(i.has(t)||!t.key)continue;const r=n.getLineBy(t.key);i.set(t,n.getLineRange(r))}gy.set(t,i)}function wy(e,t){const{root:n}=e;e.dispatchEvent(new Event("rendering")),Hm(n,Ey(e,t)),by(e),e.dispatchEvent(new Event("render")),e.dispatchEvent(new Event("rendered"))}function vy(e,t,n){const{root:r}=e,i=_y(e,t.lines).combined,o=_y(e,n.lines).combined,[s,a]=function(e,t){const n=e.length,r=t.length,i=Math.min(n,r);let o=0,s=0,a=0,c=0;for(let n=0;n<i;n++)if(!Ty(e[n],t[n])){o=a=n;break}for(let o=0;o<i;o++)if(!Ty(e[n-o-1],t[r-o-1])){s=n-o,c=r-o;break}return[[o,s],[a,c]]}(i,o);Cg(s,a)||(s[0]=Math.max(0,s[0]-1),a[0]=Math.max(0,a[0]-1),s[1]=Math.min(i.length,s[1]+1),a[1]=Math.min(o.length,a[1]+1),r.childNodes.length!==i.length&&(s[1]+=r.childNodes.length-i.length));const c=Array.from(r.childNodes).slice(s[0],s[1]),u=o.slice(a[0],a[1]);if(!c.length&&!u.length)return wy(e,n);e.dispatchEvent(new Event("rendering")),Hm(r,xy(e,u),c),by(e),e.dispatchEvent(new Event("render")),e.dispatchEvent(new Event("rendered"))}function Ey(e,t,n){return xy(e,_y(e,t.lines).combined,n)}function xy(e,t,n){return t.map((t=>function(e,t,n){return Array.isArray(t)?function(e,t,n){const r=Sy(e,t[0]);if(!r.renderMultiple)throw new Error("No render method defined for line");const i=r.renderMultiple(t.map((t=>[t.attributes,Ay(e,t.content),t.id])),e,n);return i.key=t[0].id,i}(e,t,n):function(e,t,n){const r=Sy(e,t);if(!r.render)throw new Error("No render method defined for line");const i=r.render(t.attributes,Ay(e,t.content),e,n);return ay(i,t.attributes),i.key=t.id,i}(e,t,n)}(e,t,n))).filter(Boolean)}function _y(e,t){const n=py.get(t);if(n)return n;const r=[],i={};let o=[];t.forEach(((n,s)=>{const a=Sy(e,n);if(a.shouldCombine){o.push(n);const c=t[s+1];if(!c||Sy(e,c)!==a||!a.shouldCombine(n.attributes,c.attributes)){const e=hy.get(o[0]);e&&e.length===o.length&&o.every(((t,n)=>e[n]===t))?o=e:hy.set(o[0],o),r.push(o),i[o[0].id]=o,o=[]}}else a.render&&(r.push(n),i[n.id]=n)}));const s={combined:r,byKey:i};return py.set(t,s),s}function Ay(e,t,n){const{formats:r,embeds:i}=e.typeset;let o=[],s=!0;return t.ops.forEach(((t,a,c)=>{let u=[];if("string"==typeof t.insert){const e=c[a-1],n=c[a+1];let r=t.insert.replace(/  /g,"  ").replace(/  /g,"  ");e&&"object"!=typeof e.insert||(r=r.replace(/^ /," ")),n&&"object"!=typeof n.insert&&!function(e){return"string"==typeof e.insert&&" "===e.insert[0]}
/*!
     * escape-html
     * Copyright(c) 2012-2013 TJ Holowaychuk
     * Copyright(c) 2015 Andreas Lubbe
     * Copyright(c) 2015 Tiancheng "Timothy" Gu
     * MIT Licensed
     */(n)||(r=r.replace(/ $/," ")),s=!1,u.push(r)}else if(t.insert){const r=i.findByAttributes(t.insert);(null==r?void 0:r.render)&&(u.push(r.render(t.insert,uy,e,n)),"br"===r.name?s=!0:r.noFill||(s=!1))}t.attributes&&Object.keys(t.attributes).sort(((e,t)=>r.priority(t)-r.priority(e))).forEach((i=>{const o=r.get(i);if(null==o?void 0:o.render){const r=o.render(t.attributes,u,e,n);r&&(ly.set(r,o),u=[r])}})),o.push.apply(o,u)})),o=By(o),s&&o.push(fy),o}function Ty(e,t){return e===t||Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every(((e,n)=>e===t[n]))}function Sy(e,t){let n=dy.get(t.attributes);return n||(n=e.typeset.lines.findByAttributes(t.attributes,!0),dy.set(t.attributes,n)),n}function By(e){const t=[];if(e.forEach(((e,n)=>{const r=t.length-1,i=t[r];i&&"string"!=typeof i&&"string"!=typeof e&&ly.has(i)&&ly.get(i)===ly.get(e)&&Cg(i.props,e.props)?i.children=i.children.concat(e.children):i&&"string"==typeof i&&"string"==typeof e?t[r]+=e:(t.push(e),i&&"string"!=typeof i&&i.children&&(i.children=By(i.children)))})),t.length){const e=t[t.length-1];e&&"string"!=typeof e&&e.children&&(e.children=By(e.children))}return t}const Ny=/["'&<>]/;function Oy(e){var t,n=""+e,r=Ny.exec(n);if(!r)return n;var i="",o=0,s=0;for(o=r.index;o<n.length;o++){switch(n.charCodeAt(o)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}s!==o&&(i+=n.substring(s,o)),s=o+1,i+=t}return s!==o?i+n.substring(s,o):i}const Iy=NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT;function Ry(e,t){return(e.ownerDocument||document).createTreeWalker(e,Iy,{acceptNode(e){if(e.nodeType===Node.TEXT_NODE&&""===e.nodeValue)return NodeFilter.FILTER_REJECT;if(t){const n=t(e);return n?!0===n?NodeFilter.FILTER_ACCEPT:n:NodeFilter.FILTER_REJECT}return NodeFilter.FILTER_ACCEPT}})}const ky="address, article, aside, blockquote, editor, dd, div, dl, dt, fieldset, figcaption, figure, footer, form, h1, h2, h3, h4, h5, h6, header, hr, li, main, nav, noscript, ol, output, p, pre, section, table, tfoot, ul, video",Ly=/[\0-\x09\x0B\x1F\x7F-\x9F\xAD\u0600-\u0605\u061C\u06DD\u070F\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB\uE000-\uF8FF]/g,$y={STYLE:!0,SCRIPT:!0,LINK:!0,META:!0,TITLE:!0},Py={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},Uy=/[ \t\n\r]+/g,Dy=document.createElement("div"),Fy={};function Cy(e,t){return"BR"===t.nodeName&&function(e,t){const n=t.closest&&t.closest(e.typeset.lines.selector);if(!n)return!1;const r=Ry(n);r.currentNode=t;const i=r.nextNode();return!i||i instanceof HTMLElement&&i.matches(ky)}(e,t)}function My(e,t){return Hy(Ey(e,t,!0))}function jy(e,t,n){return new km(qy(e,t),n)}function qy(e,t,n){const r=zy(e,{root:(new window.DOMParser).parseFromString(t,"text/html").body,possiblePartial:null==n?void 0:n.possiblePartial,collapseWhitespace:null==n?void 0:n.collapseWhitespace});return Vy(r),r}function Vy(e){e.forEach((e=>{"string"==typeof e.insert&&(e.insert=e.insert.replace(Ly,""))}))}function zy(e,t=Fy){const{lines:n,embeds:r}=e.typeset,i=t.root||e.root,o=null==t.collapseWhitespace||t.collapseWhitespace;var s=Ry(i,(e=>!$y[e.nodeName]));const a=new pm;let c,u,f=!1,l=!1,d=!0;for(t.startNode?(s.currentNode=t.startNode,s.previousNode(),t.offset&&a.retain(t.offset,void 0)):s.currentNode=i;(u=s.nextNode())&&u!==t.endNode;)if(Cy(e,u))d=!1;else if("BR"===u.nodeName&&"Apple-interchange-newline"===u.className)a.insert("\n",!c||c.unknownLine?{}:c);else if(u.nodeType===Node.TEXT_NODE){let t=u.parentNode;if(null==u.nodeValue||""===u.nodeValue.replace(/\n+/g,""))continue;if(!u.nodeValue.replace(/\s+/g,"")&&(u.parentNode===i||u.previousSibling&&n.matches(u.previousSibling)||u.nextSibling&&n.matches(u.nextSibling)))continue;const r=u.nodeValue,s=(o?r.replace(Uy," "):r).replace(/\xA0/g," ");if(!s||" "===s&&t.classList.contains("EOP"))continue;const c=Gy(t,i,e);d=!1,a.insert(s,c)}else if(r.matches(u)){const t=r.findByNode(u);if(t){const n=Gy(u.parentNode,i,e);!1!==t.fromDom&&a.insert(t.fromDom?t.fromDom(u):{[t.name]:!0},n)}}else if(n.matches(u)||u.nodeType===Node.ELEMENT_NODE&&u.matches(ky)){if(l=!n.matches(u),l){let e=u.parentNode;for(;e&&!n.matches(e)&&e!==i;)e=e.parentNode;if(e&&e!==i)continue}const e=n.findByNode(u,!0);if(e===n.default&&(!u.parentNode||n.matches(u.parentNode)))continue;if(e.frozen)for(;s.lastChild(););f?c&&c.unknownLine&&d||(a.insert("\n",!c||c.unknownLine?{}:c),d=!0):f=!0,c=l?{unknownLine:l}:e&&e!==n.default?e.fromDom?e.fromDom(u):{[e.name]:!0}:{},t.includeIds&&u.key&&(c.id=u.key)}return l&&d||!f&&t.possiblePartial||a.insert("\n",!c||c.unknownLine?{}:c),a}function Hy(e){return e&&e.length?e.reduce(((e,t)=>e+("string"!=typeof t?function(e){if("string"==typeof e){Dy.textContent=e;const t=Dy.innerHTML;return Dy.textContent="",t}const t=Object.keys(e.props).reduce(((t,n)=>"key"===n||null==e.props[n]?t:`${t} ${Oy(n)}="${Oy(e.props[n])}"`),""),n=Hy(e.children),r=n||!Py[e.type]?`</${e.type}>`:"";return`<${e.type}${t}>${n}${r}`}(t):Oy(t).replace(/\xA0/g,"&nbsp;"))),""):""}function Gy(e,t,n){const{lines:r,formats:i}=n.typeset,o={};for(;e&&!r.matches(e)&&e!==t;){if(i.matches(e)){const t=i.findByNode(e);t&&!1!==t.fromDom&&(o[t.name]=!t.fromDom||t.fromDom(e))}else e.hasAttribute("style")&&i.list.forEach((t=>{t.styleSelector&&e.matches(t.styleSelector)&&(o[t.name]=!t.fromDom||t.fromDom(e))}));e=e.parentNode}return o}const Ky=[null,0];function Wy(e,t){const n=function(e,t){t[0]>t[1]&&(t=[t[1],t[0]]);const[n,r,i,o]=Xy(e,t),s=e.root.ownerDocument.createRange();return n&&i&&(s.setStart(n,r),s.setEnd(i,o)),s}(e,t);if((null==n?void 0:n.endContainer.nodeType)===Node.ELEMENT_NODE)try{n.setEnd(n.endContainer,n.endOffset+1)}catch(e){}return n}function Zy(e,t,n,r){var i;const{root:o}=e,{lines:s}=e.typeset;if(!o.contains(t))return-1;if(t.nodeType===Node.ELEMENT_NODE){if(t.childNodes.length===n){if(null!=yy(o,t))return yy(o,t)-1;t.childNodes.length&&(n=function(e,t){var n;const{lines:r,embeds:i}=e.typeset;if(i.matches(t)&&!Cy(e,t))return 1;if(t.nodeType===Node.TEXT_NODE)return Qy(r,t);const o=Ry(t);let s,a=r.findByNode(t)?1:0;for(;s=o.nextNode();)s.nodeType===Node.TEXT_NODE?a+=Qy(r,s):(null===(n=s.classList)||void 0===n?void 0:n.contains("decoration"))||(i.matches(s)&&!Cy(e,s)||r.matches(s))&&a++;return a}(e,t=t.childNodes[n-1]))}else t=t.childNodes[n],n=0;const a=my(o,t);if(null!=a)return(null===(i=s.findByNode(t))||void 0===i?void 0:i.frozen)?a+n:(null==r||r<a?a:a-1)+n}return Yy(e,t)+n}function Yy(e,t){var n;const{root:r}=e;if(!r.ownerDocument)return-1;const{lines:i,embeds:o}=e.typeset,s=Ry(r);let a;s.currentNode=t;let c,u=0;for(;(a=s.previousNode())&&a!==r;){if(null!=(c=my(r,a))){u+=c;break}a.nodeType===Node.TEXT_NODE?u+=Qy(i,a):(null===(n=a.classList)||void 0===n?void 0:n.contains("decoration"))||(o.matches(a)&&!Cy(e,a)||i.matches(a)&&e.doc.lines[0].id!==a.key)&&u++}return u}function Xy(e,t){if(null==t)return[null,0,null,0];{const n=t[0]<=t[1],r=n?1:-1,i=t[0]===t[1],[o,s,a]=Jy(e,t[0],n?0:1),[c,u]=i&&!a?[o,s]:a&&(i||t[1]-t[0]==r*e.doc.getLineAt(t[0]).length)?[o,s+(n?1:-1)]:Jy(e,t[1],n?1:0);return[o,s,c,u]}}function Jy(e,t,n){var r;const{root:i}=e;if(!i.ownerDocument)return Ky;const{lines:o,embeds:s}=e.typeset,a=Array.from(i.childNodes),c=function(e,t){const{root:n}=e;if(!n.ownerDocument)return;return Array.from(n.childNodes).find((e=>my(n,e)<=t&&yy(n,e)>t))}(e,t);if(!c)return Ky;if(o.findByNode(c,!0).frozen)return[c.parentNode,a.indexOf(c)+n,!0];const u=!(t-=my(i,c)),f=Ry(c);let l,d=!1;for(;l=f.nextNode();)if(l.nodeType===Node.TEXT_NODE){const e=Qy(o,l);if(t<=e)return[l,t];t-=e}else if(null===(r=l.classList)||void 0===r?void 0:r.contains("decoration"));else if(s.matches(l)&&!Cy(e,l)){const e=s.findByNode(l);if(!e||!1===e.fromDom)continue;if((t-=1)<=0){const e=Array.from(l.parentNode.childNodes);return[l.parentNode,e.indexOf(l)+1+t]}}else if(o.matches(l)&&(d?t-=1:d=!0,0===t)){const e=f.firstChild();if(e&&e.nodeType===Node.TEXT_NODE)return[e,0];if(e){return[l,Array.from(l.childNodes).indexOf(e)]}return[l,0]}return u?[c,0]:Ky}function Qy(e,t){const n=t.nodeValue||"";return n.trim()||!e.matches(t.previousSibling)&&!e.matches(t.nextSibling)?n.length:0}function eb(e){var t;const{root:n}=e,r=e.doc.selection;if(!n.ownerDocument)return null;const i=n.ownerDocument.getSelection(),{lines:o}=e.typeset;if(null!=i&&null!=i.anchorNode&&null!=i.focusNode&&n.contains(i.anchorNode)){const n=Zy(e,i.anchorNode,i.anchorOffset,r&&r[0]),s=i.anchorNode===i.focusNode&&i.anchorOffset===i.focusOffset,a=o.findByAttributes(null===(t=e.doc.getLineAt(n))||void 0===t?void 0:t.attributes,!0).frozen;return[n,s?n:Zy(e,i.focusNode,i.focusOffset,!a&&r?r[1]:null)]}return null}function tb(e,t){const{root:n}=e;if(!n.ownerDocument)return;const r=n.ownerDocument.getSelection();if(!r)return;const i=r.anchorNode&&n.contains(r.anchorNode)&&document.activeElement!==document.body;if(null==t)i&&(r.removeAllRanges(),n.classList.contains("focus")&&n.classList.remove("focus"));else{const[o,s,a,c]=Xy(e,t),u=t[0]===t[1]?"Caret":"Range";o&&a&&(r.anchorNode===o&&r.anchorOffset===s&&r.focusNode===a&&r.focusOffset===c&&r.type===u||r.setBaseAndExtent(o,s,a,c)),i||n.focus(),n.classList.contains("focus")||n.classList.add("focus")}n.dispatchEvent(new Event("select",{bubbles:!0}))}var nb;!function(e){e.api="api",e.user="user",e.history="history",e.input="input",e.paste="paste"}(nb||(nb={}));const rb=function(e={}){return function(t){let n=0,r="",i=!1,o={undo:[],redo:[]};const s={maxStack:500,delay:0,...e};function a(e){"historyUndo"===e.inputType?(e.preventDefault(),c()):"historyRedo"===e.inputType&&(e.preventDefault(),u())}function c(){p("undo","redo")}function u(){p("redo","undo")}function f(){return o.undo.length>0}function l(){return o.redo.length>0}function d(){n=0}function h(){o={undo:[],redo:[]}}function p(e,n){if(0===o[e].length)return;const r=o[e].pop();o[n].push(r),d(),i=!0,"function"==typeof r[e]?r[e]():t.update(r[e],nb.history),i=!1}function g({change:e,old:t,source:a}){return e?i?void 0:e.contentChanged?void(a!==nb.api?function(e,t){const i=Date.now(),a=function(e){var t;const{ops:n}=e.delta;let r=0,i=n.length-1;if(n[r].retain&&!n[r].attributes&&r++,1===n[i].retain&&(null===(t=n[i].attributes)||void 0===t?void 0:t.id)&&i--,r===i){const e=n[r];if(e.delete)return"delete";if("\n"===e.insert)return"newline";if("string"==typeof e.insert)return"insert"}return""}(e);o.redo.length=0;const c=new Sm(null,e.delta.invert(t.toDelta()),t.selection);if(a&&r===a||d(),r=a,n&&(!s.delay||n+s.delay>i)&&o.undo.length){const t=o.undo[o.undo.length-1];t.redo.delta=t.redo.delta.compose(e.delta),t.redo.selection=e.selection,t.undo.delta=c.delta.compose(t.undo.delta)}else{const t=new Sm(null,e.delta,e.selection);n=i,o.undo.push({redo:t,undo:c})}o.undo.length>s.maxStack&&o.undo.shift()}(e,t):function(e,t){const n=t instanceof pm?new Sm(null,t):t;e.undo.forEach((e=>{e.undo=n.transform(e.undo,!0),e.redo=n.transform(e.redo,!0)})),e.redo.forEach((e=>{e.undo=n.transform(e.undo,!0),e.redo=n.transform(e.redo,!0)}))}(o,e)):d():h()}return{options:s,hasUndo:f,hasRedo:l,undo:c,redo:u,cutoffHistory:d,clearHistory:h,setStack:function(e){o=e},getStack:function(){return o},getActive:()=>({undo:f(),redo:l()}),commands:{undo:c,redo:u},shortcuts:{"win:Ctrl+Z":"undo","mac:Cmd+Z":"undo","win:Ctrl+Y":"redo","mac:Cmd+Shift+Z":"redo"},init(){t.on("change",g),t.root.addEventListener("beforeinput",a)},destroy(){t.off("change",g),t.root.removeEventListener("beforeinput",a)}}}}();const ib=!(navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform)||/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream)&&/Mobi|Android/.test(navigator.userAgent)&&!window.MSStream,ob={characterData:!0,characterDataOldValue:!0,subtree:!0,childList:!0};function sb(e,t){for(;t&&t.parentNode!==e;)t=t.parentNode;return t}const ab={Control:!0,Meta:!0,Shift:!0,Alt:!0},cb=-1!==navigator.userAgent.indexOf("Macintosh"),ub=cb?/Cmd/:/Ctrl/;class fb extends KeyboardEvent{constructor(e,t){super(e,t),this.shortcut=(null==t?void 0:t.shortcut)||"",this.osShortcut=`${cb?"mac":"win"}:${this.shortcut}`,this.modShortcut=this.shortcut.replace(ub,"Mod")}static fromKeyboardEvent(e){return e.shortcut=lb(e),new fb("shortcut",e)}}function lb(e){const t=[];let n=e.key;return n?(" "===n&&(n="Space"),e.metaKey&&t.push("Cmd"),e.ctrlKey&&t.push("Ctrl"),e.altKey&&t.push("Alt"),e.shiftKey&&t.push("Shift"),ab[n]||(cb&&e.altKey&&e.code&&e.code.startsWith("Key")&&(n=e.code.replace("Key","")),1===n.length&&(n=n.toUpperCase()),t.push(n)),t.join("+")):""}const db={},hb=window.chrome&&"object"==typeof window.chrome;const pb={dontFixNewline:!0},gb={excludeProps:new Set(["id"])};class mb extends Event{constructor(e,t){super(e,t),this.delta=t.delta,this.html=t.html,this.text=t.text}}function yb(e){const{id:t,...n}=e.attributes;return n}const bb={copyPlainText:!0,copyHTML:!0};function wb(e,t){return n=>{function r({doc:r}){var i,o,s;const a=n.modules.decorations.getDecorator("placeholder"),c=("function"==typeof e?e():e)||"";let u;if(a.hasDecorations()){const e=a.getDecoration().ops;u=null===(o=null===(i=e[e.length-1].attributes)||void 0===i?void 0:i.decoration)||void 0===o?void 0:o.placeholder}const{lines:f}=n.typeset,l=f.findByAttributes(null===(s=r.lines[0])||void 0===s?void 0:s.attributes,!0),d=f.default===l&&1===r.length;if(d||(null==t?void 0:t.keepAttribute)){const e={"data-placeholder":c||""};d&&(e.class="placeholder"),Cg(e,u)||(a.remove(),a.decorateLine(0,e).apply())}else a.remove()}return n.addEventListener("decorate",r),{destroy(){n.removeEventListener("decorate",r)}}}}const vb={keyboard:function(e){function t(t){if(t.defaultPrevented)return;const{typeset:{lines:n},doc:r}=e;let{selection:o}=r;if(!o)return;t.preventDefault();const[s,a]=o,c=s===a,u=r.getLineAt(o[0]),[f,l]=r.getLineRange(o[0]);let d,{id:h,...p}=u.attributes;const g=n.findByAttributes(p,!0),m=a===f,y=a===l-1;!i(u)||g===n.default||g.contained||g.defaultFollows||g.frozen||!c?(s===f&&a===l&&g.frozen?(d={dontFixNewline:!0},o=0===s?[s,s]:[a,a],p=g.nextLineAttributes?g.nextLineAttributes(p):db):y&&(g.nextLineAttributes||g.defaultFollows||g.frozen)?p=g.nextLineAttributes?g.nextLineAttributes(p):db:m&&!y&&(g.defaultFollows&&(p=db),d={dontFixNewline:!0}),e.insert("\n",p,o,d),s===f&&a===l&&g.frozen&&e.select(0===s?0:a)):e.formatLine(db)}function n(t,n){if(t.defaultPrevented)return;const{typeset:{lines:r},doc:o}=e,{selection:s}=o;if(!s)return;const[a,c]=s,u=a===c,[f,l]=o.getLineRange(a);if(u&&(!hb||t.ctrlKey||t.altKey||t.metaKey)){if(-1===n&&a!==f)return;if(1===n&&a!==l-1)return}if(t.preventDefault(),-1===n&&s[0]+s[1]===0)d(o.getLineAt(a),!0);else{const t=gm(s),c=o.getLineAt(t[0]),h=r.findByAttributes(c.attributes,!0);if(u&&(-1===n&&a===f||1===n&&a===l-1)&&!h.contained){if(-1===n&&d(o.getLineAt(a)))return;const r=o.lines[o.lines.indexOf(c)+n],[s,u]=1===n?[c,r]:[r,c];if(s&&i(s)&&u&&!i(u))return e.update(e.change.delete([t[0]+n,t[0]],{dontFixNewline:!0}),nb.input)}e.delete(n,{dontFixNewline:h.frozen})}function d(t,n){if(!t)return;const i=r.findByAttributes(t.attributes,!0);return i?i.indentable&&t.attributes.indent?(e.outdent(),!0):n||i!==r.default&&!i.defaultFollows?(e.formatLine(db),!0):void 0:void 0}}function r(r){var i;if(r.isComposing)return;!function(e){e.shortcut=lb(e),e.osShortcut=`${cb?"mac":"win"}:${e.shortcut}`,e.modShortcut=e.shortcut.replace(ub,"Mod")}(r);const o=t=>{const n=e.shortcuts[t];if(n&&e.commands[n])return r.preventDefault(),!1!==e.commands[n]()};if(!e.root.dispatchEvent(fb.fromKeyboardEvent(r))||o(r.shortcut)||o(r.osShortcut)||o(r.modShortcut))r.preventDefault();else{switch(r.modShortcut){case"Enter":return t(r);case"Shift+Enter":return function(n){if(n.defaultPrevented)return;const{typeset:r,doc:i}=e;if(!r.embeds.get("br"))return t(n);i.selection&&(n.preventDefault(),e.insert({br:!0}))}(r);case"Tab":case"Shift+Tab":case"Mod+]":case"Mod+[":return function(t){if(t.defaultPrevented)return;t.preventDefault();const n=t.modShortcut;"Tab"===n||"Mod+]"===n?e.indent():e.outdent()}(r)}switch(null===(i=r.modShortcut)||void 0===i?void 0:i.split("+").pop()){case"Backspace":return function(e){n(e,-1)}(r);case"Delete":return function(e){n(e,1)}(r);default:return}}}function i(t){var n;return 1===t.length&&!(null===(n=e.typeset.lines.findByAttributes(t.attributes))||void 0===n?void 0:n.frozen)}return{init(){e.root.addEventListener("keydown",r)},destroy(){e.root.removeEventListener("keydown",r)}}},input:function(e){let t=!1;function n(){const e=i.takeRecords();e.length&&r(e)}function r(n){if(!e.enabled)return e.render();let r=function(t){const n=function(e){const t=new Set;if(e=e.filter((e=>"characterData"!==e.type||!t.has(e.target)&&(t.add(e.target),!0))),e.length>3)return null;const n=e.find((e=>"characterData"===e.type));if(!n)return null;const r=e.find((e=>1===e.addedNodes.length&&"#text"===e.addedNodes[0].nodeName)),i=e.find((e=>1===e.addedNodes.length&&"BR"===e.addedNodes[0].nodeName||1===e.removedNodes.length&&"BR"===e.removedNodes[0].nodeName));return 1+(r?1:0)+(i?1:0)<e.length||r&&r.addedNodes[0]!==n.target?null:n}(t);if(!n||null==n.oldValue||null==n.target.nodeValue)return null;const r=new pm,i=Yy(e,n.target);r.retain(i);let o;if(e.doc.selection){o=gm(e.doc.selection)[0]-i,o<0&&(o=0)}return tm(n.oldValue.replace(/\xA0/g," "),n.target.nodeValue.replace(/\xA0/g," "),o).forEach((([t,n])=>{t===tm.EQUAL?r.retain(n.length):t===tm.DELETE?r.delete(n.length):t===tm.INSERT&&r.insert(n,e.activeFormats)})),r.chop(),r}(n),i=eb(e);if(!r){const t=function(e,t){let n,r;for(let i=0;i<t.length;i++){const o=t[i];if(o.target===e)return;const s=sb(e,o.target);if(!s||!s.key)return;(!n||my(e,s)<my(e,n))&&(n=s),(!r||my(e,s)>my(e,r))&&(r=s)}if(n&&r)return[n,r]}(e.root,n);r=function(t){const{doc:n}=e;if(t){const[r,i]=t,o=my(e.root,r),s=yy(e.root,i),a=zy(e,{startNode:r,endNode:i.nextElementSibling||void 0,collapseWhitespace:!1});let c=n.toDelta().slice(o,s).diff(a);return c.ops.length&&o&&(c=(new pm).retain(o).concat(c)),c}{const t=zy(e,{collapseWhitespace:!1});return n.toDelta().diff(t)}}(t)}if(t&&(function(e){let t=!1;const n=e.ops[e.ops.length-1];n.insert&&n.insert.br&&(t=!0);return t}(r)&&(r.ops.pop(),r.insert("\n")),null!==i&&(i[0]++,i[1]++),t=!1),r&&r.ops.length){Vy(r);const t=e.doc;e.update(new Sm(e.doc,r,i,e.activeFormats),nb.input),e.doc.lines===t.lines&&e.render()}}const i=new window.MutationObserver(r);function o(){i.disconnect()}function s(){i.observe(e.root,ob)}function a(e){e.data&&e.data.includes("\n")&&(t=!0)}return{init(){e.root.addEventListener("input",n),e.on("rendering",o),e.on("render",s),ib&&e.root.addEventListener("beforeinput",a)},destroy(){i.disconnect(),e.root.removeEventListener("input",n),e.off("rendering",o),e.off("render",s),ib&&e.root.removeEventListener("beforeinput",a)}}},copy:function(e,t=bb){function n(n){if(!e.enabled||!e.doc.selection)return;n.preventDefault();const r=n.clipboardData,{doc:i}=e,{selection:o}=i;if(!i.selection)return;if(!r||!o)return;const s=gm(i.selection),a=i.slice(s[0],s[1]);if(!a.ops.length)return;const c=a.map((e=>"string"==typeof e.insert?e.insert:" ")).join("");if(t.copyHTML){let t;c.includes("\n")?(a.push({insert:"\n",attributes:i.getLineFormat(s[1])}),t=My(e,new km(a))):t=function(e,t){return Hy(Ay(e,t,!0))}(e,a),r.setData("text/html",t)}t.copyPlainText&&r.setData("text/plain",c)}function r(t){n(t),e.delete()}return{init(){e.root.addEventListener("copy",n),e.root.addEventListener("cut",r)},destroy(){e.root.removeEventListener("copy",n),e.root.removeEventListener("cut",r)}}},paste:function(e,t){function n(n){if(!e.enabled||!e.doc.selection)return;n.preventDefault();const r=n.clipboardData,{doc:i}=e,o=i.selection&&gm(i.selection);if(!r||!o)return;const[s,a]=o,c=r.getData("text/html"),u=r.getData("text/plain");let f;if(c)f=(null==t?void 0:t.htmlParser)?t.htmlParser(e,c):qy(e,c,{possiblePartial:!0});else{if(!u)return;f=(new pm).insert(u)}const l=f.filter((e=>"string"==typeof e.insert&&e.insert.includes("\n"))).length>0;let d=f.length();if(l){let e=Em.fromDelta(f,i.byId);f=Em.toDelta(e),d=f.length();const t=i.getLineAt(s),n=i.getLineAt(a),r=yb(t),o=t===n?r:yb(n);c||(e=e.map((e=>({...e,attributes:t.attributes}))),r!==o&&(e[e.length-1].attributes=n.attributes));const u=e[0],l=yb(u),h=e[e.length-1],p=u===h?l:yb(h);s===i.getLineRange(t)[0]||Cg(r,l,gb)||(f=(new pm).insert("\n",r).concat(f),d++);const g=f.ops[f.ops.length-1].insert,m="string"==typeof g&&g.endsWith("\n");m&&a!==i.getLineRange(n)[1]&&Cg(o,p,gb)?f=f.slice(0,--d):m&&a===i.getLineRange(n)[1]-1&&(f.delete(1),d--)}const h=new mb("paste",{delta:f,html:c,text:u,cancelable:!0});if(e.dispatchEvent(h),f=h.delta,!h.defaultPrevented)if(f&&f.ops.length){const t=e.change.delete(o,l?pb:void 0);t.insertContent(s,f).select(s+d),e.update(t,nb.paste)}else s!==a&&e.delete([s,a])}return{init(){e.root.addEventListener("paste",n)},destroy(){e.root.removeEventListener("paste",n)}}},history:rb,decorations:function(e){e.typeset.formats.add(ry),e.typeset.embeds.add(iy);const t=new Map;let n=e.doc,r=n,i=n,o=!1;function s(s){var a,c;if(!s)throw new TypeError("A decoration name is required");const u=t.get(s);if(!u)return!1;const f=cy(s,u,n);return t.delete(s),i=t.size?i.apply(f):n,o||(null===(a=e.modules.rendering)||void 0===a||a.render({old:r,doc:i}),null===(c=e.modules.selection)||void 0===c||c.renderSelection()),!0}function a(){t.size&&t.clear(),i=n}function c(s,a){var c,u;const f=t.get(s),l=f?f.compose(a,!0):a;Cg(l,f)||!f&&!l.ops.length||(l.ops.length?t.set(s,l):t.delete(s),i=t.size?i.apply(a,null):n,o||(null===(c=e.modules.rendering)||void 0===c||c.render({old:r,doc:i}),null===(u=e.modules.selection)||void 0===u||u.renderSelection()))}function u(e){const{change:r,changedLines:o}=e;if(n=e.doc,r){if(r.contentChanged){for(let[e,n]of t)n=r.delta.transform(n,!0),n.ops.length?t.set(e,n):t.delete(e);i=t.size?i.apply(r.delta,null):n,t.size&&i.lines.forEach(((e,t)=>{const r=n.lines[t];e!==r&&e.id!==r.id&&(e.id=r.id)}))}}else a();f(r,o)}function f(t,i){const s={old:r,doc:n,change:t,changedLines:i};o=!0,e.dispatchEvent(new oy("decorate",s)),o=!1}function l(){r=i}return e.on("change",u),e.on("render",l),{get old(){return r},get doc(){return i},getDecorator:function(n){if(!n)throw new TypeError("A decoration name is required");const r=t.get(n);return new sy(n,e.doc,r,c,s)},removeDecorations:s,clearDecorations:a,gatherDecorations:f,init(){f()},destroy(){e.off("change",u),e.off("render",l)}}},rendering:function(e){function t(t){const{doc:n,old:r}=e.modules.decorations||t;r.lines!==n.lines&&vy(e,r,n)}return e.on("change",t),{render:function(t){if(t){const{doc:n,old:r}=t;r&&n?vy(e,r,n):n&&wy(e,n)}else{const{doc:t}=e.modules.decorations||e;wy(e,t)}},destroy(){e.off("change",t)}}},selection:function(e){let t,n,r=!1;function i(){if(!e.enabled)return;const t=eb(e);if(!t&&r)return;if(r&&(r=!1),t&&t[0]===t[1]&&e.doc.selection&&e.doc.selection[0]===t[0]&&e.doc.selection[1]===t[0]+1){const n=e.doc.getLineAt(t[0]);e.typeset.lines.findByAttributes(n.attributes,!0).frozen&&(t[0]--,t[1]--)}const{doc:n}=e;if(!Cg(n.selection,t)){if(t&&t[0]===t[1]&&t[0]>=n.length)return;e.select(t)}}function o(){!r&&e.enabled&&tb(e,e.doc.selection)}function s(){const{doc:t,typeset:{lines:n}}=e,r=e.modules.decorations.getDecorator("selection");r.clear();const i=t.selection;i&&t.getLinesAt(i).forEach((e=>{if(n.findByAttributes(e.attributes,!0).frozen){const n=Cg(i,t.getLineRange(e));r.decorateLine(t.getLineRange(e)[0],{class:"selected"+(n?" focus":"")})}})),r.apply()}function a(t){let n=t.target;for(;n.parentNode&&n.parentNode!==e.root;)n=n.parentNode;const r=my(e.root,n),i=null!=r&&e.doc.getLineAt(r),o=i&&e.typeset.lines.findByAttributes(i.attributes);null!=r&&i&&o&&o.frozen&&(t.preventDefault(),e.select([r,r+i.length]))}function c(t){var n;const r=(null===(n=t.doc)||void 0===n?void 0:n.selection)||e.doc.selection;tb(e,r)}function u(){e.root.classList.toggle("window-inactive",!t.hasFocus())}return{pause:function(){r=!0;const{selection:t}=e.doc,{decorations:n}=e.modules;if(t&&t[0]!==t[1]&&n){n.getDecorator("pausedSelection").decorateText(t,{class:"selected"}).apply()}},resume:function(){r=!1;const{decorations:t}=e.modules;t&&t.removeDecorations("pausedSelection"),setTimeout(o)},renderSelection:o,init(){t=e.root.ownerDocument,n=t.defaultView,t.addEventListener("selectionchange",i),n.addEventListener("focus",u),n.addEventListener("blur",u),e.root.addEventListener("mousedown",a),e.on("change",c),e.on("decorate",s)},destroy(){t.removeEventListener("selectionchange",i),n.removeEventListener("focus",u),n.removeEventListener("blur",u),e.root.removeEventListener("mousedown",a),e.off("change",c),e.off("decorate",s),r=!1,t=null,n=null}}}},Eb=()=>{},xb=Ie({},Eb),_b=Ie(new km,Eb),Ab=Ie(null,Eb),Tb=Ie(void 0,Eb);function Sb(t){const n=Rb(Bb(t)),r=Rb(Nb(t)),i=Rb(Ob(t)),a=Rb(Ib(t)),u=function(t){return function(t,n,r){const i=!Array.isArray(t),a=i?[t]:t,u=n.length<2;return Ie(r,(t=>{let r=!1;const f=[];let l=0,d=e;const h=()=>{if(l)return;d();const r=n(i?f[0]:f,t);u?t(r):d=s(r)?r:e},p=a.map(((e,t)=>c(e,(e=>{f[t]=e,l&=~(1<<t),r&&h()}),(()=>{l|=1<<t}))));return r=!0,h(),function(){o(p),d(),r=!1}}))}(t,(e=>!!e))}(i);return{active:n,doc:r,selection:i,root:a,focus:u,updateEditor:function(e){e!==t&&(t=e,n.set(Bb(t)),r.set(Nb(t)),i.set(Ob(t)),a.set(Ib(t)))}}}function Bb(e){if(!e)return xb;let t=e.getActive();return Ie(t,(n=>{const r=()=>{const r=e.getActive();Cg(t,r)||n(t=r)};return e.on("changed",r),e.on("format",r),()=>{e.off("changed",r),e.off("format",r)}}))}function Nb(e){return e?Ie(e.doc,(t=>{const n=()=>t(e.doc);return n(),e.on("changed",n),()=>e.off("changed",n)})):_b}function Ob(e){return e?Ie(e.doc.selection,(t=>{const n=()=>t(e.doc.selection);return n(),e.on("changed",n),()=>e.off("changed",n)})):Ab}function Ib(e){return e?Ie(e._root,(t=>{const n=()=>t(e._root);return n(),e.on("root",n),()=>e.off("root",n)})):Tb}function Rb(e){const t="subscribe"in e?u(e):e,{set:n,subscribe:r}=Re(t);let i;function o(e){i&&i(),e&&(i=e.subscribe((e=>n(e))))}return"subscribe"in e&&o(e),{set:o,subscribe:r}}Jm({name:"paragraph",selector:"p",commands:e=>()=>e.formatLine({}),shortcuts:"Mod+0",render:(e,t)=>zm("p",null,t)}),Jm({name:"header",selector:"h1, h2, h3, h4, h5, h6",defaultFollows:!0,commands:e=>({header:t=>e.toggleLineFormat({header:t}),header1:()=>e.toggleLineFormat({header:1}),header2:()=>e.toggleLineFormat({header:2}),header3:()=>e.toggleLineFormat({header:3}),header4:()=>e.toggleLineFormat({header:4}),header5:()=>e.toggleLineFormat({header:5}),header6:()=>e.toggleLineFormat({header:6})}),shortcuts:{"Mod+1":"header1","Mod+2":"header2","Mod+3":"header3","Mod+4":"header4","Mod+5":"header5","Mod+6":"header6"},fromDom:e=>({header:parseInt(e.nodeName.replace("H",""))}),render:(e,t)=>zm(`h${e.header}`,null,t)}),Jm({name:"list",selector:"ul > li, ol > li",indentable:!0,commands:e=>({bulletList:()=>e.toggleLineFormat({list:"bullet"}),orderedList:()=>e.toggleLineFormat({list:"ordered"}),checkList:()=>e.toggleLineFormat({list:"check"}),indent:()=>e.indent(),outdent:()=>e.outdent(),toggleCheck:t=>{const n="string"==typeof t?e.doc.getLineBy(t):e.doc.selection?e.doc.getLineAt(e.doc.selection[0]):null;if(!n)return!1;const[r]=e.doc.getLineRange(n),i={list:"check"};n.attributes.checked||(i.checked=!0),e.formatLine(i,r)}}),shortcuts:{"Mod+Space":"toggleCheck"},fromDom(e){let t=-1,n=e.parentNode;const r=e.hasAttribute("data-checked")?"check":n&&"OL"===n.nodeName?"ordered":"bullet";for(;n;){if(/^UL|OL$/.test(n.nodeName))t++;else if("LI"!==n.nodeName)break;n=n.parentNode}!t&&e.className.startsWith("ql-indent-")&&(t=parseInt(e.className.replace("ql-indent-","")));const i={list:r};return t&&(i.indent=t),"true"===e.getAttribute("data-checked")&&(i.checked=!0),i},nextLineAttributes(e){const{start:t,...n}=e;return n},shouldCombine:(e,t)=>e.list===t.list||t.indent,renderMultiple:(e,t,n)=>{const r=[],i=[];return e.forEach((([e,o,s])=>{const a="ordered"===e.list?"ol":"ul",c=e.indent||0;let u={key:s};if("check"===e.list){function l(e){t.enabled&&(e.preventDefault(),t.commands.toggleCheck(s))}const d=zm("button",{class:"check-list-check",onmousedown:l,ontouchstart:l});1===o.length&&"br"===o[0].type?o.push(d):o.unshift(d),u={...u,class:"check-list-item","data-checked":""+(e.checked||!1)}}const f=ay(zm("li",u,o),e);for(;c>=i.length;){const h=zm(a,{start:e.start,type:e.type,key:`${s}-outer`}),p=i.length?i[i.length-1].children:r,g=p[p.length-1];"object"==typeof g&&"li"===g.type&&n?g.children.push(h):p.push(h),i.push(h)}if(!function(e,t,n){return e.type===t&&(e.props.start===n.start||e.props.start&&!n.start)&&e.props.type===n.type}(i[c],a,e)){const m=zm(a,{start:e.start,type:e.type});(c?i[c-1].children:r).push(m),i[c]=m}i[c].children.push(f),i.length=c+1})),r[0]}}),Jm({name:"blockquote",selector:"blockquote p",commands:e=>(t=!0)=>{"string"!=typeof t&&(t=!0),e.toggleLineFormat({blockquote:t})},fromDom(e){const{className:t}=e.parentNode,n=t.match(/quote-(\S+)/);return{blockquote:n&&"true"!==n[1]&&n[1]||!0}},shouldCombine:(e,t)=>e.blockquote===t.blockquote,renderMultiple:e=>{const t=e[0][0].blockquote,n="string"==typeof t?{className:`quote-${t}`}:null,r=e.map((([e,t,n])=>zm("p",{key:n},t)));return zm("blockquote",n,r)}}),Jm({name:"code-block",selector:"pre code",contained:!0,commands:e=>()=>e.toggleLineFormat({"code-block":!0}),renderMultiple:e=>{const t=[];return e.forEach((([e,n,r])=>{n.length&&"br"===n[n.length-1].type&&n.pop(),t.push(zm("code",{key:r},n)),t.push("\n")})),zm("pre",{spellcheck:!1},t)}}),Jm({name:"hr",selector:"hr",frozen:!0,commands:e=>()=>{const{doc:t}=e,{selection:n}=t;if(!n)return;const r=gm(n),i=e.change.delete(r);if(r[0]===r[1]&&1===t.getLineAt(r[0]).length)i.insert(r[0],"\n",{...t.getLineFormat(r[0])}).formatLine(r[0],{hr:!0});else{const e=(new pm).insert("\n",t.getLineAt(r[0]).attributes).insert("\n",{hr:!0});i.insertContent(r[0],e),i.select(r[0]+2)}e.update(i)},render:()=>zm("hr")}),Qm({name:"bold",selector:"strong, b",styleSelector:'[style*="font-weight:bold"], [style*="font-weight: bold"]',commands:e=>()=>e.toggleTextFormat({bold:!0}),shortcuts:"Mod+B",render:(e,t)=>zm("strong",null,t)}),Qm({name:"italic",selector:"em, i",styleSelector:'[style*="font-style:italic"], [style*="font-style: italic"]',commands:e=>()=>e.toggleTextFormat({italic:!0}),shortcuts:"Mod+I",render:(e,t)=>zm("em",null,t)}),Qm({name:"code",selector:"code",commands:e=>()=>e.toggleTextFormat({code:!0}),render:(e,t)=>zm("code",null,t)}),Qm({name:"link",selector:"a[href]",greedy:!1,commands:e=>t=>e.toggleTextFormat({link:t}),fromDom:e=>e.href,render:(e,t)=>zm("a",{href:e.link,target:"_blank"},t)}),ey({name:"image",selector:"img",commands:e=>(t,n)=>e.insert({image:t,...n}),fromDom:e=>{const t={};return["src","alt","width","height"].forEach((n=>{if(!e.hasAttribute(n))return;const r=e.getAttribute(n);"src"===n&&(n="image"),t[n]=r})),t},render:e=>{const{image:t,...n}=e;return n.src=t,zm("img",n)}}),ey({name:"br",selector:"br",commands:e=>()=>e.insert({br:!0}),render:()=>zm("br")});const kb={lines:["paragraph","header","list","blockquote","code-block","hr"],formats:["link","bold","italic","code"],embeds:["image","br"]},Lb={},$b=[],Pb=["focus","blur","keydown","mousedown","mouseup","click"],Ub=new WeakMap;class Db extends Event{constructor(e,t){super(e,t),this.old=t.old,this.doc=t.doc,this.change=t.change,this.changedLines=t.changedLines,this.source=t.source,Object.setPrototypeOf(this,Db.prototype)}modify(e){if(!this.cancelable)throw new Error('Cannot modify an applied change, listen to the "changing" event');this.doc=this.doc.apply(e),this.change&&(this.change.delta=this.change.delta.compose(e)),this.changedLines&&(this.changedLines=this.old.lines===this.doc.lines?$b:qb(this.old,this.doc))}}class Fb extends Event{constructor(e,t){super(e,t),this.formats=t.formats}}class Cb extends im{constructor(e={}){super(),this.activeFormats=Lb,this.commands={},this.shortcuts={},this.modules={},this.catchErrors=!e.dev,this.identifier=e.identifier,this.typeset=new Xm(e.types||kb),e.doc?this.doc=e.doc:e.html?this.doc=jy(this,e.html):e.text?this.doc=new km((new pm).insert(e.text)):this.doc=new km,this.throwOnError=e.throwOnError||!1,this._enabled=void 0===e.enabled||e.enabled,this._modules={...vb,...e.modules},e.root&&this.setRoot(e.root)}get root(){return this._root||this.setRoot(document.createElement("div")),this._root}get enabled(){return this._enabled}set enabled(e){e=!!e;const t=this._enabled!==e;!e&&this.doc.selection&&this.select(null,nb.api),this._enabled=e,this._root&&(this._root.contentEditable=e?"true":"inherit"),t&&this.dispatchEvent(new Event("enabledchange"))}get change(){const e=new Sm(this.doc);return e.apply=(t=nb.user)=>this.update(e,t),e}setRoot(e){if(!e)throw new TypeError("Root must be set, cannot be "+e);return this.destroy(),this._root=e,this.init(),this.dispatchEvent(new Event("root")),this}update(e,t=nb.user){if(!this.enabled&&t!==nb.api)return this;e instanceof pm&&(e=new Sm(this.doc,e));const n=this.doc,r=n.apply(e,void 0,this.throwOnError),i=n.lines===r.lines?$b:qb(n,r);return this.set(r,t,e,i),this}set(e,t=nb.user,n,r){const i=this.doc;if(e instanceof pm&&(e=new km(e)),!this.enabled&&t!==nb.api||!e||i.equals(e))return this;const o=new Db("changing",{cancelable:!0,old:i,doc:e,change:n,changedLines:r,source:t});return this.dispatchEvent(o,this.catchErrors),o.defaultPrevented||i.equals(o.doc)||(this.activeFormats=(null==n?void 0:n.activeFormats)?n.activeFormats:jb(this,o.doc),this.doc=o.doc,this.dispatchEvent(new Db("change",{...o,cancelable:!1}),this.catchErrors),this.dispatchEvent(new Db("changed",{...o,cancelable:!1}),this.catchErrors)),this}getHTML(){return My(this,this.doc)}setHTML(e,t=this.doc.selection,n){return this.set(jy(this,e,t))}getDelta(){return this.doc.toDelta()}setDelta(e,t=this.doc.selection,n){return this.set(new km(e,t),n)}getText(e){return this.doc.getText(e)}setText(e,t=this.doc.selection,n){return this.set(new km((new pm).insert(e),t),n)}getActive(){const{selection:e}=this.doc;let t=e?e[0]===e[1]?{...this.activeFormats,...this.doc.getLineFormat(e)}:{...this.doc.getFormats(e)}:{};return Object.values(this.modules).forEach((e=>{e.getActive&&(t={...t,...e.getActive()})})),t}select(e,t){return this.update(this.change.select(e),t)}insert(e,t,n=this.doc.selection,r){if(!n)return this;const i=Cg(n,this.doc.selection);null==t&&"string"==typeof e&&"\n"!==e&&(t=i?this.activeFormats:jb(this,this.doc,n));const o=this.typeset.lines.findByAttributes(t,!0),s=this.change.delete(n),a=gm(n)[0];if(i&&s.setActiveFormats("\n"!==e&&t||jb(this,this.doc,n)),"\n"===e&&o.frozen){const e={...this.doc.getLineFormat(a)},n={...t};let r={...e};const i=(new pm).insert("\n",e);this.doc.getLineRange(a)[1]-1!==a?i.insert("\n",n):r=n,s.insertContent(a,i).formatLine(a,r).select(a+2)}else s.insert(a,e,t,r);return this.update(s)}insertContent(e,t=this.doc.selection){if(!t)return this;const n=this.change.delete(t).insertContent(t[0],e);return this.update(n)}delete(e,t){let n;if(Array.isArray(e))n=gm(e);else{if(!this.doc.selection)return this;n=gm(this.doc.selection),e&&n[0]===n[1]&&(n=e<0?[n[0]+e,n[1]]:[n[0],n[1]+e])}const r=jb(this,this.doc,n),i=this.change.delete(n,t).select(n[0]).setActiveFormats(r);return this.update(i)}formatText(e,t=this.doc.selection){return t?("string"==typeof e&&(e={[e]:!0}),t[0]===t[1]?(this.activeFormats=fm.compose(this.activeFormats,e)||Lb,this.dispatchEvent(new Fb("format",{formats:this.activeFormats})),this):(Mb(this,"formatText",e,t),this)):this}toggleTextFormat(e,t=this.doc.selection){return t?("string"==typeof e&&(e={[e]:!0}),t[0]===t[1]?(Bm(e,this.activeFormats)&&(e=fm.invert(e)),this.activeFormats=fm.compose(this.activeFormats,e)||Lb,this.dispatchEvent(new Fb("format",{formats:this.activeFormats})),this):(Mb(this,"toggleTextFormat",e,t),this)):this}formatLine(e,t=this.doc.selection){return"string"==typeof e&&(e={[e]:!0}),Mb(this,"formatLine",e,t),this}toggleLineFormat(e,t=this.doc.selection){return"string"==typeof e&&(e={[e]:!0}),Mb(this,"toggleLineFormat",e,t),this}indent(){return Hb(this,1),this}outdent(){return Hb(this,-1),this}removeFormat(e=this.doc.selection){return Mb(this,"removeFormat",null,e),this}getBounds(e,t,n){var r;if("number"==typeof e&&(e=[e,e]),!e)return;let i=null===(r=Wy(this,e))||void 0===r?void 0:r.getBoundingClientRect();if(i&&t){const e=t.getBoundingClientRect(),r=(n?t.scrollLeft:0)-e.x,o=(n?t.scrollTop:0)-e.y;i=new DOMRect(i.x+r,i.y+o,i.width,i.height)}return i}getAllBounds(e,t,n){var r;"number"==typeof e&&(e=[e,e]);const i=null===(r=Wy(this,e))||void 0===r?void 0:r.getClientRects();let o=i&&Array.from(i);if(o&&t){const e=t.getBoundingClientRect(),r=(n?t.scrollLeft:0)-e.x,i=(n?t.scrollTop:0)-e.y;o=o.map((e=>new DOMRect(e.x+r,e.y+i,e.width,e.height)))}return o}getIndexFromPoint(e,t){return function(e,t,n){const r=e.root.ownerDocument;if("caretPositionFromPoint"in r)try{const i=r.caretPositionFromPoint(t,n);if(i)return Zy(e,i.offsetNode,i.offset)}catch(e){}if(r.caretRangeFromPoint){const i=r.caretRangeFromPoint(t,n);if(i)return Zy(e,i.startContainer,i.startOffset)}return null}(this,e,t)}render(){var e,t,n;return null===(e=this.modules.decorations)||void 0===e||e.gatherDecorations(),null===(t=this.modules.rendering)||void 0===t||t.render(),null===(n=this.modules.selection)||void 0===n||n.renderSelection(),this}init(){const e=this._root;e.editor&&e.editor.destroy(),e.editor=this,this.enabled=this._enabled,this.commands={},Pb.forEach((e=>this._root.addEventListener(e,Gb(this)))),this.typeset.lines.list.forEach((e=>e.commands&&Vb(this,e.name,e.commands(this)))),this.typeset.formats.list.forEach((e=>e.commands&&Vb(this,e.name,e.commands(this)))),this.typeset.embeds.list.forEach((e=>e.commands&&Vb(this,e.name,e.commands(this)))),Object.keys(this._modules).forEach((e=>{if(!this._modules[e])return;const t=this.modules[e]=this._modules[e](this);t.commands&&Vb(this,e,t.commands)})),this.shortcuts=function(e){const t={},{typeset:{lines:n,formats:r,embeds:i},modules:o}=e;return Wb(n,t),Wb(r,t),Wb(i,t),function(e,t){Object.keys(e).forEach((n=>{var r;const i=null===(r=e[n])||void 0===r?void 0:r.shortcuts;i&&Zb(i,t)}))}(o,t),t}(this),Object.keys(this.modules).forEach((e=>{var t,n;return null===(n=(t=this.modules[e]).init)||void 0===n?void 0:n.call(t)})),this.render()}destroy(){const e=this._root;e&&(Pb.forEach((t=>e.removeEventListener(t,Gb(this)))),Object.values(this.modules).forEach((e=>e.destroy&&e.destroy())),this._root=void 0,delete e.editor)}}function Mb(e,t,n,r){if(!r)return;const i=e.change[t](r,n);e.update(i)}function jb(e,t,n=t.selection){const{formats:r}=e.typeset;if(!n||0===n[0])return Lb;const i=gm(n)[0];let o=i;const s=t.getTextFormat(o),a={};return Object.keys(s).forEach((e=>{const n=r.get(e);n&&(!1!==n.greedy||t.getTextFormat(i)[e])&&(a[e]=s[e])})),a}function qb(e,t){const n=new Set(e.lines);return t.lines.filter((e=>!n.has(e)))}function Vb(e,t,n){n&&("function"==typeof n?e.commands[t]=zb(e,n):Object.keys(n).forEach((t=>e.commands[t]=zb(e,n[t]))))}function zb(e,t){return(...n)=>{t(...n),e.doc.selection&&e.root.focus()}}function Hb(e,t=1){const{typeset:{lines:n},doc:r}=e,{selection:i}=r;if(!i)return r;const o=e.change;r.getLinesAt(i).forEach((e=>{if(!n.findByAttributes(e.attributes,!0).indentable)return;const i=r.getLineRange(e);let s=(e.attributes.indent||0)+t;s<=0&&(s=null),o.formatLine(i[0],s<0?Lb:{...e.attributes,indent:s})})),e.update(o)}function Gb(e){let t=Ub.get(e);return t||(t=Kb.bind(e),Ub.set(e,t)),t}function Kb(e){this.dispatchEvent(e)}function Wb(e,t){e.list.forEach((e=>{const n=e.shortcuts;n&&("string"==typeof n?t[n]=e.name:Zb(n,t))}))}function Zb(e,t){Object.keys(e).forEach((n=>t[n]=e[n]))}const Yb=e=>({}),Xb=e=>({}),Jb=e=>({}),Qb=e=>({});function ew(e){let t,n,r,i,o,s,a;const c=e[1].title,u=l(c,e,e[0],Qb),f=e[1].actions,d=l(f,e,e[0],Xb);return{c(){t=R("div"),n=R("div"),n.innerHTML='<label for="my-drawer-3" class="btn btn-square btn-ghost"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-6 h-6 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></label>',r=$(),i=R("div"),u&&u.c(),o=$(),s=R("div"),d&&d.c(),D(n,"class","flex-none lg:hidden"),D(i,"class","flex-1 px-2 mx-2 font-bold text-lg"),D(t,"class","w-full navbar bg-base-100 border-b border-base-300")},m(e,c){N(e,t,c),T(t,n),T(t,r),T(t,i),u&&u.m(i,null),T(t,o),T(t,s),d&&d.m(s,null),a=!0},p(e,[t]){u&&u.p&&(!a||1&t)&&p(u,c,e,e[0],a?h(c,e[0],t,Jb):g(e[0]),Qb),d&&d.p&&(!a||1&t)&&p(d,f,e,e[0],a?h(f,e[0],t,Yb):g(e[0]),Xb)},i(e){a||(ge(u,e),ge(d,e),a=!0)},o(e){me(u,e),me(d,e),a=!1},d(e){e&&O(t),u&&u.d(e),d&&d.d(e)}}}function tw(e,t,n){let{$$slots:r={},$$scope:i}=t;return e.$$set=e=>{"$$scope"in e&&n(0,i=e.$$scope)},[i,r]}class nw extends Ne{constructor(e){super(),Be(this,e,tw,ew,a,{})}}function rw(e,t){function n(){t&&t.destroy()}return e.children.length&&t.set(function(e,t){return new km(zy(e,{root:t}))}(t,e)),t&&t.setRoot(e),{update:function(r){t!==r&&(n(),r&&r.setRoot(e),t=r)},destroy:n}}var iw="top",ow="bottom",sw="right",aw="left",cw="auto",uw=[iw,ow,sw,aw],fw="start",lw="end",dw="clippingParents",hw="viewport",pw="popper",gw="reference",mw=uw.reduce((function(e,t){return e.concat([t+"-"+fw,t+"-"+lw])}),[]),yw=[].concat(uw,[cw]).reduce((function(e,t){return e.concat([t,t+"-"+fw,t+"-"+lw])}),[]),bw=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function ww(e){return e?(e.nodeName||"").toLowerCase():null}function vw(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Ew(e){return e instanceof vw(e).Element||e instanceof Element}function xw(e){return e instanceof vw(e).HTMLElement||e instanceof HTMLElement}function _w(e){return"undefined"!=typeof ShadowRoot&&(e instanceof vw(e).ShadowRoot||e instanceof ShadowRoot)}var Aw={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},i=t.elements[e];xw(i)&&ww(i)&&(Object.assign(i.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],i=t.attributes[e]||{},o=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});xw(r)&&ww(r)&&(Object.assign(r.style,o),Object.keys(i).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]};function Tw(e){return e.split("-")[0]}var Sw=Math.max,Bw=Math.min,Nw=Math.round;function Ow(e,t){void 0===t&&(t=!1);var n=e.getBoundingClientRect(),r=1,i=1;if(xw(e)&&t){var o=e.offsetHeight,s=e.offsetWidth;s>0&&(r=Nw(n.width)/s||1),o>0&&(i=Nw(n.height)/o||1)}return{width:n.width/r,height:n.height/i,top:n.top/i,right:n.right/r,bottom:n.bottom/i,left:n.left/r,x:n.left/r,y:n.top/i}}function Iw(e){var t=Ow(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function Rw(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&_w(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function kw(e){return vw(e).getComputedStyle(e)}function Lw(e){return["table","td","th"].indexOf(ww(e))>=0}function $w(e){return((Ew(e)?e.ownerDocument:e.document)||window.document).documentElement}function Pw(e){return"html"===ww(e)?e:e.assignedSlot||e.parentNode||(_w(e)?e.host:null)||$w(e)}function Uw(e){return xw(e)&&"fixed"!==kw(e).position?e.offsetParent:null}function Dw(e){for(var t=vw(e),n=Uw(e);n&&Lw(n)&&"static"===kw(n).position;)n=Uw(n);return n&&("html"===ww(n)||"body"===ww(n)&&"static"===kw(n).position)?t:n||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&xw(e)&&"fixed"===kw(e).position)return null;for(var n=Pw(e);xw(n)&&["html","body"].indexOf(ww(n))<0;){var r=kw(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}function Fw(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Cw(e,t,n){return Sw(e,Bw(t,n))}function Mw(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function jw(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}var qw={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,i=e.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,a=Tw(n.placement),c=Fw(a),u=[aw,sw].indexOf(a)>=0?"height":"width";if(o&&s){var f=function(e,t){return Mw("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:jw(e,uw))}(i.padding,n),l=Iw(o),d="y"===c?iw:aw,h="y"===c?ow:sw,p=n.rects.reference[u]+n.rects.reference[c]-s[c]-n.rects.popper[u],g=s[c]-n.rects.reference[c],m=Dw(o),y=m?"y"===c?m.clientHeight||0:m.clientWidth||0:0,b=p/2-g/2,w=f[d],v=y-l[u]-f[h],E=y/2-l[u]/2+b,x=Cw(w,E,v),_=c;n.modifiersData[r]=((t={})[_]=x,t.centerOffset=x-E,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=t.elements.popper.querySelector(r)))&&("production"!==process.env.NODE_ENV&&(xw(r)||console.error(['Popper: "arrow" element must be an HTMLElement (not an SVGElement).',"To use an SVG arrow, wrap it in an HTMLElement that will be used as","the arrow."].join(" "))),Rw(t.elements.popper,r)?t.elements.arrow=r:"production"!==process.env.NODE_ENV&&console.error(['Popper: "arrow" modifier\'s `element` must be a child of the popper',"element."].join(" ")))},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Vw(e){return e.split("-")[1]}var zw={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Hw(e){var t,n=e.popper,r=e.popperRect,i=e.placement,o=e.variation,s=e.offsets,a=e.position,c=e.gpuAcceleration,u=e.adaptive,f=e.roundOffsets,l=e.isFixed,d=s.x,h=void 0===d?0:d,p=s.y,g=void 0===p?0:p,m="function"==typeof f?f({x:h,y:g}):{x:h,y:g};h=m.x,g=m.y;var y=s.hasOwnProperty("x"),b=s.hasOwnProperty("y"),w=aw,v=iw,E=window;if(u){var x=Dw(n),_="clientHeight",A="clientWidth";if(x===vw(n)&&"static"!==kw(x=$w(n)).position&&"absolute"===a&&(_="scrollHeight",A="scrollWidth"),i===iw||(i===aw||i===sw)&&o===lw)v=ow,g-=(l&&E.visualViewport?E.visualViewport.height:x[_])-r.height,g*=c?1:-1;if(i===aw||(i===iw||i===ow)&&o===lw)w=sw,h-=(l&&E.visualViewport?E.visualViewport.width:x[A])-r.width,h*=c?1:-1}var T,S=Object.assign({position:a},u&&zw),B=!0===f?function(e){var t=e.x,n=e.y,r=window.devicePixelRatio||1;return{x:Nw(t*r)/r||0,y:Nw(n*r)/r||0}}({x:h,y:g}):{x:h,y:g};return h=B.x,g=B.y,c?Object.assign({},S,((T={})[v]=b?"0":"",T[w]=y?"0":"",T.transform=(E.devicePixelRatio||1)<=1?"translate("+h+"px, "+g+"px)":"translate3d("+h+"px, "+g+"px, 0)",T)):Object.assign({},S,((t={})[v]=b?g+"px":"",t[w]=y?h+"px":"",t.transform="",t))}var Gw={passive:!0};var Kw={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,o=void 0===i||i,s=r.resize,a=void 0===s||s,c=vw(t.elements.popper),u=[].concat(t.scrollParents.reference,t.scrollParents.popper);return o&&u.forEach((function(e){e.addEventListener("scroll",n.update,Gw)})),a&&c.addEventListener("resize",n.update,Gw),function(){o&&u.forEach((function(e){e.removeEventListener("scroll",n.update,Gw)})),a&&c.removeEventListener("resize",n.update,Gw)}},data:{}},Ww={left:"right",right:"left",bottom:"top",top:"bottom"};function Zw(e){return e.replace(/left|right|bottom|top/g,(function(e){return Ww[e]}))}var Yw={start:"end",end:"start"};function Xw(e){return e.replace(/start|end/g,(function(e){return Yw[e]}))}function Jw(e){var t=vw(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Qw(e){return Ow($w(e)).left+Jw(e).scrollLeft}function ev(e){var t=kw(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function tv(e){return["html","body","#document"].indexOf(ww(e))>=0?e.ownerDocument.body:xw(e)&&ev(e)?e:tv(Pw(e))}function nv(e,t){var n;void 0===t&&(t=[]);var r=tv(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),o=vw(r),s=i?[o].concat(o.visualViewport||[],ev(r)?r:[]):r,a=t.concat(s);return i?a:a.concat(nv(Pw(s)))}function rv(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function iv(e,t){return t===hw?rv(function(e){var t=vw(e),n=$w(e),r=t.visualViewport,i=n.clientWidth,o=n.clientHeight,s=0,a=0;return r&&(i=r.width,o=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(s=r.offsetLeft,a=r.offsetTop)),{width:i,height:o,x:s+Qw(e),y:a}}(e)):Ew(t)?function(e){var t=Ow(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):rv(function(e){var t,n=$w(e),r=Jw(e),i=null==(t=e.ownerDocument)?void 0:t.body,o=Sw(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Sw(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+Qw(e),c=-r.scrollTop;return"rtl"===kw(i||n).direction&&(a+=Sw(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:a,y:c}}($w(e)))}function ov(e,t,n){var r="clippingParents"===t?function(e){var t=nv(Pw(e)),n=["absolute","fixed"].indexOf(kw(e).position)>=0&&xw(e)?Dw(e):e;return Ew(n)?t.filter((function(e){return Ew(e)&&Rw(e,n)&&"body"!==ww(e)})):[]}(e):[].concat(t),i=[].concat(r,[n]),o=i[0],s=i.reduce((function(t,n){var r=iv(e,n);return t.top=Sw(r.top,t.top),t.right=Bw(r.right,t.right),t.bottom=Bw(r.bottom,t.bottom),t.left=Sw(r.left,t.left),t}),iv(e,o));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function sv(e){var t,n=e.reference,r=e.element,i=e.placement,o=i?Tw(i):null,s=i?Vw(i):null,a=n.x+n.width/2-r.width/2,c=n.y+n.height/2-r.height/2;switch(o){case iw:t={x:a,y:n.y-r.height};break;case ow:t={x:a,y:n.y+n.height};break;case sw:t={x:n.x+n.width,y:c};break;case aw:t={x:n.x-r.width,y:c};break;default:t={x:n.x,y:n.y}}var u=o?Fw(o):null;if(null!=u){var f="y"===u?"height":"width";switch(s){case fw:t[u]=t[u]-(n[f]/2-r[f]/2);break;case lw:t[u]=t[u]+(n[f]/2-r[f]/2)}}return t}function av(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=void 0===r?e.placement:r,o=n.boundary,s=void 0===o?dw:o,a=n.rootBoundary,c=void 0===a?hw:a,u=n.elementContext,f=void 0===u?pw:u,l=n.altBoundary,d=void 0!==l&&l,h=n.padding,p=void 0===h?0:h,g=Mw("number"!=typeof p?p:jw(p,uw)),m=f===pw?gw:pw,y=e.rects.popper,b=e.elements[d?m:f],w=ov(Ew(b)?b:b.contextElement||$w(e.elements.popper),s,c),v=Ow(e.elements.reference),E=sv({reference:v,element:y,strategy:"absolute",placement:i}),x=rv(Object.assign({},y,E)),_=f===pw?x:v,A={top:w.top-_.top+g.top,bottom:_.bottom-w.bottom+g.bottom,left:w.left-_.left+g.left,right:_.right-w.right+g.right},T=e.modifiersData.offset;if(f===pw&&T){var S=T[i];Object.keys(A).forEach((function(e){var t=[sw,ow].indexOf(e)>=0?1:-1,n=[iw,ow].indexOf(e)>=0?"y":"x";A[e]+=S[n]*t}))}return A}function cv(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=n.boundary,o=n.rootBoundary,s=n.padding,a=n.flipVariations,c=n.allowedAutoPlacements,u=void 0===c?yw:c,f=Vw(r),l=f?a?mw:mw.filter((function(e){return Vw(e)===f})):uw,d=l.filter((function(e){return u.indexOf(e)>=0}));0===d.length&&(d=l,"production"!==process.env.NODE_ENV&&console.error(["Popper: The `allowedAutoPlacements` option did not allow any","placements. Ensure the `placement` option matches the variation","of the allowed placements.",'For example, "auto" cannot be used to allow "bottom-start".','Use "auto-start" instead.'].join(" ")));var h=d.reduce((function(t,n){return t[n]=av(e,{placement:n,boundary:i,rootBoundary:o,padding:s})[Tw(n)],t}),{});return Object.keys(h).sort((function(e,t){return h[e]-h[t]}))}var uv={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var i=n.mainAxis,o=void 0===i||i,s=n.altAxis,a=void 0===s||s,c=n.fallbackPlacements,u=n.padding,f=n.boundary,l=n.rootBoundary,d=n.altBoundary,h=n.flipVariations,p=void 0===h||h,g=n.allowedAutoPlacements,m=t.options.placement,y=Tw(m),b=c||(y===m||!p?[Zw(m)]:function(e){if(Tw(e)===cw)return[];var t=Zw(e);return[Xw(e),t,Xw(t)]}(m)),w=[m].concat(b).reduce((function(e,n){return e.concat(Tw(n)===cw?cv(t,{placement:n,boundary:f,rootBoundary:l,padding:u,flipVariations:p,allowedAutoPlacements:g}):n)}),[]),v=t.rects.reference,E=t.rects.popper,x=new Map,_=!0,A=w[0],T=0;T<w.length;T++){var S=w[T],B=Tw(S),N=Vw(S)===fw,O=[iw,ow].indexOf(B)>=0,I=O?"width":"height",R=av(t,{placement:S,boundary:f,rootBoundary:l,altBoundary:d,padding:u}),k=O?N?sw:aw:N?ow:iw;v[I]>E[I]&&(k=Zw(k));var L=Zw(k),$=[];if(o&&$.push(R[B]<=0),a&&$.push(R[k]<=0,R[L]<=0),$.every((function(e){return e}))){A=S,_=!1;break}x.set(S,$)}if(_)for(var P=function(e){var t=w.find((function(t){var n=x.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return A=t,"break"},U=p?3:1;U>0;U--){if("break"===P(U))break}t.placement!==A&&(t.modifiersData[r]._skip=!0,t.placement=A,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function fv(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function lv(e){return[iw,sw,ow,aw].some((function(t){return e[t]>=0}))}var dv={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.offset,o=void 0===i?[0,0]:i,s=yw.reduce((function(e,n){return e[n]=function(e,t,n){var r=Tw(e),i=[aw,iw].indexOf(r)>=0?-1:1,o="function"==typeof n?n(Object.assign({},t,{placement:e})):n,s=o[0],a=o[1];return s=s||0,a=(a||0)*i,[aw,sw].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}(n,t.rects,o),e}),{}),a=s[t.placement],c=a.x,u=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=u),t.modifiersData[r]=s}};var hv={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.mainAxis,o=void 0===i||i,s=n.altAxis,a=void 0!==s&&s,c=n.boundary,u=n.rootBoundary,f=n.altBoundary,l=n.padding,d=n.tether,h=void 0===d||d,p=n.tetherOffset,g=void 0===p?0:p,m=av(t,{boundary:c,rootBoundary:u,padding:l,altBoundary:f}),y=Tw(t.placement),b=Vw(t.placement),w=!b,v=Fw(y),E="x"===v?"y":"x",x=t.modifiersData.popperOffsets,_=t.rects.reference,A=t.rects.popper,T="function"==typeof g?g(Object.assign({},t.rects,{placement:t.placement})):g,S="number"==typeof T?{mainAxis:T,altAxis:T}:Object.assign({mainAxis:0,altAxis:0},T),B=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,N={x:0,y:0};if(x){if(o){var O,I="y"===v?iw:aw,R="y"===v?ow:sw,k="y"===v?"height":"width",L=x[v],$=L+m[I],P=L-m[R],U=h?-A[k]/2:0,D=b===fw?_[k]:A[k],F=b===fw?-A[k]:-_[k],C=t.elements.arrow,M=h&&C?Iw(C):{width:0,height:0},j=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},q=j[I],V=j[R],z=Cw(0,_[k],M[k]),H=w?_[k]/2-U-z-q-S.mainAxis:D-z-q-S.mainAxis,G=w?-_[k]/2+U+z+V+S.mainAxis:F+z+V+S.mainAxis,K=t.elements.arrow&&Dw(t.elements.arrow),W=K?"y"===v?K.clientTop||0:K.clientLeft||0:0,Z=null!=(O=null==B?void 0:B[v])?O:0,Y=L+G-Z,X=Cw(h?Bw($,L+H-Z-W):$,L,h?Sw(P,Y):P);x[v]=X,N[v]=X-L}if(a){var J,Q="x"===v?iw:aw,ee="x"===v?ow:sw,te=x[E],ne="y"===E?"height":"width",re=te+m[Q],ie=te-m[ee],oe=-1!==[iw,aw].indexOf(y),se=null!=(J=null==B?void 0:B[E])?J:0,ae=oe?re:te-_[ne]-A[ne]-se+S.altAxis,ce=oe?te+_[ne]+A[ne]-se-S.altAxis:ie,ue=h&&oe?function(e,t,n){var r=Cw(e,t,n);return r>n?n:r}(ae,te,ce):Cw(h?ae:re,te,h?ce:ie);x[E]=ue,N[E]=ue-te}t.modifiersData[r]=N}},requiresIfExists:["offset"]};function pv(e,t,n){void 0===n&&(n=!1);var r,i=xw(t),o=xw(t)&&function(e){var t=e.getBoundingClientRect(),n=Nw(t.width)/e.offsetWidth||1,r=Nw(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),s=$w(t),a=Ow(e,o),c={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!n)&&(("body"!==ww(t)||ev(s))&&(c=(r=t)!==vw(r)&&xw(r)?function(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}(r):Jw(r)),xw(t)?((u=Ow(t,!0)).x+=t.clientLeft,u.y+=t.clientTop):s&&(u.x=Qw(s))),{x:a.left+c.scrollLeft-u.x,y:a.top+c.scrollTop-u.y,width:a.width,height:a.height}}function gv(e){var t=new Map,n=new Set,r=[];function i(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var r=t.get(e);r&&i(r)}})),r.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||i(e)})),r}function mv(e){var t;return function(){return t||(t=new Promise((function(n){Promise.resolve().then((function(){t=void 0,n(e())}))}))),t}}function yv(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return[].concat(n).reduce((function(e,t){return e.replace(/%s/,t)}),e)}var bv='Popper: modifier "%s" provided an invalid %s property, expected %s but got %s',wv='Popper: modifier "%s" requires "%s", but "%s" modifier is not available',vv=["name","enabled","phase","fn","effect","requires","options"];var Ev="Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.",xv={placement:"bottom",modifiers:[],strategy:"absolute"};function _v(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function Av(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,i=t.defaultOptions,o=void 0===i?xv:i;return function(e,t,n){void 0===n&&(n=o);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},xv,o),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},s=[],a=!1,c={state:i,setOptions:function(n){var a="function"==typeof n?n(i.options):n;u(),i.options=Object.assign({},o,i.options,a),i.scrollParents={reference:Ew(e)?nv(e):e.contextElement?nv(e.contextElement):[],popper:nv(t)};var f=function(e){var t=gv(e);return bw.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(r,i.options.modifiers)));if(i.orderedModifiers=f.filter((function(e){return e.enabled})),"production"!==process.env.NODE_ENV){var l=function(e,t){var n=new Set;return e.filter((function(e){var r=t(e);if(!n.has(r))return n.add(r),!0}))}([].concat(f,i.options.modifiers),(function(e){return e.name}));if(function(e){e.forEach((function(t){[].concat(Object.keys(t),vv).filter((function(e,t,n){return n.indexOf(e)===t})).forEach((function(n){switch(n){case"name":"string"!=typeof t.name&&console.error(yv(bv,String(t.name),'"name"','"string"','"'+String(t.name)+'"'));break;case"enabled":"boolean"!=typeof t.enabled&&console.error(yv(bv,t.name,'"enabled"','"boolean"','"'+String(t.enabled)+'"'));break;case"phase":bw.indexOf(t.phase)<0&&console.error(yv(bv,t.name,'"phase"',"either "+bw.join(", "),'"'+String(t.phase)+'"'));break;case"fn":"function"!=typeof t.fn&&console.error(yv(bv,t.name,'"fn"','"function"','"'+String(t.fn)+'"'));break;case"effect":null!=t.effect&&"function"!=typeof t.effect&&console.error(yv(bv,t.name,'"effect"','"function"','"'+String(t.fn)+'"'));break;case"requires":null==t.requires||Array.isArray(t.requires)||console.error(yv(bv,t.name,'"requires"','"array"','"'+String(t.requires)+'"'));break;case"requiresIfExists":Array.isArray(t.requiresIfExists)||console.error(yv(bv,t.name,'"requiresIfExists"','"array"','"'+String(t.requiresIfExists)+'"'));break;case"options":case"data":break;default:console.error('PopperJS: an invalid property has been provided to the "'+t.name+'" modifier, valid properties are '+vv.map((function(e){return'"'+e+'"'})).join(", ")+'; but "'+n+'" was provided.')}t.requires&&t.requires.forEach((function(n){null==e.find((function(e){return e.name===n}))&&console.error(yv(wv,String(t.name),n,n))}))}))}))}(l),Tw(i.options.placement)===cw)i.orderedModifiers.find((function(e){return"flip"===e.name}))||console.error(['Popper: "auto" placements require the "flip" modifier be',"present and enabled to work."].join(" "));var d=kw(t);[d.marginTop,d.marginRight,d.marginBottom,d.marginLeft].some((function(e){return parseFloat(e)}))&&console.warn(['Popper: CSS "margin" styles cannot be used to apply padding',"between the popper and its reference element or boundary.","To replicate margin, use the `offset` modifier, as well as","the `padding` option in the `preventOverflow` and `flip`","modifiers."].join(" "))}return i.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,o=e.effect;if("function"==typeof o){var a=o({state:i,name:t,instance:c,options:r}),u=function(){};s.push(a||u)}})),c.update()},forceUpdate:function(){if(!a){var e=i.elements,t=e.reference,n=e.popper;if(_v(t,n)){i.rects={reference:pv(t,Dw(n),"fixed"===i.options.strategy),popper:Iw(n)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach((function(e){return i.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0,o=0;o<i.orderedModifiers.length;o++){if("production"!==process.env.NODE_ENV&&(r+=1)>100){console.error("Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.");break}if(!0!==i.reset){var s=i.orderedModifiers[o],u=s.fn,f=s.options,l=void 0===f?{}:f,d=s.name;"function"==typeof u&&(i=u({state:i,options:l,name:d,instance:c})||i)}else i.reset=!1,o=-1}}else"production"!==process.env.NODE_ENV&&console.error(Ev)}},update:mv((function(){return new Promise((function(e){c.forceUpdate(),e(i)}))})),destroy:function(){u(),a=!0}};if(!_v(e,t))return"production"!==process.env.NODE_ENV&&console.error(Ev),c;function u(){s.forEach((function(e){return e()})),s=[]}return c.setOptions(n).then((function(e){!a&&n.onFirstUpdate&&n.onFirstUpdate(e)})),c}}var Tv=Av({defaultModifiers:[Kw,{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=sv({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=void 0===r||r,o=n.adaptive,s=void 0===o||o,a=n.roundOffsets,c=void 0===a||a;if("production"!==process.env.NODE_ENV){var u=kw(t.elements.popper).transitionProperty||"";s&&["transform","top","right","bottom","left"].some((function(e){return u.indexOf(e)>=0}))&&console.warn(["Popper: Detected CSS transitions on at least one of the following",'CSS properties: "transform", "top", "right", "bottom", "left".',"\n\n",'Disable the "computeStyles" modifier\'s `adaptive` option to allow',"for smooth transitions, or remove these properties from the CSS","transition declaration on the popper element if only transitioning","opacity or background-color for example.","\n\n","We recommend using the popper element as a wrapper around an inner","element that can have any CSS property transitioned for animations."].join(" "))}var f={placement:Tw(t.placement),variation:Vw(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,Hw(Object.assign({},f,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:s,roundOffsets:c})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,Hw(Object.assign({},f,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},Aw,dv,uv,hv,qw,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,o=t.modifiersData.preventOverflow,s=av(t,{elementContext:"reference"}),a=av(t,{altBoundary:!0}),c=fv(s,r),u=fv(a,i,o),f=lv(c),l=lv(u);t.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:u,isReferenceHidden:f,hasPopperEscaped:l},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":f,"data-popper-escaped":l})}}]});const Sv=-1e5,Bv={left:Sv,right:Sv,top:Sv,bottom:Sv,width:0,height:0},Nv=e=>({commands:1&e[0],active:32&e[0],selection:16&e[0],focus:64&e[0],placement:8&e[0]}),Ov=e=>({commands:e[0].commands,active:e[5],selection:e[4],focus:e[6],placement:e[3]});function Iv(e){let t,n,r,i;const s=e[24].default,a=l(s,e,e[23],Ov);return{c(){t=R("div"),a&&a.c(),D(t,"class",e[1])},m(o,s){N(o,t,s),a&&a.m(t,null),e[25](t),n=!0,r||(i=[U(t,"focusin",e[12]),U(t,"focusout",e[13])],r=!0)},p(e,r){a&&a.p&&(!n||8388729&r[0])&&p(a,s,e,e[23],n?h(s,e[23],r,Nv):g(e[23]),Ov),(!n||2&r[0])&&D(t,"class",e[1])},i(e){n||(ge(a,e),n=!0)},o(e){me(a,e),n=!1},d(n){n&&O(t),a&&a.d(n),e[25](null),r=!1,o(i)}}}function Rv(e){let t,n,r=e[4]&&e[4][0]!==e[4][1]&&Iv(e);return{c(){r&&r.c(),t=P()},m(e,i){r&&r.m(e,i),N(e,t,i),n=!0},p(e,n){e[4]&&e[4][0]!==e[4][1]?r?(r.p(e,n),16&n[0]&&ge(r,1)):(r=Iv(e),r.c(),ge(r,1),r.m(t.parentNode,t)):r&&(he(),me(r,1,1,(()=>{r=null})),pe())},i(e){n||(ge(r),n=!0)},o(e){me(r),n=!1},d(e){r&&r.d(e),e&&O(t)}}}function kv(e,t,n){let r,i,o,s,a,c,u,l,d,h,{$$slots:p={},$$scope:g}=t,{editor:m}=t,{class:y="bubble-menu"}=t,{offset:b=0}=t,{padding:w=4}=t,{for:v}=t,{placement:E="top"}=t,x=!1,_=!1,A=E;const{active:T,doc:S,selection:B,focus:N,root:O,updateEditor:I}=Sb(m);function R(){if(!x)if(u)if(l)l.update();else{const e={getBoundingClientRect:()=>m.getBounds(r)||Bv,contextElement:m.root};l=Tv(e,u,{placement:E,modifiers:[{name:"arrow",options:{element:"[data-arrow]"}},{name:"computeStyles",options:{adaptive:!1}},{name:"offset",options:{offset:[0,b]}},{name:"preventOverflow",options:{padding:w}},{name:"dataOutput",enabled:!0,phase:"write",fn({state:e}){n(3,A=e.placement.split("-")[0])}}]}),requestAnimationFrame((()=>u&&u.classList.add("active")))}else l&&!_&&(l.destroy(),l=null)}function k(){n(18,x=!0)}function L(){n(18,x=!1),R()}function $(e){d&&(d.removeEventListener("mousedown",k),(h||d).removeEventListener("mouseup",L)),d=e,h=e&&e.ownerDocument,d&&(d.addEventListener("mousedown",k),(h||d).addEventListener("mouseup",L))}function P(){_&&(m.modules.selection.resume(),n(19,_=!1))}return f(e,T,(e=>n(5,a=e))),f(e,S,(e=>n(21,o=e))),f(e,B,(e=>n(22,s=e))),f(e,N,(e=>n(6,c=e))),f(e,O,(e=>n(20,i=e))),Z((()=>{$(),P(),l&&l.destroy()})),e.$$set=e=>{"editor"in e&&n(0,m=e.editor),"class"in e&&n(1,y=e.class),"offset"in e&&n(14,b=e.offset),"padding"in e&&n(15,w=e.padding),"for"in e&&n(16,v=e.for),"placement"in e&&n(17,E=e.placement),"$$scope"in e&&n(23,g=e.$$scope)},e.$$.update=()=>{1&e.$$.dirty[0]&&I(m),4980736&e.$$.dirty[0]&&n(4,r=function(e,t,n){let i;if(n&&n[0]===n[1]-1){const e=m.doc.getLineAt(n[0]),t=m.typeset.lines.findByAttributes(e.attributes,!0);t.frozen&&(i=t.name)}return i!=v&&(n=null),e||t?r:n}(x,_,s)),2097156&e.$$.dirty[0]&&R(),1048576&e.$$.dirty[0]&&$(i)},[m,y,u,A,r,a,c,T,S,B,N,O,function(e){_||"BUTTON"===e.target.nodeName||(m.modules.selection.pause(),n(19,_=!0))},P,b,w,v,E,x,_,i,o,s,g,p,function(e){J[e?"unshift":"push"]((()=>{u=e,n(2,u)}))}]}class Lv extends Ne{constructor(e){super(),Be(this,e,kv,Rv,a,{editor:0,class:1,offset:14,padding:15,for:16,placement:17},null,[-1,-1])}}function $v(e){let t,n;return{c(){t=k("title"),n=L(e[0])},m(e,r){N(e,t,r),T(t,n)},p(e,t){1&t&&F(n,e[0])},d(e){e&&O(t)}}}function Pv(e){let t,n,r,i=e[0]&&$v(e);const o=e[3].default,s=l(o,e,e[2],null);return{c(){t=k("svg"),i&&i.c(),n=P(),s&&s.c(),D(t,"xmlns","http://www.w3.org/2000/svg"),D(t,"viewBox",e[1]),D(t,"class","svelte-3h8371")},m(e,o){N(e,t,o),i&&i.m(t,null),T(t,n),s&&s.m(t,null),r=!0},p(e,[a]){e[0]?i?i.p(e,a):(i=$v(e),i.c(),i.m(t,n)):i&&(i.d(1),i=null),s&&s.p&&(!r||4&a)&&p(s,o,e,e[2],r?h(o,e[2],a,null):g(e[2]),null),(!r||2&a)&&D(t,"viewBox",e[1])},i(e){r||(ge(s,e),r=!0)},o(e){me(s,e),r=!1},d(e){e&&O(t),i&&i.d(),s&&s.d(e)}}}function Uv(e,t,n){let{$$slots:r={},$$scope:i}=t,{title:o=null}=t,{viewBox:s}=t;return e.$$set=e=>{"title"in e&&n(0,o=e.title),"viewBox"in e&&n(1,s=e.viewBox),"$$scope"in e&&n(2,i=e.$$scope)},[o,s,i,r]}class Dv extends Ne{constructor(e){super(),Be(this,e,Uv,Pv,a,{title:0,viewBox:1})}}function Fv(t){let n;return{c(){n=k("path"),D(n,"d","M448 96v320h32a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16H320a16 16 0 0 1-16-16v-32a16 16 0 0 1 16-16h32V288H160v128h32a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16H32a16 16 0 0 1-16-16v-32a16 16 0 0 1 16-16h32V96H32a16 16 0 0 1-16-16V48a16 16 0 0 1 16-16h160a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16h-32v128h192V96h-32a16 16 0 0 1-16-16V48a16 16 0 0 1 16-16h160a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16z")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function Cv(e){let t,r;const i=[{viewBox:"0 0 512 512"},e[0]];let o={$$slots:{default:[Fv]},$$scope:{ctx:e}};for(let e=0;e<i.length;e+=1)o=n(o,i[e]);return t=new Dv({props:o}),{c(){_e(t.$$.fragment)},m(e,n){Ae(t,e,n),r=!0},p(e,[n]){const r=1&n?Ee(i,[i[0],xe(e[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){r||(ge(t.$$.fragment,e),r=!0)},o(e){me(t.$$.fragment,e),r=!1},d(e){Te(t,e)}}}function Mv(e,t,r){return e.$$set=e=>{r(0,t=n(n({},t),m(e)))},[t=m(t)]}class jv extends Ne{constructor(e){super(),Be(this,e,Mv,Cv,a,{})}}function qv(t){let n;return{c(){n=k("path"),D(n,"d","M333.49 238a122 122 0 0 0 27-65.21C367.87 96.49 308 32 233.42 32H34a16 16 0 0 0-16 16v48a16 16 0 0 0 16 16h31.87v288H34a16 16 0 0 0-16 16v48a16 16 0 0 0 16 16h209.32c70.8 0 134.14-51.75 141-122.4 4.74-48.45-16.39-92.06-50.83-119.6zM145.66 112h87.76a48 48 0 0 1 0 96h-87.76zm87.76 288h-87.76V288h87.76a56 56 0 0 1 0 112z")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function Vv(e){let t,r;const i=[{viewBox:"0 0 384 512"},e[0]];let o={$$slots:{default:[qv]},$$scope:{ctx:e}};for(let e=0;e<i.length;e+=1)o=n(o,i[e]);return t=new Dv({props:o}),{c(){_e(t.$$.fragment)},m(e,n){Ae(t,e,n),r=!0},p(e,[n]){const r=1&n?Ee(i,[i[0],xe(e[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){r||(ge(t.$$.fragment,e),r=!0)},o(e){me(t.$$.fragment,e),r=!1},d(e){Te(t,e)}}}function zv(e,t,r){return e.$$set=e=>{r(0,t=n(n({},t),m(e)))},[t=m(t)]}class Hv extends Ne{constructor(e){super(),Be(this,e,zv,Vv,a,{})}}function Gv(t){let n;return{c(){n=k("path"),D(n,"d","M320 48v32a16 16 0 0 1-16 16h-62.76l-80 320H208a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16H16a16 16 0 0 1-16-16v-32a16 16 0 0 1 16-16h62.76l80-320H112a16 16 0 0 1-16-16V48a16 16 0 0 1 16-16h192a16 16 0 0 1 16 16z")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function Kv(e){let t,r;const i=[{viewBox:"0 0 320 512"},e[0]];let o={$$slots:{default:[Gv]},$$scope:{ctx:e}};for(let e=0;e<i.length;e+=1)o=n(o,i[e]);return t=new Dv({props:o}),{c(){_e(t.$$.fragment)},m(e,n){Ae(t,e,n),r=!0},p(e,[n]){const r=1&n?Ee(i,[i[0],xe(e[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){r||(ge(t.$$.fragment,e),r=!0)},o(e){me(t.$$.fragment,e),r=!1},d(e){Te(t,e)}}}function Wv(e,t,r){return e.$$set=e=>{r(0,t=n(n({},t),m(e)))},[t=m(t)]}class Zv extends Ne{constructor(e){super(),Be(this,e,Wv,Kv,a,{})}}function Yv(t){let n;return{c(){n=k("path"),D(n,"d","M48 48a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm0 160a48 48 0 1 0 48 48 48 48 0 0 0-48-48zm448 16H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function Xv(e){let t,r;const i=[{viewBox:"0 0 512 512"},e[0]];let o={$$slots:{default:[Yv]},$$scope:{ctx:e}};for(let e=0;e<i.length;e+=1)o=n(o,i[e]);return t=new Dv({props:o}),{c(){_e(t.$$.fragment)},m(e,n){Ae(t,e,n),r=!0},p(e,[n]){const r=1&n?Ee(i,[i[0],xe(e[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){r||(ge(t.$$.fragment,e),r=!0)},o(e){me(t.$$.fragment,e),r=!1},d(e){Te(t,e)}}}function Jv(e,t,r){return e.$$set=e=>{r(0,t=n(n({},t),m(e)))},[t=m(t)]}class Qv extends Ne{constructor(e){super(),Be(this,e,Jv,Xv,a,{})}}function eE(e){let t,n,r,i,a,c,u,f,l,d,h,p,g,m,y,b,w,v,E;return i=new jv({}),f=new Qv({}),p=new Hv({}),b=new Zv({}),{c(){t=R("div"),n=R("button"),r=R("span"),_e(i.$$.fragment),a=$(),c=R("button"),u=R("span"),_e(f.$$.fragment),l=$(),d=R("button"),h=R("span"),_e(p.$$.fragment),g=$(),m=R("button"),y=R("span"),_e(b.$$.fragment),D(r,"class","w-6 h-6 p-1"),D(n,"class","btn btn-sm"),D(u,"class","w-6 h-6 p-1"),D(c,"class","btn btn-sm"),D(h,"class","w-6 h-6 p-1"),D(d,"class","btn btn-sm"),D(y,"class","w-6 h-6 p-1"),D(m,"class","btn btn-sm"),D(t,"class","btn-group")},m(o,x){N(o,t,x),T(t,n),T(n,r),Ae(i,r,null),T(t,a),T(t,c),T(c,u),Ae(f,u,null),T(t,l),T(t,d),T(d,h),Ae(p,h,null),T(t,g),T(t,m),T(m,y),Ae(b,y,null),w=!0,v||(E=[U(n,"click",(function(){s(e[3].header1)&&e[3].header1.apply(this,arguments)})),U(c,"click",(function(){s(e[3].bulletList)&&e[3].bulletList.apply(this,arguments)})),U(d,"click",(function(){s(e[3].bold)&&e[3].bold.apply(this,arguments)})),U(m,"click",(function(){s(e[3].italic)&&e[3].italic.apply(this,arguments)}))],v=!0)},p(t,n){e=t},i(e){w||(ge(i.$$.fragment,e),ge(f.$$.fragment,e),ge(p.$$.fragment,e),ge(b.$$.fragment,e),w=!0)},o(e){me(i.$$.fragment,e),me(f.$$.fragment,e),me(p.$$.fragment,e),me(b.$$.fragment,e),w=!1},d(e){e&&O(t),Te(i),Te(f),Te(p),Te(b),v=!1,o(E)}}}function tE(e){let t,n,r,i,a,c,u,f;return t=new Lv({props:{for:null,editor:e[0],offset:8,$$slots:{default:[eE,({commands:e})=>({3:e}),({commands:e})=>e?8:0]},$$scope:{ctx:e}}}),{c(){_e(t.$$.fragment),n=$(),r=R("div"),D(r,"class",i="p-4 min-h-[16rem] textarea border-base-300 "+e[2]+" "+(e[1]?"opacity-50":"")+" svelte-1utagcy")},m(i,o){Ae(t,i,o),N(i,n,o),N(i,r,o),c=!0,u||(f=[y(a=rw.call(null,r,e[0])),y(nE.call(null,r))],u=!0)},p(e,[n]){const o={};1&n&&(o.editor=e[0]),24&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o),(!c||6&n&&i!==(i="p-4 min-h-[16rem] textarea border-base-300 "+e[2]+" "+(e[1]?"opacity-50":"")+" svelte-1utagcy"))&&D(r,"class",i),a&&s(a.update)&&1&n&&a.update.call(null,e[0])},i(e){c||(ge(t.$$.fragment,e),c=!0)},o(e){me(t.$$.fragment,e),c=!1},d(e){Te(t,e),e&&O(n),e&&O(r),u=!1,o(f)}}}function nE(e){e.focus()}function rE(e,t,n){let{editor:r}=t,{disabled:i=!1}=t,{class:o=""}=t;return e.$$set=e=>{"editor"in e&&n(0,r=e.editor),"disabled"in e&&n(1,i=e.disabled),"class"in e&&n(2,o=e.class)},e.$$.update=()=>{2&e.$$.dirty&&n(0,r.enabled=!i,r)},[r,i,o]}class iE extends Ne{constructor(e){super(),Be(this,e,rE,tE,a,{editor:0,disabled:1,class:2})}}function oE(e,t,n){const r=e.slice();return r[11]=t[n],r}function sE(e){let t,n,r,i,o,s,a,c,u=e[11]+"";function f(){return e[7](e[11])}return{c(){t=R("button"),n=R("span"),r=L(u),i=$(),o=k("svg"),s=k("path"),D(s,"stroke-linecap","round"),D(s,"stroke-linejoin","round"),D(s,"stroke-width","2"),D(s,"d","M6 18L18 6M6 6l12 12"),D(o,"xmlns","http://www.w3.org/2000/svg"),D(o,"fill","none"),D(o,"viewBox","0 0 24 24"),D(o,"class","inline-block w-4 h-4 stroke-current"),D(t,"class","btn btn-outline btn-sm flex items-center")},m(e,u){N(e,t,u),T(t,n),T(n,r),T(t,i),T(t,o),T(o,s),a||(c=U(t,"click",f),a=!0)},p(t,n){e=t,1&n&&u!==(u=e[11]+"")&&F(r,u)},d(e){e&&O(t),a=!1,c()}}}function aE(t){let n,r,i,s,a,c,u,f,l,d,h=t[0],p=[];for(let e=0;e<h.length;e+=1)p[e]=sE(oE(t,h,e));return{c(){n=R("div");for(let e=0;e<p.length;e+=1)p[e].c();r=$(),i=R("input"),a=$(),c=R("button"),u=L("Add"),D(i,"placeholder","Add tag..."),D(i,"class",s="bg-transparent text-base rounded-lg h-8 px-3 w-32 "+(t[1]?"opacity-50":"")),i.disabled=t[1],D(c,"class","btn btn-sm btn-ghost"),c.disabled=f=0===t[2].trim().length||t[0].includes(t[2])||t[1],D(n,"class","flex flex-wrap space-x-2")},m(e,o){N(e,n,o);for(let e=0;e<p.length;e+=1)p[e]&&p[e].m(n,null);T(n,r),T(n,i),C(i,t[2]),t[9](i),T(n,a),T(n,c),T(c,u),l||(d=[U(i,"input",t[8]),U(i,"keypress",t[6]),U(c,"click",t[4])],l=!0)},p(e,[t]){if(33&t){let i;for(h=e[0],i=0;i<h.length;i+=1){const o=oE(e,h,i);p[i]?p[i].p(o,t):(p[i]=sE(o),p[i].c(),p[i].m(n,r))}for(;i<p.length;i+=1)p[i].d(1);p.length=h.length}2&t&&s!==(s="bg-transparent text-base rounded-lg h-8 px-3 w-32 "+(e[1]?"opacity-50":""))&&D(i,"class",s),2&t&&(i.disabled=e[1]),4&t&&i.value!==e[2]&&C(i,e[2]),7&t&&f!==(f=0===e[2].trim().length||e[0].includes(e[2])||e[1])&&(c.disabled=f)},i:e,o:e,d(e){e&&O(n),I(p,e),t[9](null),l=!1,o(d)}}}function cE(e,t,n){let r,{tags:i}=t,{disabled:o=!1}=t,s="";const a=Y();function c(){a("add",s),n(2,s=""),r.focus()}function u(e){a("remove",e)}return e.$$set=e=>{"tags"in e&&n(0,i=e.tags),"disabled"in e&&n(1,o=e.disabled)},[i,o,s,r,c,u,function(e){"Enter"===e.key&&s.trim().length>0&&!i.includes(s)&&c()},e=>u(e),function(){s=this.value,n(2,s)},function(e){J[e?"unshift":"push"]((()=>{r=e,n(3,r)}))}]}class uE extends Ne{constructor(e){super(),Be(this,e,cE,aE,a,{tags:0,disabled:1})}}function fE(e,t,n){const r=e.slice();return r[13]=t[n],r}function lE(e){let t,n,r,i,o,s,a,c,u,f=e[0].owner+"";return{c(){t=R("p"),n=L("This note is "),r=R("span"),r.textContent="shared",i=L(" with you. It is owned\n      by "),o=R("span"),s=L(f),a=L("."),c=$(),u=R("p"),u.textContent="Users with whom the owner shared the note:",D(r,"class","font-bold"),D(o,"class","italic font-bold"),D(t,"class","mt-3"),D(u,"class","mt-3")},m(e,f){N(e,t,f),T(t,n),T(t,r),T(t,i),T(t,o),T(o,s),T(t,a),N(e,c,f),N(e,u,f)},p(e,t){1&t&&f!==(f=e[0].owner+"")&&F(s,f)},d(e){e&&O(t),e&&O(c),e&&O(u)}}}function dE(t){let n;return{c(){n=R("p"),n.textContent="Add users by their principal to allow them editing the note.",D(n,"class","mt-1")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function hE(e){let t,n,r,i,o,s,a,c,u,f=e[13]+"";function l(){return e[9](e[13])}return{c(){t=R("button"),n=R("span"),r=L(f),i=$(),o=k("svg"),s=k("path"),D(s,"stroke-linecap","round"),D(s,"stroke-linejoin","round"),D(s,"stroke-width","2"),D(s,"d","M6 18L18 6M6 6l12 12"),D(o,"xmlns","http://www.w3.org/2000/svg"),D(o,"fill","none"),D(o,"viewBox","0 0 24 24"),D(o,"class","inline-block w-4 h-4 stroke-current"),D(t,"class","btn btn-outline btn-sm flex items-center"),t.disabled=a=e[4]||e[5]||!e[1]},m(e,a){N(e,t,a),T(t,n),T(n,r),T(t,i),T(t,o),T(o,s),c||(u=U(t,"click",l),c=!0)},p(n,i){e=n,1&i&&f!==(f=e[13]+"")&&F(r,f),50&i&&a!==(a=e[4]||e[5]||!e[1])&&(t.disabled=a)},d(e){e&&O(t),c=!1,u()}}}function pE(t){let n,r,i,s,a,c,u,f,l,d,h,p,g,m,y,b=t[4]?"Adding...":t[5]?"Removing... ":"Add";function w(e,t){return e[1]?dE:lE}let v=w(t),E=v(t),x=t[0].users,_=[];for(let e=0;e<x.length;e+=1)_[e]=hE(fE(t,x,e));return{c(){n=R("div"),r=R("p"),r.textContent="Users",i=$(),E.c(),s=$(),a=R("div");for(let e=0;e<_.length;e+=1)_[e].c();c=$(),u=R("input"),l=$(),d=R("button"),h=L(b),D(r,"class","text-lg font-bold"),D(u,"placeholder","Add principal..."),D(u,"class",f="bg-transparent text-base rounded-lg h-8 px-3 w-auto "+(t[4]||t[5]?"opacity-50":"")+" "+(t[1]?"":"hidden")),u.disabled=t[4],D(d,"class",p="btn btn-sm btn-ghost "+(t[1]?"":"hidden")+" "+(t[4]||t[5]?"loading":"")),d.disabled=g=0===t[2].trim().length||t[0].users.includes(t[2])||t[4]||t[5],D(a,"class","flex flex-wrap space-x-2 mt-2"),D(n,"class","flex flex-col flex-wrap mt-4")},m(e,o){N(e,n,o),T(n,r),T(n,i),E.m(n,null),T(n,s),T(n,a);for(let e=0;e<_.length;e+=1)_[e]&&_[e].m(a,null);T(a,c),T(a,u),C(u,t[2]),t[11](u),T(a,l),T(a,d),T(d,h),m||(y=[U(u,"input",t[10]),U(u,"keypress",t[8]),U(d,"click",t[6])],m=!0)},p(e,[t]){if(v===(v=w(e))&&E?E.p(e,t):(E.d(1),E=v(e),E&&(E.c(),E.m(n,s))),179&t){let n;for(x=e[0].users,n=0;n<x.length;n+=1){const r=fE(e,x,n);_[n]?_[n].p(r,t):(_[n]=hE(r),_[n].c(),_[n].m(a,c))}for(;n<_.length;n+=1)_[n].d(1);_.length=x.length}50&t&&f!==(f="bg-transparent text-base rounded-lg h-8 px-3 w-auto "+(e[4]||e[5]?"opacity-50":"")+" "+(e[1]?"":"hidden"))&&D(u,"class",f),16&t&&(u.disabled=e[4]),4&t&&u.value!==e[2]&&C(u,e[2]),48&t&&b!==(b=e[4]?"Adding...":e[5]?"Removing... ":"Add")&&F(h,b),50&t&&p!==(p="btn btn-sm btn-ghost "+(e[1]?"":"hidden")+" "+(e[4]||e[5]?"loading":""))&&D(d,"class",p),53&t&&g!==(g=0===e[2].trim().length||e[0].users.includes(e[2])||e[4]||e[5])&&(d.disabled=g)},i:e,o:e,d(e){e&&O(n),E.d(),I(_,e),t[11](null),m=!1,o(y)}}}function gE(e,t,n){let r;f(e,gg,(e=>n(12,r=e)));let i,{editedNote:o}=t,{ownedByMe:s=!1}=t,a="",c=!1,u=!1;async function l(){n(4,c=!0);try{await async function(e,t,n){await n.add_user(e,t)}(o.id,a,r.actor),Pp({type:"success",message:"User successfully added"}),n(0,o.users=[...o.users,a],o),n(2,a=""),i.focus()}catch(e){Up(e,"Could not add user.")}finally{n(4,c=!1)}await Ug(r.actor,r.crypto).catch((e=>Up(e,"Could not refresh notes.")))}async function d(e){n(5,u=!0);try{await async function(e,t,n){await n.remove_user(e,t)}(o.id,e,r.actor),n(0,o.users=o.users.filter((t=>t!==e)),o),Pp({type:"success",message:"User successfully removed"})}catch(e){Up(e,"Could not remove user.")}finally{n(5,u=!1)}await Ug(r.actor,r.crypto).catch((e=>Up(e,"Could not refresh notes.")))}return e.$$set=e=>{"editedNote"in e&&n(0,o=e.editedNote),"ownedByMe"in e&&n(1,s=e.ownedByMe)},[o,s,a,i,c,u,l,d,function(e){"Enter"===e.key&&a.trim().length>0&&!o.users.includes(a)&&l()},e=>{d(e)},function(){a=this.value,n(2,a)},function(e){J[e?"unshift":"push"]((()=>{i=e,n(3,i)}))}]}class mE extends Ne{constructor(e){super(),Be(this,e,gE,pE,a,{editedNote:0,ownedByMe:1})}}function yE(t){let n;return{c(){n=k("path"),D(n,"d","M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function bE(e){let t,r;const i=[{viewBox:"0 0 448 512"},e[0]];let o={$$slots:{default:[yE]},$$scope:{ctx:e}};for(let e=0;e<i.length;e+=1)o=n(o,i[e]);return t=new Dv({props:o}),{c(){_e(t.$$.fragment)},m(e,n){Ae(t,e,n),r=!0},p(e,[n]){const r=1&n?Ee(i,[i[0],xe(e[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){r||(ge(t.$$.fragment,e),r=!0)},o(e){me(t.$$.fragment,e),r=!1},d(e){Te(t,e)}}}function wE(e,t,r){return e.$$set=e=>{r(0,t=n(n({},t),m(e)))},[t=m(t)]}class vE extends Ne{constructor(e){super(),Be(this,e,wE,bE,a,{})}}var EE,xE;function _E(){if(xE)return EE;xE=1;const{entries:e,setPrototypeOf:t,isFrozen:n,getPrototypeOf:r,getOwnPropertyDescriptor:i}=Object;let{freeze:o,seal:s,create:a}=Object,{apply:c,construct:u}="undefined"!=typeof Reflect&&Reflect;o||(o=function(e){return e}),s||(s=function(e){return e}),c||(c=function(e,t,n){return e.apply(t,n)}),u||(u=function(e,t){return new e(...t)});const f=T(Array.prototype.forEach),l=T(Array.prototype.lastIndexOf),d=T(Array.prototype.pop),h=T(Array.prototype.push),p=T(Array.prototype.splice),g=T(String.prototype.toLowerCase),m=T(String.prototype.toString),y=T(String.prototype.match),b=T(String.prototype.replace),w=T(String.prototype.indexOf),v=T(String.prototype.trim),E=T(Object.prototype.hasOwnProperty),x=T(RegExp.prototype.test),_=(A=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return u(A,t)});var A;function T(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return c(e,t,r)}}function S(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g;t&&t(e,null);let o=r.length;for(;o--;){let t=r[o];if("string"==typeof t){const e=i(t);e!==t&&(n(r)||(r[o]=e),t=e)}e[t]=!0}return e}function B(e){for(let t=0;t<e.length;t++){E(e,t)||(e[t]=null)}return e}function N(t){const n=a(null);for(const[r,i]of e(t)){E(t,r)&&(Array.isArray(i)?n[r]=B(i):i&&"object"==typeof i&&i.constructor===Object?n[r]=N(i):n[r]=i)}return n}function O(e,t){for(;null!==e;){const n=i(e,t);if(n){if(n.get)return T(n.get);if("function"==typeof n.value)return T(n.value)}e=r(e)}return function(){return null}}const I=o(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),R=o(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),k=o(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),L=o(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),$=o(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),P=o(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),U=o(["#text"]),D=o(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),F=o(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),C=o(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),M=o(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),j=s(/\{\{[\w\W]*|[\w\W]*\}\}/gm),q=s(/<%[\w\W]*|[\w\W]*%>/gm),V=s(/\$\{[\w\W]*/gm),z=s(/^data-[\-\w.\u00B7-\uFFFF]+$/),H=s(/^aria-[\-\w]+$/),G=s(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),K=s(/^(?:\w+script|data):/i),W=s(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Z=s(/^html$/i),Y=s(/^[a-z][.\w]*(-[.\w]+)+$/i);var X=Object.freeze({__proto__:null,ARIA_ATTR:H,ATTR_WHITESPACE:W,CUSTOM_ELEMENT:Y,DATA_ATTR:z,DOCTYPE_NAME:Z,ERB_EXPR:q,IS_ALLOWED_URI:G,IS_SCRIPT_OR_DATA:K,MUSTACHE_EXPR:j,TMPLIT_EXPR:V});const J=1,Q=3,ee=7,te=8,ne=9,re=function(){return"undefined"==typeof window?null:window};var ie=function t(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re();const r=e=>t(e);if(r.version="3.2.6",r.removed=[],!n||!n.document||n.document.nodeType!==ne||!n.Element)return r.isSupported=!1,r;let{document:i}=n;const s=i,c=s.currentScript,{DocumentFragment:u,HTMLTemplateElement:A,Node:T,Element:B,NodeFilter:j,NamedNodeMap:q=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:V,DOMParser:z,trustedTypes:H}=n,K=B.prototype,W=O(K,"cloneNode"),Y=O(K,"remove"),ie=O(K,"nextSibling"),oe=O(K,"childNodes"),se=O(K,"parentNode");if("function"==typeof A){const e=i.createElement("template");e.content&&e.content.ownerDocument&&(i=e.content.ownerDocument)}let ae,ce="";const{implementation:ue,createNodeIterator:fe,createDocumentFragment:le,getElementsByTagName:de}=i,{importNode:he}=s;let pe={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};r.isSupported="function"==typeof e&&"function"==typeof se&&ue&&void 0!==ue.createHTMLDocument;const{MUSTACHE_EXPR:ge,ERB_EXPR:me,TMPLIT_EXPR:ye,DATA_ATTR:be,ARIA_ATTR:we,IS_SCRIPT_OR_DATA:ve,ATTR_WHITESPACE:Ee,CUSTOM_ELEMENT:xe}=X;let{IS_ALLOWED_URI:_e}=X,Ae=null;const Te=S({},[...I,...R,...k,...$,...U]);let Se=null;const Be=S({},[...D,...F,...C,...M]);let Ne=Object.seal(a(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Oe=null,Ie=null,Re=!0,ke=!0,Le=!1,$e=!0,Pe=!1,Ue=!0,De=!1,Fe=!1,Ce=!1,Me=!1,je=!1,qe=!1,Ve=!0,ze=!1,He=!0,Ge=!1,Ke={},We=null;const Ze=S({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ye=null;const Xe=S({},["audio","video","img","source","image","track"]);let Je=null;const Qe=S({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),et="http://www.w3.org/1998/Math/MathML",tt="http://www.w3.org/2000/svg",nt="http://www.w3.org/1999/xhtml";let rt=nt,it=!1,ot=null;const st=S({},[et,tt,nt],m);let at=S({},["mi","mo","mn","ms","mtext"]),ct=S({},["annotation-xml"]);const ut=S({},["title","style","font","a","script"]);let ft=null;const lt=["application/xhtml+xml","text/html"];let dt=null,ht=null;const pt=i.createElement("form"),gt=function(e){return e instanceof RegExp||e instanceof Function},mt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ht||ht!==e){if(e&&"object"==typeof e||(e={}),e=N(e),ft=-1===lt.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,dt="application/xhtml+xml"===ft?m:g,Ae=E(e,"ALLOWED_TAGS")?S({},e.ALLOWED_TAGS,dt):Te,Se=E(e,"ALLOWED_ATTR")?S({},e.ALLOWED_ATTR,dt):Be,ot=E(e,"ALLOWED_NAMESPACES")?S({},e.ALLOWED_NAMESPACES,m):st,Je=E(e,"ADD_URI_SAFE_ATTR")?S(N(Qe),e.ADD_URI_SAFE_ATTR,dt):Qe,Ye=E(e,"ADD_DATA_URI_TAGS")?S(N(Xe),e.ADD_DATA_URI_TAGS,dt):Xe,We=E(e,"FORBID_CONTENTS")?S({},e.FORBID_CONTENTS,dt):Ze,Oe=E(e,"FORBID_TAGS")?S({},e.FORBID_TAGS,dt):N({}),Ie=E(e,"FORBID_ATTR")?S({},e.FORBID_ATTR,dt):N({}),Ke=!!E(e,"USE_PROFILES")&&e.USE_PROFILES,Re=!1!==e.ALLOW_ARIA_ATTR,ke=!1!==e.ALLOW_DATA_ATTR,Le=e.ALLOW_UNKNOWN_PROTOCOLS||!1,$e=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Pe=e.SAFE_FOR_TEMPLATES||!1,Ue=!1!==e.SAFE_FOR_XML,De=e.WHOLE_DOCUMENT||!1,Me=e.RETURN_DOM||!1,je=e.RETURN_DOM_FRAGMENT||!1,qe=e.RETURN_TRUSTED_TYPE||!1,Ce=e.FORCE_BODY||!1,Ve=!1!==e.SANITIZE_DOM,ze=e.SANITIZE_NAMED_PROPS||!1,He=!1!==e.KEEP_CONTENT,Ge=e.IN_PLACE||!1,_e=e.ALLOWED_URI_REGEXP||G,rt=e.NAMESPACE||nt,at=e.MATHML_TEXT_INTEGRATION_POINTS||at,ct=e.HTML_INTEGRATION_POINTS||ct,Ne=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&gt(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ne.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&gt(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ne.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ne.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Pe&&(ke=!1),je&&(Me=!0),Ke&&(Ae=S({},U),Se=[],!0===Ke.html&&(S(Ae,I),S(Se,D)),!0===Ke.svg&&(S(Ae,R),S(Se,F),S(Se,M)),!0===Ke.svgFilters&&(S(Ae,k),S(Se,F),S(Se,M)),!0===Ke.mathMl&&(S(Ae,$),S(Se,C),S(Se,M))),e.ADD_TAGS&&(Ae===Te&&(Ae=N(Ae)),S(Ae,e.ADD_TAGS,dt)),e.ADD_ATTR&&(Se===Be&&(Se=N(Se)),S(Se,e.ADD_ATTR,dt)),e.ADD_URI_SAFE_ATTR&&S(Je,e.ADD_URI_SAFE_ATTR,dt),e.FORBID_CONTENTS&&(We===Ze&&(We=N(We)),S(We,e.FORBID_CONTENTS,dt)),He&&(Ae["#text"]=!0),De&&S(Ae,["html","head","body"]),Ae.table&&(S(Ae,["tbody"]),delete Oe.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw _('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw _('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');ae=e.TRUSTED_TYPES_POLICY,ce=ae.createHTML("")}else void 0===ae&&(ae=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(H,c)),null!==ae&&"string"==typeof ce&&(ce=ae.createHTML(""));o&&o(e),ht=e}},yt=S({},[...R,...k,...L]),bt=S({},[...$,...P]),wt=function(e){h(r.removed,{element:e});try{se(e).removeChild(e)}catch(t){Y(e)}},vt=function(e,t){try{h(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){h(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(Me||je)try{wt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},Et=function(e){let t=null,n=null;if(Ce)e="<remove></remove>"+e;else{const t=y(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===ft&&rt===nt&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const r=ae?ae.createHTML(e):e;if(rt===nt)try{t=(new z).parseFromString(r,ft)}catch(e){}if(!t||!t.documentElement){t=ue.createDocument(rt,"template",null);try{t.documentElement.innerHTML=it?ce:r}catch(e){}}const o=t.body||t.documentElement;return e&&n&&o.insertBefore(i.createTextNode(n),o.childNodes[0]||null),rt===nt?de.call(t,De?"html":"body")[0]:De?t.documentElement:o},xt=function(e){return fe.call(e.ownerDocument||e,e,j.SHOW_ELEMENT|j.SHOW_COMMENT|j.SHOW_TEXT|j.SHOW_PROCESSING_INSTRUCTION|j.SHOW_CDATA_SECTION,null)},_t=function(e){return e instanceof V&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof q)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},At=function(e){return"function"==typeof T&&e instanceof T};function Tt(e,t,n){f(e,(e=>{e.call(r,t,n,ht)}))}const St=function(e){let t=null;if(Tt(pe.beforeSanitizeElements,e,null),_t(e))return wt(e),!0;const n=dt(e.nodeName);if(Tt(pe.uponSanitizeElement,e,{tagName:n,allowedTags:Ae}),Ue&&e.hasChildNodes()&&!At(e.firstElementChild)&&x(/<[/\w!]/g,e.innerHTML)&&x(/<[/\w!]/g,e.textContent))return wt(e),!0;if(e.nodeType===ee)return wt(e),!0;if(Ue&&e.nodeType===te&&x(/<[/\w]/g,e.data))return wt(e),!0;if(!Ae[n]||Oe[n]){if(!Oe[n]&&Nt(n)){if(Ne.tagNameCheck instanceof RegExp&&x(Ne.tagNameCheck,n))return!1;if(Ne.tagNameCheck instanceof Function&&Ne.tagNameCheck(n))return!1}if(He&&!We[n]){const t=se(e)||e.parentNode,n=oe(e)||e.childNodes;if(n&&t){for(let r=n.length-1;r>=0;--r){const i=W(n[r],!0);i.__removalCount=(e.__removalCount||0)+1,t.insertBefore(i,ie(e))}}}return wt(e),!0}return e instanceof B&&!function(e){let t=se(e);t&&t.tagName||(t={namespaceURI:rt,tagName:"template"});const n=g(e.tagName),r=g(t.tagName);return!!ot[e.namespaceURI]&&(e.namespaceURI===tt?t.namespaceURI===nt?"svg"===n:t.namespaceURI===et?"svg"===n&&("annotation-xml"===r||at[r]):Boolean(yt[n]):e.namespaceURI===et?t.namespaceURI===nt?"math"===n:t.namespaceURI===tt?"math"===n&&ct[r]:Boolean(bt[n]):e.namespaceURI===nt?!(t.namespaceURI===tt&&!ct[r])&&!(t.namespaceURI===et&&!at[r])&&!bt[n]&&(ut[n]||!yt[n]):!("application/xhtml+xml"!==ft||!ot[e.namespaceURI]))}(e)?(wt(e),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!x(/<\/no(script|embed|frames)/i,e.innerHTML)?(Pe&&e.nodeType===Q&&(t=e.textContent,f([ge,me,ye],(e=>{t=b(t,e," ")})),e.textContent!==t&&(h(r.removed,{element:e.cloneNode()}),e.textContent=t)),Tt(pe.afterSanitizeElements,e,null),!1):(wt(e),!0)},Bt=function(e,t,n){if(Ve&&("id"===t||"name"===t)&&(n in i||n in pt))return!1;if(ke&&!Ie[t]&&x(be,t));else if(Re&&x(we,t));else if(!Se[t]||Ie[t]){if(!(Nt(e)&&(Ne.tagNameCheck instanceof RegExp&&x(Ne.tagNameCheck,e)||Ne.tagNameCheck instanceof Function&&Ne.tagNameCheck(e))&&(Ne.attributeNameCheck instanceof RegExp&&x(Ne.attributeNameCheck,t)||Ne.attributeNameCheck instanceof Function&&Ne.attributeNameCheck(t))||"is"===t&&Ne.allowCustomizedBuiltInElements&&(Ne.tagNameCheck instanceof RegExp&&x(Ne.tagNameCheck,n)||Ne.tagNameCheck instanceof Function&&Ne.tagNameCheck(n))))return!1}else if(Je[t]);else if(x(_e,b(n,Ee,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==w(n,"data:")||!Ye[e]){if(Le&&!x(ve,b(n,Ee,"")));else if(n)return!1}else;return!0},Nt=function(e){return"annotation-xml"!==e&&y(e,xe)},Ot=function(e){Tt(pe.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||_t(e))return;const n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Se,forceKeepAttr:void 0};let i=t.length;for(;i--;){const o=t[i],{name:s,namespaceURI:a,value:c}=o,u=dt(s),l=c;let h="value"===s?l:v(l);if(n.attrName=u,n.attrValue=h,n.keepAttr=!0,n.forceKeepAttr=void 0,Tt(pe.uponSanitizeAttribute,e,n),h=n.attrValue,!ze||"id"!==u&&"name"!==u||(vt(s,e),h="user-content-"+h),Ue&&x(/((--!?|])>)|<\/(style|title)/i,h)){vt(s,e);continue}if(n.forceKeepAttr)continue;if(!n.keepAttr){vt(s,e);continue}if(!$e&&x(/\/>/i,h)){vt(s,e);continue}Pe&&f([ge,me,ye],(e=>{h=b(h,e," ")}));const p=dt(e.nodeName);if(Bt(p,u,h)){if(ae&&"object"==typeof H&&"function"==typeof H.getAttributeType)if(a);else switch(H.getAttributeType(p,u)){case"TrustedHTML":h=ae.createHTML(h);break;case"TrustedScriptURL":h=ae.createScriptURL(h)}if(h!==l)try{a?e.setAttributeNS(a,s,h):e.setAttribute(s,h),_t(e)?wt(e):d(r.removed)}catch(t){vt(s,e)}}else vt(s,e)}Tt(pe.afterSanitizeAttributes,e,null)},It=function e(t){let n=null;const r=xt(t);for(Tt(pe.beforeSanitizeShadowDOM,t,null);n=r.nextNode();)Tt(pe.uponSanitizeShadowNode,n,null),St(n),Ot(n),n.content instanceof u&&e(n.content);Tt(pe.afterSanitizeShadowDOM,t,null)};return r.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=null,o=null,a=null;if(it=!e,it&&(e="\x3c!--\x3e"),"string"!=typeof e&&!At(e)){if("function"!=typeof e.toString)throw _("toString is not a function");if("string"!=typeof(e=e.toString()))throw _("dirty is not a string, aborting")}if(!r.isSupported)return e;if(Fe||mt(t),r.removed=[],"string"==typeof e&&(Ge=!1),Ge){if(e.nodeName){const t=dt(e.nodeName);if(!Ae[t]||Oe[t])throw _("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof T)n=Et("\x3c!----\x3e"),i=n.ownerDocument.importNode(e,!0),i.nodeType===J&&"BODY"===i.nodeName||"HTML"===i.nodeName?n=i:n.appendChild(i);else{if(!Me&&!Pe&&!De&&-1===e.indexOf("<"))return ae&&qe?ae.createHTML(e):e;if(n=Et(e),!n)return Me?null:qe?ce:""}n&&Ce&&wt(n.firstChild);const c=xt(Ge?e:n);for(;o=c.nextNode();)St(o),Ot(o),o.content instanceof u&&It(o.content);if(Ge)return e;if(Me){if(je)for(a=le.call(n.ownerDocument);n.firstChild;)a.appendChild(n.firstChild);else a=n;return(Se.shadowroot||Se.shadowrootmode)&&(a=he.call(s,a,!0)),a}let l=De?n.outerHTML:n.innerHTML;return De&&Ae["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&x(Z,n.ownerDocument.doctype.name)&&(l="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+l),Pe&&f([ge,me,ye],(e=>{l=b(l,e," ")})),ae&&qe?ae.createHTML(l):l},r.setConfig=function(){mt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Fe=!0},r.clearConfig=function(){ht=null,Fe=!1},r.isValidAttribute=function(e,t,n){ht||mt({});const r=dt(e),i=dt(t);return Bt(r,i,n)},r.addHook=function(e,t){"function"==typeof t&&h(pe[e],t)},r.removeHook=function(e,t){if(void 0!==t){const n=l(pe[e],t);return-1===n?void 0:p(pe[e],n,1)[0]}return d(pe[e])},r.removeHooks=function(e){pe[e]=[]},r.removeAllHooks=function(){pe={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},r}();return EE=ie}var AE=Le(window.DOMPurify||(window.DOMPurify=_E().default||_E()));function TE(e){let t,n,r,i,o,s;t=new nw({props:{$$slots:{title:[BE]},$$scope:{ctx:e}}});const a=[OE,NE],c=[];function u(e,t){return"loading"===e[1].state?0:"loaded"===e[1].state?1:-1}return~(i=u(e))&&(o=c[i]=a[i](e)),{c(){_e(t.$$.fragment),n=$(),r=R("main"),o&&o.c(),D(r,"class","p-4")},m(e,o){Ae(t,e,o),N(e,n,o),N(e,r,o),~i&&c[i].m(r,null),s=!0},p(e,n){const s={};32768&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);let f=i;i=u(e),i!==f&&(o&&(he(),me(c[f],1,1,(()=>{c[f]=null})),pe()),~i?(o=c[i],o||(o=c[i]=a[i](e),o.c()),ge(o,1),o.m(r,null)):o=null)},i(e){s||(ge(t.$$.fragment,e),ge(o),s=!0)},o(e){me(t.$$.fragment,e),me(o),s=!1},d(e){Te(t,e),e&&O(n),e&&O(r),~i&&c[i].d()}}}function SE(e){let t,n,r,i,o,s;t=new nw({props:{$$slots:{actions:[kE],title:[IE]},$$scope:{ctx:e}}});const a=[$E,LE],c=[];function u(e,t){return"loaded"===e[1].state?0:"loading"===e[1].state?1:-1}return~(i=u(e))&&(o=c[i]=a[i](e)),{c(){_e(t.$$.fragment),n=$(),r=R("main"),o&&o.c(),D(r,"class","p-4")},m(e,o){Ae(t,e,o),N(e,n,o),N(e,r,o),~i&&c[i].m(r,null),s=!0},p(e,n){const s={};32824&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);let f=i;i=u(e),i===f?~i&&c[i].p(e,n):(o&&(he(),me(c[f],1,1,(()=>{c[f]=null})),pe()),~i?(o=c[i],o?o.p(e,n):(o=c[i]=a[i](e),o.c()),ge(o,1),o.m(r,null)):o=null)},i(e){s||(ge(t.$$.fragment,e),ge(o),s=!0)},o(e){me(t.$$.fragment,e),me(o),s=!1},d(e){Te(t,e),e&&O(n),e&&O(r),~i&&c[i].d()}}}function BE(t){let n;return{c(){n=R("span"),n.textContent="Edit note",D(n,"slot","title")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function NE(t){let n;return{c(){n=R("div"),n.textContent="Could not find note.",D(n,"class","alert alert-error")},m(e,t){N(e,n,t)},i:e,o:e,d(e){e&&O(n)}}}function OE(e){let t,n,r;return t=new xg({}),{c(){_e(t.$$.fragment),n=L("\n      Loading note...")},m(e,i){Ae(t,e,i),N(e,n,i),r=!0},i(e){r||(ge(t.$$.fragment,e),r=!0)},o(e){me(t.$$.fragment,e),r=!1},d(e){Te(t,e),e&&O(n)}}}function IE(t){let n;return{c(){n=R("span"),n.textContent="Edit note",D(n,"slot","title")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function RE(e){let t,n,r;return n=new vE({}),{c(){t=R("span"),_e(n.$$.fragment),D(t,"class","w-6 h-6 p-1")},m(e,i){N(e,t,i),Ae(n,t,null),r=!0},i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){me(n.$$.fragment,e),r=!1},d(e){e&&O(t),Te(n)}}}function kE(e){let t,n,r,i,o,s,a,c,u=e[4]?"Deleting...":"",f=!e[4]&&RE();return{c(){t=R("button"),f&&f.c(),n=$(),r=L(u),D(t,"slot","actions"),D(t,"class",i="btn btn-ghost "+(e[4]?"loading":"")+" "+(e[5]?"":"hidden")),t.disabled=o=e[3]||e[4]},m(i,o){N(i,t,o),f&&f.m(t,null),T(t,n),T(t,r),s=!0,a||(c=U(t,"click",e[7]),a=!0)},p(e,a){e[4]?f&&(he(),me(f,1,1,(()=>{f=null})),pe()):f?16&a&&ge(f,1):(f=RE(),f.c(),ge(f,1),f.m(t,n)),(!s||16&a)&&u!==(u=e[4]?"Deleting...":"")&&F(r,u),(!s||48&a&&i!==(i="btn btn-ghost "+(e[4]?"loading":"")+" "+(e[5]?"":"hidden")))&&D(t,"class",i),(!s||24&a&&o!==(o=e[3]||e[4]))&&(t.disabled=o)},i(e){s||(ge(f),s=!0)},o(e){me(f),s=!1},d(e){e&&O(t),f&&f.d(),a=!1,c()}}}function LE(t){let n;return{c(){n=L("Loading notes...")},m(e,t){N(e,n,t)},p:e,i:e,o:e,d(e){e&&O(n)}}}function $E(e){let t,n,r,i,o,s,a,c,u,f,l,d,h,p,g,m=e[3]?"Saving...":"Save";return t=new iE({props:{editor:e[2],disabled:e[3]||e[4],class:"mb-3"}}),r=new uE({props:{tags:e[0].tags,disabled:e[3]||e[4]}}),r.$on("add",e[11]),r.$on("remove",e[12]),d=new mE({props:{editedNote:e[0],ownedByMe:e[5]}}),{c(){_e(t.$$.fragment),n=$(),_e(r.$$.fragment),i=$(),o=R("button"),s=L(m),u=$(),f=R("hr"),l=$(),_e(d.$$.fragment),D(o,"class",a="btn mt-4 btn-primary "+(e[3]?"loading":"")),o.disabled=c=e[3]||e[4],D(f,"class","mt-10")},m(a,c){Ae(t,a,c),N(a,n,c),Ae(r,a,c),N(a,i,c),N(a,o,c),T(o,s),N(a,u,c),N(a,f,c),N(a,l,c),Ae(d,a,c),h=!0,p||(g=U(o,"click",e[6]),p=!0)},p(e,n){const i={};4&n&&(i.editor=e[2]),24&n&&(i.disabled=e[3]||e[4]),t.$set(i);const u={};1&n&&(u.tags=e[0].tags),24&n&&(u.disabled=e[3]||e[4]),r.$set(u),(!h||8&n)&&m!==(m=e[3]?"Saving...":"Save")&&F(s,m),(!h||8&n&&a!==(a="btn mt-4 btn-primary "+(e[3]?"loading":"")))&&D(o,"class",a),(!h||24&n&&c!==(c=e[3]||e[4]))&&(o.disabled=c);const f={};1&n&&(f.editedNote=e[0]),32&n&&(f.ownedByMe=e[5]),d.$set(f)},i(e){h||(ge(t.$$.fragment,e),ge(r.$$.fragment,e),ge(d.$$.fragment,e),h=!0)},o(e){me(t.$$.fragment,e),me(r.$$.fragment,e),me(d.$$.fragment,e),h=!1},d(e){Te(t,e),e&&O(n),Te(r,e),e&&O(i),e&&O(o),e&&O(u),e&&O(f),e&&O(l),Te(d,e),p=!1,g()}}}function PE(e){let t,n,r,i;const o=[SE,TE],s=[];function a(e,t){return e[0]?0:1}return t=a(e),n=s[t]=o[t](e),{c(){n.c(),r=P()},m(e,n){s[t].m(e,n),N(e,r,n),i=!0},p(e,[i]){let c=t;t=a(e),t===c?s[t].p(e,i):(he(),me(s[c],1,1,(()=>{s[c]=null})),pe(),n=s[t],n?n.p(e,i):(n=s[t]=o[t](e),n.c()),ge(n,1),n.m(r.parentNode,r))},i(e){i||(ge(n),i=!0)},o(e){me(n),i=!1},d(e){s[t].d(e),e&&O(r)}}}function UE(e,t,n){let r,i;f(e,Lg,(e=>n(1,r=e))),f(e,gg,(e=>n(13,i=e)));let o,s,a,{currentRoute:c}=t,u=!1,l=!1;function d(e){n(0,o.tags=[...o.tags,e],o)}function h(e){n(0,o.tags=o.tags.filter((t=>t!==e)),o)}return e.$$set=e=>{"currentRoute"in e&&n(10,c=e.currentRoute)},e.$$.update=()=>{if(1027&e.$$.dirty&&"loaded"===r.state&&!o){const e=r.list.find((e=>e.id.toString()===c.namedParams.id));e&&(n(0,o=Object.assign({},e)),n(2,s=new Cb({modules:{placeholder:wb("Start typing...")},html:o.content})),n(5,a=e.owner==function(){if("initialized"!==i.state)throw new Error("expected the auth.state to be initialized");return i.client.getIdentity().getPrincipal().toString()}()))}},[o,r,s,u,l,a,async function(){if("initialized"!==i.state)return;const e=AE.sanitize(s.getHTML());n(3,u=!0),await async function(e,t,n){const r=await Ig(e,n);await t.update_note(e.id,r.encrypted_text)}(Object.assign(Object.assign({},o),{content:e,title:kg(e),updatedAt:Date.now()}),i.actor,i.crypto).catch((e=>{Up(e,"Could not update note.")})).finally((()=>{n(3,u=!1)})),Pp({type:"success",message:"Note saved successfully"}),await Ug(i.actor,i.crypto).catch((e=>Up(e,"Could not refresh notes.")))},async function(){"initialized"===i.state&&(n(4,l=!0),await i.actor.delete_note(o.id).catch((e=>{n(4,l=!1),Up(e,"Could not delete note.")})),await Ug(i.actor,i.crypto).catch((e=>Up(e,"Could not refresh notes."))).finally((()=>{Pp({type:"success",message:"Note deleted successfully"}),og("/notes")})))},d,h,c,e=>d(e.detail),e=>h(e.detail)]}class DE extends Ne{constructor(e){super(),Be(this,e,UE,PE,a,{currentRoute:10})}}let FE={content:"",tags:[]};try{const e=JSON.parse(localStorage.getItem("draft"));"content"in e&&"tags"in e&&(FE=e)}catch(Nc){}const CE=Re(FE);function ME(t){let n;return{c(){n=R("span"),n.textContent="New note",D(n,"slot","title")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function jE(e){let t,n,r,i,s,a,c,u,f,l,d,h,p,g=e[0]?"Adding...":"Add note";return t=new nw({props:{$$slots:{title:[ME]},$$scope:{ctx:e}}}),i=new iE({props:{editor:e[2],class:"mb-3",disabled:e[0]}}),a=new uE({props:{tags:e[1],disabled:e[0]}}),a.$on("add",e[7]),a.$on("remove",e[8]),{c(){_e(t.$$.fragment),n=$(),r=R("main"),_e(i.$$.fragment),s=$(),_e(a.$$.fragment),c=$(),u=R("button"),f=L(g),D(u,"class",l="btn mt-6 btn-primary "+(e[0]?"loading":"")),u.disabled=e[0],D(r,"class","p-4")},m(o,l){Ae(t,o,l),N(o,n,l),N(o,r,l),Ae(i,r,null),T(r,s),Ae(a,r,null),T(r,c),T(r,u),T(u,f),d=!0,h||(p=[U(window,"beforeunload",e[4]),U(u,"click",e[3])],h=!0)},p(e,[n]){const r={};2048&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r);const o={};1&n&&(o.disabled=e[0]),i.$set(o);const s={};2&n&&(s.tags=e[1]),1&n&&(s.disabled=e[0]),a.$set(s),(!d||1&n)&&g!==(g=e[0]?"Adding...":"Add note")&&F(f,g),(!d||1&n&&l!==(l="btn mt-6 btn-primary "+(e[0]?"loading":"")))&&D(u,"class",l),(!d||1&n)&&(u.disabled=e[0])},i(e){d||(ge(t.$$.fragment,e),ge(i.$$.fragment,e),ge(a.$$.fragment,e),d=!0)},o(e){me(t.$$.fragment,e),me(i.$$.fragment,e),me(a.$$.fragment,e),d=!1},d(e){Te(t,e),e&&O(n),e&&O(r),Te(i),Te(a),h=!1,o(p)}}}function qE(e,t,n){let r,i;f(e,gg,(e=>n(9,r=e))),f(e,CE,(e=>n(10,i=e)));let o=!1,s=i.tags;const a=new Cb({modules:{placeholder:wb("Start typing...")},html:i.content});function c(){CE.set({content:AE.sanitize(a.getHTML()),tags:s})}function u(e){n(1,s=[...s,e])}function l(e){n(1,s=s.filter((t=>t!==e)))}Z(c);return[o,s,a,async function(){"initialized"===r.state&&(n(0,o=!0),await async function(e,t,n){const r=await t.create_note();e.id=r;const i=(await Ig(e,n)).encrypted_text;await t.update_note(r,i)}(function(e,t,n){const r=kg(e),i=Date.now();return{id:BigInt(0),title:r,content:e,createdAt:i,updatedAt:i,tags:t,owner:n.toString(),users:[""]}}(AE.sanitize(a.getHTML()),s,r.client.getIdentity().getPrincipal()),r.actor,r.crypto).catch((e=>{Up(e,"Could not add note.")})).finally((()=>{n(0,o=!1)})),a.setHTML(""),n(1,s=[]),Pp({type:"success",message:"Note added successfully"}),Ug(r.actor,r.crypto).catch((e=>Up(e,"Could not refresh notes."))))},c,u,l,e=>u(e.detail),e=>l(e.detail)]}CE.subscribe((e=>{localStorage.setItem("draft",JSON.stringify(e))})),gg.subscribe((e=>{"anonymous"===e.state&&CE.set(FE)}));class VE extends Ne{constructor(e){super(),Be(this,e,qE,jE,a,{})}}function zE(e,t,n){const r=e.slice();return r[4]=t[n],r}function HE(t){let n;return{c(){n=R("span"),n.textContent="Unnamed note",D(n,"class","text-gray-500")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function GE(e){let t,n=e[0].title+"";return{c(){t=L(n)},m(e,n){N(e,t,n)},p(e,r){1&r&&n!==(n=e[0].title+"")&&F(t,n)},d(e){e&&O(t)}}}function KE(e){let t,n=e[0].tags,r=[];for(let t=0;t<n.length;t+=1)r[t]=WE(zE(e,n,t));return{c(){t=R("div");for(let e=0;e<r.length;e+=1)r[e].c();D(t,"class","mt-4 ")},m(e,n){N(e,t,n);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null)},p(e,i){if(5&i){let o;for(n=e[0].tags,o=0;o<n.length;o+=1){const s=zE(e,n,o);r[o]?r[o].p(s,i):(r[o]=WE(s),r[o].c(),r[o].m(t,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=n.length}},d(e){e&&O(t),I(r,e)}}}function WE(e){let t,n,r,i,o,s=e[4]+"";function a(...t){return e[3](e[4],...t)}return{c(){t=R("button"),n=L(s),r=$(),D(t,"class","btn btn-outline btn-sm mr-2 mb-2 pointer-events-auto")},m(e,s){N(e,t,s),T(t,n),T(t,r),i||(o=U(t,"click",a),i=!0)},p(t,r){e=t,1&r&&s!==(s=e[4]+"")&&F(n,s)},d(e){e&&O(t),i=!1,o()}}}function ZE(t){let n,r,i,o,s,a,c;function u(e,t){return e[0].title?GE:HE}let f=u(t),l=f(t),d=t[0].tags.length>0&&KE(t);return{c(){n=R("a"),r=R("div"),i=R("h2"),l.c(),o=$(),s=L(t[1]),a=$(),d&&d.c(),D(i,"class","text-lg font-bold mb-2 line-clamp-3"),D(r,"class","pointer-events-none"),D(n,"class","p-4 rounded-md border border-base-300 dark:border-base-300 bg-base dark:bg-base-100 hover:-translate-y-2 transition-transform"),D(n,"href",c=`/notes/edit/${t[0].id}`)},m(e,t){N(e,n,t),T(n,r),T(r,i),l.m(i,null),T(r,o),T(r,s),T(r,a),d&&d.m(r,null)},p(e,[t]){f===(f=u(e))&&l?l.p(e,t):(l.d(1),l=f(e),l&&(l.c(),l.m(i,null))),2&t&&F(s,e[1]),e[0].tags.length>0?d?d.p(e,t):(d=KE(e),d.c(),d.m(r,null)):d&&(d.d(1),d=null),1&t&&c!==(c=`/notes/edit/${e[0].id}`)&&D(n,"href",c)},i:e,o:e,d(e){e&&O(n),l.d(),d&&d.d()}}}function YE(e,t,n){let r,{note:i}=t;const o=Y();return e.$$set=e=>{"note"in e&&n(0,i=e.note)},e.$$.update=()=>{1&e.$$.dirty&&n(1,r=function(e,t=50){const n=document.createElement("div");n.innerHTML=e.content;let r=n.innerText;const i=Rg(n);return i&&(r=r.replace(i,"")),r.slice(0,t)+(r.length>t?"...":"")}(i))},[i,r,o,(e,t)=>{o("tagclick",e),t.stopPropagation(),t.preventDefault()}]}class XE extends Ne{constructor(e){super(),Be(this,e,YE,ZE,a,{note:0})}}function JE(e,t,n){const r=e.slice();return r[6]=t[n],r}function QE(t){let n;return{c(){n=R("span"),n.textContent="Your notes",D(n,"slot","title")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function ex(e){let t;return{c(){t=R("a"),t.textContent="New Note",D(t,"class","btn btn-primary"),D(t,"href","/")},m(e,n){N(e,t,n)},d(e){e&&O(t)}}}function tx(e){let t,n="loaded"===e[1].state&&e[1].list.length>0&&ex();return{c(){n&&n.c(),t=P()},m(e,r){n&&n.m(e,r),N(e,t,r)},p(e,r){"loaded"===e[1].state&&e[1].list.length>0?n||(n=ex(),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&O(t)}}}function nx(t){let n;return{c(){n=R("div"),n.textContent="Could not load notes.",D(n,"class","alert alert-error")},m(e,t){N(e,n,t)},p:e,i:e,o:e,d(e){e&&O(n)}}}function rx(e){let t,n,r,i;const o=[sx,ox],s=[];function a(e,t){return e[1].list.length>0?0:1}return t=a(e),n=s[t]=o[t](e),{c(){n.c(),r=P()},m(e,n){s[t].m(e,n),N(e,r,n),i=!0},p(e,i){let c=t;t=a(e),t===c?s[t].p(e,i):(he(),me(s[c],1,1,(()=>{s[c]=null})),pe(),n=s[t],n?n.p(e,i):(n=s[t]=o[t](e),n.c()),ge(n,1),n.m(r.parentNode,r))},i(e){i||(ge(n),i=!0)},o(e){me(n),i=!1},d(e){s[t].d(e),e&&O(r)}}}function ix(t){let n,r,i;return n=new xg({}),{c(){_e(n.$$.fragment),r=L("\n    Loading notes...")},m(e,t){Ae(n,e,t),N(e,r,t),i=!0},p:e,i(e){i||(ge(n.$$.fragment,e),i=!0)},o(e){me(n.$$.fragment,e),i=!1},d(e){Te(n,e),e&&O(r)}}}function ox(t){let n,r,i;return{c(){n=R("div"),n.textContent="You don't have any notes.",r=$(),i=R("div"),i.innerHTML='<a href="/" class="btn btn-primary">Add a note</a>',D(n,"class","text-center pt-8 italic"),D(i,"class","text-center pt-8 ")},m(e,t){N(e,n,t),N(e,r,t),N(e,i,t)},p:e,i:e,o:e,d(e){e&&O(n),e&&O(r),e&&O(i)}}}function sx(e){let t,n,r,i,o,s,a,c,u=[],f=new Map,l=e[2];const d=e=>e[6].id;for(let t=0;t<l.length;t+=1){let n=JE(e,l,t),r=d(n);f.set(r,u[t]=ax(r,n))}return{c(){t=R("div"),n=R("input"),i=$(),o=R("div");for(let e=0;e<u.length;e+=1)u[e].c();D(n,"class",r="bg-transparent text-base "+(e[0].length>0?"border":"")+" rounded-lg h-8 px-3"),D(n,"placeholder","Filter notes..."),D(t,"class","mb-6"),D(o,"class","grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 max-w-7xl")},m(r,f){N(r,t,f),T(t,n),C(n,e[0]),N(r,i,f),N(r,o,f);for(let e=0;e<u.length;e+=1)u[e]&&u[e].m(o,null);s=!0,a||(c=U(n,"input",e[4]),a=!0)},p(e,t){(!s||1&t&&r!==(r="bg-transparent text-base "+(e[0].length>0?"border":"")+" rounded-lg h-8 px-3"))&&D(n,"class",r),1&t&&n.value!==e[0]&&C(n,e[0]),5&t&&(l=e[2],he(),u=ve(u,t,d,1,e,l,f,o,we,ax,null,JE),pe())},i(e){if(!s){for(let e=0;e<l.length;e+=1)ge(u[e]);s=!0}},o(e){for(let e=0;e<u.length;e+=1)me(u[e]);s=!1},d(e){e&&O(t),e&&O(i),e&&O(o);for(let e=0;e<u.length;e+=1)u[e].d();a=!1,c()}}}function ax(e,t){let n,r,i;return r=new XE({props:{note:t[6]}}),r.$on("tagclick",t[5]),{key:e,first:null,c(){n=P(),_e(r.$$.fragment),this.first=n},m(e,t){N(e,n,t),Ae(r,e,t),i=!0},p(e,n){t=e;const i={};4&n&&(i.note=t[6]),r.$set(i)},i(e){i||(ge(r.$$.fragment,e),i=!0)},o(e){me(r.$$.fragment,e),i=!1},d(e){e&&O(n),Te(r,e)}}}function cx(e){let t,n,r,i,o,s;t=new nw({props:{$$slots:{actions:[tx],title:[QE]},$$scope:{ctx:e}}});const a=[ix,rx,nx],c=[];function u(e,t){return"loading"===e[1].state?0:"loaded"===e[1].state?1:"error"===e[1].state?2:-1}return~(i=u(e))&&(o=c[i]=a[i](e)),{c(){_e(t.$$.fragment),n=$(),r=R("main"),o&&o.c(),D(r,"class","p-4")},m(e,o){Ae(t,e,o),N(e,n,o),N(e,r,o),~i&&c[i].m(r,null),s=!0},p(e,[n]){const s={};514&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);let f=i;i=u(e),i===f?~i&&c[i].p(e,n):(o&&(he(),me(c[f],1,1,(()=>{c[f]=null})),pe()),~i?(o=c[i],o?o.p(e,n):(o=c[i]=a[i](e),o.c()),ge(o,1),o.m(r,null)):o=null)},i(e){s||(ge(t.$$.fragment,e),ge(o),s=!0)},o(e){me(t.$$.fragment,e),me(o),s=!1},d(e){Te(t,e),e&&O(n),e&&O(r),~i&&c[i].d()}}}function ux(e,t,n){let r,i;f(e,Lg,(e=>n(1,i=e)));let o,s="";return e.$$.update=()=>{2&e.$$.dirty&&n(3,r="loaded"===i.state?i.list.map((e=>{const t=document.createElement("div");t.innerHTML=e.content;return[t.innerText,...e.tags].join("/#delimiter#/").toLowerCase()})):[]),11&e.$$.dirty&&"loaded"===i.state&&(s.length>0?n(2,o=i.list.filter(((e,t)=>r[t].includes(s.toLowerCase())))):n(2,o=i.list))},[s,i,o,r,function(){s=this.value,n(0,s)},e=>n(0,s=e.detail)]}class fx extends Ne{constructor(e){super(),Be(this,e,ux,cx,a,{})}}function lx(t){let n;return{c(){n=k("path"),D(n,"d","M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-32 252c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92H92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function dx(e){let t,r;const i=[{viewBox:"0 0 448 512"},e[0]];let o={$$slots:{default:[lx]},$$scope:{ctx:e}};for(let e=0;e<i.length;e+=1)o=n(o,i[e]);return t=new Dv({props:o}),{c(){_e(t.$$.fragment)},m(e,n){Ae(t,e,n),r=!0},p(e,[n]){const r=1&n?Ee(i,[i[0],xe(e[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){r||(ge(t.$$.fragment,e),r=!0)},o(e){me(t.$$.fragment,e),r=!1},d(e){Te(t,e)}}}function hx(e,t,r){return e.$$set=e=>{r(0,t=n(n({},t),m(e)))},[t=m(t)]}class px extends Ne{constructor(e){super(),Be(this,e,hx,dx,a,{})}}function gx(t){let n;return{c(){n=k("path"),D(n,"d","M448 360V24c0-13.3-10.7-24-24-24H96C43 0 0 43 0 96v320c0 53 43 96 96 96h328c13.3 0 24-10.7 24-24v-16c0-7.5-3.5-14.3-8.9-18.7-4.2-15.4-4.2-59.3 0-74.7 5.4-4.3 8.9-11.1 8.9-18.6zM128 134c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm0 64c0-3.3 2.7-6 6-6h212c3.3 0 6 2.7 6 6v20c0 3.3-2.7 6-6 6H134c-3.3 0-6-2.7-6-6v-20zm253.4 250H96c-17.7 0-32-14.3-32-32 0-17.6 14.4-32 32-32h285.4c-1.9 17.1-1.9 46.9 0 64z")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function mx(e){let t,r;const i=[{viewBox:"0 0 448 512"},e[0]];let o={$$slots:{default:[gx]},$$scope:{ctx:e}};for(let e=0;e<i.length;e+=1)o=n(o,i[e]);return t=new Dv({props:o}),{c(){_e(t.$$.fragment)},m(e,n){Ae(t,e,n),r=!0},p(e,[n]){const r=1&n?Ee(i,[i[0],xe(e[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){r||(ge(t.$$.fragment,e),r=!0)},o(e){me(t.$$.fragment,e),r=!1},d(e){Te(t,e)}}}function yx(e,t,r){return e.$$set=e=>{r(0,t=n(n({},t),m(e)))},[t=m(t)]}class bx extends Ne{constructor(e){super(),Be(this,e,yx,mx,a,{})}}function wx(t){let n;return{c(){n=k("path"),D(n,"d","M624 448h-80V113.45C544 86.19 522.47 64 496 64H384v64h96v384h144c8.84 0 16-7.16 16-16v-32c0-8.84-7.16-16-16-16zM312.24 1.01l-192 49.74C105.99 54.44 96 67.7 96 82.92V448H16c-8.84 0-16 7.16-16 16v32c0 8.84 7.16 16 16 16h336V33.18c0-21.58-19.56-37.41-39.76-32.17zM264 288c-13.25 0-24-14.33-24-32s10.75-32 24-32 24 14.33 24 32-10.75 32-24 32z")},m(e,t){N(e,n,t)},p:e,d(e){e&&O(n)}}}function vx(e){let t,r;const i=[{viewBox:"0 0 640 512"},e[0]];let o={$$slots:{default:[wx]},$$scope:{ctx:e}};for(let e=0;e<i.length;e+=1)o=n(o,i[e]);return t=new Dv({props:o}),{c(){_e(t.$$.fragment)},m(e,n){Ae(t,e,n),r=!0},p(e,[n]){const r=1&n?Ee(i,[i[0],xe(e[0])]):{};2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){r||(ge(t.$$.fragment,e),r=!0)},o(e){me(t.$$.fragment,e),r=!1},d(e){Te(t,e)}}}function Ex(e,t,r){return e.$$set=e=>{r(0,t=n(n({},t),m(e)))},[t=m(t)]}class xx extends Ne{constructor(e){super(),Be(this,e,Ex,vx,a,{})}}function _x(e){const t=e-1;return t*t*t+1}function Ax(e,{delay:n=0,duration:r=400,easing:i=t}={}){const o=+getComputedStyle(e).opacity;return{delay:n,duration:r,easing:i,css:e=>"opacity: "+e*o}}function Tx(e,{delay:t=0,duration:n=400,easing:r=_x,x:i=0,y:o=0,opacity:s=0}={}){const a=getComputedStyle(e),c=+a.opacity,u="none"===a.transform?"":a.transform,f=c*(1-s),[l,d]=b(i),[h,p]=b(o);return{delay:t,duration:n,easing:r,css:(e,t)=>`\n\t\t\ttransform: ${u} translate(${(1-e)*l}${d}, ${(1-e)*h}${p});\n\t\t\topacity: ${c-f*t}`}}function Sx(t){let n,r,i,o,s,a,c,u,f;return i=new vg({}),{c(){n=R("div"),r=R("p"),_e(i.$$.fragment),o=$(),s=R("button"),s.textContent="I understand",D(r,"class","opacity-90 sm:flex-1"),D(s,"class","btn btn-outline btn-xs sm:btn-sm sm:self-start mt-4 sm:mt-0 sm:ml-4 opacity-90"),D(n,"class","sticky bottom-0 p-4 text-xs bg-base-300 mt-4 sm:flex")},m(e,a){N(e,n,a),T(n,r),Ae(i,r,null),T(n,o),T(n,s),c=!0,u||(f=U(s,"click",t[1]),u=!0)},p:e,i(e){c||(ge(i.$$.fragment,e),a&&a.end(1),c=!0)},o(e){me(i.$$.fragment,e),a=be(n,Tx,{y:50}),c=!1},d(e){e&&O(n),Te(i),e&&a&&a.end(),u=!1,f()}}}function Bx(e){let t,n,r=!e[0]&&Sx(e);return{c(){r&&r.c(),t=P()},m(e,i){r&&r.m(e,i),N(e,t,i),n=!0},p(e,[n]){e[0]?r&&(he(),me(r,1,1,(()=>{r=null})),pe()):r?(r.p(e,n),1&n&&ge(r,1)):(r=Sx(e),r.c(),ge(r,1),r.m(t.parentNode,t))},i(e){n||(ge(r),n=!0)},o(e){me(r),n=!1},d(e){r&&r.d(e),e&&O(t)}}}function Nx(e,t,n){let r=!!window.localStorage.getItem("disclaimer-dismissed");return[r,function(){window.localStorage.setItem("disclaimer-dismissed","yes"),n(0,r=!0)}]}class Ox extends Ne{constructor(e){super(),Be(this,e,Nx,Bx,a,{})}}function Ix(e){let t,n,r,i,o,s,a,c,u,f,d,m,y,b,w,v,E,x,_,A,S,B,I,k,P,C,M,j,q,V,z,H,G,K,W,Z,Y,X,J,Q,ee,te,ne,re,ie,oe=e[0].client.getIdentity().getPrincipal()+"";const se=e[2].default,ae=l(se,e,e[1],null);return a=new Ox({}),P=new px({}),z=new bx({}),J=new xx({}),{c(){t=R("div"),n=R("input"),r=$(),i=R("div"),o=R("div"),ae&&ae.c(),s=$(),_e(a.$$.fragment),c=$(),u=R("div"),f=R("label"),d=$(),m=R("aside"),y=R("div"),y.textContent="Encrypted Notes",b=$(),w=R("div"),v=R("div"),v.textContent="My Principal:",E=$(),x=R("div"),_=L(oe),A=$(),S=R("ul"),B=R("li"),I=R("a"),k=R("span"),_e(P.$$.fragment),C=L("\n            New note"),M=$(),j=R("li"),q=R("a"),V=R("span"),_e(z.$$.fragment),H=L("\n            Your notes"),G=$(),K=R("li"),W=$(),Z=R("li"),Y=R("button"),X=R("span"),_e(J.$$.fragment),Q=L("\n            Log out"),ee=$(),te=R("div"),te.innerHTML='<img src="/img/ic-badge-powered-by-crypto_transparent-white-text.png" alt="Powered by the Internet Computer" class="hidden dark:inline "/> \n        <img src="/img/ic-badge-powered-by-crypto_transparent-dark-text.png" alt="Powered by the Internet Computer" class="dark:hidden inline "/>',D(n,"id","my-drawer-3"),D(n,"type","checkbox"),D(n,"class","drawer-toggle"),D(o,"class","flex-1"),D(i,"class","flex flex-col drawer-content lg:!z-[1000]"),D(f,"for","my-drawer-3"),D(f,"class","drawer-overlay"),D(y,"class","sticky h-16 py-4 pl-5 text-2xl font-bold border-b border-base-300 text-primary dark:text-white"),D(v,"class","pl-4"),D(x,"class","pl-4"),D(w,"class","border-b"),D(k,"class","w-6 h-6 p-1 mr-2"),D(I,"href","/"),D(V,"class","w-6 h-6 p-1 mr-2"),D(q,"href","/notes"),D(K,"class","flex-1"),D(X,"class","w-6 h-6 p-1 mr-2"),D(S,"class","p-4 overflow-y-auto menu w-full bg-base-100 flex-1 flex flex-col"),D(te,"class","px-5 pb-4"),D(m,"class","flex flex-col justify-between border-r border-base-300 bg-base-100 text-base-content w-64 sm:w-80 "),D(u,"class","drawer-side"),D(t,"class","bg-base-200 drawer drawer-mobile min-h-screen")},m(l,h){N(l,t,h),T(t,n),T(t,r),T(t,i),T(i,o),ae&&ae.m(o,null),T(i,s),Ae(a,i,null),T(t,c),T(t,u),T(u,f),T(u,d),T(u,m),T(m,y),T(m,b),T(m,w),T(w,v),T(w,E),T(w,x),T(x,_),T(m,A),T(m,S),T(S,B),T(B,I),T(I,k),Ae(P,k,null),T(I,C),T(S,M),T(S,j),T(j,q),T(q,V),Ae(z,V,null),T(q,H),T(S,G),T(S,K),T(S,W),T(S,Z),T(Z,Y),T(Y,X),Ae(J,X,null),T(Y,Q),T(m,ee),T(m,te),ne=!0,re||(ie=U(Y,"click",e[3]),re=!0)},p(e,[t]){ae&&ae.p&&(!ne||2&t)&&p(ae,se,e,e[1],ne?h(se,e[1],t,null):g(e[1]),null),(!ne||1&t)&&oe!==(oe=e[0].client.getIdentity().getPrincipal()+"")&&F(_,oe)},i(e){ne||(ge(ae,e),ge(a.$$.fragment,e),ge(P.$$.fragment,e),ge(z.$$.fragment,e),ge(J.$$.fragment,e),ne=!0)},o(e){me(ae,e),me(a.$$.fragment,e),me(P.$$.fragment,e),me(z.$$.fragment,e),me(J.$$.fragment,e),ne=!1},d(e){e&&O(t),ae&&ae.d(e),Te(a),Te(P),Te(z),Te(J),re=!1,ie()}}}function Rx(e,t,n){let r;f(e,gg,(e=>n(0,r=e)));let{$$slots:i={},$$scope:o}=t;return e.$$set=e=>{"$$scope"in e&&n(1,o=e.$$scope)},[r,o,i,()=>yg()]}class kx extends Ne{constructor(e){super(),Be(this,e,Rx,Ix,a,{})}}function Lx(t){let n,r;return n=new pg({props:{routes:t[0]}}),{c(){_e(n.$$.fragment)},m(e,t){Ae(n,e,t),r=!0},p:e,i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){me(n.$$.fragment,e),r=!1},d(e){Te(n,e)}}}function $x(e){let t,n;return t=new kx({props:{$$slots:{default:[Lx]},$$scope:{ctx:e}}}),{c(){_e(t.$$.fragment)},m(e,r){Ae(t,e,r),n=!0},p(e,[n]){const r={};2&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){me(t.$$.fragment,e),n=!1},d(e){Te(t,e)}}}function Px(e){return[[{name:"/",component:VE},{name:"/notes",nestedRoutes:[{name:"index",component:fx},{name:"edit/:id",component:DE}]}]]}class Ux extends Ne{constructor(e){super(),Be(this,e,Px,$x,a,{})}}function Dx(e,t,n){const r=e.slice();return r[2]=t[n],r}function Fx(n,r){let i,o,a,c,u,f,l,d,h=r[2].message+"";return{key:n,first:null,c(){i=R("div"),o=R("p"),a=L(h),c=$(),D(i,"class",u="alert "+r[1][r[2].type]+" bg-opacity-100 text-white"),this.first=i},m(e,t){N(e,i,t),T(i,o),T(o,a),T(i,c),d=!0},p(e,t){r=e,(!d||1&t)&&h!==(h=r[2].message+"")&&F(a,h),(!d||1&t&&u!==(u="alert "+r[1][r[2].type]+" bg-opacity-100 text-white"))&&D(i,"class",u)},i(n){d||(re((()=>{d&&(l&&l.end(1),f=function(n,r,i){const o={direction:"in"};let a,c,u=r(n,i,o),f=!1,l=0;function d(){a&&G(n,a)}function h(){const{delay:r=0,duration:i=300,easing:o=t,tick:s=e,css:h}=u||ye;h&&(a=H(n,0,1,i,r,o,h,l++)),s(0,1);const p=v()+r,g=p+i;c&&c.abort(),f=!0,re((()=>fe(n,!0,"start"))),c=A((e=>{if(f){if(e>=g)return s(1,0),fe(n,!0,"end"),d(),f=!1;if(e>=p){const t=o((e-p)/i);s(t,1-t)}}return f}))}let p=!1;return{start(){p||(p=!0,G(n),s(u)?(u=u(o),ue().then(h)):h())},invalidate(){p=!1},end(){f&&(d(),f=!1)}}}(i,Tx,{x:100,duration:200}),f.start())})),d=!0)},o(e){f&&f.invalidate(),l=be(i,Ax,{}),d=!1},d(e){e&&O(i),e&&l&&l.end()}}}function Cx(e){let t,n,r=[],i=new Map,o=e[0];const s=e=>e[2].id;for(let t=0;t<o.length;t+=1){let n=Dx(e,o,t),a=s(n);i.set(a,r[t]=Fx(a,n))}return{c(){t=R("div");for(let e=0;e<r.length;e+=1)r[e].c();D(t,"class","absolute right-4 bottom-4 flex flex-col max-w-xs space-y-4")},m(e,i){N(e,t,i);for(let e=0;e<r.length;e+=1)r[e]&&r[e].m(t,null);n=!0},p(e,[n]){3&n&&(o=e[0],he(),r=ve(r,n,s,1,e,o,i,t,we,Fx,null,Dx),pe())},i(e){if(!n){for(let e=0;e<o.length;e+=1)ge(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)me(r[e]);n=!1},d(e){e&&O(t);for(let e=0;e<r.length;e+=1)r[e].d()}}}function Mx(e,t,n){let r;f(e,$p,(e=>n(0,r=e)));return[r,{info:"alert-info",error:"alert-error",success:"alert-success"}]}class jx extends Ne{constructor(e){super(),Be(this,e,Mx,Cx,a,{})}}function qx(e){let t,n;return t=new Og({props:{auth:e[0]}}),{c(){_e(t.$$.fragment)},m(e,r){Ae(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.auth=e[0]),t.$set(r)},i(e){n||(ge(t.$$.fragment,e),n=!0)},o(e){me(t.$$.fragment,e),n=!1},d(e){Te(t,e)}}}function Vx(t){let n,r;return n=new Ux({}),{c(){_e(n.$$.fragment)},m(e,t){Ae(n,e,t),r=!0},p:e,i(e){r||(ge(n.$$.fragment,e),r=!0)},o(e){me(n.$$.fragment,e),r=!1},d(e){Te(n,e)}}}function zx(e){let t,n,r,i,o;const s=[Vx,qx],a=[];function c(e,t){return"initialized"===e[0].state?0:1}return t=c(e),n=a[t]=s[t](e),i=new jx({}),{c(){n.c(),r=$(),_e(i.$$.fragment)},m(e,n){a[t].m(e,n),N(e,r,n),Ae(i,e,n),o=!0},p(e,[i]){let o=t;t=c(e),t===o?a[t].p(e,i):(he(),me(a[o],1,1,(()=>{a[o]=null})),pe(),n=a[t],n?n.p(e,i):(n=a[t]=s[t](e),n.c()),ge(n,1),n.m(r.parentNode,r))},i(e){o||(ge(n),ge(i.$$.fragment,e),o=!0)},o(e){me(n),me(i.$$.fragment,e),o=!1},d(e){a[t].d(e),e&&O(r),Te(i,e)}}}function Hx(e,t,n){let r;return f(e,gg,(e=>n(0,r=e))),[r]}class Gx extends Ne{constructor(e){super(),Be(this,e,Hx,zx,a,{})}}(async()=>{new Gx({target:document.body})})()}();
//# sourceMappingURL=main.js.map
