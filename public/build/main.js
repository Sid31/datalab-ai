!function(){"use strict";function t(){}!function(){const t={DFX_NETWORK:"local",CANISTER_ID_ENCRYPTED_NOTES:"uxrrr-q7777-77774-qaaaq-cai"};try{if(process)return process.env=Object.assign({},process.env),void Object.assign(process.env,t)}catch(t){}globalThis.process={env:t}}();const e=t=>t;function r(t){return t()}function n(){return Object.create(null)}function i(t){t.forEach(r)}function o(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let a;function c(t,e){return a||(a=document.createElement("a")),a.href=e,t===a.href}function u(e,...r){if(null==e)return t;const n=e.subscribe(...r);return n.unsubscribe?()=>n.unsubscribe():n}function l(t){let e;return u(t,(t=>e=t))(),e}function f(t,e,r){t.$$.on_destroy.push(u(e,r))}function d(t){const e="string"==typeof t&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}const h="undefined"!=typeof window;let p=h?()=>window.performance.now():()=>Date.now(),g=h?t=>requestAnimationFrame(t):t;const m=new Set;function y(t){m.forEach((e=>{e.c(t)||(m.delete(e),e.f())})),0!==m.size&&g(y)}function b(t){let e;return 0===m.size&&g(y),{promise:new Promise((r=>{m.add(e={c:t,f:r})})),abort(){m.delete(e)}}}function w(t,e){t.appendChild(e)}function v(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function x(t){const e=S("style");return function(t,e){w(t.head||t,e),e.sheet}(v(t),e),e.sheet}function E(t,e,r){t.insertBefore(e,r||null)}function _(t){t.parentNode&&t.parentNode.removeChild(t)}function B(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function S(t){return document.createElement(t)}function I(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function A(t){return document.createTextNode(t)}function T(){return A(" ")}function N(){return A("")}function O(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function R(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function U(t){return""===t?null:+t}function k(t,e){e=""+e,t.data!==e&&(t.data=e)}function P(t,e){t.value=null==e?"":e}function C(t,e,r,n){null==r?t.style.removeProperty(e):t.style.setProperty(e,r,n?"important":"")}function D(t,e,r){for(let r=0;r<t.options.length;r+=1){const n=t.options[r];if(n.__value===e)return void(n.selected=!0)}r&&void 0===e||(t.selectedIndex=-1)}function L(t){const e=t.querySelector(":checked");return e&&e.__value}function F(t,e,r){t.classList[r?"add":"remove"](e)}function j(t,e,{bubbles:r=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,r,n,e),i}class ${constructor(t=!1){this.is_svg=!1,this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,e,r=null){this.e||(this.is_svg?this.e=I(e.nodeName):this.e=S(11===e.nodeType?"TEMPLATE":e.nodeName),this.t="TEMPLATE"!==e.tagName?e:e.content,this.c(t)),this.i(r)}h(t){this.e.innerHTML=t,this.n=Array.from("TEMPLATE"===this.e.nodeName?this.e.content.childNodes:this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)E(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(_)}}const M=new Map;let q,V=0;function z(t,e,r,n,i,o,s,a=0){const c=16.666/n;let u="{\n";for(let t=0;t<=1;t+=c){const n=e+(r-e)*o(t);u+=100*t+`%{${s(n,1-n)}}\n`}const l=u+`100% {${s(r,1-r)}}\n}`,f=`__svelte_${function(t){let e=5381,r=t.length;for(;r--;)e=(e<<5)-e^t.charCodeAt(r);return e>>>0}(l)}_${a}`,d=v(t),{stylesheet:h,rules:p}=M.get(d)||function(t,e){const r={stylesheet:x(e),rules:{}};return M.set(t,r),r}(d,t);p[f]||(p[f]=!0,h.insertRule(`@keyframes ${f} ${l}`,h.cssRules.length));const g=t.style.animation||"";return t.style.animation=`${g?`${g}, `:""}${f} ${n}ms linear ${i}ms 1 both`,V+=1,f}function G(t,e){const r=(t.style.animation||"").split(", "),n=r.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=r.length-n.length;i&&(t.style.animation=n.join(", "),V-=i,V||g((()=>{V||(M.forEach((t=>{const{ownerNode:e}=t.stylesheet;e&&_(e)})),M.clear())})))}function K(t){q=t}function H(){if(!q)throw new Error("Function called outside component initialization");return q}function Z(t){H().$$.on_mount.push(t)}function W(){const t=H();return(e,r,{cancelable:n=!1}={})=>{const i=t.$$.callbacks[e];if(i){const o=j(e,r,{cancelable:n});return i.slice().forEach((e=>{e.call(t,o)})),!o.defaultPrevented}return!0}}const Y=[],X=[];let J=[];const Q=[],tt=Promise.resolve();let et=!1;function rt(t){J.push(t)}const nt=new Set;let it,ot=0;function st(){if(0!==ot)return;const t=q;do{try{for(;ot<Y.length;){const t=Y[ot];ot++,K(t),at(t.$$)}}catch(t){throw Y.length=0,ot=0,t}for(K(null),Y.length=0,ot=0;X.length;)X.pop()();for(let t=0;t<J.length;t+=1){const e=J[t];nt.has(e)||(nt.add(e),e())}J.length=0}while(Y.length);for(;Q.length;)Q.pop()();et=!1,nt.clear(),K(t)}function at(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(rt)}}function ct(){return it||(it=Promise.resolve(),it.then((()=>{it=null}))),it}function ut(t,e,r){t.dispatchEvent(j(`${e?"intro":"outro"}${r}`))}const lt=new Set;let ft;function dt(){ft={r:0,c:[],p:ft}}function ht(){ft.r||i(ft.c),ft=ft.p}function pt(t,e){t&&t.i&&(lt.delete(t),t.i(e))}function gt(t,e,r,n){if(t&&t.o){if(lt.has(t))return;lt.add(t),ft.c.push((()=>{lt.delete(t),n&&(r&&t.d(1),n())})),t.o(e)}else n&&n()}const mt={duration:0};function yt(t,e){gt(t,1,1,(()=>{e.delete(t.key)}))}function bt(t){t&&t.c()}function wt(t,e,n,s){const{fragment:a,after_update:c}=t.$$;a&&a.m(e,n),s||rt((()=>{const e=t.$$.on_mount.map(r).filter(o);t.$$.on_destroy?t.$$.on_destroy.push(...e):i(e),t.$$.on_mount=[]})),c.forEach(rt)}function vt(t,e){const r=t.$$;null!==r.fragment&&(!function(t){const e=[],r=[];J.forEach((n=>-1===t.indexOf(n)?e.push(n):r.push(n))),r.forEach((t=>t())),J=e}(r.after_update),i(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function xt(t,e){-1===t.$$.dirty[0]&&(Y.push(t),et||(et=!0,tt.then(st)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Et(e,r,o,s,a,c,u,l=[-1]){const f=q;K(e);const d=e.$$={fragment:null,ctx:[],props:c,update:t,not_equal:a,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(f?f.$$.context:[])),callbacks:n(),dirty:l,skip_bound:!1,root:r.target||f.$$.root};u&&u(d.root);let h=!1;if(d.ctx=o?o(e,r.props||{},((t,r,...n)=>{const i=n.length?n[0]:r;return d.ctx&&a(d.ctx[t],d.ctx[t]=i)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](i),h&&xt(e,t)),r})):[],d.update(),h=!0,i(d.before_update),d.fragment=!!s&&s(d.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);d.fragment&&d.fragment.l(t),t.forEach(_)}else d.fragment&&d.fragment.c();r.intro&&pt(e.$$.fragment),wt(e,r.target,r.anchor,r.customElement),st()}K(f)}class _t{$destroy(){vt(this,1),this.$destroy=t}$on(e,r){if(!o(r))return t;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const t=n.indexOf(r);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Bt=[];function St(e,r=t){let n;const i=new Set;function o(t){if(s(e,t)&&(e=t,n)){const t=!Bt.length;for(const t of i)t[1](),Bt.push(t,e);if(t){for(let t=0;t<Bt.length;t+=2)Bt[t][0](Bt[t+1]);Bt.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,a=t){const c=[s,a];return i.add(c),1===i.size&&(n=r(o)||t),s(e),()=>{i.delete(c),0===i.size&&n&&(n(),n=null)}}}}var It="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function At(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}for(var Tt={},Nt={byteLength:function(t){var e=Ct(t),r=e[0],n=e[1];return 3*(r+n)/4-n},toByteArray:function(t){var e,r,n=Ct(t),i=n[0],o=n[1],s=new Ut(function(t,e,r){return 3*(e+r)/4-r}(0,i,o)),a=0,c=o>0?i-4:i;for(r=0;r<c;r+=4)e=Rt[t.charCodeAt(r)]<<18|Rt[t.charCodeAt(r+1)]<<12|Rt[t.charCodeAt(r+2)]<<6|Rt[t.charCodeAt(r+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===o&&(e=Rt[t.charCodeAt(r)]<<2|Rt[t.charCodeAt(r+1)]>>4,s[a++]=255&e);1===o&&(e=Rt[t.charCodeAt(r)]<<10|Rt[t.charCodeAt(r+1)]<<4|Rt[t.charCodeAt(r+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},fromByteArray:function(t){for(var e,r=t.length,n=r%3,i=[],o=16383,s=0,a=r-n;s<a;s+=o)i.push(Dt(t,s,s+o>a?a:s+o));1===n?(e=t[r-1],i.push(Ot[e>>2]+Ot[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],i.push(Ot[e>>10]+Ot[e>>4&63]+Ot[e<<2&63]+"="));return i.join("")}},Ot=[],Rt=[],Ut="undefined"!=typeof Uint8Array?Uint8Array:Array,kt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pt=0;Pt<64;++Pt)Ot[Pt]=kt[Pt],Rt[kt.charCodeAt(Pt)]=Pt;function Ct(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function Dt(t,e,r){for(var n,i,o=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(Ot[(i=n)>>18&63]+Ot[i>>12&63]+Ot[i>>6&63]+Ot[63&i]);return o.join("")}Rt["-".charCodeAt(0)]=62,Rt["_".charCodeAt(0)]=63;var Lt,Ft={};Ft.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,c=(1<<a)-1,u=c>>1,l=-7,f=r?i-1:0,d=r?-1:1,h=t[e+f];for(f+=d,o=h&(1<<-l)-1,h>>=-l,l+=a;l>0;o=256*o+t[e+f],f+=d,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+t[e+f],f+=d,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(h?-1:1);s+=Math.pow(2,n),o-=u}return(h?-1:1)*s*Math.pow(2,o-n)},Ft.write=function(t,e,r,n,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,f=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:o-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+f>=1?d/c:d*Math.pow(2,1-f))*c>=2&&(s++,c/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(e*c-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[r+h]=255&a,h+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[r+h]=255&s,h+=p,s/=256,u-=8);t[r+h-p]|=128*g},function(t){const e=Nt,r=Ft,n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=function(t){+t!=t&&(t=0);return s.alloc(+t)},t.INSPECT_MAX_BYTES=50;const i=2147483647;function o(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return a(t,e,r)}function a(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=0|h(t,e);let n=o(r);const i=n.write(t,e);i!==r&&(n=n.slice(0,i));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(H(t,Uint8Array)){const e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(H(t,ArrayBuffer)||t&&H(t.buffer,ArrayBuffer))return f(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(H(t,SharedArrayBuffer)||t&&H(t.buffer,SharedArrayBuffer)))return f(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return s.from(n,e,r);const i=function(t){if(s.isBuffer(t)){const e=0|d(t.length),r=o(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||Z(t.length)?o(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return c(t),o(t<0?0:0|d(t))}function l(t){const e=t.length<0?0:0|d(t.length),r=o(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function f(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,s.prototype),n}function d(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function h(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||H(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(t).length;default:if(i)return n?-1:z(t).length;e=(""+e).toLowerCase(),i=!0}}function p(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,r);case"utf8":case"utf-8":return B(this,e,r);case"ascii":return I(this,e,r);case"latin1":case"binary":return A(this,e,r);case"base64":return _(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function m(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=s.from(e,n)),s.isBuffer(e))return 0===e.length?-1:y(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):y(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function y(t,e,r,n,i){let o,s=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){let n=-1;for(o=r;o<a;o++)if(u(t,o)===u(e,-1===n?0:o-n)){if(-1===n&&(n=o),o-n+1===c)return n*s}else-1!==n&&(o-=o-n),n=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){let r=!0;for(let n=0;n<c;n++)if(u(t,o+n)!==u(e,n)){r=!1;break}if(r)return o}return-1}function b(t,e,r,n){r=Number(r)||0;const i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;const o=e.length;let s;for(n>o/2&&(n=o/2),s=0;s<n;++s){const n=parseInt(e.substr(2*s,2),16);if(Z(n))return s;t[r+s]=n}return s}function w(t,e,r,n){return K(z(e,t.length-r),t,r,n)}function v(t,e,r,n){return K(function(t){const e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function x(t,e,r,n){return K(G(e),t,r,n)}function E(t,e,r,n){return K(function(t,e){let r,n,i;const o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function _(t,r,n){return 0===r&&n===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(r,n))}function B(t,e,r){r=Math.min(t.length,r);const n=[];let i=e;for(;i<r;){const e=t[i];let o=null,s=e>239?4:e>223?3:e>191?2:1;if(i+s<=r){let r,n,a,c;switch(s){case 1:e<128&&(o=e);break;case 2:r=t[i+1],128==(192&r)&&(c=(31&e)<<6|63&r,c>127&&(o=c));break;case 3:r=t[i+1],n=t[i+2],128==(192&r)&&128==(192&n)&&(c=(15&e)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:r=t[i+1],n=t[i+2],a=t[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|1023&o),n.push(o),i+=s}return function(t){const e=t.length;if(e<=S)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=S));return r}(n)}t.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,r){return a(t,e,r)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,r){return function(t,e,r){return c(t),t<=0?o(t):void 0!==e?"string"==typeof r?o(t).fill(e,r):o(t).fill(e):o(t)}(t,e,r)},s.allocUnsafe=function(t){return u(t)},s.allocUnsafeSlow=function(t){return u(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(H(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),H(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;const n=s.allocUnsafe(e);let i=0;for(r=0;r<t.length;++r){let e=t[r];if(H(e,Uint8Array))i+e.length>n.length?(s.isBuffer(e)||(e=s.from(e)),e.copy(n,i)):Uint8Array.prototype.set.call(n,e,i);else{if(!s.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,i)}i+=e.length}return n},s.byteLength=h,s.prototype._isBuffer=!0,s.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)g(this,e,e+1);return this},s.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},s.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},s.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?B(this,0,t):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},n&&(s.prototype[n]=s.prototype.inspect),s.prototype.compare=function(t,e,r,n,i){if(H(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;let o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0);const c=Math.min(o,a),u=this.slice(n,i),l=t.slice(e,r);for(let t=0;t<c;++t)if(u[t]!==l[t]){o=u[t],a=l[t];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},s.prototype.indexOf=function(t,e,r){return m(this,t,e,r,!0)},s.prototype.lastIndexOf=function(t,e,r){return m(this,t,e,r,!1)},s.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return b(this,t,e,r);case"utf8":case"utf-8":return w(this,t,e,r);case"ascii":case"latin1":case"binary":return v(this,t,e,r);case"base64":return x(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const S=4096;function I(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function A(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function T(t,e,r){const n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=e;n<r;++n)i+=W[t[n]];return i}function N(t,e,r){const n=t.slice(e,r);let i="";for(let t=0;t<n.length-1;t+=2)i+=String.fromCharCode(n[t]+256*n[t+1]);return i}function O(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,r,n,i,o){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function U(t,e,r,n,i){$(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,r}function k(t,e,r,n,i){$(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r+7]=o,o>>=8,t[r+6]=o,o>>=8,t[r+5]=o,o>>=8,t[r+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=s,s>>=8,t[r+2]=s,s>>=8,t[r+1]=s,s>>=8,t[r]=s,r+8}function P(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function C(t,e,n,i,o){return e=+e,n>>>=0,o||P(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function D(t,e,n,i,o){return e=+e,n>>>=0,o||P(t,0,n,8),r.write(t,e,n,i,52,8),n+8}s.prototype.slice=function(t,e){const r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,s.prototype),n},s.prototype.readUintLE=s.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);let n=this[t],i=1,o=0;for(;++o<e&&(i*=256);)n+=this[t+o]*i;return n},s.prototype.readUintBE=s.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);let n=this[t+--e],i=1;for(;e>0&&(i*=256);)n+=this[t+--e]*i;return n},s.prototype.readUint8=s.prototype.readUInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readBigUInt64LE=Y((function(t){M(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||q(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,i=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),s.prototype.readBigUInt64BE=Y((function(t){M(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||q(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],i=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),s.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);let n=this[t],i=1,o=0;for(;++o<e&&(i*=256);)n+=this[t+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},s.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);let n=e,i=1,o=this[t+--n];for(;n>0&&(i*=256);)o+=this[t+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},s.prototype.readInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||O(t,2,this.length);const r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(t,e){t>>>=0,e||O(t,2,this.length);const r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readBigInt64LE=Y((function(t){M(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||q(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),s.prototype.readBigInt64BE=Y((function(t){M(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||q(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)})),s.prototype.readFloatLE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){R(this,t,e,r,Math.pow(2,8*r)-1,0)}let i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(t,e,r,n){if(t=+t,e>>>=0,r>>>=0,!n){R(this,t,e,r,Math.pow(2,8*r)-1,0)}let i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},s.prototype.writeUint8=s.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigUInt64LE=Y((function(t,e=0){return U(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeBigUInt64BE=Y((function(t,e=0){return k(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);R(this,t,e,r,n-1,-n)}let i=0,o=1,s=0;for(this[e]=255&t;++i<r&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+r},s.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);R(this,t,e,r,n-1,-n)}let i=r-1,o=1,s=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+r},s.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigInt64LE=Y((function(t,e=0){return U(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeBigInt64BE=Y((function(t,e=0){return k(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeFloatLE=function(t,e,r){return C(this,t,e,!0,r)},s.prototype.writeFloatBE=function(t,e,r){return C(this,t,e,!1,r)},s.prototype.writeDoubleLE=function(t,e,r){return D(this,t,e,!0,r)},s.prototype.writeDoubleBE=function(t,e,r){return D(this,t,e,!1,r)},s.prototype.copy=function(t,e,r,n){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);const i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},s.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{const o=s.isBuffer(t)?t:s.from(t,n),a=o.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=o[i%a]}return this};const L={};function F(t,e,r){L[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function j(t){let e="",r=t.length;const n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function $(t,e,r,n,i,o){if(t>r||t<e){const n="bigint"==typeof e?"n":"";let i;throw i=o>3?0===e||e===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(o+1)}${n}`:`>= -(2${n} ** ${8*(o+1)-1}${n}) and < 2 ** ${8*(o+1)-1}${n}`:`>= ${e}${n} and <= ${r}${n}`,new L.ERR_OUT_OF_RANGE("value",i,t)}!function(t,e,r){M(e,"offset"),void 0!==t[e]&&void 0!==t[e+r]||q(e,t.length-(r+1))}(n,i,o)}function M(t,e){if("number"!=typeof t)throw new L.ERR_INVALID_ARG_TYPE(e,"number",t)}function q(t,e,r){if(Math.floor(t)!==t)throw M(t,r),new L.ERR_OUT_OF_RANGE(r||"offset","an integer",t);if(e<0)throw new L.ERR_BUFFER_OUT_OF_BOUNDS;throw new L.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}F("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),F("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),F("ERR_OUT_OF_RANGE",(function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=j(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=j(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n}),RangeError);const V=/[^+/0-9A-Za-z-_]/g;function z(t,e){let r;e=e||1/0;const n=t.length;let i=null;const o=[];for(let s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function G(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function K(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function H(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Z(t){return t!=t}const W=function(){const t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function Y(t){return"undefined"==typeof BigInt?X:t}function X(){throw new Error("BigInt not supported")}}(Tt),function(t){t[t.SysFatal=1]="SysFatal",t[t.SysTransient=2]="SysTransient",t[t.DestinationInvalid=3]="DestinationInvalid",t[t.CanisterReject=4]="CanisterReject",t[t.CanisterError=5]="CanisterError"}(Lt||(Lt={}));const jt="abcdefghijklmnopqrstuvwxyz234567",$t=Object.create(null);for(let t=0;t<32;t++)$t[jt[t]]=t;$t[0]=$t.o,$t[1]=$t.i;const Mt=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);const qt="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function Vt(t,...e){if(!((r=t)instanceof Uint8Array||ArrayBuffer.isView(r)&&"Uint8Array"===r.constructor.name))throw new Error("Uint8Array expected");var r;if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function zt(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Gt(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Kt(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ht(t,e){return t<<32-e|t>>>e}function Zt(t){return"string"==typeof t&&(t=function(t){if("string"!=typeof t)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}(t)),Vt(t),t}class Wt{}function Yt(t){const e=e=>t().update(Zt(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Xt(t=32){if(qt&&"function"==typeof qt.getRandomValues)return qt.getRandomValues(new Uint8Array(t));if(qt&&"function"==typeof qt.randomBytes)return Uint8Array.from(qt.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function Jt(t,e,r){return t&e^~t&r}function Qt(t,e,r){return t&e^t&r^e&r}class te extends Wt{constructor(t,e,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(t),this.view=Kt(this.buffer)}update(t){zt(this),Vt(t=Zt(t));const{view:e,buffer:r,blockLen:n}=this,i=t.length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s!==n)r.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=Kt(t);for(;n<=i-o;o+=n)this.process(e,o)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){zt(this),function(t,e){Vt(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;e[o++]=128,Gt(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(r,0),o=0);for(let t=o;t<n;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,u=n?0:4;t.setUint32(e+c,s,n),t.setUint32(e+u,a,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=Kt(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return t.destroyed=o,t.finished=i,t.length=n,t.pos=s,n%e&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const ee=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),re=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),ne=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),ie=BigInt(2**32-1),oe=BigInt(32);function se(t,e=!1){return e?{h:Number(t&ie),l:Number(t>>oe&ie)}:{h:0|Number(t>>oe&ie),l:0|Number(t&ie)}}const ae=(t,e,r)=>t>>>r,ce=(t,e,r)=>t<<32-r|e>>>r,ue=(t,e,r)=>t>>>r|e<<32-r,le=(t,e,r)=>t<<32-r|e>>>r,fe=(t,e,r)=>t<<64-r|e>>>r-32,de=(t,e,r)=>t>>>r-32|e<<64-r;function he(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:0|i}}const pe=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),ge=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,me=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),ye=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,be=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),we=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0,ve=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),xe=new Uint32Array(64);class Ee extends te{constructor(t=32){super(64,t,8,!1),this.A=0|ee[0],this.B=0|ee[1],this.C=0|ee[2],this.D=0|ee[3],this.E=0|ee[4],this.F=0|ee[5],this.G=0|ee[6],this.H=0|ee[7]}get(){const{A:t,B:e,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[t,e,r,n,i,o,s,a]}set(t,e,r,n,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)xe[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=xe[t-15],r=xe[t-2],n=Ht(e,7)^Ht(e,18)^e>>>3,i=Ht(r,17)^Ht(r,19)^r>>>10;xe[t]=i+xe[t-7]+n+xe[t-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(Ht(s,6)^Ht(s,11)^Ht(s,25))+Jt(s,a,c)+ve[t]+xe[t]|0,l=(Ht(r,2)^Ht(r,13)^Ht(r,22))+Qt(r,n,i)|0;u=c,c=a,a=s,s=o+e|0,o=i,i=n,n=r,r=e+l|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,o,s,a,c,u)}roundClean(){Gt(xe)}destroy(){this.set(0,0,0,0,0,0,0,0),Gt(this.buffer)}}class _e extends Ee{constructor(){super(28),this.A=0|re[0],this.B=0|re[1],this.C=0|re[2],this.D=0|re[3],this.E=0|re[4],this.F=0|re[5],this.G=0|re[6],this.H=0|re[7]}}const Be=(()=>function(t,e=!1){const r=t.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let o=0;o<r;o++){const{h:r,l:s}=se(t[o],e);[n[o],i[o]]=[r,s]}return[n,i]}(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t)))))(),Se=(()=>Be[0])(),Ie=(()=>Be[1])(),Ae=new Uint32Array(80),Te=new Uint32Array(80);class Ne extends te{constructor(t=64){super(128,t,16,!1),this.Ah=0|ne[0],this.Al=0|ne[1],this.Bh=0|ne[2],this.Bl=0|ne[3],this.Ch=0|ne[4],this.Cl=0|ne[5],this.Dh=0|ne[6],this.Dl=0|ne[7],this.Eh=0|ne[8],this.El=0|ne[9],this.Fh=0|ne[10],this.Fl=0|ne[11],this.Gh=0|ne[12],this.Gl=0|ne[13],this.Hh=0|ne[14],this.Hl=0|ne[15]}get(){const{Ah:t,Al:e,Bh:r,Bl:n,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:u,Fh:l,Fl:f,Gh:d,Gl:h,Hh:p,Hl:g}=this;return[t,e,r,n,i,o,s,a,c,u,l,f,d,h,p,g]}set(t,e,r,n,i,o,s,a,c,u,l,f,d,h,p,g){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|l,this.Fl=0|f,this.Gh=0|d,this.Gl=0|h,this.Hh=0|p,this.Hl=0|g}process(t,e){for(let r=0;r<16;r++,e+=4)Ae[r]=t.getUint32(e),Te[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|Ae[t-15],r=0|Te[t-15],n=ue(e,r,1)^ue(e,r,8)^ae(e,0,7),i=le(e,r,1)^le(e,r,8)^ce(e,r,7),o=0|Ae[t-2],s=0|Te[t-2],a=ue(o,s,19)^fe(o,s,61)^ae(o,0,6),c=le(o,s,19)^de(o,s,61)^ce(o,s,6),u=me(i,c,Te[t-7],Te[t-16]),l=ye(u,n,a,Ae[t-7],Ae[t-16]);Ae[t]=0|l,Te[t]=0|u}let{Ah:r,Al:n,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:u,Eh:l,El:f,Fh:d,Fl:h,Gh:p,Gl:g,Hh:m,Hl:y}=this;for(let t=0;t<80;t++){const e=ue(l,f,14)^ue(l,f,18)^fe(l,f,41),b=le(l,f,14)^le(l,f,18)^de(l,f,41),w=l&d^~l&p,v=be(y,b,f&h^~f&g,Ie[t],Te[t]),x=we(v,m,e,w,Se[t],Ae[t]),E=0|v,_=ue(r,n,28)^fe(r,n,34)^fe(r,n,39),B=le(r,n,28)^de(r,n,34)^de(r,n,39),S=r&i^r&s^i&s,I=n&o^n&a^o&a;m=0|p,y=0|g,p=0|d,g=0|h,d=0|l,h=0|f,({h:l,l:f}=he(0|c,0|u,0|x,0|E)),c=0|s,u=0|a,s=0|i,a=0|o,i=0|r,o=0|n;const A=pe(E,B,I);r=ge(A,x,_,S),n=0|A}({h:r,l:n}=he(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:o}=he(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=he(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=he(0|this.Dh,0|this.Dl,0|c,0|u)),({h:l,l:f}=he(0|this.Eh,0|this.El,0|l,0|f)),({h:d,l:h}=he(0|this.Fh,0|this.Fl,0|d,0|h)),({h:p,l:g}=he(0|this.Gh,0|this.Gl,0|p,0|g)),({h:m,l:y}=he(0|this.Hh,0|this.Hl,0|m,0|y)),this.set(r,n,i,o,s,a,c,u,l,f,d,h,p,g,m,y)}roundClean(){Gt(Ae,Te)}destroy(){Gt(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Oe=Yt((()=>new Ee)),Re=Yt((()=>new _e)),Ue=Yt((()=>new Ne)),ke=Oe,Pe=Re;const Ce="__principal__";let De=class t{constructor(t){this._arr=t,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([4]))}static managementCanister(){return this.fromText("aaaaa-aa")}static selfAuthenticating(t){const e=(r=t,Pe.create().update(new Uint8Array(r)).digest());var r;return new this(new Uint8Array([...e,2]))}static from(e){if("string"==typeof e)return t.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new t(e);if("object"==typeof e&&null!==e&&!0===e._isPrincipal)return new t(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(t){return new this((t=>{var e;return new Uint8Array((null!==(e=t.match(/.{1,2}/g))&&void 0!==e?e:[]).map((t=>parseInt(t,16))))})(t))}static fromText(t){let e=t;if(t.includes(Ce)){const r=JSON.parse(t);Ce in r&&(e=r[Ce])}let r=function(t){let e=0,r=0;const n=new Uint8Array(4*t.length/3|0);let i=0;function o(t){let o=$t[t.toLowerCase()];if(void 0===o)throw new Error(`Invalid character: ${JSON.stringify(t)}`);o<<=3,r|=o>>>e,e+=5,e>=8&&(n[i++]=r,e-=8,r=e>0?o<<5-e&255:0)}for(const e of t)o(e);return n.slice(0,i)}(e.toLowerCase().replace(/-/g,""));r=r.slice(4,r.length);const n=new this(r);if(n.toText()!==e)throw new Error(`Principal "${n.toText()}" does not have a valid checksum (original value "${e}" may not be a valid Principal ID).`);return n}static fromUint8Array(t){return new this(t)}isAnonymous(){return 1===this._arr.byteLength&&4===this._arr[0]}toUint8Array(){return this._arr}toHex(){return(t=>t.reduce(((t,e)=>t+e.toString(16).padStart(2,"0")),""))(this._arr).toUpperCase()}toText(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,function(t){const e=new Uint8Array(t);let r=-1;for(let t=0;t<e.length;t++){const n=e[t];r=Mt[255&(n^r)]^r>>>8}return(-1^r)>>>0}(this._arr));const e=new Uint8Array(t),r=Uint8Array.from(this._arr),n=function(t){let e=0,r=0,n="";for(let o=0;o<t.length;)o+=(i=t[o],e<0?r|=i>>-e:r=i<<e&248,e>3?(e-=8,1):(e<4&&(n+=jt[r>>3],e+=5),0));var i;return n+(e<0?jt[r>>3]:"")}(new Uint8Array([...e,...r])),i=n.match(/.{1,5}/g);if(!i)throw new Error;return i.join("-")}toString(){return this.toText()}toJSON(){return{[Ce]:this.toText()}}compareTo(t){for(let e=0;e<Math.min(this._arr.length,t._arr.length);e++){if(this._arr[e]<t._arr[e])return"lt";if(this._arr[e]>t._arr[e])return"gt"}return this._arr.length<t._arr.length?"lt":this._arr.length>t._arr.length?"gt":"eq"}ltEq(t){const e=this.compareTo(t);return"lt"==e||"eq"==e}gtEq(t){const e=this.compareTo(t);return"gt"==e||"eq"==e}};function Le(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.byteLength),0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e.buffer}function Fe(t){return[...new Uint8Array(t)].map((t=>t.toString(16).padStart(2,"0"))).join("")}const je=new RegExp(/^[0-9a-fA-F]+$/);function $e(t){if(!je.test(t))throw new Error("Invalid hexadecimal string.");const e=[...t].reduce(((t,e,r)=>(t[r/2|0]=(t[r/2|0]||"")+e,t)),[]).map((t=>Number.parseInt(t,16)));return new Uint8Array(e).buffer}function Me(t,e){if(t.byteLength!==e.byteLength)return t.byteLength-e.byteLength;const r=new Uint8Array(t),n=new Uint8Array(e);for(let t=0;t<r.length;t++)if(r[t]!==n[t])return r[t]-n[t];return 0}function qe(t,e){return 0===Me(t,e)}function Ve(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function ze(t){return t instanceof Uint8Array?Ve(t):t instanceof ArrayBuffer?t:Array.isArray(t)?Ve(new Uint8Array(t)):"buffer"in t?ze(t.buffer):Ve(new Uint8Array(t))}class Ge extends Error{constructor(t){super(t),this.message=t,this.name="AgentError",this.__proto__=Ge.prototype,Object.setPrototypeOf(this,Ge.prototype)}}function Ke(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.byteLength),0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e}class He{constructor(t,e=(null==t?void 0:t.byteLength)||0){this._buffer=We(t||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,e)}save(){return this._view}restore(t){this._view=t}get buffer(){return We(this._view.slice())}get byteLength(){return this._view.byteLength}read(t){const e=this._view.subarray(0,t);return this._view=this._view.subarray(t),e.slice().buffer}readUint8(){const t=this._view[0];return this._view=this._view.subarray(1),t}write(t){const e=new Uint8Array(t),r=this._view.byteLength;this._view.byteOffset+this._view.byteLength+e.byteLength>=this._buffer.byteLength?this.alloc(e.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+e.byteLength),this._view.set(e,r)}get end(){return 0===this._view.byteLength}alloc(t){const e=new ArrayBuffer(1.2*(this._buffer.byteLength+t)|0),r=new Uint8Array(e,0,this._view.byteLength+t);r.set(this._view),this._buffer=e,this._view=r}}function Ze(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function We(t){return t instanceof Uint8Array?Ze(t):t instanceof ArrayBuffer?t:Array.isArray(t)?Ze(new Uint8Array(t)):"buffer"in t?We(t.buffer):Ze(new Uint8Array(t))}function Ye(t){if(/^_\d+_$/.test(t)||/^_0x[0-9a-fA-F]+_$/.test(t)){const e=+t.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return function(t){const e=(new TextEncoder).encode(t);let r=0;for(const t of e)r=(223*r+t)%2**32;return r}(t)}function Xe(){throw new Error("unexpected end of buffer")}function Je(t,e){return t.byteLength<e&&Xe(),t.read(e)}function Qe(t){const e=t.readUint8();return void 0===e&&Xe(),e}function tr(t){if("number"==typeof t&&(t=BigInt(t)),t<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,r=new He(new ArrayBuffer(e),0);for(;;){const e=Number(t&BigInt(127));if((t/=BigInt(128))===BigInt(0)){r.write(new Uint8Array([e]));break}r.write(new Uint8Array([128|e]))}return r.buffer}function er(t){let e,r=BigInt(1),n=BigInt(0);do{e=Qe(t),n+=BigInt(127&e).valueOf()*r,r*=BigInt(128)}while(e>=128);return n}function rr(t){"number"==typeof t&&(t=BigInt(t));const e=t<BigInt(0);e&&(t=-t-BigInt(1));const r=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,n=new He(new ArrayBuffer(r),0);for(;;){const r=i(t);if(t/=BigInt(128),e&&t===BigInt(0)&&0!=(64&r)||!e&&t===BigInt(0)&&0==(64&r)){n.write(new Uint8Array([r]));break}n.write(new Uint8Array([128|r]))}function i(t){const r=t%BigInt(128);return Number(e?BigInt(128)-r-BigInt(1):r)}return n.buffer}function nr(t){const e=new Uint8Array(t.buffer);let r=0;for(;r<e.byteLength;r++)if(e[r]<128){if(0==(64&e[r]))return er(t);break}const n=new Uint8Array(Je(t,r+1));let i=BigInt(0);for(let t=n.byteLength-1;t>=0;t--)i=i*BigInt(128)+BigInt(128-(127&n[t])-1);return-i-BigInt(1)}function ir(t,e){t=BigInt(t);const r=new He(new ArrayBuffer(Math.min(1,e)),0);let n=0,i=BigInt(256),o=BigInt(0),s=Number(t%i);for(r.write(new Uint8Array([s]));++n<e;)t<0&&o===BigInt(0)&&0!==s&&(o=BigInt(1)),s=Number((t/i-o)%BigInt(256)),r.write(new Uint8Array([s])),i*=BigInt(256);return r.buffer}function or(t,e){let r=BigInt(Qe(t)),n=BigInt(1),i=0;for(;++i<e;){n*=BigInt(256);r+=n*BigInt(Qe(t))}return r}function sr(t){const e=BigInt(t);if(t<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const ar="DIDL";function cr(t,e,r){return t.map(((t,n)=>r(t,e[n])))}class ur{constructor(){this._typs=[],this._idx=new Map}has(t){return this._idx.has(t.name)}add(t,e){const r=this._typs.length;this._idx.set(t.name,r),this._typs.push(e)}merge(t,e){const r=this._idx.get(t.name),n=this._idx.get(e);if(void 0===r)throw new Error("Missing type index for "+t);if(void 0===n)throw new Error("Missing type index for "+e);this._typs[r]=this._typs[n],this._typs.splice(n,1),this._idx.delete(e)}encode(){const t=tr(this._typs.length),e=Ke(...this._typs);return Ke(t,e)}indexOf(t){if(!this._idx.has(t))throw new Error("Missing type index for "+t);return rr(this._idx.get(t)||0)}}class lr{display(){return this.name}valueToString(t){return Pr(t)}buildTypeTable(t){t.has(this)||this._buildTypeTableImpl(t)}}class fr extends lr{checkType(t){if(this.name!==t.name)throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`);return t}_buildTypeTableImpl(t){}}class dr extends lr{checkType(t){if(t instanceof Nr){const e=t.getType();if(void 0===e)throw new Error("type mismatch with uninitialized type");return e}throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`)}encodeType(t){return t.indexOf(this.name)}}class hr extends fr{accept(t,e){return t.visitEmpty(this,e)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return rr(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class pr extends lr{checkType(t){throw new Error("Method not implemented for unknown.")}accept(t,e){throw t.visitType(this,e)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(t,e){let r,n=e.decodeValue(t,e);return Object(n)!==n&&(n=Object(n)),r=e instanceof Nr?()=>e.getType():()=>e,Object.defineProperty(n,"type",{value:r,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class gr extends fr{accept(t,e){return t.visitBool(this,e)}covariant(t){if("boolean"==typeof t)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){return new Uint8Array([t?1:0])}encodeType(){return rr(-2)}decodeValue(t,e){switch(this.checkType(e),Qe(t)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class mr extends fr{accept(t,e){return t.visitNull(this,e)}covariant(t){if(null===t)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return rr(-1)}decodeValue(t,e){return this.checkType(e),null}get name(){return"null"}}class yr extends fr{accept(t,e){return t.visitReserved(this,e)}covariant(t){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return rr(-16)}decodeValue(t,e){return e.name!==this.name&&e.decodeValue(t,e),null}get name(){return"reserved"}}class br extends fr{accept(t,e){return t.visitText(this,e)}covariant(t){if("string"==typeof t)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){const e=(new TextEncoder).encode(t);return Ke(tr(e.byteLength),e)}encodeType(){return rr(-15)}decodeValue(t,e){this.checkType(e);const r=er(t),n=Je(t,Number(r));return new TextDecoder("utf8",{fatal:!0}).decode(n)}get name(){return"text"}valueToString(t){return'"'+t+'"'}}class wr extends fr{accept(t,e){return t.visitInt(this,e)}covariant(t){if("bigint"==typeof t||Number.isInteger(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){return rr(t)}encodeType(){return rr(-4)}decodeValue(t,e){return this.checkType(e),nr(t)}get name(){return"int"}valueToString(t){return t.toString()}}class vr extends fr{accept(t,e){return t.visitNat(this,e)}covariant(t){if("bigint"==typeof t&&t>=BigInt(0)||Number.isInteger(t)&&t>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){return tr(t)}encodeType(){return rr(-3)}decodeValue(t,e){return this.checkType(e),er(t)}get name(){return"nat"}valueToString(t){return t.toString()}}class xr extends fr{constructor(t){if(super(),this._bits=t,32!==t&&64!==t)throw new Error("not a valid float type")}accept(t,e){return t.visitFloat(this,e)}covariant(t){if("number"==typeof t||t instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){const e=new ArrayBuffer(this._bits/8),r=new DataView(e);return 32===this._bits?r.setFloat32(0,t,!0):r.setFloat64(0,t,!0),e}encodeType(){return rr(32===this._bits?-13:-14)}decodeValue(t,e){this.checkType(e);const r=Je(t,this._bits/8),n=new DataView(r);return 32===this._bits?n.getFloat32(0,!0):n.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(t){return t.toString()}}class Er extends fr{constructor(t){super(),this._bits=t}accept(t,e){return t.visitFixedInt(this,e)}covariant(t){const e=sr(this._bits-1)*BigInt(-1),r=sr(this._bits-1)-BigInt(1);let n=!1;if("bigint"==typeof t)n=t>=e&&t<=r;else if(Number.isInteger(t)){const i=BigInt(t);n=i>=e&&i<=r}else n=!1;if(n)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){return ir(t,this._bits/8)}encodeType(){return rr(-9-(Math.log2(this._bits)-3))}decodeValue(t,e){this.checkType(e);const r=function(t,e){let r=or(t,e);const n=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return r>=n&&(r-=n*BigInt(2)),r}(t,this._bits/8);return this._bits<=32?Number(r):r}get name(){return`int${this._bits}`}valueToString(t){return t.toString()}}class _r extends fr{constructor(t){super(),this._bits=t}accept(t,e){return t.visitFixedNat(this,e)}covariant(t){const e=sr(this._bits);let r=!1;if("bigint"==typeof t&&t>=BigInt(0))r=t<e;else if(Number.isInteger(t)&&t>=0){r=BigInt(t)<e}else r=!1;if(r)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){return function(t,e){if(BigInt(t)<BigInt(0))throw new Error("Cannot write negative values.");return ir(t,e)}(t,this._bits/8)}encodeType(){return rr(-5-(Math.log2(this._bits)-3))}decodeValue(t,e){this.checkType(e);const r=or(t,this._bits/8);return this._bits<=32?Number(r):r}get name(){return`nat${this._bits}`}valueToString(t){return t.toString()}}class Br extends dr{constructor(t){super(),this._type=t,this._blobOptimization=!1,t instanceof _r&&8===t._bits&&(this._blobOptimization=!0)}accept(t,e){return t.visitVec(this,this._type,e)}covariant(t){const e=this._type instanceof _r||this._type instanceof Er?this._type._bits:0;if(ArrayBuffer.isView(t)&&e==8*t.BYTES_PER_ELEMENT||Array.isArray(t)&&t.every(((t,e)=>{try{return this._type.covariant(t)}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nindex ${e} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){const e=tr(t.length);if(this._blobOptimization)return Ke(e,new Uint8Array(t));if(ArrayBuffer.isView(t))return Ke(e,new Uint8Array(t.buffer));const r=new He(new ArrayBuffer(e.byteLength+t.length),0);r.write(e);for(const e of t){const t=this._type.encodeValue(e);r.write(new Uint8Array(t))}return r.buffer}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const e=rr(-19),r=this._type.encodeType(t);t.add(this,Ke(e,r))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof Br))throw new Error("Not a vector type");const n=Number(er(t));if(this._type instanceof _r){if(8==this._type._bits)return new Uint8Array(t.read(n));if(16==this._type._bits)return new Uint16Array(t.read(2*n));if(32==this._type._bits)return new Uint32Array(t.read(4*n));if(64==this._type._bits)return new BigUint64Array(t.read(8*n))}if(this._type instanceof Er){if(8==this._type._bits)return new Int8Array(t.read(n));if(16==this._type._bits)return new Int16Array(t.read(2*n));if(32==this._type._bits)return new Int32Array(t.read(4*n));if(64==this._type._bits)return new BigInt64Array(t.read(8*n))}const i=[];for(let e=0;e<n;e++)i.push(this._type.decodeValue(t,r._type));return i}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(t){return"vec {"+t.map((t=>this._type.valueToString(t))).join("; ")+"}"}}class Sr extends dr{constructor(t){super(),this._type=t}accept(t,e){return t.visitOpt(this,this._type,e)}covariant(t){try{if(Array.isArray(t)&&(0===t.length||1===t.length&&this._type.covariant(t[0])))return!0}catch(e){throw new Error(`Invalid ${this.display()} argument: ${Pr(t)} \n\n-> ${e.message}`)}throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){return 0===t.length?new Uint8Array([0]):Ke(new Uint8Array([1]),this._type.encodeValue(t[0]))}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const e=rr(-18),r=this._type.encodeType(t);t.add(this,Ke(e,r))}decodeValue(t,e){if(e instanceof mr)return[];if(e instanceof yr)return[];let r=e;if(e instanceof Nr){const t=e.getType();if(void 0===t)throw new Error("type mismatch with uninitialized type");r=t}if(r instanceof Sr)switch(Qe(t)){case 0:return[];case 1:{const e=t.save();try{return[this._type.decodeValue(t,r._type)]}catch(n){return t.restore(e),r._type.decodeValue(t,r._type),[]}}default:throw new Error("Not an option value")}else{if(this._type instanceof mr||this._type instanceof Sr||this._type instanceof yr)return r.decodeValue(t,r),[];{const n=t.save();try{return[this._type.decodeValue(t,e)]}catch(i){return t.restore(n),r.decodeValue(t,e),[]}}}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(t){return 0===t.length?"null":`opt ${this._type.valueToString(t[0])}`}}class Ir extends dr{constructor(t={}){super(),this._fields=Object.entries(t).sort(((t,e)=>Ye(t[0])-Ye(e[0])))}accept(t,e){return t.visitRecord(this,this._fields,e)}tryAsTuple(){const t=[];for(let e=0;e<this._fields.length;e++){const[r,n]=this._fields[e];if(r!==`_${e}_`)return null;t.push(n)}return t}covariant(t){if("object"==typeof t&&this._fields.every((([e,r])=>{if(!t.hasOwnProperty(e))throw new Error(`Record is missing key "${e}".`);try{return r.covariant(t[e])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nfield ${e} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){const e=this._fields.map((([e])=>t[e])),r=cr(this._fields,e,(([,t],e)=>t.encodeValue(e)));return Ke(...r)}_buildTypeTableImpl(t){this._fields.forEach((([e,r])=>r.buildTypeTable(t)));const e=rr(-20),r=tr(this._fields.length),n=this._fields.map((([e,r])=>Ke(tr(Ye(e)),r.encodeType(t))));t.add(this,Ke(e,r,Ke(...n)))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof Ir))throw new Error("Not a record type");const n={};let i=0,o=0;for(;o<r._fields.length;){const[e,s]=r._fields[o];if(i>=this._fields.length){s.decodeValue(t,s),o++;continue}const[a,c]=this._fields[i],u=Ye(this._fields[i][0]),l=Ye(e);if(u===l)n[a]=c.decodeValue(t,s),i++,o++;else if(l>u){if(!(c instanceof Sr||c instanceof yr))throw new Error("Cannot find required field "+a);n[a]=[],i++}else s.decodeValue(t,s),o++}for(const[t,e]of this._fields.slice(i)){if(!(e instanceof Sr||e instanceof yr))throw new Error("Cannot find required field "+t);n[t]=[]}return n}get name(){const t=this._fields.map((([t,e])=>t+":"+e.name));return`record {${t.join("; ")}}`}display(){const t=this._fields.map((([t,e])=>t+":"+e.display()));return`record {${t.join("; ")}}`}valueToString(t){const e=this._fields.map((([e])=>t[e])),r=cr(this._fields,e,(([t,e],r)=>t+"="+e.valueToString(r)));return`record {${r.join("; ")}}`}}class Ar extends Ir{constructor(t){const e={};t.forEach(((t,r)=>e["_"+r+"_"]=t)),super(e),this._components=t}accept(t,e){return t.visitTuple(this,this._components,e)}covariant(t){if(Array.isArray(t)&&t.length>=this._fields.length&&this._components.every(((e,r)=>{try{return e.covariant(t[r])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nindex ${r} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){const e=cr(this._components,t,((t,e)=>t.encodeValue(e)));return Ke(...e)}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof Ar))throw new Error("not a tuple type");if(r._components.length<this._components.length)throw new Error("tuple mismatch");const n=[];for(const[e,i]of r._components.entries())e>=this._components.length?i.decodeValue(t,i):n.push(this._components[e].decodeValue(t,i));return n}display(){const t=this._components.map((t=>t.display()));return`record {${t.join("; ")}}`}valueToString(t){const e=cr(this._components,t,((t,e)=>t.valueToString(e)));return`record {${e.join("; ")}}`}}class Tr extends dr{constructor(t={}){super(),this._fields=Object.entries(t).sort(((t,e)=>Ye(t[0])-Ye(e[0])))}accept(t,e){return t.visitVariant(this,this._fields,e)}covariant(t){if("object"==typeof t&&1===Object.entries(t).length&&this._fields.every((([e,r])=>{try{return!t.hasOwnProperty(e)||r.covariant(t[e])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nvariant ${e} -> ${t.message}`)}})))return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){for(let e=0;e<this._fields.length;e++){const[r,n]=this._fields[e];if(t.hasOwnProperty(r)){return Ke(tr(e),n.encodeValue(t[r]))}}throw Error("Variant has no data: "+t)}_buildTypeTableImpl(t){this._fields.forEach((([,e])=>{e.buildTypeTable(t)}));const e=rr(-21),r=tr(this._fields.length),n=this._fields.map((([e,r])=>Ke(tr(Ye(e)),r.encodeType(t))));t.add(this,Ke(e,r,...n))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof Tr))throw new Error("Not a variant type");const n=Number(er(t));if(n>=r._fields.length)throw Error("Invalid variant index: "+n);const[i,o]=r._fields[n];for(const[e,r]of this._fields)if(Ye(i)===Ye(e)){return{[e]:r.decodeValue(t,o)}}throw new Error("Cannot find field hash "+i)}get name(){return`variant {${this._fields.map((([t,e])=>t+":"+e.name)).join("; ")}}`}display(){return`variant {${this._fields.map((([t,e])=>t+("null"===e.name?"":`:${e.display()}`))).join("; ")}}`}valueToString(t){for(const[e,r]of this._fields)if(t.hasOwnProperty(e)){const n=r.valueToString(t[e]);return"null"===n?`variant {${e}}`:`variant {${e}=${n}}`}throw new Error("Variant has no data: "+t)}}class Nr extends dr{constructor(){super(...arguments),this._id=Nr._counter++,this._type=void 0}accept(t,e){if(!this._type)throw Error("Recursive type uninitialized.");return t.visitRec(this,this._type,e)}fill(t){this._type=t}getType(){return this._type}covariant(t){if(this._type&&this._type.covariant(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(t)}_buildTypeTableImpl(t){if(!this._type)throw Error("Recursive type uninitialized.");t.add(this,new Uint8Array([])),this._type.buildTypeTable(t),t.merge(this,this._type.name)}decodeValue(t,e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(t,e)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`${this.name}.${this._type.name}`}valueToString(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(t)}}function Or(t){if(1!==Qe(t))throw new Error("Cannot decode principal");const e=Number(er(t));return De.fromUint8Array(new Uint8Array(Je(t,e)))}Nr._counter=0;class Rr extends fr{accept(t,e){return t.visitPrincipal(this,e)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){const e=t.toUint8Array(),r=tr(e.byteLength);return Ke(new Uint8Array([1]),r,e)}encodeType(){return rr(-24)}decodeValue(t,e){return this.checkType(e),Or(t)}get name(){return"principal"}valueToString(t){return`${this.name} "${t.toText()}"`}}class Ur extends dr{constructor(t,e,r=[]){super(),this.argTypes=t,this.retTypes=e,this.annotations=r}static argsToString(t,e){if(t.length!==e.length)throw new Error("arity mismatch");return"("+t.map(((t,r)=>t.valueToString(e[r]))).join(", ")+")"}accept(t,e){return t.visitFunc(this,e)}covariant(t){if(Array.isArray(t)&&2===t.length&&t[0]&&t[0]._isPrincipal&&"string"==typeof t[1])return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue([t,e]){const r=t.toUint8Array(),n=tr(r.byteLength),i=Ke(new Uint8Array([1]),n,r),o=(new TextEncoder).encode(e),s=tr(o.byteLength);return Ke(new Uint8Array([1]),i,s,o)}_buildTypeTableImpl(t){this.argTypes.forEach((e=>e.buildTypeTable(t))),this.retTypes.forEach((e=>e.buildTypeTable(t)));const e=rr(-22),r=tr(this.argTypes.length),n=Ke(...this.argTypes.map((e=>e.encodeType(t)))),i=tr(this.retTypes.length),o=Ke(...this.retTypes.map((e=>e.encodeType(t)))),s=tr(this.annotations.length),a=Ke(...this.annotations.map((t=>this.encodeAnnotation(t))));t.add(this,Ke(e,r,n,i,o,s,a))}decodeValue(t){if(1!==Qe(t))throw new Error("Cannot decode function reference");const e=Or(t),r=Je(t,Number(er(t)));return[e,new TextDecoder("utf8",{fatal:!0}).decode(r)]}get name(){return`(${this.argTypes.map((t=>t.name)).join(", ")}) -> (${this.retTypes.map((t=>t.name)).join(", ")})${" "+this.annotations.join(" ")}`}valueToString([t,e]){return`func "${t.toText()}".${e}`}display(){return`(${this.argTypes.map((t=>t.display())).join(", ")})  (${this.retTypes.map((t=>t.display())).join(", ")})${" "+this.annotations.join(" ")}`}encodeAnnotation(t){if("query"===t)return new Uint8Array([1]);if("oneway"===t)return new Uint8Array([2]);if("composite_query"===t)return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class kr extends dr{constructor(t){super(),this._fields=Object.entries(t).sort(((t,e)=>t[0]<e[0]?-1:t[0]>e[0]?1:0))}accept(t,e){return t.visitService(this,e)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Pr(t)}`)}encodeValue(t){const e=t.toUint8Array(),r=tr(e.length);return Ke(new Uint8Array([1]),r,e)}_buildTypeTableImpl(t){this._fields.forEach((([e,r])=>r.buildTypeTable(t)));const e=rr(-23),r=tr(this._fields.length),n=this._fields.map((([e,r])=>{const n=(new TextEncoder).encode(e);return Ke(tr(n.length),n,r.encodeType(t))}));t.add(this,Ke(e,r,...n))}decodeValue(t){return Or(t)}get name(){const t=this._fields.map((([t,e])=>t+":"+e.name));return`service {${t.join("; ")}}`}valueToString(t){return`service "${t.toText()}"`}}function Pr(t){const e=JSON.stringify(t,((t,e)=>"bigint"==typeof e?`BigInt(${e})`:e));return e&&e.length>400?e.substring(0,397)+"...":e}function Cr(t,e){if(e.length<t.length)throw Error("Wrong number of message arguments");const r=new ur;t.forEach((t=>t.buildTypeTable(r)));const n=(new TextEncoder).encode(ar),i=r.encode(),o=tr(e.length),s=Ke(...t.map((t=>t.encodeType(r)))),a=Ke(...cr(t,e,((t,e)=>{try{t.covariant(e)}catch(t){throw new Error(t.message+"\n\n")}return t.encodeValue(e)})));return Ke(n,i,o,s,a)}function Dr(t,e){const r=new He(e);if(e.byteLength<ar.length)throw new Error("Message length smaller than magic number");const n=Je(r,ar.length),i=(new TextDecoder).decode(n);if(i!==ar)throw new Error("Wrong magic number: "+JSON.stringify(i));const[o,s]=function(t){const e=[],r=Number(er(t));for(let n=0;n<r;n++){const r=Number(nr(t));switch(r){case-18:case-19:{const n=Number(nr(t));e.push([r,n]);break}case-20:case-21:{const n=[];let i,o=Number(er(t));for(;o--;){const e=Number(er(t));if(e>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if("number"==typeof i&&i>=e)throw new Error("field id collision or not sorted");i=e;const r=Number(nr(t));n.push([e,r])}e.push([r,n]);break}case-22:{const n=[];let i=Number(er(t));for(;i--;)n.push(Number(nr(t)));const o=[];let s=Number(er(t));for(;s--;)o.push(Number(nr(t)));const a=[];let c=Number(er(t));for(;c--;){switch(Number(er(t))){case 1:a.push("query");break;case 2:a.push("oneway");break;case 3:a.push("composite_query");break;default:throw new Error("unknown annotation")}}e.push([r,[n,o,a]]);break}case-23:{let n=Number(er(t));const i=[];for(;n--;){const e=Number(er(t)),r=(new TextDecoder).decode(Je(t,e)),n=nr(t);i.push([r,n])}e.push([r,i]);break}default:throw new Error("Illegal op_code: "+r)}}const n=[],i=Number(er(t));for(let e=0;e<i;e++)n.push(Number(nr(t)));return[e,n]}(r);if(s.length<t.length)throw new Error("Wrong number of return values");const a=o.map((t=>cn()));function c(t){if(t<-24)throw new Error("future value not supported");if(t<0)switch(t){case-1:return Mr;case-2:return $r;case-3:return zr;case-4:return Vr;case-5:return Xr;case-6:return Jr;case-7:return Qr;case-8:return tn;case-9:return Hr;case-10:return Zr;case-11:return Wr;case-12:return Yr;case-13:return Gr;case-14:return Kr;case-15:return qr;case-16:return Fr;case-17:return Lr;case-24:return en;default:throw new Error("Illegal op_code: "+t)}if(t>=o.length)throw new Error("type index out of range");return a[t]}function u(t){switch(t[0]){case-19:return nn(c(t[1]));case-18:return on(c(t[1]));case-20:{const e={};for(const[r,n]of t[1]){e[`_${r}_`]=c(n)}const r=sn(e),n=r.tryAsTuple();return Array.isArray(n)?rn(...n):r}case-21:{const e={};for(const[r,n]of t[1]){e[`_${r}_`]=c(n)}return an(e)}case-22:{const[e,r,n]=t[1];return un(e.map((t=>c(t))),r.map((t=>c(t))),n)}case-23:{const e={},r=t[1];for(const[t,n]of r){let r=c(n);if(r instanceof Nr&&(r=r.getType()),!(r instanceof Ur))throw new Error("Illegal service definition: services can only contain functions");e[t]=r}return ln(e)}default:throw new Error("Illegal op_code: "+t[0])}}o.forEach(((t,e)=>{if(-22===t[0]){const r=u(t);a[e].fill(r)}})),o.forEach(((t,e)=>{if(-22!==t[0]){const r=u(t);a[e].fill(r)}}));const l=s.map((t=>c(t))),f=t.map(((t,e)=>t.decodeValue(r,l[e])));for(let e=t.length;e<l.length;e++)l[e].decodeValue(r,l[e]);if(r.byteLength>0)throw new Error("decode: Left-over bytes");return f}const Lr=new hr,Fr=new yr,jr=new pr,$r=new gr,Mr=new mr,qr=new br,Vr=new wr,zr=new vr,Gr=new xr(32),Kr=new xr(64),Hr=new Er(8),Zr=new Er(16),Wr=new Er(32),Yr=new Er(64),Xr=new _r(8),Jr=new _r(16),Qr=new _r(32),tn=new _r(64),en=new Rr;function rn(...t){return new Ar(t)}function nn(t){return new Br(t)}function on(t){return new Sr(t)}function sn(t){return new Ir(t)}function an(t){return new Tr(t)}function cn(){return new Nr}function un(t,e,r=[]){return new Ur(t,e,r)}function ln(t){return new kr(t)}var fn=Object.freeze({__proto__:null,Bool:$r,BoolClass:gr,ConstructType:dr,Empty:Lr,EmptyClass:hr,FixedIntClass:Er,FixedNatClass:_r,Float32:Gr,Float64:Kr,FloatClass:xr,Func:un,FuncClass:Ur,Int:Vr,Int16:Zr,Int32:Wr,Int64:Yr,Int8:Hr,IntClass:wr,Nat:zr,Nat16:Jr,Nat32:Qr,Nat64:tn,Nat8:Xr,NatClass:vr,Null:Mr,NullClass:mr,Opt:on,OptClass:Sr,PrimitiveType:fr,Principal:en,PrincipalClass:Rr,Rec:cn,RecClass:Nr,Record:sn,RecordClass:Ir,Reserved:Fr,ReservedClass:yr,Service:ln,ServiceClass:kr,Text:qr,TextClass:br,Tuple:rn,TupleClass:Ar,Type:lr,Unknown:jr,UnknownClass:pr,Variant:an,VariantClass:Tr,Vec:nn,VecClass:Br,Visitor:class{visitType(t,e){throw new Error("Not implemented")}visitPrimitive(t,e){return this.visitType(t,e)}visitEmpty(t,e){return this.visitPrimitive(t,e)}visitBool(t,e){return this.visitPrimitive(t,e)}visitNull(t,e){return this.visitPrimitive(t,e)}visitReserved(t,e){return this.visitPrimitive(t,e)}visitText(t,e){return this.visitPrimitive(t,e)}visitNumber(t,e){return this.visitPrimitive(t,e)}visitInt(t,e){return this.visitNumber(t,e)}visitNat(t,e){return this.visitNumber(t,e)}visitFloat(t,e){return this.visitPrimitive(t,e)}visitFixedInt(t,e){return this.visitNumber(t,e)}visitFixedNat(t,e){return this.visitNumber(t,e)}visitPrincipal(t,e){return this.visitPrimitive(t,e)}visitConstruct(t,e){return this.visitType(t,e)}visitVec(t,e,r){return this.visitConstruct(t,r)}visitOpt(t,e,r){return this.visitConstruct(t,r)}visitRecord(t,e,r){return this.visitConstruct(t,r)}visitTuple(t,e,r){const n=e.map(((t,e)=>[`_${e}_`,t]));return this.visitRecord(t,n,r)}visitVariant(t,e,r){return this.visitConstruct(t,r)}visitRec(t,e,r){return this.visitConstruct(e,r)}visitFunc(t,e){return this.visitConstruct(t,e)}visitService(t,e){return this.visitConstruct(t,e)}},decode:Dr,encode:Cr}),dn={},hn={};!function(t){var e=Nt,r=Ft,n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=function(t){+t!=t&&(t=0);return s.alloc(+t)},t.INSPECT_MAX_BYTES=50;var i=2147483647;function o(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return a(t,e,r)}function a(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|h(t,e),n=o(r),i=n.write(t,e);i!==r&&(n=n.slice(0,i));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(j(t,Uint8Array)){var e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(j(t,ArrayBuffer)||t&&j(t.buffer,ArrayBuffer))return f(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(j(t,SharedArrayBuffer)||t&&j(t.buffer,SharedArrayBuffer)))return f(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return s.from(n,e,r);var i=function(t){if(s.isBuffer(t)){var e=0|d(t.length),r=o(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||$(t.length)?o(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return c(t),o(t<0?0:0|d(t))}function l(t){for(var e=t.length<0?0:0|d(t.length),r=o(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function f(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,s.prototype),n}function d(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function h(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||j(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return D(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return L(t).length;default:if(i)return n?-1:D(t).length;e=(""+e).toLowerCase(),i=!0}}function p(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,r);case"utf8":case"utf-8":return B(this,e,r);case"ascii":return I(this,e,r);case"latin1":case"binary":return A(this,e,r);case"base64":return _(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function m(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),$(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=s.from(e,n)),s.isBuffer(e))return 0===e.length?-1:y(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):y(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function y(t,e,r,n,i){var o,s=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,r/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=r;o<a;o++)if(u(t,o)===u(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(r+c>a&&(r=a-c),o=r;o>=0;o--){for(var f=!0,d=0;d<c;d++)if(u(t,o+d)!==u(e,d)){f=!1;break}if(f)return o}return-1}function b(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if($(a))return s;t[r+s]=a}return s}function w(t,e,r,n){return F(D(e,t.length-r),t,r,n)}function v(t,e,r,n){return F(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function x(t,e,r,n){return F(L(e),t,r,n)}function E(t,e,r,n){return F(function(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=(r=t.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function _(t,r,n){return 0===r&&n===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(r,n))}function B(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,s,a,c,u=t[i],l=null,f=u>239?4:u>223?3:u>191?2:1;if(i+f<=r)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),i+=f}return function(t){var e=t.length;if(e<=S)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=S));return r}(n)}t.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,r){return a(t,e,r)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,r){return function(t,e,r){return c(t),t<=0?o(t):void 0!==e?"string"==typeof r?o(t).fill(e,r):o(t).fill(e):o(t)}(t,e,r)},s.allocUnsafe=function(t){return u(t)},s.allocUnsafeSlow=function(t){return u(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(j(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),j(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,i=0,o=Math.min(r,n);i<o;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=s.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var o=t[r];if(j(o,Uint8Array))i+o.length>n.length?s.from(o).copy(n,i):Uint8Array.prototype.set.call(n,o,i);else{if(!s.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i)}i+=o.length}return n},s.byteLength=h,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},s.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},s.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},s.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?B(this,0,t):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},n&&(s.prototype[n]=s.prototype.inspect),s.prototype.compare=function(t,e,r,n,i){if(j(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0),c=Math.min(o,a),u=this.slice(n,i),l=t.slice(e,r),f=0;f<c;++f)if(u[f]!==l[f]){o=u[f],a=l[f];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},s.prototype.indexOf=function(t,e,r){return m(this,t,e,r,!0)},s.prototype.lastIndexOf=function(t,e,r){return m(this,t,e,r,!1)},s.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return b(this,t,e,r);case"utf8":case"utf-8":return w(this,t,e,r);case"ascii":case"latin1":case"binary":return v(this,t,e,r);case"base64":return x(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function I(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function A(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function T(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=M[t[o]];return i}function N(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function O(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function R(t,e,r,n,i,o){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function U(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function k(t,e,n,i,o){return e=+e,n>>>=0,o||U(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function P(t,e,n,i,o){return e=+e,n>>>=0,o||U(t,0,n,8),r.write(t,e,n,i,52,8),n+8}s.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,s.prototype),n},s.prototype.readUintLE=s.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},s.prototype.readUintBE=s.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},s.prototype.readUint8=s.prototype.readUInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},s.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},s.prototype.readInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||O(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(t,e){t>>>=0,e||O(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readFloatLE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||R(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||R(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},s.prototype.writeUint8=s.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);R(this,t,e,r,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},s.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);R(this,t,e,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},s.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||R(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeFloatLE=function(t,e,r){return k(this,t,e,!0,r)},s.prototype.writeFloatBE=function(t,e,r){return k(this,t,e,!1,r)},s.prototype.writeDoubleLE=function(t,e,r){return P(this,t,e,!0,r)},s.prototype.writeDoubleBE=function(t,e,r){return P(this,t,e,!1,r)},s.prototype.copy=function(t,e,r,n){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},s.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var i=t.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{var a=s.isBuffer(t)?t:s.from(t,n),c=a.length;if(0===c)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<r-e;++o)this[o+e]=a[o%c]}return this};var C=/[^+/0-9A-Za-z-_]/g;function D(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function L(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(C,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function F(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function j(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function $(t){return t!=t}var M=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)e[n+i]=t[r]+t[i];return e}()}(hn);var pn,gn={exports:{}};pn=gn,function(t){var e,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,i=Math.floor,o="[BigNumber Error] ",s=o+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,d=1e9;function h(t){var e=0|t;return t>0||t===e?e:e-1}function p(t){for(var e,r,n=1,i=t.length,o=t[0]+"";n<i;){for(e=t[n++]+"",r=c-e.length;r--;e="0"+e);o+=e}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function g(t,e){var r,n,i=t.c,o=e.c,s=t.s,a=e.s,c=t.e,u=e.e;if(!s||!a)return null;if(r=i&&!i[0],n=o&&!o[0],r||n)return r?n?0:-a:s;if(s!=a)return s;if(r=s<0,n=c==u,!i||!o)return n?0:!i^r?1:-1;if(!n)return c>u^r?1:-1;for(a=(c=i.length)<(u=o.length)?c:u,s=0;s<a;s++)if(i[s]!=o[s])return i[s]>o[s]^r?1:-1;return c==u?0:c>u^r?1:-1}function m(t,e,r,n){if(t<e||t>r||t!==i(t))throw Error(o+(n||"Argument")+("number"==typeof t?t<e||t>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function y(t){var e=t.c.length-1;return h(t.e/c)==e&&t.c[e]%2!=0}function b(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function w(t,e,r){var n,i;if(e<0){for(i=r+".";++e;i+=r);t=i+t}else if(++e>(n=t.length)){for(i=r,e-=n;--e;i+=r);t+=i}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}e=function t(e){var v,x,E,_,B,S,I,A,T,N,O=z.prototype={constructor:z,toString:null,valueOf:null},R=new z(1),U=20,k=4,P=-7,C=21,D=-1e7,L=1e7,F=!1,j=1,$=0,M={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},q="0123456789abcdefghijklmnopqrstuvwxyz",V=!0;function z(t,e){var n,o,a,l,f,d,h,p,g=this;if(!(g instanceof z))return new z(t,e);if(null==e){if(t&&!0===t._isBigNumber)return g.s=t.s,void(!t.c||t.e>L?g.c=g.e=null:t.e<D?g.c=[g.e=0]:(g.e=t.e,g.c=t.c.slice()));if((d="number"==typeof t)&&0*t==0){if(g.s=1/t<0?(t=-t,-1):1,t===~~t){for(l=0,f=t;f>=10;f/=10,l++);return void(l>L?g.c=g.e=null:(g.e=l,g.c=[t]))}p=String(t)}else{if(!r.test(p=String(t)))return E(g,p,d);g.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(l=p.indexOf("."))>-1&&(p=p.replace(".","")),(f=p.search(/e/i))>0?(l<0&&(l=f),l+=+p.slice(f+1),p=p.substring(0,f)):l<0&&(l=p.length)}else{if(m(e,2,q.length,"Base"),10==e&&V)return Z(g=new z(t),U+g.e+1,k);if(p=String(t),d="number"==typeof t){if(0*t!=0)return E(g,p,d,e);if(g.s=1/t<0?(p=p.slice(1),-1):1,z.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(s+t)}else g.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(n=q.slice(0,e),l=f=0,h=p.length;f<h;f++)if(n.indexOf(o=p.charAt(f))<0){if("."==o){if(f>l){l=h;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,f=-1,l=0;continue}return E(g,String(t),d,e)}d=!1,(l=(p=x(p,e,10,g.s)).indexOf("."))>-1?p=p.replace(".",""):l=p.length}for(f=0;48===p.charCodeAt(f);f++);for(h=p.length;48===p.charCodeAt(--h););if(p=p.slice(f,++h)){if(h-=f,d&&z.DEBUG&&h>15&&(t>u||t!==i(t)))throw Error(s+g.s*t);if((l=l-f-1)>L)g.c=g.e=null;else if(l<D)g.c=[g.e=0];else{if(g.e=l,g.c=[],f=(l+1)%c,l<0&&(f+=c),f<h){for(f&&g.c.push(+p.slice(0,f)),h-=c;f<h;)g.c.push(+p.slice(f,f+=c));f=c-(p=p.slice(f)).length}else f-=h;for(;f--;p+="0");g.c.push(+p)}}else g.c=[g.e=0]}function G(t,e,r,n){var i,o,s,a,c;if(null==r?r=k:m(r,0,8),!t.c)return t.toString();if(i=t.c[0],s=t.e,null==e)c=p(t.c),c=1==n||2==n&&(s<=P||s>=C)?b(c,s):w(c,s,"0");else if(o=(t=Z(new z(t),e,r)).e,a=(c=p(t.c)).length,1==n||2==n&&(e<=o||o<=P)){for(;a<e;c+="0",a++);c=b(c,o)}else if(e-=s,c=w(c,o,"0"),o+1>a){if(--e>0)for(c+=".";e--;c+="0");}else if((e+=o-a)>0)for(o+1==a&&(c+=".");e--;c+="0");return t.s<0&&i?"-"+c:c}function K(t,e){for(var r,n=1,i=new z(t[0]);n<t.length;n++){if(!(r=new z(t[n])).s){i=r;break}e.call(i,r)&&(i=r)}return i}function H(t,e,r){for(var n=1,i=e.length;!e[--i];e.pop());for(i=e[0];i>=10;i/=10,n++);return(r=n+r*c-1)>L?t.c=t.e=null:r<D?t.c=[t.e=0]:(t.e=r,t.c=e),t}function Z(t,e,r,o){var s,u,f,d,h,p,g,m=t.c,y=l;if(m){t:{for(s=1,d=m[0];d>=10;d/=10,s++);if((u=e-s)<0)u+=c,f=e,g=(h=m[p=0])/y[s-f-1]%10|0;else if((p=n((u+1)/c))>=m.length){if(!o)break t;for(;m.length<=p;m.push(0));h=g=0,s=1,f=(u%=c)-c+1}else{for(h=d=m[p],s=1;d>=10;d/=10,s++);g=(f=(u%=c)-c+s)<0?0:h/y[s-f-1]%10|0}if(o=o||e<0||null!=m[p+1]||(f<0?h:h%y[s-f-1]),o=r<4?(g||o)&&(0==r||r==(t.s<0?3:2)):g>5||5==g&&(4==r||o||6==r&&(u>0?f>0?h/y[s-f]:0:m[p-1])%10&1||r==(t.s<0?8:7)),e<1||!m[0])return m.length=0,o?(e-=t.e+1,m[0]=y[(c-e%c)%c],t.e=-e||0):m[0]=t.e=0,t;if(0==u?(m.length=p,d=1,p--):(m.length=p+1,d=y[c-u],m[p]=f>0?i(h/y[s-f]%y[f])*d:0),o)for(;;){if(0==p){for(u=1,f=m[0];f>=10;f/=10,u++);for(f=m[0]+=d,d=1;f>=10;f/=10,d++);u!=d&&(t.e++,m[0]==a&&(m[0]=1));break}if(m[p]+=d,m[p]!=a)break;m[p--]=0,d=1}for(u=m.length;0===m[--u];m.pop());}t.e>L?t.c=t.e=null:t.e<D&&(t.c=[t.e=0])}return t}function W(t){var e,r=t.e;return null===r?t.toString():(e=p(t.c),e=r<=P||r>=C?b(e,r):w(e,r,"0"),t.s<0?"-"+e:e)}return z.clone=t,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(t){var e,r;if(null!=t){if("object"!=typeof t)throw Error(o+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(m(r=t[e],0,d,e),U=r),t.hasOwnProperty(e="ROUNDING_MODE")&&(m(r=t[e],0,8,e),k=r),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((r=t[e])&&r.pop?(m(r[0],-d,0,e),m(r[1],0,d,e),P=r[0],C=r[1]):(m(r,-d,d,e),P=-(C=r<0?-r:r))),t.hasOwnProperty(e="RANGE"))if((r=t[e])&&r.pop)m(r[0],-d,-1,e),m(r[1],1,d,e),D=r[0],L=r[1];else{if(m(r,-d,d,e),!r)throw Error(o+e+" cannot be zero: "+r);D=-(L=r<0?-r:r)}if(t.hasOwnProperty(e="CRYPTO")){if((r=t[e])!==!!r)throw Error(o+e+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw F=!r,Error(o+"crypto unavailable");F=r}else F=r}if(t.hasOwnProperty(e="MODULO_MODE")&&(m(r=t[e],0,9,e),j=r),t.hasOwnProperty(e="POW_PRECISION")&&(m(r=t[e],0,d,e),$=r),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(r=t[e]))throw Error(o+e+" not an object: "+r);M=r}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(r=t[e])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(o+e+" invalid: "+r);V="0123456789"==r.slice(0,10),q=r}}return{DECIMAL_PLACES:U,ROUNDING_MODE:k,EXPONENTIAL_AT:[P,C],RANGE:[D,L],CRYPTO:F,MODULO_MODE:j,POW_PRECISION:$,FORMAT:M,ALPHABET:q}},z.isBigNumber=function(t){if(!t||!0!==t._isBigNumber)return!1;if(!z.DEBUG)return!0;var e,r,n=t.c,s=t.e,u=t.s;t:if("[object Array]"=={}.toString.call(n)){if((1===u||-1===u)&&s>=-d&&s<=d&&s===i(s)){if(0===n[0]){if(0===s&&1===n.length)return!0;break t}if((e=(s+1)%c)<1&&(e+=c),String(n[0]).length==e){for(e=0;e<n.length;e++)if((r=n[e])<0||r>=a||r!==i(r))break t;if(0!==r)return!0}}}else if(null===n&&null===s&&(null===u||1===u||-1===u))return!0;throw Error(o+"Invalid BigNumber: "+t)},z.maximum=z.max=function(){return K(arguments,O.lt)},z.minimum=z.min=function(){return K(arguments,O.gt)},z.random=(_=9007199254740992,B=Math.random()*_&2097151?function(){return i(Math.random()*_)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,r,s,a,u,f=0,h=[],p=new z(R);if(null==t?t=U:m(t,0,d),a=n(t/c),F)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(a*=2));f<a;)(u=131072*e[f]+(e[f+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),e[f]=r[0],e[f+1]=r[1]):(h.push(u%1e14),f+=2);f=a/2}else{if(!crypto.randomBytes)throw F=!1,Error(o+"crypto unavailable");for(e=crypto.randomBytes(a*=7);f<a;)(u=281474976710656*(31&e[f])+1099511627776*e[f+1]+4294967296*e[f+2]+16777216*e[f+3]+(e[f+4]<<16)+(e[f+5]<<8)+e[f+6])>=9e15?crypto.randomBytes(7).copy(e,f):(h.push(u%1e14),f+=7);f=a/7}if(!F)for(;f<a;)(u=B())<9e15&&(h[f++]=u%1e14);for(a=h[--f],t%=c,a&&t&&(u=l[c-t],h[f]=i(a/u)*u);0===h[f];h.pop(),f--);if(f<0)h=[s=0];else{for(s=-1;0===h[0];h.splice(0,1),s-=c);for(f=1,u=h[0];u>=10;u/=10,f++);f<c&&(s-=c-f)}return p.e=s,p.c=h,p}),z.sum=function(){for(var t=1,e=arguments,r=new z(e[0]);t<e.length;)r=r.plus(e[t++]);return r},x=function(){var t="0123456789";function e(t,e,r,n){for(var i,o,s=[0],a=0,c=t.length;a<c;){for(o=s.length;o--;s[o]*=e);for(s[0]+=n.indexOf(t.charAt(a++)),i=0;i<s.length;i++)s[i]>r-1&&(null==s[i+1]&&(s[i+1]=0),s[i+1]+=s[i]/r|0,s[i]%=r)}return s.reverse()}return function(r,n,i,o,s){var a,c,u,l,f,d,h,g,m=r.indexOf("."),y=U,b=k;for(m>=0&&(l=$,$=0,r=r.replace(".",""),d=(g=new z(n)).pow(r.length-m),$=l,g.c=e(w(p(d.c),d.e,"0"),10,i,t),g.e=g.c.length),u=l=(h=e(r,n,i,s?(a=q,t):(a=t,q))).length;0==h[--l];h.pop());if(!h[0])return a.charAt(0);if(m<0?--u:(d.c=h,d.e=u,d.s=o,h=(d=v(d,g,y,b,i)).c,f=d.r,u=d.e),m=h[c=u+y+1],l=i/2,f=f||c<0||null!=h[c+1],f=b<4?(null!=m||f)&&(0==b||b==(d.s<0?3:2)):m>l||m==l&&(4==b||f||6==b&&1&h[c-1]||b==(d.s<0?8:7)),c<1||!h[0])r=f?w(a.charAt(1),-y,a.charAt(0)):a.charAt(0);else{if(h.length=c,f)for(--i;++h[--c]>i;)h[c]=0,c||(++u,h=[1].concat(h));for(l=h.length;!h[--l];);for(m=0,r="";m<=l;r+=a.charAt(h[m++]));r=w(r,u,a.charAt(0))}return r}}(),v=function(){function t(t,e,r){var n,i,o,s,a=0,c=t.length,u=e%f,l=e/f|0;for(t=t.slice();c--;)a=((i=u*(o=t[c]%f)+(n=l*o+(s=t[c]/f|0)*u)%f*f+a)/r|0)+(n/f|0)+l*s,t[c]=i%r;return a&&(t=[a].concat(t)),t}function e(t,e,r,n){var i,o;if(r!=n)o=r>n?1:-1;else for(i=o=0;i<r;i++)if(t[i]!=e[i]){o=t[i]>e[i]?1:-1;break}return o}function r(t,e,r,n){for(var i=0;r--;)t[r]-=i,i=t[r]<e[r]?1:0,t[r]=i*n+t[r]-e[r];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(n,o,s,u,l){var f,d,p,g,m,y,b,w,v,x,E,_,B,S,I,A,T,N=n.s==o.s?1:-1,O=n.c,R=o.c;if(!(O&&O[0]&&R&&R[0]))return new z(n.s&&o.s&&(O?!R||O[0]!=R[0]:R)?O&&0==O[0]||!R?0*N:N/0:NaN);for(v=(w=new z(N)).c=[],N=s+(d=n.e-o.e)+1,l||(l=a,d=h(n.e/c)-h(o.e/c),N=N/c|0),p=0;R[p]==(O[p]||0);p++);if(R[p]>(O[p]||0)&&d--,N<0)v.push(1),g=!0;else{for(S=O.length,A=R.length,p=0,N+=2,(m=i(l/(R[0]+1)))>1&&(R=t(R,m,l),O=t(O,m,l),A=R.length,S=O.length),B=A,E=(x=O.slice(0,A)).length;E<A;x[E++]=0);T=R.slice(),T=[0].concat(T),I=R[0],R[1]>=l/2&&I++;do{if(m=0,(f=e(R,x,A,E))<0){if(_=x[0],A!=E&&(_=_*l+(x[1]||0)),(m=i(_/I))>1)for(m>=l&&(m=l-1),b=(y=t(R,m,l)).length,E=x.length;1==e(y,x,b,E);)m--,r(y,A<b?T:R,b,l),b=y.length,f=1;else 0==m&&(f=m=1),b=(y=R.slice()).length;if(b<E&&(y=[0].concat(y)),r(x,y,E,l),E=x.length,-1==f)for(;e(R,x,A,E)<1;)m++,r(x,A<E?T:R,E,l),E=x.length}else 0===f&&(m++,x=[0]);v[p++]=m,x[0]?x[E++]=O[B]||0:(x=[O[B]],E=1)}while((B++<S||null!=x[0])&&N--);g=null!=x[0],v[0]||v.splice(0,1)}if(l==a){for(p=1,N=v[0];N>=10;N/=10,p++);Z(w,s+(w.e=p+d*c-1)+1,u,g)}else w.e=d,w.r=+g;return w}}(),S=/^(-?)0([xbo])(?=\w[\w.]*$)/i,I=/^([^.]+)\.$/,A=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,N=/^\s*\+(?=[\w.])|^\s+|\s+$/g,E=function(t,e,r,n){var i,s=r?e:e.replace(N,"");if(T.test(s))t.s=isNaN(s)?null:s<0?-1:1;else{if(!r&&(s=s.replace(S,(function(t,e,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?t:e})),n&&(i=n,s=s.replace(I,"$1").replace(A,"0.$1")),e!=s))return new z(s,i);if(z.DEBUG)throw Error(o+"Not a"+(n?" base "+n:"")+" number: "+e);t.s=null}t.c=t.e=null},O.absoluteValue=O.abs=function(){var t=new z(this);return t.s<0&&(t.s=1),t},O.comparedTo=function(t,e){return g(this,new z(t,e))},O.decimalPlaces=O.dp=function(t,e){var r,n,i,o=this;if(null!=t)return m(t,0,d),null==e?e=k:m(e,0,8),Z(new z(o),t+o.e+1,e);if(!(r=o.c))return null;if(n=((i=r.length-1)-h(this.e/c))*c,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},O.dividedBy=O.div=function(t,e){return v(this,new z(t,e),U,k)},O.dividedToIntegerBy=O.idiv=function(t,e){return v(this,new z(t,e),0,1)},O.exponentiatedBy=O.pow=function(t,e){var r,s,a,u,l,f,d,h,p=this;if((t=new z(t)).c&&!t.isInteger())throw Error(o+"Exponent not an integer: "+W(t));if(null!=e&&(e=new z(e)),l=t.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!t.c||!t.c[0])return h=new z(Math.pow(+W(p),l?2-y(t):+W(t))),e?h.mod(e):h;if(f=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new z(NaN);(s=!f&&p.isInteger()&&e.isInteger())&&(p=p.mod(e))}else{if(t.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||l&&p.c[1]>=24e7:p.c[0]<8e13||l&&p.c[0]<=9999975e7)))return u=p.s<0&&y(t)?-0:0,p.e>-1&&(u=1/u),new z(f?1/u:u);$&&(u=n($/c+2))}for(l?(r=new z(.5),f&&(t.s=1),d=y(t)):d=(a=Math.abs(+W(t)))%2,h=new z(R);;){if(d){if(!(h=h.times(p)).c)break;u?h.c.length>u&&(h.c.length=u):s&&(h=h.mod(e))}if(a){if(0===(a=i(a/2)))break;d=a%2}else if(Z(t=t.times(r),t.e+1,1),t.e>14)d=y(t);else{if(0==(a=+W(t)))break;d=a%2}p=p.times(p),u?p.c&&p.c.length>u&&(p.c.length=u):s&&(p=p.mod(e))}return s?h:(f&&(h=R.div(h)),e?h.mod(e):u?Z(h,$,k,void 0):h)},O.integerValue=function(t){var e=new z(this);return null==t?t=k:m(t,0,8),Z(e,e.e+1,t)},O.isEqualTo=O.eq=function(t,e){return 0===g(this,new z(t,e))},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(t,e){return g(this,new z(t,e))>0},O.isGreaterThanOrEqualTo=O.gte=function(t,e){return 1===(e=g(this,new z(t,e)))||0===e},O.isInteger=function(){return!!this.c&&h(this.e/c)>this.c.length-2},O.isLessThan=O.lt=function(t,e){return g(this,new z(t,e))<0},O.isLessThanOrEqualTo=O.lte=function(t,e){return-1===(e=g(this,new z(t,e)))||0===e},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&0==this.c[0]},O.minus=function(t,e){var r,n,i,o,s=this,u=s.s;if(e=(t=new z(t,e)).s,!u||!e)return new z(NaN);if(u!=e)return t.s=-e,s.plus(t);var l=s.e/c,f=t.e/c,d=s.c,p=t.c;if(!l||!f){if(!d||!p)return d?(t.s=-e,t):new z(p?s:NaN);if(!d[0]||!p[0])return p[0]?(t.s=-e,t):new z(d[0]?s:3==k?-0:0)}if(l=h(l),f=h(f),d=d.slice(),u=l-f){for((o=u<0)?(u=-u,i=d):(f=l,i=p),i.reverse(),e=u;e--;i.push(0));i.reverse()}else for(n=(o=(u=d.length)<(e=p.length))?u:e,u=e=0;e<n;e++)if(d[e]!=p[e]){o=d[e]<p[e];break}if(o&&(i=d,d=p,p=i,t.s=-t.s),(e=(n=p.length)-(r=d.length))>0)for(;e--;d[r++]=0);for(e=a-1;n>u;){if(d[--n]<p[n]){for(r=n;r&&!d[--r];d[r]=e);--d[r],d[n]+=a}d[n]-=p[n]}for(;0==d[0];d.splice(0,1),--f);return d[0]?H(t,d,f):(t.s=3==k?-1:1,t.c=[t.e=0],t)},O.modulo=O.mod=function(t,e){var r,n,i=this;return t=new z(t,e),!i.c||!t.s||t.c&&!t.c[0]?new z(NaN):!t.c||i.c&&!i.c[0]?new z(i):(9==j?(n=t.s,t.s=1,r=v(i,t,0,3),t.s=n,r.s*=n):r=v(i,t,0,j),(t=i.minus(r.times(t))).c[0]||1!=j||(t.s=i.s),t)},O.multipliedBy=O.times=function(t,e){var r,n,i,o,s,u,l,d,p,g,m,y,b,w,v,x=this,E=x.c,_=(t=new z(t,e)).c;if(!(E&&_&&E[0]&&_[0]))return!x.s||!t.s||E&&!E[0]&&!_||_&&!_[0]&&!E?t.c=t.e=t.s=null:(t.s*=x.s,E&&_?(t.c=[0],t.e=0):t.c=t.e=null),t;for(n=h(x.e/c)+h(t.e/c),t.s*=x.s,(l=E.length)<(g=_.length)&&(b=E,E=_,_=b,i=l,l=g,g=i),i=l+g,b=[];i--;b.push(0));for(w=a,v=f,i=g;--i>=0;){for(r=0,m=_[i]%v,y=_[i]/v|0,o=i+(s=l);o>i;)r=((d=m*(d=E[--s]%v)+(u=y*d+(p=E[s]/v|0)*m)%v*v+b[o]+r)/w|0)+(u/v|0)+y*p,b[o--]=d%w;b[o]=r}return r?++n:b.splice(0,1),H(t,b,n)},O.negated=function(){var t=new z(this);return t.s=-t.s||null,t},O.plus=function(t,e){var r,n=this,i=n.s;if(e=(t=new z(t,e)).s,!i||!e)return new z(NaN);if(i!=e)return t.s=-e,n.minus(t);var o=n.e/c,s=t.e/c,u=n.c,l=t.c;if(!o||!s){if(!u||!l)return new z(i/0);if(!u[0]||!l[0])return l[0]?t:new z(u[0]?n:0*i)}if(o=h(o),s=h(s),u=u.slice(),i=o-s){for(i>0?(s=o,r=l):(i=-i,r=u),r.reverse();i--;r.push(0));r.reverse()}for((i=u.length)-(e=l.length)<0&&(r=l,l=u,u=r,e=i),i=0;e;)i=(u[--e]=u[e]+l[e]+i)/a|0,u[e]=a===u[e]?0:u[e]%a;return i&&(u=[i].concat(u),++s),H(t,u,s)},O.precision=O.sd=function(t,e){var r,n,i,o=this;if(null!=t&&t!==!!t)return m(t,1,d),null==e?e=k:m(e,0,8),Z(new z(o),t,e);if(!(r=o.c))return null;if(n=(i=r.length-1)*c+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return t&&o.e+1>n&&(n=o.e+1),n},O.shiftedBy=function(t){return m(t,-9007199254740991,u),this.times("1e"+t)},O.squareRoot=O.sqrt=function(){var t,e,r,n,i,o=this,s=o.c,a=o.s,c=o.e,u=U+4,l=new z("0.5");if(1!==a||!s||!s[0])return new z(!a||a<0&&(!s||s[0])?NaN:s?o:1/0);if(0==(a=Math.sqrt(+W(o)))||a==1/0?(((e=p(s)).length+c)%2==0&&(e+="0"),a=Math.sqrt(+e),c=h((c+1)/2)-(c<0||c%2),r=new z(e=a==1/0?"5e"+c:(e=a.toExponential()).slice(0,e.indexOf("e")+1)+c)):r=new z(a+""),r.c[0])for((a=(c=r.e)+u)<3&&(a=0);;)if(i=r,r=l.times(i.plus(v(o,i,u,1))),p(i.c).slice(0,a)===(e=p(r.c)).slice(0,a)){if(r.e<c&&--a,"9999"!=(e=e.slice(a-3,a+1))&&(n||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(Z(r,r.e+U+2,1),t=!r.times(r).eq(o));break}if(!n&&(Z(i,i.e+U+2,0),i.times(i).eq(o))){r=i;break}u+=4,a+=4,n=1}return Z(r,r.e+U+1,k,t)},O.toExponential=function(t,e){return null!=t&&(m(t,0,d),t++),G(this,t,e,1)},O.toFixed=function(t,e){return null!=t&&(m(t,0,d),t=t+this.e+1),G(this,t,e)},O.toFormat=function(t,e,r){var n,i=this;if(null==r)null!=t&&e&&"object"==typeof e?(r=e,e=null):t&&"object"==typeof t?(r=t,t=e=null):r=M;else if("object"!=typeof r)throw Error(o+"Argument not an object: "+r);if(n=i.toFixed(t,e),i.c){var s,a=n.split("."),c=+r.groupSize,u=+r.secondaryGroupSize,l=r.groupSeparator||"",f=a[0],d=a[1],h=i.s<0,p=h?f.slice(1):f,g=p.length;if(u&&(s=c,c=u,u=s,g-=s),c>0&&g>0){for(s=g%c||c,f=p.substr(0,s);s<g;s+=c)f+=l+p.substr(s,c);u>0&&(f+=l+p.slice(s)),h&&(f="-"+f)}n=d?f+(r.decimalSeparator||"")+((u=+r.fractionGroupSize)?d.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):d):f}return(r.prefix||"")+n+(r.suffix||"")},O.toFraction=function(t){var e,r,n,i,s,a,u,f,d,h,g,m,y=this,b=y.c;if(null!=t&&(!(u=new z(t)).isInteger()&&(u.c||1!==u.s)||u.lt(R)))throw Error(o+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+W(u));if(!b)return new z(y);for(e=new z(R),d=r=new z(R),n=f=new z(R),m=p(b),s=e.e=m.length-y.e-1,e.c[0]=l[(a=s%c)<0?c+a:a],t=!t||u.comparedTo(e)>0?s>0?e:d:u,a=L,L=1/0,u=new z(m),f.c[0]=0;h=v(u,e,0,1),1!=(i=r.plus(h.times(n))).comparedTo(t);)r=n,n=i,d=f.plus(h.times(i=d)),f=i,e=u.minus(h.times(i=e)),u=i;return i=v(t.minus(r),n,0,1),f=f.plus(i.times(d)),r=r.plus(i.times(n)),f.s=d.s=y.s,g=v(d,n,s*=2,k).minus(y).abs().comparedTo(v(f,r,s,k).minus(y).abs())<1?[d,n]:[f,r],L=a,g},O.toNumber=function(){return+W(this)},O.toPrecision=function(t,e){return null!=t&&m(t,1,d),G(this,t,e,2)},O.toString=function(t){var e,r=this,n=r.s,i=r.e;return null===i?n?(e="Infinity",n<0&&(e="-"+e)):e="NaN":(null==t?e=i<=P||i>=C?b(p(r.c),i):w(p(r.c),i,"0"):10===t&&V?e=w(p((r=Z(new z(r),U+i+1,k)).c),r.e,"0"):(m(t,2,q.length,"Base"),e=x(w(p(r.c),i,"0"),10,t,n,!0)),n<0&&r.c[0]&&(e="-"+e)),e},O.valueOf=O.toJSON=function(){return W(this)},O._isBigNumber=!0,null!=e&&z.set(e),z}(),e.default=e.BigNumber=e,pn.exports?pn.exports=e:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=e)}(It);var mn=gn.exports,yn={},bn={};const wn=mn.BigNumber;bn.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},bn.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36},bn.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},bn.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},bn.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")},bn.SHIFT32=Math.pow(2,32),bn.SHIFT16=Math.pow(2,16),bn.MAX_SAFE_HIGH=2097151,bn.NEG_ONE=new wn(-1),bn.TEN=new wn(10),bn.TWO=new wn(2),bn.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5},function(t){const{Buffer:e}=hn,r=mn.BigNumber,n=bn,i=n.SHIFT32,o=n.SHIFT16;t.parseHalf=function(t){var e,r,n;return n=128&t[0]?-1:1,e=(124&t[0])>>2,r=(3&t[0])<<8|t[1],e?31===e?n*(r?NaN:Infinity):n*Math.pow(2,e-25)*(1024+r):5.960464477539063e-8*n*r},t.arrayBufferToBignumber=function(t){const e=t.byteLength;let n="";for(let r=0;r<e;r++)n+=(i=t[r])<16?"0"+i.toString(16):i.toString(16);var i;return new r(n,16)},t.buildMap=t=>{const e=new Map,r=Object.keys(t),n=r.length;for(let i=0;i<n;i++)e.set(r[i],t[r[i]]);return e},t.buildInt32=(t,e)=>t*o+e,t.buildInt64=(e,n,o,s)=>{const a=t.buildInt32(e,n),c=t.buildInt32(o,s);return a>2097151?new r(a).times(i).plus(c):a*i+c},t.writeHalf=function(t,r){const n=e.allocUnsafe(4);n.writeFloatBE(r,0);const i=n.readUInt32BE(0);if(0!=(8191&i))return!1;var o=i>>16&32768;const s=i>>23&255,a=8388607&i;if(s>=113&&s<=142)o+=(s-112<<10)+(a>>13);else{if(!(s>=103&&s<113))return!1;if(a&(1<<126-s)-1)return!1;o+=a+8388608>>126-s}return t.writeUInt16BE(o,0),!0},t.keySorter=function(t,e){var r=t[0].byteLength,n=e[0].byteLength;return r>n?1:n>r?-1:t[0].compare(e[0])},t.isNegativeZero=t=>0===t&&1/t<0,t.nextPowerOf2=t=>{let e=0;if(t&&!(t&t-1))return t;for(;0!==t;)t>>=1,e+=1;return 1<<e}}(yn);const vn=bn,xn=vn.MT,En=vn.SIMPLE,_n=vn.SYMS;var Bn=class t{constructor(t){if("number"!=typeof t)throw new Error("Invalid Simple type: "+typeof t);if(t<0||t>255||(0|t)!==t)throw new Error("value must be a small positive integer: "+t);this.value=t}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(t){return t._pushInt(this.value,xn.SIMPLE_FLOAT)}static isSimple(e){return e instanceof t}static decode(e,r){switch(null==r&&(r=!0),e){case En.FALSE:return!1;case En.TRUE:return!0;case En.NULL:return r?null:_n.NULL;case En.UNDEFINED:return r?void 0:_n.UNDEFINED;case-1:if(!r)throw new Error("Invalid BREAK");return _n.BREAK;default:return new t(e)}}};var Sn=class t{constructor(t,e,r){if(this.tag=t,this.value=e,this.err=r,"number"!=typeof this.tag)throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(0|this.tag)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(t){return t._pushTag(this.tag),t.pushAny(this.value)}convert(e){var r,n;if("function"!=typeof(n=null!=e?e[this.tag]:void 0)&&"function"!=typeof(n=t["_tag"+this.tag]))return this;try{return n.call(t,this.value)}catch(t){return r=t,this.err=r,this}}};const In=self.location?self.location.protocol+"//"+self.location.host:"",An=self.URL;var Tn={URLWithLegacySupport:class{constructor(t="",e=In){this.super=new An(t,e),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(t){this.super.hash=t}set host(t){this.super.host=t}set hostname(t){this.super.hostname=t}set href(t){this.super.href=t}set origin(t){this.super.origin=t}set password(t){this.super.password=t}set pathname(t){this.super.pathname=t}set port(t){this.super.port=t}set protocol(t){this.super.protocol=t}set search(t){this.super.search=t}set searchParams(t){this.super.searchParams=t}set username(t){this.super.username=t}createObjectURL(t){return this.super.createObjectURL(t)}revokeObjectURL(t){this.super.revokeObjectURL(t)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:In,format:function(t){if("string"==typeof t){return new An(t).toString()}if(!(t instanceof An)){const e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",n=t.port?":"+t.port:"",i=t.protocol?t.protocol+"//":"",o=t.host||"",s=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),c=t.hash||"",u=t.pathname||"";return`${i}${e||r}${o||s+n}${t.path||u+a}${c}`}}};const{URLWithLegacySupport:Nn,format:On}=Tn;const{URLWithLegacySupport:Rn,format:Un,URLSearchParams:kn,defaultBase:Pn}=Tn;var Cn={URL:Rn,URLSearchParams:kn,format:Un,relative:(t,e={},r={},n)=>{let i,o=e.protocol?e.protocol.replace(":",""):"http";o=(r[o]||n||o)+":";try{i=new Nn(t)}catch(t){i={}}const s=Object.assign({},e,{protocol:o||i.protocol,host:e.host||i.host});return new Nn(t,On(s)).toString()},defaultBase:Pn};const{Buffer:Dn}=hn,Ln=Ft,Fn=mn.BigNumber,jn=function(t,e,r){"use asm";var n=new t.Uint8Array(r),i=e.pushInt,o=e.pushInt32,s=e.pushInt32Neg,a=e.pushInt64,c=e.pushInt64Neg,u=e.pushFloat,l=e.pushFloatSingle,f=e.pushFloatDouble,d=e.pushTrue,h=e.pushFalse,p=e.pushUndefined,g=e.pushNull,m=e.pushInfinity,y=e.pushInfinityNeg,b=e.pushNaN,w=e.pushNaNNeg,v=e.pushArrayStart,x=e.pushArrayStartFixed,E=e.pushArrayStartFixed32,_=e.pushArrayStartFixed64,B=e.pushObjectStart,S=e.pushObjectStartFixed,I=e.pushObjectStartFixed32,A=e.pushObjectStartFixed64,T=e.pushByteString,N=e.pushByteStringStart,O=e.pushUtf8String,R=e.pushUtf8StringStart,U=e.pushSimpleUnassigned,k=e.pushTagStart,P=e.pushTagStart4,C=e.pushTagStart8,D=e.pushTagUnassigned,L=e.pushBreak,F=t.Math.pow,j=0,$=0,M=0;function q(t){t=t|0;j=0;$=t;while((j|0)<($|0)){M=Yt[n[j]&255](n[j]|0)|0;if((M|0)>0){break}}return M|0}function V(t){t=t|0;if(((j|0)+(t|0)|0)<($|0)){return 0}return 1}function z(t){t=t|0;return n[t|0]<<8|n[t+1|0]|0}function G(t){t=t|0;return n[t|0]<<24|n[t+1|0]<<16|n[t+2|0]<<8|n[t+3|0]|0}function K(t){t=t|0;i(t|0);j=j+1|0;return 0}function H(t){t=t|0;if(V(1)|0){return 1}i(n[j+1|0]|0);j=j+2|0;return 0}function Z(t){t=t|0;if(V(2)|0){return 1}i(z(j+1|0)|0);j=j+3|0;return 0}function W(t){t=t|0;if(V(4)|0){return 1}o(z(j+1|0)|0,z(j+3|0)|0);j=j+5|0;return 0}function Y(t){t=t|0;if(V(8)|0){return 1}a(z(j+1|0)|0,z(j+3|0)|0,z(j+5|0)|0,z(j+7|0)|0);j=j+9|0;return 0}function X(t){t=t|0;i(-1-(t-32|0)|0);j=j+1|0;return 0}function J(t){t=t|0;if(V(1)|0){return 1}i(-1-(n[j+1|0]|0)|0);j=j+2|0;return 0}function Q(t){t=t|0;var e=0;if(V(2)|0){return 1}e=z(j+1|0)|0;i(-1-(e|0)|0);j=j+3|0;return 0}function tt(t){t=t|0;if(V(4)|0){return 1}s(z(j+1|0)|0,z(j+3|0)|0);j=j+5|0;return 0}function et(t){t=t|0;if(V(8)|0){return 1}c(z(j+1|0)|0,z(j+3|0)|0,z(j+5|0)|0,z(j+7|0)|0);j=j+9|0;return 0}function rt(t){t=t|0;var e=0;var r=0;var n=0;n=t-64|0;if(V(n|0)|0){return 1}e=j+1|0;r=(j+1|0)+(n|0)|0;T(e|0,r|0);j=r|0;return 0}function nt(t){t=t|0;var e=0;var r=0;var i=0;if(V(1)|0){return 1}i=n[j+1|0]|0;e=j+2|0;r=(j+2|0)+(i|0)|0;if(V(i+1|0)|0){return 1}T(e|0,r|0);j=r|0;return 0}function it(t){t=t|0;var e=0;var r=0;var n=0;if(V(2)|0){return 1}n=z(j+1|0)|0;e=j+3|0;r=(j+3|0)+(n|0)|0;if(V(n+2|0)|0){return 1}T(e|0,r|0);j=r|0;return 0}function ot(t){t=t|0;var e=0;var r=0;var n=0;if(V(4)|0){return 1}n=G(j+1|0)|0;e=j+5|0;r=(j+5|0)+(n|0)|0;if(V(n+4|0)|0){return 1}T(e|0,r|0);j=r|0;return 0}function st(t){t=t|0;return 1}function at(t){t=t|0;N();j=j+1|0;return 0}function ct(t){t=t|0;var e=0;var r=0;var n=0;n=t-96|0;if(V(n|0)|0){return 1}e=j+1|0;r=(j+1|0)+(n|0)|0;O(e|0,r|0);j=r|0;return 0}function ut(t){t=t|0;var e=0;var r=0;var i=0;if(V(1)|0){return 1}i=n[j+1|0]|0;e=j+2|0;r=(j+2|0)+(i|0)|0;if(V(i+1|0)|0){return 1}O(e|0,r|0);j=r|0;return 0}function lt(t){t=t|0;var e=0;var r=0;var n=0;if(V(2)|0){return 1}n=z(j+1|0)|0;e=j+3|0;r=(j+3|0)+(n|0)|0;if(V(n+2|0)|0){return 1}O(e|0,r|0);j=r|0;return 0}function ft(t){t=t|0;var e=0;var r=0;var n=0;if(V(4)|0){return 1}n=G(j+1|0)|0;e=j+5|0;r=(j+5|0)+(n|0)|0;if(V(n+4|0)|0){return 1}O(e|0,r|0);j=r|0;return 0}function dt(t){t=t|0;return 1}function ht(t){t=t|0;R();j=j+1|0;return 0}function pt(t){t=t|0;x(t-128|0);j=j+1|0;return 0}function gt(t){t=t|0;if(V(1)|0){return 1}x(n[j+1|0]|0);j=j+2|0;return 0}function mt(t){t=t|0;if(V(2)|0){return 1}x(z(j+1|0)|0);j=j+3|0;return 0}function yt(t){t=t|0;if(V(4)|0){return 1}E(z(j+1|0)|0,z(j+3|0)|0);j=j+5|0;return 0}function bt(t){t=t|0;if(V(8)|0){return 1}_(z(j+1|0)|0,z(j+3|0)|0,z(j+5|0)|0,z(j+7|0)|0);j=j+9|0;return 0}function wt(t){t=t|0;v();j=j+1|0;return 0}function vt(t){t=t|0;var e=0;e=t-160|0;if(V(e|0)|0){return 1}S(e|0);j=j+1|0;return 0}function xt(t){t=t|0;if(V(1)|0){return 1}S(n[j+1|0]|0);j=j+2|0;return 0}function Et(t){t=t|0;if(V(2)|0){return 1}S(z(j+1|0)|0);j=j+3|0;return 0}function _t(t){t=t|0;if(V(4)|0){return 1}I(z(j+1|0)|0,z(j+3|0)|0);j=j+5|0;return 0}function Bt(t){t=t|0;if(V(8)|0){return 1}A(z(j+1|0)|0,z(j+3|0)|0,z(j+5|0)|0,z(j+7|0)|0);j=j+9|0;return 0}function St(t){t=t|0;B();j=j+1|0;return 0}function It(t){t=t|0;k(t-192|0|0);j=j+1|0;return 0}function At(t){t=t|0;k(t|0);j=j+1|0;return 0}function Tt(t){t=t|0;k(t|0);j=j+1|0;return 0}function Nt(t){t=t|0;k(t|0);j=j+1|0;return 0}function Ot(t){t=t|0;k(t|0);j=j+1|0;return 0}function Rt(t){t=t|0;k(t-192|0|0);j=j+1|0;return 0}function Ut(t){t=t|0;k(t|0);j=j+1|0;return 0}function kt(t){t=t|0;k(t|0);j=j+1|0;return 0}function Pt(t){t=t|0;k(t|0);j=j+1|0;return 0}function Ct(t){t=t|0;if(V(1)|0){return 1}k(n[j+1|0]|0);j=j+2|0;return 0}function Dt(t){t=t|0;if(V(2)|0){return 1}k(z(j+1|0)|0);j=j+3|0;return 0}function Lt(t){t=t|0;if(V(4)|0){return 1}P(z(j+1|0)|0,z(j+3|0)|0);j=j+5|0;return 0}function Ft(t){t=t|0;if(V(8)|0){return 1}C(z(j+1|0)|0,z(j+3|0)|0,z(j+5|0)|0,z(j+7|0)|0);j=j+9|0;return 0}function jt(t){t=t|0;U((t|0)-224|0);j=j+1|0;return 0}function $t(t){t=t|0;h();j=j+1|0;return 0}function Mt(t){t=t|0;d();j=j+1|0;return 0}function qt(t){t=t|0;g();j=j+1|0;return 0}function Vt(t){t=t|0;p();j=j+1|0;return 0}function zt(t){t=t|0;if(V(1)|0){return 1}U(n[j+1|0]|0);j=j+2|0;return 0}function Gt(t){t=t|0;var e=0;var r=0;var i=1.0;var o=0.0;var s=0.0;var a=0.0;if(V(2)|0){return 1}e=n[j+1|0]|0;r=n[j+2|0]|0;if((e|0)&0x80){i=-1.0}o=+(((e|0)&0x7C)>>2);s=+(((e|0)&0x03)<<8|r);if(+o==0.0){u(+(+i*+5.9604644775390625e-8*+s))}else if(+o==31.0){if(+i==1.0){if(+s>0.0){b()}else{m()}}else{if(+s>0.0){w()}else{y()}}}else{u(+(+i*F(+2,+(+o-25.0))*+(1024.0+s)))}j=j+3|0;return 0}function Kt(t){t=t|0;if(V(4)|0){return 1}l(n[j+1|0]|0,n[j+2|0]|0,n[j+3|0]|0,n[j+4|0]|0);j=j+5|0;return 0}function Ht(t){t=t|0;if(V(8)|0){return 1}f(n[j+1|0]|0,n[j+2|0]|0,n[j+3|0]|0,n[j+4|0]|0,n[j+5|0]|0,n[j+6|0]|0,n[j+7|0]|0,n[j+8|0]|0);j=j+9|0;return 0}function Zt(t){t=t|0;return 1}function Wt(t){t=t|0;L();j=j+1|0;return 0}var Yt=[K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,H,Z,W,Y,Zt,Zt,Zt,Zt,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,J,Q,tt,et,Zt,Zt,Zt,Zt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,nt,it,ot,st,Zt,Zt,Zt,at,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ut,lt,ft,dt,Zt,Zt,Zt,ht,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,gt,mt,yt,bt,Zt,Zt,Zt,wt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,xt,Et,_t,Bt,Zt,Zt,Zt,St,It,It,It,It,It,It,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Ct,Dt,Lt,Ft,Zt,Zt,Zt,Zt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,jt,$t,Mt,qt,Vt,zt,Gt,Kt,Ht,Zt,Zt,Zt,Wt];return{parse:q}},$n=yn,Mn=bn,qn=Bn,Vn=Sn,{URL:zn}=Cn;let Gn=class t{constructor(t){!(t=t||{}).size||t.size<65536?t.size=65536:t.size=$n.nextPowerOf2(t.size),this._heap=new ArrayBuffer(t.size),this._heap8=new Uint8Array(this._heap),this._buffer=Dn.from(this._heap),this._reset(),this._knownTags=Object.assign({0:t=>new Date(t),1:t=>new Date(1e3*t),2:t=>$n.arrayBufferToBignumber(t),3:t=>Mn.NEG_ONE.minus($n.arrayBufferToBignumber(t)),4:t=>Mn.TEN.pow(t[0]).times(t[1]),5:t=>Mn.TWO.pow(t[0]).times(t[1]),32:t=>new zn(t),35:t=>new RegExp(t)},t.tags),this.parser=jn(It,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var t=this._parents.pop();if(t.length>0)throw new Error(`Missing ${t.length} elements`);switch(t.type){case Mn.PARENT.TAG:this._push(this.createTag(t.ref[0],t.ref[1]));break;case Mn.PARENT.BYTE_STRING:this._push(this.createByteString(t.ref,t.length));break;case Mn.PARENT.UTF8_STRING:this._push(this.createUtf8String(t.ref,t.length));break;case Mn.PARENT.MAP:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(t.ref,t.length));break;case Mn.PARENT.OBJECT:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(t.ref,t.length));break;case Mn.PARENT.ARRAY:this._push(this.createArray(t.ref,t.length))}this._currentParent&&this._currentParent.type===Mn.PARENT.TAG&&this._dec()}_dec(){const t=this._currentParent;t.length<0||(t.length--,0===t.length&&this._closeParent())}_push(t,e){const r=this._currentParent;switch(r.values++,r.type){case Mn.PARENT.ARRAY:case Mn.PARENT.BYTE_STRING:case Mn.PARENT.UTF8_STRING:r.length>-1?this._ref[this._ref.length-r.length]=t:this._ref.push(t),this._dec();break;case Mn.PARENT.OBJECT:null!=r.tmpKey?(this._ref[r.tmpKey]=t,r.tmpKey=null,this._dec()):(r.tmpKey=t,"string"!=typeof r.tmpKey&&(r.type=Mn.PARENT.MAP,r.ref=$n.buildMap(r.ref)));break;case Mn.PARENT.MAP:null!=r.tmpKey?(this._ref.set(r.tmpKey,t),r.tmpKey=null,this._dec()):r.tmpKey=t;break;case Mn.PARENT.TAG:this._ref.push(t),e||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(t,e,r){this._parents[this._depth]={type:e,length:r,ref:t,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:Mn.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(t,e){const r=this._knownTags[t];return r?r(e):new Vn(t,e)}createMap(t,e){return t}createObject(t,e){return t}createArray(t,e){return t}createByteString(t,e){return Dn.concat(t)}createByteStringFromHeap(t,e){return t===e?Dn.alloc(0):Dn.from(this._heap.slice(t,e))}createInt(t){return t}createInt32(t,e){return $n.buildInt32(t,e)}createInt64(t,e,r,n){return $n.buildInt64(t,e,r,n)}createFloat(t){return t}createFloatSingle(t,e,r,n){return Ln.read([t,e,r,n],0,!1,23,4)}createFloatDouble(t,e,r,n,i,o,s,a){return Ln.read([t,e,r,n,i,o,s,a],0,!1,52,8)}createInt32Neg(t,e){return-1-$n.buildInt32(t,e)}createInt64Neg(t,e,r,n){const i=$n.buildInt32(t,e),o=$n.buildInt32(r,n);return i>Mn.MAX_SAFE_HIGH?Mn.NEG_ONE.minus(new Fn(i).times(Mn.SHIFT32).plus(o)):-1-(i*Mn.SHIFT32+o)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(t,e){return t.join("")}createUtf8StringFromHeap(t,e){return t===e?"":this._buffer.toString("utf8",t,e)}createSimpleUnassigned(t){return new qn(t)}pushInt(t){this._push(this.createInt(t))}pushInt32(t,e){this._push(this.createInt32(t,e))}pushInt64(t,e,r,n){this._push(this.createInt64(t,e,r,n))}pushFloat(t){this._push(this.createFloat(t))}pushFloatSingle(t,e,r,n){this._push(this.createFloatSingle(t,e,r,n))}pushFloatDouble(t,e,r,n,i,o,s,a){this._push(this.createFloatDouble(t,e,r,n,i,o,s,a))}pushInt32Neg(t,e){this._push(this.createInt32Neg(t,e))}pushInt64Neg(t,e,r,n){this._push(this.createInt64Neg(t,e,r,n))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],Mn.PARENT.ARRAY,-1)}pushArrayStartFixed(t){this._createArrayStartFixed(t)}pushArrayStartFixed32(t,e){const r=$n.buildInt32(t,e);this._createArrayStartFixed(r)}pushArrayStartFixed64(t,e,r,n){const i=$n.buildInt64(t,e,r,n);this._createArrayStartFixed(i)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(t){this._createObjectStartFixed(t)}pushObjectStartFixed32(t,e){const r=$n.buildInt32(t,e);this._createObjectStartFixed(r)}pushObjectStartFixed64(t,e,r,n){const i=$n.buildInt64(t,e,r,n);this._createObjectStartFixed(i)}pushByteStringStart(){this._parents[this._depth]={type:Mn.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(t,e){this._push(this.createByteStringFromHeap(t,e))}pushUtf8StringStart(){this._parents[this._depth]={type:Mn.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(t,e){this._push(this.createUtf8StringFromHeap(t,e))}pushSimpleUnassigned(t){this._push(this.createSimpleUnassigned(t))}pushTagStart(t){this._parents[this._depth]={type:Mn.PARENT.TAG,length:1,ref:[t]}}pushTagStart4(t,e){this.pushTagStart($n.buildInt32(t,e))}pushTagStart8(t,e,r,n){this.pushTagStart($n.buildInt64(t,e,r,n))}pushTagUnassigned(t){this._push(this.createTag(t))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(t){0!==t?this._createParent({},Mn.PARENT.OBJECT,t):this._push(this.createObject({}))}_createArrayStartFixed(t){0!==t?this._createParent(new Array(t),Mn.PARENT.ARRAY,t):this._push(this.createArray([]))}_decode(t){if(0===t.byteLength)throw new Error("Input too short");this._reset(),this._heap8.set(t);const e=this.parser.parse(t.byteLength);if(this._depth>1){for(;0===this._currentParent.length;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(e>0)throw new Error("Failed to parse");if(0===this._res.length)throw new Error("No valid result")}decodeFirst(t){return this._decode(t),this._res[0]}decodeAll(t){return this._decode(t),this._res}static decode(e,r){"string"==typeof e&&(e=Dn.from(e,r||"hex"));return new t({size:e.length}).decodeFirst(e)}static decodeAll(e,r){"string"==typeof e&&(e=Dn.from(e,r||"hex"));return new t({size:e.length}).decodeAll(e)}};Gn.decodeFirst=Gn.decode;var Kn=Gn;const{Buffer:Hn}=hn,Zn=Kn,Wn=yn;class Yn extends Zn{createTag(t,e){return`${t}(${e})`}createInt(t){return super.createInt(t).toString()}createInt32(t,e){return super.createInt32(t,e).toString()}createInt64(t,e,r,n){return super.createInt64(t,e,r,n).toString()}createInt32Neg(t,e){return super.createInt32Neg(t,e).toString()}createInt64Neg(t,e,r,n){return super.createInt64Neg(t,e,r,n).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(t){const e=super.createFloat(t);return Wn.isNegativeZero(t)?"-0_1":`${e}_1`}createFloatSingle(t,e,r,n){return`${super.createFloatSingle(t,e,r,n)}_2`}createFloatDouble(t,e,r,n,i,o,s,a){return`${super.createFloatDouble(t,e,r,n,i,o,s,a)}_3`}createByteString(t,e){const r=t.join(", ");return-1===e?`(_ ${r})`:`h'${r}`}createByteStringFromHeap(t,e){return`h'${Hn.from(super.createByteStringFromHeap(t,e)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(t){return`simple(${t})`}createArray(t,e){const r=super.createArray(t,e);return-1===e?`[_ ${r.join(", ")}]`:`[${r.join(", ")}]`}createMap(t,e){const r=super.createMap(t),n=Array.from(r.keys()).reduce(Jn(r),"");return-1===e?`{_ ${n}}`:`{${n}}`}createObject(t,e){const r=super.createObject(t),n=Object.keys(r).reduce(Jn(r),"");return-1===e?`{_ ${n}}`:`{${n}}`}createUtf8String(t,e){const r=t.join(", ");return-1===e?`(_ ${r})`:`"${r}"`}createUtf8StringFromHeap(t,e){return`"${Hn.from(super.createUtf8StringFromHeap(t,e)).toString("utf8")}"`}static diagnose(t,e){"string"==typeof t&&(t=Hn.from(t,e||"hex"));return(new Yn).decodeFirst(t)}}var Xn=Yn;function Jn(t){return(e,r)=>e?`${e}, ${r}: ${t[r]}`:`${r}: ${t[r]}`}const{Buffer:Qn}=hn,{URL:ti}=Cn,ei=mn.BigNumber,ri=yn,ni=bn,ii=ni.MT,oi=ni.NUMBYTES,si=ni.SHIFT32,ai=ni.SYMS,ci=ni.TAG,ui=ni.MT.SIMPLE_FLOAT<<5|ni.NUMBYTES.TWO,li=ni.MT.SIMPLE_FLOAT<<5|ni.NUMBYTES.FOUR,fi=ni.MT.SIMPLE_FLOAT<<5|ni.NUMBYTES.EIGHT,di=ni.MT.SIMPLE_FLOAT<<5|ni.SIMPLE.TRUE,hi=ni.MT.SIMPLE_FLOAT<<5|ni.SIMPLE.FALSE,pi=ni.MT.SIMPLE_FLOAT<<5|ni.SIMPLE.UNDEFINED,gi=ni.MT.SIMPLE_FLOAT<<5|ni.SIMPLE.NULL,mi=new ei("0x20000000000000"),yi=Qn.from("f97e00","hex"),bi=Qn.from("f9fc00","hex"),wi=Qn.from("f97c00","hex");class vi{constructor(t){t=t||{},this.streaming="function"==typeof t.stream,this.onData=t.stream,this.semanticTypes=[[ti,this._pushUrl],[ei,this._pushBigNumber]];const e=t.genTypes||[],r=e.length;for(let t=0;t<r;t++)this.addSemanticType(e[t][0],e[t][1]);this._reset()}addSemanticType(t,e){const r=this.semanticTypes.length;for(let n=0;n<r;n++){if(this.semanticTypes[n][0]===t){const t=this.semanticTypes[n][1];return this.semanticTypes[n][1]=e,t}}return this.semanticTypes.push([t,e]),null}push(t){return!t||(this.result[this.offset]=t,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=t.length,this.offset++,this.streaming&&this.onData(this.finalize()),!0)}pushWrite(t,e,r){return this.result[this.offset]=t,this.resultMethod[this.offset]=e,this.resultLength[this.offset]=r,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(t){return this.pushWrite(t,1,1)}_pushUInt16BE(t){return this.pushWrite(t,2,2)}_pushUInt32BE(t){return this.pushWrite(t,3,4)}_pushDoubleBE(t){return this.pushWrite(t,4,8)}_pushNaN(){return this.push(yi)}_pushInfinity(t){const e=t<0?bi:wi;return this.push(e)}_pushFloat(t){const e=Qn.allocUnsafe(2);if(ri.writeHalf(e,t)&&ri.parseHalf(e)===t)return this._pushUInt8(ui)&&this.push(e);const r=Qn.allocUnsafe(4);return r.writeFloatBE(t,0),r.readFloatBE(0)===t?this._pushUInt8(li)&&this.push(r):this._pushUInt8(fi)&&this._pushDoubleBE(t)}_pushInt(t,e,r){const n=e<<5;return t<24?this._pushUInt8(n|t):t<=255?this._pushUInt8(n|oi.ONE)&&this._pushUInt8(t):t<=65535?this._pushUInt8(n|oi.TWO)&&this._pushUInt16BE(t):t<=4294967295?this._pushUInt8(n|oi.FOUR)&&this._pushUInt32BE(t):t<=Number.MAX_SAFE_INTEGER?this._pushUInt8(n|oi.EIGHT)&&this._pushUInt32BE(Math.floor(t/si))&&this._pushUInt32BE(t%si):e===ii.NEG_INT?this._pushFloat(r):this._pushFloat(t)}_pushIntNum(t){return t<0?this._pushInt(-t-1,ii.NEG_INT,t):this._pushInt(t,ii.POS_INT)}_pushNumber(t){switch(!1){case t==t:return this._pushNaN(t);case isFinite(t):return this._pushInfinity(t);case t%1!=0:return this._pushIntNum(t);default:return this._pushFloat(t)}}_pushString(t){const e=Qn.byteLength(t,"utf8");return this._pushInt(e,ii.UTF8_STRING)&&this.pushWrite(t,5,e)}_pushBoolean(t){return this._pushUInt8(t?di:hi)}_pushUndefined(t){return this._pushUInt8(pi)}_pushArray(t,e){const r=e.length;if(!t._pushInt(r,ii.ARRAY))return!1;for(let n=0;n<r;n++)if(!t.pushAny(e[n]))return!1;return!0}_pushTag(t){return this._pushInt(t,ii.TAG)}_pushDate(t,e){return t._pushTag(ci.DATE_EPOCH)&&t.pushAny(Math.round(e/1e3))}_pushBuffer(t,e){return t._pushInt(e.length,ii.BYTE_STRING)&&t.push(e)}_pushNoFilter(t,e){return t._pushBuffer(t,e.slice())}_pushRegexp(t,e){return t._pushTag(ci.REGEXP)&&t.pushAny(e.source)}_pushSet(t,e){if(!t._pushInt(e.size,ii.ARRAY))return!1;for(const r of e)if(!t.pushAny(r))return!1;return!0}_pushUrl(t,e){return t._pushTag(ci.URI)&&t.pushAny(e.format())}_pushBigint(t){let e=ci.POS_BIGINT;t.isNegative()&&(t=t.negated().minus(1),e=ci.NEG_BIGINT);let r=t.toString(16);r.length%2&&(r="0"+r);const n=Qn.from(r,"hex");return this._pushTag(e)&&this._pushBuffer(this,n)}_pushBigNumber(t,e){if(e.isNaN())return t._pushNaN();if(!e.isFinite())return t._pushInfinity(e.isNegative()?-1/0:1/0);if(e.isInteger())return t._pushBigint(e);if(!t._pushTag(ci.DECIMAL_FRAC)||!t._pushInt(2,ii.ARRAY))return!1;const r=e.decimalPlaces(),n=e.multipliedBy(new ei(10).pow(r));return!!t._pushIntNum(-r)&&(n.abs().isLessThan(mi)?t._pushIntNum(n.toNumber()):t._pushBigint(n))}_pushMap(t,e){return!!t._pushInt(e.size,ii.MAP)&&this._pushRawMap(e.size,Array.from(e))}_pushObject(t){if(!t)return this._pushUInt8(gi);for(var e=this.semanticTypes.length,r=0;r<e;r++)if(t instanceof this.semanticTypes[r][0])return this.semanticTypes[r][1].call(t,this,t);var n=t.encodeCBOR;if("function"==typeof n)return n.call(t,this);var i=Object.keys(t),o=i.length;return!!this._pushInt(o,ii.MAP)&&this._pushRawMap(o,i.map((e=>[e,t[e]])))}_pushRawMap(t,e){e=e.map((function(t){return t[0]=vi.encode(t[0]),t})).sort(ri.keySorter);for(var r=0;r<t;r++){if(!this.push(e[r][0]))return!1;if(!this.pushAny(e[r][1]))return!1}return!0}write(t){return this.pushAny(t)}pushAny(t){var e=function(t){return{}.toString.call(t).slice(8,-1)}(t);switch(e){case"Number":return this._pushNumber(t);case"String":return this._pushString(t);case"Boolean":return this._pushBoolean(t);case"Object":return this._pushObject(t);case"Array":return this._pushArray(this,t);case"Uint8Array":return this._pushBuffer(this,Qn.isBuffer(t)?t:Qn.from(t));case"Null":return this._pushUInt8(gi);case"Undefined":return this._pushUndefined(t);case"Map":return this._pushMap(this,t);case"Set":return this._pushSet(this,t);case"URL":return this._pushUrl(this,t);case"BigNumber":return this._pushBigNumber(this,t);case"Date":return this._pushDate(this,t);case"RegExp":return this._pushRegexp(this,t);case"Symbol":switch(t){case ai.NULL:return this._pushObject(null);case ai.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+t.toString())}default:throw new Error("Unknown type: "+typeof t+", "+(t?t.toString():""))}}finalize(){if(0===this.offset)return null;for(var t=this.result,e=this.resultLength,r=this.resultMethod,n=this.offset,i=0,o=0;o<n;o++)i+=e[o];var s=Qn.allocUnsafe(i),a=0,c=0;for(o=0;o<n;o++){switch(c=e[o],r[o]){case 0:t[o].copy(s,a);break;case 1:s.writeUInt8(t[o],a,!0);break;case 2:s.writeUInt16BE(t[o],a,!0);break;case 3:s.writeUInt32BE(t[o],a,!0);break;case 4:s.writeDoubleBE(t[o],a,!0);break;case 5:s.write(t[o],a,c,"utf8");break;default:throw new Error("unkown method")}a+=c}var u=s;return this._reset(),u}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(t){const e=new vi;if(!e.pushAny(t))throw new Error("Failed to encode input");return e.finalize()}}var xi,Ei=vi;(xi=dn).Diagnose=Xn,xi.Decoder=Kn,xi.Encoder=Ei,xi.Simple=Bn,xi.Tagged=Sn,xi.decodeAll=xi.Decoder.decodeAll,xi.decodeFirst=xi.Decoder.decodeFirst,xi.diagnose=xi.Diagnose.diagnose,xi.encode=xi.Encoder.encode,xi.decode=xi.Decoder.decode,xi.leveldb={decode:xi.Decoder.decodeAll,encode:xi.Encoder.encode,buffer:!0,name:"cbor"};var _i=At(dn);function Bi(t){return Ve(ke.create().update(new Uint8Array(t)).digest())}function Si(t){if(t instanceof _i.Tagged)return Si(t.value);if("string"==typeof t)return Ii(t);if("number"==typeof t)return Bi(tr(t));if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return Bi(t);if(Array.isArray(t)){return Bi(Le(...t.map(Si)))}if(t&&"object"==typeof t&&t._isPrincipal)return Bi(t.toUint8Array());if("object"==typeof t&&null!==t&&"function"==typeof t.toHash)return Si(t.toHash());if("object"==typeof t)return Ti(t);if("bigint"==typeof t)return Bi(tr(t));throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${t}`),{value:t})}const Ii=t=>Bi((new TextEncoder).encode(t));function Ai(t){return Ti(t)}function Ti(t){const e=Object.entries(t).filter((([,t])=>void 0!==t)).map((([t,e])=>[Ii(t),Si(e)]));return Bi(Le(...e.sort((([t],[e])=>Me(t,e))).map((t=>Le(...t)))))}var Ni=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r};const Oi=(new TextEncoder).encode("\nic-request");class Ri{getPrincipal(){return this._principal||(this._principal=De.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(t){const{body:e}=t,r=Ni(t,["body"]),n=Ai(e);return Object.assign(Object.assign({},r),{body:{content:e,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(Le(Oi,n))}})}}class Ui{getPrincipal(){return De.anonymous()}async transformRequest(t){return Object.assign(Object.assign({},t),{body:{content:t.body}})}}var ki={},Pi={},Ci={};Object.defineProperty(Ci,"__esModule",{value:!0});const Di=9007199254740992;function Li(t,...e){const r=new Uint8Array(t.byteLength+e.reduce(((t,e)=>t+e.byteLength),0));r.set(new Uint8Array(t),0);let n=t.byteLength;for(const t of e)r.set(new Uint8Array(t),n),n+=t.byteLength;return r.buffer}function Fi(t,e,r){const n=2**(e-24);r=(r=r.replace(/[^0-9a-fA-F]/g,"")).slice(2*-n).padStart(2*n,"0");const i=[(t<<5)+e].concat(r.match(/../g).map((t=>parseInt(t,16))));return new Uint8Array(i).buffer}function ji(t,e){if(e<24)return new Uint8Array([(t<<5)+e]).buffer;return Fi(t,e<=255?24:e<=65535?25:e<=4294967295?26:27,e.toString(16))}function $i(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|63&n):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=(1023&n)<<10|1023&t.charCodeAt(r),e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return Li(new Uint8Array(ji(3,t.length)),new Uint8Array(e))}function Mi(t){return new Uint8Array(t).buffer}function qi(t){if(isNaN(t))throw new RangeError("Invalid number.");t=Math.min(Math.max(0,t),23);return new Uint8Array([0+t]).buffer}function Vi(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Fi(0,24,t=(t=Math.min(Math.max(0,t),255)).toString(16))}function zi(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Fi(0,25,t=(t=Math.min(Math.max(0,t),65535)).toString(16))}function Gi(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Fi(0,26,t=(t=Math.min(Math.max(0,t),4294967295)).toString(16))}function Ki(t,e){if("string"==typeof t&&16==e){if(t.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return Fi(0,27,t)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Fi(0,27,t=(t=Math.min(Math.max(0,t),Di)).toString(16))}function Hi(t){if(isNaN(t))throw new RangeError("Invalid number.");if(0===t)return qi(0);t=Math.min(Math.max(0,-t),24)-1;return new Uint8Array([32+t]).buffer}function Zi(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Fi(1,24,t=(t=Math.min(Math.max(0,-t-1),255)).toString(16))}function Wi(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Fi(1,25,t=(t=Math.min(Math.max(0,-t-1),65535)).toString(16))}function Yi(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Fi(1,26,t=(t=Math.min(Math.max(0,-t-1),4294967295)).toString(16))}function Xi(t,e){if("string"==typeof t&&16==e){if((t=t.startsWith("-")?t.slice(1):"0").match(/[^0-9a-fA-F]/)||t.length>16)throw new RangeError("Invalid number.");let e=!1,r=t.split("").reduceRight(((t,r)=>{if(e)return r+t;let n=parseInt(r,16)-1;return n>=0?(e=!0,n.toString(16)+t):"f"+t}),"");return e?Fi(1,27,r):Ki(0)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return Fi(1,27,t=(t=Math.min(Math.max(0,-t-1),9007199254740992)).toString(16))}function Ji(){return Mi(new Uint8Array([245]))}function Qi(){return Mi(new Uint8Array([244]))}Ci.tagged=function(t,e){if(14277111==t)return Li(new Uint8Array([217,217,247]),e);if(t<24)return Li(new Uint8Array([192+t]),e);{const e=t<=255?24:t<=65535?25:t<=4294967295?26:27,r=2**(e-24),n=t.toString(16).slice(2*-r).padStart(2*r,"0"),i=[192+e].concat(n.match(/../g).map((t=>parseInt(t,16))));return new Uint8Array(i).buffer}},Ci.raw=Mi,Ci.uSmall=qi,Ci.u8=Vi,Ci.u16=zi,Ci.u32=Gi,Ci.u64=Ki,Ci.iSmall=Hi,Ci.i8=Zi,Ci.i16=Wi,Ci.i32=Yi,Ci.i64=Xi,Ci.number=function(t){return t>=0?t<24?qi(t):t<=255?Vi(t):t<=65535?zi(t):t<=4294967295?Gi(t):Ki(t):t>=-24?Hi(t):t>=-255?Zi(t):t>=-65535?Wi(t):t>=-4294967295?Yi(t):Xi(t)},Ci.bytes=function(t){return Li(ji(2,t.byteLength),t)},Ci.string=function(t){return $i(t)},Ci.array=function(t){return Li(ji(4,t.length),...t)},Ci.map=function(t,e=!1){t instanceof Map||(t=new Map(Object.entries(t)));let r=Array.from(t.entries());return e&&(r=r.sort((([t],[e])=>t.localeCompare(e)))),Li(ji(5,t.size),...r.map((([t,e])=>Li($i(t),e))))},Ci.singleFloat=function(t){const e=new Float32Array([t]);return Li(new Uint8Array([250]),new Uint8Array(e.buffer))},Ci.doubleFloat=function(t){const e=new Float64Array([t]);return Li(new Uint8Array([251]),new Uint8Array(e.buffer))},Ci.bool=function(t){return t?Ji():Qi()},Ci.true_=Ji,Ci.false_=Qi,Ci.null_=function(){return Mi(new Uint8Array([246]))},Ci.undefined_=function(){return Mi(new Uint8Array([247]))};var to=It&&It.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(Pi,"__esModule",{value:!0});const eo=to(Ci),ro=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class no{constructor(t,e=!1){this._serializer=t,this._stable=e,this.name="jsonDefault",this.priority=-100}match(t){return-1!=["undefined","boolean","number","string","object"].indexOf(typeof t)}encode(t){switch(typeof t){case"undefined":return eo.undefined_();case"boolean":return eo.bool(t);case"number":return Math.floor(t)===t?eo.number(t):eo.doubleFloat(t);case"string":return eo.string(t);case"object":if(null===t)return eo.null_();if(Array.isArray(t))return eo.array(t.map((t=>this._serializer.serializeValue(t))));if(ro.find((e=>t instanceof e)))return eo.bytes(t.buffer);if(-1!==Object.getOwnPropertyNames(t).indexOf("toJSON"))return this.encode(t.toJSON());if(t instanceof Map){const e=new Map;for(const[r,n]of t.entries())e.set(r,this._serializer.serializeValue(n));return eo.map(e,this._stable)}{const e=new Map;for(const[r,n]of Object.entries(t))e.set(r,this._serializer.serializeValue(n));return eo.map(e,this._stable)}default:throw new Error("Invalid value.")}}}Pi.JsonDefaultCborEncoder=no;class io{constructor(){this.name="cborEncoder",this.priority=-90}match(t){return"object"==typeof t&&"function"==typeof t.toCBOR}encode(t){return t.toCBOR()}}Pi.ToCborEncoder=io;class oo{constructor(){this._encoders=new Set}static withDefaultEncoders(t=!1){const e=new this;return e.addEncoder(new no(e,t)),e.addEncoder(new io),e}removeEncoder(t){for(const e of this._encoders.values())e.name==t&&this._encoders.delete(e)}addEncoder(t){this._encoders.add(t)}getEncoderFor(t){let e=null;for(const r of this._encoders)(!e||r.priority>e.priority)&&r.match(t)&&(e=r);if(null===e)throw new Error("Could not find an encoder for value.");return e}serializeValue(t){return this.getEncoderFor(t).encode(t)}serialize(t){return this.serializeValue(t)}}Pi.CborSerializer=oo;Pi.SelfDescribeCborSerializer=class extends oo{serialize(t){return eo.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(t))]))}},function(t){var e=It&&It.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(Pi);const r=e(Ci);t.value=r}(ki);const so=ki.SelfDescribeCborSerializer.withDefaultEncoders(!0);var ao;function co(t){return so.serialize(t)}function uo(t){const e=t.byteLength;let r=BigInt(0);for(let n=0;n<e;n++)r=r*BigInt(256)+BigInt(t[n]);return r}so.addEncoder(new class{get name(){return"Principal"}get priority(){return 0}match(t){return t&&!0===t._isPrincipal}encode(t){return ki.value.bytes(t.toUint8Array())}}),so.addEncoder(new class{get name(){return"Buffer"}get priority(){return 1}match(t){return t instanceof ArrayBuffer||ArrayBuffer.isView(t)}encode(t){return ki.value.bytes(new Uint8Array(t))}}),so.addEncoder(new class{get name(){return"BigInt"}get priority(){return 1}match(t){return"bigint"==typeof t}encode(t){return t>BigInt(0)?ki.value.tagged(2,ki.value.bytes($e(t.toString(16)))):ki.value.tagged(3,ki.value.bytes($e((BigInt("-1")*t).toString(16))))}}),function(t){t[t.Uint64LittleEndian=71]="Uint64LittleEndian",t[t.Semantic=55799]="Semantic"}(ao||(ao={}));class lo extends _i.Decoder{createByteString(t){return Le(...t)}createByteStringFromHeap(t,e){return t===e?new ArrayBuffer(0):new Uint8Array(this._heap.slice(t,e))}}function fo(t){const e=new Uint8Array(t),r=new lo({size:e.byteLength,tags:{2:t=>uo(t),3:t=>-uo(t),[ao.Semantic]:t=>t}});try{return r.decodeFirst(e)}catch(t){throw new Error(`Failed to decode CBOR: ${t}, input: ${Fe(e)}`)}}const ho=()=>{if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){const t=new Uint32Array(1);return window.crypto.getRandomValues(t),t[0]}if("undefined"!=typeof crypto&&crypto.getRandomValues){const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]}return"undefined"!=typeof crypto&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(4294967295*Math.random())};var po;function go(){const t=new ArrayBuffer(16),e=new DataView(t),r=ho(),n=ho(),i=ho(),o=ho();return e.setUint32(0,r),e.setUint32(4,n),e.setUint32(8,i),e.setUint32(12,o),t}!function(t){t.Call="call"}(po||(po={}));const mo=BigInt(1e6);class yo{constructor(t){if(t<9e4){const e=BigInt(Date.now()+t)*mo/BigInt(1e9);return void(this._value=e*BigInt(1e9))}const e=BigInt(Math.floor(Date.now()+t-6e4))*mo/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=e}toCBOR(){return ki.value.u64(this._value.toString(16),16)}toHash(){return tr(this._value)}}function bo(t=go){return async e=>{const r=e.request.headers;e.request.headers=r,"call"===e.endpoint&&(e.body.nonce=t())}}function wo(t){const e=[];return t.forEach(((t,r)=>{e.push([r,t])})),e}class vo extends Ge{constructor(t,e){super(t),this.response=e,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class xo extends Ge{constructor(t,e,r,n,i,o){super(t),this.response=e,this.requestId=r,this.senderPubkey=n,this.senderSig=i,this.ingressExpiry=o,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class Eo extends Ge{constructor(t,e,r,n,i,o){super(t),this.response=e,this.requestId=r,this.senderPubkey=n,this.senderSig=i,this.ingressExpiry=o,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class _o extends Ge{constructor(t,e,r,n,i,o){super(t),this.response=e,this.requestId=r,this.senderPubkey=n,this.senderSig=i,this.ingressExpiry=o,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Bo=BigInt(0),So=BigInt(1);function Io(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function Ao(t){if(!Io(t))throw new Error("Uint8Array expected")}function To(t,e){if("boolean"!=typeof e)throw new Error(t+" boolean expected, got "+e)}function No(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return""===t?Bo:BigInt("0x"+t)}const Oo="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,Ro=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function Uo(t){if(Ao(t),Oo)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=Ro[t[r]];return e}const ko={_0:48,_9:57,A:65,F:70,a:97,f:102};function Po(t){return t>=ko._0&&t<=ko._9?t-ko._0:t>=ko.A&&t<=ko.F?t-(ko.A-10):t>=ko.a&&t<=ko.f?t-(ko.a-10):void 0}function Co(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);if(Oo)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){const r=Po(t.charCodeAt(i)),o=Po(t.charCodeAt(i+1));if(void 0===r||void 0===o){const e=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+i)}n[e]=16*r+o}return n}function Do(t){return No(Uo(t))}function Lo(t){return Ao(t),No(Uo(Uint8Array.from(t).reverse()))}function Fo(t,e){return Co(t.toString(16).padStart(2*e,"0"))}function jo(t,e){return Fo(t,e).reverse()}function $o(t,e,r){let n;if("string"==typeof e)try{n=Co(e)}catch(e){throw new Error(t+" must be hex string or Uint8Array, cause: "+e)}else{if(!Io(e))throw new Error(t+" must be hex string or Uint8Array");n=Uint8Array.from(e)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function Mo(...t){let e=0;for(let r=0;r<t.length;r++){const n=t[r];Ao(n),e+=n.length}const r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}function qo(t){if("string"!=typeof t)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}const Vo=t=>"bigint"==typeof t&&Bo<=t;function zo(t,e,r){return Vo(t)&&Vo(e)&&Vo(r)&&e<=t&&t<r}function Go(t,e,r,n){if(!zo(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function Ko(t){let e;for(e=0;t>Bo;t>>=So,e+=1);return e}function Ho(t,e){return t>>BigInt(e)&So}const Zo=t=>(So<<BigInt(t))-So,Wo={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||Io(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function Yo(t,e,r={}){const n=(e,r,n)=>{const i=Wo[r];if("function"!=typeof i)throw new Error("invalid validator function");const o=t[e];if(!(n&&void 0===o||i(o,t)))throw new Error("param "+String(e)+" is invalid. Expected "+r+", got "+o)};for(const[t,r]of Object.entries(e))n(t,r,!1);for(const[t,e]of Object.entries(r))n(t,e,!0);return t}const Xo=()=>{throw new Error("not implemented")};function Jo(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(void 0!==i)return i;const o=t(r,...n);return e.set(r,o),o}}const Qo=BigInt(0),ts=BigInt(1),es=BigInt(2),rs=BigInt(3),ns=BigInt(4),is=BigInt(5),os=BigInt(8);function ss(t,e){const r=t%e;return r>=Qo?r:e+r}function as(t,e,r){let n=t;for(;e-- >Qo;)n*=n,n%=r;return n}function cs(t,e){if(t===Qo)throw new Error("invert: expected non-zero number");if(e<=Qo)throw new Error("invert: expected positive modulus, got "+e);let r=ss(t,e),n=e,i=Qo,o=ts;for(;r!==Qo;){const t=n%r,e=i-o*(n/r);n=r,r=t,i=o,o=e}if(n!==ts)throw new Error("invert: does not exist");return ss(i,e)}function us(t,e){const r=(t.ORDER+ts)/ns,n=t.pow(e,r);if(!t.eql(t.sqr(n),e))throw new Error("Cannot find square root");return n}function ls(t,e){const r=(t.ORDER-is)/os,n=t.mul(e,es),i=t.pow(n,r),o=t.mul(e,i),s=t.mul(t.mul(o,es),i),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function fs(t){return t%ns===rs?us:t%os===is?ls:function(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-ts,r=0;for(;e%es===Qo;)e/=es,r++;let n=es;const i=bs(t);for(;1===ms(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return us;let o=i.pow(n,e);const s=(e+ts)/es;return function(t,n){if(t.is0(n))return n;if(1!==ms(t,n))throw new Error("Cannot find square root");let i=r,a=t.mul(t.ONE,o),c=t.pow(n,e),u=t.pow(n,s);for(;!t.eql(c,t.ONE);){if(t.is0(c))return t.ZERO;let e=1,r=t.sqr(c);for(;!t.eql(r,t.ONE);)if(e++,r=t.sqr(r),e===i)throw new Error("Cannot find square root");const n=ts<<BigInt(i-e-1),o=t.pow(a,n);i=e,a=t.sqr(o),c=t.mul(c,a),u=t.mul(u,o)}return u}}(t)}const ds=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function hs(t){const e=ds.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return Yo(t,e)}function ps(t,e,r){if(r<Qo)throw new Error("invalid exponent, negatives unsupported");if(r===Qo)return t.ONE;if(r===ts)return e;let n=t.ONE,i=e;for(;r>Qo;)r&ts&&(n=t.mul(n,i)),i=t.sqr(i),r>>=ts;return n}function gs(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),i=e.reduce(((e,r,i)=>t.is0(r)?e:(n[i]=e,t.mul(e,r))),t.ONE),o=t.inv(i);return e.reduceRight(((e,r,i)=>t.is0(r)?e:(n[i]=t.mul(e,n[i]),t.mul(e,r))),o),n}function ms(t,e){const r=(t.ORDER-ts)/es,n=t.pow(e,r),i=t.eql(n,t.ONE),o=t.eql(n,t.ZERO),s=t.eql(n,t.neg(t.ONE));if(!i&&!o&&!s)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function ys(t,e){void 0!==e&&function(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}(e);const r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function bs(t,e,r=!1,n={}){if(t<=Qo)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:o}=ys(t,e);if(o>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let s;const a=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:o,MASK:Zo(i),ZERO:Qo,ONE:ts,create:e=>ss(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("invalid field element: expected bigint, got "+typeof e);return Qo<=e&&e<t},is0:t=>t===Qo,isOdd:t=>(t&ts)===ts,neg:e=>ss(-e,t),eql:(t,e)=>t===e,sqr:e=>ss(e*e,t),add:(e,r)=>ss(e+r,t),sub:(e,r)=>ss(e-r,t),mul:(e,r)=>ss(e*r,t),pow:(t,e)=>ps(a,t,e),div:(e,r)=>ss(e*cs(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>cs(e,t),sqrt:n.sqrt||(e=>(s||(s=fs(t)),s(a,e))),toBytes:t=>r?jo(t,o):Fo(t,o),fromBytes:t=>{if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);return r?Lo(t):Do(t)},invertBatch:t=>gs(a,t),cmov:(t,e,r)=>r?e:t});return Object.freeze(a)}function ws(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function vs(t){const e=ws(t);return e+Math.ceil(e/2)}const xs=Do;function Es(t,e){if(Bs(t),Bs(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=255&t,t>>>=8;return new Uint8Array(r)}function _s(t,e){const r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}function Bs(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Ss(t,e,r){Yo(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:n,k:i,m:o,hash:s,expand:a,DST:c}=r;Ao(t),Bs(e);const u="string"==typeof c?qo(c):c,l=n.toString(2).length,f=Math.ceil((l+i)/8),d=e*o*f;let h;if("xmd"===a)h=function(t,e,r,n){Ao(t),Ao(e),Bs(r),e.length>255&&(e=n(Mo(qo("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:o}=n,s=Math.ceil(r/i);if(r>65535||s>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=Mo(e,Es(e.length,1)),c=Es(0,o),u=Es(r,2),l=new Array(s),f=n(Mo(c,t,u,Es(0,1),a));l[0]=n(Mo(f,Es(1,1),a));for(let t=1;t<=s;t++){const e=[_s(f,l[t-1]),Es(t+1,1),a];l[t]=n(Mo(...e))}return Mo(...l).slice(0,r)}(t,u,d,s);else if("xof"===a)h=function(t,e,r,n,i){if(Ao(t),Ao(e),Bs(r),e.length>255){const t=Math.ceil(2*n/8);e=i.create({dkLen:t}).update(qo("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(Es(r,2)).update(e).update(Es(e.length,1)).digest()}(t,u,d,i,s);else{if("_internal_pass"!==a)throw new Error('expand must be "xmd" or "xof"');h=t}const p=new Array(e);for(let t=0;t<e;t++){const e=new Array(o);for(let r=0;r<o;r++){const i=f*(r+t*o),s=h.subarray(i,i+f);e[r]=ss(xs(s),n)}p[t]=e}return p}function Is(t,e){const r=e.map((t=>Array.from(t).reverse()));return(e,n)=>{const[i,o,s,a]=r.map((r=>r.reduce(((r,n)=>t.add(t.mul(r,e),n))))),[c,u]=gs(t,[o,a],!0);return e=t.mul(i,c),n=t.mul(n,t.mul(s,u)),{x:e,y:n}}}function As(t,e,r){if("function"!=typeof e)throw new Error("mapToCurve() must be defined");function n(r){return t.fromAffine(e(r))}function i(e){const r=e.clearCofactor();return r.equals(t.ZERO)?t.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(t,e){const o=Ss(t,2,{...r,DST:r.DST,...e}),s=n(o[0]),a=n(o[1]);return i(s.add(a))},encodeToCurve:(t,e)=>i(n(Ss(t,1,{...r,DST:r.encodeDST,...e})[0])),mapToCurve(t){if(!Array.isArray(t))throw new Error("expected array of bigints");for(const e of t)if("bigint"!=typeof e)throw new Error("expected array of bigints");return i(n(t))}}}const Ts=BigInt(0),Ns=BigInt(1);function Os(t,e){const r=e.negate();return t?r:e}function Rs(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Us(t,e){Rs(t,e);const r=2**t;return{windows:Math.ceil(e/t)+1,windowSize:2**(t-1),mask:Zo(t),maxNumber:r,shiftBy:BigInt(t)}}function ks(t,e,r){const{windowSize:n,mask:i,maxNumber:o,shiftBy:s}=r;let a=Number(t&i),c=t>>s;a>n&&(a-=o,c+=Ns);const u=e*n;return{nextN:c,offset:u+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:e%2!=0,offsetF:u}}const Ps=new WeakMap,Cs=new WeakMap;function Ds(t){return Cs.get(t)||1}function Ls(t,e){return{constTimeNegate:Os,hasPrecomputes:t=>1!==Ds(t),unsafeLadder(e,r,n=t.ZERO){let i=e;for(;r>Ts;)r&Ns&&(n=n.add(i)),i=i.double(),r>>=Ns;return n},precomputeWindow(t,r){const{windows:n,windowSize:i}=Us(r,e),o=[];let s=t,a=s;for(let t=0;t<n;t++){a=s,o.push(a);for(let t=1;t<i;t++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(r,n,i){let o=t.ZERO,s=t.BASE;const a=Us(r,e);for(let t=0;t<a.windows;t++){const{nextN:e,offset:r,isZero:c,isNeg:u,isNegF:l,offsetF:f}=ks(i,t,a);i=e,c?s=s.add(Os(l,n[f])):o=o.add(Os(u,n[r]))}return{p:o,f:s}},wNAFUnsafe(r,n,i,o=t.ZERO){const s=Us(r,e);for(let t=0;t<s.windows&&i!==Ts;t++){const{nextN:e,offset:r,isZero:a,isNeg:c}=ks(i,t,s);if(i=e,!a){const t=n[r];o=o.add(c?t.negate():t)}}return o},getPrecomputes(t,e,r){let n=Ps.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&Ps.set(e,r(n))),n},wNAFCached(t,e,r){const n=Ds(t);return this.wNAF(n,this.getPrecomputes(n,t,r),e)},wNAFCachedUnsafe(t,e,r,n){const i=Ds(t);return 1===i?this.unsafeLadder(t,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),e,n)},setWindowSize(t,r){Rs(r,e),Cs.set(t,r),Ps.delete(t)}}}function Fs(t,e,r,n){!function(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach(((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)}))}(r,t),function(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach(((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)}))}(n,e);const i=r.length,o=n.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,a=Ko(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=Zo(c),l=new Array(Number(u)+1).fill(s);let f=s;for(let t=Math.floor((e.BITS-1)/c)*c;t>=0;t-=c){l.fill(s);for(let e=0;e<o;e++){const i=n[e],o=Number(i>>BigInt(t)&u);l[o]=l[o].add(r[e])}let e=s;for(let t=l.length-1,r=s;t>0;t--)r=r.add(l[t]),e=e.add(r);if(f=f.add(e),0!==t)for(let t=0;t<c;t++)f=f.double()}return f}function js(t){return hs(t.Fp),Yo(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ys(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const $s=BigInt(0),Ms=BigInt(1),qs=BigInt(2),Vs=BigInt(3),zs=BigInt(4);function Gs(t){const e=function(t){const e=js(t);Yo(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}(t),{Fp:r}=e,n=bs(e.n,e.nBitLength),i=e.toBytes||((t,e,n)=>{const i=e.toAffine();return Mo(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),o=e.fromBytes||(t=>{const e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function s(t){const{a:n,b:i}=e,o=r.sqr(t),s=r.mul(o,t);return r.add(r.add(s,r.mul(t,n)),i)}function a(t,e){const n=r.sqr(e),i=s(t);return r.eql(n,i)}if(!a(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const c=r.mul(r.pow(e.a,Vs),zs),u=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(c,u)))throw new Error("bad curve params: a or b");function l(t){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:i,n:o}=e;if(r&&"bigint"!=typeof t){if(Io(t)&&(t=Uo(t)),"string"!=typeof t||!r.includes(t.length))throw new Error("invalid private key");t=t.padStart(2*n,"0")}let s;try{s="bigint"==typeof t?t:Do($o("private key",t,n))}catch(e){throw new Error("invalid private key, expected hex or "+n+" bytes, got "+typeof t)}return i&&(s=ss(s,o)),Go("private key",s,Ms,o),s}function f(t){if(!(t instanceof p))throw new Error("ProjectivePoint expected")}const d=Jo(((t,e)=>{const{px:n,py:i,pz:o}=t;if(r.eql(o,r.ONE))return{x:n,y:i};const s=t.is0();null==e&&(e=s?r.ONE:r.inv(o));const a=r.mul(n,e),c=r.mul(i,e),u=r.mul(o,e);if(s)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw new Error("invZ was invalid");return{x:a,y:c}})),h=Jo((t=>{if(t.is0()){if(e.allowInfinityPoint&&!r.is0(t.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=t.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not FE");if(!a(n,i))throw new Error("bad point: equation left != right");if(!t.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));class p{constructor(t,e,n){if(null==t||!r.isValid(t))throw new Error("x required");if(null==e||!r.isValid(e)||r.is0(e))throw new Error("y required");if(null==n||!r.isValid(n))throw new Error("z required");this.px=t,this.py=e,this.pz=n,Object.freeze(this)}static fromAffine(t){const{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw new Error("invalid affine point");if(t instanceof p)throw new Error("projective point not allowed");const i=t=>r.eql(t,r.ZERO);return i(e)&&i(n)?p.ZERO:new p(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=gs(r,t.map((t=>t.pz)));return t.map(((t,r)=>t.toAffine(e[r]))).map(p.fromAffine)}static fromHex(t){const e=p.fromAffine(o($o("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return p.BASE.multiply(l(t))}static msm(t,e){return Fs(p,n,t,e)}_setWindowSize(t){y.setWindowSize(this,t)}assertValidity(){h(this)}hasEvenY(){const{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){f(t);const{px:e,py:n,pz:i}=this,{px:o,py:s,pz:a}=t,c=r.eql(r.mul(e,a),r.mul(o,i)),u=r.eql(r.mul(n,a),r.mul(s,i));return c&&u}negate(){return new p(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:n}=e,i=r.mul(n,Vs),{px:o,py:s,pz:a}=this;let c=r.ZERO,u=r.ZERO,l=r.ZERO,f=r.mul(o,o),d=r.mul(s,s),h=r.mul(a,a),g=r.mul(o,s);return g=r.add(g,g),l=r.mul(o,a),l=r.add(l,l),c=r.mul(t,l),u=r.mul(i,h),u=r.add(c,u),c=r.sub(d,u),u=r.add(d,u),u=r.mul(c,u),c=r.mul(g,c),l=r.mul(i,l),h=r.mul(t,h),g=r.sub(f,h),g=r.mul(t,g),g=r.add(g,l),l=r.add(f,f),f=r.add(l,f),f=r.add(f,h),f=r.mul(f,g),u=r.add(u,f),h=r.mul(s,a),h=r.add(h,h),f=r.mul(h,g),c=r.sub(c,f),l=r.mul(h,d),l=r.add(l,l),l=r.add(l,l),new p(c,u,l)}add(t){f(t);const{px:n,py:i,pz:o}=this,{px:s,py:a,pz:c}=t;let u=r.ZERO,l=r.ZERO,d=r.ZERO;const h=e.a,g=r.mul(e.b,Vs);let m=r.mul(n,s),y=r.mul(i,a),b=r.mul(o,c),w=r.add(n,i),v=r.add(s,a);w=r.mul(w,v),v=r.add(m,y),w=r.sub(w,v),v=r.add(n,o);let x=r.add(s,c);return v=r.mul(v,x),x=r.add(m,b),v=r.sub(v,x),x=r.add(i,o),u=r.add(a,c),x=r.mul(x,u),u=r.add(y,b),x=r.sub(x,u),d=r.mul(h,v),u=r.mul(g,b),d=r.add(u,d),u=r.sub(y,d),d=r.add(y,d),l=r.mul(u,d),y=r.add(m,m),y=r.add(y,m),b=r.mul(h,b),v=r.mul(g,v),y=r.add(y,b),b=r.sub(m,b),b=r.mul(h,b),v=r.add(v,b),m=r.mul(y,v),l=r.add(l,m),m=r.mul(x,v),u=r.mul(w,u),u=r.sub(u,m),m=r.mul(w,y),d=r.mul(x,d),d=r.add(d,m),new p(u,l,d)}subtract(t){return this.add(t.negate())}is0(){return this.equals(p.ZERO)}wNAF(t){return y.wNAFCached(this,t,p.normalizeZ)}multiplyUnsafe(t){const{endo:n,n:i}=e;Go("scalar",t,$s,i);const o=p.ZERO;if(t===$s)return o;if(this.is0()||t===Ms)return this;if(!n||y.hasPrecomputes(this))return y.wNAFCachedUnsafe(this,t,p.normalizeZ);let{k1neg:s,k1:a,k2neg:c,k2:u}=n.splitScalar(t),l=o,f=o,d=this;for(;a>$s||u>$s;)a&Ms&&(l=l.add(d)),u&Ms&&(f=f.add(d)),d=d.double(),a>>=Ms,u>>=Ms;return s&&(l=l.negate()),c&&(f=f.negate()),f=new p(r.mul(f.px,n.beta),f.py,f.pz),l.add(f)}multiply(t){const{endo:n,n:i}=e;let o,s;if(Go("scalar",t,Ms,i),n){const{k1neg:e,k1:i,k2neg:a,k2:c}=n.splitScalar(t);let{p:u,f:l}=this.wNAF(i),{p:f,f:d}=this.wNAF(c);u=y.constTimeNegate(e,u),f=y.constTimeNegate(a,f),f=new p(r.mul(f.px,n.beta),f.py,f.pz),o=u.add(f),s=l.add(d)}else{const{p:e,f:r}=this.wNAF(t);o=e,s=r}return p.normalizeZ([o,s])[0]}multiplyAndAddUnsafe(t,e,r){const n=p.BASE,i=(t,e)=>e!==$s&&e!==Ms&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),o=i(this,e).add(i(t,r));return o.is0()?void 0:o}toAffine(t){return d(this,t)}isTorsionFree(){const{h:t,isTorsionFree:r}=e;if(t===Ms)return!0;if(r)return r(p,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:r}=e;return t===Ms?this:r?r(p,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return To("isCompressed",t),this.assertValidity(),i(p,this,t)}toHex(t=!0){return To("isCompressed",t),Uo(this.toRawBytes(t))}}p.BASE=new p(e.Gx,e.Gy,r.ONE),p.ZERO=new p(r.ZERO,r.ONE,r.ZERO);const{endo:g,nBitLength:m}=e,y=Ls(p,g?Math.ceil(m/2):m);return{CURVE:e,ProjectivePoint:p,normPrivateKeyToScalar:l,weierstrassEquation:s,isWithinCurveOrder:function(t){return zo(t,Ms,e.n)}}}function Ks(t,e){if(hs(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const r=function(t,e){const r=t.ORDER;let n=$s;for(let t=r-Ms;t%qs===$s;t/=qs)n+=Ms;const i=n,o=qs<<i-Ms-Ms,s=o*qs,a=(r-Ms)/s,c=(a-Ms)/qs,u=s-Ms,l=o,f=t.pow(e,a),d=t.pow(e,(a+Ms)/qs);let h=(e,r)=>{let n=f,o=t.pow(r,u),s=t.sqr(o);s=t.mul(s,r);let a=t.mul(e,s);a=t.pow(a,c),a=t.mul(a,o),o=t.mul(a,r),s=t.mul(a,e);let h=t.mul(s,o);a=t.pow(h,l);let p=t.eql(a,t.ONE);o=t.mul(s,d),a=t.mul(h,n),s=t.cmov(o,s,p),h=t.cmov(a,h,p);for(let e=i;e>Ms;e--){let r=e-qs;r=qs<<r-Ms;let i=t.pow(h,r);const a=t.eql(i,t.ONE);o=t.mul(s,n),n=t.mul(n,n),i=t.mul(h,n),s=t.cmov(o,s,a),h=t.cmov(i,h,a)}return{isValid:p,value:s}};if(t.ORDER%zs===Vs){const r=(t.ORDER-Vs)/zs,n=t.sqrt(t.neg(e));h=(e,i)=>{let o=t.sqr(i);const s=t.mul(e,i);o=t.mul(o,s);let a=t.pow(o,r);a=t.mul(a,s);const c=t.mul(a,n),u=t.mul(t.sqr(a),i),l=t.eql(u,e);return{isValid:l,value:t.cmov(c,a,l)}}}return h}(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,o,s,a,c,u,l,f;i=t.sqr(n),i=t.mul(i,e.Z),o=t.sqr(i),o=t.add(o,i),s=t.add(o,t.ONE),s=t.mul(s,e.B),a=t.cmov(e.Z,t.neg(o),!t.eql(o,t.ZERO)),a=t.mul(a,e.A),o=t.sqr(s),u=t.sqr(a),c=t.mul(u,e.A),o=t.add(o,c),o=t.mul(o,s),u=t.mul(u,a),c=t.mul(u,e.B),o=t.add(o,c),l=t.mul(i,s);const{isValid:d,value:h}=r(o,u);f=t.mul(i,n),f=t.mul(f,h),l=t.cmov(l,s,d),f=t.cmov(f,h,d);const p=t.isOdd(n)===t.isOdd(f);f=t.cmov(t.neg(f),f,p);const g=gs(t,[a],!0)[0];return l=t.mul(l,g),{x:l,y:f}}}const Hs=BigInt(0),Zs=BigInt(1),Ws=BigInt(2),Ys=BigInt(3);const Xs=BigInt(0),Js=BigInt(1),Qs=BigInt(2),ta=BigInt(3);function ea(t,e,r,n,i=1,o){const s=BigInt(void 0===o?n:o),a=r**BigInt(n),c=[];for(let o=0;o<i;o++){const i=BigInt(o+1),u=[];for(let o=0,c=Js;o<n;o++){const n=(i*c-i)/s%a;u.push(t.pow(e,n)),c*=r}c.push(u)}return c}const ra=BigInt(0),na=BigInt(1),ia=BigInt(2),oa=BigInt(3),sa=BigInt(4),aa=BigInt("0xd201000000010000"),ca=Ko(aa),{Fp:ua,Fp2:la,Fp6:fa,Fp4Square:da,Fp12:ha}=function(t){const{ORDER:e}=t,r=bs(e),n=r.create(t.NONRESIDUE||BigInt(-1)),i=r.div(r.ONE,Qs),o=ea(r,n,r.ORDER,2)[0],s=({c0:t,c1:e},{c0:n,c1:i})=>({c0:r.add(t,n),c1:r.add(e,i)}),a=({c0:t,c1:e},{c0:n,c1:i})=>({c0:r.sub(t,n),c1:r.sub(e,i)}),c=({c0:t,c1:e},n)=>{if("bigint"==typeof n)return{c0:r.mul(t,n),c1:r.mul(e,n)};const{c0:i,c1:o}=n;let s=r.mul(t,i),a=r.mul(e,o);return{c0:r.sub(s,a),c1:r.sub(r.mul(r.add(t,e),r.add(i,o)),r.add(s,a))}},u=({c0:t,c1:e})=>{const n=r.add(t,e),i=r.sub(t,e),o=r.add(t,t);return{c0:r.mul(n,i),c1:r.mul(o,e)}},l=t=>{if(2!==t.length)throw new Error("invalid tuple");const e=t.map((t=>r.create(t)));return{c0:e[0],c1:e[1]}},f=e*e,d=l(t.FP2_NONRESIDUE),h={ORDER:f,isLE:r.isLE,NONRESIDUE:d,BITS:Ko(f),BYTES:Math.ceil(Ko(f)/8),MASK:Zo(Ko(f)),ZERO:{c0:r.ZERO,c1:r.ZERO},ONE:{c0:r.ONE,c1:r.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>"bigint"==typeof t&&"bigint"==typeof e,is0:({c0:t,c1:e})=>r.is0(t)&&r.is0(e),eql:({c0:t,c1:e},{c0:n,c1:i})=>r.eql(t,n)&&r.eql(e,i),neg:({c0:t,c1:e})=>({c0:r.neg(t),c1:r.neg(e)}),pow:(t,e)=>ps(h,t,e),invertBatch:t=>gs(h,t),add:s,sub:a,mul:c,sqr:u,addN:s,subN:a,mulN:c,sqrN:u,div:(t,e)=>h.mul(t,"bigint"==typeof e?r.inv(r.create(e)):h.inv(e)),inv:({c0:t,c1:e})=>{const n=r.inv(r.create(t*t+e*e));return{c0:r.mul(n,r.create(t)),c1:r.mul(n,r.create(-e))}},sqrt:e=>{if(t.Fp2sqrt)return t.Fp2sqrt(e);const{c0:o,c1:s}=e;if(r.is0(s))return 1===ms(r,o)?h.create({c0:r.sqrt(o),c1:r.ZERO}):h.create({c0:r.ZERO,c1:r.sqrt(r.div(o,n))});const a=r.sqrt(r.sub(r.sqr(o),r.mul(r.sqr(s),n)));let c=r.mul(r.add(a,o),i);-1===ms(r,c)&&(c=r.sub(c,a));const u=r.sqrt(c),l=h.create({c0:u,c1:r.div(r.mul(s,i),u)});if(!h.eql(h.sqr(l),e))throw new Error("Cannot find square root");const f=l,d=h.neg(f),{re:p,im:g}=h.reim(f),{re:m,im:y}=h.reim(d);return g>y||g===y&&p>m?f:d},isOdd:t=>{const{re:e,im:r}=h.reim(t);return BigInt(e%Qs||e===Xs&&r%Qs)==Js},fromBytes(t){if(t.length!==h.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:r.fromBytes(t.subarray(0,r.BYTES)),c1:r.fromBytes(t.subarray(r.BYTES))}},toBytes:({c0:t,c1:e})=>Mo(r.toBytes(t),r.toBytes(e)),cmov:({c0:t,c1:e},{c0:n,c1:i},o)=>({c0:r.cmov(t,n,o),c1:r.cmov(e,i,o)}),reim:({c0:t,c1:e})=>({re:t,im:e}),mulByNonresidue:({c0:t,c1:e})=>h.mul({c0:t,c1:e},d),mulByB:t.Fp2mulByB,fromBigTuple:l,frobeniusMap:({c0:t,c1:e},n)=>({c0:t,c1:r.mul(e,o[n%2])})},p=({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o})=>({c0:h.add(t,n),c1:h.add(e,i),c2:h.add(r,o)}),g=({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o})=>({c0:h.sub(t,n),c1:h.sub(e,i),c2:h.sub(r,o)}),m=({c0:t,c1:e,c2:r},n)=>{if("bigint"==typeof n)return{c0:h.mul(t,n),c1:h.mul(e,n),c2:h.mul(r,n)};const{c0:i,c1:o,c2:s}=n,a=h.mul(t,i),c=h.mul(e,o),u=h.mul(r,s);return{c0:h.add(a,h.mulByNonresidue(h.sub(h.mul(h.add(e,r),h.add(o,s)),h.add(c,u)))),c1:h.add(h.sub(h.mul(h.add(t,e),h.add(i,o)),h.add(a,c)),h.mulByNonresidue(u)),c2:h.sub(h.add(c,h.mul(h.add(t,r),h.add(i,s))),h.add(a,u))}},y=({c0:t,c1:e,c2:r})=>{let n=h.sqr(t),i=h.mul(h.mul(t,e),Qs),o=h.mul(h.mul(e,r),Qs),s=h.sqr(r);return{c0:h.add(h.mulByNonresidue(o),n),c1:h.add(h.mulByNonresidue(s),i),c2:h.sub(h.sub(h.add(h.add(i,h.sqr(h.add(h.sub(t,e),r))),o),n),s)}},[b,w]=ea(h,d,r.ORDER,6,2,3),v={ORDER:h.ORDER,isLE:h.isLE,BITS:3*h.BITS,BYTES:3*h.BYTES,MASK:Zo(3*h.BITS),ZERO:{c0:h.ZERO,c1:h.ZERO,c2:h.ZERO},ONE:{c0:h.ONE,c1:h.ZERO,c2:h.ZERO},create:t=>t,isValid:({c0:t,c1:e,c2:r})=>h.isValid(t)&&h.isValid(e)&&h.isValid(r),is0:({c0:t,c1:e,c2:r})=>h.is0(t)&&h.is0(e)&&h.is0(r),neg:({c0:t,c1:e,c2:r})=>({c0:h.neg(t),c1:h.neg(e),c2:h.neg(r)}),eql:({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o})=>h.eql(t,n)&&h.eql(e,i)&&h.eql(r,o),sqrt:Xo,div:(t,e)=>v.mul(t,"bigint"==typeof e?r.inv(r.create(e)):v.inv(e)),pow:(t,e)=>ps(v,t,e),invertBatch:t=>gs(v,t),add:p,sub:g,mul:m,sqr:y,addN:p,subN:g,mulN:m,sqrN:y,inv:({c0:t,c1:e,c2:r})=>{let n=h.sub(h.sqr(t),h.mulByNonresidue(h.mul(r,e))),i=h.sub(h.mulByNonresidue(h.sqr(r)),h.mul(t,e)),o=h.sub(h.sqr(e),h.mul(t,r)),s=h.inv(h.add(h.mulByNonresidue(h.add(h.mul(r,i),h.mul(e,o))),h.mul(t,n)));return{c0:h.mul(s,n),c1:h.mul(s,i),c2:h.mul(s,o)}},fromBytes:t=>{if(t.length!==v.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:h.fromBytes(t.subarray(0,h.BYTES)),c1:h.fromBytes(t.subarray(h.BYTES,2*h.BYTES)),c2:h.fromBytes(t.subarray(2*h.BYTES))}},toBytes:({c0:t,c1:e,c2:r})=>Mo(h.toBytes(t),h.toBytes(e),h.toBytes(r)),cmov:({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o},s)=>({c0:h.cmov(t,n,s),c1:h.cmov(e,i,s),c2:h.cmov(r,o,s)}),fromBigSix:t=>{if(!Array.isArray(t)||6!==t.length)throw new Error("invalid Fp6 usage");return{c0:h.fromBigTuple(t.slice(0,2)),c1:h.fromBigTuple(t.slice(2,4)),c2:h.fromBigTuple(t.slice(4,6))}},frobeniusMap:({c0:t,c1:e,c2:r},n)=>({c0:h.frobeniusMap(t,n),c1:h.mul(h.frobeniusMap(e,n),b[n%6]),c2:h.mul(h.frobeniusMap(r,n),w[n%6])}),mulByFp2:({c0:t,c1:e,c2:r},n)=>({c0:h.mul(t,n),c1:h.mul(e,n),c2:h.mul(r,n)}),mulByNonresidue:({c0:t,c1:e,c2:r})=>({c0:h.mulByNonresidue(r),c1:t,c2:e}),mul1:({c0:t,c1:e,c2:r},n)=>({c0:h.mulByNonresidue(h.mul(r,n)),c1:h.mul(t,n),c2:h.mul(e,n)}),mul01({c0:t,c1:e,c2:r},n,i){let o=h.mul(t,n),s=h.mul(e,i);return{c0:h.add(h.mulByNonresidue(h.sub(h.mul(h.add(e,r),i),s)),o),c1:h.sub(h.sub(h.mul(h.add(n,i),h.add(t,e)),o),s),c2:h.add(h.sub(h.mul(h.add(t,r),n),o),s)}}},x=ea(h,d,r.ORDER,12,1,6)[0],E=({c0:t,c1:e},{c0:r,c1:n})=>({c0:v.add(t,r),c1:v.add(e,n)}),_=({c0:t,c1:e},{c0:r,c1:n})=>({c0:v.sub(t,r),c1:v.sub(e,n)}),B=({c0:t,c1:e},r)=>{if("bigint"==typeof r)return{c0:v.mul(t,r),c1:v.mul(e,r)};let{c0:n,c1:i}=r,o=v.mul(t,n),s=v.mul(e,i);return{c0:v.add(o,v.mulByNonresidue(s)),c1:v.sub(v.mul(v.add(t,e),v.add(n,i)),v.add(o,s))}},S=({c0:t,c1:e})=>{let r=v.mul(t,e);return{c0:v.sub(v.sub(v.mul(v.add(v.mulByNonresidue(e),t),v.add(t,e)),r),v.mulByNonresidue(r)),c1:v.add(r,r)}},I={ORDER:h.ORDER,isLE:v.isLE,BITS:2*v.BITS,BYTES:2*v.BYTES,MASK:Zo(2*v.BITS),ZERO:{c0:v.ZERO,c1:v.ZERO},ONE:{c0:v.ONE,c1:v.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>v.isValid(t)&&v.isValid(e),is0:({c0:t,c1:e})=>v.is0(t)&&v.is0(e),neg:({c0:t,c1:e})=>({c0:v.neg(t),c1:v.neg(e)}),eql:({c0:t,c1:e},{c0:r,c1:n})=>v.eql(t,r)&&v.eql(e,n),sqrt:Xo,inv:({c0:t,c1:e})=>{let r=v.inv(v.sub(v.sqr(t),v.mulByNonresidue(v.sqr(e))));return{c0:v.mul(t,r),c1:v.neg(v.mul(e,r))}},div:(t,e)=>I.mul(t,"bigint"==typeof e?r.inv(r.create(e)):I.inv(e)),pow:(t,e)=>ps(I,t,e),invertBatch:t=>gs(I,t),add:E,sub:_,mul:B,sqr:S,addN:E,subN:_,mulN:B,sqrN:S,fromBytes:t=>{if(t.length!==I.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:v.fromBytes(t.subarray(0,v.BYTES)),c1:v.fromBytes(t.subarray(v.BYTES))}},toBytes:({c0:t,c1:e})=>Mo(v.toBytes(t),v.toBytes(e)),cmov:({c0:t,c1:e},{c0:r,c1:n},i)=>({c0:v.cmov(t,r,i),c1:v.cmov(e,n,i)}),fromBigTwelve:t=>({c0:v.fromBigSix(t.slice(0,6)),c1:v.fromBigSix(t.slice(6,12))}),frobeniusMap(t,e){const{c0:r,c1:n,c2:i}=v.frobeniusMap(t.c1,e),o=x[e%12];return{c0:v.frobeniusMap(t.c0,e),c1:v.create({c0:h.mul(r,o),c1:h.mul(n,o),c2:h.mul(i,o)})}},mulByFp2:({c0:t,c1:e},r)=>({c0:v.mulByFp2(t,r),c1:v.mulByFp2(e,r)}),conjugate:({c0:t,c1:e})=>({c0:t,c1:v.neg(e)}),mul014:({c0:t,c1:e},r,n,i)=>{let o=v.mul01(t,r,n),s=v.mul1(e,i);return{c0:v.add(v.mulByNonresidue(s),o),c1:v.sub(v.sub(v.mul01(v.add(e,t),r,h.add(n,i)),o),s)}},mul034:({c0:t,c1:e},r,n,i)=>{const o=v.create({c0:h.mul(t.c0,r),c1:h.mul(t.c1,r),c2:h.mul(t.c2,r)}),s=v.mul01(e,n,i),a=v.mul01(v.add(t,e),h.add(r,n),i);return{c0:v.add(v.mulByNonresidue(s),o),c1:v.sub(a,v.add(o,s))}},_cyclotomicSquare:t.Fp12cyclotomicSquare,_cyclotomicExp:t.Fp12cyclotomicExp,finalExponentiate:t.Fp12finalExponentiate};return{Fp:r,Fp2:h,Fp6:v,Fp4Square:function(t,e){const r=h.sqr(t),n=h.sqr(e);return{first:h.add(h.mulByNonresidue(n),r),second:h.sub(h.sub(h.sqr(h.add(t,e)),r),n)}},Fp12:I}}({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[na,na],Fp2mulByB:({c0:t,c1:e})=>{const r=ua.mul(t,sa),n=ua.mul(e,sa);return{c0:ua.sub(r,n),c1:ua.add(r,n)}},Fp12cyclotomicSquare:({c0:t,c1:e})=>{const{c0:r,c1:n,c2:i}=t,{c0:o,c1:s,c2:a}=e,{first:c,second:u}=da(r,s),{first:l,second:f}=da(o,i),{first:d,second:h}=da(n,a),p=la.mulByNonresidue(h);return{c0:fa.create({c0:la.add(la.mul(la.sub(c,r),ia),c),c1:la.add(la.mul(la.sub(l,n),ia),l),c2:la.add(la.mul(la.sub(d,i),ia),d)}),c1:fa.create({c0:la.add(la.mul(la.add(p,o),ia),p),c1:la.add(la.mul(la.add(u,s),ia),u),c2:la.add(la.mul(la.add(f,a),ia),f)})}},Fp12cyclotomicExp(t,e){let r=ha.ONE;for(let n=ca-1;n>=0;n--)r=ha._cyclotomicSquare(r),Ho(e,n)&&(r=ha.mul(r,t));return r},Fp12finalExponentiate:t=>{const e=aa,r=ha.div(ha.frobeniusMap(t,6),t),n=ha.mul(ha.frobeniusMap(r,2),r),i=ha.conjugate(ha._cyclotomicExp(n,e)),o=ha.mul(ha.conjugate(ha._cyclotomicSquare(n)),i),s=ha.conjugate(ha._cyclotomicExp(o,e)),a=ha.conjugate(ha._cyclotomicExp(s,e)),c=ha.mul(ha.conjugate(ha._cyclotomicExp(a,e)),ha._cyclotomicSquare(i)),u=ha.conjugate(ha._cyclotomicExp(c,e)),l=ha.frobeniusMap(ha.mul(i,a),2),f=ha.frobeniusMap(ha.mul(s,n),3),d=ha.frobeniusMap(ha.mul(c,ha.conjugate(n)),1),h=ha.mul(ha.mul(u,ha.conjugate(o)),n);return ha.mul(ha.mul(ha.mul(l,f),d),h)}}),pa=bs(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),ma=Is(la,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map((t=>t.map((t=>la.fromBigTuple(t.map(BigInt))))))),ya=Is(ua,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map((t=>t.map((t=>BigInt(t)))))),ba=Ks(la,{A:la.create({c0:ua.create(ra),c1:ua.create(BigInt(240))}),B:la.create({c0:ua.create(BigInt(1012)),c1:ua.create(BigInt(1012))}),Z:la.create({c0:ua.create(BigInt(-2)),c1:ua.create(BigInt(-1))})}),wa=Ks(ua,{A:ua.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:ua.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:ua.create(BigInt(11))}),{G2psi:va,G2psi2:xa}=function(t,e,r){const n=e.pow(r,(t.ORDER-Js)/ta),i=e.pow(r,(t.ORDER-Js)/Qs);function o(t,r){return[e.mul(e.frobeniusMap(t,1),n),e.mul(e.frobeniusMap(r,1),i)]}const s=e.pow(r,(t.ORDER**Qs-Js)/ta),a=e.pow(r,(t.ORDER**Qs-Js)/Qs);if(!e.eql(a,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function c(t,r){return[e.mul(t,s),e.neg(r)]}const u=t=>(e,r)=>{const n=r.toAffine(),i=t(n.x,n.y);return e.fromAffine({x:i[0],y:i[1]})};return{psi:o,psi2:c,G2psi:u(o),G2psi2:u(c),PSI_X:n,PSI_Y:i,PSI2_X:s,PSI2_Y:a}}(ua,la,la.div(la.ONE,la.NONRESIDUE)),Ea=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:ua.ORDER,m:2,k:128,expand:"xmd",hash:Oe}),_a=Sa(ua.toBytes(ra),{infinity:!0,compressed:!0});function Ba(t){const e=224&(t=t.slice())[0],r=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return t[0]&=31,{compressed:r,infinity:n,sort:i,value:t}}function Sa(t,e){if(224&t[0])throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function Ia(t){t.assertValidity();const e=t.equals(Ta.G1.ProjectivePoint.ZERO),{x:r,y:n}=t.toAffine();if(e)return _a.slice();const i=ua.ORDER,o=Boolean(n*ia/i);return Sa(Fo(r,ua.BYTES),{compressed:!0,sort:o})}function Aa(t){t.assertValidity();const e=ua.BYTES;if(t.equals(Ta.G2.ProjectivePoint.ZERO))return Mo(_a,Fo(ra,e));const{x:r,y:n}=t.toAffine(),{re:i,im:o}=la.reim(r),{re:s,im:a}=la.reim(n),c=Boolean((a>ra?a*ia:s*ia)/ua.ORDER&na),u=i;return Mo(Sa(Fo(o,e),{sort:c,compressed:!0}),Fo(u,e))}const Ta=function(t){const{Fp:e,Fr:r,Fp2:n,Fp6:i,Fp12:o}=t.fields,s=t.params.xNegative,a=t.params.twistType,c=Gs({n:r.ORDER,...t.G1}),u=Object.assign(c,As(c.ProjectivePoint,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),l=Gs({n:r.ORDER,...t.G2}),f=Object.assign(l,As(l.ProjectivePoint,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults}));let d;if("multiplicative"===a)d=(t,e,r,i,s,a)=>o.mul014(i,t,n.mul(e,s),n.mul(r,a));else{if("divisive"!==a)throw new Error("bls: unknown twist type");d=(t,e,r,i,s,a)=>o.mul034(i,n.mul(r,a),n.mul(e,s),t)}const h=n.div(n.ONE,n.mul(n.ONE,Ws));function p(t,e,r,i){const o=n.sqr(r),s=n.sqr(i),a=n.mulByB(n.mul(s,Ys)),c=n.mul(a,Ys),u=n.sub(n.sub(n.sqr(n.add(r,i)),s),o),l=n.sub(a,o),f=n.mul(n.sqr(e),Ys),d=n.neg(u);return t.push([l,f,d]),{Rx:e=n.mul(n.mul(n.mul(n.sub(o,c),e),r),h),Ry:r=n.sub(n.sqr(n.mul(n.add(o,c),h)),n.mul(n.sqr(a),Ys)),Rz:i=n.mul(o,u)}}function g(t,e,r,i,o,s){const a=n.sub(r,n.mul(s,i)),c=n.sub(e,n.mul(o,i)),u=n.sub(n.mul(a,o),n.mul(c,s)),l=n.neg(a),f=c;t.push([u,l,f]);const d=n.sqr(c),h=n.mul(d,c),p=n.mul(d,e),g=n.add(n.sub(h,n.mul(p,Ws)),n.mul(n.sqr(a),i));return{Rx:e=n.mul(c,g),Ry:r=n.sub(n.mul(n.sub(p,g),a),n.mul(h,r)),Rz:i=n.mul(i,h)}}const m=function(t){const e=[];for(;t>Zs;t>>=Zs)(t&Zs)===Hs?e.unshift(0):(t&Ys)===Ys?(e.unshift(-1),t+=Zs):e.unshift(1);return e}(t.params.ateLoopSize),y=Jo((e=>{const r=e,{x:i,y:o}=r.toAffine(),s=i,a=o,c=n.neg(o);let u=s,l=a,f=n.ONE;const d=[];for(const t of m){const e=[];({Rx:u,Ry:l,Rz:f}=p(e,u,l,f)),t&&({Rx:u,Ry:l,Rz:f}=g(e,u,l,f,s,-1===t?c:a)),d.push(e)}if(t.postPrecompute){const e=d[d.length-1];t.postPrecompute(u,l,f,s,a,g.bind(null,e))}return d}));function b(t,e=!1){let r=o.ONE;if(t.length){const e=t[0][0].length;for(let n=0;n<e;n++){r=o.sqr(r);for(const[e,i,o]of t)for(const[t,s,a]of e[n])r=d(t,s,a,r,i,o)}}return s&&(r=o.conjugate(r)),e?o.finalExponentiate(r):r}function w(t,e=!0){const r=[];u.ProjectivePoint.normalizeZ(t.map((({g1:t})=>t))),f.ProjectivePoint.normalizeZ(t.map((({g2:t})=>t)));for(const{g1:e,g2:n}of t){if(e.equals(u.ProjectivePoint.ZERO)||n.equals(f.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");e.assertValidity(),n.assertValidity();const t=e.toAffine();r.push([y(n),t.x,t.y])}return b(r,e)}const v={randomPrivateKey:()=>{const e=vs(r.ORDER);return function(t,e,r=!1){const n=t.length,i=ws(e),o=vs(e);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const s=ss(r?Lo(t):Do(t),e-ts)+ts;return r?jo(s,i):Fo(s,i)}(t.randomBytes(e),r.ORDER)},calcPairingPrecomputes:y},{ShortSignature:x}=t.G1,{Signature:E}=t.G2;function _(t){return t instanceof u.ProjectivePoint?t:u.ProjectivePoint.fromHex(t)}function B(t,e){return t instanceof u.ProjectivePoint?t:u.hashToCurve($o("point",t),e)}function S(t){return t instanceof f.ProjectivePoint?t:E.fromHex(t)}function I(t,e){return t instanceof f.ProjectivePoint?t:f.hashToCurve($o("point",t),e)}function A(t){if(!Array.isArray(t)||0===t.length)throw new Error("expected non-empty array")}return u.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:function(t){return u.ProjectivePoint.fromPrivateKey(t).toRawBytes(!0)},getPublicKeyForShortSignatures:function(t){return f.ProjectivePoint.fromPrivateKey(t).toRawBytes(!0)},sign:function(t,e,r){const n=I(t,r);n.assertValidity();const i=n.multiply(u.normPrivateKeyToScalar(e));return t instanceof f.ProjectivePoint?i:E.toRawBytes(i)},signShortSignature:function(t,e,r){const n=B(t,r);n.assertValidity();const i=n.multiply(u.normPrivateKeyToScalar(e));return t instanceof u.ProjectivePoint?i:x.toRawBytes(i)},verify:function(t,e,r,n){const i=_(r),s=I(e,n),a=u.ProjectivePoint.BASE,c=S(t),l=w([{g1:i.negate(),g2:s},{g1:a,g2:c}]);return o.eql(l,o.ONE)},verifyBatch:function(t,e,r,n){if(A(e),r.length!==e.length)throw new Error("amount of public keys and messages should be equal");const i=S(t),s=e.map((t=>I(t,n))),a=r.map(_),c=new Map;for(let t=0;t<a.length;t++){const e=a[t],r=s[t];let n=c.get(r);void 0===n&&(n=[],c.set(r,n)),n.push(e)}const l=[];try{for(const[t,e]of c){const r=e.reduce(((t,e)=>t.add(e)));l.push({g1:r,g2:t})}return l.push({g1:u.ProjectivePoint.BASE.negate(),g2:i}),o.eql(w(l),o.ONE)}catch{return!1}},verifyShortSignature:function(t,e,r,n){const i=S(r),s=B(e,n),a=f.ProjectivePoint.BASE,c=w([{g1:s,g2:i},{g1:_(t),g2:a.negate()}]);return o.eql(c,o.ONE)},aggregatePublicKeys:function(t){A(t);const e=t.map(_).reduce(((t,e)=>t.add(e)),u.ProjectivePoint.ZERO);return t[0]instanceof u.ProjectivePoint?(e.assertValidity(),e):e.toRawBytes(!0)},aggregateSignatures:function(t){A(t);const e=t.map(S).reduce(((t,e)=>t.add(e)),f.ProjectivePoint.ZERO);return t[0]instanceof f.ProjectivePoint?(e.assertValidity(),e):E.toRawBytes(e)},aggregateShortSignatures:function(t){A(t);const e=t.map(_).reduce(((t,e)=>t.add(e)),u.ProjectivePoint.ZERO);return t[0]instanceof u.ProjectivePoint?(e.assertValidity(),e):x.toRawBytes(e)},millerLoopBatch:b,pairing:function(t,e,r=!0){return w([{g1:t,g2:e}],r)},pairingBatch:w,G1:u,G2:f,Signature:E,ShortSignature:x,fields:{Fr:r,Fp:e,Fp2:n,Fp6:i,Fp12:o},params:{ateLoopSize:t.params.ateLoopSize,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:v}}({fields:{Fp:ua,Fp2:la,Fp6:fa,Fp12:ha,Fr:pa},G1:{Fp:ua,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:ua.ZERO,b:sa,htfDefaults:{...Ea,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const r=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new t(ua.mul(e.px,r),e.py,e.pz);return e.multiplyUnsafe(aa).negate().multiplyUnsafe(aa).equals(n)},clearCofactor:(t,e)=>e.multiplyUnsafe(aa).add(e),mapToCurve:t=>{const{x:e,y:r}=wa(ua.create(t[0]));return ya(e,r)},fromBytes:t=>{const{compressed:e,infinity:r,sort:n,value:i}=Ba(t);if(48===i.length&&e){const t=ua.ORDER,e=Do(i),o=ua.create(e&ua.MASK);if(r){if(o!==ra)throw new Error("G1: non-empty compressed point at infinity");return{x:ra,y:ra}}const s=ua.add(ua.pow(o,oa),ua.create(Ta.params.G1b));let a=ua.sqrt(s);if(!a)throw new Error("invalid compressed G1 point");return a*ia/t!==BigInt(n)&&(a=ua.neg(a)),{x:ua.create(o),y:ua.create(a)}}if(96!==i.length||e)throw new Error("invalid point G1, expected 48/96 bytes");{const t=Do(i.subarray(0,ua.BYTES)),e=Do(i.subarray(ua.BYTES));if(r){if(t!==ra||e!==ra)throw new Error("G1: non-empty point at infinity");return Ta.G1.ProjectivePoint.ZERO.toAffine()}return{x:ua.create(t),y:ua.create(e)}}},toBytes:(t,e,r)=>{const n=e.equals(t.ZERO),{x:i,y:o}=e.toAffine();if(r){if(n)return _a.slice();const t=ua.ORDER,e=Boolean(o*ia/t);return Sa(Fo(i,ua.BYTES),{compressed:!0,sort:e})}if(n){return Mo(new Uint8Array([64]),new Uint8Array(2*ua.BYTES-1))}return Mo(Fo(i,ua.BYTES),Fo(o,ua.BYTES))},ShortSignature:{fromHex(t){const{infinity:e,sort:r,value:n}=Ba($o("signatureHex",t,48)),i=ua.ORDER,o=Do(n);if(e)return Ta.G1.ProjectivePoint.ZERO;const s=ua.create(o&ua.MASK),a=ua.add(ua.pow(s,oa),ua.create(Ta.params.G1b));let c=ua.sqrt(a);if(!c)throw new Error("invalid compressed G1 point");const u=BigInt(r);c*ia/i!==u&&(c=ua.neg(c));const l=Ta.G1.ProjectivePoint.fromAffine({x:s,y:c});return l.assertValidity(),l},toRawBytes:t=>Ia(t),toHex:t=>Uo(Ia(t))}},G2:{Fp:la,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:la.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:la.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:la.ZERO,b:la.fromBigTuple([sa,sa]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...Ea},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:t=>{const{x:e,y:r}=ba(la.fromBigTuple(t));return ma(e,r)},isTorsionFree:(t,e)=>e.multiplyUnsafe(aa).negate().equals(va(t,e)),clearCofactor:(t,e)=>{const r=aa;let n=e.multiplyUnsafe(r).negate(),i=va(t,e),o=e.double();o=xa(t,o),o=o.subtract(i),i=n.add(i),i=i.multiplyUnsafe(r).negate(),o=o.add(i),o=o.subtract(n);return o.subtract(e)},fromBytes:t=>{const{compressed:e,infinity:r,sort:n,value:i}=Ba(t);if(!e&&!r&&n||!e&&r&&n||n&&r&&e)throw new Error("invalid encoding flag: "+(224&t[0]));const o=ua.BYTES,s=(t,e,r)=>Do(t.slice(e,r));if(96===i.length&&e){const t=Ta.params.G2b,e=ua.ORDER;if(r){if(i.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid compressed G2 point");return{x:la.ZERO,y:la.ZERO}}const a=s(i,0,o),c=s(i,o,2*o),u=la.create({c0:ua.create(c),c1:ua.create(a)}),l=la.add(la.pow(u,oa),t);let f=la.sqrt(l);const d=f.c1===ra?f.c0*ia/e:f.c1*ia/e?na:ra;return f=n&&d>0?f:la.neg(f),{x:u,y:f}}if(192!==i.length||e)throw new Error("invalid point G2, expected 96/192 bytes");{if(r){if(i.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid uncompressed G2 point");return{x:la.ZERO,y:la.ZERO}}const t=s(i,0,o),e=s(i,o,2*o),n=s(i,2*o,3*o),a=s(i,3*o,4*o);return{x:la.fromBigTuple([e,t]),y:la.fromBigTuple([a,n])}}},toBytes:(t,e,r)=>{const{BYTES:n,ORDER:i}=ua,o=e.equals(t.ZERO),{x:s,y:a}=e.toAffine();if(r){if(o)return Mo(_a,Fo(ra,n));const t=Boolean(a.c1===ra?a.c0*ia/i:a.c1*ia/i);return Mo(Sa(Fo(s.c1,n),{compressed:!0,sort:t}),Fo(s.c0,n))}{if(o)return Mo(new Uint8Array([64]),new Uint8Array(4*n-1));const{re:t,im:e}=la.reim(s),{re:r,im:i}=la.reim(a);return Mo(Fo(e,n),Fo(t,n),Fo(i,n),Fo(r,n))}},Signature:{fromHex(t){const{infinity:e,sort:r,value:n}=Ba($o("signatureHex",t)),i=ua.ORDER,o=n.length/2;if(48!==o&&96!==o)throw new Error("invalid compressed signature length, must be 96 or 192");const s=Do(n.slice(0,o)),a=Do(n.slice(o));if(e)return Ta.G2.ProjectivePoint.ZERO;const c=ua.create(s&ua.MASK),u=ua.create(a),l=la.create({c0:u,c1:c}),f=la.add(la.pow(l,oa),Ta.params.G2b);let d=la.sqrt(f);if(!d)throw new Error("Failed to find a square root");const{re:h,im:p}=la.reim(d),g=BigInt(r);(p>ra&&p*ia/i!==g||p===ra&&h*ia/i!==g)&&(d=la.neg(d));const m=Ta.G2.ProjectivePoint.fromAffine({x:l,y:d});return m.assertValidity(),m},toRawBytes:t=>Aa(t),toHex:t=>Uo(Aa(t))}},params:{ateLoopSize:aa,r:pa.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:Ea,hash:Oe,randomBytes:Xt});function Na(t,e,r){const n="string"==typeof t?t:Fe(t),i="string"==typeof e?e:Fe(e),o="string"==typeof r?r:Fe(r);return Ta.verifyShortSignature(i,o,n)}const Oa=t=>er(new He(t)),Ra=t=>{const e=Oa(t);return new Date(Number(e)/1e6)};var Ua,ka,Pa=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},Ca=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class Da extends Ge{constructor(t){super(`Invalid certificate: ${t}`)}}!function(t){t[t.Empty=0]="Empty",t[t.Fork=1]="Fork",t[t.Labeled=2]="Labeled",t[t.Leaf=3]="Leaf",t[t.Pruned=4]="Pruned"}(ka||(ka={}));class La{constructor(t,e,r,n,i=5,o=!1){this._rootKey=e,this._canisterId=r,this._blsVerify=n,this._maxAgeInMinutes=i,Ua.set(this,!1),Pa(this,Ua,o,"f"),this.cert=fo(new Uint8Array(t))}static async create(t){const e=La.createUnverified(t);return await e.verify(),e}static createUnverified(t){let e=t.blsVerify;return e||(e=Na),new La(t.certificate,t.rootKey,t.canisterId,e,t.maxAgeInMinutes,t.disableTimeVerification)}lookup(t){return Ga(t,this.cert.tree)}lookup_label(t){return this.lookup([t])}async verify(){const t=await Ma(this.cert.tree),e=await this._checkDelegationAndGetKey(this.cert.delegation),r=this.cert.signature,n=function(t){const e=Fa.byteLength+ja;if(t.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const r=t.slice(0,Fa.byteLength);if(!qe(r,Fa))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${Fa}, but get ${r}`);return t.slice(Fa.byteLength)}(e),i=Le(qa("ic-state-root"),t);let o=!1;const s=$a(this.lookup(["time"]));if(!s)throw new Da("Certificate does not contain a time");if(!Ca(this,Ua,"f")){const t=3e5,e=60*this._maxAgeInMinutes*1e3,r=Date.now(),n=r-e,i=r+t,o=Ra(s);if(o.getTime()<n)throw new Da(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+o.toISOString()+" Current time: "+new Date(r).toISOString());if(o.getTime()>i)throw new Da("Certificate is signed more than 5 minutes in the future. Certificate time: "+o.toISOString()+" Current time: "+new Date(r).toISOString())}try{o=await this._blsVerify(new Uint8Array(n),new Uint8Array(r),new Uint8Array(i))}catch(t){o=!1}if(!o)throw new Da("Signature verification failed")}async _checkDelegationAndGetKey(t){if(!t)return this._rootKey;const e=await La.createUnverified({certificate:t.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(e.cert.delegation)throw new Da("Delegation certificates cannot be nested");if(await e.verify(),this._canisterId.toString()!==Nu){if(!Za({canisterId:this._canisterId,subnetId:De.fromUint8Array(new Uint8Array(t.subnet_id)),tree:e.cert.tree}))throw new Da(`Canister ${this._canisterId} not in range of delegations for subnet 0x${Fe(t.subnet_id)}`)}const r=$a(e.lookup(["subnet",t.subnet_id,"public_key"]));if(!r)throw new Error(`Could not find subnet key for subnet 0x${Fe(t.subnet_id)}`);return r}}Ua=new WeakMap;const Fa=$e("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),ja=96;function $a(t){if(t.status===Va.Found)return t.value instanceof ArrayBuffer?t.value:t.value instanceof Uint8Array?t.value.buffer:void 0}async function Ma(t){switch(t[0]){case ka.Empty:return Bi(qa("ic-hashtree-empty"));case ka.Pruned:return t[1];case ka.Leaf:return Bi(Le(qa("ic-hashtree-leaf"),t[1]));case ka.Labeled:return Bi(Le(qa("ic-hashtree-labeled"),t[1],await Ma(t[2])));case ka.Fork:return Bi(Le(qa("ic-hashtree-fork"),await Ma(t[1]),await Ma(t[2])));default:throw new Error("unreachable")}}function qa(t){return Le(new Uint8Array([t.length]),(new TextEncoder).encode(t))}var Va,za;function Ga(t,e){if(0===t.length){if(e[0]===ka.Leaf){if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:Va.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:Va.Found,value:e[1].buffer}:{status:Va.Found,value:e[1]}}return{status:Va.Found,value:e}}const r=Ha("string"==typeof t[0]?(new TextEncoder).encode(t[0]):t[0],e);switch(r.status){case Va.Found:return Ga(t.slice(1),r.value);case za.Greater:case za.Less:return{status:Va.Absent};default:return r}}function Ka(t){switch(t[0]){case ka.Empty:return[];case ka.Fork:return Ka(t[1]).concat(Ka(t[2]));default:return[t]}}function Ha(t,e){switch(e[0]){case ka.Labeled:return function(t,e){const r=new Uint8Array(t),n=new Uint8Array(e);for(let t=0;t<r.length;t++)if(r[t]>n[t])return!0;return!1}(t,e[1])?{status:za.Greater}:qe(t,e[1])?{status:Va.Found,value:e[2]}:{status:za.Less};case ka.Fork:const r=Ha(t,e[1]);switch(r.status){case za.Greater:{const r=Ha(t,e[2]);return r.status===za.Less?{status:Va.Absent}:r}case Va.Unknown:{let r=Ha(t,e[2]);return r.status===za.Less?{status:Va.Unknown}:r}default:return r}case ka.Pruned:return{status:Va.Unknown};default:return{status:Va.Absent}}}function Za(t){const{canisterId:e,subnetId:r,tree:n}=t,i=Ga(["subnet",r.toUint8Array(),"canister_ranges"],n);if(i.status!==Va.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${r}`);return fo(i.value).map((t=>[De.fromUint8Array(t[0]),De.fromUint8Array(t[1])])).some((t=>t[0].ltEq(e)&&t[1].gtEq(e)))}!function(t){t.Unknown="unknown",t.Absent="absent",t.Found="found"}(Va||(Va={})),function(t){t.Less="less",t.Greater="greater"}(za||(za={}));const Wa=async t=>{const{agent:e,paths:r}=t,n=De.from(t.canisterId),i=[...new Set(r)],o=i.map((t=>Xa(t,n))),s=new Map,a=i.map(((t,r)=>(async()=>{var a;try{const t=await e.readState(n,{paths:[o[r]]});if(null==e.rootKey)throw new Error("Agent is missing root key");const a=await La.create({certificate:t.certificate,rootKey:e.rootKey,canisterId:n,disableTimeVerification:!0}),c=(r,i)=>{if("subnet"===i){if(null==e.rootKey)throw new Error("Agent is missing root key");return{path:i,data:Ya(t.certificate,n,e.rootKey)}}return{path:i,data:$a(r.lookup(Xa(i,n)))}},{path:u,data:l}=c(a,i[r]);if(l)switch(u){case"time":s.set(u,Ra(l));break;case"controllers":s.set(u,ec(l));break;case"module_hash":s.set(u,Ja(l));break;case"subnet":s.set(u,l);break;case"candid":s.set(u,(new TextDecoder).decode(l));break;default:if("string"!=typeof u&&"key"in u&&"path"in u)switch(u.decodeStrategy){case"raw":s.set(u.key,l);break;case"leb128":s.set(u.key,Oa(l));break;case"cbor":s.set(u.key,Qa(l));break;case"hex":s.set(u.key,Ja(l));break;case"utf-8":s.set(u.key,tc(l))}}else console.warn(`Expected to find result for path ${u}, but instead found nothing.`),"string"==typeof u?s.set(u,null):s.set(u.key,null)}catch(e){if(null===(a=null==e?void 0:e.message)||void 0===a?void 0:a.includes("Invalid certificate"))throw new Ge(e.message);"string"!=typeof t&&"key"in t&&"path"in t?s.set(t.key,null):s.set(t,null),console.group(),console.warn(`Expected to find result for path ${t}, but instead found nothing.`),console.warn(e),console.groupEnd()}})()));return await Promise.all(a),s},Ya=(t,e,r)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const n=fo(new Uint8Array(t)),i=n.tree;let o,s=n.delegation;s&&s.subnet_id?o=De.fromUint8Array(new Uint8Array(s.subnet_id)):s||void 0===r?(o=De.selfAuthenticating(De.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),s={subnet_id:o.toUint8Array(),certificate:new ArrayBuffer(0)}):(o=De.selfAuthenticating(new Uint8Array(r)),s={subnet_id:o.toUint8Array(),certificate:new ArrayBuffer(0)});if(!Za({canisterId:e,subnetId:o,tree:i}))throw new Error("Canister not in range");const a=Ga(["subnet",s.subnet_id,"node"],i);if(a.status!==Va.Found)throw new Error("Node not found");if(a.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const c=Ka(a.value),u=new Map;return c.forEach((t=>{const e=De.from(new Uint8Array(t[1])).toText(),r=Ga(["public_key"],t[2]);if(r.status!==Va.Found)throw new Error("Public key not found");const n=r.value;if(44!==n.byteLength)throw new Error("Invalid public key length");u.set(e,n)})),{subnetId:De.fromUint8Array(new Uint8Array(s.subnet_id)).toText(),nodeKeys:u}},Xa=(t,e)=>{const r=new TextEncoder,n=t=>new DataView(r.encode(t).buffer).buffer,i=new DataView(e.toUint8Array().buffer).buffer;switch(t){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in t&&"path"in t){if("string"==typeof t.path||t.path instanceof ArrayBuffer){const e=t.path,r="string"==typeof e?n(e):e;return[n("canister"),i,n("metadata"),r]}return t.path}}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${t} was formatted correctly.`)},Ja=t=>Fe(t),Qa=t=>fo(t),tc=t=>(new TextDecoder).decode(t),ec=t=>Qa(t).map((t=>De.fromUint8Array(new Uint8Array(t))));var rc=Object.freeze({__proto__:null,CustomPath:class{constructor(t,e,r){this.key=t,this.path=e,this.decodeStrategy=r}},encodePath:Xa,fetchNodeKeys:Ya,request:Wa});const nc=BigInt(0),ic=BigInt(1),oc=BigInt(2),sc=BigInt(8),ac={zip215:!0};function cc(t){const e=function(t){const e=js(t);return Yo(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:r,n:n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=e,u=oc<<BigInt(8*a)-ic,l=r.create,f=bs(e.n,e.nBitLength);if(!function(t,n){const i=r.sqr(t),o=r.sqr(n),s=r.add(r.mul(e.a,i),o),a=r.add(r.ONE,r.mul(e.d,r.mul(i,o)));return r.eql(s,a)}(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const d=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:r.sqrt(t*r.inv(e))}}catch(t){return{isValid:!1,value:nc}}}),h=e.adjustScalarBytes||(t=>t),p=e.domain||((t,e,r)=>{if(To("phflag",r),e.length||r)throw new Error("Contexts/pre-hash are not supported");return t});function g(t,e,r=!1){Go("coordinate "+t,e,r?ic:nc,u)}function m(t){if(!(t instanceof w))throw new Error("ExtendedPoint expected")}const y=Jo(((t,e)=>{const{ex:n,ey:i,ez:o}=t,s=t.is0();null==e&&(e=s?sc:r.inv(o));const a=l(n*e),c=l(i*e),u=l(o*e);if(s)return{x:nc,y:ic};if(u!==ic)throw new Error("invZ was invalid");return{x:a,y:c}})),b=Jo((t=>{const{a:r,d:n}=e;if(t.is0())throw new Error("bad point: ZERO");const{ex:i,ey:o,ez:s,et:a}=t,c=l(i*i),u=l(o*o),f=l(s*s),d=l(f*f),h=l(c*r);if(l(f*l(h+u))!==l(d+l(n*l(c*u))))throw new Error("bad point: equation left != right (1)");if(l(i*o)!==l(s*a))throw new Error("bad point: equation left != right (2)");return!0}));class w{constructor(t,e,r,n){g("x",t),g("y",e),g("z",r,!0),g("t",n),this.ex=t,this.ey=e,this.ez=r,this.et=n,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof w)throw new Error("extended point not allowed");const{x:e,y:r}=t||{};return g("x",e),g("y",r),new w(e,r,ic,l(e*r))}static normalizeZ(t){const e=gs(r,t.map((t=>t.ez)));return t.map(((t,r)=>t.toAffine(e[r]))).map(w.fromAffine)}static msm(t,e){return Fs(w,f,t,e)}_setWindowSize(t){E.setWindowSize(this,t)}assertValidity(){b(this)}equals(t){m(t);const{ex:e,ey:r,ez:n}=this,{ex:i,ey:o,ez:s}=t,a=l(e*s),c=l(i*n),u=l(r*s),f=l(o*n);return a===c&&u===f}is0(){return this.equals(w.ZERO)}negate(){return new w(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:t}=e,{ex:r,ey:n,ez:i}=this,o=l(r*r),s=l(n*n),a=l(oc*l(i*i)),c=l(t*o),u=r+n,f=l(l(u*u)-o-s),d=c+s,h=d-a,p=c-s,g=l(f*h),m=l(d*p),y=l(f*p),b=l(h*d);return new w(g,m,b,y)}add(t){m(t);const{a:r,d:n}=e,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:u,ez:f,et:d}=t,h=l(i*c),p=l(o*u),g=l(a*n*d),y=l(s*f),b=l((i+o)*(c+u)-h-p),v=y-g,x=y+g,E=l(p-r*h),_=l(b*v),B=l(x*E),S=l(b*E),I=l(v*x);return new w(_,B,I,S)}subtract(t){return this.add(t.negate())}wNAF(t){return E.wNAFCached(this,t,w.normalizeZ)}multiply(t){const e=t;Go("scalar",e,ic,n);const{p:r,f:i}=this.wNAF(e);return w.normalizeZ([r,i])[0]}multiplyUnsafe(t,e=w.ZERO){const r=t;return Go("scalar",r,nc,n),r===nc?x:this.is0()||r===ic?this:E.wNAFCachedUnsafe(this,r,w.normalizeZ,e)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return E.unsafeLadder(this,n).is0()}toAffine(t){return y(this,t)}clearCofactor(){const{h:t}=e;return t===ic?this:this.multiplyUnsafe(t)}static fromHex(t,n=!1){const{d:i,a:o}=e,s=r.BYTES;t=$o("pointHex",t,s),To("zip215",n);const a=t.slice(),c=t[s-1];a[s-1]=-129&c;const f=Lo(a),h=n?u:r.ORDER;Go("pointHex.y",f,nc,h);const p=l(f*f),g=l(p-ic),m=l(i*p-o);let{isValid:y,value:b}=d(g,m);if(!y)throw new Error("Point.fromHex: invalid y coordinate");const v=(b&ic)===ic,x=0!=(128&c);if(!n&&b===nc&&x)throw new Error("Point.fromHex: x=0 and x_0=1");return x!==v&&(b=l(-b)),w.fromAffine({x:b,y:f})}static fromPrivateKey(t){const{scalar:e}=S(t);return v.multiply(e)}toRawBytes(){const{x:t,y:e}=this.toAffine(),n=jo(e,r.BYTES);return n[n.length-1]|=t&ic?128:0,n}toHex(){return Uo(this.toRawBytes())}}w.BASE=new w(e.Gx,e.Gy,ic,l(e.Gx*e.Gy)),w.ZERO=new w(nc,ic,ic,nc);const{BASE:v,ZERO:x}=w,E=Ls(w,8*a);function _(t){return ss(t,n)}function B(t){return _(Lo(t))}function S(t){const e=r.BYTES;t=$o("private key",t,e);const n=$o("hashed private key",o(t),2*e),i=h(n.slice(0,e));return{head:i,prefix:n.slice(e,2*e),scalar:B(i)}}function I(t){const{head:e,prefix:r,scalar:n}=S(t),i=v.multiply(n),o=i.toRawBytes();return{head:e,prefix:r,scalar:n,point:i,pointBytes:o}}function A(t=Uint8Array.of(),...e){const r=Mo(...e);return B(o(p(r,$o("context",t),!!i)))}const T=ac;v._setWindowSize(8);return{CURVE:e,getPublicKey:function(t){return I(t).pointBytes},sign:function(t,e,o={}){t=$o("message",t),i&&(t=i(t));const{prefix:s,scalar:a,pointBytes:c}=I(e),u=A(o.context,s,t),l=v.multiply(u).toRawBytes(),f=_(u+A(o.context,l,c,t)*a);return Go("signature.s",f,nc,n),$o("result",Mo(l,jo(f,r.BYTES)),2*r.BYTES)},verify:function(t,e,n,o=T){const{context:s,zip215:a}=o,c=r.BYTES;t=$o("signature",t,2*c),e=$o("message",e),n=$o("publicKey",n,c),void 0!==a&&To("zip215",a),i&&(e=i(e));const u=Lo(t.slice(c,2*c));let l,f,d;try{l=w.fromHex(n,a),f=w.fromHex(t.slice(0,c),a),d=v.multiplyUnsafe(u)}catch(t){return!1}if(!a&&l.isSmallOrder())return!1;const h=A(s,f.toRawBytes(),l.toRawBytes(),e);return f.add(l.multiplyUnsafe(h)).subtract(d).clearCofactor().equals(w.ZERO)},ExtendedPoint:w,utils:{getExtendedPublicKey:I,randomPrivateKey:()=>s(r.BYTES),precompute:(t=8,e=w.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}const uc=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),lc=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const fc=BigInt(1),dc=BigInt(2);BigInt(3);const hc=BigInt(5),pc=BigInt(8);function gc(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function mc(t,e){const r=uc,n=ss(e*e*e,r),i=function(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),o=uc,s=t*t%o*t%o,a=as(s,dc,o)*s%o,c=as(a,fc,o)*t%o,u=as(c,hc,o)*c%o,l=as(u,e,o)*u%o,f=as(l,r,o)*l%o,d=as(f,n,o)*f%o,h=as(d,i,o)*d%o,p=as(h,i,o)*d%o,g=as(p,e,o)*u%o;return{pow_p_5_8:as(g,dc,o)*t%o,b2:s}}(t*ss(n*n*e,r)).pow_p_5_8;let o=ss(t*n*i,r);const s=ss(e*o*o,r),a=o,c=ss(o*lc,r),u=s===t,l=s===ss(-t,r),f=s===ss(-t*lc,r);return u&&(o=a),(l||f)&&(o=c),(ss(o,r)&ts)===ts&&(o=ss(-o,r)),{isValid:u||l,value:o}}const yc=(()=>bs(uc,void 0,!0))(),bc=(()=>({a:yc.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:yc,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:pc,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Ue,randomBytes:Xt,adjustScalarBytes:gc,uvRatio:mc}))(),wc=(()=>cc(bc))();var vc,xc,Ec,_c,Bc=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},Sc=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class Ic{constructor(t={}){vc.set(this,void 0),xc.set(this,void 0),this[Ec]=this.entries.bind(this),this[_c]="ExpirableMap";const{source:e=[],expirationTime:r=6e5}=t,n=Date.now();Bc(this,vc,new Map([...e].map((([t,e])=>[t,{value:e,timestamp:n}]))),"f"),Bc(this,xc,r,"f")}prune(){const t=Date.now();for(const[e,r]of Sc(this,vc,"f").entries())t-r.timestamp>Sc(this,xc,"f")&&Sc(this,vc,"f").delete(e);return this}set(t,e){this.prune();const r={value:e,timestamp:Date.now()};return Sc(this,vc,"f").set(t,r),this}get(t){const e=Sc(this,vc,"f").get(t);if(void 0!==e){if(!(Date.now()-e.timestamp>Sc(this,xc,"f")))return e.value;Sc(this,vc,"f").delete(t)}}clear(){Sc(this,vc,"f").clear()}entries(){const t=Sc(this,vc,"f").entries();return function*(){for(const[e,r]of t)yield[e,r.value]}()}values(){const t=Sc(this,vc,"f").values();return function*(){for(const e of t)yield e.value}()}keys(){return Sc(this,vc,"f").keys()}forEach(t,e){for(const[r,n]of Sc(this,vc,"f").entries())t.call(e,n.value,r,this)}has(t){return Sc(this,vc,"f").has(t)}delete(t){return Sc(this,vc,"f").delete(t)}get size(){return Sc(this,vc,"f").size}}vc=new WeakMap,xc=new WeakMap,Ec=Symbol.iterator,_c=Symbol.toStringTag;const Ac=t=>{if(t<=127)return 1;if(t<=255)return 2;if(t<=65535)return 3;if(t<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},Tc=(t,e,r)=>{if(r<=127)return t[e]=r,1;if(r<=255)return t[e]=129,t[e+1]=r,2;if(r<=65535)return t[e]=130,t[e+1]=r>>8,t[e+2]=r,3;if(r<=16777215)return t[e]=131,t[e+1]=r>>16,t[e+2]=r>>8,t[e+3]=r,4;throw new Error("Length too long (> 4 bytes)")},Nc=(t,e)=>{if(t[e]<128)return 1;if(128===t[e])throw new Error("Invalid length 0");if(129===t[e])return 2;if(130===t[e])return 3;if(131===t[e])return 4;throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const Oc=Uint8Array.from([48,5,6,3,43,101,112]);function Rc(t,e){const r=2+Ac(t.byteLength+1),n=e.byteLength+r+t.byteLength;let i=0;const o=new Uint8Array(1+Ac(n)+n);return o[i++]=48,i+=Tc(o,i,n),o.set(e,i),i+=e.byteLength,o[i++]=3,i+=Tc(o,i,t.byteLength+1),o[i++]=0,o.set(new Uint8Array(t),i),o}Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);const Uc=(t,e)=>{let r=0;const n=(t,e)=>{if(i[r++]!==t)throw new Error("Expected: "+e)},i=new Uint8Array(t);if(n(48,"sequence"),r+=Nc(i,r),!qe(i.slice(r,r+e.byteLength),e))throw new Error("Not the expected OID.");r+=e.byteLength,n(3,"bit string");const o=((t,e)=>{const r=Nc(t,e);if(1===r)return t[e];if(2===r)return t[e+1];if(3===r)return(t[e+1]<<8)+t[e+2];if(4===r)return(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];throw new Error("Length too long (> 4 bytes)")})(i,r)-1;r+=Nc(i,r),n(0,"0 padding");const s=i.slice(r);if(o!==s.length)throw new Error(`DER payload mismatch: Expected length ${o} actual length ${s.length}`);return s};var kc,Pc,Cc=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},Dc=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};let Lc=class t{constructor(e){if(kc.set(this,void 0),Pc.set(this,void 0),e.byteLength!==t.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Cc(this,kc,e,"f"),Cc(this,Pc,t.derEncode(e),"f")}static from(t){return this.fromDer(t.toDer())}static fromRaw(e){return new t(e)}static fromDer(e){return new t(this.derDecode(e))}static derEncode(t){return Rc(t,Oc).buffer}static derDecode(t){const e=Uc(t,Oc);if(e.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return e}get rawKey(){return Dc(this,kc,"f")}get derKey(){return Dc(this,Pc,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};kc=new WeakMap,Pc=new WeakMap,Lc.RAW_KEY_LENGTH=32;class Fc{constructor(){this.observers=[]}subscribe(t){this.observers.push(t)}unsubscribe(t){this.observers=this.observers.filter((e=>e!==t))}notify(t,...e){this.observers.forEach((r=>r(t,...e)))}}class jc extends Fc{constructor(){super()}print(t,...e){this.notify({message:t,level:"info"},...e)}warn(t,...e){this.notify({message:t,level:"warn"},...e)}error(t,e,...r){this.notify({message:t,level:"error",error:e},...r)}}var $c,Mc,qc,Vc,zc,Gc,Kc,Hc,Zc,Wc=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},Yc=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};const Xc=.5,Jc=1.5,Qc=500,tu=6e4,eu=9e5,ru=10;class nu{constructor(t=nu.default){$c.set(this,void 0),Mc.set(this,void 0),qc.set(this,void 0),Vc.set(this,void 0),zc.set(this,void 0),Gc.set(this,void 0),Kc.set(this,void 0),Hc.set(this,void 0),Zc.set(this,0);const{initialInterval:e=Qc,randomizationFactor:r=Xc,multiplier:n=Jc,maxInterval:i=tu,maxElapsedTime:o=eu,maxIterations:s=ru,date:a=Date}=t;Wc(this,$c,e,"f"),Wc(this,Mc,r,"f"),Wc(this,qc,n,"f"),Wc(this,Vc,i,"f"),Wc(this,Hc,a,"f"),Wc(this,zc,a.now(),"f"),Wc(this,Gc,o,"f"),Wc(this,Kc,s,"f")}get ellapsedTimeInMsec(){return Yc(this,Hc,"f").now()-Yc(this,zc,"f")}get currentInterval(){return Yc(this,$c,"f")}get count(){return Yc(this,Zc,"f")}get randomValueFromInterval(){const t=Yc(this,Mc,"f")*Yc(this,$c,"f"),e=Yc(this,$c,"f")-t,r=Yc(this,$c,"f")+t;return Math.random()*(r-e)+e}incrementCurrentInterval(){var t;return Wc(this,$c,Math.min(Yc(this,$c,"f")*Yc(this,qc,"f"),Yc(this,Vc,"f")),"f"),Wc(this,Zc,(t=Yc(this,Zc,"f"),++t),"f"),Yc(this,$c,"f")}next(){return this.ellapsedTimeInMsec>=Yc(this,Gc,"f")||Yc(this,Zc,"f")>=Yc(this,Kc,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}$c=new WeakMap,Mc=new WeakMap,qc=new WeakMap,Vc=new WeakMap,zc=new WeakMap,Gc=new WeakMap,Kc=new WeakMap,Hc=new WeakMap,Zc=new WeakMap,nu.default={initialInterval:Qc,randomizationFactor:Xc,multiplier:Jc,maxInterval:tu,maxElapsedTime:eu,maxIterations:ru,date:Date};var iu,ou,su,au,cu,uu,lu,fu,du,hu,pu,gu,mu,yu,bu,wu,vu,xu,Eu,_u,Bu,Su,Iu=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},Au=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};!function(t){t.Received="received",t.Processing="processing",t.Replied="replied",t.Rejected="rejected",t.Unknown="unknown",t.Done="done"}(Su||(Su={}));const Tu=6e4,Nu="aaaaa-aa";class Ou extends Ge{constructor(t){super(t),this.message=t}}class Ru extends Ge{constructor(t){super(t),this.message=t}}class Uu{constructor(t={}){var e,r;iu.add(this),ou.set(this,null),su.set(this,!1),au.set(this,void 0),cu.set(this,void 0),uu.set(this,void 0),lu.set(this,void 0),fu.set(this,0),du.set(this,void 0),hu.set(this,void 0),pu.set(this,void 0),gu.set(this,void 0),this._isAgent=!0,this.config={},mu.set(this,0),this.log=new jc,yu.set(this,[]),bu.set(this,[]),wu.set(this,new Ic({expirationTime:3e5})),vu.set(this,!0),_u.set(this,((t,e)=>{if(!1===Au(this,vu,"f"))return t;if(!e)throw new Da("Invalid signature from replica signed query: no matching node key found.");const{status:r,signatures:n=[],requestId:i}=t,o=ze((new TextEncoder).encode("\vic-response"));for(const s of n){const{timestamp:n,identity:a}=s,c=De.fromUint8Array(a).toText();let u;if("replied"===r){const{reply:e}=t;u=Ti({status:r,reply:e,timestamp:BigInt(n),request_id:i})}else{if("rejected"!==r)throw new Error(`Unknown status: ${r}`);{const{reject_code:e,reject_message:o,error_code:s}=t;u=Ti({status:r,reject_code:e,reject_message:o,error_code:s,timestamp:BigInt(n),request_id:i})}}const l=Le(o,ze(new Uint8Array(u))),f=null==e?void 0:e.nodeKeys.get(c);if(!f)throw new Da("Invalid signature from replica signed query: no matching node key found.");const d=Lc.fromDer(f).rawKey;if(wc.verify(s.signature,new Uint8Array(l),new Uint8Array(d)))return t;throw new Da(`Invalid signature from replica ${c} signed query.`)}return t})),this.config=t,Iu(this,cu,t.fetch||function(){let t;if("undefined"!=typeof window){if(!window.fetch)throw new Ou("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");t=window.fetch.bind(window)}else if("undefined"!=typeof global){if(!global.fetch)throw new Ou("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");t=global.fetch.bind(global)}else"undefined"!=typeof self&&self.fetch&&(t=self.fetch.bind(self));if(t)return t;throw new Ou("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}()||fetch.bind(global),"f"),Iu(this,uu,t.fetchOptions,"f"),Iu(this,lu,t.callOptions,"f"),Iu(this,su,null!==(e=t.shouldFetchRootKey)&&void 0!==e&&e,"f"),t.rootKey?this.rootKey=t.rootKey:Au(this,su,"f")?this.rootKey=null:this.rootKey=$e("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae");const n=function(t){let e;if(void 0!==t)e=t.match(/^[a-z]+:/)||"undefined"==typeof window?new URL(t):new URL(window.location.protocol+"//"+t);else{const t=["ic0.app","icp0.io","127.0.0.1","localhost"],r=[".github.dev",".gitpod.io"],n="undefined"!=typeof window?window.location:void 0,i=null==n?void 0:n.hostname;let o;i&&"string"==typeof i&&(o=r.some((t=>i.endsWith(t)))?i:t.find((t=>i.endsWith(t)))),e=n&&o?new URL(`${n.protocol}//${o}${n.port?":"+n.port:""}`):new URL("https://icp-api.io")}return e.toString()}(t.host);this.host=new URL(n),void 0!==t.verifyQuerySignatures&&Iu(this,vu,t.verifyQuerySignatures,"f"),Iu(this,hu,null!==(r=t.retryTimes)&&void 0!==r?r:3,"f");if(Iu(this,pu,t.backoffStrategy||(()=>new nu({maxIterations:Au(this,hu,"f")})),"f"),this.host.hostname.endsWith(".ic0.app")?this.host.hostname="ic0.app":this.host.hostname.endsWith(".icp0.io")?this.host.hostname="icp0.io":this.host.hostname.endsWith(".icp-api.io")&&(this.host.hostname="icp-api.io"),t.credentials){const{name:e,password:r}=t.credentials;Iu(this,du,`${e}${r?":"+r:""}`,"f")}if(Iu(this,au,Promise.resolve(t.identity||new Ui),"f"),t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes>5)throw new Ge(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);if(t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes<=0)throw new Ge(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);Iu(this,gu,t.ingressExpiryInMinutes||5,"f"),this.addTransform("update",bo(go)),t.useQueryNonces&&this.addTransform("query",bo(go)),t.logToConsole&&this.log.subscribe((t=>{"error"===t.level?console.error(t.message):"warn"===t.level?console.warn(t.message):console.log(t.message)}))}get waterMark(){return Au(this,mu,"f")}static createSync(t={}){return new this(Object.assign({},t))}static async create(t={shouldFetchRootKey:!1}){const e=Uu.createSync(t),r=[e.syncTime()];return"https://icp-api.io"!==e.host.toString()&&t.shouldFetchRootKey&&r.push(e.fetchRootKey()),await Promise.all(r),e}static async from(t){var e;try{return"config"in t?await Uu.create(t.config):await Uu.create({fetch:t._fetch,fetchOptions:t._fetchOptions,callOptions:t._callOptions,host:t._host.toString(),identity:null!==(e=t._identity)&&void 0!==e?e:void 0})}catch(t){throw new Ge("Failed to create agent from provided agent")}}isLocal(){const t=this.host.hostname;return"127.0.0.1"===t||t.endsWith("127.0.0.1")}addTransform(t,e,r=e.priority||0){if("update"===t){const t=Au(this,bu,"f").findIndex((t=>(t.priority||0)<r));Au(this,bu,"f").splice(t>=0?t:Au(this,bu,"f").length,0,Object.assign(e,{priority:r}))}else if("query"===t){const t=Au(this,yu,"f").findIndex((t=>(t.priority||0)<r));Au(this,yu,"f").splice(t>=0?t:Au(this,yu,"f").length,0,Object.assign(e,{priority:r}))}}async getPrincipal(){if(!Au(this,au,"f"))throw new Ru("This identity has expired due this application's security policy. Please refresh your authentication.");return(await Au(this,au,"f")).getPrincipal()}async call(t,e,r){var n,i;await Au(this,iu,"m",Bu).call(this);const o=null===(n=e.callSync)||void 0===n||n,s=await(void 0!==r?await r:await Au(this,au,"f"));if(!s)throw new Ru("This identity has expired due this application's security policy. Please refresh your authentication.");const a=De.from(t),c=e.effectiveCanisterId?De.from(e.effectiveCanisterId):a,u=s.getPrincipal()||De.anonymous();let l=new yo(Au(this,gu,"f")*Tu);Math.abs(Au(this,fu,"f"))>3e4&&(l=new yo(Au(this,gu,"f")*Tu+Au(this,fu,"f")));const f={request_type:po.Call,canister_id:a,method_name:e.methodName,arg:e.arg,sender:u,ingress_expiry:l};let d,h=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},Au(this,du,"f")?{Authorization:"Basic "+btoa(Au(this,du,"f"))}:{})},endpoint:"call",body:f});function p(t){return new Uint8Array(t)}d=(null==e?void 0:e.nonce)?p(e.nonce):h.body.nonce?p(h.body.nonce):void 0,f.nonce=d,h=await s.transformRequest(h);const g=co(h.body),m=Au(this,pu,"f").call(this),y=Ai(f);try{const t=()=>(this.log.print(`fetching "/api/v3/canister/${c.toText()}/call" with request:`,h),Au(this,cu,"f").call(this,""+new URL(`/api/v3/canister/${c.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},Au(this,lu,"f")),h.request),{body:g}))),e=()=>(this.log.print(`fetching "/api/v2/canister/${c.toText()}/call" with request:`,h),Au(this,cu,"f").call(this,""+new URL(`/api/v2/canister/${c.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},Au(this,lu,"f")),h.request),{body:g}))),r=Au(this,iu,"m",Eu).call(this,{request:o?t:e,backoff:m,tries:0}),n=await r,i=await n.arrayBuffer(),s=200===n.status&&i.byteLength>0?fo(i):null;if(s&&"certificate"in s){const t=await this.parseTimeFromResponse({certificate:s.certificate});Iu(this,mu,t,"f")}return{requestId:y,response:{ok:n.ok,status:n.status,statusText:n.statusText,body:s,headers:wo(n.headers)},requestDetails:f}}catch(n){if(n.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(t,Object.assign(Object.assign({},e),{callSync:!1}),r);const o=`Error while making call: ${null!==(i=n.message)&&void 0!==i?i:String(n)}`,s=new xo(o,n,Fe(y),Fe(h.body.sender_pubkey),Fe(h.body.sender_sig),String(h.body.content.ingress_expiry._value));throw this.log.error(o,s),s}}async query(t,e,r){var n,i,o,s;await Au(this,iu,"m",Bu).call(this);const a=Au(this,pu,"f").call(this),c=e.effectiveCanisterId?De.from(e.effectiveCanisterId):De.from(t);let u,l;this.log.print(`ecid ${c.toString()}`),this.log.print(`canisterId ${t.toString()}`);const f=await(void 0!==r?r:Au(this,au,"f"));if(!f)throw new Ru("This identity has expired due this application's security policy. Please refresh your authentication.");const d=De.from(t),h=(null==f?void 0:f.getPrincipal())||De.anonymous(),p={request_type:"query",canister_id:d,method_name:e.methodName,arg:e.arg,sender:h,ingress_expiry:new yo(Au(this,gu,"f")*Tu)},g=Ai(p);u=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},Au(this,du,"f")?{Authorization:"Basic "+btoa(Au(this,du,"f"))}:{})},endpoint:"read",body:p}),u=await(null==f?void 0:f.transformRequest(u));const m=co(u.body),y={canister:d.toText(),ecid:c,transformedRequest:u,body:m,requestId:g,backoff:a,tries:0},b=async()=>({requestDetails:p,query:await Au(this,iu,"m",xu).call(this,y)}),w=async()=>{if(!Au(this,vu,"f"))return;const t=Au(this,wu,"f").get(c.toString());return t||(await this.fetchSubnetKeys(c.toString()),Au(this,wu,"f").get(c.toString()))};try{const[e,r]=await Promise.all([b(),w()]);l=e;const{requestDetails:n,query:i}=l,o=Object.assign(Object.assign({},i),{requestDetails:n});if(this.log.print("Query response:",o),!Au(this,vu,"f"))return o;try{return Au(this,_u,"f").call(this,o,r)}catch(e){this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),Au(this,wu,"f").delete(t.toString()),await this.fetchSubnetKeys(c.toString());const r=Au(this,wu,"f").get(t.toString());if(!r)throw new Da("Invalid signature from replica signed query: no matching node key found.");return Au(this,_u,"f").call(this,o,r)}}catch(t){const e=`Error while making call: ${null!==(n=t.message)&&void 0!==n?n:String(t)}`,r=new Eo(e,t,String(g),Fe(null===(i=null==u?void 0:u.body)||void 0===i?void 0:i.sender_pubkey),Fe(null===(o=null==u?void 0:u.body)||void 0===o?void 0:o.sender_sig),String(null===(s=null==u?void 0:u.body)||void 0===s?void 0:s.content.ingress_expiry._value));throw this.log.error(e,r),r}}async createReadStateRequest(t,e){await Au(this,iu,"m",Bu).call(this);const r=await(void 0!==e?await e:await Au(this,au,"f"));if(!r)throw new Ru("This identity has expired due this application's security policy. Please refresh your authentication.");const n=(null==r?void 0:r.getPrincipal())||De.anonymous(),i=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},Au(this,du,"f")?{Authorization:"Basic "+btoa(Au(this,du,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:t.paths,sender:n,ingress_expiry:new yo(Au(this,gu,"f")*Tu)}});return null==r?void 0:r.transformRequest(i)}async readState(t,e,r,n){var i,o,s,a;const c=function(t){for(const e of t.paths){const[t,r]=e;if(qe(t,ze((new TextEncoder).encode("request_status"))))return r}}(e);await Au(this,iu,"m",Bu).call(this);const u="string"==typeof t?De.fromText(t):t,l=null!=n?n:await this.createReadStateRequest(e,r),f=co(l.body);this.log.print(`fetching "/api/v2/canister/${u}/read_state" with request:`,l);const d=Au(this,pu,"f").call(this);try{const t=await Au(this,iu,"m",Eu).call(this,{request:()=>Au(this,cu,"f").call(this,""+new URL(`/api/v2/canister/${u.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},Au(this,uu,"f")),l.request),{body:f})),backoff:d,tries:0});if(!t.ok)throw new Error(`Server returned an error:\n  Code: ${t.status} (${t.statusText})\n  Body: ${await t.text()}\n`);const e=fo(await t.arrayBuffer());this.log.print("Read state response:",e);const r=await this.parseTimeFromResponse(e);return r>0&&(this.log.print("Read state response time:",r),Iu(this,mu,r,"f")),e}catch(t){const e=`Caught exception while attempting to read state: ${null!==(i=t.message)&&void 0!==i?i:String(t)}`,r=new _o(e,t,String(c),Fe(null===(o=null==l?void 0:l.body)||void 0===o?void 0:o.sender_pubkey),Fe(null===(s=null==l?void 0:l.body)||void 0===s?void 0:s.sender_sig),String(null===(a=null==l?void 0:l.body)||void 0===a?void 0:a.content.ingress_expiry._value));throw this.log.error(e,r),r}}async parseTimeFromResponse(t){let e;if(t.certificate){const r=fo(t.certificate);if(!r||!("tree"in r))throw new Error("Could not decode time from response");e=r.tree;const n=Ga(["time"],e);if(n.status!==Va.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(n.value instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Time was not found in the response or was not in its expected format.");const i=Ra(ze(n.value));return this.log.print("Time from response:",i),this.log.print("Time from response in milliseconds:",Number(i)),Number(i)}return this.log.warn("No certificate found in response"),0}async syncTime(t){await Au(this,iu,"m",Bu).call(this);const e=await Promise.resolve().then((function(){return rc})),r=Date.now();try{t||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const n=Uu.createSync({identity:new Ui,host:this.host.toString(),fetch:Au(this,cu,"f"),retryTimes:0}),i=(await e.request({canisterId:null!=t?t:De.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:n,paths:["time"]})).get("time");i&&(Iu(this,fu,Number(i)-Number(r),"f"),this.log.notify({message:`Syncing time: offset of ${Au(this,fu,"f")}`,level:"info"}))}catch(t){this.log.error("Caught exception while attempting to sync time",t)}}async status(){const t=Au(this,du,"f")?{Authorization:"Basic "+btoa(Au(this,du,"f"))}:{};this.log.print('fetching "/api/v2/status"');const e=Au(this,pu,"f").call(this),r=await Au(this,iu,"m",Eu).call(this,{backoff:e,request:()=>Au(this,cu,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:t},Au(this,uu,"f"))),tries:0});return fo(await r.arrayBuffer())}async fetchRootKey(){let t;return Au(this,ou,"f")||Iu(this,ou,new Promise(((t,e)=>{this.status().then((e=>{const r=e.root_key;this.rootKey=r,t(r)})).catch(e)})),"f"),t=await Au(this,ou,"f"),Iu(this,ou,null,"f"),t}invalidateIdentity(){Iu(this,au,null,"f")}replaceIdentity(t){Iu(this,au,Promise.resolve(t),"f")}async fetchSubnetKeys(t){await Au(this,iu,"m",Bu).call(this);const e=De.from(t),r=(await Wa({canisterId:e,paths:["subnet"],agent:this})).get("subnet");if(r&&"object"==typeof r&&"nodeKeys"in r)return Au(this,wu,"f").set(e.toText(),r),r}_transform(t){let e=Promise.resolve(t);if("call"===t.endpoint)for(const t of Au(this,bu,"f"))e=e.then((e=>t(e).then((t=>t||e))));else for(const t of Au(this,yu,"f"))e=e.then((e=>t(e).then((t=>t||e))));return e}}var ku;function Pu(){const t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!t)throw new Error("No Agent could be found.");return t}ou=new WeakMap,su=new WeakMap,au=new WeakMap,cu=new WeakMap,uu=new WeakMap,lu=new WeakMap,fu=new WeakMap,du=new WeakMap,hu=new WeakMap,pu=new WeakMap,gu=new WeakMap,mu=new WeakMap,yu=new WeakMap,bu=new WeakMap,wu=new WeakMap,vu=new WeakMap,_u=new WeakMap,iu=new WeakSet,xu=async function t(e){var r,n;const{ecid:i,transformedRequest:o,body:s,requestId:a,backoff:c,tries:u}=e,l=0===u?0:c.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:u,backoff:c,delay:l}),null===l)throw new Ge(`Timestamp failed to pass the watermark after retrying the configured ${Au(this,hu,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);let f;l>0&&await new Promise((t=>setTimeout(t,l)));try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,o);const t=await Au(this,cu,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},Au(this,uu,"f")),o.request),{body:s}));if(200!==t.status)throw new vo(`Gateway returned an error:\n  Code: ${t.status} (${t.statusText})\n  Body: ${await t.text()}\n`,{ok:t.ok,status:t.status,statusText:t.statusText,headers:wo(t.headers)});{const e=fo(await t.arrayBuffer());f=Object.assign(Object.assign({},e),{httpDetails:{ok:t.ok,status:t.status,statusText:t.statusText,headers:wo(t.headers)},requestId:a})}}catch(r){if(u<Au(this,hu,"f"))return this.log.warn(`Caught exception while attempting to make query:\n  ${r}\n  Retrying query.`),await Au(this,iu,"m",t).call(this,Object.assign(Object.assign({},e),{tries:u+1}));throw r}const d=null===(n=null===(r=f.signatures)||void 0===r?void 0:r[0])||void 0===n?void 0:n.timestamp;if(!Au(this,vu,"f"))return f;if(!d)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const h=Number(BigInt(d)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:h}),Number(this.waterMark)>h){const r=new Ge("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",r,{timestamp:d,waterMark:this.waterMark}),u<Au(this,hu,"f"))return await Au(this,iu,"m",t).call(this,Object.assign(Object.assign({},e),{tries:u+1}));throw new Ge(`Timestamp failed to pass the watermark after retrying the configured ${Au(this,hu,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return f},Eu=async function t(e){const{request:r,backoff:n,tries:i}=e,o=0===i?0:n.next();if(null===o)throw new Ge(`Timestamp failed to pass the watermark after retrying the configured ${Au(this,hu,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);let s;o>0&&await new Promise((t=>setTimeout(t,o)));try{s=await r()}catch(e){if(Au(this,hu,"f")>i)return this.log.warn(`Caught exception while attempting to make request:\n  ${e}\n  Retrying request.`),await Au(this,iu,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw e}if(s.ok)return s;const a=await s.clone().text(),c=`Server returned an error:\n  Code: ${s.status} (${s.statusText})\n  Body: ${a}\n`;if(404===s.status&&s.url.includes("api/v3"))throw new vo("v3 api not supported. Fall back to v2",{ok:s.ok,status:s.status,statusText:s.statusText,headers:wo(s.headers)});if(i<Au(this,hu,"f"))return await Au(this,iu,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw new vo(c,{ok:s.ok,status:s.status,statusText:s.statusText,headers:wo(s.headers)})},Bu=async function(){if(!this.rootKey){if(null!==this.rootKey||!Au(this,su,"f"))throw new Ge(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${Au(this,su,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`);await this.fetchRootKey()}},function(t){t.Error="err",t.GetPrincipal="gp",t.GetPrincipalResponse="gpr",t.Query="q",t.QueryResponse="qr",t.Call="c",t.CallResponse="cr",t.ReadState="rs",t.ReadStateResponse="rsr",t.Status="s",t.StatusResponse="sr"}(ku||(ku={}));const Cu=3e5;function Du(){return function(...t){return async(e,r,n)=>{for(const i of t)await i(e,r,n)}}((t=function(){let t=!0;return async()=>!!t&&(t=!1,!0)}(),e=1e3,async(r,n,i)=>{if(await t(r,n,i))return new Promise((t=>setTimeout(t,e)))}),function(t,e){let r=t;return()=>new Promise((t=>setTimeout((()=>{r*=e,t()}),r)))}(1e3,1.2),function(t){const e=Date.now()+t;return async(r,n,i)=>{if(Date.now()>e)throw new Error(`Request timed out after ${t} msec:\n  Request ID: ${Fe(n)}\n  Request status: ${i}\n`)}}(Cu));var t,e}async function Lu(t,e,r,n=Du(),i,o){var s;const a=[(new TextEncoder).encode("request_status"),r],c=null!=i?i:await(null===(s=t.createReadStateRequest)||void 0===s?void 0:s.call(t,{paths:[a]})),u=await t.readState(e,{paths:[a]},void 0,c);if(null==t.rootKey)throw new Error("Agent root key not initialized before polling");const l=await La.create({certificate:u.certificate,rootKey:t.rootKey,canisterId:e,blsVerify:o}),f=$a(l.lookup([...a,(new TextEncoder).encode("status")]));let d;switch(d=void 0===f?Su.Unknown:(new TextDecoder).decode(f),d){case Su.Replied:return{reply:$a(l.lookup([...a,"reply"])),certificate:l};case Su.Received:case Su.Unknown:case Su.Processing:return await n(e,r,d),Lu(t,e,r,n,c,o);case Su.Rejected:{const t=new Uint8Array($a(l.lookup([...a,"reject_code"])))[0],e=(new TextDecoder).decode($a(l.lookup([...a,"reject_message"])));throw new Error(`Call was rejected:\n  Request ID: ${Fe(r)}\n  Reject code: ${t}\n  Reject text: ${e}\n`)}case Su.Done:throw new Error(`Call was marked as done but we never saw the reply:\n  Request ID: ${Fe(r)}\n`)}throw new Error("unreachable")}var Fu=({IDL:t})=>{const e=t.Variant({mainnet:t.Null,testnet:t.Null}),r=t.Text,n=t.Record({network:e,address:r,min_confirmations:t.Opt(t.Nat32)}),i=t.Nat64,o=i,s=t.Nat32,a=t.Record({start_height:s,end_height:t.Opt(s),network:e}),c=t.Vec(t.Nat8),u=t.Record({tip_height:s,block_headers:t.Vec(c)}),l=t.Record({network:e}),f=t.Nat64,d=t.Vec(f),h=t.Record({network:e,filter:t.Opt(t.Variant({page:t.Vec(t.Nat8),min_confirmations:t.Nat32})),address:r}),p=t.Vec(t.Nat8),g=t.Record({txid:t.Vec(t.Nat8),vout:t.Nat32}),m=t.Record({height:t.Nat32,value:i,outpoint:g}),y=t.Record({next_page:t.Opt(t.Vec(t.Nat8)),tip_height:s,tip_block_hash:p,utxos:t.Vec(m)}),b=t.Record({transaction:t.Vec(t.Nat8),network:e}),w=t.Principal,v=t.Record({canister_id:w,num_requested_changes:t.Opt(t.Nat64)}),x=t.Variant({from_user:t.Record({user_id:t.Principal}),from_canister:t.Record({canister_version:t.Opt(t.Nat64),canister_id:t.Principal})}),E=t.Vec(t.Nat8),_=t.Variant({creation:t.Record({controllers:t.Vec(t.Principal)}),code_deployment:t.Record({mode:t.Variant({reinstall:t.Null,upgrade:t.Null,install:t.Null}),module_hash:t.Vec(t.Nat8)}),load_snapshot:t.Record({canister_version:t.Nat64,taken_at_timestamp:t.Nat64,snapshot_id:E}),controllers_change:t.Record({controllers:t.Vec(t.Principal)}),code_uninstall:t.Null}),B=t.Record({timestamp_nanos:t.Nat64,canister_version:t.Nat64,origin:x,details:_}),S=t.Record({controllers:t.Vec(t.Principal),module_hash:t.Opt(t.Vec(t.Nat8)),recent_changes:t.Vec(B),total_num_changes:t.Nat64}),I=t.Record({canister_id:w}),A=t.Variant({controllers:t.Null,public:t.Null,allowed_viewers:t.Vec(t.Principal)}),T=t.Record({freezing_threshold:t.Nat,controllers:t.Vec(t.Principal),reserved_cycles_limit:t.Nat,log_visibility:A,wasm_memory_limit:t.Nat,memory_allocation:t.Nat,compute_allocation:t.Nat}),N=t.Record({status:t.Variant({stopped:t.Null,stopping:t.Null,running:t.Null}),memory_size:t.Nat,cycles:t.Nat,settings:T,query_stats:t.Record({response_payload_bytes_total:t.Nat,num_instructions_total:t.Nat,num_calls_total:t.Nat,request_payload_bytes_total:t.Nat}),idle_cycles_burned_per_day:t.Nat,module_hash:t.Opt(t.Vec(t.Nat8)),reserved_cycles:t.Nat}),O=t.Record({canister_id:w}),R=t.Record({freezing_threshold:t.Opt(t.Nat),controllers:t.Opt(t.Vec(t.Principal)),reserved_cycles_limit:t.Opt(t.Nat),log_visibility:t.Opt(A),wasm_memory_limit:t.Opt(t.Nat),memory_allocation:t.Opt(t.Nat),compute_allocation:t.Opt(t.Nat)}),U=t.Record({settings:t.Opt(R),sender_canister_version:t.Opt(t.Nat64)}),k=t.Record({canister_id:w}),P=t.Record({canister_id:w}),C=t.Record({canister_id:w,snapshot_id:E}),D=t.Record({canister_id:w}),L=t.Variant({secp256k1:t.Null}),F=t.Record({key_id:t.Record({name:t.Text,curve:L}),canister_id:t.Opt(w),derivation_path:t.Vec(t.Vec(t.Nat8))}),j=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),$=t.Record({canister_id:w}),M=t.Record({idx:t.Nat64,timestamp_nanos:t.Nat64,content:t.Vec(t.Nat8)}),q=t.Record({canister_log_records:t.Vec(M)}),V=t.Record({value:t.Text,name:t.Text}),z=t.Record({status:t.Nat,body:t.Vec(t.Nat8),headers:t.Vec(V)}),G=t.Record({url:t.Text,method:t.Variant({get:t.Null,head:t.Null,post:t.Null}),max_response_bytes:t.Opt(t.Nat64),body:t.Opt(t.Vec(t.Nat8)),transform:t.Opt(t.Record({function:t.Func([t.Record({context:t.Vec(t.Nat8),response:z})],[z],["query"]),context:t.Vec(t.Nat8)})),headers:t.Vec(V)}),K=t.Variant({reinstall:t.Null,upgrade:t.Opt(t.Record({wasm_memory_persistence:t.Opt(t.Variant({keep:t.Null,replace:t.Null})),skip_pre_upgrade:t.Opt(t.Bool)})),install:t.Null}),H=t.Record({hash:t.Vec(t.Nat8)}),Z=t.Record({arg:t.Vec(t.Nat8),wasm_module_hash:t.Vec(t.Nat8),mode:K,chunk_hashes_list:t.Vec(H),target_canister:w,store_canister:t.Opt(w),sender_canister_version:t.Opt(t.Nat64)}),W=t.Vec(t.Nat8),Y=t.Record({arg:t.Vec(t.Nat8),wasm_module:W,mode:K,canister_id:w,sender_canister_version:t.Opt(t.Nat64)}),X=t.Record({canister_id:w}),J=t.Record({id:E,total_size:t.Nat64,taken_at_timestamp:t.Nat64}),Q=t.Vec(J),tt=t.Record({canister_id:w,sender_canister_version:t.Opt(t.Nat64),snapshot_id:E}),et=t.Record({start_at_timestamp_nanos:t.Nat64,subnet_id:t.Principal}),rt=t.Record({num_block_failures_total:t.Nat64,node_id:t.Principal,num_blocks_proposed_total:t.Nat64}),nt=t.Vec(t.Record({timestamp_nanos:t.Nat64,node_metrics:t.Vec(rt)})),it=t.Record({settings:t.Opt(R),specified_id:t.Opt(w),amount:t.Opt(t.Nat),sender_canister_version:t.Opt(t.Nat64)}),ot=t.Record({canister_id:w}),st=t.Record({canister_id:w,amount:t.Nat}),at=t.Vec(t.Nat8),ct=t.Variant({ed25519:t.Null,bip340secp256k1:t.Null}),ut=t.Record({key_id:t.Record({algorithm:ct,name:t.Text}),canister_id:t.Opt(w),derivation_path:t.Vec(t.Vec(t.Nat8))}),lt=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),ft=t.Record({key_id:t.Record({name:t.Text,curve:L}),derivation_path:t.Vec(t.Vec(t.Nat8)),message_hash:t.Vec(t.Nat8)}),dt=t.Record({signature:t.Vec(t.Nat8)}),ht=t.Variant({bip341:t.Record({merkle_root_hash:t.Vec(t.Nat8)})}),pt=t.Record({aux:t.Opt(ht),key_id:t.Record({algorithm:ct,name:t.Text}),derivation_path:t.Vec(t.Vec(t.Nat8)),message:t.Vec(t.Nat8)}),gt=t.Record({signature:t.Vec(t.Nat8)}),mt=t.Record({canister_id:w}),yt=t.Record({canister_id:w}),bt=t.Record({canister_id:w}),wt=t.Vec(H),vt=t.Record({subnet_id:t.Principal}),xt=t.Record({replica_version:t.Text}),Et=t.Record({replace_snapshot:t.Opt(E),canister_id:w}),_t=J,Bt=t.Record({canister_id:w,sender_canister_version:t.Opt(t.Nat64)}),St=t.Record({canister_id:t.Principal,settings:R,sender_canister_version:t.Opt(t.Nat64)}),It=t.Record({chunk:t.Vec(t.Nat8),canister_id:t.Principal}),At=H;return t.Service({bitcoin_get_balance:t.Func([n],[o],[]),bitcoin_get_block_headers:t.Func([a],[u],[]),bitcoin_get_current_fee_percentiles:t.Func([l],[d],[]),bitcoin_get_utxos:t.Func([h],[y],[]),bitcoin_send_transaction:t.Func([b],[],[]),canister_info:t.Func([v],[S],[]),canister_status:t.Func([I],[N],[]),clear_chunk_store:t.Func([O],[],[]),create_canister:t.Func([U],[k],[]),delete_canister:t.Func([P],[],[]),delete_canister_snapshot:t.Func([C],[],[]),deposit_cycles:t.Func([D],[],[]),ecdsa_public_key:t.Func([F],[j],[]),fetch_canister_logs:t.Func([$],[q],["query"]),http_request:t.Func([G],[z],[]),install_chunked_code:t.Func([Z],[],[]),install_code:t.Func([Y],[],[]),list_canister_snapshots:t.Func([X],[Q],[]),load_canister_snapshot:t.Func([tt],[],[]),node_metrics_history:t.Func([et],[nt],[]),provisional_create_canister_with_cycles:t.Func([it],[ot],[]),provisional_top_up_canister:t.Func([st],[],[]),raw_rand:t.Func([],[at],[]),schnorr_public_key:t.Func([ut],[lt],[]),sign_with_ecdsa:t.Func([ft],[dt],[]),sign_with_schnorr:t.Func([pt],[gt],[]),start_canister:t.Func([mt],[],[]),stop_canister:t.Func([yt],[],[]),stored_chunks:t.Func([bt],[wt],[]),subnet_info:t.Func([vt],[xt],[]),take_canister_snapshot:t.Func([Et],[_t],[]),uninstall_code:t.Func([Bt],[],[]),update_settings:t.Func([St],[],[]),upload_chunk:t.Func([It],[At],[])})};class ju extends Ge{constructor(t,e,r,n){super(["Call failed:",`  Canister: ${t.toText()}`,`  Method: ${e} (${r})`,...Object.getOwnPropertyNames(n).map((t=>`  "${t}": ${JSON.stringify(n[t])}`))].join("\n")),this.canisterId=t,this.methodName=e,this.type=r,this.props=n}}class $u extends ju{constructor(t,e,r){var n;super(t,e,"query",{Status:r.status,Code:null!==(n=Lt[r.reject_code])&&void 0!==n?n:`Unknown Code "${r.reject_code}"`,Message:r.reject_message}),this.result=r}}class Mu extends ju{constructor(t,e,r,n,i,o,s){super(t,e,"update",Object.assign({"Request ID":Fe(r)},n.body?Object.assign(Object.assign({},s?{"Error code":s}:{}),{"Reject code":String(i),"Reject message":o}):{"HTTP status code":n.status.toString(),"HTTP status text":n.statusText})),this.requestId=r,this.response=n,this.reject_code=i,this.reject_message=o,this.error_code=s}}const qu=Symbol.for("ic-agent-metadata");class Vu{constructor(t){this[qu]=Object.freeze(t)}static agentOf(t){return t[qu].config.agent}static interfaceOf(t){return t[qu].service}static canisterIdOf(t){return De.from(t[qu].config.canisterId)}static async install(t,e){const r=void 0===t.mode?{install:null}:t.mode,n=t.arg?[...new Uint8Array(t.arg)]:[],i=[...new Uint8Array(t.module)],o="string"==typeof e.canisterId?De.fromText(e.canisterId):e.canisterId;await Wu(e).install_code({mode:r,arg:n,wasm_module:i,canister_id:o,sender_canister_version:[]})}static async createCanister(t,e){const{canister_id:r}=await Wu(t||{}).provisional_create_canister_with_cycles({amount:[],settings:function(t){return[{controllers:t.controllers?[t.controllers]:[],compute_allocation:t.compute_allocation?[t.compute_allocation]:[],freezing_threshold:t.freezing_threshold?[t.freezing_threshold]:[],memory_allocation:t.memory_allocation?[t.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}(e||{}),specified_id:[],sender_canister_version:[]});return r}static async createAndInstallCanister(t,e,r){const n=await this.createCanister(r);return await this.install(Object.assign({},e),Object.assign(Object.assign({},r),{canisterId:n})),this.createActor(t,Object.assign(Object.assign({},r),{canisterId:n}))}static createActorClass(t,e){const r=t({IDL:fn});return class extends Vu{constructor(t){if(!t.canisterId)throw new Ge(`Canister ID is required, but received ${typeof t.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const n="string"==typeof t.canisterId?De.fromText(t.canisterId):t.canisterId;super({config:Object.assign(Object.assign(Object.assign({},Gu),t),{canisterId:n}),service:r});for(const[n,i]of r._fields)(null==e?void 0:e.httpDetails)&&i.annotations.push(Ku),(null==e?void 0:e.certificate)&&i.annotations.push(Hu),this[n]=Zu(this,n,i,t.blsVerify)}}}static createActor(t,e){if(!e.canisterId)throw new Ge(`Canister ID is required, but received ${typeof e.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(t))(e)}static createActorWithHttpDetails(t,e){return new(this.createActorClass(t,{httpDetails:!0}))(e)}static createActorWithExtendedDetails(t,e,r={httpDetails:!0,certificate:!0}){return new(this.createActorClass(t,r))(e)}}function zu(t,e){const r=Dr(t,Tt.Buffer.from(e));switch(r.length){case 0:return;case 1:return r[0];default:return r}}const Gu={pollingStrategyFactory:Du},Ku="http-details",Hu="certificate";function Zu(t,e,r,n){let i;i=r.annotations.includes("query")||r.annotations.includes("composite_query")?async(n,...i)=>{var o,s;const a=(n=Object.assign(Object.assign({},n),null===(s=(o=t[qu].config).queryTransform)||void 0===s?void 0:s.call(o,e,i,Object.assign(Object.assign({},t[qu].config),n)))).agent||t[qu].config.agent||Pu(),c=De.from(n.canisterId||t[qu].config.canisterId),u=Cr(r.argTypes,i),l=await a.query(c,{methodName:e,arg:u,effectiveCanisterId:n.effectiveCanisterId}),f=Object.assign(Object.assign({},l.httpDetails),{requestDetails:l.requestDetails});switch(l.status){case"rejected":throw new $u(c,e,l);case"replied":return r.annotations.includes(Ku)?{httpDetails:f,result:zu(r.retTypes,l.reply.arg)}:zu(r.retTypes,l.reply.arg)}}:async(i,...o)=>{var s,a;const c=(i=Object.assign(Object.assign({},i),null===(a=(s=t[qu].config).callTransform)||void 0===a?void 0:a.call(s,e,o,Object.assign(Object.assign({},t[qu].config),i)))).agent||t[qu].config.agent||Pu(),{canisterId:u,effectiveCanisterId:l,pollingStrategyFactory:f}=Object.assign(Object.assign(Object.assign({},Gu),t[qu].config),i),d=De.from(u),h=void 0!==l?De.from(l):d,p=Cr(r.argTypes,o),{requestId:g,response:m,requestDetails:y}=await c.call(d,{methodName:e,arg:p,effectiveCanisterId:h});let b,w;if(m.body&&m.body.certificate){if(null==c.rootKey)throw new Error("Agent is missing root key");const t=m.body.certificate;w=await La.create({certificate:We(t),rootKey:c.rootKey,canisterId:De.from(u),blsVerify:n});const r=[(new TextEncoder).encode("request_status"),g];switch((new TextDecoder).decode($a(w.lookup([...r,"status"])))){case"replied":b=$a(w.lookup([...r,"reply"]));break;case"rejected":{const t=new Uint8Array($a(w.lookup([...r,"reject_code"])))[0],n=(new TextDecoder).decode($a(w.lookup([...r,"reject_message"]))),i=$a(w.lookup([...r,"error_code"])),o=i?(new TextDecoder).decode(i):void 0;throw new Mu(d,e,g,m,t,n,o)}}}else if(m.body&&"reject_message"in m.body){const{reject_code:t,reject_message:r,error_code:n}=m.body;throw new Mu(d,e,g,m,t,r,n)}if(202===m.status){const t=f(),e=await Lu(c,h,g,t,n);w=e.certificate,b=e.reply}const v=r.annotations.includes(Ku),x=r.annotations.includes(Hu),E=Object.assign(Object.assign({},m),{requestDetails:y});if(void 0!==b)return v&&x?{httpDetails:E,certificate:w,result:zu(r.retTypes,b)}:x?{certificate:w,result:zu(r.retTypes,b)}:v?{httpDetails:E,result:zu(r.retTypes,b)}:zu(r.retTypes,b);if(0===r.retTypes.length)return v?{httpDetails:m,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${r.retTypes.join(",")}].`)};const o=(...t)=>i({},...t);return o.withOptions=t=>(...e)=>i(t,...e),o}function Wu(t){function e(e,r){if(t.effectiveCanisterId)return{effectiveCanisterId:De.from(t.effectiveCanisterId)};const n=r[0];let i=De.fromHex("");return n&&"object"==typeof n&&n.target_canister&&"install_chunked_code"===e&&(i=De.from(n.target_canister)),n&&"object"==typeof n&&n.canister_id&&(i=De.from(n.canister_id)),{effectiveCanisterId:i}}return Vu.createActor(Fu,Object.assign(Object.assign(Object.assign({},t),{canisterId:De.fromHex("")}),{callTransform:e,queryTransform:e}))}const Yu=({IDL:t})=>{const e=t.Record({id:t.Nat,passport_id:t.Nat,owner:t.Text,memory_type:t.Text,encrypted_content:t.Text,created_at:t.Nat64,importance_score:t.Nat8}),r=t.Record({id:t.Nat,capabilities:t.Vec(t.Text),owner:t.Text,encrypted_specifications:t.Text,created_at:t.Nat64,api_endpoints:t.Vec(t.Text),last_active:t.Nat64,agent_name:t.Text,agent_type:t.Text,is_active:t.Bool}),n=t.Record({id:t.Nat,encrypted_text:t.Text,owner:t.Text,users:t.Vec(t.Text)});return t.Service({add_agent_memory:t.Func([t.Nat,t.Text,t.Text,t.Nat8],[t.Nat],[]),add_user:t.Func([t.Nat,t.Text],[],[]),create_agent_passport:t.Func([t.Text,t.Text,t.Vec(t.Text),t.Text],[t.Nat],[]),create_note:t.Func([],[t.Nat],[]),delete_note:t.Func([t.Nat],[],[]),encrypted_symmetric_key_for_note:t.Func([t.Nat,t.Vec(t.Nat8)],[t.Text],[]),get_agent_memories:t.Func([t.Nat,t.Opt(t.Text)],[t.Vec(e)],[]),get_agent_passport:t.Func([t.Nat],[t.Opt(r)],[]),get_my_passports:t.Func([],[t.Vec(r)],[]),get_notes:t.Func([],[t.Vec(n)],[]),remove_user:t.Func([t.Nat,t.Text],[],[]),symmetric_key_verification_key_for_note:t.Func([],[t.Text],[]),update_agent_specifications:t.Func([t.Nat,t.Text],[],[]),update_note:t.Func([t.Nat,t.Text],[],[]),whoami:t.Func([],[t.Text],[])})};function Xu(t){const e=process.env.CANISTER_ID_ENCRYPTED_NOTES||"uxrrr-q7777-77774-qaaaq-cai",r={host:"ic"===process.env.DFX_NETWORK?`https://${e}.ic0.app`:"http://localhost:8000"};t?t.agentOptions?t.agentOptions.host=r.host:t.agentOptions=r:t={agentOptions:r};const n=new Uu(Object.assign({},t.agentOptions));return"production"!==process.env.NODE_ENV&&(console.log("Dev environment - fetching root key..."),n.fetchRootKey().catch((t=>{console.warn("Unable to fetch root key. Check to ensure that your local replica is running"),console.error(t)}))),Vu.createActor(Yu,Object.assign({agent:n,canisterId:e},null==t?void 0:t.actorOptions))}var Ju,Qu,tl,el,rl=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},nl=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};function il(t){return null!==t&&"object"==typeof t}class ol{constructor(t){if(Ju.set(this,void 0),Qu.set(this,void 0),t.byteLength!==ol.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");rl(this,Ju,ze(t),"f"),rl(this,Qu,ol.derEncode(t),"f")}static from(t){if("string"==typeof t){const e=$e(t);return this.fromRaw(e)}if(il(t)){const e=t;if(il(e)&&Object.hasOwnProperty.call(e,"__derEncodedPublicKey__"))return this.fromDer(e);if(ArrayBuffer.isView(e)){const t=e;return this.fromRaw(ze(t.buffer))}if(e instanceof ArrayBuffer)return this.fromRaw(e);if("rawKey"in e)return this.fromRaw(e.rawKey);if("derKey"in e)return this.fromDer(e.derKey);if("toDer"in e)return this.fromDer(e.toDer())}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(t){return new ol(t)}static fromDer(t){return new ol(this.derDecode(t))}static derEncode(t){const e=Rc(t,Oc).buffer;return e.__derEncodedPublicKey__=void 0,e}static derDecode(t){const e=Uc(t,Oc);if(e.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return ze(e)}get rawKey(){return nl(this,Ju,"f")}get derKey(){return nl(this,Qu,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}Ju=new WeakMap,Qu=new WeakMap,ol.RAW_KEY_LENGTH=32;class sl extends Ri{constructor(t,e){super(),tl.set(this,void 0),el.set(this,void 0),rl(this,tl,ol.from(t),"f"),rl(this,el,new Uint8Array(e),"f")}static generate(t){if(t&&32!==t.length)throw new Error("Ed25519 Seed needs to be 32 bytes long.");t||(t=wc.utils.randomPrivateKey()),qe(t,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const e=new Uint8Array(32);for(let r=0;r<32;r++)e[r]=new Uint8Array(t)[r];const r=wc.getPublicKey(e);return sl.fromKeyPair(r,e)}static fromParsedJson(t){const[e,r]=t;return new sl(ol.fromDer($e(e)),$e(r))}static fromJSON(t){const e=JSON.parse(t);if(Array.isArray(e)){if("string"==typeof e[0]&&"string"==typeof e[1])return this.fromParsedJson([e[0],e[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(t)}`)}static fromKeyPair(t,e){return new sl(ol.fromRaw(t),e)}static fromSecretKey(t){const e=wc.getPublicKey(new Uint8Array(t));return sl.fromKeyPair(e,t)}toJSON(){return[Fe(nl(this,tl,"f").toDer()),Fe(nl(this,el,"f"))]}getKeyPair(){return{secretKey:nl(this,el,"f"),publicKey:nl(this,tl,"f")}}getPublicKey(){return nl(this,tl,"f")}async sign(t){const e=new Uint8Array(t),r=Ve(wc.sign(e,nl(this,el,"f").slice(0,32)));return Object.defineProperty(r,"__signature__",{enumerable:!1,value:void 0}),r}static verify(t,e,r){const[n,i,o]=[t,e,r].map((t=>("string"==typeof t&&(t=$e(t)),t instanceof Uint8Array&&(t=ze(t.buffer)),new Uint8Array(t))));return wc.verify(n,i,o)}}tl=new WeakMap,el=new WeakMap;class al extends Error{constructor(t){super(t),this.message=t,Object.setPrototypeOf(this,al.prototype)}}function cl(t){if("undefined"!=typeof global&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(t)return t;if("undefined"!=typeof crypto&&crypto.subtle)return crypto.subtle;throw new al("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class ul extends Ri{constructor(t,e,r){super(),this._keyPair=t,this._derKey=e,this._subtleCrypto=r}static async generate(t){const{extractable:e=!1,keyUsages:r=["sign","verify"],subtleCrypto:n}=null!=t?t:{},i=cl(n),o=await i.generateKey({name:"ECDSA",namedCurve:"P-256"},e,r);return new this(o,await i.exportKey("spki",o.publicKey),i)}static async fromKeyPair(t,e){const r=cl(e),n=await r.exportKey("spki",t.publicKey);return new ul(t,n,r)}getKeyPair(){return this._keyPair}getPublicKey(){const t=this._derKey,e=Object.create(this._keyPair.publicKey);return e.toDer=function(){return t},e}async sign(t){return await this._subtleCrypto.sign({name:"ECDSA",hash:{name:"SHA-256"}},this._keyPair.privateKey,t)}}var ll,fl=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},dl=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class hl{constructor(t){ll.set(this,void 0),fl(this,ll,t,"f")}get rawKey(){return dl(this,ll,"f").rawKey}get derKey(){return dl(this,ll,"f").derKey}toDer(){return dl(this,ll,"f").toDer()}getPublicKey(){return dl(this,ll,"f")}getPrincipal(){if(!dl(this,ll,"f").rawKey)throw new Error("Cannot get principal from a public key without a raw key.");return De.fromUint8Array(new Uint8Array(dl(this,ll,"f").rawKey))}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}ll=new WeakMap;var pl,gl=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},ml=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)},yl=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r};const bl=(new TextEncoder).encode("ic-request-auth-delegation"),wl=(new TextEncoder).encode("\nic-request");function vl(t){if("string"!=typeof t||t.length<64)throw new Error("Invalid public key.");return $e(t)}class xl{constructor(t,e,r){this.pubkey=t,this.expiration=e,this.targets=r}toCBOR(){return ki.value.map(Object.assign({pubkey:ki.value.bytes(this.pubkey),expiration:ki.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:ki.value.array(this.targets.map((t=>ki.value.bytes(We(t.toUint8Array())))))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:Fe(this.pubkey)},this.targets&&{targets:this.targets.map((t=>t.toHex()))})}}class El{constructor(t,e){this.delegations=t,this.publicKey=e}static async create(t,e,r=new Date(Date.now()+9e5),n={}){var i,o;const s=await async function(t,e,r,n){const i=new xl(e.toDer(),BigInt(+r)*BigInt(1e6),n),o=new Uint8Array([...bl,...new Uint8Array(Ai(Object.assign({},i)))]);return{delegation:i,signature:await t.sign(We(o))}}(t,e,r,n.targets);return new El([...(null===(i=n.previous)||void 0===i?void 0:i.delegations)||[],s],(null===(o=n.previous)||void 0===o?void 0:o.publicKey)||t.getPublicKey().toDer())}static fromJSON(t){const{publicKey:e,delegations:r}="string"==typeof t?JSON.parse(t):t;if(!Array.isArray(r))throw new Error("Invalid delegations.");return new this(r.map((t=>{const{delegation:e,signature:r}=t,{pubkey:n,expiration:i,targets:o}=e;if(void 0!==o&&!Array.isArray(o))throw new Error("Invalid targets.");return{delegation:new xl(vl(n),BigInt("0x"+i),o&&o.map((t=>{if("string"!=typeof t)throw new Error("Invalid target.");return De.fromHex(t)}))),signature:vl(r)}})),vl(e))}static fromDelegations(t,e){return new this(t,e)}toJSON(){return{delegations:this.delegations.map((t=>{const{delegation:e,signature:r}=t,{targets:n}=e;return{delegation:Object.assign({expiration:e.expiration.toString(16),pubkey:Fe(e.pubkey)},n&&{targets:n.map((t=>t.toHex()))}),signature:Fe(r)}})),publicKey:Fe(this.publicKey)}}}class _l extends Ri{constructor(t,e){super(),this._inner=t,this._delegation=e}static fromDelegation(t,e){return new this(t,e)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(t){return this._inner.sign(t)}async transformRequest(t){const{body:e}=t,r=yl(t,["body"]),n=await Ai(e);return Object.assign(Object.assign({},r),{body:{content:e,sender_sig:await this.sign(We(new Uint8Array([...wl,...new Uint8Array(n)]))),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class Bl extends hl{constructor(t,e){super(t),pl.set(this,void 0),gl(this,pl,e,"f")}get delegation(){return ml(this,pl,"f")}static fromDelegation(t,e){return new Bl(t,e)}}var Sl;pl=new WeakMap,function(t){t[t.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"}(Sl||(Sl={}));const Il=["mousedown","mousemove","keydown","touchstart","wheel"];class Al{constructor(t={}){var e;this.callbacks=[],this.idleTimeout=6e5,this.timeoutID=void 0;const{onIdle:r,idleTimeout:n=6e5}=t||{};this.callbacks=r?[r]:[],this.idleTimeout=n;const i=this._resetTimer.bind(this);window.addEventListener("load",i,!0),Il.forEach((function(t){document.addEventListener(t,i,!0)}));const o=(t,e)=>{let r;return(...n)=>{const i=this;clearTimeout(r),r=window.setTimeout((function(){r=void 0,t.apply(i,n)}),e)}};if(null==t?void 0:t.captureScroll){const r=o(i,null!==(e=null==t?void 0:t.scrollDebounce)&&void 0!==e?e:100);window.addEventListener("scroll",r,!0)}i()}static create(t={}){return new this(t)}registerCallback(t){this.callbacks.push(t)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const t=this._resetTimer.bind(this);Il.forEach((function(e){document.removeEventListener(e,t,!0)})),this.callbacks.forEach((t=>t()))}_resetTimer(){const t=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(t,this.idleTimeout)}}const Tl=(t,e)=>e.some((e=>t instanceof e));let Nl,Ol;const Rl=new WeakMap,Ul=new WeakMap,kl=new WeakMap,Pl=new WeakMap,Cl=new WeakMap;let Dl={get(t,e,r){if(t instanceof IDBTransaction){if("done"===e)return Ul.get(t);if("objectStoreNames"===e)return t.objectStoreNames||kl.get(t);if("store"===e)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return jl(t[e])},set:(t,e,r)=>(t[e]=r,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function Ll(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Ol||(Ol=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply($l(this),e),jl(Rl.get(this))}:function(...e){return jl(t.apply($l(this),e))}:function(e,...r){const n=t.call($l(this),e,...r);return kl.set(n,e.sort?e.sort():[e]),jl(n)}}function Fl(t){return"function"==typeof t?Ll(t):(t instanceof IDBTransaction&&function(t){if(Ul.has(t))return;const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{e(),n()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),n()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)}));Ul.set(t,e)}(t),Tl(t,Nl||(Nl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,Dl):t)}function jl(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,r)=>{const n=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{e(jl(t.result)),n()},o=()=>{r(t.error),n()};t.addEventListener("success",i),t.addEventListener("error",o)}));return e.then((e=>{e instanceof IDBCursor&&Rl.set(e,t)})).catch((()=>{})),Cl.set(e,t),e}(t);if(Pl.has(t))return Pl.get(t);const e=Fl(t);return e!==t&&(Pl.set(t,e),Cl.set(e,t)),e}const $l=t=>Cl.get(t);const Ml=["get","getKey","getAll","getAllKeys","count"],ql=["put","add","delete","clear"],Vl=new Map;function zl(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(Vl.get(e))return Vl.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=ql.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!i&&!Ml.includes(r))return;const o=async function(t,...e){const o=this.transaction(t,i?"readwrite":"readonly");let s=o.store;return n&&(s=s.index(e.shift())),(await Promise.all([s[r](...e),i&&o.done]))[0]};return Vl.set(e,o),o}Dl=(t=>({...t,get:(e,r,n)=>zl(e,r)||t.get(e,r,n),has:(e,r)=>!!zl(e,r)||t.has(e,r)}))(Dl);const Gl="auth-client-db",Kl="ic-keyval",Hl=async(t=Gl,e=Kl,r)=>(ef&&(null===localStorage||void 0===localStorage?void 0:localStorage.getItem(Ql))&&(localStorage.removeItem(Ql),localStorage.removeItem(Jl)),await function(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),a=jl(s);return n&&s.addEventListener("upgradeneeded",(t=>{n(jl(s.result),t.oldVersion,t.newVersion,jl(s.transaction),t)})),r&&s.addEventListener("blocked",(t=>r(t.oldVersion,t.newVersion,t))),a.then((t=>{o&&t.addEventListener("close",(()=>o())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}(t,r,{upgrade:t=>{t.objectStoreNames.contains(e)&&t.clear(e),t.createObjectStore(e)}}));class Zl{constructor(t,e){this._db=t,this._storeName=e}static async create(t){const{dbName:e=Gl,storeName:r=Kl,version:n=tf}=null!=t?t:{},i=await Hl(e,r,n);return new Zl(i,r)}async set(t,e){return await async function(t,e,r,n){return await t.put(e,n,r)}(this._db,this._storeName,t,e)}async get(t){var e;return null!==(e=await async function(t,e,r){return await t.get(e,r)}(this._db,this._storeName,t))&&void 0!==e?e:null}async remove(t){return await async function(t,e,r){return await t.delete(e,r)}(this._db,this._storeName,t)}}var Wl,Yl=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},Xl=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};const Jl="identity",Ql="delegation",tf=1,ef="undefined"!=typeof window;class rf{constructor(t="ic-",e){this.prefix=t,this._localStorage=e}get(t){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+t))}set(t,e){return this._getLocalStorage().setItem(this.prefix+t,e),Promise.resolve()}remove(t){return this._getLocalStorage().removeItem(this.prefix+t),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?void 0:self.localStorage:global.localStorage:window.localStorage;if(!t)throw new Error("Could not find local storage.");return t}}class nf{constructor(t){Wl.set(this,void 0),Yl(this,Wl,null!=t?t:{},"f")}get _db(){return new Promise((t=>{this.initializedDb?t(this.initializedDb):Zl.create(Xl(this,Wl,"f")).then((e=>{this.initializedDb=e,t(e)}))}))}async get(t){const e=await this._db;return await e.get(t)}async set(t,e){const r=await this._db;await r.set(t,e)}async remove(t){const e=await this._db;await e.remove(t)}}Wl=new WeakMap;const of="ECDSA",sf="Ed25519";class af{constructor(t,e,r,n,i,o,s,a){this._identity=t,this._key=e,this._chain=r,this._storage=n,this.idleManager=i,this._createOptions=o,this._idpWindow=s,this._eventHandler=a,this._registerDefaultIdleCallback()}static async create(t={}){var e,r,n;const i=null!==(e=t.storage)&&void 0!==e?e:new nf,o=null!==(r=t.keyType)&&void 0!==r?r:of;let s=null;if(t.identity)s=t.identity;else{let t=await i.get(Jl);if(!t&&ef)try{const e=new rf,r=await e.get(Ql),n=await e.get(Jl);r&&n&&o===of&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await i.set(Ql,r),await i.set(Jl,n),t=r,await e.remove(Ql),await e.remove(Jl))}catch(t){console.error("error while attempting to recover localstorage: "+t)}if(t)try{"object"==typeof t?s=o===sf&&"string"==typeof t?await sl.fromJSON(t):await ul.fromKeyPair(t):"string"==typeof t&&(s=sl.fromJSON(t))}catch(t){}}let a,c=new Ui,u=null;if(s)try{const e=await i.get(Ql);if("object"==typeof e&&null!==e)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");t.identity?c=t.identity:e&&(u=El.fromJSON(e),!function(t,e){for(const{delegation:e}of t.delegations)if(+new Date(Number(e.expiration/BigInt(1e6)))<=+Date.now())return!1;const r=[],n=null==e?void 0:e.scope;n&&(Array.isArray(n)?r.push(...n.map((t=>"string"==typeof t?De.fromText(t):t))):r.push("string"==typeof n?De.fromText(n):n));for(const e of r){const r=e.toText();for(const{delegation:e}of t.delegations){if(void 0===e.targets)continue;let t=!0;for(const n of e.targets)if(n.toText()===r){t=!1;break}if(t)return!1}}return!0}(u)?(await cf(i),s=null):c="toDer"in s?Bl.fromDelegation(s,u):_l.fromDelegation(s,u))}catch(t){console.error(t),await cf(i),s=null}return(null===(n=t.idleOptions)||void 0===n?void 0:n.disableIdle)?a=void 0:(u||t.identity)&&(a=Al.create(t.idleOptions)),s||(o===sf?(s=await sl.generate(),await i.set(Jl,JSON.stringify(s.toJSON()))):(t.storage&&o===of&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${sf}' as the key type, as it can serialize to a string`),s=await ul.generate(),await i.set(Jl,s.getKeyPair()))),new this(c,s,u,i,a,t)}_registerDefaultIdleCallback(){var t,e;const r=null===(t=this._createOptions)||void 0===t?void 0:t.idleOptions;(null==r?void 0:r.onIdle)||(null==r?void 0:r.disableDefaultIdleCallback)||null===(e=this.idleManager)||void 0===e||e.registerCallback((()=>{this.logout(),location.reload()}))}async _handleSuccess(t,e){var r,n;const i=t.delegations.map((t=>({delegation:new xl(t.delegation.pubkey,t.delegation.expiration,t.delegation.targets),signature:t.signature.buffer}))),o=El.fromDelegations(i,t.userPublicKey.buffer),s=this._key;if(!s)return;this._chain=o,this._identity="toDer"in s?Bl.fromDelegation(s,this._chain):_l.fromDelegation(s,this._chain),null===(r=this._idpWindow)||void 0===r||r.close();const a=null===(n=this._createOptions)||void 0===n?void 0:n.idleOptions;this.idleManager||(null==a?void 0:a.disableIdle)||(this.idleManager=Al.create(a),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(Ql,JSON.stringify(this._chain.toJSON())),null==e||e(t)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&null!==this._chain}async login(t){var e,r,n,i;const o=BigInt(8)*BigInt(36e11),s=new URL((null===(e=null==t?void 0:t.identityProvider)||void 0===e?void 0:e.toString())||"https://identity.internetcomputer.org");s.hash="#authorize",null===(r=this._idpWindow)||void 0===r||r.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(s,Object.assign({maxTimeToLive:null!==(n=null==t?void 0:t.maxTimeToLive)&&void 0!==n?n:o},t)),window.addEventListener("message",this._eventHandler),this._idpWindow=null!==(i=window.open(s.toString(),"idpWindow",null==t?void 0:t.windowOpenerFeatures))&&void 0!==i?i:void 0;const a=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure("UserInterrupt",null==t?void 0:t.onError):setTimeout(a,500))};a()}_getEventHandler(t,e){return async r=>{var n,i,o;if(r.origin!==t.origin)return;const s=r.data;switch(s.kind){case"authorize-ready":{const r=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array(null===(n=this._key)||void 0===n?void 0:n.getPublicKey().toDer()),maxTimeToLive:null==e?void 0:e.maxTimeToLive,allowPinAuthentication:null==e?void 0:e.allowPinAuthentication,derivationOrigin:null===(i=null==e?void 0:e.derivationOrigin)||void 0===i?void 0:i.toString()},null==e?void 0:e.customValues);null===(o=this._idpWindow)||void 0===o||o.postMessage(r,t.origin);break}case"authorize-client-success":try{await this._handleSuccess(s,null==e?void 0:e.onSuccess)}catch(t){this._handleFailure(t.message,null==e?void 0:e.onError)}break;case"authorize-client-failure":this._handleFailure(s.text,null==e?void 0:e.onError)}}}_handleFailure(t,e){var r;null===(r=this._idpWindow)||void 0===r||r.close(),null==e||e(t),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(t={}){if(await cf(this._storage),this._identity=new Ui,this._chain=null,t.returnTo)try{window.history.pushState({},"",t.returnTo)}catch(e){window.location.href=t.returnTo}}}async function cf(t){await t.remove(Jl),await t.remove(Ql),await t.remove("iv")}function uf(t){return new Promise(((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)}))}let lf;function ff(){return lf||(lf=function(t,e){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(e);const n=uf(r);return(t,r)=>n.then((n=>r(n.transaction(e,t).objectStore(e))))}("keyval-store","keyval")),lf}function df(t,e=ff()){return e("readonly",(e=>uf(e.get(t))))}const hf="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function pf(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function gf(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function mf(t,...e){if(!pf(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function yf(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.createHasher");gf(t.outputLen),gf(t.blockLen)}function bf(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function wf(t,e){mf(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function vf(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function xf(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ef(t,e){return t<<32-e|t>>>e}function _f(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const Bf=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]?t=>t:function(t){for(let e=0;e<t.length;e++)t[e]=_f(t[e]);return t},Sf="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,If=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function Af(t){if(mf(t),Sf)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=If[t[r]];return e}const Tf={_0:48,_9:57,A:65,F:70,a:97,f:102};function Nf(t){return t>=Tf._0&&t<=Tf._9?t-Tf._0:t>=Tf.A&&t<=Tf.F?t-(Tf.A-10):t>=Tf.a&&t<=Tf.f?t-(Tf.a-10):void 0}function Of(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);if(Sf)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){const r=Nf(t.charCodeAt(i)),o=Nf(t.charCodeAt(i+1));if(void 0===r||void 0===o){const e=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+i)}n[e]=16*r+o}return n}function Rf(t){if("string"!=typeof t)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}function Uf(t){return"string"==typeof t&&(t=Rf(t)),mf(t),t}function kf(...t){let e=0;for(let r=0;r<t.length;r++){const n=t[r];mf(n),e+=n.length}const r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}class Pf{}function Cf(t){const e=e=>t().update(Uf(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Df(t=32){if(hf&&"function"==typeof hf.getRandomValues)return hf.getRandomValues(new Uint8Array(t));if(hf&&"function"==typeof hf.randomBytes)return Uint8Array.from(hf.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function Lf(t,e,r){return t&e^~t&r}function Ff(t,e,r){return t&e^t&r^e&r}class jf extends Pf{constructor(t,e,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(t),this.view=xf(this.buffer)}update(t){bf(this),mf(t=Uf(t));const{view:e,buffer:r,blockLen:n}=this,i=t.length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s!==n)r.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=xf(t);for(;n<=i-o;o+=n)this.process(e,o)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){bf(this),wf(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;e[o++]=128,vf(this.buffer.subarray(o)),this.padOffset>n-o&&(this.process(r,0),o=0);for(let t=o;t<n;t++)e[t]=0;(function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,u=n?0:4;t.setUint32(e+c,s,n),t.setUint32(e+u,a,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=xf(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,u[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return t.destroyed=o,t.finished=i,t.length=n,t.pos=s,n%e&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const $f=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Mf=BigInt(2**32-1),qf=BigInt(32);function Vf(t,e=!1){return e?{h:Number(t&Mf),l:Number(t>>qf&Mf)}:{h:0|Number(t>>qf&Mf),l:0|Number(t&Mf)}}function zf(t,e=!1){const r=t.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let o=0;o<r;o++){const{h:r,l:s}=Vf(t[o],e);[n[o],i[o]]=[r,s]}return[n,i]}const Gf=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Kf=new Uint32Array(64);class Hf extends jf{constructor(t=32){super(64,t,8,!1),this.A=0|$f[0],this.B=0|$f[1],this.C=0|$f[2],this.D=0|$f[3],this.E=0|$f[4],this.F=0|$f[5],this.G=0|$f[6],this.H=0|$f[7]}get(){const{A:t,B:e,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[t,e,r,n,i,o,s,a]}set(t,e,r,n,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)Kf[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=Kf[t-15],r=Kf[t-2],n=Ef(e,7)^Ef(e,18)^e>>>3,i=Ef(r,17)^Ef(r,19)^r>>>10;Kf[t]=i+Kf[t-7]+n+Kf[t-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(Ef(s,6)^Ef(s,11)^Ef(s,25))+Lf(s,a,c)+Gf[t]+Kf[t]|0,l=(Ef(r,2)^Ef(r,13)^Ef(r,22))+Ff(r,n,i)|0;u=c,c=a,a=s,s=o+e|0,o=i,i=n,n=r,r=e+l|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,o,s,a,c,u)}roundClean(){vf(Kf)}destroy(){this.set(0,0,0,0,0,0,0,0),vf(this.buffer)}}zf(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t))));const Zf=Cf((()=>new Hf)),Wf=BigInt(0),Yf=BigInt(1);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Xf(t,e){if("boolean"!=typeof e)throw new Error(t+" boolean expected, got "+e)}function Jf(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return""===t?Wf:BigInt("0x"+t)}function Qf(t){return Jf(Af(t))}function td(t){return mf(t),Jf(Af(Uint8Array.from(t).reverse()))}function ed(t,e){return Of(t.toString(16).padStart(2*e,"0"))}function rd(t,e){return ed(t,e).reverse()}function nd(t,e,r){let n;if("string"==typeof e)try{n=Of(e)}catch(e){throw new Error(t+" must be hex string or Uint8Array, cause: "+e)}else{if(!pf(e))throw new Error(t+" must be hex string or Uint8Array");n=Uint8Array.from(e)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}const id=t=>"bigint"==typeof t&&Wf<=t;function od(t){let e;for(e=0;t>Wf;t>>=Yf,e+=1);return e}function sd(t,e){return t>>BigInt(e)&Yf}const ad=t=>(Yf<<BigInt(t))-Yf;function cd(t,e,r={}){if(!t||"object"!=typeof t)throw new Error("expected valid options object");function n(e,r,n){const i=t[e];if(n&&void 0===i)return;const o=typeof i;if(o!==r||null===i)throw new Error(`param "${e}" is invalid: expected ${r}, got ${o}`)}Object.entries(e).forEach((([t,e])=>n(t,e,!1))),Object.entries(r).forEach((([t,e])=>n(t,e,!0)))}const ud=()=>{throw new Error("not implemented")};function ld(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(void 0!==i)return i;const o=t(r,...n);return e.set(r,o),o}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const fd=BigInt(0),dd=BigInt(1),hd=BigInt(2),pd=BigInt(3),gd=BigInt(4),md=BigInt(5),yd=BigInt(8);function bd(t,e){const r=t%e;return r>=fd?r:e+r}function wd(t,e){if(t===fd)throw new Error("invert: expected non-zero number");if(e<=fd)throw new Error("invert: expected positive modulus, got "+e);let r=bd(t,e),n=e,i=fd,o=dd;for(;r!==fd;){const t=n%r,e=i-o*(n/r);n=r,r=t,i=o,o=e}if(n!==dd)throw new Error("invert: does not exist");return bd(i,e)}function vd(t,e){const r=(t.ORDER+dd)/gd,n=t.pow(e,r);if(!t.eql(t.sqr(n),e))throw new Error("Cannot find square root");return n}function xd(t,e){const r=(t.ORDER-md)/yd,n=t.mul(e,hd),i=t.pow(n,r),o=t.mul(e,i),s=t.mul(t.mul(o,hd),i),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function Ed(t){return t%gd===pd?vd:t%yd===md?xd:function(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-dd,r=0;for(;e%hd===fd;)e/=hd,r++;let n=hd;const i=Td(t);for(;1===Ad(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return vd;let o=i.pow(n,e);const s=(e+dd)/hd;return function(t,n){if(t.is0(n))return n;if(1!==Ad(t,n))throw new Error("Cannot find square root");let i=r,a=t.mul(t.ONE,o),c=t.pow(n,e),u=t.pow(n,s);for(;!t.eql(c,t.ONE);){if(t.is0(c))return t.ZERO;let e=1,r=t.sqr(c);for(;!t.eql(r,t.ONE);)if(e++,r=t.sqr(r),e===i)throw new Error("Cannot find square root");const n=dd<<BigInt(i-e-1),o=t.pow(a,n);i=e,a=t.sqr(o),c=t.mul(c,a),u=t.mul(u,o)}return u}}(t)}const _d=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Bd(t){return cd(t,_d.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),t}function Sd(t,e,r){if(r<fd)throw new Error("invalid exponent, negatives unsupported");if(r===fd)return t.ONE;if(r===dd)return e;let n=t.ONE,i=e;for(;r>fd;)r&dd&&(n=t.mul(n,i)),i=t.sqr(i),r>>=dd;return n}function Id(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),i=e.reduce(((e,r,i)=>t.is0(r)?e:(n[i]=e,t.mul(e,r))),t.ONE),o=t.inv(i);return e.reduceRight(((e,r,i)=>t.is0(r)?e:(n[i]=t.mul(e,n[i]),t.mul(e,r))),o),n}function Ad(t,e){const r=(t.ORDER-dd)/hd,n=t.pow(e,r),i=t.eql(n,t.ONE),o=t.eql(n,t.ZERO),s=t.eql(n,t.neg(t.ONE));if(!i&&!o&&!s)throw new Error("invalid Legendre symbol result");return i?1:o?0:-1}function Td(t,e,r=!1,n={}){if(t<=fd)throw new Error("invalid field: expected ORDER > 0, got "+t);let i,o;if("object"==typeof e&&null!=e){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const t=e;t.BITS&&(i=t.BITS),t.sqrt&&(o=t.sqrt),"boolean"==typeof t.isLE&&(r=t.isLE)}else"number"==typeof e&&(i=e),n.sqrt&&(o=n.sqrt);const{nBitLength:s,nByteLength:a}=function(t,e){void 0!==e&&gf(e);const r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}(t,i);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const u=Object.freeze({ORDER:t,isLE:r,BITS:s,BYTES:a,MASK:ad(s),ZERO:fd,ONE:dd,create:e=>bd(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("invalid field element: expected bigint, got "+typeof e);return fd<=e&&e<t},is0:t=>t===fd,isValidNot0:t=>!u.is0(t)&&u.isValid(t),isOdd:t=>(t&dd)===dd,neg:e=>bd(-e,t),eql:(t,e)=>t===e,sqr:e=>bd(e*e,t),add:(e,r)=>bd(e+r,t),sub:(e,r)=>bd(e-r,t),mul:(e,r)=>bd(e*r,t),pow:(t,e)=>Sd(u,t,e),div:(e,r)=>bd(e*wd(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>wd(e,t),sqrt:o||(e=>(c||(c=Ed(t)),c(u,e))),toBytes:t=>r?rd(t,a):ed(t,a),fromBytes:t=>{if(t.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+t.length);return r?td(t):Qf(t)},invertBatch:t=>Id(u,t),cmov:(t,e,r)=>r?e:t});return Object.freeze(u)}function Nd(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Od(t){const e=Nd(t);return e+Math.ceil(e/2)}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const Rd=BigInt(0),Ud=BigInt(1);function kd(t,e){const r=e.negate();return t?r:e}function Pd(t,e,r){const n="pz"===e?t=>t.pz:t=>t.ez,i=Id(t.Fp,r.map(n));return r.map(((t,e)=>t.toAffine(i[e]))).map(t.fromAffine)}function Cd(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Dd(t,e){Cd(t,e);const r=2**t;return{windows:Math.ceil(e/t)+1,windowSize:2**(t-1),mask:ad(t),maxNumber:r,shiftBy:BigInt(t)}}function Ld(t,e,r){const{windowSize:n,mask:i,maxNumber:o,shiftBy:s}=r;let a=Number(t&i),c=t>>s;a>n&&(a-=o,c+=Ud);const u=e*n;return{nextN:c,offset:u+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:e%2!=0,offsetF:u}}const Fd=new WeakMap,jd=new WeakMap;function $d(t){return jd.get(t)||1}function Md(t){if(t!==Rd)throw new Error("invalid wNAF")}function qd(t,e,r,n){(function(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach(((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)}))})(r,t),function(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach(((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)}))}(n,e);const i=r.length,o=n.length;if(i!==o)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,a=od(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=ad(c),l=new Array(Number(u)+1).fill(s);let f=s;for(let t=Math.floor((e.BITS-1)/c)*c;t>=0;t-=c){l.fill(s);for(let e=0;e<o;e++){const i=n[e],o=Number(i>>BigInt(t)&u);l[o]=l[o].add(r[e])}let e=s;for(let t=l.length-1,r=s;t>0;t--)r=r.add(l[t]),e=e.add(r);if(f=f.add(e),0!==t)for(let t=0;t<c;t++)f=f.double()}return f}function Vd(t,e){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Bd(e),e}return Td(t)}const zd=Qf;function Gd(t,e){if(Hd(t),Hd(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=255&t,t>>>=8;return new Uint8Array(r)}function Kd(t,e){const r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}function Hd(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Zd(t,e,r){cd(r,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:n,k:i,m:o,hash:s,expand:a,DST:c}=r;if(!pf(c)&&"string"!=typeof c)throw new Error("DST must be string or uint8array");if(!function(t){return"function"==typeof t&&Number.isSafeInteger(t.outputLen)}(r.hash))throw new Error("expected valid hash");mf(t),Hd(e);const u="string"==typeof c?Rf(c):c,l=n.toString(2).length,f=Math.ceil((l+i)/8),d=e*o*f;let h;if("xmd"===a)h=function(t,e,r,n){mf(t),mf(e),Hd(r),e.length>255&&(e=n(kf(Rf("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:o}=n,s=Math.ceil(r/i);if(r>65535||s>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=kf(e,Gd(e.length,1)),c=Gd(0,o),u=Gd(r,2),l=new Array(s),f=n(kf(c,t,u,Gd(0,1),a));l[0]=n(kf(f,Gd(1,1),a));for(let t=1;t<=s;t++){const e=[Kd(f,l[t-1]),Gd(t+1,1),a];l[t]=n(kf(...e))}return kf(...l).slice(0,r)}(t,u,d,s);else if("xof"===a)h=function(t,e,r,n,i){if(mf(t),mf(e),Hd(r),e.length>255){const t=Math.ceil(2*n/8);e=i.create({dkLen:t}).update(Rf("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(Gd(r,2)).update(e).update(Gd(e.length,1)).digest()}(t,u,d,i,s);else{if("_internal_pass"!==a)throw new Error('expand must be "xmd" or "xof"');h=t}const p=new Array(e);for(let t=0;t<e;t++){const e=new Array(o);for(let r=0;r<o;r++){const i=f*(r+t*o),s=h.subarray(i,i+f);e[r]=bd(zd(s),n)}p[t]=e}return p}function Wd(t,e){const r=e.map((t=>Array.from(t).reverse()));return(e,n)=>{const[i,o,s,a]=r.map((r=>r.reduce(((r,n)=>t.add(t.mul(r,e),n))))),[c,u]=Id(t,[o,a],!0);return e=t.mul(i,c),n=t.mul(n,t.mul(s,u)),{x:e,y:n}}}function Yd(t,e,r){if("function"!=typeof e)throw new Error("mapToCurve() must be defined");function n(r){return t.fromAffine(e(r))}function i(e){const r=e.clearCofactor();return r.equals(t.ZERO)?t.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(t,e){const o=r.DST?r.DST:{},s=Zd(t,2,Object.assign({},r,o,e)),a=n(s[0]),c=n(s[1]);return i(a.add(c))},encodeToCurve(t,e){const o=r.encodeDST?r.encodeDST:{};return i(n(Zd(t,1,Object.assign({},r,o,e))[0]))},mapToCurve(t){if(!Array.isArray(t))throw new Error("expected array of bigints");for(const e of t)if("bigint"!=typeof e)throw new Error("expected array of bigints");return i(n(t))}}}class Xd extends Pf{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,yf(t);const r=Uf(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?t.create().update(r).digest():r);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),vf(i)}update(t){return bf(this),this.iHash.update(t),this}digestInto(t){bf(this),mf(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return t.finished=n,t.destroyed=i,t.blockLen=o,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Jd=(t,e,r)=>new Xd(t,e).update(r).digest();Jd.create=(t,e)=>new Xd(t,e)
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */;const Qd=BigInt(0),th=BigInt(1),eh=BigInt(2),rh=BigInt(3),nh=BigInt(4);function ih(t,e,r){return function(n){const i=t.sqr(n),o=t.mul(i,n);return t.add(t.add(o,t.mul(n,e)),r)}}function oh(t,e,r){const{BYTES:n}=t;return function(i){let o;if("bigint"==typeof i)o=i;else{let r=nd("private key",i);if(e){if(!e.includes(2*r.length))throw new Error("invalid private key");const t=new Uint8Array(n);t.set(r,t.length-r.length),r=t}try{o=t.fromBytes(r)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof i}`)}}if(r&&(o=t.create(o)),!t.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}}function sh(t,e={}){const{Fp:r,Fn:n}=function(t,e,r={}){if(!e||"object"!=typeof e)throw new Error(`expected valid ${t} CURVE object`);for(const t of["p","n","h"]){const r=e[t];if(!("bigint"==typeof r&&r>Rd))throw new Error(`CURVE.${t} must be positive bigint`)}const n=Vd(e.p,r.Fp),i=Vd(e.n,r.Fn),o=["Gx","Gy","a","weierstrass"===t?"b":"d"];for(const t of o)if(!n.isValid(e[t]))throw new Error(`CURVE.${t} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:i}}("weierstrass",t,e),{h:i,n:o}=t;cd(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:s}=e;if(s&&(!r.is0(t.a)||"bigint"!=typeof s.beta||"function"!=typeof s.splitScalar))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const c=e.toBytes||function(t,e,n){const{x:i,y:o}=e.toAffine(),s=r.toBytes(i);if(Xf("isCompressed",n),n){a();return kf(function(t){return Uint8Array.of(t?2:3)}(!r.isOdd(o)),s)}return kf(Uint8Array.of(4),s,r.toBytes(o))},u=e.fromBytes||function(t){mf(t);const e=r.BYTES,n=e+1,i=2*e+1,o=t.length,s=t[0],c=t.subarray(1);if(o!==n||2!==s&&3!==s){if(o===i&&4===s){const t=r.fromBytes(c.subarray(0*e,1*e)),n=r.fromBytes(c.subarray(1*e,2*e));if(!f(t,n))throw new Error("bad point: is not on curve");return{x:t,y:n}}throw new Error(`bad point: got length ${o}, expected compressed=${n} or uncompressed=${i}`)}{const t=r.fromBytes(c);if(!r.isValid(t))throw new Error("bad point: is not on curve, wrong x");const e=l(t);let n;try{n=r.sqrt(e)}catch(t){const e=t instanceof Error?": "+t.message:"";throw new Error("bad point: is not on curve, sqrt error"+e)}a();return 1==(1&s)!==r.isOdd(n)&&(n=r.neg(n)),{x:t,y:n}}},l=ih(r,t.a,t.b);function f(t,e){const n=r.sqr(e),i=l(t);return r.eql(n,i)}if(!f(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const d=r.mul(r.pow(t.a,rh),nh),h=r.mul(r.sqr(t.b),BigInt(27));if(r.is0(r.add(d,h)))throw new Error("bad curve params: a or b");function p(t,e,n=!1){if(!r.isValid(e)||n&&r.is0(e))throw new Error(`bad point coordinate ${t}`);return e}function g(t){if(!(t instanceof w))throw new Error("ProjectivePoint expected")}const m=ld(((t,e)=>{const{px:n,py:i,pz:o}=t;if(r.eql(o,r.ONE))return{x:n,y:i};const s=t.is0();null==e&&(e=s?r.ONE:r.inv(o));const a=r.mul(n,e),c=r.mul(i,e),u=r.mul(o,e);if(s)return{x:r.ZERO,y:r.ZERO};if(!r.eql(u,r.ONE))throw new Error("invZ was invalid");return{x:a,y:c}})),y=ld((t=>{if(t.is0()){if(e.allowInfinityPoint&&!r.is0(t.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=t.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not field elements");if(!f(n,i))throw new Error("bad point: equation left != right");if(!t.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));function b(t,e,n,i,o){return n=new w(r.mul(n.px,t),n.py,n.pz),e=kd(i,e),n=kd(o,n),e.add(n)}class w{constructor(t,e,r){this.px=p("x",t),this.py=p("y",e,!0),this.pz=p("z",r),Object.freeze(this)}static fromAffine(t){const{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw new Error("invalid affine point");if(t instanceof w)throw new Error("projective point not allowed");return r.is0(e)&&r.is0(n)?w.ZERO:new w(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){return Pd(w,"pz",t)}static fromBytes(t){return mf(t),w.fromHex(t)}static fromHex(t){const e=w.fromAffine(u(nd("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){const r=oh(n,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return w.BASE.multiply(r(t))}static msm(t,e){return qd(w,n,t,e)}precompute(t=8,e=!0){return x.setWindowSize(this,t),e||this.multiply(rh),this}_setWindowSize(t){this.precompute(t)}assertValidity(){y(this)}hasEvenY(){const{y:t}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(t)}equals(t){g(t);const{px:e,py:n,pz:i}=this,{px:o,py:s,pz:a}=t,c=r.eql(r.mul(e,a),r.mul(o,i)),u=r.eql(r.mul(n,a),r.mul(s,i));return c&&u}negate(){return new w(this.px,r.neg(this.py),this.pz)}double(){const{a:e,b:n}=t,i=r.mul(n,rh),{px:o,py:s,pz:a}=this;let c=r.ZERO,u=r.ZERO,l=r.ZERO,f=r.mul(o,o),d=r.mul(s,s),h=r.mul(a,a),p=r.mul(o,s);return p=r.add(p,p),l=r.mul(o,a),l=r.add(l,l),c=r.mul(e,l),u=r.mul(i,h),u=r.add(c,u),c=r.sub(d,u),u=r.add(d,u),u=r.mul(c,u),c=r.mul(p,c),l=r.mul(i,l),h=r.mul(e,h),p=r.sub(f,h),p=r.mul(e,p),p=r.add(p,l),l=r.add(f,f),f=r.add(l,f),f=r.add(f,h),f=r.mul(f,p),u=r.add(u,f),h=r.mul(s,a),h=r.add(h,h),f=r.mul(h,p),c=r.sub(c,f),l=r.mul(h,d),l=r.add(l,l),l=r.add(l,l),new w(c,u,l)}add(e){g(e);const{px:n,py:i,pz:o}=this,{px:s,py:a,pz:c}=e;let u=r.ZERO,l=r.ZERO,f=r.ZERO;const d=t.a,h=r.mul(t.b,rh);let p=r.mul(n,s),m=r.mul(i,a),y=r.mul(o,c),b=r.add(n,i),v=r.add(s,a);b=r.mul(b,v),v=r.add(p,m),b=r.sub(b,v),v=r.add(n,o);let x=r.add(s,c);return v=r.mul(v,x),x=r.add(p,y),v=r.sub(v,x),x=r.add(i,o),u=r.add(a,c),x=r.mul(x,u),u=r.add(m,y),x=r.sub(x,u),f=r.mul(d,v),u=r.mul(h,y),f=r.add(u,f),u=r.sub(m,f),f=r.add(m,f),l=r.mul(u,f),m=r.add(p,p),m=r.add(m,p),y=r.mul(d,y),v=r.mul(h,v),m=r.add(m,y),y=r.sub(p,y),y=r.mul(d,y),v=r.add(v,y),p=r.mul(m,v),l=r.add(l,p),p=r.mul(x,v),u=r.mul(b,u),u=r.sub(u,p),p=r.mul(b,m),f=r.mul(x,f),f=r.add(f,p),new w(u,l,f)}subtract(t){return this.add(t.negate())}is0(){return this.equals(w.ZERO)}multiply(t){const{endo:r}=e;if(!n.isValidNot0(t))throw new Error("invalid scalar: out of range");let i,o;const s=t=>x.wNAFCached(this,t,w.normalizeZ);if(r){const{k1neg:e,k1:n,k2neg:a,k2:c}=r.splitScalar(t),{p:u,f:l}=s(n),{p:f,f:d}=s(c);o=l.add(d),i=b(r.beta,u,f,e,a)}else{const{p:e,f:r}=s(t);i=e,o=r}return w.normalizeZ([i,o])[0]}multiplyUnsafe(t){const{endo:r}=e,i=this;if(!n.isValid(t))throw new Error("invalid scalar: out of range");if(t===Qd||i.is0())return w.ZERO;if(t===th)return i;if(x.hasPrecomputes(this))return this.multiply(t);if(r){const{k1neg:e,k1:n,k2neg:o,k2:s}=r.splitScalar(t),{p1:a,p2:c}=function(t,e,r,n){let i=e,o=t.ZERO,s=t.ZERO;for(;r>Rd||n>Rd;)r&Ud&&(o=o.add(i)),n&Ud&&(s=s.add(i)),i=i.double(),r>>=Ud,n>>=Ud;return{p1:o,p2:s}}(w,i,n,s);return b(r.beta,a,c,e,o)}return x.wNAFCachedUnsafe(i,t)}multiplyAndAddUnsafe(t,e,r){const n=this.multiplyUnsafe(e).add(t.multiplyUnsafe(r));return n.is0()?void 0:n}toAffine(t){return m(this,t)}isTorsionFree(){const{isTorsionFree:t}=e;return i===th||(t?t(w,this):x.wNAFCachedUnsafe(this,o).is0())}clearCofactor(){const{clearCofactor:t}=e;return i===th?this:t?t(w,this):this.multiplyUnsafe(i)}toBytes(t=!0){return Xf("isCompressed",t),this.assertValidity(),c(w,this,t)}toRawBytes(t=!0){return this.toBytes(t)}toHex(t=!0){return Af(this.toBytes(t))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}w.BASE=new w(t.Gx,t.Gy,r.ONE),w.ZERO=new w(r.ZERO,r.ONE,r.ZERO),w.Fp=r,w.Fn=n;const v=n.BITS,x=function(t,e){return{constTimeNegate:kd,hasPrecomputes:t=>1!==$d(t),unsafeLadder(e,r,n=t.ZERO){let i=e;for(;r>Rd;)r&Ud&&(n=n.add(i)),i=i.double(),r>>=Ud;return n},precomputeWindow(t,r){const{windows:n,windowSize:i}=Dd(r,e),o=[];let s=t,a=s;for(let t=0;t<n;t++){a=s,o.push(a);for(let t=1;t<i;t++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(r,n,i){let o=t.ZERO,s=t.BASE;const a=Dd(r,e);for(let t=0;t<a.windows;t++){const{nextN:e,offset:r,isZero:c,isNeg:u,isNegF:l,offsetF:f}=Ld(i,t,a);i=e,c?s=s.add(kd(l,n[f])):o=o.add(kd(u,n[r]))}return Md(i),{p:o,f:s}},wNAFUnsafe(r,n,i,o=t.ZERO){const s=Dd(r,e);for(let t=0;t<s.windows&&i!==Rd;t++){const{nextN:e,offset:r,isZero:a,isNeg:c}=Ld(i,t,s);if(i=e,!a){const t=n[r];o=o.add(c?t.negate():t)}}return Md(i),o},getPrecomputes(t,e,r){let n=Fd.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&("function"==typeof r&&(n=r(n)),Fd.set(e,n))),n},wNAFCached(t,e,r){const n=$d(t);return this.wNAF(n,this.getPrecomputes(n,t,r),e)},wNAFCachedUnsafe(t,e,r,n){const i=$d(t);return 1===i?this.unsafeLadder(t,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),e,n)},setWindowSize(t,r){Cd(r,e),jd.set(t,r),Fd.delete(t)}}}(w,e.endo?Math.ceil(v/2):v);return w}function ah(t){const{CURVE:e,curveOpts:r}=function(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp,n=Td(e.n,t.nBitLength),i={Fp:r,Fn:n,allowedPrivateKeyLengths:t.allowedPrivateKeyLengths,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,wrapPrivateKey:t.wrapPrivateKey,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:i}}(t);return function(t,e){const{Fp:r,Fn:n}=e;function i(t){return function(t,e,r){return id(t)&&id(e)&&id(r)&&e<=t&&t<r}(t,th,n.ORDER)}const o=ih(r,t.a,t.b),s=oh(n,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return Object.assign({},{CURVE:t,Point:e,ProjectivePoint:e,normPrivateKeyToScalar:s,weierstrassEquation:o,isWithinCurveOrder:i})}(t,sh(e,r))}function ch(t,e){Bd(t);const{A:r,B:n,Z:i}=e;if(!t.isValid(r)||!t.isValid(n)||!t.isValid(i))throw new Error("mapToCurveSimpleSWU: invalid opts");const o=function(t,e){const r=t.ORDER;let n=Qd;for(let t=r-th;t%eh===Qd;t/=eh)n+=th;const i=n,o=eh<<i-th-th,s=o*eh,a=(r-th)/s,c=(a-th)/eh,u=s-th,l=o,f=t.pow(e,a),d=t.pow(e,(a+th)/eh);let h=(e,r)=>{let n=f,o=t.pow(r,u),s=t.sqr(o);s=t.mul(s,r);let a=t.mul(e,s);a=t.pow(a,c),a=t.mul(a,o),o=t.mul(a,r),s=t.mul(a,e);let h=t.mul(s,o);a=t.pow(h,l);let p=t.eql(a,t.ONE);o=t.mul(s,d),a=t.mul(h,n),s=t.cmov(o,s,p),h=t.cmov(a,h,p);for(let e=i;e>th;e--){let r=e-eh;r=eh<<r-th;let i=t.pow(h,r);const a=t.eql(i,t.ONE);o=t.mul(s,n),n=t.mul(n,n),i=t.mul(h,n),s=t.cmov(o,s,a),h=t.cmov(i,h,a)}return{isValid:p,value:s}};if(t.ORDER%nh===rh){const r=(t.ORDER-rh)/nh,n=t.sqrt(t.neg(e));h=(e,i)=>{let o=t.sqr(i);const s=t.mul(e,i);o=t.mul(o,s);let a=t.pow(o,r);a=t.mul(a,s);const c=t.mul(a,n),u=t.mul(t.sqr(a),i),l=t.eql(u,e);return{isValid:l,value:t.cmov(c,a,l)}}}return h}(t,i);if(!t.isOdd)throw new Error("Field does not have .isOdd()");return e=>{let s,a,c,u,l,f,d,h;s=t.sqr(e),s=t.mul(s,i),a=t.sqr(s),a=t.add(a,s),c=t.add(a,t.ONE),c=t.mul(c,n),u=t.cmov(i,t.neg(a),!t.eql(a,t.ZERO)),u=t.mul(u,r),a=t.sqr(c),f=t.sqr(u),l=t.mul(f,r),a=t.add(a,l),a=t.mul(a,c),f=t.mul(f,u),l=t.mul(f,n),a=t.add(a,l),d=t.mul(s,c);const{isValid:p,value:g}=o(a,f);h=t.mul(s,e),h=t.mul(h,g),d=t.cmov(d,c,p),h=t.cmov(h,g,p);const m=t.isOdd(e)===t.isOdd(h);h=t.cmov(t.neg(h),h,m);const y=Id(t,[u],!0)[0];return d=t.mul(d,y),{x:d,y:h}}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const uh=BigInt(0),lh=BigInt(1),fh=BigInt(2),dh=BigInt(3);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const hh=BigInt(0),ph=BigInt(1),gh=BigInt(2),mh=BigInt(3);function yh(t,e,r,n,i=1,o){const s=BigInt(void 0===o?n:o),a=r**BigInt(n),c=[];for(let o=0;o<i;o++){const i=BigInt(o+1),u=[];for(let o=0,c=ph;o<n;o++){const n=(i*c-i)/s%a;u.push(t.pow(e,n)),c*=r}c.push(u)}return c}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const bh=BigInt(0),wh=BigInt(1),vh=BigInt(2),xh=BigInt(3),Eh=BigInt(4),_h=BigInt("0xd201000000010000"),Bh=od(_h),Sh={p:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),n:BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001"),h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),a:bh,b:Eh,Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1")},Ih=Td(Sh.n),{Fp:Ah,Fp2:Th,Fp6:Nh,Fp4Square:Oh,Fp12:Rh}=function(t){const{ORDER:e}=t,r=Td(e),n=r.create(t.NONRESIDUE||BigInt(-1)),i=r.div(r.ONE,gh),o=yh(r,n,r.ORDER,2)[0],s=({c0:t,c1:e},{c0:n,c1:i})=>({c0:r.add(t,n),c1:r.add(e,i)}),a=({c0:t,c1:e},{c0:n,c1:i})=>({c0:r.sub(t,n),c1:r.sub(e,i)}),c=({c0:t,c1:e},n)=>{if("bigint"==typeof n)return{c0:r.mul(t,n),c1:r.mul(e,n)};const{c0:i,c1:o}=n;let s=r.mul(t,i),a=r.mul(e,o);return{c0:r.sub(s,a),c1:r.sub(r.mul(r.add(t,e),r.add(i,o)),r.add(s,a))}},u=({c0:t,c1:e})=>{const n=r.add(t,e),i=r.sub(t,e),o=r.add(t,t);return{c0:r.mul(n,i),c1:r.mul(o,e)}},l=t=>{if(2!==t.length)throw new Error("invalid tuple");const e=t.map((t=>r.create(t)));return{c0:e[0],c1:e[1]}};function f(t,e){return"bigint"==typeof t&&hh<=t&&t<e}const d=e*e,h=l(t.FP2_NONRESIDUE),p={ORDER:d,isLE:r.isLE,NONRESIDUE:h,BITS:od(d),BYTES:Math.ceil(od(d)/8),MASK:ad(od(d)),ZERO:{c0:r.ZERO,c1:r.ZERO},ONE:{c0:r.ONE,c1:r.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>f(t,d)&&f(e,d),is0:({c0:t,c1:e})=>r.is0(t)&&r.is0(e),isValidNot0:t=>!p.is0(t)&&p.isValid(t),eql:({c0:t,c1:e},{c0:n,c1:i})=>r.eql(t,n)&&r.eql(e,i),neg:({c0:t,c1:e})=>({c0:r.neg(t),c1:r.neg(e)}),pow:(t,e)=>Sd(p,t,e),invertBatch:t=>Id(p,t),add:s,sub:a,mul:c,sqr:u,addN:s,subN:a,mulN:c,sqrN:u,div:(t,e)=>p.mul(t,"bigint"==typeof e?r.inv(r.create(e)):p.inv(e)),inv:({c0:t,c1:e})=>{const n=r.inv(r.create(t*t+e*e));return{c0:r.mul(n,r.create(t)),c1:r.mul(n,r.create(-e))}},sqrt:e=>{if(t.Fp2sqrt)return t.Fp2sqrt(e);const{c0:o,c1:s}=e;if(r.is0(s))return 1===Ad(r,o)?p.create({c0:r.sqrt(o),c1:r.ZERO}):p.create({c0:r.ZERO,c1:r.sqrt(r.div(o,n))});const a=r.sqrt(r.sub(r.sqr(o),r.mul(r.sqr(s),n)));let c=r.mul(r.add(a,o),i);-1===Ad(r,c)&&(c=r.sub(c,a));const u=r.sqrt(c),l=p.create({c0:u,c1:r.div(r.mul(s,i),u)});if(!p.eql(p.sqr(l),e))throw new Error("Cannot find square root");const f=l,d=p.neg(f),{re:h,im:g}=p.reim(f),{re:m,im:y}=p.reim(d);return g>y||g===y&&h>m?f:d},isOdd:t=>{const{re:e,im:r}=p.reim(t);return BigInt(e%gh||e===hh&&r%gh)==ph},fromBytes(t){if(t.length!==p.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:r.fromBytes(t.subarray(0,r.BYTES)),c1:r.fromBytes(t.subarray(r.BYTES))}},toBytes:({c0:t,c1:e})=>kf(r.toBytes(t),r.toBytes(e)),cmov:({c0:t,c1:e},{c0:n,c1:i},o)=>({c0:r.cmov(t,n,o),c1:r.cmov(e,i,o)}),reim:({c0:t,c1:e})=>({re:t,im:e}),mulByNonresidue:({c0:t,c1:e})=>p.mul({c0:t,c1:e},h),mulByB:t.Fp2mulByB,fromBigTuple:l,frobeniusMap:({c0:t,c1:e},n)=>({c0:t,c1:r.mul(e,o[n%2])})},g=({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o})=>({c0:p.add(t,n),c1:p.add(e,i),c2:p.add(r,o)}),m=({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o})=>({c0:p.sub(t,n),c1:p.sub(e,i),c2:p.sub(r,o)}),y=({c0:t,c1:e,c2:r},n)=>{if("bigint"==typeof n)return{c0:p.mul(t,n),c1:p.mul(e,n),c2:p.mul(r,n)};const{c0:i,c1:o,c2:s}=n,a=p.mul(t,i),c=p.mul(e,o),u=p.mul(r,s);return{c0:p.add(a,p.mulByNonresidue(p.sub(p.mul(p.add(e,r),p.add(o,s)),p.add(c,u)))),c1:p.add(p.sub(p.mul(p.add(t,e),p.add(i,o)),p.add(a,c)),p.mulByNonresidue(u)),c2:p.sub(p.add(c,p.mul(p.add(t,r),p.add(i,s))),p.add(a,u))}},b=({c0:t,c1:e,c2:r})=>{let n=p.sqr(t),i=p.mul(p.mul(t,e),gh),o=p.mul(p.mul(e,r),gh),s=p.sqr(r);return{c0:p.add(p.mulByNonresidue(o),n),c1:p.add(p.mulByNonresidue(s),i),c2:p.sub(p.sub(p.add(p.add(i,p.sqr(p.add(p.sub(t,e),r))),o),n),s)}},[w,v]=yh(p,h,r.ORDER,6,2,3),x={ORDER:p.ORDER,isLE:p.isLE,BITS:3*p.BITS,BYTES:3*p.BYTES,MASK:ad(3*p.BITS),ZERO:{c0:p.ZERO,c1:p.ZERO,c2:p.ZERO},ONE:{c0:p.ONE,c1:p.ZERO,c2:p.ZERO},create:t=>t,isValid:({c0:t,c1:e,c2:r})=>p.isValid(t)&&p.isValid(e)&&p.isValid(r),is0:({c0:t,c1:e,c2:r})=>p.is0(t)&&p.is0(e)&&p.is0(r),isValidNot0:t=>!x.is0(t)&&x.isValid(t),neg:({c0:t,c1:e,c2:r})=>({c0:p.neg(t),c1:p.neg(e),c2:p.neg(r)}),eql:({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o})=>p.eql(t,n)&&p.eql(e,i)&&p.eql(r,o),sqrt:ud,div:(t,e)=>x.mul(t,"bigint"==typeof e?r.inv(r.create(e)):x.inv(e)),pow:(t,e)=>Sd(x,t,e),invertBatch:t=>Id(x,t),add:g,sub:m,mul:y,sqr:b,addN:g,subN:m,mulN:y,sqrN:b,inv:({c0:t,c1:e,c2:r})=>{let n=p.sub(p.sqr(t),p.mulByNonresidue(p.mul(r,e))),i=p.sub(p.mulByNonresidue(p.sqr(r)),p.mul(t,e)),o=p.sub(p.sqr(e),p.mul(t,r)),s=p.inv(p.add(p.mulByNonresidue(p.add(p.mul(r,i),p.mul(e,o))),p.mul(t,n)));return{c0:p.mul(s,n),c1:p.mul(s,i),c2:p.mul(s,o)}},fromBytes:t=>{if(t.length!==x.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:p.fromBytes(t.subarray(0,p.BYTES)),c1:p.fromBytes(t.subarray(p.BYTES,2*p.BYTES)),c2:p.fromBytes(t.subarray(2*p.BYTES))}},toBytes:({c0:t,c1:e,c2:r})=>kf(p.toBytes(t),p.toBytes(e),p.toBytes(r)),cmov:({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:o},s)=>({c0:p.cmov(t,n,s),c1:p.cmov(e,i,s),c2:p.cmov(r,o,s)}),fromBigSix:t=>{if(!Array.isArray(t)||6!==t.length)throw new Error("invalid Fp6 usage");return{c0:p.fromBigTuple(t.slice(0,2)),c1:p.fromBigTuple(t.slice(2,4)),c2:p.fromBigTuple(t.slice(4,6))}},frobeniusMap:({c0:t,c1:e,c2:r},n)=>({c0:p.frobeniusMap(t,n),c1:p.mul(p.frobeniusMap(e,n),w[n%6]),c2:p.mul(p.frobeniusMap(r,n),v[n%6])}),mulByFp2:({c0:t,c1:e,c2:r},n)=>({c0:p.mul(t,n),c1:p.mul(e,n),c2:p.mul(r,n)}),mulByNonresidue:({c0:t,c1:e,c2:r})=>({c0:p.mulByNonresidue(r),c1:t,c2:e}),mul1:({c0:t,c1:e,c2:r},n)=>({c0:p.mulByNonresidue(p.mul(r,n)),c1:p.mul(t,n),c2:p.mul(e,n)}),mul01({c0:t,c1:e,c2:r},n,i){let o=p.mul(t,n),s=p.mul(e,i);return{c0:p.add(p.mulByNonresidue(p.sub(p.mul(p.add(e,r),i),s)),o),c1:p.sub(p.sub(p.mul(p.add(n,i),p.add(t,e)),o),s),c2:p.add(p.sub(p.mul(p.add(t,r),n),o),s)}}},E=yh(p,h,r.ORDER,12,1,6)[0],_=({c0:t,c1:e},{c0:r,c1:n})=>({c0:x.add(t,r),c1:x.add(e,n)}),B=({c0:t,c1:e},{c0:r,c1:n})=>({c0:x.sub(t,r),c1:x.sub(e,n)}),S=({c0:t,c1:e},r)=>{if("bigint"==typeof r)return{c0:x.mul(t,r),c1:x.mul(e,r)};let{c0:n,c1:i}=r,o=x.mul(t,n),s=x.mul(e,i);return{c0:x.add(o,x.mulByNonresidue(s)),c1:x.sub(x.mul(x.add(t,e),x.add(n,i)),x.add(o,s))}},I=({c0:t,c1:e})=>{let r=x.mul(t,e);return{c0:x.sub(x.sub(x.mul(x.add(x.mulByNonresidue(e),t),x.add(t,e)),r),x.mulByNonresidue(r)),c1:x.add(r,r)}},A={ORDER:p.ORDER,isLE:x.isLE,BITS:2*x.BITS,BYTES:2*x.BYTES,MASK:ad(2*x.BITS),ZERO:{c0:x.ZERO,c1:x.ZERO},ONE:{c0:x.ONE,c1:x.ZERO},create:t=>t,isValid:({c0:t,c1:e})=>x.isValid(t)&&x.isValid(e),is0:({c0:t,c1:e})=>x.is0(t)&&x.is0(e),isValidNot0:t=>!A.is0(t)&&A.isValid(t),neg:({c0:t,c1:e})=>({c0:x.neg(t),c1:x.neg(e)}),eql:({c0:t,c1:e},{c0:r,c1:n})=>x.eql(t,r)&&x.eql(e,n),sqrt:ud,inv:({c0:t,c1:e})=>{let r=x.inv(x.sub(x.sqr(t),x.mulByNonresidue(x.sqr(e))));return{c0:x.mul(t,r),c1:x.neg(x.mul(e,r))}},div:(t,e)=>A.mul(t,"bigint"==typeof e?r.inv(r.create(e)):A.inv(e)),pow:(t,e)=>Sd(A,t,e),invertBatch:t=>Id(A,t),add:_,sub:B,mul:S,sqr:I,addN:_,subN:B,mulN:S,sqrN:I,fromBytes:t=>{if(t.length!==A.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:x.fromBytes(t.subarray(0,x.BYTES)),c1:x.fromBytes(t.subarray(x.BYTES))}},toBytes:({c0:t,c1:e})=>kf(x.toBytes(t),x.toBytes(e)),cmov:({c0:t,c1:e},{c0:r,c1:n},i)=>({c0:x.cmov(t,r,i),c1:x.cmov(e,n,i)}),fromBigTwelve:t=>({c0:x.fromBigSix(t.slice(0,6)),c1:x.fromBigSix(t.slice(6,12))}),frobeniusMap(t,e){const{c0:r,c1:n,c2:i}=x.frobeniusMap(t.c1,e),o=E[e%12];return{c0:x.frobeniusMap(t.c0,e),c1:x.create({c0:p.mul(r,o),c1:p.mul(n,o),c2:p.mul(i,o)})}},mulByFp2:({c0:t,c1:e},r)=>({c0:x.mulByFp2(t,r),c1:x.mulByFp2(e,r)}),conjugate:({c0:t,c1:e})=>({c0:t,c1:x.neg(e)}),mul014:({c0:t,c1:e},r,n,i)=>{let o=x.mul01(t,r,n),s=x.mul1(e,i);return{c0:x.add(x.mulByNonresidue(s),o),c1:x.sub(x.sub(x.mul01(x.add(e,t),r,p.add(n,i)),o),s)}},mul034:({c0:t,c1:e},r,n,i)=>{const o=x.create({c0:p.mul(t.c0,r),c1:p.mul(t.c1,r),c2:p.mul(t.c2,r)}),s=x.mul01(e,n,i),a=x.mul01(x.add(t,e),p.add(r,n),i);return{c0:x.add(x.mulByNonresidue(s),o),c1:x.sub(a,x.add(o,s))}},_cyclotomicSquare:t.Fp12cyclotomicSquare,_cyclotomicExp:t.Fp12cyclotomicExp,finalExponentiate:t.Fp12finalExponentiate};return{Fp:r,Fp2:p,Fp6:x,Fp12:A,Fp4Square:function(t,e){const r=p.sqr(t),n=p.sqr(e);return{first:p.add(p.mulByNonresidue(n),r),second:p.sub(p.sub(p.sqr(p.add(t,e)),r),n)}}}}({ORDER:Sh.p,FP2_NONRESIDUE:[wh,wh],Fp2mulByB:({c0:t,c1:e})=>{const r=Ah.mul(t,Eh),n=Ah.mul(e,Eh);return{c0:Ah.sub(r,n),c1:Ah.add(r,n)}},Fp12cyclotomicSquare:({c0:t,c1:e})=>{const{c0:r,c1:n,c2:i}=t,{c0:o,c1:s,c2:a}=e,{first:c,second:u}=Oh(r,s),{first:l,second:f}=Oh(o,i),{first:d,second:h}=Oh(n,a),p=Th.mulByNonresidue(h);return{c0:Nh.create({c0:Th.add(Th.mul(Th.sub(c,r),vh),c),c1:Th.add(Th.mul(Th.sub(l,n),vh),l),c2:Th.add(Th.mul(Th.sub(d,i),vh),d)}),c1:Nh.create({c0:Th.add(Th.mul(Th.add(p,o),vh),p),c1:Th.add(Th.mul(Th.add(u,s),vh),u),c2:Th.add(Th.mul(Th.add(f,a),vh),f)})}},Fp12cyclotomicExp(t,e){let r=Rh.ONE;for(let n=Bh-1;n>=0;n--)r=Rh._cyclotomicSquare(r),sd(e,n)&&(r=Rh.mul(r,t));return r},Fp12finalExponentiate:t=>{const e=_h,r=Rh.div(Rh.frobeniusMap(t,6),t),n=Rh.mul(Rh.frobeniusMap(r,2),r),i=Rh.conjugate(Rh._cyclotomicExp(n,e)),o=Rh.mul(Rh.conjugate(Rh._cyclotomicSquare(n)),i),s=Rh.conjugate(Rh._cyclotomicExp(o,e)),a=Rh.conjugate(Rh._cyclotomicExp(s,e)),c=Rh.mul(Rh.conjugate(Rh._cyclotomicExp(a,e)),Rh._cyclotomicSquare(i)),u=Rh.conjugate(Rh._cyclotomicExp(c,e)),l=Rh.frobeniusMap(Rh.mul(i,a),2),f=Rh.frobeniusMap(Rh.mul(s,n),3),d=Rh.frobeniusMap(Rh.mul(c,Rh.conjugate(n)),1),h=Rh.mul(Rh.mul(u,Rh.conjugate(o)),n);return Rh.mul(Rh.mul(Rh.mul(l,f),d),h)}}),{G2psi:Uh,G2psi2:kh}=function(t,e,r){const n=e.pow(r,(t.ORDER-ph)/mh),i=e.pow(r,(t.ORDER-ph)/gh);function o(t,r){return[e.mul(e.frobeniusMap(t,1),n),e.mul(e.frobeniusMap(r,1),i)]}const s=e.pow(r,(t.ORDER**gh-ph)/mh),a=e.pow(r,(t.ORDER**gh-ph)/gh);if(!e.eql(a,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function c(t,r){return[e.mul(t,s),e.neg(r)]}const u=t=>(e,r)=>{const n=r.toAffine(),i=t(n.x,n.y);return e.fromAffine({x:i[0],y:i[1]})};return{psi:o,psi2:c,G2psi:u(o),G2psi2:u(c),PSI_X:n,PSI_Y:i,PSI2_X:s,PSI2_Y:a}}(Ah,Th,Th.div(Th.ONE,Th.NONRESIDUE)),Ph=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:Ah.ORDER,m:2,k:128,expand:"xmd",hash:Zf}),Ch={p:Th.ORDER,n:Sh.n,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),a:Th.ZERO,b:Th.fromBigTuple([Eh,Eh]),Gx:Th.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:Th.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")])},Dh=Fh(Ah.toBytes(bh),{infinity:!0,compressed:!0});function Lh(t){const e=224&(t=t.slice())[0],r=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return t[0]&=31,{compressed:r,infinity:n,sort:i,value:t}}function Fh(t,e){if(224&t[0])throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function jh(t){t.assertValidity();const{BYTES:e,ORDER:r}=Ah,{x:n,y:i}=t.toAffine();if(t.is0())return Dh.slice();const o=!!(i*vh/r);return Fh(ed(n,e),{compressed:!0,sort:o})}function $h(t){const{infinity:e,sort:r,value:n}=Lh(nd("signatureHex",t,48)),i=Ah.ORDER,o=Vh.G1.Point,s=Qf(n);if(e)return o.ZERO;const a=Ah.create(s&Ah.MASK),c=Ah.add(Ah.pow(a,xh),Ah.create(Sh.b));let u=Ah.sqrt(c);if(!u)throw new Error("invalid G1 point: compressed");const l=BigInt(r);u*vh/i!==l&&(u=Ah.neg(u));const f=o.fromAffine({x:a,y:u});return f.assertValidity(),f}function Mh(t){t.assertValidity();const{BYTES:e}=Ah;if(t.is0())return kf(Dh,ed(bh,e));const{x:r,y:n}=t.toAffine(),{re:i,im:o}=Th.reim(r),{re:s,im:a}=Th.reim(n),c=!!((a>bh?a*vh:s*vh)/Ah.ORDER&wh),u=i;return kf(Fh(ed(o,e),{sort:c,compressed:!0}),ed(u,e))}function qh(t){const{ORDER:e}=Ah,{infinity:r,sort:n,value:i}=Lh(nd("signatureHex",t)),o=Vh.G2.Point,s=i.length/2;if(48!==s&&96!==s)throw new Error("invalid compressed signature length, expected 96/192 bytes");const a=Qf(i.slice(0,s)),c=Qf(i.slice(s));if(r)return o.ZERO;const u=Ah.create(a&Ah.MASK),l=Ah.create(c),f=Th.create({c0:l,c1:u}),d=Th.add(Th.pow(f,xh),Ch.b);let h=Th.sqrt(d);if(!h)throw new Error("Failed to find a square root");const{re:p,im:g}=Th.reim(h),m=BigInt(n);(g>bh&&g*vh/e!==m||g===bh&&p*vh/e!==m)&&(h=Th.neg(h));const y=o.fromAffine({x:f,y:h});return y.assertValidity(),y}const Vh=function(t){const{Fp:e,Fr:r,Fp2:n,Fp6:i,Fp12:o}=t.fields,s=t.params.xNegative,a=t.params.twistType,c=ah(t.G1),u=Object.assign(c,Yd(c.Point,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),l=ah(t.G2),f=Object.assign(l,Yd(l.Point,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults}));let d;if("multiplicative"===a)d=(t,e,r,i,s,a)=>o.mul014(i,t,n.mul(e,s),n.mul(r,a));else{if("divisive"!==a)throw new Error("bls: unknown twist type");d=(t,e,r,i,s,a)=>o.mul034(i,n.mul(r,a),n.mul(e,s),t)}const h=n.div(n.ONE,n.mul(n.ONE,fh));function p(t,e,r,i){const o=n.sqr(r),s=n.sqr(i),a=n.mulByB(n.mul(s,dh)),c=n.mul(a,dh),u=n.sub(n.sub(n.sqr(n.add(r,i)),s),o),l=n.sub(a,o),f=n.mul(n.sqr(e),dh),d=n.neg(u);return t.push([l,f,d]),{Rx:e=n.mul(n.mul(n.mul(n.sub(o,c),e),r),h),Ry:r=n.sub(n.sqr(n.mul(n.add(o,c),h)),n.mul(n.sqr(a),dh)),Rz:i=n.mul(o,u)}}function g(t,e,r,i,o,s){const a=n.sub(r,n.mul(s,i)),c=n.sub(e,n.mul(o,i)),u=n.sub(n.mul(a,o),n.mul(c,s)),l=n.neg(a),f=c;t.push([u,l,f]);const d=n.sqr(c),h=n.mul(d,c),p=n.mul(d,e),g=n.add(n.sub(h,n.mul(p,fh)),n.mul(n.sqr(a),i));return{Rx:e=n.mul(c,g),Ry:r=n.sub(n.mul(n.sub(p,g),a),n.mul(h,r)),Rz:i=n.mul(i,h)}}const m=function(t){const e=[];for(;t>lh;t>>=lh)(t&lh)===uh?e.unshift(0):(t&dh)===dh?(e.unshift(-1),t+=lh):e.unshift(1);return e}(t.params.ateLoopSize),y=ld((e=>{const r=e,{x:i,y:o}=r.toAffine(),s=i,a=o,c=n.neg(o);let u=s,l=a,f=n.ONE;const d=[];for(const t of m){const e=[];({Rx:u,Ry:l,Rz:f}=p(e,u,l,f)),t&&({Rx:u,Ry:l,Rz:f}=g(e,u,l,f,s,-1===t?c:a)),d.push(e)}if(t.postPrecompute){const e=d[d.length-1];t.postPrecompute(u,l,f,s,a,g.bind(null,e))}return d}));function b(t,e=!1){let r=o.ONE;if(t.length){const e=t[0][0].length;for(let n=0;n<e;n++){r=o.sqr(r);for(const[e,i,o]of t)for(const[t,s,a]of e[n])r=d(t,s,a,r,i,o)}}return s&&(r=o.conjugate(r)),e?o.finalExponentiate(r):r}function w(t,e=!0){const r=[];Pd(u.Point,"pz",t.map((({g1:t})=>t))),Pd(f.Point,"pz",t.map((({g2:t})=>t)));for(const{g1:e,g2:n}of t){if(e.is0()||n.is0())throw new Error("pairing is not available for ZERO point");e.assertValidity(),n.assertValidity();const t=e.toAffine();r.push([y(n),t.x,t.y])}return b(r,e)}const v=t.randomBytes||Df,x={randomPrivateKey:()=>{const t=Od(r.ORDER);return function(t,e,r=!1){const n=t.length,i=Nd(e),o=Od(e);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);const s=bd(r?td(t):Qf(t),e-dd)+dd;return r?rd(s,i):ed(s,i)}(v(t),r.ORDER)},calcPairingPrecomputes:y};function E(t){if(!Array.isArray(t)||0===t.length)throw new Error("expected non-empty array")}function _(t){return t instanceof u.Point?t:u.Point.fromHex(t)}function B(e,r){function n(t){return t instanceof e.Point?t:e.Point.fromHex(t)}function i(t){return t instanceof r.Point?t:r.Point.fromHex(t)}function s(t){if(!(t instanceof r.Point))throw new Error(`expected valid message hashed to ${a?"G2":"G1"} curve`);return t}const a=r.Point.Fp.BYTES>e.Point.Fp.BYTES;return{getPublicKey:t=>e.Point.fromPrivateKey(t),sign(t,r,n){if(null!=n)throw new Error("sign() expects 2 arguments");return s(t).assertValidity(),t.multiply(e.normPrivateKeyToScalar(r))},verify(t,r,c,u){if(null!=u)throw new Error("verify() expects 3 arguments");t=i(t);const l=(c=n(c)).negate(),f=e.Point.BASE,d=s(r),h=w(a?[{g1:l,g2:d},{g1:f,g2:t}]:[{g1:d,g2:l},{g1:t,g2:f}]);return o.eql(h,o.ONE)},aggregatePublicKeys(t){E(t);const r=(t=t.map((t=>n(t)))).reduce(((t,e)=>t.add(e)),e.Point.ZERO);return r.assertValidity(),r},aggregateSignatures(t){E(t);const e=(t=t.map((t=>i(t)))).reduce(((t,e)=>t.add(e)),r.Point.ZERO);return e.assertValidity(),e},hash(t,e){mf(t);const n=e?{DST:e}:void 0;return r.hashToCurve(t,n)},Signature:a?t.G2.Signature:t.G1.ShortSignature}}const S=B(u,f),I=B(f,u),{ShortSignature:A}=t.G1,{Signature:T}=t.G2;function N(t,e){return t instanceof u.Point?t:I.hash(nd("point",t),e?.DST)}function O(t,e){return t instanceof f.Point?t:S.hash(nd("point",t),e?.DST)}return u.Point.BASE.precompute(4),{longSignatures:S,shortSignatures:I,millerLoopBatch:b,pairing:function(t,e,r=!0){return w([{g1:t,g2:e}],r)},pairingBatch:w,verifyBatch:function(t,e,r,n){if(E(e),r.length!==e.length)throw new Error("amount of public keys and messages should be equal");const i=function(t){return t instanceof f.Point?t:T.fromHex(t)}(t),s=e.map((t=>O(t,n))),a=r.map(_),c=new Map;for(let t=0;t<a.length;t++){const e=a[t],r=s[t];let n=c.get(r);void 0===n&&(n=[],c.set(r,n)),n.push(e)}const l=[];try{for(const[t,e]of c){const r=e.reduce(((t,e)=>t.add(e)));l.push({g1:r,g2:t})}return l.push({g1:u.Point.BASE.negate(),g2:i}),o.eql(w(l),o.ONE)}catch{return!1}},curves:{G1:c.Point,G2:l.Point},fields:{Fr:r,Fp:e,Fp2:n,Fp6:i,Fp12:o},params:{ateLoopSize:t.params.ateLoopSize,twistType:t.params.twistType,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:x,getPublicKey:function(t){return S.getPublicKey(t).toBytes(!0)},getPublicKeyForShortSignatures:function(t){return I.getPublicKey(t).toBytes(!0)},sign:function(t,e,r){const n=O(t,r),i=S.sign(n,e);return t instanceof f.Point?i:T.toBytes(i)},signShortSignature:function(t,e,r){const n=N(t,r),i=I.sign(n,e);return t instanceof u.Point?i:A.toBytes(i)},verify:function(t,e,r,n){const i=O(e,n);return S.verify(t,i,r)},verifyShortSignature:function(t,e,r,n){const i=N(e,n);return I.verify(t,i,r)},aggregatePublicKeys:function(t){const e=S.aggregatePublicKeys(t);return t[0]instanceof u.Point?e:e.toBytes(!0)},aggregateSignatures:function(t){const e=S.aggregateSignatures(t);return t[0]instanceof f.Point?e:T.toBytes(e)},aggregateShortSignatures:function(t){const e=I.aggregateSignatures(t);return t[0]instanceof u.Point?e:A.toBytes(e)},G1:u,G2:f,Signature:T,ShortSignature:A}}({fields:{Fp:Ah,Fp2:Th,Fp6:Nh,Fp12:Rh,Fr:Ih},G1:{...Sh,Fp:Ah,htfDefaults:{...Ph,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const r=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new t(Ah.mul(e.px,r),e.py,e.pz);return e.multiplyUnsafe(_h).negate().multiplyUnsafe(_h).equals(n)},clearCofactor:(t,e)=>e.multiplyUnsafe(_h).add(e),mapToCurve:function(t){const{x:e,y:r}=Kh(Ah.create(t[0]));return Gh(e,r)},fromBytes:function(t){const{compressed:e,infinity:r,sort:n,value:i}=Lh(t),{BYTES:o,ORDER:s}=Ah;if(48===i.length&&e){const t=Qf(i),e=Ah.create(t&Ah.MASK);if(r){if(e!==bh)throw new Error("invalid G1 point: non-empty, at infinity, with compression");return{x:bh,y:bh}}const o=Ah.add(Ah.pow(e,xh),Ah.create(Sh.b));let a=Ah.sqrt(o);if(!a)throw new Error("invalid G1 point: compressed point");return a*vh/s!==BigInt(n)&&(a=Ah.neg(a)),{x:Ah.create(e),y:Ah.create(a)}}if(96!==i.length||e)throw new Error("invalid G1 point: expected 48/96 bytes");{const t=Qf(i.subarray(0,o)),e=Qf(i.subarray(o));if(r){if(t!==bh||e!==bh)throw new Error("G1: non-empty point at infinity");return Vh.G1.Point.ZERO.toAffine()}return{x:Ah.create(t),y:Ah.create(e)}}},toBytes:function(t,e,r){const{BYTES:n,ORDER:i}=Ah,o=e.is0(),{x:s,y:a}=e.toAffine();if(r){if(o)return Dh.slice();const t=!!(a*vh/i);return Fh(ed(s,n),{compressed:!0,sort:t})}return o?kf(Uint8Array.of(64),new Uint8Array(2*n-1)):kf(ed(s,n),ed(a,n))},ShortSignature:{fromBytes:t=>(mf(t),$h(t)),fromHex:t=>$h(t),toBytes:t=>jh(t),toRawBytes:t=>jh(t),toHex:t=>Af(jh(t))}},G2:{...Ch,Fp:Th,hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...Ph},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:function(t){const{x:e,y:r}=Hh(Th.fromBigTuple(t));return zh(e,r)},isTorsionFree:(t,e)=>e.multiplyUnsafe(_h).negate().equals(Uh(t,e)),clearCofactor:(t,e)=>{const r=_h;let n=e.multiplyUnsafe(r).negate(),i=Uh(t,e),o=e.double();return o=kh(t,o),o=o.subtract(i),i=n.add(i),i=i.multiplyUnsafe(r).negate(),o=o.add(i),o=o.subtract(n),o.subtract(e)},fromBytes:function(t){const{BYTES:e,ORDER:r}=Ah,{compressed:n,infinity:i,sort:o,value:s}=Lh(t);if(!n&&!i&&o||!n&&i&&o||o&&i&&n)throw new Error("invalid encoding flag: "+(224&t[0]));const a=(t,e,r)=>Qf(t.slice(e,r));if(96===s.length&&n){if(i){if(s.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid G2 point: compressed");return{x:Th.ZERO,y:Th.ZERO}}const t=a(s,0,e),n=a(s,e,2*e),c=Th.create({c0:Ah.create(n),c1:Ah.create(t)}),u=Th.add(Th.pow(c,xh),Ch.b);let l=Th.sqrt(u);const f=l.c1===bh?l.c0*vh/r:l.c1*vh/r?wh:bh;return l=o&&f>0?l:Th.neg(l),{x:c,y:l}}if(192!==s.length||n)throw new Error("invalid G2 point: expected 96/192 bytes");{if(i){if(s.reduce(((t,e)=>0!==t?e+1:e),0)>0)throw new Error("invalid G2 point: uncompressed");return{x:Th.ZERO,y:Th.ZERO}}const t=a(s,0*e,1*e),r=a(s,1*e,2*e),n=a(s,2*e,3*e),o=a(s,3*e,4*e);return{x:Th.fromBigTuple([r,t]),y:Th.fromBigTuple([o,n])}}},toBytes:function(t,e,r){const{BYTES:n,ORDER:i}=Ah,o=e.is0(),{x:s,y:a}=e.toAffine();if(r){if(o)return kf(Dh,ed(bh,n));const t=!!(a.c1===bh?a.c0*vh/i:a.c1*vh/i);return kf(Fh(ed(s.c1,n),{compressed:!0,sort:t}),ed(s.c0,n))}{if(o)return kf(Uint8Array.of(64),new Uint8Array(4*n-1));const{re:t,im:e}=Th.reim(s),{re:r,im:i}=Th.reim(a);return kf(ed(e,n),ed(t,n),ed(i,n),ed(r,n))}},Signature:{fromBytes:t=>(mf(t),qh(t)),fromHex:t=>qh(t),toBytes:t=>Mh(t),toRawBytes:t=>Mh(t),toHex:t=>Af(Mh(t))}},params:{ateLoopSize:_h,r:Sh.n,xNegative:!0,twistType:"multiplicative"},htfDefaults:Ph,hash:Zf}),zh=Wd(Th,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map((t=>t.map((t=>Th.fromBigTuple(t.map(BigInt))))))),Gh=Wd(Ah,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map((t=>t.map((t=>BigInt(t)))))),Kh=ch(Ah,{A:Ah.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:Ah.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:Ah.create(BigInt(11))}),Hh=ch(Th,{A:Th.create({c0:Ah.create(bh),c1:Ah.create(BigInt(240))}),B:Th.create({c0:Ah.create(BigInt(1012)),c1:Ah.create(BigInt(1012))}),Z:Th.create({c0:Ah.create(BigInt(-2)),c1:Ah.create(BigInt(-1))})});const Zh=BigInt(0),Wh=BigInt(1),Yh=BigInt(2),Xh=BigInt(7),Jh=BigInt(256),Qh=BigInt(113),tp=[],ep=[],rp=[];for(let t=0,e=Wh,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],tp.push(2*(5*n+r)),ep.push((t+1)*(t+2)/2%64);let i=Zh;for(let t=0;t<7;t++)e=(e<<Wh^(e>>Xh)*Qh)%Jh,e&Yh&&(i^=Wh<<(Wh<<BigInt(t))-Wh);rp.push(i)}const np=zf(rp,!0),ip=np[0],op=np[1],sp=(t,e,r)=>r>32?((t,e,r)=>e<<r-32|t>>>64-r)(t,e,r):((t,e,r)=>t<<r|e>>>32-r)(t,e,r),ap=(t,e,r)=>r>32?((t,e,r)=>t<<r-32|e>>>64-r)(t,e,r):((t,e,r)=>e<<r|t>>>32-r)(t,e,r);class cp extends Pf{constructor(t,e,r,n=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=i,gf(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");var o;this.state=new Uint8Array(200),this.state32=(o=this.state,new Uint32Array(o.buffer,o.byteOffset,Math.floor(o.byteLength/4)))}clone(){return this._cloneInto()}keccak(){Bf(this.state32),function(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){const n=(e+8)%10,i=(e+2)%10,o=r[i],s=r[i+1],a=sp(o,s,1)^r[n],c=ap(o,s,1)^r[n+1];for(let r=0;r<50;r+=10)t[e+r]^=a,t[e+r+1]^=c}let e=t[2],i=t[3];for(let r=0;r<24;r++){const n=ep[r],o=sp(e,i,n),s=ap(e,i,n),a=tp[r];e=t[a],i=t[a+1],t[a]=o,t[a+1]=s}for(let e=0;e<50;e+=10){for(let n=0;n<10;n++)r[n]=t[e+n];for(let n=0;n<10;n++)t[e+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=ip[n],t[1]^=op[n]}vf(r)}(this.state32,this.rounds),Bf(this.state32),this.posOut=0,this.pos=0}update(t){bf(this),mf(t=Uf(t));const{blockLen:e,state:r}=this,n=t.length;for(let i=0;i<n;){const o=Math.min(e-this.pos,n-i);for(let e=0;e<o;e++)r[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:r,blockLen:n}=this;t[r]^=e,0!=(128&e)&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){bf(this,!1),mf(t),this.finish();const e=this.state,{blockLen:r}=this;for(let n=0,i=t.length;n<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-n);t.set(e.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return gf(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(wf(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,vf(this.state)}_cloneInto(t){const{blockLen:e,suffix:r,outputLen:n,rounds:i,enableXOF:o}=this;return t||(t=new cp(e,r,n,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=n,t.enableXOF=o,t.destroyed=this.destroyed,t}}var up,lp,fp;up=31,lp=136,fp=32,function(t){const e=(e,r)=>t(r).update(Uf(e)).digest(),r=t({});e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e)}(((t={})=>new cp(lp,up,void 0===t.dkLen?fp:t.dkLen,!0)));const dp=Uint8Array.from([0]),hp=Uint8Array.of();const pp=(t,e,r,n,i)=>function(t,e,r,n=32){yf(t),gf(n);const i=t.outputLen;if(n>255*i)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(n/i);void 0===r&&(r=hp);const s=new Uint8Array(o*i),a=Jd.create(t,e),c=a._cloneInto(),u=new Uint8Array(a.outputLen);for(let t=0;t<o;t++)dp[0]=t+1,c.update(0===t?hp:u).update(r).update(dp).digestInto(u),s.set(u,i*t),a._cloneInto(c);return a.destroy(),c.destroy(),vf(u,dp),s.slice(0,n)}(t,function(t,e,r){return yf(t),void 0===r&&(r=new Uint8Array(t.outputLen)),Jd(t,Uf(r),Uf(e))}(t,e,r),n,i),gp=Zf,mp=48;class yp{#t;#e;static random(){return new yp(Vh.utils.randomPrivateKey())}static deserialize(t){if(32!==t.length)throw new Error("Invalid size for transport secret key");return new yp(t)}publicKeyBytes(){return this.#e.toRawBytes(!0)}serialize(){return this.#t}constructor(t){this.#t=t;const e=Vh.G1.ProjectivePoint.fromPrivateKey(this.#t);this.#e=e}}function bp(t){let e=t.length;const r=new Uint8Array(8+e);for(let t=7;t>=0;t--)r[t]=255&e,e>>>=8;return r.set(t,8),r}class wp{#t;static deserialize(t){return new wp(Vh.G2.ProjectivePoint.fromHex(t))}deriveKey(t){if(0===t.length)return this;{const e="ic-vetkd-bls12-381-g2-context",r=this.publicKeyBytes(),n=function(t,e){const r={p:Vh.params.r,m:1,DST:e},n=Object.assign({},Vh.G2.CURVE.htfDefaults,r);return Zd(t,1,n)[0][0]}(new Uint8Array([...bp(r),...bp(t)]),e),i=Vh.G2.ProjectivePoint.BASE.multiply(n);return new wp(this.getPoint().add(i))}}publicKeyBytes(){return this.#t.toRawBytes(!0)}getPoint(){return this.#t}constructor(t){this.#t=t}}function vp(t){return"string"==typeof t?(new TextEncoder).encode(t):t}function xp(t,e,r){const n=Vh.G2.ProjectivePoint.BASE.negate(),i=Vh.fields.Fp12.ONE,o=r instanceof Vh.G1.ProjectivePoint?r:Vh.G1.ProjectivePoint.fromHex(r),s=function(t,e){const r=t.publicKeyBytes(),n=new Uint8Array([...r,...e]);return Vh.G1.ProjectivePoint.fromAffine(Vh.G1.hashToCurve(n,{DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_AUG_"}).toAffine())}(t,e),a=Vh.pairingBatch([{g1:o,g2:n},{g1:s,g2:t.getPoint()}]);return Vh.fields.Fp12.eql(a,i)}class Ep{#t;#e;signatureBytes(){return this.#e}serialize(){return this.#e}deriveSymmetricKey(t,e){return function(t,e,r){const n=new Uint8Array;return pp(gp,t,n,e,r)}(this.#e,t,e)}async asDerivedKeyMaterial(){return _p.setup(this.#e)}static deserialize(t){return new Ep(Vh.G1.ProjectivePoint.fromHex(t))}getPoint(){return this.#t}constructor(t){this.#t=t,this.#e=t.toRawBytes(!0)}}class _p{#t;constructor(t){this.#t=t}static fromCryptoKey(t){return new _p(t)}static async setup(t){const e=await globalThis.crypto.subtle.importKey("raw",t,"HKDF",!1,["deriveKey"]);return new _p(e)}getCryptoKey(){return this.#t}async deriveAesGcmCryptoKey(t){const e={name:"HKDF",hash:"SHA-256",length:256,info:vp(t),salt:new Uint8Array};return globalThis.crypto.subtle.deriveKey(e,this.#t,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async encryptMessage(t,e){const r=await this.deriveAesGcmCryptoKey(e),n=globalThis.crypto.getRandomValues(new Uint8Array(12)),i=new Uint8Array(await globalThis.crypto.subtle.encrypt({name:"AES-GCM",iv:n},r,vp(t)));return new Uint8Array([...n,...i])}async decryptMessage(t,e){if(t.length<28)throw new Error("Invalid ciphertext, too short to possibly be valid");const r=t.slice(0,12),n=t.slice(12),i=await this.deriveAesGcmCryptoKey(e);try{const t=await globalThis.crypto.subtle.decrypt({name:"AES-GCM",iv:r},i,n);return new Uint8Array(t)}catch{throw new Error("Decryption failed")}}}class Bp{#t;#e;#r;static deserialize(t){if(192!==t.length)throw new Error("Invalid EncryptedVetKey serialization");const e=Vh.G1.ProjectivePoint.fromHex(t.subarray(0,mp)),r=Vh.G2.ProjectivePoint.fromHex(t.subarray(mp,144)),n=Vh.G1.ProjectivePoint.fromHex(t.subarray(144));return new Bp(e,r,n)}decryptAndVerify(t,e,r){const n=Vh.G1.ProjectivePoint.BASE,i=Vh.G2.ProjectivePoint.BASE.negate(),o=Vh.fields.Fp12.ONE,s=Vh.pairingBatch([{g1:this.#t,g2:i},{g1:n,g2:this.#e}]);if(!Vh.fields.Fp12.eql(s,o))throw new Error("Invalid VetKey");const a=this.#r.subtract(this.#t.multiply(Vh.G1.normPrivateKeyToScalar(t.serialize())));if(xp(e,r,a))return new Ep(a);throw new Error("Invalid VetKey")}constructor(t,e,r){this.#t=t,this.#e=e,this.#r=r}}class Sp{constructor(t){this.actor=t}async encryptWithNoteKey(t,e,r){await this.fetch_note_key_if_needed(t,e);const n=await df([t.toString(),e]),i=Uint8Array.from([...r].map((t=>t.charCodeAt(0)))).buffer,o=window.crypto.getRandomValues(new Uint8Array(12)),s=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},n,i);return String.fromCharCode(...new Uint8Array(o))+String.fromCharCode(...new Uint8Array(s))}async decryptWithNoteKey(t,e,r){await this.fetch_note_key_if_needed(t,e);const n=await df([t.toString(),e]);if(r.length<13)throw new Error("wrong encoding, too short to contain iv");const i=r.slice(0,12),o=r.slice(12),s=Uint8Array.from([...i].map((t=>t.charCodeAt(0)))).buffer,a=Uint8Array.from([...o].map((t=>t.charCodeAt(0)))).buffer;let c=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:s},n,a);return String.fromCharCode(...new Uint8Array(c))}async fetch_note_key_if_needed(t,e){if(!await df([t.toString(),e])){const r=yp.random(),n=await this.actor.encrypted_symmetric_key_for_note(t,r.publicKeyBytes()),i=Bp.deserialize(Ip(n)),o=await this.actor.symmetric_key_verification_key_for_note(),s=wp.deserialize(Ip(o)),a=function(t){var e=BigInt(t).toString(16);for(;e.length<32;)e="0"+e;var r=e.length/2,n=new Uint8Array(r),i=0,o=0;for(;i<r;)n[i]=parseInt(e.slice(o,o+2),16),i+=1,o+=2;return n}(t),c=(new TextEncoder).encode(e);let u=new Uint8Array(a.length+c.length);u.set(a),u.set(c,a.length);const l=i.decryptAndVerify(r,s,u),f=await(await l.asDerivedKeyMaterial()).deriveAesGcmCryptoKey("note-key");await function(t,e,r=ff()){return r("readwrite",(r=>(r.put(e,t),uf(r.transaction))))}([t.toString(),e],f)}}}const Ip=t=>Uint8Array.from(t.match(/.{1,2}/g).map((t=>parseInt(t,16))));let Ap=0;const Tp=St([]);function Np(t,e=2e3){const r=Ap++;Tp.update((e=>[...e,Object.assign(Object.assign({},t),{id:r})])),setTimeout((()=>{Tp.update((t=>t.filter((t=>t.id!=r))))}),e)}function Op(t){Np({type:"error",message:t})}function Rp(t){Np({type:"success",message:t})}const{set:Up,subscribe:kp}=St({}),Pp={subscribe:kp,set:Up,remove:()=>{Up({})}},Cp=(t,e="")=>{const r=new URL(t);function n(){return o(e).reduce(((t,e,r)=>(":"===e[0]&&t.push({value:e.slice(1),index:r}),t)),[])}function i(){return o(r.pathname)}function o(t){return"/"===t||0===t.trim().length?[t]:("/"===t.slice(-1)&&(t=t.slice(0,-1)),"/"===t[0]&&(t=t.slice(1)),t.split("/"))}return Object.freeze({hash:r.hash,host:r.host,hostname:r.hostname,namedParams:function(){const t=i();return n().reduce(((e,r)=>(e[r.value]=t[r.index],e)),{})}(),namedParamsKeys:n().reduce(((t,e)=>(t.push(e.value),t)),[]),namedParamsValues:function(){const t=i();return n().reduce(((e,r)=>(e.push(t[r.index]),e)),[])}(),pathNames:i(),port:r.port,pathname:r.pathname,protocol:r.protocol,search:r.search,queryParams:function(){const t={};return r.searchParams.forEach(((e,r)=>{t[r]=e})),t}(),queryParamsKeys:function(){const t=[];return r.searchParams.forEach(((e,r)=>{t.push(r)})),t}(),queryParamsValues:function(){const t=[];return r.searchParams.forEach((e=>{t.push(e)})),t}()})},Dp=t=>{let e=!1;return 0===Object.keys(t).length||(t.childRoute&&0===Object.keys(t.childRoute).length?e=!0:t.childRoute&&(e=Dp(t.childRoute)),e)},Lp=(t,e)=>(e=Vp(e)).includes(":")?e.includes(t):e.startsWith(t),Fp=(t,e,r)=>{let n=!1;if(r)return{exists:e.lang&&e.lang[r]&&e.lang[r].includes(t),language:r};if(n=Lp(t,e.name),!n&&e.lang&&"object"==typeof e.lang)for(const[i,o]of Object.entries(e.lang))Lp(t,o)&&(n=!0,r=i);return{exists:n,language:r}},jp=(t="")=>{if(0===t.trim().length)return[];return $p(t).reduce(((t,e)=>(":"===e[0]&&t.push(e.slice(1)),t)),[])},$p=t=>"/"===t||0===t.trim().length?[t]:(t=Vp(t,"both")).split("/"),Mp=(t="")=>{let e;return"/"===t||0===t.trim().length?t:(e=(t=Vp(t,"lead")).split(":")[0],e=Vp(e,"trail"),e.toLowerCase())},qp=(t,e)=>{const r=e.split("/");return r.length>1&&r.forEach((function(e,r){e.length>0&&r>0&&t.shift()})),t},Vp=(t,e="lead")=>("trail"!==e&&"both"!==e||(t=t.replace(/\/$/,"")),"lead"!==e&&"both"!==e||(t=t.replace(/^\//,"")),t),zp=(t,e=null)=>e&&t.lang&&t.lang[e]?t.lang[e]:t.name,Gp=(t,e,r,n,i=!1)=>{if("/"===t||0===t.trim().length)return{result:t,language:null};let o=t,s=r.name,a=n;if(i&&(a=""),s=Vp(s),o=Vp(o),r.childRoute)return{result:t,language:a};{let t=Fp(o,r,a);t.exists&&i&&(o=zp(r,n));let c=s.split(":")[0];return c=Vp(c,"trail"),c=c.split("/"),c.shift(),c.forEach((()=>{const s=e[0];if(t=Fp(`${o}/${s}`,r,a),!s||!t.exists)return{result:o,language:t.language};o=i?zp(r,n):`${o}/${s}`,e.shift()})),{result:o,language:t.language}}},Kp=t=>{const e=t||!1;let r="";const n=(t,r)=>{if("undefined"!=typeof window){const n=(t=>{let e=[];if(t.queryParams)for(let[r,n]of Object.entries(t.queryParams))e.push(`${r}=${n}`);const r=t.hash?t.hash:"";return e.length>0?`${t.path}?${e.join("&")}${r}`:t.path+r})(t);r&&window.history.pushState({page:n},"",n),e&&i(n)}},i=t=>{"undefined"!=typeof ga&&(ga("set","page",t),ga("send","pageview"))};return Object.freeze({active:()=>r,isActive:(t,e=!1)=>{"/"!==t[0]&&(t="/"+t);let n=Cp(`http://fake.com${t}`).pathname,i=Cp(`http://fake.com${r}`).pathname;return n=Vp(n,"trail"),i=Vp(i,"trail"),e?i.includes(n):i===n},setActive:(t,e)=>{r=t.path,n(t,e)}})},Hp=(t,e)=>{const r=(t=>{const e=t;return Object.freeze({valid:()=>e&&e.guard&&"function"==typeof e.guard,redirect:()=>!e.guard(),redirectPath:()=>{let t="/";return e.redirect&&e.redirect.length>0&&(t=e.redirect),t}})})(t.onlyIf);return Object.freeze({path:()=>{let n=e;return t.redirectTo&&t.redirectTo.length>0&&(n=t.redirectTo),r.valid()&&r.redirect()&&(n=r.redirectPath()),n}})};function Zp({routes:t,currentUrl:e,routerOptions:r,convert:n}){const i=r.defaultLanguage,o=r.prefix?r.prefix.toLowerCase():"",s=function(t,e){if(e&&e.trim().length>0){const r=t.endsWith(e)?e:e+"/",n=t.replace(r,"");return Cp(n)}return Cp(t)}(e,o);let a="",c={},u=!1;function l(t,e,r,n,o){let f={};const d=function({basePath:t,basePathName:e,pathNames:r,convert:n,currentLanguage:i}){let o,s,a=i;function c(){return zp(s,a)}function u(){return Mp(c())}function l(){return Mp(o.result)}return Object.freeze({basePathSameAsLocalised:function(){return l()===u()},updatedPath:function(t){return s=t,o=Gp(e,r,s,a,n),a=n?i:o.language,o},basePathNameWithoutNamedParams:l,localisedPathName:c,localisedRouteWithoutNamedParams:u,namedPath:function(){let e=c();return e&&!e.startsWith("/")&&(e="/"+e),t?`${t}${e}`:e},pathNames:r,routeLanguage:function(){return a},routePath:function(){let e=`${t}/${l()}`;"//"===e&&(e="/"),a&&(r=qp(r,u()));const n=jp(c());return n&&n.length>0&&n.forEach((function(){r.length>0&&(e+=`/${r.shift()}`)})),e}})}({basePath:e,basePathName:r.shift().toLowerCase(),pathNames:r,convert:o,currentLanguage:n});return u=!1,t.forEach((function(t){if(d.updatedPath(t),function(t,e){const r=t.basePathSameAsLocalised();r&&(u=!0);return r||!u&&(t=>Vp(t).startsWith(":"))(e)}(d,t.name)){let e=d.routePath();if(a=Hp(t,a).path(),f.name!==e&&(f=function({route:t,routePath:e,routeLanguage:r,urlParser:n,namedPath:o}){const s=function({routeInfo:t,path:e,routeNamedParams:r,urlParser:n,namedPath:i,language:o}){const s=()=>{const t=Cp(`https://fake.com${n.pathname}`,i).namedParams;return{...r,...t}};return Object.freeze({get:()=>({name:e,component:t.component,hash:n.hash,layout:t.layout,queryParams:n.queryParams,namedParams:s(),path:e,language:o}),namedParams:s})}({routeInfo:t,urlParser:n,path:e,routeNamedParams:c,namedPath:o,language:r||i});return c=s.namedParams(),s.get()}({route:t,routePath:e,routeLanguage:d.routeLanguage(),urlParser:s,namedPath:d.namedPath()})),t.nestedRoutes&&t.nestedRoutes.length>0&&d.pathNames.length>0)f.childRoute=l(t.nestedRoutes,e,d.pathNames,d.routeLanguage(),o),f.path=f.childRoute.path,f.language=f.childRoute.language;else if(function(t,e){return t.nestedRoutes&&t.nestedRoutes.length>0&&0===e.length}(t,d.pathNames)){const r=l(t.nestedRoutes,e,["index"],d.routeLanguage(),o);r&&Object.keys(r).length>0&&(f.childRoute=r,f.language=f.childRoute.language)}}})),a&&(f.redirectTo=a),f}const f=e=>{const r=t.find((t=>"404"==t.name)),n=e||i||"";return r?{...r,language:n,path:"404"}:{name:"404",component:"",path:"404",redirectTo:"/404.html"}};return Object.freeze({findActiveRoute:function(){let e=l(t,"",s.pathNames,r.lang,n);return e&&Object.keys(e).length&&!Dp(e)?(e.path=e.path.split("?")[0],o&&(e.path=`/${o}${e.path}`)):"undefined"!=typeof window&&(e=f(r.lang)),e}})}const Wp="/404.html";let Yp,Xp=[],Jp={};const Qp=(t,e,r={})=>{Jp={...r},void 0!==e&&""!==e||(e=document.location.href),Yp=Kp(Jp.gaPageviews),e=Vp(e,"trail"),Xp=t;const n=()=>{let r=!1;return Jp.langConvertTo&&(Jp.lang=Jp.langConvertTo,r=!0),Zp({routes:t,currentUrl:e,routerOptions:Jp,convert:r}).findActiveRoute()};return Object.freeze({setActiveRoute:(t=!0)=>{const e=n();return e.redirectTo?((t,e)=>("undefined"!=typeof window&&(t===Wp?Yp.setActive({path:Wp},e):tg(t)),t))(e.redirectTo,t):(Yp.setActive(e,t),Pp.set(e),e)},findActiveRoute:n})},tg=(t,e=null,r=!0)=>(t=Vp(t,"lead"),e&&(Jp.langConvertTo=e),Qp(Xp,"http://fake.com/"+t,Jp).setActiveRoute(r));"undefined"!=typeof window&&(window.addEventListener("click",(t=>{if("a"!==t.target.localName.toLowerCase())return;if(t.metaKey||t.ctrlKey||t.shiftKey)return;const e=Jp.prefix?`/${Jp.prefix.toLowerCase()}`:"",r=t.target.pathname&&t.target.host===window.location.host,n=!(e.length>1)||t.target.pathname.startsWith(e);if(r&&n){t.preventDefault();const e=t.target.pathname+t.target.search+t.target.search+t.target.hash;"_blank"===t.target.target?window.open(e,"newTab"):tg(e)}})),window.onpopstate=function(t){let e=window.location.pathname+window.location.search+window.location.hash;tg(e,null,!1)});const eg=St({state:"initializing-auth"});function rg(){const t=l(eg);"anonymous"===t.state&&t.client.login({maxTimeToLive:BigInt(1800)*BigInt(1e9),identityProvider:"ic"===process.env.DFX_NETWORK?"https://identity.ic0.app/#authorize":"http://rdmx6-jaaaa-aaaaa-aaadq-cai.localhost:8000/#authorize",onSuccess:()=>ng(t.client)})}async function ng(t){setTimeout((()=>{try{const t=JSON.parse(window.localStorage.getItem("ic-delegation")),e=Number.parseInt(t.delegations[0].delegation.expiration,16)/1e6;setTimeout((()=>{!async function(){const t=l(eg);"initialized"===t.state&&(await t.client.logout(),eg.update((()=>({state:"anonymous",actor:Xu(),client:t.client}))),tg("/"))}()}),e-Date.now())}catch(t){console.error("Could not handle delegation expiry.")}}));try{const e=Xu({agentOptions:{identity:t.getIdentity()}});eg.update((()=>({state:"initializing-crypto",actor:e,client:t})));const r=new Sp(e);eg.update((()=>({state:"initialized",actor:e,client:t,crypto:r})))}catch(t){eg.update((()=>({state:"error",error:t.message||"An error occurred"})))}}function ig(e){let r,n;return{c(){r=S("strong"),r.textContent="Disclaimer:",n=A(" This sample dapp is intended exclusively for experimental\npurpose. You are advised not to use this dapp for storing your critical data such\nas keys or passwords.")},m(t,e){E(t,r,e),E(t,n,e)},p:t,i:t,o:t,d(t){t&&_(r),t&&_(n)}}}!async function(){const t=await af.create();await t.isAuthenticated()?ng(t):eg.update((()=>({state:"anonymous",actor:Xu(),client:t})))}();class og extends _t{constructor(t){super(),Et(this,t,null,ig,s,{})}}function sg(e){let r;return{c(){r=S("span"),R(r,"class","inline-block h-4 w-4 rounded-full mr-2 border-2 animate-spin border-b-current border-r-current border-t-transparent border-l-transparent")},m(t,e){E(t,r,e)},p:t,i:t,o:t,d(t){t&&_(r)}}}class ag extends _t{constructor(t){super(),Et(this,t,null,sg,s,{})}}function cg(e){let r;return{c(){r=S("div"),r.textContent="An error occurred.",R(r,"class","text-lg font-semibold mt-8")},m(t,e){E(t,r,e)},p:t,i:t,o:t,d(t){t&&_(r)}}}function ug(e){let r,n,i;return{c(){r=S("button"),r.textContent="Login with Internet Identity to manage synthetic datasets",R(r,"class","btn btn-primary")},m(t,o){E(t,r,o),n||(i=O(r,"click",e[1]),n=!0)},p:t,i:t,o:t,d(t){t&&_(r),n=!1,i()}}}function lg(e){let r,n,i,o;return n=new ag({}),{c(){r=S("div"),bt(n.$$.fragment),i=A("\n          Synchronizing... Please keep the app open on a device that's already added."),R(r,"class","text-lg font-semibold")},m(t,e){E(t,r,e),wt(n,r,null),w(r,i),o=!0},p:t,i(t){o||(pt(n.$$.fragment,t),o=!0)},o(t){gt(n.$$.fragment,t),o=!1},d(t){t&&_(r),vt(n)}}}function fg(e){let r,n,i,o;return n=new ag({}),{c(){r=S("div"),bt(n.$$.fragment),i=A("\n          Initializing..."),R(r,"class","text-lg font-semibold mt-8")},m(t,e){E(t,r,e),wt(n,r,null),w(r,i),o=!0},p:t,i(t){o||(pt(n.$$.fragment,t),o=!0)},o(t){gt(n.$$.fragment,t),o=!1},d(t){t&&_(r),vt(n)}}}function dg(t){let e,r,n,i,o,s,a,c,u,l,f,d,h,p,g,m,y;const b=[fg,lg,ug,cg],v=[];function x(t,e){return"initializing-auth"===t[0].state||"initializing-crypto"===t[0].state?0:"synchronizing"===t[0].state?1:"anonymous"===t[0].state?2:"error"===t[0].state?3:-1}return~(l=x(t))&&(f=v[l]=b[l](t)),p=new og({}),{c(){e=S("div"),r=S("div"),n=S("div"),i=S("h1"),i.textContent="Synthetic Data Manager",o=T(),s=S("p"),s.textContent="Secure synthetic data management platform on the Internet Computer.",a=T(),c=S("p"),c.textContent="Upload, manage, and share synthetic datasets with privacy-preserving encryption and access controls.",u=T(),f&&f.c(),d=T(),h=S("div"),bt(p.$$.fragment),g=T(),m=S("div"),m.innerHTML='<img src="/img/ic-badge-powered-by-crypto_label-stripe-white-text.png" alt="Powered by the Internet Computer" class="hidden dark:inline h-4"/> \n    <img src="/img/ic-badge-powered-by-crypto_label-stripe-dark-text.png" alt="Powered by the Internet Computer" class="dark:hidden inline h-4"/>',R(i,"class","mb-5 text-4xl sm:text-5xl font-bold text-primary dark:text-white"),R(s,"class","mb-5 text-xl font-semibold"),R(c,"class","mb-5"),R(h,"class","text-xs mt-8 sm:mt-12 opacity-75 mb-12 sm:mb-32"),R(n,"class","max-w-xl "),R(r,"class","text-center hero-content "),R(m,"class","fixed bottom-0 text-center left-0 right-0 pb-4 sm:pb-8"),R(e,"class","hero min-h-screen pt-8 sm:pt-0 content-start sm:content-center")},m(t,f){E(t,e,f),w(e,r),w(r,n),w(n,i),w(n,o),w(n,s),w(n,a),w(n,c),w(n,u),~l&&v[l].m(n,null),w(n,d),w(n,h),wt(p,h,null),w(e,g),w(e,m),y=!0},p(t,[e]){let r=l;l=x(t),l===r?~l&&v[l].p(t,e):(f&&(dt(),gt(v[r],1,1,(()=>{v[r]=null})),ht()),~l?(f=v[l],f?f.p(t,e):(f=v[l]=b[l](t),f.c()),pt(f,1),f.m(n,d)):f=null)},i(t){y||(pt(f),pt(p.$$.fragment,t),y=!0)},o(t){gt(f),gt(p.$$.fragment,t),y=!1},d(t){t&&_(e),~l&&v[l].d(),vt(p)}}}function hg(t,e,r){let{auth:n}=e;return t.$$set=t=>{"auth"in t&&r(0,n=t.auth)},[n,()=>rg()]}class pg extends _t{constructor(t){super(),Et(this,t,hg,dg,s,{auth:0})}}function gg(e){let r;return{c(){r=S("div"),r.innerHTML='<svg class="w-12 h-12 mx-auto mb-4" stroke="currentColor" fill="none" viewBox="0 0 48 48"><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg> \n          <p class="text-lg font-semibold mb-2">Drop your CSV file here</p> \n          <p class="text-sm mb-4">or click to browse</p>',R(r,"class","text-base-content/70")},m(t,e){E(t,r,e)},p:t,d(t){t&&_(r)}}}function mg(t){let e,r,n,i,o,s,a,c,u,l,f,d=t[1].split("\n").length-1+"";return{c(){e=S("div"),r=I("svg"),n=I("path"),i=I("path"),o=T(),s=S("p"),a=A(t[0]),c=T(),u=S("p"),l=A(d),f=A(" rows detected"),R(n,"d","M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"),R(i,"fill-rule","evenodd"),R(i,"d","M4 5a2 2 0 012-2v1a1 1 0 001 1h6a1 1 0 001-1V3a2 2 0 012 2v6.5a1.5 1.5 0 01-1.5 1.5h-7A1.5 1.5 0 014 11.5V5zm8 5a1 1 0 10-2 0v1.5a.5.5 0 01-.5.5h-3a.5.5 0 01-.5-.5V10a1 1 0 10-2 0v1.5A2.5 2.5 0 006.5 14h3a2.5 2.5 0 002.5-2.5V10z"),R(i,"clip-rule","evenodd"),R(r,"class","w-12 h-12 mx-auto mb-2"),R(r,"fill","currentColor"),R(r,"viewBox","0 0 20 20"),R(s,"class","font-semibold"),R(u,"class","text-sm opacity-70"),R(e,"class","text-success mb-4")},m(t,d){E(t,e,d),w(e,r),w(r,n),w(r,i),w(e,o),w(e,s),w(s,a),w(e,c),w(e,u),w(u,l),w(u,f)},p(t,e){1&e&&k(a,t[0]),2&e&&d!==(d=t[1].split("\n").length-1+"")&&k(l,d)},d(t){t&&_(e)}}}function yg(t){let e,r,n,i,o,s,a,c=t[1].split("\n").slice(0,6).join("\n")+"",u=t[1].split("\n").length>6?"\n...":"";return{c(){e=S("div"),r=S("h3"),r.textContent="Preview",n=T(),i=S("div"),o=S("pre"),s=A(c),a=A(u),R(r,"class","font-semibold mb-2"),R(o,"class","text-xs"),R(i,"class","bg-base-200 p-4 rounded-lg max-h-48 overflow-auto"),R(e,"class","mt-6")},m(t,c){E(t,e,c),w(e,r),w(e,n),w(e,i),w(i,o),w(o,s),w(o,a)},p(t,e){2&e&&c!==(c=t[1].split("\n").slice(0,6).join("\n")+"")&&k(s,c),2&e&&u!==(u=t[1].split("\n").length>6?"\n...":"")&&k(a,u)},d(t){t&&_(e)}}}function bg(t){let e;return{c(){e=A("Upload Dataset")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function wg(t){let e,r;return{c(){e=S("span"),r=A("\n          Uploading..."),R(e,"class","loading loading-spinner loading-sm")},m(t,n){E(t,e,n),E(t,r,n)},d(t){t&&_(e),t&&_(r)}}}function vg(e){let r,n,o,s,a,c,u,l,f,d,h,p,g,m,y,b,v,x,B,I,N,U,k,P,C,D;function L(t,e){return t[0]?mg:gg}let F=L(e),j=F(e),$=e[1]&&yg(e);function M(t,e){return t[2]?wg:bg}let q=M(e),V=q(e);return{c(){r=S("div"),n=S("div"),o=S("h2"),o.textContent="Upload CSV Dataset",s=T(),a=S("div"),j.c(),c=T(),u=S("input"),l=T(),f=S("button"),d=A("Browse Files"),p=T(),g=S("div"),g.textContent="OR",m=T(),y=S("div"),b=S("button"),v=A("Load Sample Employee Data"),x=T(),B=S("p"),B.textContent="Loads a sample CSV with employee information for testing",I=T(),$&&$.c(),N=T(),U=S("div"),k=S("button"),V.c(),R(o,"class","card-title mb-4"),R(u,"type","file"),R(u,"accept",".csv"),R(u,"class","hidden"),R(f,"class","btn btn-outline btn-sm"),f.disabled=e[2],R(a,"class",h="border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(e[3]?"border-primary bg-primary/10":"border-base-300")),R(g,"class","divider"),R(b,"class","btn btn-secondary btn-outline"),b.disabled=e[2],R(B,"class","text-xs text-base-content/60 mt-2"),R(y,"class","text-center"),R(k,"class","btn btn-primary"),k.disabled=P=!e[1]||e[2],R(U,"class","card-actions justify-end mt-6"),R(n,"class","card-body"),R(r,"class","card bg-base-100 shadow-xl")},m(t,i){E(t,r,i),w(r,n),w(n,o),w(n,s),w(n,a),j.m(a,null),w(a,c),w(a,u),e[11](u),w(a,l),w(a,f),w(f,d),w(n,p),w(n,g),w(n,m),w(n,y),w(y,b),w(b,v),w(y,x),w(y,B),w(n,I),$&&$.m(n,null),w(n,N),w(n,U),w(U,k),V.m(k,null),C||(D=[O(u,"change",e[5]),O(f,"click",e[12]),O(a,"drop",e[6]),O(a,"dragover",e[7]),O(a,"dragleave",e[8]),O(b,"click",e[9]),O(k,"click",e[10])],C=!0)},p(t,[e]){F===(F=L(t))&&j?j.p(t,e):(j.d(1),j=F(t),j&&(j.c(),j.m(a,c))),4&e&&(f.disabled=t[2]),8&e&&h!==(h="border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(t[3]?"border-primary bg-primary/10":"border-base-300"))&&R(a,"class",h),4&e&&(b.disabled=t[2]),t[1]?$?$.p(t,e):($=yg(t),$.c(),$.m(n,N)):$&&($.d(1),$=null),q!==(q=M(t))&&(V.d(1),V=q(t),V&&(V.c(),V.m(k,null))),6&e&&P!==(P=!t[1]||t[2])&&(k.disabled=P)},i:t,o:t,d(t){t&&_(r),j.d(),e[11](null),$&&$.d(),V.d(),C=!1,i(D)}}}function xg(t,e,r){const n=W();let i,o="",s="",a=!1,c=!1;async function u(t){r(0,o=t.name);try{r(1,s=await t.text()),Rp(`File "${o}" loaded successfully`)}catch(t){Op("Failed to read file")}}return[o,s,a,c,i,function(t){var e;const r=null===(e=t.target.files)||void 0===e?void 0:e[0];r&&u(r)},function(t){var e;t.preventDefault(),r(3,c=!1);const n=null===(e=t.dataTransfer)||void 0===e?void 0:e.files[0];n&&"text/csv"===n.type?u(n):Op("Please upload a CSV file")},function(t){t.preventDefault(),r(3,c=!0)},function(){r(3,c=!1)},function(){r(0,o="sample_employees.csv"),r(1,s="name,email,age,city,salary\nJohn Doe,john.doe@email.com,28,New York,75000\nJane Smith,jane.smith@email.com,32,Los Angeles,82000\nMike Johnson,mike.johnson@email.com,25,Chicago,68000\nSarah Wilson,sarah.wilson@email.com,29,Houston,71000\nDavid Brown,david.brown@email.com,35,Phoenix,85000"),Rp("Sample data loaded")},async function(){if(s){r(2,a=!0);try{const t=l(eg);if(!t||"initialized"!==t.state)return void Op("Authentication required");const e=s.split("\n"),a=e[0].split(",").map((t=>t.trim())),c=e.slice(1).filter((t=>t.trim())),u=await t.actor.create_note(),f=JSON.stringify({fileName:o,type:"csv_dataset",headers:a,content:s,rowCount:c.length,uploadedAt:(new Date).toISOString()});console.log(" About to update note:",u,"with data:",f),await t.actor.update_note(u,f),console.log(" Note updated successfully"),console.log("Dataset uploaded successfully:",u),Rp("Dataset uploaded successfully"),n("uploaded",{datasetId:u,fileName:o,headers:a,rowCount:c.length}),r(0,o=""),r(1,s=""),i&&r(4,i.value="",i)}catch(t){Op(`Failed to upload dataset: ${t.message}`)}finally{r(2,a=!1)}}else Op("Please select a CSV file first")},function(t){X[t?"unshift":"push"]((()=>{i=t,r(4,i)}))},()=>i?.click()]}class Eg extends _t{constructor(t){super(),Et(this,t,xg,vg,s,{})}}function _g(t,e,r){const n=t.slice();return n[5]=e[r],n}function Bg(t){let e;return{c(){e=A("Load Dataset")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function Sg(t){let e;return{c(){e=S("span"),R(e,"class","loading loading-spinner loading-xs")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function Ig(t){let e,r,n,i,o,s,a,c,u,l,f,d,h,p,g,m,y,b,v,x,B,I,N,U,k,P,C,D,L=t[5].name+"",F=t[5].description+"",j=t[5].rowCount.toLocaleString()+"",$=t[5].headers.length+"",M=t[5].headers.join(", ")+"";function q(t,e){return t[0]?Sg:Bg}let V=q(t),z=V(t);function G(){return t[3](t[5])}return{c(){e=S("div"),r=S("div"),n=S("div"),i=S("div"),o=S("h3"),s=A(L),a=T(),c=S("p"),u=A(F),l=T(),f=S("div"),d=S("div"),h=A(j),p=A(" rows"),g=T(),m=S("div"),y=A($),b=A(" columns"),v=T(),x=S("div"),B=S("strong"),B.textContent="Columns:",I=T(),N=A(M),U=T(),k=S("button"),z.c(),P=T(),R(o,"class","font-semibold text-lg"),R(c,"class","text-sm text-base-content/70 mb-3"),R(d,"class","badge badge-outline badge-sm"),R(m,"class","badge badge-outline badge-sm"),R(f,"class","flex flex-wrap gap-2 mb-3"),R(x,"class","text-xs text-base-content/60"),R(i,"class","flex-1"),R(k,"class","btn btn-primary btn-sm ml-4"),k.disabled=t[0],R(n,"class","flex justify-between items-start"),R(r,"class","card-body p-4"),R(e,"class","card bg-base-200 shadow-sm")},m(t,_){E(t,e,_),w(e,r),w(r,n),w(n,i),w(i,o),w(o,s),w(i,a),w(i,c),w(c,u),w(i,l),w(i,f),w(f,d),w(d,h),w(d,p),w(f,g),w(f,m),w(m,y),w(m,b),w(i,v),w(i,x),w(x,B),w(x,I),w(x,N),w(n,U),w(n,k),z.m(k,null),w(e,P),C||(D=O(k,"click",G),C=!0)},p(e,r){V!==(V=q(t=e))&&(z.d(1),z=V(t),z&&(z.c(),z.m(k,null))),1&r&&(k.disabled=t[0])},d(t){t&&_(e),z.d(),C=!1,D()}}}function Ag(e){let r,n,i,o,s,a,c,u,l,f=e[1],d=[];for(let t=0;t<f.length;t+=1)d[t]=Ig(_g(e,f,t));return{c(){r=S("div"),n=S("div"),i=S("h2"),i.textContent="Load Sample Datasets",o=T(),s=S("p"),s.textContent="Choose from pre-configured synthetic datasets to explore the platform features",a=T(),c=S("div");for(let t=0;t<d.length;t+=1)d[t].c();u=T(),l=S("div"),l.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> \n      <div><h3 class="font-bold">About Sample Data</h3> \n        <div class="text-sm">All sample datasets contain synthetic data generated for demonstration purposes. \n          Sensitive fields are pre-masked for privacy compliance.</div></div>',R(i,"class","card-title mb-4"),R(s,"class","text-base-content/70 mb-6"),R(c,"class","grid gap-4"),R(l,"class","alert alert-info mt-6"),R(n,"class","card-body"),R(r,"class","card bg-base-100 shadow-xl")},m(t,e){E(t,r,e),w(r,n),w(n,i),w(n,o),w(n,s),w(n,a),w(n,c);for(let t=0;t<d.length;t+=1)d[t]&&d[t].m(c,null);w(n,u),w(n,l)},p(t,[e]){if(7&e){let r;for(f=t[1],r=0;r<f.length;r+=1){const n=_g(t,f,r);d[r]?d[r].p(n,e):(d[r]=Ig(n),d[r].c(),d[r].m(c,null))}for(;r<d.length;r+=1)d[r].d(1);d.length=f.length}},i:t,o:t,d(t){t&&_(r),B(d,t)}}}function Tg(t,e,r){const n=W();let i=!1;async function o(t){r(0,i=!0);try{const e=l(eg);if(!e||"initialized"!==e.state)return void Op("Authentication required");const r=await e.actor.create_note(),i=JSON.stringify({fileName:`${t.name.toLowerCase().replace(/\s+/g,"_")}.csv`,type:"synthetic_dataset",headers:t.headers,content:t.data,rowCount:t.rowCount,uploadedAt:(new Date).toISOString(),sampleDataset:!0,description:t.description});await e.actor.update_note(r,i),console.log("Sample dataset loaded successfully:",r),Rp(`Sample dataset "${t.name}" loaded successfully`),n("loaded",{datasetId:r,fileName:`${t.name.toLowerCase().replace(/\s+/g,"_")}.csv`,headers:t.headers,rowCount:t.rowCount})}catch(t){Op(`Failed to load sample dataset: ${t.message}`)}finally{r(0,i=!1)}}return[i,[{name:"Customer Demographics",description:"Synthetic customer data with demographics and purchasing behavior",headers:["customer_id","name","email","age","city","income","segment"],rowCount:1e3,data:"customer_id,name,email,age,city,income,segment\n1001,Alice Johnson,alice.j@email.com,32,Seattle,75000,Premium\n1002,Bob Smith,bob.smith@email.com,28,Portland,52000,Standard\n1003,Carol Davis,carol.d@email.com,45,San Francisco,95000,Premium\n1004,David Wilson,david.w@email.com,35,Los Angeles,68000,Standard\n1005,Emma Brown,emma.b@email.com,29,Denver,71000,Standard"},{name:"Financial Transactions",description:"Synthetic financial transaction data with privacy masking",headers:["transaction_id","account_id","amount","category","date","merchant"],rowCount:2500,data:"transaction_id,account_id,amount,category,date,merchant\nTXN001,ACC****1234,125.50,Groceries,2024-01-15,SafeWay Store\nTXN002,ACC****5678,45.00,Gas,2024-01-15,Shell Station\nTXN003,ACC****9012,89.99,Electronics,2024-01-16,Best Buy\nTXN004,ACC****3456,12.75,Coffee,2024-01-16,Starbucks\nTXN005,ACC****7890,250.00,Utilities,2024-01-17,City Power"},{name:"Healthcare Records",description:"De-identified patient data for research purposes",headers:["patient_id","age_group","condition","treatment","outcome","region"],rowCount:750,data:"patient_id,age_group,condition,treatment,outcome,region\nP****001,25-35,Hypertension,Medication A,Improved,North\nP****002,45-55,Diabetes,Insulin,Stable,South\nP****003,35-45,Asthma,Inhaler,Improved,East\nP****004,55-65,Arthritis,Physical Therapy,Stable,West\nP****005,25-35,Migraine,Medication B,Improved,North"},{name:"Medical Synthetic Demo",description:"Optimized medical dataset for synthetic data generation testing",headers:["id","age","gender","diagnosis","treatment","outcome","date"],rowCount:100,data:"id,age,gender,diagnosis,treatment,outcome,date\nMED001,34,F,ICD_1050,TX_150,Improved,2024-01-15\nMED002,67,M,ICD_1120,TX_200,Stable,2024-01-16\nMED003,45,F,ICD_1075,TX_175,Improved,2024-01-17\nMED004,29,M,ICD_1200,TX_125,Stable,2024-01-18\nMED005,52,F,ICD_1300,TX_250,Improved,2024-01-19\nMED006,38,M,ICD_1150,TX_180,Stable,2024-01-20\nMED007,61,F,ICD_1400,TX_220,Improved,2024-01-21\nMED008,43,M,ICD_1250,TX_160,Stable,2024-01-22\nMED009,36,F,ICD_1350,TX_190,Improved,2024-01-23\nMED010,55,M,ICD_1180,TX_210,Stable,2024-01-24"},{name:"IoT Sensor Data",description:"Synthetic sensor readings from smart devices",headers:["device_id","timestamp","temperature","humidity","location","status"],rowCount:5e3,data:"device_id,timestamp,temperature,humidity,location,status\nDEV001,2024-01-15T08:00:00Z,22.5,45,Building A Floor 1,Normal\nDEV002,2024-01-15T08:00:00Z,21.8,48,Building A Floor 2,Normal\nDEV003,2024-01-15T08:00:00Z,23.1,42,Building B Floor 1,Normal\nDEV004,2024-01-15T08:00:00Z,20.9,51,Building B Floor 2,Alert\nDEV005,2024-01-15T08:00:00Z,22.3,46,Building C Floor 1,Normal"}],o,t=>o(t)]}class Ng extends _t{constructor(t){super(),Et(this,t,Tg,Ag,s,{})}}function Og(t,e,r){const n=t.slice();return n[16]=e[r],n}function Rg(t,e,r){const n=t.slice();return n[19]=e[r],n}function Ug(t,e,r){const n=t.slice();return n[19]=e[r],n}function kg(e){let r,n,i=e[19]+"";return{c(){r=S("option"),n=A(i),r.__value=e[19],r.value=r.__value},m(t,e){E(t,r,e),w(r,n)},p:t,d(t){t&&_(r)}}}function Pg(e){let r,n,i=e[19]+"";return{c(){r=S("option"),n=A(i),r.__value=e[19],r.value=r.__value},m(t,e){E(t,r,e),w(r,n)},p:t,d(t){t&&_(r)}}}function Cg(t){let e,r=t[0],n=[];for(let e=0;e<r.length;e+=1)n[e]=Fg(Og(t,r,e));return{c(){e=S("div");for(let t=0;t<n.length;t+=1)n[t].c();R(e,"class","space-y-3 max-h-96 overflow-y-auto")},m(t,r){E(t,e,r);for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,null)},p(t,i){if(1&i){let o;for(r=t[0],o=0;o<r.length;o+=1){const s=Og(t,r,o);n[o]?n[o].p(s,i):(n[o]=Fg(s),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=r.length}},d(t){t&&_(e),B(n,t)}}}function Dg(e){let r;return{c(){r=S("div"),r.textContent="No memories found. Add some memories to get started!",R(r,"class","text-center text-gray-500 py-8")},m(t,e){E(t,r,e)},p:t,d(t){t&&_(r)}}}function Lg(e){let r;return{c(){r=S("div"),r.innerHTML='<span class="loading loading-spinner loading-md"></span>',R(r,"class","flex justify-center items-center h-32")},m(t,e){E(t,r,e)},p:t,d(t){t&&_(r)}}}function Fg(t){let e,r,n,i,o,s,a,c,u,l,f,d,h,p,g,m,y,b,v,x,B,I,N,O,U=t[16].memory_type+"",P=qg(t[16].importance_score)+"",C=t[16].importance_score+"",D=$g(t[16].created_at)+"",L=t[16].decrypted_content+"",F=t[16].id+"";return{c(){e=S("div"),r=S("div"),n=S("div"),i=S("div"),o=S("div"),s=A(U),a=T(),c=S("div"),u=A(P),l=A(" ("),f=A(C),d=A(")"),p=T(),g=S("div"),m=A(D),y=T(),b=S("div"),v=A(L),x=T(),B=S("div"),I=A("ID: "),N=A(F),O=T(),R(o,"class","badge badge-outline text-xs"),R(c,"class",h="badge "+Mg(t[16].importance_score)+" text-xs"),R(i,"class","flex gap-2 items-center"),R(g,"class","text-xs opacity-60"),R(n,"class","flex justify-between items-start mb-2"),R(b,"class","text-sm"),R(B,"class","text-xs opacity-50 mt-2"),R(r,"class","card-body p-4"),R(e,"class","card bg-base-200 shadow-sm")},m(t,h){E(t,e,h),w(e,r),w(r,n),w(n,i),w(i,o),w(o,s),w(i,a),w(i,c),w(c,u),w(c,l),w(c,f),w(c,d),w(n,p),w(n,g),w(g,m),w(r,y),w(r,b),w(b,v),w(r,x),w(r,B),w(B,I),w(B,N),w(e,O)},p(t,e){1&e&&U!==(U=t[16].memory_type+"")&&k(s,U),1&e&&P!==(P=qg(t[16].importance_score)+"")&&k(u,P),1&e&&C!==(C=t[16].importance_score+"")&&k(f,C),1&e&&h!==(h="badge "+Mg(t[16].importance_score)+" text-xs")&&R(c,"class",h),1&e&&D!==(D=$g(t[16].created_at)+"")&&k(m,D),1&e&&L!==(L=t[16].decrypted_content+"")&&k(v,L),1&e&&F!==(F=t[16].id+"")&&k(N,F)},d(t){t&&_(e)}}}function jg(e){let r,n,o,s,a,c,u,l,f,d,h,p,g,m,y,b,v,x,I,N,U,C,L,j,$,M,q,V,z,G,K,H,Z,W,Y,X,J,Q,tt,et,nt,it,ot=e[7],st=[];for(let t=0;t<ot.length;t+=1)st[t]=kg(Ug(e,ot,t));let at=e[7],ct=[];for(let t=0;t<at.length;t+=1)ct[t]=Pg(Rg(e,at,t));function ut(t,e){return t[1]?Lg:0===t[0].length?Dg:Cg}let lt=ut(e),ft=lt(e);return{c(){r=S("div"),n=S("div"),o=S("h3"),o.textContent="Agent Memories",s=T(),a=S("div"),c=S("select"),u=S("option"),u.textContent="All Types";for(let t=0;t<st.length;t+=1)st[t].c();l=T(),f=S("button"),f.textContent="Refresh",d=T(),h=S("div"),p=S("input"),g=T(),m=S("div"),m.textContent="Add New Memory",y=T(),b=S("div"),v=S("div"),x=S("div"),I=S("label"),I.textContent="Type",N=T(),U=S("select");for(let t=0;t<ct.length;t+=1)ct[t].c();C=T(),L=S("div"),j=S("label"),j.textContent="Importance (0-100)",$=T(),M=S("input"),q=T(),V=S("div"),z=A(e[6]),G=T(),K=S("div"),H=S("label"),H.textContent="Action",Z=T(),W=S("button"),Y=A("Add Memory"),J=T(),Q=S("div"),tt=S("textarea"),et=T(),ft.c(),R(o,"class","card-title"),u.__value="",u.value=u.__value,R(c,"class","select select-bordered select-sm"),void 0===e[3]&&rt((()=>e[12].call(c))),R(f,"class","btn btn-sm btn-outline"),R(a,"class","flex gap-2 mb-4"),R(p,"type","checkbox"),R(m,"class","collapse-title text-sm font-medium"),R(I,"class","label label-text text-xs"),R(U,"class","select select-bordered select-sm"),void 0===e[4]&&rt((()=>e[13].call(U))),R(x,"class","form-control"),R(j,"class","label label-text text-xs"),R(M,"type","range"),R(M,"min","0"),R(M,"max","100"),R(M,"class","range range-sm"),R(V,"class","text-xs text-center"),R(L,"class","form-control"),R(H,"class","label label-text text-xs"),R(W,"class","btn btn-primary btn-sm"),W.disabled=X=e[2]||!e[5].trim(),F(W,"loading",e[2]),R(K,"class","form-control"),R(v,"class","grid grid-cols-1 md:grid-cols-3 gap-4 mt-2"),R(tt,"class","textarea textarea-bordered textarea-sm"),R(tt,"placeholder","Enter memory content..."),tt.disabled=e[2],R(Q,"class","form-control mt-2"),R(b,"class","collapse-content"),R(h,"class","collapse collapse-arrow bg-base-200 mb-4"),R(n,"class","card-body"),R(r,"class","card bg-base-100 shadow-xl")},m(t,i){E(t,r,i),w(r,n),w(n,o),w(n,s),w(n,a),w(a,c),w(c,u);for(let t=0;t<st.length;t+=1)st[t]&&st[t].m(c,null);D(c,e[3],!0),w(a,l),w(a,f),w(n,d),w(n,h),w(h,p),w(h,g),w(h,m),w(h,y),w(h,b),w(b,v),w(v,x),w(x,I),w(x,N),w(x,U);for(let t=0;t<ct.length;t+=1)ct[t]&&ct[t].m(U,null);D(U,e[4],!0),w(v,C),w(v,L),w(L,j),w(L,$),w(L,M),P(M,e[6]),w(L,q),w(L,V),w(V,z),w(v,G),w(v,K),w(K,H),w(K,Z),w(K,W),w(W,Y),w(b,J),w(b,Q),w(Q,tt),P(tt,e[5]),w(n,et),ft.m(n,null),nt||(it=[O(c,"change",e[12]),O(c,"change",e[10]),O(f,"click",e[8]),O(U,"change",e[13]),O(M,"change",e[14]),O(M,"input",e[14]),O(W,"click",e[9]),O(tt,"input",e[15])],nt=!0)},p(t,[e]){if(128&e){let r;for(ot=t[7],r=0;r<ot.length;r+=1){const n=Ug(t,ot,r);st[r]?st[r].p(n,e):(st[r]=kg(n),st[r].c(),st[r].m(c,null))}for(;r<st.length;r+=1)st[r].d(1);st.length=ot.length}if(136&e&&D(c,t[3]),128&e){let r;for(at=t[7],r=0;r<at.length;r+=1){const n=Rg(t,at,r);ct[r]?ct[r].p(n,e):(ct[r]=Pg(n),ct[r].c(),ct[r].m(U,null))}for(;r<ct.length;r+=1)ct[r].d(1);ct.length=at.length}144&e&&D(U,t[4]),64&e&&P(M,t[6]),64&e&&k(z,t[6]),36&e&&X!==(X=t[2]||!t[5].trim())&&(W.disabled=X),4&e&&F(W,"loading",t[2]),4&e&&(tt.disabled=t[2]),32&e&&P(tt,t[5]),lt===(lt=ut(t))&&ft?ft.p(t,e):(ft.d(1),ft=lt(t),ft&&(ft.c(),ft.m(n,null)))},i:t,o:t,d(t){t&&_(r),B(st,t),B(ct,t),ft.d(),nt=!1,i(it)}}}function $g(t){return new Date(Number(t)/1e6).toLocaleString()}function Mg(t){return t>=80?"badge-error":t>=60?"badge-warning":t>=40?"badge-info":"badge-ghost"}function qg(t){return t>=80?"Critical":t>=60?"High":t>=40?"Medium":"Low"}function Vg(t,e,r){let{passportId:n}=e,i=[],o=!0,s=!1,a="",c="conversation",u="",l=50;const f=["conversation","preference","skill","context","goal","instruction","feedback","error"];async function d(){r(1,o=!0);try{const t=eg;if("initialized"!==t.state)return void Op("Authentication required");const e=await t.actor.get_agent_memories(n,a?[a]:[]);r(0,i=e);for(let e of i)try{e.decrypted_content=await t.crypto.decryptWithNoteKey(BigInt(e.id),e.owner,e.encrypted_content)}catch(t){console.warn("Could not decrypt memory:",t),e.decrypted_content="[Encrypted]"}i.sort(((t,e)=>t.importance_score!==e.importance_score?e.importance_score-t.importance_score:Number(e.created_at)-Number(t.created_at)))}catch(t){Op(`Failed to load memories: ${t.message}`)}finally{r(1,o=!1)}}return Z((async()=>{await d()})),t.$$set=t=>{"passportId"in t&&r(11,n=t.passportId)},[i,o,s,a,c,u,l,f,d,async function(){if(u.trim()){r(2,s=!0);try{const t=eg;if("initialized"!==t.state)return void Op("Authentication required");const e=await t.crypto.encryptWithNoteKey(BigInt(Date.now()),t.actor.getPrincipal().toString(),u);Rp(`Memory added successfully! ID: ${await t.actor.add_agent_memory(n,c,e,l)}`),r(5,u=""),r(6,l=50),await d()}catch(t){Op(`Failed to add memory: ${t.message}`)}finally{r(2,s=!1)}}else Op("Memory content is required")},async function(){await d()},n,function(){a=L(this),r(3,a),r(7,f)},function(){c=L(this),r(4,c),r(7,f)},function(){l=U(this.value),r(6,l)},function(){u=this.value,r(5,u)}]}class zg extends _t{constructor(t){super(),Et(this,t,Vg,jg,s,{passportId:11})}}function Gg(t,e,r){const n=t.slice();return n[6]=e[r],n}function Kg(t,e,r){const n=t.slice();return n[9]=e[r],n}function Hg(e){let r;return{c(){r=S("div"),r.innerHTML="<span>Passport not found or access denied</span>",R(r,"class","alert alert-error")},m(t,e){E(t,r,e)},p:t,i:t,o:t,d(t){t&&_(r)}}}function Zg(t){let e,r,n,o,s,a,c,u,l,f,d,h,p,g,m,y,b,v,x,I,U,P,C,D,L,F,j,$,M,q,V,z,G,K,H,Z,W,Y,X,J,Q,tt,et,rt,nt,it,ot,st,at,ct,ut,lt,ft,mt,yt,bt,wt,vt,xt,Et,_t,Bt,St,It,At,Tt=t[1].agent_name+"",Nt=t[1].is_active?"Available":"Archived",Ot=t[1].agent_type+"",Rt=t[1].owner+"",Ut=t[1].owner+"",kt=new Date(Number(t[1].created_at)/1e6).toLocaleString()+"",Pt=rm(t[1].last_active)+"",Ct=t[3]?"Hide":"Show",Dt=t[1].capabilities,Lt=[];for(let e=0;e<Dt.length;e+=1)Lt[e]=Yg(Kg(t,Dt,e));let Ft=t[1].api_endpoints&&t[1].api_endpoints.length>0&&Xg(t),jt=t[1].decrypted_specifications&&Qg(t),$t=t[3]&&tm(t);return{c(){e=S("div"),r=S("div"),n=S("div"),o=S("h1"),s=A(Tt),a=T(),c=S("div"),u=S("p"),l=S("strong"),l.textContent="Status:",f=T(),d=A(Nt),p=T(),g=S("p"),m=S("strong"),m.textContent="Type:",y=T(),b=A(Ot),v=T(),x=S("div"),I=S("div"),U=S("h3"),U.textContent="Passport ID",P=T(),C=S("p"),D=S("strong"),D.textContent="Owner:",L=T(),F=A(Rt),j=T(),$=S("div"),M=S("h3"),M.textContent="Owner",q=T(),V=S("p"),z=A(Ut),G=T(),K=S("div"),H=S("h3"),H.textContent="Created",Z=T(),W=S("p"),Y=S("strong"),Y.textContent="Created:",X=T(),J=A(kt),Q=T(),tt=S("div"),et=S("h3"),et.textContent="Last Active",rt=T(),nt=S("p"),it=A(Pt),ot=T(),st=S("div"),at=S("h3"),at.textContent="Columns",ct=T(),ut=S("div");for(let t=0;t<Lt.length;t+=1)Lt[t].c();lt=T(),Ft&&Ft.c(),ft=T(),jt&&jt.c(),mt=T(),yt=S("div"),bt=S("button"),wt=A(Ct),vt=A(" Memories"),xt=T(),Et=S("button"),Et.textContent="Refresh",_t=T(),$t&&$t.c(),Bt=N(),R(o,"class","text-3xl font-bold mb-6"),R(c,"class",h="badge "+nm(t[1].is_active)),R(n,"class","flex justify-between items-start"),R(U,"class","font-semibold text-sm opacity-70"),R(M,"class","font-semibold text-sm opacity-70"),R(V,"class","font-mono text-xs break-all"),R(H,"class","font-semibold text-sm opacity-70"),R(et,"class","font-semibold text-sm opacity-70"),R(nt,"class","text-sm"),R(x,"class","grid grid-cols-1 md:grid-cols-2 gap-4 mt-4"),R(at,"class","text-lg font-semibold mb-2"),R(ut,"class","flex flex-wrap gap-2"),R(st,"class","mt-4"),R(bt,"class","btn btn-outline"),R(Et,"class","btn btn-primary"),R(yt,"class","card-actions justify-end mt-6"),R(r,"class","card-body"),R(e,"class","card bg-base-100 shadow-xl")},m(i,h){E(i,e,h),w(e,r),w(r,n),w(n,o),w(o,s),w(n,a),w(n,c),w(c,u),w(u,l),w(u,f),w(u,d),w(n,p),w(n,g),w(g,m),w(g,y),w(g,b),w(r,v),w(r,x),w(x,I),w(I,U),w(I,P),w(I,C),w(C,D),w(C,L),w(C,F),w(x,j),w(x,$),w($,M),w($,q),w($,V),w(V,z),w(x,G),w(x,K),w(K,H),w(K,Z),w(K,W),w(W,Y),w(W,X),w(W,J),w(x,Q),w(x,tt),w(tt,et),w(tt,rt),w(tt,nt),w(nt,it),w(r,ot),w(r,st),w(st,at),w(st,ct),w(st,ut);for(let t=0;t<Lt.length;t+=1)Lt[t]&&Lt[t].m(ut,null);w(r,lt),Ft&&Ft.m(r,null),w(r,ft),jt&&jt.m(r,null),w(r,mt),w(r,yt),w(yt,bt),w(bt,wt),w(bt,vt),w(yt,xt),w(yt,Et),E(i,_t,h),$t&&$t.m(i,h),E(i,Bt,h),St=!0,It||(At=[O(bt,"click",t[5]),O(Et,"click",t[4])],It=!0)},p(t,e){if((!St||2&e)&&Tt!==(Tt=t[1].agent_name+"")&&k(s,Tt),(!St||2&e)&&Nt!==(Nt=t[1].is_active?"Available":"Archived")&&k(d,Nt),(!St||2&e&&h!==(h="badge "+nm(t[1].is_active)))&&R(c,"class",h),(!St||2&e)&&Ot!==(Ot=t[1].agent_type+"")&&k(b,Ot),(!St||2&e)&&Rt!==(Rt=t[1].owner+"")&&k(F,Rt),(!St||2&e)&&Ut!==(Ut=t[1].owner+"")&&k(z,Ut),(!St||2&e)&&kt!==(kt=new Date(Number(t[1].created_at)/1e6).toLocaleString()+"")&&k(J,kt),(!St||2&e)&&Pt!==(Pt=rm(t[1].last_active)+"")&&k(it,Pt),2&e){let r;for(Dt=t[1].capabilities,r=0;r<Dt.length;r+=1){const n=Kg(t,Dt,r);Lt[r]?Lt[r].p(n,e):(Lt[r]=Yg(n),Lt[r].c(),Lt[r].m(ut,null))}for(;r<Lt.length;r+=1)Lt[r].d(1);Lt.length=Dt.length}t[1].api_endpoints&&t[1].api_endpoints.length>0?Ft?Ft.p(t,e):(Ft=Xg(t),Ft.c(),Ft.m(r,ft)):Ft&&(Ft.d(1),Ft=null),t[1].decrypted_specifications?jt?jt.p(t,e):(jt=Qg(t),jt.c(),jt.m(r,mt)):jt&&(jt.d(1),jt=null),(!St||8&e)&&Ct!==(Ct=t[3]?"Hide":"Show")&&k(wt,Ct),t[3]?$t?($t.p(t,e),8&e&&pt($t,1)):($t=tm(t),$t.c(),pt($t,1),$t.m(Bt.parentNode,Bt)):$t&&(dt(),gt($t,1,1,(()=>{$t=null})),ht())},i(t){St||(pt($t),St=!0)},o(t){gt($t),St=!1},d(t){t&&_(e),B(Lt,t),Ft&&Ft.d(),jt&&jt.d(),t&&_(_t),$t&&$t.d(t),t&&_(Bt),It=!1,i(At)}}}function Wg(e){let r;return{c(){r=S("div"),r.innerHTML='<span class="loading loading-spinner loading-lg"></span>',R(r,"class","flex justify-center items-center h-64")},m(t,e){E(t,r,e)},p:t,i:t,o:t,d(t){t&&_(r)}}}function Yg(t){let e,r,n=t[9]+"";return{c(){e=S("span"),r=A(n),R(e,"class","badge badge-primary")},m(t,n){E(t,e,n),w(e,r)},p(t,e){2&e&&n!==(n=t[9]+"")&&k(r,n)},d(t){t&&_(e)}}}function Xg(t){let e,r,n,i,o=t[1].api_endpoints,s=[];for(let e=0;e<o.length;e+=1)s[e]=Jg(Gg(t,o,e));return{c(){e=S("div"),r=S("h3"),r.textContent="Data Access",n=T(),i=S("div");for(let t=0;t<s.length;t+=1)s[t].c();R(r,"class","text-lg font-semibold mb-2"),R(i,"class","flex flex-wrap gap-2"),R(e,"class","mt-4")},m(t,o){E(t,e,o),w(e,r),w(e,n),w(e,i);for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(i,null)},p(t,e){if(2&e){let r;for(o=t[1].api_endpoints,r=0;r<o.length;r+=1){const n=Gg(t,o,r);s[r]?s[r].p(n,e):(s[r]=Jg(n),s[r].c(),s[r].m(i,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=o.length}},d(t){t&&_(e),B(s,t)}}}function Jg(t){let e,r,n=t[6]+"";return{c(){e=S("div"),r=A(n),R(e,"class","badge badge-secondary")},m(t,n){E(t,e,n),w(e,r)},p(t,e){2&e&&n!==(n=t[6]+"")&&k(r,n)},d(t){t&&_(e)}}}function Qg(t){let e,r,n,i,o,s=t[1].encrypted_specifications+"";return{c(){e=S("div"),r=S("h3"),r.textContent="Dataset Content",n=T(),i=S("div"),o=A(s),R(r,"class","text-lg font-semibold mb-2"),R(i,"class","bg-base-200 p-4 rounded-lg font-mono text-sm whitespace-pre-wrap"),R(e,"class","mt-4")},m(t,s){E(t,e,s),w(e,r),w(e,n),w(e,i),w(i,o)},p(t,e){2&e&&s!==(s=t[1].encrypted_specifications+"")&&k(o,s)},d(t){t&&_(e)}}}function tm(t){let e,r,n;return r=new zg({props:{passportId:t[0]}}),{c(){e=S("div"),bt(r.$$.fragment),R(e,"class","mt-6")},m(t,i){E(t,e,i),wt(r,e,null),n=!0},p(t,e){const n={};1&e&&(n.passportId=t[0]),r.$set(n)},i(t){n||(pt(r.$$.fragment,t),n=!0)},o(t){gt(r.$$.fragment,t),n=!1},d(t){t&&_(e),vt(r)}}}function em(t){let e,r,n,i;const o=[Wg,Zg,Hg],s=[];function a(t,e){return t[2]?0:t[1]?1:2}return e=a(t),r=s[e]=o[e](t),{c(){r.c(),n=N()},m(t,r){s[e].m(t,r),E(t,n,r),i=!0},p(t,[i]){let c=e;e=a(t),e===c?s[e].p(t,i):(dt(),gt(s[c],1,1,(()=>{s[c]=null})),ht(),r=s[e],r?r.p(t,i):(r=s[e]=o[e](t),r.c()),pt(r,1),r.m(n.parentNode,n))},i(t){i||(pt(r),i=!0)},o(t){gt(r),i=!1},d(t){s[e].d(t),t&&_(n)}}}function rm(t){return new Date(Number(t)/1e6).toLocaleString()}function nm(t){return t?"badge-success":"badge-error"}function im(t,e,r){let{syntheticId:n}=e,i=null,o=!0,s=!1;async function a(){r(2,o=!0);try{const t=l(eg);if(console.log(" SyntheticViewer - Loading synthetic data details..."),!t||"initialized"!==t.state)return console.error("Error loading synthetic data:",null==t?void 0:t.state),void Op("Authentication required");const e=(await t.actor.get_notes()).find((t=>t.id===n));if(e)try{const t=JSON.parse(e.encrypted_text);r(1,i={id:e.id,agent_name:t.fileName||"Unknown Dataset",agent_type:t.type||"dataset",owner:e.owner,capabilities:t.headers||[],created_at:BigInt(1e6*new Date(t.uploadedAt||Date.now()).getTime()),last_active:BigInt(1e6*new Date(t.uploadedAt||Date.now()).getTime()),is_active:!0,encrypted_specifications:t.content||"",decrypted_specifications:t.content||"",api_endpoints:[],rowCount:t.rowCount||0,sampleDataset:t.sampleDataset||!1,description:t.description||""})}catch(t){console.error("Failed to parse dataset:",t),Op("Failed to load dataset details")}}catch(t){console.error("Failed to load synthetic data:",t.message),Op("Failed to load synthetic data")}finally{r(2,o=!1)}}Z((()=>{const t=l(eg);if(t&&"initialized"===t.state)a();else{const t=eg.subscribe((e=>{e&&"initialized"===e.state&&(a(),t())}))}}));return t.$$set=t=>{"syntheticId"in t&&r(0,n=t.syntheticId)},[n,i,o,s,a,()=>r(3,s=!s)]}class om extends _t{constructor(t){super(),Et(this,t,im,em,s,{syntheticId:0})}}function sm(t,e,r){const n=t.slice();return n[7]=e[r],n}function am(t,e,r){const n=t.slice();return n[10]=e[r],n}function cm(e){let r,n,i,o,s,a,c,u;function l(t,e){return t[1]?dm:0===t[0].length?fm:lm}let f=l(e),d=f(e);return{c(){r=S("div"),n=S("h2"),n.textContent="My Synthetic Datasets",i=T(),o=S("button"),o.textContent="Refresh",s=T(),d.c(),a=N(),R(n,"class","text-xl font-bold"),R(o,"class","btn btn-sm btn-outline"),R(r,"class","flex justify-between items-center")},m(t,l){E(t,r,l),w(r,n),w(r,i),w(r,o),E(t,s,l),d.m(t,l),E(t,a,l),c||(u=O(o,"click",e[3]),c=!0)},p(t,e){f===(f=l(t))&&d?d.p(t,e):(d.d(1),d=f(t),d&&(d.c(),d.m(a.parentNode,a)))},i:t,o:t,d(t){t&&_(r),t&&_(s),d.d(t),t&&_(a),c=!1,u()}}}function um(t){let e,r,n,i,o,s,a,c,u;return s=new om({props:{syntheticId:t[2]}}),{c(){e=S("div"),r=S("button"),r.textContent=" Back to List",n=T(),i=S("h2"),i.textContent="Dataset Details",o=T(),bt(s.$$.fragment),R(r,"class","btn btn-sm btn-outline"),R(i,"class","text-lg font-semibold"),R(e,"class","flex items-center gap-2 mb-4")},m(l,f){E(l,e,f),w(e,r),w(e,n),w(e,i),E(l,o,f),wt(s,l,f),a=!0,c||(u=O(r,"click",t[5]),c=!0)},p(t,e){const r={};4&e&&(r.syntheticId=t[2]),s.$set(r)},i(t){a||(pt(s.$$.fragment,t),a=!0)},o(t){gt(s.$$.fragment,t),a=!1},d(t){t&&_(e),t&&_(o),vt(s,t),c=!1,u()}}}function lm(t){let e,r=t[0],n=[];for(let e=0;e<r.length;e+=1)n[e]=gm(sm(t,r,e));return{c(){e=S("div");for(let t=0;t<n.length;t+=1)n[t].c();R(e,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4")},m(t,r){E(t,e,r);for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,null)},p(t,i){if(17&i){let o;for(r=t[0],o=0;o<r.length;o+=1){const s=sm(t,r,o);n[o]?n[o].p(s,i):(n[o]=gm(s),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=r.length}},d(t){t&&_(e),B(n,t)}}}function fm(e){let r;return{c(){r=S("div"),r.innerHTML='<div class="text-gray-500 mb-4"><svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17H7A5 5 0 0 1 7 7h2m0 10v3a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-3m0 0V7a1 1 0 0 0-1-1H10a1 1 0 0 0-1 1v10z"></path></svg> \n          <p class="text-lg">No datasets found</p> \n          <p class="text-sm">Upload your first CSV or load sample data to get started!</p></div>',R(r,"class","text-center py-12")},m(t,e){E(t,r,e)},p:t,d(t){t&&_(r)}}}function dm(e){let r;return{c(){r=S("div"),r.innerHTML='<span class="loading loading-spinner loading-lg"></span>',R(r,"class","flex justify-center items-center h-64")},m(t,e){E(t,r,e)},p:t,d(t){t&&_(r)}}}function hm(t){let e,r,n=t[10]+"";return{c(){e=S("div"),r=A(n),R(e,"class","badge badge-primary badge-xs")},m(t,n){E(t,e,n),w(e,r)},p(t,e){1&e&&n!==(n=t[10]+"")&&k(r,n)},d(t){t&&_(e)}}}function pm(t){let e,r,n,i,o=t[7].capabilities.length-3+"";return{c(){e=S("div"),r=A("+"),n=A(o),i=A(" more"),R(e,"class","badge badge-ghost badge-xs")},m(t,o){E(t,e,o),w(e,r),w(e,n),w(e,i)},p(t,e){1&e&&o!==(o=t[7].capabilities.length-3+"")&&k(n,o)},d(t){t&&_(e)}}}function gm(t){let e,r,n,i,o,s,a,c,u,l,f,d,h,p,g,m,y,b,v,x,I,N,U,P,C,D,L,F,j,$,M,q=ym(t[7].agent_type)+"",V=t[7].agent_name+"",z=t[7].is_active?"Available":"Archived",G=bm(t[7].agent_type)+"",K=t[7].capabilities.length+"",H=wm(t[7].created_at)+"",Z=t[7].capabilities.slice(0,3),W=[];for(let e=0;e<Z.length;e+=1)W[e]=hm(am(t,Z,e));let Y=t[7].capabilities.length>3&&pm(t);function X(){return t[6](t[7])}return{c(){e=S("div"),r=S("div"),n=S("div"),i=S("div"),o=S("span"),s=A(q),a=T(),c=S("h3"),u=A(V),l=T(),f=S("div"),d=A(z),p=T(),g=S("div"),m=S("div"),y=A(G),b=T(),v=S("div"),x=A("Columns: "),I=A(K),N=A(" | Created: "),U=A(H),P=T(),C=S("div");for(let t=0;t<W.length;t+=1)W[t].c();D=T(),Y&&Y.c(),L=T(),F=S("div"),F.innerHTML='<button class="btn btn-primary btn-sm">View Dataset</button>',j=T(),R(o,"class","text-2xl"),R(c,"class","card-title text-lg"),R(i,"class","flex items-center gap-2"),R(f,"class",h="badge "+vm(t[7].is_active)+" text-xs"),R(n,"class","flex justify-between items-start mb-2"),R(m,"class","badge badge-outline"),R(v,"class","text-sm opacity-70"),R(C,"class","flex flex-wrap gap-1 mt-2"),R(g,"class","space-y-2"),R(F,"class","card-actions justify-end mt-4"),R(r,"class","card-body p-4"),R(e,"class","card bg-base-100 shadow-lg hover:shadow-xl transition-shadow cursor-pointer")},m(t,h){E(t,e,h),w(e,r),w(r,n),w(n,i),w(i,o),w(o,s),w(i,a),w(i,c),w(c,u),w(n,l),w(n,f),w(f,d),w(r,p),w(r,g),w(g,m),w(m,y),w(g,b),w(g,v),w(v,x),w(v,I),w(v,N),w(v,U),w(g,P),w(g,C);for(let t=0;t<W.length;t+=1)W[t]&&W[t].m(C,null);w(C,D),Y&&Y.m(C,null),w(r,L),w(r,F),w(e,j),$||(M=O(e,"click",X),$=!0)},p(e,r){if(t=e,1&r&&q!==(q=ym(t[7].agent_type)+"")&&k(s,q),1&r&&V!==(V=t[7].agent_name+"")&&k(u,V),1&r&&z!==(z=t[7].is_active?"Available":"Archived")&&k(d,z),1&r&&h!==(h="badge "+vm(t[7].is_active)+" text-xs")&&R(f,"class",h),1&r&&G!==(G=bm(t[7].agent_type)+"")&&k(y,G),1&r&&K!==(K=t[7].capabilities.length+"")&&k(I,K),1&r&&H!==(H=wm(t[7].created_at)+"")&&k(U,H),1&r){let e;for(Z=t[7].capabilities.slice(0,3),e=0;e<Z.length;e+=1){const n=am(t,Z,e);W[e]?W[e].p(n,r):(W[e]=hm(n),W[e].c(),W[e].m(C,D))}for(;e<W.length;e+=1)W[e].d(1);W.length=Z.length}t[7].capabilities.length>3?Y?Y.p(t,r):(Y=pm(t),Y.c(),Y.m(C,null)):Y&&(Y.d(1),Y=null)},d(t){t&&_(e),B(W,t),Y&&Y.d(),$=!1,M()}}}function mm(t){let e,r,n,i;const o=[um,cm],s=[];function a(t,e){return t[2]?0:1}return r=a(t),n=s[r]=o[r](t),{c(){e=S("div"),n.c(),R(e,"class","space-y-4")},m(t,n){E(t,e,n),s[r].m(e,null),i=!0},p(t,[i]){let c=r;r=a(t),r===c?s[r].p(t,i):(dt(),gt(s[c],1,1,(()=>{s[c]=null})),ht(),n=s[r],n?n.p(t,i):(n=s[r]=o[r](t),n.c()),pt(n,1),n.m(e,null))},i(t){i||(pt(n),i=!0)},o(t){gt(n),i=!1},d(t){t&&_(e),s[r].d()}}}function ym(t){switch(t){case"csv_dataset":return"";case"synthetic_dataset":return"";default:return""}}function bm(t){switch(t){case"csv_dataset":return"CSV Dataset";case"synthetic_dataset":return"Synthetic Data";default:return"Dataset"}}function wm(t){return new Date(Number(t)/1e6).toLocaleDateString()}function vm(t){return t?"badge-success":"badge-error"}function xm(t,e,r){let n=[],i=!0,o=null;async function s(){var t;r(1,i=!0);try{const e=l(eg);if(console.log(" SyntheticList - Loading datasets..."),!e||"initialized"!==e.state)return console.error("Error loading datasets:",null==e?void 0:e.state),void Op("Authentication required");const i=await e.actor.get_notes(),o=[];console.log(" Raw notes from backend:",i),console.log(" Total notes found:",i.length);for(const e of i)if(console.log(" Processing note:",e.id,"Content length:",(null===(t=e.encrypted_text)||void 0===t?void 0:t.length)||0,"Content:",e.encrypted_text),e.encrypted_text&&""!==e.encrypted_text.trim()&&"temp"!==e.encrypted_text)try{const t=JSON.parse(e.encrypted_text);console.log(" Parsed dataset info:",t),(t.fileName||t.type)&&o.push({id:e.id,agent_name:t.fileName||"Unknown Dataset",agent_type:t.type||"dataset",owner:e.owner,capabilities:t.headers||[],created_at:BigInt(1e6*new Date(t.uploadedAt||Date.now()).getTime()),last_active:BigInt(1e6*new Date(t.uploadedAt||Date.now()).getTime()),is_active:!0,rowCount:t.rowCount||0,sampleDataset:t.sampleDataset||!1})}catch(t){console.warn("Failed to parse dataset:",t,"Content:",e.encrypted_text)}else console.warn("Skipping empty or temp note:",e.id);r(0,n=o),console.log(" Datasets loaded:",n.length)}catch(t){console.error("Error loading datasets:",t),Op("Failed to load datasets")}finally{r(1,i=!1)}}function a(t){r(2,o=t)}Z((()=>{const t=l(eg);if(t&&"initialized"===t.state)s();else{const t=eg.subscribe((e=>{e&&"initialized"===e.state&&(s(),t())}))}}));return[n,i,o,s,a,()=>r(2,o=null),t=>a(t.id)]}class Em extends _t{constructor(t){super(),Et(this,t,xm,mm,s,{})}}function _m(t,e,r){const n=t.slice();return n[26]=e[r],n}function Bm(t,e,r){const n=t.slice();return n[29]=e[r],n}function Sm(t,e,r){const n=t.slice();return n[32]=e[r],n}function Im(t){let e,r,n,o,s,a,c,u,l,f,d,h,p,g,m,y,b,v,x,I,N,C,L,F,j,$,M,q,V,z,G,K,H=t[10].find(t[18])?.description+"",Z=t[0],W=[];for(let e=0;e<Z.length;e+=1)W[e]=Am(Sm(t,Z,e));let Y=t[9],X=[];for(let e=0;e<Y.length;e+=1)X[e]=Tm(Bm(t,Y,e));let J=t[10],Q=[];for(let e=0;e<J.length;e+=1)Q[e]=Nm(_m(t,J,e));return{c(){e=S("div"),r=S("div"),n=S("label"),n.textContent="Select Source Dataset",o=T(),s=S("select"),a=S("option"),a.textContent="Choose a dataset...";for(let t=0;t<W.length;t+=1)W[t].c();c=T(),u=S("div"),l=S("label"),l.textContent="Generation Model",f=T(),d=S("div");for(let t=0;t<X.length;t+=1)X[t].c();h=T(),p=S("div"),g=S("div"),m=S("label"),m.textContent="Number of Records",y=T(),b=S("input"),v=T(),x=S("div"),I=S("label"),I.textContent="Privacy Level",N=T(),C=S("select");for(let t=0;t<Q.length;t+=1)Q[t].c();L=T(),F=S("p"),j=A(H),$=T(),M=S("div"),q=S("button"),V=A(" Generate Synthetic Data"),R(n,"class","block text-sm font-medium text-gray-700 mb-3"),a.__value="",a.value=a.__value,R(s,"class","w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"),void 0===t[1]&&rt((()=>t[14].call(s))),R(l,"class","block text-sm font-medium text-gray-700 mb-3"),R(d,"class","grid grid-cols-1 md:grid-cols-3 gap-4"),R(m,"class","block text-sm font-medium text-gray-700 mb-2"),R(b,"type","number"),R(b,"min","100"),R(b,"max","10000"),R(b,"step","100"),R(b,"class","w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"),R(I,"class","block text-sm font-medium text-gray-700 mb-2"),R(C,"class","w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"),void 0===t[4]&&rt((()=>t[17].call(C))),R(F,"class","text-sm text-gray-500 mt-1"),R(p,"class","grid grid-cols-1 md:grid-cols-2 gap-6"),q.disabled=z=!t[1],R(q,"class","px-8 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white font-semibold rounded-lg shadow-lg hover:from-green-600 hover:to-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200"),R(M,"class","text-center"),R(e,"class","bg-white rounded-xl shadow-lg p-6 space-y-6")},m(i,_){E(i,e,_),w(e,r),w(r,n),w(r,o),w(r,s),w(s,a);for(let t=0;t<W.length;t+=1)W[t]&&W[t].m(s,null);D(s,t[1],!0),w(e,c),w(e,u),w(u,l),w(u,f),w(u,d);for(let t=0;t<X.length;t+=1)X[t]&&X[t].m(d,null);w(e,h),w(e,p),w(p,g),w(g,m),w(g,y),w(g,b),P(b,t[3]),w(p,v),w(p,x),w(x,I),w(x,N),w(x,C);for(let t=0;t<Q.length;t+=1)Q[t]&&Q[t].m(C,null);D(C,t[4],!0),w(x,L),w(x,F),w(F,j),w(e,$),w(e,M),w(M,q),w(q,V),G||(K=[O(s,"change",t[14]),O(b,"input",t[16]),O(C,"change",t[17]),O(q,"click",t[11])],G=!0)},p(t,e){if(1&e[0]){let r;for(Z=t[0],r=0;r<Z.length;r+=1){const n=Sm(t,Z,r);W[r]?W[r].p(n,e):(W[r]=Am(n),W[r].c(),W[r].m(s,null))}for(;r<W.length;r+=1)W[r].d(1);W.length=Z.length}if(3&e[0]&&D(s,t[1]),516&e[0]){let r;for(Y=t[9],r=0;r<Y.length;r+=1){const n=Bm(t,Y,r);X[r]?X[r].p(n,e):(X[r]=Tm(n),X[r].c(),X[r].m(d,null))}for(;r<X.length;r+=1)X[r].d(1);X.length=Y.length}if(8&e[0]&&U(b.value)!==t[3]&&P(b,t[3]),1024&e[0]){let r;for(J=t[10],r=0;r<J.length;r+=1){const n=_m(t,J,r);Q[r]?Q[r].p(n,e):(Q[r]=Nm(n),Q[r].c(),Q[r].m(C,null))}for(;r<Q.length;r+=1)Q[r].d(1);Q.length=J.length}1040&e[0]&&D(C,t[4]),16&e[0]&&H!==(H=t[10].find(t[18])?.description+"")&&k(j,H),3&e[0]&&z!==(z=!t[1])&&(q.disabled=z)},d(t){t&&_(e),B(W,t),B(X,t),B(Q,t),G=!1,i(K)}}}function Am(t){let e,r,n,i,o,s,a,c=t[32].id+"",u=new Date(Number(t[32].id)/1e6).toLocaleDateString()+"";return{c(){e=S("option"),r=A("Dataset "),n=A(c),i=A(" ("),o=A(u),s=A(")"),e.__value=a=t[32].id,e.value=e.__value},m(t,a){E(t,e,a),w(e,r),w(e,n),w(e,i),w(e,o),w(e,s)},p(t,r){1&r[0]&&c!==(c=t[32].id+"")&&k(n,c),1&r[0]&&u!==(u=new Date(Number(t[32].id)/1e6).toLocaleDateString()+"")&&k(o,u),1&r[0]&&a!==(a=t[32].id)&&(e.__value=a,e.value=e.__value)},d(t){t&&_(e)}}}function Tm(t){let e,r,n,i,o,s,a,c,u,l,f,d,h,p,g,m,y,b=t[29].icon+"",v=t[29].name+"",x=t[29].description+"",B=t[29].estimatedTime+"";function I(){return t[15](t[29])}return{c(){e=S("div"),r=S("div"),n=A(b),i=T(),o=S("h3"),s=A(v),a=T(),c=S("p"),u=A(x),l=T(),f=S("p"),d=A(" "),h=A(B),p=T(),R(r,"class","text-2xl mb-2"),R(o,"class","font-semibold text-gray-900"),R(c,"class","text-sm text-gray-600 mb-2"),R(f,"class","text-xs text-gray-500"),R(e,"class",g="p-4 border-2 rounded-lg cursor-pointer transition-all "+(t[2]===t[29].id?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"))},m(t,g){E(t,e,g),w(e,r),w(r,n),w(e,i),w(e,o),w(o,s),w(e,a),w(e,c),w(c,u),w(e,l),w(e,f),w(f,d),w(f,h),w(e,p),m||(y=O(e,"click",I),m=!0)},p(r,n){t=r,4&n[0]&&g!==(g="p-4 border-2 rounded-lg cursor-pointer transition-all "+(t[2]===t[29].id?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"))&&R(e,"class",g)},d(t){t&&_(e),m=!1,y()}}}function Nm(e){let r,n,i=e[26].name+"";return{c(){r=S("option"),n=A(i),r.__value=e[26].id,r.value=r.__value},m(t,e){E(t,r,e),w(r,n)},p:t,d(t){t&&_(r)}}}function Om(t){let e,r,n,i,o,s,a,c,u,l,f,d,h,p,g,m,y,b,v,x,B,I,N,U,P,D,L,F,j,$,M,q,V,z,G,K,H,Z,W,Y,X,J,Q,tt,et,rt,nt=t[9].find(t[19])?.name+"",it=Math.round(t[6])+"";return{c(){e=S("div"),r=S("div"),n=S("h2"),n.textContent="Generating Synthetic Data",i=T(),o=S("p"),s=A("Using "),a=A(nt),c=A(" model"),u=T(),l=S("div"),f=S("div"),d=S("span"),h=A(t[7]),p=T(),g=S("span"),m=A(it),y=A("%"),b=T(),v=S("div"),x=S("div"),B=T(),I=S("div"),N=S("div"),U=S("div"),P=A(t[3]),D=T(),L=S("div"),L.textContent="Records",F=T(),j=S("div"),$=S("div"),M=A(t[2]),q=T(),V=S("div"),V.textContent="Model",z=T(),G=S("div"),K=S("div"),H=A(t[4]),Z=T(),W=S("div"),W.textContent="Privacy",Y=T(),X=S("div"),X.innerHTML='<div class="text-2xl font-bold text-orange-600">~60s</div> \n          <div class="text-sm text-gray-600">Duration</div>',J=T(),Q=S("div"),tt=S("button"),tt.textContent="Cancel Generation",R(n,"class","text-2xl font-bold text-gray-900 mb-2"),R(o,"class","text-gray-600"),R(r,"class","text-center mb-8"),R(f,"class","flex justify-between text-sm text-gray-600 mb-2"),R(x,"class","bg-gradient-to-r from-green-400 to-green-500 h-3 rounded-full transition-all duration-300 ease-out"),C(x,"width",t[6]+"%"),R(v,"class","w-full bg-gray-200 rounded-full h-3"),R(l,"class","mb-6"),R(U,"class","text-2xl font-bold text-green-600"),R(L,"class","text-sm text-gray-600"),R(N,"class","p-3 bg-gray-50 rounded-lg"),R($,"class","text-2xl font-bold text-blue-600"),R(V,"class","text-sm text-gray-600"),R(j,"class","p-3 bg-gray-50 rounded-lg"),R(K,"class","text-2xl font-bold text-purple-600"),R(W,"class","text-sm text-gray-600"),R(G,"class","p-3 bg-gray-50 rounded-lg"),R(X,"class","p-3 bg-gray-50 rounded-lg"),R(I,"class","grid grid-cols-2 md:grid-cols-4 gap-4 text-center"),R(tt,"class","px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"),R(Q,"class","text-center mt-6"),R(e,"class","bg-white rounded-xl shadow-lg p-8")},m(_,S){E(_,e,S),w(e,r),w(r,n),w(r,i),w(r,o),w(o,s),w(o,a),w(o,c),w(e,u),w(e,l),w(l,f),w(f,d),w(d,h),w(f,p),w(f,g),w(g,m),w(g,y),w(l,b),w(l,v),w(v,x),w(e,B),w(e,I),w(I,N),w(N,U),w(U,P),w(N,D),w(N,L),w(I,F),w(I,j),w(j,$),w($,M),w(j,q),w(j,V),w(I,z),w(I,G),w(G,K),w(K,H),w(G,Z),w(G,W),w(I,Y),w(I,X),w(e,J),w(e,Q),w(Q,tt),et||(rt=O(tt,"click",t[13]),et=!0)},p(t,e){4&e[0]&&nt!==(nt=t[9].find(t[19])?.name+"")&&k(a,nt),128&e[0]&&k(h,t[7]),64&e[0]&&it!==(it=Math.round(t[6])+"")&&k(m,it),64&e[0]&&C(x,"width",t[6]+"%"),8&e[0]&&k(P,t[3]),4&e[0]&&k(M,t[2]),16&e[0]&&k(H,t[4])},d(t){t&&_(e),et=!1,rt()}}}function Rm(t){let e,r,n,o,s,a,c,u,l,f,d,h,p,g,m,y,b,v,x,B,I,N,U,P,C,D,L,F,j,$,M,q,V,z,G,K,H,Z,W,Y,X,J,Q,tt,et,rt,nt,it,ot,st,at,ct,ut,lt=t[8].records+"",ft=t[8].qualityScore+"",dt=t[8].privacyLevel+"",ht=t[8].name+"",pt=t[9].find(t[20])?.name+"",gt=new Date(t[8].createdAt).toLocaleString()+"",mt=t[8].id+"";return{c(){e=S("div"),r=S("div"),r.innerHTML='<div class="text-6xl mb-4"></div> \n        <h2 class="text-2xl font-bold text-gray-900 mb-2">Synthetic Data Generated Successfully!</h2> \n        <p class="text-gray-600">Your privacy-preserving synthetic dataset is ready</p>',n=T(),o=S("div"),s=S("div"),a=S("div"),c=A(lt),u=T(),l=S("div"),l.textContent="Synthetic Records",f=T(),d=S("div"),h=S("div"),p=A(ft),g=A("%"),m=T(),y=S("div"),y.textContent="Quality Score",b=T(),v=S("div"),x=S("div"),B=A(dt),I=T(),N=S("div"),N.textContent="Privacy Level",U=T(),P=S("div"),C=S("h3"),C.textContent="Dataset Information",D=T(),L=S("div"),F=S("div"),j=S("span"),j.textContent="Name:",$=T(),M=A(ht),q=T(),V=S("div"),z=S("span"),z.textContent="Model:",G=T(),K=A(pt),H=T(),Z=S("div"),W=S("span"),W.textContent="Created:",Y=T(),X=A(gt),J=T(),Q=S("div"),tt=S("span"),tt.textContent="ID:",et=T(),rt=A(mt),nt=T(),it=S("div"),ot=S("button"),ot.textContent=" Download CSV",st=T(),at=S("button"),at.textContent=" Generate Another",R(r,"class","text-center mb-6"),R(a,"class","text-3xl font-bold text-green-600"),R(l,"class","text-sm text-gray-600"),R(s,"class","text-center p-4 bg-green-50 rounded-lg"),R(h,"class","text-3xl font-bold text-blue-600"),R(y,"class","text-sm text-gray-600"),R(d,"class","text-center p-4 bg-blue-50 rounded-lg"),R(x,"class","text-3xl font-bold text-purple-600"),R(N,"class","text-sm text-gray-600"),R(v,"class","text-center p-4 bg-purple-50 rounded-lg"),R(o,"class","grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"),R(C,"class","font-semibold text-gray-900 mb-2"),R(j,"class","font-medium"),R(z,"class","font-medium"),R(W,"class","font-medium"),R(tt,"class","font-medium"),R(L,"class","grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"),R(P,"class","bg-gray-50 rounded-lg p-4 mb-6"),R(ot,"class","px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white font-semibold rounded-lg shadow-lg hover:from-green-600 hover:to-green-700 transition-all duration-200"),R(at,"class","px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"),R(it,"class","flex flex-col sm:flex-row gap-4 justify-center"),R(e,"class","bg-white rounded-xl shadow-lg p-8")},m(i,_){E(i,e,_),w(e,r),w(e,n),w(e,o),w(o,s),w(s,a),w(a,c),w(s,u),w(s,l),w(o,f),w(o,d),w(d,h),w(h,p),w(h,g),w(d,m),w(d,y),w(o,b),w(o,v),w(v,x),w(x,B),w(v,I),w(v,N),w(e,U),w(e,P),w(P,C),w(P,D),w(P,L),w(L,F),w(F,j),w(F,$),w(F,M),w(L,q),w(L,V),w(V,z),w(V,G),w(V,K),w(L,H),w(L,Z),w(Z,W),w(Z,Y),w(Z,X),w(L,J),w(L,Q),w(Q,tt),w(Q,et),w(Q,rt),w(e,nt),w(e,it),w(it,ot),w(it,st),w(it,at),ct||(ut=[O(ot,"click",t[12]),O(at,"click",t[13])],ct=!0)},p(t,e){256&e[0]&&lt!==(lt=t[8].records+"")&&k(c,lt),256&e[0]&&ft!==(ft=t[8].qualityScore+"")&&k(p,ft),256&e[0]&&dt!==(dt=t[8].privacyLevel+"")&&k(B,dt),256&e[0]&&ht!==(ht=t[8].name+"")&&k(M,ht),256&e[0]&&pt!==(pt=t[9].find(t[20])?.name+"")&&k(K,pt),256&e[0]&&gt!==(gt=new Date(t[8].createdAt).toLocaleString()+"")&&k(X,gt),256&e[0]&&mt!==(mt=t[8].id+"")&&k(rt,mt)},d(t){t&&_(e),ct=!1,i(ut)}}}function Um(e){let r,n,i,o,s,a=!e[5]&&!e[8]&&Im(e),c=e[5]&&Om(e),u=e[8]&&Rm(e);return{c(){r=S("div"),n=S("div"),n.innerHTML='<h1 class="text-3xl font-bold text-gray-900 mb-2">Generate Synthetic Data</h1> \n    <p class="text-gray-600">Create privacy-preserving synthetic datasets from your uploaded data</p>',i=T(),a&&a.c(),o=T(),c&&c.c(),s=T(),u&&u.c(),R(n,"class","text-center"),R(r,"class","max-w-6xl mx-auto p-6 space-y-8")},m(t,e){E(t,r,e),w(r,n),w(r,i),a&&a.m(r,null),w(r,o),c&&c.m(r,null),w(r,s),u&&u.m(r,null)},p(t,e){t[5]||t[8]?a&&(a.d(1),a=null):a?a.p(t,e):(a=Im(t),a.c(),a.m(r,o)),t[5]?c?c.p(t,e):(c=Om(t),c.c(),c.m(r,s)):c&&(c.d(1),c=null),t[8]?u?u.p(t,e):(u=Rm(t),u.c(),u.m(r,null)):u&&(u.d(1),u=null)},i:t,o:t,d(t){t&&_(r),a&&a.d(),c&&c.d(),u&&u.d()}}}function km(t,e,r){let n;f(t,eg,(t=>r(22,n=t)));let i=[],o="",s="statistical",a=1e3,c="medium",u=!1,l=0,d="",h="",p=null;const g=[{id:"low",name:"Low Privacy",description:"Minimal anonymization, preserves most patterns"},{id:"medium",name:"Medium Privacy",description:"Balanced privacy and utility"},{id:"high",name:"High Privacy",description:"Maximum anonymization with differential privacy"}],m=["Analyzing dataset structure...","Detecting PII and sensitive data...","Calculating statistical distributions...","Generating correlation matrix...","Applying privacy transformations...","Creating synthetic records...","Validating data quality...","Finalizing synthetic dataset..."];async function y(t,e,n){const i=Date.now(),o=e-t;return new Promise((s=>{const a=()=>{const c=Date.now()-i,u=Math.min(c/n,1),f=2*Math.sin(c/1e3);r(6,l=t+o*u+f),r(6,l=Math.max(0,Math.min(100,l))),u<1?requestAnimationFrame(a):(r(6,l=e),s(null))};a()}))}Z((async()=>{await async function(){try{if(null==n?void 0:n.actor){const t=await n.actor.get_notes();r(0,i=t.filter((t=>t.encrypted_text.includes("csv")||t.encrypted_text.includes(","))))}}catch(t){console.error("Failed to load datasets:",t)}}()}));return[i,o,s,a,c,u,l,d,p,[{id:"statistical",name:"Statistical Model",description:"Fast generation using statistical sampling and correlation preservation",icon:"",estimatedTime:"30-60 seconds"},{id:"medical_gpt",name:"Medical GPT",description:"AI-powered generation optimized for medical data with HIPAA compliance",icon:"",estimatedTime:"1-2 minutes"},{id:"deep_learning",name:"Deep Learning",description:"Advanced neural network for complex data relationships",icon:"",estimatedTime:"2-3 minutes"}],g,async function(){if(o){r(5,u=!0),r(6,l=0),r(7,d=m[0]),r(8,p=null);try{const t={dataset_id:o,num_records:a,privacy_level:c,model_type:s,preserve_correlations:!0,hipaa_compliant:"high"===c};try{const e=await n.actor.create_synthetic_job(t);if(e.Err)throw new Error(e.Err);h=e.Ok}catch(t){console.warn("Synthetic job functions not available, using simulation mode:",t),h=`sim_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const e=6e4/m.length;for(let t=0;t<m.length;t++){r(7,d=m[t]);const i=t/m.length*100,o=(t+1)/m.length*100;if(await y(i,o,e),!h.startsWith("sim_"))try{await n.actor.update_synthetic_job_progress(h,Math.round(o),t===m.length-1?"completed":"processing")}catch(t){console.warn("Failed to update backend progress:",t)}await new Promise((t=>setTimeout(t,200)))}if(r(6,l=100),r(7,d="Generation complete!"),!h.startsWith("sim_"))try{const t=await n.actor.get_synthetic_job_status(h);if(t.Ok){const e=t.Ok;r(8,p={id:e.job_id,name:`Synthetic_${o}_${(new Date).toISOString().split("T")[0]}`,records:a,model:s,privacyLevel:c,qualityScore:Math.floor(20*Math.random())+80,createdAt:new Date(Number(e.created_at)/1e6).toISOString(),resultDatasetId:e.result_dataset_id})}}catch(t){console.warn("Failed to get job status:",t)}p||r(8,p={id:h,name:`Synthetic_${o}_${(new Date).toISOString().split("T")[0]}`,records:a,model:s,privacyLevel:c,qualityScore:Math.floor(20*Math.random())+80,createdAt:(new Date).toISOString()}),setTimeout((()=>{r(5,u=!1)}),1e3)}catch(t){console.error("Generation failed:",t),r(7,d=`Error: ${t.message}`),r(6,l=0),setTimeout((()=>{r(5,u=!1),alert(`Generation failed: ${t.message}`)}),2e3)}}else alert("Please select a dataset to generate synthetic data from")},async function(){if(!p)return;const t=[];for(let e=1;e<=a;e++)t.push([`SYN_${e.toString().padStart(6,"0")}`,Math.floor(80*Math.random())+18,Math.random()>.5?"M":"F",`ICD_${Math.floor(1e3*Math.random())+1e3}`,`TX_${Math.floor(100*Math.random())+100}`,Math.random()>.8?"Improved":"Stable"]);const e=[["id","age","gender","diagnosis","treatment","outcome"].join(","),...t.map((t=>t.join(",")))].join("\n"),r=new Blob([e],{type:"text/csv"}),n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=`${p.name}.csv`,i.click(),URL.revokeObjectURL(n)},function(){r(5,u=!1),r(6,l=0),r(7,d=""),r(8,p=null)},function(){o=L(this),r(1,o),r(0,i)},t=>r(2,s=t.id),function(){a=U(this.value),r(3,a)},function(){c=L(this),r(4,c),r(10,g)},t=>t.id===c,t=>t.id===s,t=>t.id===p.model]}class Pm extends _t{constructor(t){super(),Et(this,t,km,Um,s,{},null,[-1,-1])}}function Cm(t,e,r){const n=t.slice();return n[17]=e[r],n}function Dm(t,e,r){const n=t.slice();return n[17]=e[r],n}function Lm(t){let e,r,n,o,s,a,c,u,l,f,d,h,p,g,m,y,b,v,x,N,U,P,C,D,L,F,j,$,M=(t[4]?.toString().slice(0,2).toUpperCase()||"U")+"",q=t[3]&&Fm(t);function V(t,e){return t[2]?$m:jm}let z=V(t),G=z(t),K=!t[2]&&Mm(t),H=!t[2]&&qm(t),Z=t[6].filter(Wm),W=[];for(let e=0;e<Z.length;e+=1)W[e]=zm(Dm(t,Z,e));let Y=!t[2]&&Gm(t),X=!t[2]&&Hm();return{c(){e=S("button"),e.innerHTML='<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>',r=T(),q&&q.c(),n=T(),o=S("div"),s=S("div"),a=S("button"),G.c(),u=T(),l=S("div"),f=S("div"),d=S("div"),h=S("span"),p=A(M),g=T(),K&&K.c(),m=T(),H&&H.c(),y=T(),b=S("div"),v=S("div");for(let t=0;t<W.length;t+=1)W[t].c();x=T(),Y&&Y.c(),N=T(),U=S("div"),P=S("button"),C=I("svg"),D=I("path"),L=T(),X&&X.c(),R(e,"class","lg:hidden fixed top-4 left-4 z-50 bg-gray-900 text-white p-2 rounded-lg shadow-lg"),R(a,"class","flex items-center justify-center w-full hover:opacity-80 transition-opacity duration-200"),R(a,"title",c=t[2]?"Expand sidebar":"Collapse sidebar"),R(s,"class","flex items-center justify-center p-4 border-b border-gray-800"),R(h,"class","text-white text-sm font-semibold"),R(d,"class","w-10 h-10 bg-gradient-to-br from-green-400 to-green-500 rounded-full flex items-center justify-center shadow-lg"),R(f,"class","flex items-center gap-3"),R(l,"class","p-4 mx-4 mb-6 bg-gray-800/50 rounded-2xl border border-gray-700/50"),R(v,"class","px-4 space-y-1"),R(b,"class","flex-1 overflow-y-auto"),R(D,"stroke-linecap","round"),R(D,"stroke-linejoin","round"),R(D,"stroke-width","2"),R(D,"d","M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"),R(C,"class","w-5 h-5"),R(C,"fill","none"),R(C,"stroke","currentColor"),R(C,"viewBox","0 0 24 24"),R(P,"class","flex items-center gap-3 w-full px-3 py-2.5 rounded-lg cursor-pointer transition-all duration-200 text-gray-300 hover:bg-gray-800 hover:text-white"),R(U,"class","p-4 border-t border-gray-800"),R(o,"class",F="fixed lg:static inset-y-0 left-0 z-40 "+(t[2]?"w-20":"w-64")+" "+(t[3]?"translate-x-0":"-translate-x-full lg:translate-x-0")+" bg-gray-900 text-white transition-all duration-300 ease-in-out flex flex-col shadow-xl")},m(i,c){E(i,e,c),E(i,r,c),q&&q.m(i,c),E(i,n,c),E(i,o,c),w(o,s),w(s,a),G.m(a,null),w(o,u),w(o,l),w(l,f),w(f,d),w(d,h),w(h,p),w(f,g),K&&K.m(f,null),w(f,m),H&&H.m(f,null),w(o,y),w(o,b),w(b,v);for(let t=0;t<W.length;t+=1)W[t]&&W[t].m(v,null);w(b,x),Y&&Y.m(b,null),w(o,N),w(o,U),w(U,P),w(P,C),w(C,D),w(P,L),X&&X.m(P,null),j||($=[O(e,"click",t[12]),O(a,"click",t[14]),O(P,"click",t[8])],j=!0)},p(t,e){if(t[3]?q?q.p(t,e):(q=Fm(t),q.c(),q.m(n.parentNode,n)):q&&(q.d(1),q=null),z!==(z=V(t))&&(G.d(1),G=z(t),G&&(G.c(),G.m(a,null))),4&e&&c!==(c=t[2]?"Expand sidebar":"Collapse sidebar")&&R(a,"title",c),16&e&&M!==(M=(t[4]?.toString().slice(0,2).toUpperCase()||"U")+"")&&k(p,M),t[2]?K&&(K.d(1),K=null):K?K.p(t,e):(K=Mm(t),K.c(),K.m(f,m)),t[2]?H&&(H.d(1),H=null):H?H.p(t,e):(H=qm(t),H.c(),H.m(f,null)),199&e){let r;for(Z=t[6].filter(Wm),r=0;r<Z.length;r+=1){const n=Dm(t,Z,r);W[r]?W[r].p(n,e):(W[r]=zm(n),W[r].c(),W[r].m(v,null))}for(;r<W.length;r+=1)W[r].d(1);W.length=Z.length}t[2]?Y&&(Y.d(1),Y=null):Y?Y.p(t,e):(Y=Gm(t),Y.c(),Y.m(b,null)),t[2]?X&&(X.d(1),X=null):X||(X=Hm(),X.c(),X.m(P,null)),12&e&&F!==(F="fixed lg:static inset-y-0 left-0 z-40 "+(t[2]?"w-20":"w-64")+" "+(t[3]?"translate-x-0":"-translate-x-full lg:translate-x-0")+" bg-gray-900 text-white transition-all duration-300 ease-in-out flex flex-col shadow-xl")&&R(o,"class",F)},d(t){t&&_(e),t&&_(r),q&&q.d(t),t&&_(n),t&&_(o),G.d(),K&&K.d(),H&&H.d(),B(W,t),Y&&Y.d(),X&&X.d(),j=!1,i($)}}}function Fm(e){let r,n,i;return{c(){r=S("div"),R(r,"class","lg:hidden fixed inset-0 bg-black bg-opacity-50 z-40")},m(t,o){E(t,r,o),n||(i=O(r,"click",e[13]),n=!0)},p:t,d(t){t&&_(r),n=!1,i()}}}function jm(t){let e,r;return{c(){e=S("img"),c(e.src,r="/logo.svg")||R(e,"src","/logo.svg"),R(e,"alt","VRAM Synth"),R(e,"class","h-20 object-contain max-w-full flex-shrink-0")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function $m(t){let e,r;return{c(){e=S("img"),c(e.src,r="/vram-unified-gradient.svg")||R(e,"src","/vram-unified-gradient.svg"),R(e,"alt","VRAM"),R(e,"class","w-10 h-10 object-contain flex-shrink-0")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function Mm(t){let e,r,n,i,o,s,a=(t[4]?.toString().slice(0,12)||"Loading")+"";return{c(){e=S("div"),r=S("div"),r.textContent="Connected",n=T(),i=S("div"),o=A(a),s=A("..."),R(r,"class","text-white text-sm font-medium"),R(i,"class","text-gray-400 text-xs truncate"),R(e,"class","flex-1 min-w-0")},m(t,a){E(t,e,a),w(e,r),w(e,n),w(e,i),w(i,o),w(i,s)},p(t,e){16&e&&a!==(a=(t[4]?.toString().slice(0,12)||"Loading")+"")&&k(o,a)},d(t){t&&_(e)}}}function qm(e){let r,n,i;return{c(){r=S("button"),r.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>',R(r,"class","ml-2 hover:bg-gray-700 rounded-full p-1.5 transition-all duration-200 text-gray-400 hover:text-white"),R(r,"title","Disconnect")},m(t,o){E(t,r,o),n||(i=O(r,"click",e[8]),n=!0)},p:t,d(t){t&&_(r),n=!1,i()}}}function Vm(e){let r,n,i=e[17].label+"";return{c(){r=S("span"),n=A(i),R(r,"class","font-medium text-sm")},m(t,e){E(t,r,e),w(r,n)},p:t,d(t){t&&_(r)}}}function zm(t){let e,r,n,i,o,s,a,c=t[7](t[17].icon)+"",u=!t[2]&&Vm(t);function l(){return t[15](t[17])}return{c(){e=S("div"),r=new $(!1),n=T(),u&&u.c(),i=T(),r.a=n,R(e,"class",o="flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-all duration-200 "+(t[0]===t[17].id?"bg-gradient-to-r from-green-400 to-green-500 text-white shadow-lg":"text-gray-300 hover:bg-gray-800 hover:text-white"))},m(t,o){E(t,e,o),r.m(c,e),w(e,n),u&&u.m(e,null),w(e,i),s||(a=O(e,"click",l),s=!0)},p(r,n){(t=r)[2]?u&&(u.d(1),u=null):u?u.p(t,n):(u=Vm(t),u.c(),u.m(e,i)),1&n&&o!==(o="flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-all duration-200 "+(t[0]===t[17].id?"bg-gradient-to-r from-green-400 to-green-500 text-white shadow-lg":"text-gray-300 hover:bg-gray-800 hover:text-white"))&&R(e,"class",o)},d(t){t&&_(e),u&&u.d(),s=!1,a()}}}function Gm(t){let e,r,n,i,o=t[6].filter(Ym),s=[];for(let e=0;e<o.length;e+=1)s[e]=Km(Cm(t,o,e));return{c(){e=S("div"),r=S("span"),r.textContent="Workspace",n=T(),i=S("div");for(let t=0;t<s.length;t+=1)s[t].c();R(r,"class","text-gray-500 text-xs font-medium uppercase tracking-wide mb-3 block"),R(i,"class","space-y-1"),R(e,"class","px-4 mt-8")},m(t,o){E(t,e,o),w(e,r),w(e,n),w(e,i);for(let t=0;t<s.length;t+=1)s[t]&&s[t].m(i,null)},p(t,e){if(195&e){let r;for(o=t[6].filter(Ym),r=0;r<o.length;r+=1){const n=Cm(t,o,r);s[r]?s[r].p(n,e):(s[r]=Km(n),s[r].c(),s[r].m(i,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=o.length}},d(t){t&&_(e),B(s,t)}}}function Km(t){let e,r,n,i,o,s,a,c,u,l=t[7](t[17].icon)+"",f=t[17].label+"";function d(){return t[16](t[17])}return{c(){e=S("div"),r=new $(!1),n=T(),i=S("span"),o=A(f),s=T(),r.a=n,R(i,"class","font-medium text-sm"),R(e,"class",a="flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-all duration-200 "+(t[0]===t[17].id?"bg-gradient-to-r from-green-400 to-green-500 text-white shadow-lg":"text-gray-300 hover:bg-gray-800 hover:text-white"))},m(t,a){E(t,e,a),r.m(l,e),w(e,n),w(e,i),w(i,o),w(e,s),c||(u=O(e,"click",d),c=!0)},p(r,n){t=r,1&n&&a!==(a="flex items-center gap-3 px-3 py-2.5 rounded-lg cursor-pointer transition-all duration-200 "+(t[0]===t[17].id?"bg-gradient-to-r from-green-400 to-green-500 text-white shadow-lg":"text-gray-300 hover:bg-gray-800 hover:text-white"))&&R(e,"class",a)},d(t){t&&_(e),c=!1,u()}}}function Hm(t){let e;return{c(){e=S("span"),e.textContent="Log out",R(e,"class","font-medium text-sm")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function Zm(e){let r,n=e[5]&&Lm(e);return{c(){n&&n.c(),r=N()},m(t,e){n&&n.m(t,e),E(t,r,e)},p(t,[e]){t[5]?n?n.p(t,e):(n=Lm(t),n.c(),n.m(r.parentNode,r)):n&&(n.d(1),n=null)},i:t,o:t,d(t){n&&n.d(t),t&&_(r)}}}const Wm=t=>"main"===t.section,Ym=t=>"workspace"===t.section;function Xm(t,e,r){let n,i,o;var s,a;f(t,eg,(t=>r(11,o=t)));let{activeSection:c="upload"}=e,{setActiveSection:u}=e,l=!1,d=!1;return t.$$set=t=>{"activeSection"in t&&r(0,c=t.activeSection),"setActiveSection"in t&&r(1,u=t.setActiveSection)},t.$$.update=()=>{2048&t.$$.dirty&&r(5,n="initialized"===(null==o?void 0:o.state)),3584&t.$$.dirty&&r(4,i=null===r(10,a=null===r(9,s=null==o?void 0:o.client)||void 0===s?void 0:s.getIdentity())||void 0===a?void 0:a.getPrincipal())},[c,u,l,d,i,n,[{id:"upload",icon:"upload",label:"Upload Dataset",section:"main"},{id:"list",icon:"datasets",label:"My Datasets",section:"main"},{id:"sample",icon:"samples",label:"Sample Data",section:"main"},{id:"marketplace",icon:"marketplace",label:"Marketplace",section:"main"},{id:"generate",icon:"generate",label:"Generate Synthetic",section:"workspace"},{id:"analytics",icon:"analytics",label:"Analytics",section:"workspace"},{id:"settings",icon:"settings",label:"Settings",section:"workspace"}],t=>{const e="w-5 h-5";switch(t){case"upload":return`<svg class="${e}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" /></svg>`;case"datasets":return`<svg class="${e}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>`;case"samples":return`<svg class="${e}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>`;case"marketplace":return`<svg class="${e}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z" /></svg>`;case"generate":return`<svg class="${e}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>`;case"analytics":return`<svg class="${e}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg>`;case"settings":return`<svg class="${e}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></svg>`;default:return`<div class="${e} bg-gray-300 rounded"></div>`}},function(){(null==o?void 0:o.client)&&(o.client.logout(),window.location.reload())},s,a,o,()=>r(3,d=!d),()=>r(3,d=!1),()=>r(2,l=!l),t=>u(t.id),t=>u(t.id)]}class Jm extends _t{constructor(t){super(),Et(this,t,Xm,Zm,s,{activeSection:0,setActiveSection:1})}}function Qm(e){let r;return{c(){r=S("div"),r.innerHTML='<div class="container mx-auto p-4 max-w-md"><div class="card bg-white shadow-xl border border-gray-200"><div class="card-body text-center"><div class="loading loading-spinner loading-lg text-primary"></div> \n          <p class="mt-4 text-gray-600">Initializing authentication...</p></div></div></div>',R(r,"class","min-h-screen bg-white flex items-center justify-center")},m(t,e){E(t,r,e)},p:t,i:t,o:t,d(t){t&&_(r)}}}function ty(e){let r,n,i,o,s,a,c,u,l,f,d;return{c(){r=S("div"),n=S("div"),i=S("div"),o=S("div"),s=S("h2"),s.textContent="Authentication Required",a=T(),c=S("p"),c.textContent="Please log in with Internet Identity to access your synthetic datasets.",u=T(),l=S("button"),l.textContent="Login with Internet Identity",R(s,"class","card-title justify-center mb-4 text-gray-800"),R(c,"class","mb-6 text-gray-600"),R(l,"class","btn btn-primary"),R(o,"class","card-body text-center"),R(i,"class","card bg-white shadow-xl border border-gray-200"),R(n,"class","container mx-auto p-4 max-w-md"),R(r,"class","min-h-screen bg-white flex items-center justify-center")},m(t,e){E(t,r,e),w(r,n),w(n,i),w(i,o),w(o,s),w(o,a),w(o,c),w(o,u),w(o,l),f||(d=O(l,"click",rg),f=!0)},p:t,i:t,o:t,d(t){t&&_(r),f=!1,d()}}}function ey(t){let e,r,n,i,o,s,a,c,u,l,f,d,h,p;function g(t,e){return"upload"===t[1]?uy:"list"===t[1]?cy:"sample"===t[1]?ay:"marketplace"===t[1]?sy:"generate"===t[1]?oy:"analytics"===t[1]?iy:"settings"===t[1]?ny:ry}r=new Jm({props:{activeSection:t[1],setActiveSection:t[4]}});let m=g(t),y=m(t);function b(t,e){return"upload"===t[1]?yy:"list"===t[1]?my:"sample"===t[1]?gy:"marketplace"===t[1]?py:"generate"===t[1]?hy:"analytics"===t[1]?dy:"settings"===t[1]?fy:ly}let v=b(t),x=v(t);const B=[Sy,By,_y,Ey,xy,vy,wy,by],I=[];function A(t,e){return"list"===t[1]?0:"upload"===t[1]?1:"sample"===t[1]?2:"marketplace"===t[1]?3:"generate"===t[1]?4:"analytics"===t[1]?5:"settings"===t[1]?6:7}return d=A(t),h=I[d]=B[d](t),{c(){e=S("div"),bt(r.$$.fragment),n=T(),i=S("div"),o=S("div"),s=S("div"),a=S("h1"),y.c(),c=T(),u=S("p"),x.c(),l=T(),f=S("div"),h.c(),R(a,"class","text-3xl font-bold text-gray-800 mb-2"),R(u,"class","text-gray-600"),R(s,"class","mb-8"),R(f,"class","bg-white rounded-xl shadow-sm border border-gray-200 p-6"),R(o,"class","container mx-auto p-6"),R(i,"class","flex-1 lg:ml-0"),R(e,"class","min-h-screen bg-gray-50 flex")},m(t,h){E(t,e,h),wt(r,e,null),w(e,n),w(e,i),w(i,o),w(o,s),w(s,a),y.m(a,null),w(s,c),w(s,u),x.m(u,null),w(o,l),w(o,f),I[d].m(f,null),p=!0},p(t,e){const n={};2&e&&(n.activeSection=t[1]),r.$set(n),m!==(m=g(t))&&(y.d(1),y=m(t),y&&(y.c(),y.m(a,null))),v!==(v=b(t))&&(x.d(1),x=v(t),x&&(x.c(),x.m(u,null)));let i=d;d=A(t),d===i?I[d].p(t,e):(dt(),gt(I[i],1,1,(()=>{I[i]=null})),ht(),h=I[d],h?h.p(t,e):(h=I[d]=B[d](t),h.c()),pt(h,1),h.m(f,null))},i(t){p||(pt(r.$$.fragment,t),pt(h),p=!0)},o(t){gt(r.$$.fragment,t),gt(h),p=!1},d(t){t&&_(e),vt(r),y.d(),x.d(),I[d].d()}}}function ry(t){let e;return{c(){e=A("Synthetic Data Manager")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function ny(t){let e;return{c(){e=A("Settings")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function iy(t){let e;return{c(){e=A("Analytics")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function oy(t){let e;return{c(){e=A("Generate Synthetic")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function sy(t){let e;return{c(){e=A("Marketplace")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function ay(t){let e;return{c(){e=A("Sample Data")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function cy(t){let e;return{c(){e=A("My Datasets")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function uy(t){let e;return{c(){e=A("Upload Dataset")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function ly(t){let e;return{c(){e=A("Manage your synthetic datasets with privacy-preserving encryption")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function fy(t){let e;return{c(){e=A("Configure your preferences")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function dy(t){let e;return{c(){e=A("View analytics and insights")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function hy(t){let e;return{c(){e=A("Create synthetic data from your datasets")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function py(t){let e;return{c(){e=A("Discover and purchase synthetic datasets")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function gy(t){let e;return{c(){e=A("Explore pre-loaded synthetic datasets")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function my(t){let e;return{c(){e=A("Browse and manage your uploaded datasets")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function yy(t){let e;return{c(){e=A("Upload and encrypt your CSV datasets securely")},m(t,r){E(t,e,r)},d(t){t&&_(e)}}}function by(e){let r,n,i,o;return{c(){r=S("div"),n=S("span"),i=A("Unknown section: "),o=A(e[1]),R(r,"class","alert alert-warning")},m(t,e){E(t,r,e),w(r,n),w(n,i),w(n,o)},p(t,e){2&e&&k(o,t[1])},i:t,o:t,d(t){t&&_(r)}}}function wy(e){let r;return{c(){r=S("div"),r.innerHTML='<div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg></div> \n              <h3 class="text-lg font-semibold text-gray-900 mb-2">Settings Coming Soon</h3> \n              <p class="text-gray-600">Configure your account and privacy preferences.</p>',R(r,"class","text-center py-12")},m(t,e){E(t,r,e)},p:t,i:t,o:t,d(t){t&&_(r)}}}function vy(e){let r;return{c(){r=S("div"),r.innerHTML='<div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg></div> \n              <h3 class="text-lg font-semibold text-gray-900 mb-2">Analytics Coming Soon</h3> \n              <p class="text-gray-600">View detailed analytics and insights about your datasets.</p>',R(r,"class","text-center py-12")},m(t,e){E(t,r,e)},p:t,i:t,o:t,d(t){t&&_(r)}}}function xy(e){let r,n;return r=new Pm({}),{c(){bt(r.$$.fragment)},m(t,e){wt(r,t,e),n=!0},p:t,i(t){n||(pt(r.$$.fragment,t),n=!0)},o(t){gt(r.$$.fragment,t),n=!1},d(t){vt(r,t)}}}function Ey(e){let r;return{c(){r=S("div"),r.innerHTML='<div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path></svg></div> \n              <h3 class="text-lg font-semibold text-gray-900 mb-2">Marketplace Coming Soon</h3> \n              <p class="text-gray-600">Browse and purchase synthetic datasets from other users.</p>',R(r,"class","text-center py-12")},m(t,e){E(t,r,e)},p:t,i:t,o:t,d(t){t&&_(r)}}}function _y(e){let r,n;return r=new Ng({}),r.$on("loaded",e[3]),{c(){bt(r.$$.fragment)},m(t,e){wt(r,t,e),n=!0},p:t,i(t){n||(pt(r.$$.fragment,t),n=!0)},o(t){gt(r.$$.fragment,t),n=!1},d(t){vt(r,t)}}}function By(e){let r,n;return r=new Eg({}),r.$on("uploaded",e[3]),{c(){bt(r.$$.fragment)},m(t,e){wt(r,t,e),n=!0},p:t,i(t){n||(pt(r.$$.fragment,t),n=!0)},o(t){gt(r.$$.fragment,t),n=!1},d(t){vt(r,t)}}}function Sy(e){let r,n,i=e[2],o=Iy();return{c(){o.c(),r=N()},m(t,e){o.m(t,e),E(t,r,e),n=!0},p(e,n){4&n&&s(i,i=e[2])?(dt(),gt(o,1,1,t),ht(),o=Iy(),o.c(),pt(o,1),o.m(r.parentNode,r)):o.p(e,n)},i(t){n||(pt(o),n=!0)},o(t){gt(o),n=!1},d(t){t&&_(r),o.d(t)}}}function Iy(e){let r,n;return r=new Em({}),{c(){bt(r.$$.fragment)},m(t,e){wt(r,t,e),n=!0},p:t,i(t){n||(pt(r.$$.fragment,t),n=!0)},o(t){gt(r.$$.fragment,t),n=!1},d(t){vt(r,t)}}}function Ay(t){let e,r,n,i,o,s,a,c,u,l,f,d,h,p,g,m,y,b,v=(t[0]?.state||"undefined")+"",x=t[0]?.actor?"":"",B=t[0]?.client?"":"",I=t[0]?.crypto?"":"";const O=[ey,ty,Qm],U=[];function P(t,e){return t[0]&&"initialized"===t[0].state?0:t[0]&&"anonymous"===t[0].state?1:2}return g=P(t),m=U[g]=O[g](t),{c(){e=S("div"),r=S("strong"),r.textContent=" Debug Info:",n=A(' Auth State = "'),i=A(v),o=A('" | \n  Actor: '),s=A(x),a=A(" | \n  Client: "),c=A(B),u=A(" | \n  Crypto: "),l=A(I),f=A(' | \n  Active Tab: "'),d=A(t[1]),h=A('"'),p=T(),m.c(),y=N(),R(e,"class","bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded mb-4")},m(t,m){E(t,e,m),w(e,r),w(e,n),w(e,i),w(e,o),w(e,s),w(e,a),w(e,c),w(e,u),w(e,l),w(e,f),w(e,d),w(e,h),E(t,p,m),U[g].m(t,m),E(t,y,m),b=!0},p(t,[e]){(!b||1&e)&&v!==(v=(t[0]?.state||"undefined")+"")&&k(i,v),(!b||1&e)&&x!==(x=t[0]?.actor?"":"")&&k(s,x),(!b||1&e)&&B!==(B=t[0]?.client?"":"")&&k(c,B),(!b||1&e)&&I!==(I=t[0]?.crypto?"":"")&&k(l,I),(!b||2&e)&&k(d,t[1]);let r=g;g=P(t),g===r?U[g].p(t,e):(dt(),gt(U[r],1,1,(()=>{U[r]=null})),ht(),m=U[g],m?m.p(t,e):(m=U[g]=O[g](t),m.c()),pt(m,1),m.m(y.parentNode,y))},i(t){b||(pt(m),b=!0)},o(t){gt(m),b=!1},d(t){t&&_(e),t&&_(p),U[g].d(t),t&&_(y)}}}function Ty(t,e,r){let n;f(t,eg,(t=>r(0,n=t)));let i="upload",o=0;return t.$$.update=()=>{1&t.$$.dirty&&console.log(" Synthetic.svelte - Auth State Debug:",{state:null==n?void 0:n.state,hasActor:!!(null==n?void 0:n.actor),hasClient:!!(null==n?void 0:n.client),hasCrypto:!!(null==n?void 0:n.crypto),timestamp:(new Date).toISOString()})},[n,i,o,function(){r(1,i="list"),r(2,o++,o)},function(t){console.log(" Switching to section:",t),r(1,i=t),console.log(" Active tab is now:",i)}]}class Ny extends _t{constructor(t){super(),Et(this,t,Ty,Ay,s,{})}}function Oy(t){const e=t-1;return e*e*e+1}function Ry(t,{delay:r=0,duration:n=400,easing:i=e}={}){const o=+getComputedStyle(t).opacity;return{delay:r,duration:n,easing:i,css:t=>"opacity: "+t*o}}function Uy(t,{delay:e=0,duration:r=400,easing:n=Oy,x:i=0,y:o=0,opacity:s=0}={}){const a=getComputedStyle(t),c=+a.opacity,u="none"===a.transform?"":a.transform,l=c*(1-s),[f,h]=d(i),[p,g]=d(o);return{delay:e,duration:r,easing:n,css:(t,e)=>`\n\t\t\ttransform: ${u} translate(${(1-t)*f}${h}, ${(1-t)*p}${g});\n\t\t\topacity: ${c-l*e}`}}function ky(t,e,r){const n=t.slice();return n[2]=e[r],n}function Py(r,n){let s,a,c,u,l,f,d,h,g=n[2].message+"";return{key:r,first:null,c(){s=S("div"),a=S("p"),c=A(g),u=T(),R(s,"class",l="alert "+n[1][n[2].type]+" bg-opacity-100 text-white"),this.first=s},m(t,e){E(t,s,e),w(s,a),w(a,c),w(s,u),h=!0},p(t,e){n=t,(!h||1&e)&&g!==(g=n[2].message+"")&&k(c,g),(!h||1&e&&l!==(l="alert "+n[1][n[2].type]+" bg-opacity-100 text-white"))&&R(s,"class",l)},i(r){h||(rt((()=>{h&&(d&&d.end(1),f=function(r,n,i){const s={direction:"in"};let a,c,u=n(r,i,s),l=!1,f=0;function d(){a&&G(r,a)}function h(){const{delay:n=0,duration:i=300,easing:o=e,tick:s=t,css:h}=u||mt;h&&(a=z(r,0,1,i,n,o,h,f++)),s(0,1);const g=p()+n,m=g+i;c&&c.abort(),l=!0,rt((()=>ut(r,!0,"start"))),c=b((t=>{if(l){if(t>=m)return s(1,0),ut(r,!0,"end"),d(),l=!1;if(t>=g){const e=o((t-g)/i);s(e,1-e)}}return l}))}let g=!1;return{start(){g||(g=!0,G(r),o(u)?(u=u(s),ct().then(h)):h())},invalidate(){g=!1},end(){l&&(d(),l=!1)}}}(s,Uy,{x:100,duration:200}),f.start())})),h=!0)},o(r){f&&f.invalidate(),d=function(r,n,s){const a={direction:"out"};let c,u=n(r,s,a),l=!0;const f=ft;function d(){const{delay:n=0,duration:o=300,easing:s=e,tick:a=t,css:d}=u||mt;d&&(c=z(r,1,0,o,n,s,d));const h=p()+n,g=h+o;rt((()=>ut(r,!1,"start"))),b((t=>{if(l){if(t>=g)return a(0,1),ut(r,!1,"end"),--f.r||i(f.c),!1;if(t>=h){const e=s((t-h)/o);a(1-e,e)}}return l}))}return f.r+=1,o(u)?ct().then((()=>{u=u(a),d()})):d(),{end(t){t&&u.tick&&u.tick(1,0),l&&(c&&G(r,c),l=!1)}}}(s,Ry,{}),h=!1},d(t){t&&_(s),t&&d&&d.end()}}}function Cy(t){let e,r,n=[],o=new Map,s=t[0];const a=t=>t[2].id;for(let e=0;e<s.length;e+=1){let r=ky(t,s,e),i=a(r);o.set(i,n[e]=Py(i,r))}return{c(){e=S("div");for(let t=0;t<n.length;t+=1)n[t].c();R(e,"class","absolute right-4 bottom-4 flex flex-col max-w-xs space-y-4")},m(t,i){E(t,e,i);for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,null);r=!0},p(t,[r]){3&r&&(s=t[0],dt(),n=function(t,e,r,n,o,s,a,c,u,l,f,d){let h=t.length,p=s.length,g=h;const m={};for(;g--;)m[t[g].key]=g;const y=[],b=new Map,w=new Map,v=[];for(g=p;g--;){const t=d(o,s,g),i=r(t);let c=a.get(i);c?n&&v.push((()=>c.p(t,e))):(c=l(i,t),c.c()),b.set(i,y[g]=c),i in m&&w.set(i,Math.abs(g-m[i]))}const x=new Set,E=new Set;function _(t){pt(t,1),t.m(c,f),a.set(t.key,t),f=t.first,p--}for(;h&&p;){const e=y[p-1],r=t[h-1],n=e.key,i=r.key;e===r?(f=e.first,h--,p--):b.has(i)?!a.has(n)||x.has(n)?_(e):E.has(i)?h--:w.get(n)>w.get(i)?(E.add(n),_(e)):(x.add(i),h--):(u(r,a),h--)}for(;h--;){const e=t[h];b.has(e.key)||u(e,a)}for(;p;)_(y[p-1]);return i(v),y}(n,r,a,1,t,s,o,e,yt,Py,null,ky),ht())},i(t){if(!r){for(let t=0;t<s.length;t+=1)pt(n[t]);r=!0}},o(t){for(let t=0;t<n.length;t+=1)gt(n[t]);r=!1},d(t){t&&_(e);for(let t=0;t<n.length;t+=1)n[t].d()}}}function Dy(t,e,r){let n;f(t,Tp,(t=>r(0,n=t)));return[n,{info:"alert-info",error:"alert-error",success:"alert-success"}]}class Ly extends _t{constructor(t){super(),Et(this,t,Dy,Cy,s,{})}}function Fy(t){let e,r;return e=new pg({props:{auth:t[0]}}),{c(){bt(e.$$.fragment)},m(t,n){wt(e,t,n),r=!0},p(t,r){const n={};1&r&&(n.auth=t[0]),e.$set(n)},i(t){r||(pt(e.$$.fragment,t),r=!0)},o(t){gt(e.$$.fragment,t),r=!1},d(t){vt(e,t)}}}function jy(e){let r,n;return r=new Ny({}),{c(){bt(r.$$.fragment)},m(t,e){wt(r,t,e),n=!0},p:t,i(t){n||(pt(r.$$.fragment,t),n=!0)},o(t){gt(r.$$.fragment,t),n=!1},d(t){vt(r,t)}}}function $y(t){let e,r,n,i,o;const s=[jy,Fy],a=[];function c(t,e){return"initialized"===t[0].state?0:1}return e=c(t),r=a[e]=s[e](t),i=new Ly({}),{c(){r.c(),n=T(),bt(i.$$.fragment)},m(t,r){a[e].m(t,r),E(t,n,r),wt(i,t,r),o=!0},p(t,[i]){let o=e;e=c(t),e===o?a[e].p(t,i):(dt(),gt(a[o],1,1,(()=>{a[o]=null})),ht(),r=a[e],r?r.p(t,i):(r=a[e]=s[e](t),r.c()),pt(r,1),r.m(n.parentNode,n))},i(t){o||(pt(r),pt(i.$$.fragment,t),o=!0)},o(t){gt(r),gt(i.$$.fragment,t),o=!1},d(t){a[e].d(t),t&&_(n),vt(i,t)}}}function My(t,e,r){let n;return f(t,eg,(t=>r(0,n=t))),[n]}class qy extends _t{constructor(t){super(),Et(this,t,My,$y,s,{})}}(async()=>{new qy({target:document.body})})()}();
//# sourceMappingURL=main.js.map
